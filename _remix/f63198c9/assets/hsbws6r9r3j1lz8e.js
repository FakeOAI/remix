import{m as e,aJ as c,r as d,gA as K,az as B,z as L,e as U,bA as X,dX as V,f6 as W,P as E,d as _,bo as H,bi as J}from"./oxu1g7ovqac4x1gm.js";import{cR as Q,cS as D,ba as Y,cT as q}from"./gnak5wbxgigpi788.js";import{u as O}from"./iq3shhwjjo0q6i0d.js";import{e as Z,d as P}from"./kjwkz3o8cg2pzz3l.js";import{P as G}from"./ohwys3yhywu6ymin.js";import{aR as I}from"./l2dlwlym9v3m5hew.js";import"./mrsokoll6b76hci3.js";function z({title:r,content:t,buttons:s,time:a,icon:n,size:o="default",progressBar:m,disabled:i=!1,onClick:u}){const v=i?"border-token-dot-color border-opacity-10":"border-[rgba(0,0,0,0.1)] dark:border-[rgba(255,255,255,0.1)]",g=o==="small"?`w-[380px] pr-[15px] pl-[20px] pt-[13px] pb-[10px] ${i?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",h=u?"cursor-pointer":"",l=o==="small"?"text-[15px]":"";return e.jsxs("div",{className:c("inline-flex flex-col items-start justify-start rounded-2xl border",v,"bg-token-main-surface-primary dark:bg-token-main-surface-secondary",g,h,l),onClick:u,style:o==="small"&&!i?{boxShadow:"rgba(0, 0, 0, 0.06) 0px 2px 6px 0px"}:void 0,children:[e.jsxs("div",{className:c("flex flex-col items-start justify-start self-stretch",o!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:c("inline-flex items-start justify-start self-stretch",o!=="small"&&"gap-2"),children:[e.jsx("div",{className:c("shrink grow basis-0 font-medium leading-normal",i?"text-token-text-secondary":"text-token-text-primary"),children:r}),e.jsx("div",{className:"relative h-6 w-6"}),!i&&(n||e.jsx(I,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:c("flex w-full flex-col items-start justify-start",o==="small"&&"mt-[-2px]"),children:e.jsx("div",{className:c("inline-flex w-full items-start justify-start self-stretch rounded",o==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:c("w-full font-normal leading-relaxed",i?"text-token-text-tertiary":"text-token-text-secondary"),children:t})})})]}),m?e.jsxs("div",{className:c("mb-2 inline-flex items-center justify-between self-stretch",s?.length&&"mt-[-10px]"),children:[m,s]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[a&&e.jsx("div",{className:"shrink grow basis-0 text-[15px] font-normal leading-normal text-token-text-tertiary",children:a}),e.jsx("div",{className:"flex gap-2",children:s})]})]})}const ee={strong:r=>{const{node:t,children:s,...a}=r;return e.jsx("strong",{...a,className:c(a.className,"font-semibold text-token-text-primary"),children:s})},p:r=>{const{node:t,children:s,...a}=r;return e.jsx("p",{...a,className:c(a.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:s})}};function se({message:r,isExpandable:t}){const a=r.create_time?new Date(r.create_time*1e3):Date.now(),n=O(+a,48e4);return e.jsx(G,{percentage:n,className:c("mr-4",t?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-n)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function te({headline:r,message:t}){const a=t.create_time?new Date(t.create_time*1e3):Date.now(),n=O(+a,48e4);return e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(q,{percentage:n,thickness:1/8,className:"h-5 w-5 text-token-text-primary",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-n)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"}),r]})}function ae({isExpandable:r,handleOpenSidebarSummarizer:t,summarizationHeadline:s,latestTitle:a,message:n}){return e.jsx("div",{className:"py-2",children:e.jsx(z,{buttons:[e.jsx(H,{onClick:t,color:"secondary",className:"!h-[38px] text-[15px] font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(J,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")],title:s,time:null,icon:e.jsx("div",{className:""}),content:`${a}...`,size:"small",progressBar:e.jsx(se,{message:n,isExpandable:r})})})}function re({handleOpenSidebarSummarizer:r,summarizationHeadline:t,message:s}){return e.jsx("div",{className:"py-2",children:e.jsx(z,{buttons:[],title:t,time:null,content:s.metadata?.finished_text??"",size:"small",disabled:!0,onClick:r})})}function A({completionInProgress:r,summarizationHeadline:t,latestTitle:s,message:a,summaryText:n,isExpandable:o,disableExpansion:m,onOpenAnalytics:i,handleOpenSidebarSummarizer:u}){return e.jsx(Z,{status:r?P.Running:P.Finished,highlightedCommand:r?t==null?s:e.jsx(te,{headline:t,message:a}):a.metadata?.finished_text??"",onOpenAnalytics:i,onClick:u,children:n&&o&&!m?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(Y,{componentOverrides:ee,className:"not-prose leading-6",children:n})}):null})}function ue({messages:r,isStreaming:t,clientThreadId:s,currentGroupedMessageIndex:a,turnIndex:n}){const[o,m]=d.useState(""),[i,u]=d.useState(!1),g=K(s)===B.STREAMING,h=g||t,l=r[0].message,S=l.id,k=L.getServerThreadId(s),p=U(l),x=l.metadata?.summarization_headline,R=t&&x!=null,{toggleThreadSidebar:b}=X(),w=V(),f=W(),F=x!=null,$=Q(),j=d.useCallback(()=>{w&&f&&f.type==="summarizer"&&f.clientThreadId===s&&f.turnIndex===n?D({className:"close-thread-sidebar",update:()=>{b({type:"summarizer",clientThreadId:s,currentGroupedMessageIndex:a,turnIndex:n})}}):D({className:"open-thread-sidebar",update:()=>{b({type:"summarizer",clientThreadId:s,currentGroupedMessageIndex:a,turnIndex:n})}})},[b,s,a,n,w,f]);d.useEffect(()=>{const M=/\*\*(.*?)(?:\*\*|\n|$)/g;let C,N="";for(;(C=M.exec(p))!=null;)N=C[1].trim();N?m(N):l.metadata?.initial_text!=null&&m(l.metadata.initial_text)},[p,l.metadata?.initial_text]),d.useEffect(()=>{p.length>0&&u(!0)},[p]);const y=d.useMemo(()=>({client_thread_id:s,message_id:S,conversationId:k}),[s,S,k]);d.useEffect(()=>{i&&E.logEvent(_.receivedA8KM123Message,y)},[i]);const T=d.useCallback(()=>{E.logEvent(_.openedA8KM123Message,{...y,isStreaming:t})},[y,t]);return $?F?g||t?e.jsx(ae,{isExpandable:i,handleOpenSidebarSummarizer:j,summarizationHeadline:x,latestTitle:o,message:l}):e.jsx(re,{handleOpenSidebarSummarizer:j,summarizationHeadline:x,message:l}):e.jsx(A,{completionInProgress:h,summarizationHeadline:x,latestTitle:o,message:l,onOpenAnalytics:T,handleOpenSidebarSummarizer:i||!t?j:void 0}):e.jsx(A,{completionInProgress:h,summarizationHeadline:x,latestTitle:o,message:l,onOpenAnalytics:T,summaryText:p,isExpandable:i,disableExpansion:R})}export{ee as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,ue as default};
//# sourceMappingURL=hsbws6r9r3j1lz8e.js.map
