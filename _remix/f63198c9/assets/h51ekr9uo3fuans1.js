import{V as G,m as e,e6 as V,ex as X,r as c,a9 as O,ba as T,U as $,bJ as ee,bi as k,f1 as se,aJ as z,N as w,de as te,br as A,fy as I,cc as ae,cd as ne,gm as ie,dY as E}from"./oxu1g7ovqac4x1gm.js";import{ep as P,is as oe,e5 as re,U as _,eq as le,z as B,bL as ce,it as de,eZ as me,cZ as N,cX as ue,aO as ge,c7 as fe,iu as C,iv as xe,A as pe,c_ as he,iw as Se,hv as be,hw as je,ix as ve,iy as v,iz as Ce,S,j as ye,c$ as ze,iA as Ie,iB as ke,iC as Me,dL as Ne,iD as U,aB as D,iE as Ge,iF as Oe,iG as Fe,iH as y,iI as Te,dM as Le,iJ as we,x as Ae,iK as Ee,eW as Pe,iL as _e,iM as Be}from"./gnak5wbxgigpi788.js";import{b7 as Ue,y as De,ay as Re,K as We,L as R,aO as He,au as Ke}from"./l2dlwlym9v3m5hew.js";import{m as W}from"./mrsokoll6b76hci3.js";import{a as Ze}from"./il7m0l9oupjndsma.js";import{U as Ye,P as qe}from"./ibrhoqeqt5jsrr7k.js";function H(){const s=G(),i=P(),n=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(oe,{children:e.jsx(W.div,{whileTap:{scale:.98},children:e.jsx(V,{to:re(),onClick:()=>{i.activeSidebar==="popover-nav"&&_.setActiveSidebar(!1)},children:e.jsx(le,{icon:Ue,"data-testid":"explore-gpts-button",children:n})},"explore")})})}function Je({gizmo:s,historyDisabled:i,section:n,onClick:o,isActive:d,hideOverflowMenu:g=!1,elementRef:r}){const{clientThreadId:m}=B(),f=X(m),x=G(),[t,b]=c.useState(!1),[a,l]=c.useState(!1);c.useState(!1);const[u,p]=c.useState(null),h=O(),Y=!!s?.gizmo.tags?.includes(ce.FirstParty),q=!1;let J=!1;const[as,F]=c.useState(0),{data:M}=de(s?.gizmo.id);c.useEffect(()=>{F(M?M.items.length:0)},[M]),c.useEffect(()=>{u==null&&d&&f&&p(!0)},[d,f,u]);let j;if(s!=null)j=s.gizmo.display.name||me;else{if(h==null)return null;i?j=x.formatMessage(N.clearChat):h.canInteractWithGizmos()?j=he:j=x.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(W.div,{whileTap:{scale:.98},onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},children:e.jsx(ue,{loggingGizmoId:s?.gizmo.id??"primary",href:ge(s),onClick:o,showActiveIndicator:J,icon:e.jsx(fe,{gizmoId:s?.gizmo.id,isFirstParty:Y,gizmoEmoji:s?.gizmo.display.emoji,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6 shrink-0"}),isMenuOpen:t,label:j,rightIcon:n===C.Workspace&&e.jsx(T,{side:"right",label:x.formatMessage(L.workspaceRecommended,{workspace_name:h?.name??"Your Workspace"}),children:e.jsx(De,{className:"icon-md text-token-text-secondary",alt:x.formatMessage(L.workspaceRecommended,{workspace_name:h?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(a||t)&&!q&&!g&&e.jsx("div",{className:"text-token-text-tertiary",onClick:Q=>{Q.preventDefault()},children:e.jsx(xe,{gizmo:s,isOpen:t,setIsOpen:b,section:n})}),!g&&e.jsx(T,{side:"right",label:x.formatMessage(i?N.clearChat:N.newChat),className:"flex items-center",children:e.jsx("button",{className:t?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:i?e.jsx(Re,{className:"icon-md"}):e.jsx(We,{className:"icon-md"})})})]}),elementRef:r})}),e.jsx(pe,{children:!1})]})}const L=$({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}}),Qe=2;function K({gizmos:s,isGizmoFlyout:i,isLoaded:n,maxToShowOnLoad:o=4,isScreenArch:d,showAllSidebarItems:g}){const r=ve(s,l=>l.flair.kind),m=[...(r[v.Workspace]?.map(({resource:l})=>({gizmo:l,section:C.Workspace}))??[]).slice(0,3),...r[v.FirstParty]?.map(({resource:l})=>({gizmo:l,section:C.Keep}))??[],...r[v.SidebarKeep]?.map(({resource:l})=>({gizmo:l,section:C.Keep}))??[]],f=r[v.Recent]?.slice(0,d||n?r[v.Recent]?.length:Qe).map(({resource:l})=>({gizmo:l,section:C.Recents}))??[],x=f.length,t=m.length,b=d?x>0:s.length>o;let a=[];return i&&d?a=[...m,...f]:!i&&d?a=m:(a=[...m,...f],g||(a.length>o&&t>o?a=a.slice(0,t):a.length>o&&(a=a.slice(0,o)))),{listItems:a,itemsLeft:s.length-a.length,needsToCollapseItems:b,total:s.length}}function Z({gizmo:s,currentGizmoId:i,maxToShowOnLoad:n,hideOverflowMenu:o=!1}){const d=c.useRef(!1),g=!n,r=ee(),[m,f]=c.useState(!1),x=P(u=>!Se.isGptListCollapsed(u)),{listItems:t,needsToCollapseItems:b,itemsLeft:a}=K({gizmos:s,isGizmoFlyout:g,isLoaded:m,maxToShowOnLoad:n,isScreenArch:r,showAllSidebarItems:x});c.useEffect(()=>{m||f(!0)},[m]),c.useEffect(()=>{t.length>0&&!d.current&&(be({namespace:je.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),d.current=!0)},[t]);function l(u,p){const h=e.jsx(Je,{gizmo:u,isActive:u.gizmo.id===i,section:p,hideOverflowMenu:o},u.gizmo.id);return r?e.jsx("li",{children:h}):h}return e.jsxs("div",{children:[t.map(({gizmo:u,section:p},h)=>e.jsxs(c.Fragment,{children:[h>1&&p!==t[h-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),l(u,p)]},h)),!r&&b?e.jsxs("button",{onClick:_.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(R,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:x?e.jsxs(e.Fragment,{children:[e.jsx(k,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(He,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:a}}),e.jsx(Ke,{className:"icon-xs"})]})})]}):null,!r&&e.jsx(H,{})]})}function Ve({currentGizmoId:s,gizmos:i,onClick:n}){const{isSidebarFlyoutOpen:o,onSidebarFlyoutOpenChange:d}=Ce(),g=o(S.Gizmo),r=ye();return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(se,{onOpenChange:m=>d(S.Gizmo,m),side:r?"bottom":"right",sideOffset:4,open:g,contentAlign:"end",triggerButton:e.jsxs("button",{className:z("flex flex-1 select-none items-center gap-2.5 rounded-lg px-2 py-[7px] text-body tracking-condensed text-token-text-secondary ease-[var(--spring-bounce)] hover:bg-token-main-surface-secondary focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",g&&"bg-token-main-surface-secondary"),onClick:n,children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx(R,{className:z("icon-md font-semibold text-token-sidebar-icon")})})}),e.jsx("span",{className:"text-left",children:e.jsx(k,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(w,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(Z,{gizmo:i,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function Xe({currentGizmoId:s}){const{data:{gizmos:i}={}}=ze();let n=i;const{needsToCollapseItems:o}=K({gizmos:n??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return e.jsx(e.Fragment,{children:e.jsxs(Ie,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(k,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(H,{}),e.jsx(Z,{gizmo:n??[],currentGizmoId:s,maxToShowOnLoad:ke}),o&&e.jsx(w,{children:e.jsx(Ve,{currentGizmoId:s,gizmos:n??[]})})]})})}function $e({clientThreadId:s}){const i=O(),n=te(s),{isUnauthenticated:o}=A();return o?null:e.jsxs("div",{className:z(I.screenContent),children:[null,null,e.jsx(Me,{clientThreadId:s}),i?.canInteractWithGizmos()?e.jsx(Xe,{currentGizmoId:n}):null,!1]})}function es(){const s=O(),i=s?.data==null,{isUnauthenticated:n}=A(),{openSettings:o}=Ne(),[d]=c.useState(()=>{const t=ae.getCookie(ne.Workspace);return typeof t=="string"&&t!==ie}),g=G(),{store:r,actions:m}=U(),f=r(t=>t.mode);if(!s||d&&i)return null;const x=n?e.jsx(Ye,{}):e.jsx(Ze,{onClickSettings:()=>o()});return e.jsxs(D,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[x,e.jsx("div",{className:I.togglePinWrapper,children:e.jsx(Ge,{tooltipSideOffset:14,className:I.pinSidebarAction,icon:e.jsx(Oe,{}),onActivate:t=>{t.preventDefault(),t.persist(),Fe.togglePinSidebar(t,m,f===y.Floating?y.Pinned:y.Floating)},label:f===y.Floating?g.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):g.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:E.FloatingOrPinned})})]})}function ss(){return e.jsx(D,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(qe,{})})}function ts(){return e.jsxs(Te,{className:z(I.screenTrailingBarContainer),children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(es,{})]})}function ds(){const{clientThreadId:s,onNewThread:i}=B(),[n,o]=c.useState(!1),[d,g]=c.useState(!1),[r,m]=c.useState(!1),{store:f}=U(),x=c.useCallback(a=>a===S.Conversation?n:a===S.Gizmo?d:a===S.Conversation2?r:!1,[n,d,r]),t=c.useCallback((a,l)=>{const u=p=>{a===S.Conversation?o(p):a===S.Gizmo?g(p):a===S.Conversation2&&m(p)};l?u(!0):setTimeout(()=>{u(!1)},100)},[]),b=c.useRef(null);return we((a,l)=>{t(S.Conversation,!1),t(S.Gizmo,!1),t(S.Conversation2,!1);const u=window.matchMedia("(max-width: 700px)").matches,p=Be(b.current);l!=null&&u&&f.getState().isSidebarOpen&&(f.getState().mode===y.Floating||p)&&setTimeout(()=>{document.getElementById(E.OpenOrClosed)?.click()},100)}),e.jsxs(Ae,{value:{isSidebarFlyoutOpen:x,onSidebarFlyoutOpenChange:t},children:[e.jsx(Ee,{}),e.jsx(Pe,{anchor:"vertical",className:z(I.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(_e,{onNewThread:i}),ref:b,trackLeading:!0,trailing:e.jsx(ts,{}),children:e.jsx($e,{clientThreadId:s})})]})}export{ds as C,Z as G};
//# sourceMappingURL=h51ekr9uo3fuans1.js.map
