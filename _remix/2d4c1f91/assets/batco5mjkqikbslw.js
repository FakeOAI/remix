const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kkizjqmer3nufm0p.js","assets/gqmy69lfum1xn3in.js","assets/i4z8naqcr3t3djqa.js","assets/root-dcq62fgs.css","assets/d4csy61zb3bg00vm.js","assets/icnxn2xqcp3w18gd.js","assets/conversation-small-ict01xsi.css","assets/j227w6l3b2pn3ia0.js","assets/gvt29ccgnn9ozjnb.js","assets/hmx43jrf0ugj575q.js","assets/obxf2z7dfyt6736c.js","assets/bxirhx0fjaukusoi.js","assets/wk2ugqlasqmex1ht.js","assets/w66zz6tw9lx2rsa1.js","assets/hdn1awdxz2kxk5zs.js","assets/e67pohch4eo5p8ua.js","assets/is-scrollable-element-i34sjb0l.css","assets/eys53ek1xfuj2qu2.js","assets/gt1nd5d752xxormd.js","assets/i5v48a1mcjul24c4.js","assets/code-composer-ne11stli.css","assets/on4x2khaps8sjitk.js","assets/pecthdiuo9dc8q4p.js","assets/k5hnhzujhqf0i4aq.js","assets/igvm3j3d34n6yxg9.js","assets/l1l7138jxqsxecdx.js","assets/dhyjmgmeeztgicru.js","assets/dcq6opmm2fdie4vr.js","assets/lavist5b3jb0daxk.js","assets/n1i2rzi2bxwwu41n.js","assets/document-composer-ofhzvcxp.css","assets/ilte4zfawaj4noly.js","assets/mrx8u80hpunr7ux9.js","assets/d3y72ugnrmac5z1v.js","assets/i7utccinsv890y27.js","assets/e9lafxuzyeh4418f.js","assets/cctttvu6l9fe5ino.js","assets/j5w4166bn3c02o6l.js","assets/sso-kd6s8mrtse4xhjco.js","assets/lixsqsf92vxrz44h.js","assets/fwlffwb8x61oidmk.js","assets/dxo7jh8g6yhf5o3w.js","assets/nd0vf5z6jty2a64o.js","assets/c0eimf7twbjv80ig.js","assets/itghwucfyv5ciib7.js","assets/m0w87alh0nqnzbre.js","assets/gk2hjig0je5svcif.js","assets/cwpixm22y0dtg212.js","assets/983a0dy92b3ronpv.js","assets/eqioprfiyr5t7wpr.js","assets/kqwdyvkaaavvn8k3.js","assets/u2yzjc5fk8e8a6w2.js","assets/jvjd9j7by7k06xb0.js","assets/e47w1p65in2qrt7m.js","assets/fshrbah8t1r8n219.js","assets/lsd1w8334od0c87y.js","assets/nsqezb0hiq5olebv.js","assets/kl925td8j57j74za.js","assets/of5yvzdmhv2g7t68.js","assets/iej0cupg2dqkmejt.js","assets/olsry4yry895u1z3.js","assets/tqmapdd5thvqq76y.js","assets/jk8w36bsokizpx57.js","assets/cqwq471r9dns5tsd.js"])))=>i.map(i=>d[i]);
import{j as t,ar as A,aw as re,r as u,Y as q,aY as ee,X as _e,aE as ve,aF as be,fJ as js,aO as ks,d as G,g2 as Ms,g3 as ws,aG as T,c4 as Es,D as Is,fZ as Ts,f_ as _s,bU as Ns,g4 as As,at as ne,g5 as Be,bD as ae,bE as Rs,g6 as Ps,cR as Fs,m as Tt,bG as Ne,a8 as le,Z as _t,cw as Ds,cu as Os,b8 as D,b0 as ke,dK as Nt,P as U,S as Me,ck as At,a3 as Je,aZ as Rt,R as dt,N as Pt,aB as et,ao as Ft,bJ as Bs,K as Ls,ab as Ws,dA as $s,bs as we,a7 as Us,dF as Hs,y as Vs,ac as Gs,aa as qs,aK as Ke,fE as zs}from"./gqmy69lfum1xn3in.js";import{kg as Ks,br as Qs,kA as Ys,kB as Xs,kb as Zs,kC as Js,bJ as Ae,kh as Dt,kf as en,kD as tn,kE as mt,fW as sn,fV as nn,kF as an,fC as on,kG as rn,kH as Ot,kI as ln,ki as ft,Z as cn,j_ as Bt,kJ as un,ky as dn,fL as mn,kK as fn,kL as gn,kM as xn,kN as pn,kO as hn,fN as vn,kz as bn,fF as yn,kP as Sn,hf as Cn,hh as jn,hg as kn,hq as Mn,iL as Lt,kQ as Wt,kR as wn,kS as gt,fG as Qe,kT as En,kU as In,kV as Tn,kW as _n,kX as Nn,kY as An,kZ as Rn,k_ as Pn,k$ as Fn,l0 as Dn,U as X,k8 as On,k5 as Le,l1 as We,l2 as Bn,l3 as Ln,l4 as Wn,k4 as $n,l5 as Un,hG as Hn,ka as Vn,l6 as Gn,l7 as qn,k7 as zn,hu as $e,bn as Kn,l8 as Qn,l9 as Yn,la as Ce,lb as Xn,lc as $t,ld as Ue,le as Zn,lf as Jn,aK as oe,lg as ea,lh as ta,li as sa,am as L,lj as Ut,af as xt,ag as ie,ah as Re,ar as na,aS as aa,aT as oa,au as ra,av as Ht,aw as Ee,ax as ce,aJ as la,aU as B,lk as $,aV as ia,ay as ca,az as ua,aA as da,aC as Vt,aB as ma,aj as fa,aG as ga,aH as xa,aL as pa,aM as ha,ll as va,lm as ba,ln as ya,lo as Sa,aO as pt,lp as Gt,aP as Ca,aI as ja,aR as ka,lq as Ma,lr as wa,ls as Ea,lt as qt,lu as Ia,lv as Ta,lw as He,lx as _a,g0 as Na,a$ as ye,m as tt,c4 as st,c as Aa,j1 as nt,cE as zt,c5 as Ra,c6 as ht,p as Kt,ly as Qt,lz as Yt,lA as Xt,lB as Zt,lC as Pa,aa as Jt,cQ as Fa,lD as Da,q as es,lE as ts,lF as Oa,lG as Ba,iG as La,a as ss,e as Wa,C as Ye,lH as vt,T as $a,lI as Ua,lJ as Ha,lK as Va,A as Ga,lL as qa,df as za,lM as Ka,lN as Qa,v as Y,lO as Ya,bZ as Xa,lP as Za,lQ as Ja,lR as eo,jH as to,lS as so,lT as no,a8 as ao,iK as oo,jK as ro,cj as lo,dO as io,fo as co,cT as uo,fp as mo,hT as fo,lU as go,k0 as xo,lV as po,bM as ns,eP as as,n as ho,o as vo,b4 as bo,de as yo,lW as So,lX as Co,cf as jo,lY as ko,lZ as bt,c2 as yt,l_ as Mo}from"./icnxn2xqcp3w18gd.js";import{T as wo,b as Eo,g as Io,bH as To,d as _o,ag as No,s as Ao,L as Ro,Z as Po,r as Fo,b7 as os,bw as rs,bC as ls,bX as is,G as Do,aF as cs,bs as Oo,aE as us,bt as Bo,a3 as Lo,bx as Wo,bG as $o,ax as Uo,Y as ds,bd as Ve}from"./i4z8naqcr3t3djqa.js";import{B as Ho,T as Vo,I as Go}from"./gt1nd5d752xxormd.js";import{P as Ie}from"./i5v48a1mcjul24c4.js";import{m as Te}from"./gvt29ccgnn9ozjnb.js";function qo({className:e,zIndexKey:s,onClick:n}){return t.jsx(Te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:A("absolute inset-0",e,Ks[s]),onClick:n})}function zo({zIndexKey:e,onClick:s}){return t.jsx(qo,{zIndexKey:e,onClick:s,className:"bg-gray-50/50 dark:bg-black/50"})}const Ko=({onScroll:e})=>(Ys(({scrollTop:s})=>{e?.(s)}),null),Qo=({shouldScrollToTop:e})=>{const s=Xs();return u.useEffect(()=>{e===!0&&s({behavior:"smooth"})},[e,s]),null},Yo=()=>{const e=Zs();u.useEffect(()=>{e({behavior:"smooth"})},[e]);const[s]=Js();return s?null:t.jsx("button",{onClick:()=>e({behavior:"smooth"}),className:"absolute bottom-5 right-1/2 z-10 flex h-8 w-8 translate-x-1/2 cursor-pointer items-center justify-center rounded-full border border-token-border-light bg-token-main-surface-primary bg-clip-padding text-token-text-secondary",children:t.jsx(wo,{className:"icon-md text-token-text-primary"})})},Xo=re.section`w-full h-full flex flex-col popover bg-token-main-surface-primary`,Zo=({children:e,onScroll:s,shouldScrollToTop:n,scrollToBottomMode:a="top",isLoading:o=!1},r)=>t.jsxs("main",{className:"relative flex min-h-0 flex-auto flex-grow flex-col",ref:r,children:[t.jsx(Qs,{children:o&&t.jsx(zo,{zIndexKey:"textdocDiffLoadingOverlay"})}),t.jsxs(Ho,{followButtonClassName:"hidden",initialScrollBehavior:"auto",className:"h-full",mode:a,children:[e,a==="bottom"&&t.jsx(Yo,{}),t.jsx(Ko,{onScroll:s}),t.jsx(Qo,{shouldScrollToTop:n})]})]}),Jo=u.forwardRef(Zo),er=re.header`flex items-center justify-between p-3 h-14`,tr=re.h2`ml-2.5 text-base text-lg text-gray-700 dark:text-token-text-secondary truncate`,sr=({onClick:e})=>{const s=q();return t.jsx(ee,{label:s.formatMessage(nr.close),children:t.jsx(Ae,{icon:Eo,onClick:e})})},de=({children:e})=>t.jsx(Xo,{children:e});de.Title=tr;de.CloseButton=sr;de.Header=er;de.Content=Jo;const nr=_e({close:{id:"Bix/Kd",defaultMessage:"Close"}}),ar=ve(()=>be(()=>import("./kkizjqmer3nufm0p.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.CodeComposer),{loading:()=>t.jsx("div",{className:Dt.code,children:t.jsx("div",{className:"h-full w-full px-4",children:t.jsx(Ie,{lines:20})})})}),or=e=>t.jsx(ar,{...e}),ms=()=>{const[{width:e},s]=en(),n=e>=mt+sn?mt:nn;return t.jsx("div",{className:A(Dt.document,"mt-4"),ref:s,style:{margin:`0 ${tn}px`},children:t.jsx("div",{style:{width:n},children:t.jsx(Ie,{lines:20})})})},rr=ve(()=>be(()=>import("./on4x2khaps8sjitk.js"),__vite__mapDeps([21,1,2,3,11,5,6,10,4,7,8,12,13,14,15,16,22,23,24,25,26,27,28,29,18,19,30])).then(e=>e.DocumentComposer),{loading:ms}),lr=e=>t.jsx(rr,{...e}),ir=({onScroll:e,textdocId:s})=>{const n=an(s),{windowWidth:a}=js(d=>d,{windowWidth:0,windowHeight:0});if(!n)return null;const{versions:o}=n,r=on(o),l=rn(r);let i=null;switch(r?.type){case Bt.DOCUMENT:i=t.jsx(lr,{value:r.content,comments:[],isRequestActive:l,isPreview:!0,isDisabled:!0,hideAccelerators:!0,commentsMode:ft.ALL_HIDDEN,hideToolbar:!0,hideEditOverlay:!0,width:a,modelCursor:r.modelCursor});break;default:r&&Ot(r.type)&&(i=t.jsx(or,{id:"codemirror",currentlyStreamingLineIndex:null,language:ln(r.type),value:r.content,commentsMode:ft.ALL_HIDDEN,hideToolbar:!0,hideAccelerators:!0,comments:[],readonlyReason:cn.Streaming,isRequestActive:l}))}return t.jsx(de,{children:t.jsx(de.Content,{onScroll:e,children:i})})},cr=u.memo(ir);function ur(e,s){switch(e){case"presentation":return t.jsx(hn,{});case"table":return t.jsx(pn,{});case"chart":return t.jsx(xn,{});case Bt.DOCUMENT:return t.jsx(Io,{className:A("icon-md",{"text-token-text-primary":s,"text-token-text-tertiary":!s})});default:return Ot(e)?t.jsx(fn,{className:A("icon-md",{"text-token-text-primary":s,"text-token-text-tertiary":!s})}):t.jsx(gn,{})}}const dr=({isHovered:e=!1})=>{const s=q();return t.jsx(ee,{label:s.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:t.jsx(Te.div,{role:"button",animate:{opacity:e?1:.64},whileHover:{opacity:1},transition:{type:"tween",duration:.18},className:"text-token-text-secondary transition-colors",children:t.jsx(To,{className:"icon-md"})})})},mr=({isCanvasOpen:e,isFocused:s,isHovered:n,isInlinePreview:a,size:o})=>e?s?"0px 2px 6px 0px rgba(0, 0, 0, 0.06)":"0px 2px 6px 0px rgba(0, 0, 0, 0)":a?n||s?`0px ${o==="large"?12:4}px ${o==="large"?32:10}px 0px rgba(0, 0, 0, 0.064)`:`0px ${o==="large"?6:4}px ${o==="large"?14:4}px 0px rgba(0, 0, 0, 0.04)`:"0px 2px 6px 0px rgba(0, 0, 0, 0)",fr=({textdocId:e,isInlinePreview:s=!1,isStreaming:n=!1,isDisabled:a=!1,isFocused:o=!1,isCanvasOpen:r=!1,marginBottom:l,size:i="large",onClick:d,children:g,name:m,type:b})=>{const c=u.useRef(null),[f,p]=u.useState(!1),[h]=u.useState(()=>un(100,180,!1)),{resolvedTheme:v}=ks(),S=v==="dark",M=b?t.jsx("span",{className:A("flex-shrink-0 transition-[filter]",{grayscale:!o&&!f}),children:ur(b,o&&r)}):t.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center overflow-hidden",children:t.jsx(Ie,{lines:1,size:"base",width:100,widthVariance:0})}),x=m?t.jsx("span",{className:"min-w-0 truncate",children:m}):t.jsx("div",{className:"flex h-5 flex-grow items-center overflow-hidden",style:{width:h},children:t.jsx(Ie,{lines:1,size:"base",width:100,widthVariance:0})}),y=n&&t.jsx(dn,{size:20,className:A("flex-shrink-0",o?"text-blue-selection":"text-token-text-secondary")}),k=()=>{!c.current||a||(vn.logButtonClick(bn.MESSAGE_ATTACHMENT,{type:b}),yn(c.current),d?.())},j=i==="large"?100:50,E=`${S?"rgba(0,0,0,0)":"rgba(255,255,255,0)"}, ${S?"#2f2f2f":"#ffffff"}`;return t.jsxs(Te.div,{role:"button",id:mn(e),initial:{opacity:n?0:1,scale:n?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:.72},className:A("popover relative flex select-none flex-col overflow-hidden border bg-token-main-surface-primary transition-shadow duration-500",a?"cursor-default":"cursor-pointer",{"border-token-text-tertiary font-medium dark:border-gray-600":o&&r,"font-regular":!o,"border-token-border-light":!f&&!o,"border-token-border-medium":f&&!o,"flex min-w-0 max-w-full flex-shrink flex-grow-0 items-center justify-between self-start rounded-xl":r||!s,"w-full rounded-2xl":!r&&s}),onMouseEnter:()=>!a&&p(!0),onMouseLeave:()=>p(!1),onClick:k,ref:c,style:{marginBottom:l,height:r||!s?void 0:i==="large"?"24rem":"10rem",width:i==="small"?"300px":void 0,boxShadow:mr({isCanvasOpen:r,isFocused:o,isHovered:f,isInlinePreview:s,size:i})},children:[t.jsxs("div",{className:A("flex w-full min-w-0 items-center justify-between gap-2 self-start border-token-border-light px-4 transition-colors duration-700",{"border-token-border-light":!f&&!o,"border-token-border-medium":f&&!o,"text-sm font-medium text-token-text-primary":!r&&f&&s,"py-2":r||!s,"py-3":!r&&s,"text-sm font-medium text-token-text-secondary":!r&&!f&&s}),children:[t.jsxs("div",{className:A("flex min-w-0 items-center",{"gap-2":r||!s,"gap-3.5":!r&&s}),children:[M,x]}),r?t.jsx(Te.span,{animate:y?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:y}):s&&!a?t.jsx(dr,{isHovered:f}):null]}),t.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!r&&g,s&&!r&&t.jsx("div",{className:"absolute bottom-0 z-20 h-24 w-full transition-colors",style:{height:j,background:`linear-gradient(${E})`}}),s&&i==="small"&&!r&&t.jsx("div",{className:"absolute bottom-0 right-0 top-0 z-20 transition-colors",style:{width:j,background:`linear-gradient(to right, ${E})`}})]})]})},gr=({type:e,name:s,isStreaming:n=!1,isFocused:a=!1,onClick:o,textdocId:r,isFetching:l=!1,isCanvasOpen:i=!1,isInlinePreview:d=!1})=>{const[g,m]=u.useState(!1),b=f=>{m(f>0)},c=i||!d?12:!i&&d?16:void 0;return t.jsx(fr,{name:s,isFocused:a,isCanvasOpen:i,textdocId:r,type:e,isInlinePreview:d,isStreaming:n,onClick:o,marginBottom:c,children:d&&t.jsx("div",{className:A("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-light":g,"border-transparent":!g}),children:l?t.jsx(ms,{}):!!r&&t.jsx(cr,{onScroll:b,textdocId:r})})})},xr=({textdocId:e})=>{const s=Sn(d=>d?.resolveTempTextdocId[e]??e),n=Cn(s),a=jn(s),o=kn();if(!n)return null;const r=()=>{Mn(s)},{title:l,type:i}=n;return t.jsx("div",{className:"flex w-full justify-end",children:t.jsx(gr,{textdocId:s,type:i,name:l,isFocused:a,isCanvasOpen:o,onClick:r,isInlinePreview:!0})})},pr=({messages:e})=>{const[s]=e,n=s?.message.metadata?.canvas;return!n||n.user_message_type!=null?null:t.jsx(t.Fragment,{children:n.pasted_textdocs?.map(({tempId:a})=>t.jsx(xr,{textdocId:a},a))})};function fs({attachments:e,citations:s,contentReferences:n,className:a,clientThreadId:o,displayParts:r,isCompletionInProgress:l,id:i,isActivelyStreaming:d,isUserTurn:g,turnIndex:m,isFeedbackEnabled:b,messages:c,onRequestMoreCompletions:f,parts:p,prevGroupedMessageType:h,prevGroupedMessages:v,showEditButton:S,onEnterEdit:M,size:x="medium"}){const y=Lt(),k=c.length>1,{flagSeverity:j,shouldHideContent:E}=Wt(k?void 0:c[0]),w=p.some(N=>N!==""),I=!w&&c[0].message.metadata?.content_references?.length===0,R=c[0].message.metadata?.targeted_reply_label??c[0].message.metadata?.targeted_reply;return u.useEffect(()=>{const N=c[0].message;if(N.author.metadata?.real_author===`tool:${wn.SEARCHGPT}`&&w){const H=N.metadata?.search_source;gt.logEvent(G.searchToolRequestTimeToFirstTextToken,o,N.id,{search_source:H},()=>{H===Ms.InstantQuery&&ws.logEvent(G.searchToolPageLoadTimeToFirstTextToken,{message_id:N.id})})}},[o,w,c]),u.useEffect(()=>{if(!I)switch(h){case Qe.Browsing:gt.logEvent(G.browsingTimeToFirstTextToken,o,c[0].message.id);break}},[I,c,o,h]),t.jsxs("div",{"data-message-author-role":c[0].message.author.role,"data-message-id":c[0].message.id,dir:"auto",className:A(a,"text-message flex w-full flex-col items-end gap-2 whitespace-normal break-words [.text-message+&]:mt-5"),"data-message-model-slug":c[0].message.metadata?.model_slug,children:[R&&t.jsxs("div",{className:"mb-1 ml-6 mt-1 flex items-start gap-1.5 text-sm font-normal text-token-text-tertiary sm:ml-7 lg:ml-8",children:[t.jsx(_o,{className:"icon-md mt-1 shrink-0"}),t.jsx("p",{className:"mr-2 line-clamp-3",children:R})]}),g&&y&&t.jsx(pr,{messages:c}),t.jsx(En,{messages:c}),t.jsx(hr,{parts:p,attachments:e,isUserTurn:g,isCompletionInProgress:l,turnIndex:m,displayParts:r,isActivelyStreaming:d,shouldHideContent:E,showEditButton:S,onEnterEdit:M,clientThreadId:o,id:i,isEmpty:I,prevGroupedMessageType:h,prevGroupedMessages:v,flagSeverity:j,messages:c,citations:s,contentReferences:n,size:x}),t.jsx(In,{message:k?void 0:c[0],id:i,isFeedbackEnabled:b,onRequestMoreCompletions:f,clientThreadId:o,isUserTurn:g}),t.jsx(Tn,{isUserTurn:g,message:k?void 0:c[0]}),!g&&!d&&v&&h===Qe.SearchResult&&t.jsx(_n,{messages:v})]})}function hr({clientThreadId:e,id:s,displayParts:n,isCompletionInProgress:a,turnIndex:o,isActivelyStreaming:r,shouldHideContent:l,showEditButton:i=!1,onEnterEdit:d,isEmpty:g,prevGroupedMessageType:m,prevGroupedMessages:b,messages:c,citations:f,contentReferences:p,size:h,isUserTurn:v,parts:S,attachments:M}){const x=q(),y=u.useRef(!1),k=Nn(n),[j,E]=u.useState({}),[w,I]=u.useState(!1),R=An(),{streamingContext:N}=Rn();u.useEffect(()=>{R&&(N.setOnStylesUpdatedCallback(E),N.onStreamingChanged(a),N.setOnResetCallback(()=>I(!1)),a&&(I(!0),E(N.createTopLevelStyles())))},[R,a,N]);const H=Pn(),_=c[0].message.metadata?.gizmo_id,O=c[0].message.metadata?.serialization_metadata,P=Fn(c[0].message).length,F=u.useMemo(()=>({clientThreadId:e,messageId:s,turnIndex:o}),[e,s,o]),C=Dn(c[0].message),Q=!!_&&H.includes(_),W=u.useCallback(()=>{X.toggleChatThreadFlyout(e,o,s)},[e,o,s]),V=t.jsx(Ln,{parts:S,attachments:M,isUserTurn:v,clientThreadId:e},"files-and-tables"),te=!!(M?.length||n.some(z=>z.type==="images")),fe=On();function ge(z,Z){const K=m===Qe.CodeInterpreter?b?.map(ue=>ue.message):void 0,{text:pe,contentReferences:De}=Wn(Z,f,p,Q);let lt=De;fe&&(lt=De.filter(ue=>ue.type!=="attribution"));const{processedText:Se,displayedContentReferences:it}=$n(pe,lt,r?void 0:K,!1,r);Se.includes(Un)&&!y.current&&(y.current=!0,Is.addError(new Error("Failed replaceTextWithDirectives"),{text:Se,displayedContentReferences:it}));const ct=c[0].message,ut=ct.metadata?.message_locale;let Oe=t.jsx(Hn,{clientThreadId:e,messageId:s,isStreamingOrProcessing:w,size:h,className:A(r&&!R&&"result-streaming",C&&"headers-v2"),children:Se===""?"&#8203;":Se});if(ut!=null){const ue=Ts(ut,!1);ue!=null&&(Oe=t.jsx(_s,{locale:ue,children:Oe}))}return t.jsx(Vn.Provider,{value:{analyticsMetadata:F,message:ct,contentReferences:it,onShowSearchResults:W,numImageResults:P,isActivelyStreaming:r,useSafeUrls:!0},children:Oe},z)}const xe=n.map((z,Z)=>{if(z.type==="transcription"){const K=l?null:z.text;let pe=null;if(v&&l)pe=t.jsx("span",{className:"italic opacity-30",children:t.jsx(T,{...je.contentRemoved})});else if(v&&K!=null)pe=K.trim().length===0?t.jsx("span",{className:"italic opacity-30",children:t.jsx(Le,{text:x.formatMessage(je.transcriptUnavailable),customSymbolOffsets:void 0})}):t.jsx("span",{className:"italic opacity-65",children:t.jsx(Le,{text:`“${K.trim()}”`,customSymbolOffsets:void 0})});else if(!v&&K!=null)return ge(Z,K);return t.jsx(We,{containsImagesOrAttachments:te,isUserTurn:v,showEditButton:i,onEnterEdit:d,children:pe},Z)}else if(z.type==="text"){const K=l?null:z.text;return!g&&!l&&!v?ge(Z,k):g&&r&&!v?R?t.jsx("div",{className:"pulsing-dot"},Z):t.jsx("div",{className:"result-streaming",children:t.jsx("span",{children:t.jsx("pre",{})})},Z):t.jsx(We,{containsImagesOrAttachments:te,isUserTurn:v,showEditButton:i,onEnterEdit:d,children:v&&l?t.jsx("span",{className:"italic opacity-30",children:t.jsx(T,{...je.contentRemoved})}):K?t.jsx(Le,{text:K,customSymbolOffsets:O?.custom_symbol_offsets}):null},Z)}else if(z.type==="images"){const K=c[0].message.metadata?.attachments??[];return t.jsx(Bn,{assets:z.imageAssets,attachments:K},Z)}else return null}),rt=n.findIndex(z=>z.type==="text");if(rt!==-1?xe.splice(rt,0,V):xe.push(V),l&&v)xe.length=0,xe.push(t.jsx(We,{containsImagesOrAttachments:te,isUserTurn:v,onEnterEdit:Es,children:t.jsx("span",{className:"italic opacity-30",children:t.jsx(T,{...je.contentRemoved})})}));else if(l&&!v)return null;return t.jsx("div",{className:A("flex w-full flex-col gap-1 empty:hidden",v&&"items-end rtl:items-start",!v&&"first:pt-[3px]",w&&"streaming-response"),style:j,children:xe})}const je=_e({contentRemoved:{id:"textMessage.contentRemoved",defaultMessage:"Content removed"},transcriptUnavailable:{id:"textMessage.transcriptUnavailable",defaultMessage:"Transcript Unavailable"}});function vr(e){const{isActivelyStreaming:s,...n}=e,a=Ns(),o=a?.includes("debug")??!1,r=e.messages[e.messages.length-1].message.id,[l,i]=u.useState(Gn(e.parts)),d=u.useRef(void 0);return d.current===void 0&&(d.current=a?.includes(As)??!1?new qn(e.parts,i,s,void 0,{debug:o}):new zn(e.parts,i,s)),u.useEffect(()=>{d.current!=null&&(d.current.onMessagePartsUpdated(e.parts,s),d.current.isBuffering()&&$e.addDelayedRenderingMessage(r))},[e.parts,r,s]),u.useEffect(()=>{d.current!=null&&!d.current.isBuffering()&&$e.removeDelayedRenderingMessage(r)},[l,r]),u.useEffect(()=>()=>$e.removeDelayedRenderingMessage(r),[r]),u.useEffect(()=>()=>{d.current!=null&&(d.current.destroy(),d.current=void 0)},[]),t.jsx(fs,{...n,displayParts:l,isActivelyStreaming:s||d.current?.isBuffering()})}function br({message:e,isCompletionInProgress:s,clientThreadId:n,className:a,isUserTurn:o,turnIndex:r,isFeedbackEnabled:l,prevGroupedMessageType:i,prevGroupedMessages:d,showEditButton:g,onEnterEdit:m,onRequestMoreCompletions:b}){const c=u.useMemo(()=>"parts"in e.message.content?e.message.content.parts:[Kn(e.message)],[e]);return t.jsx(yr,{parts:c,messages:[e],isCompletionInProgress:s,className:a,citations:e.message.metadata?.citations,contentReferences:e.message.metadata?.content_references,attachments:e.message.metadata?.attachments,isUserTurn:o,turnIndex:r,id:e.nodeId,isFeedbackEnabled:l,onRequestMoreCompletions:b,clientThreadId:n,showEditButton:g,onEnterEdit:m,prevGroupedMessageType:i,prevGroupedMessages:d})}const St=ne.memo(br);function yr(e){const s=e.messages.length>1,{flagSeverity:n}=Wt(s?void 0:e.messages[0]),a=n!=="danger"&&e.isCompletionInProgress,o=!e.parts.some(l=>l!==""),[r]=u.useState(()=>!e.isUserTurn&&(e.isCompletionInProgress||o));return r?t.jsx(vr,{...e,isActivelyStreaming:a}):t.jsx(fs,{...e,displayParts:Qn({isUserTurn:e.isUserTurn,parts:e.parts}),isActivelyStreaming:a})}const gs={...Rs},Sr=gs.useInsertionEffect,Cr=Sr||(e=>e());function xs(e){const s=u.useRef(()=>{});return Cr(()=>{s.current=e}),u.useCallback(function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return s.current==null?void 0:s.current(...a)},[])}var Xe=typeof document<"u"?u.useLayoutEffect:u.useEffect;let Ct=!1,jr=0;const jt=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+jr++;function kr(){const[e,s]=u.useState(()=>Ct?jt():void 0);return Xe(()=>{e==null&&s(jt())},[]),u.useEffect(()=>{Ct=!0},[]),e}const Mr=gs.useId,wr=Mr||kr;function Er(){const e=new Map;return{emit(s,n){var a;(a=e.get(s))==null||a.forEach(o=>o(n))},on(s,n){e.set(s,[...e.get(s)||[],n])},off(s,n){var a;e.set(s,((a=e.get(s))==null?void 0:a.filter(o=>o!==n))||[])}}}const Ir=u.createContext(null),Tr=u.createContext(null),_r=()=>{var e;return((e=u.useContext(Ir))==null?void 0:e.id)||null},Nr=()=>u.useContext(Tr),Ar="data-floating-ui-focusable";function Rr(e){const{open:s=!1,onOpenChange:n,elements:a}=e,o=wr(),r=u.useRef({}),[l]=u.useState(()=>Er()),i=_r()!=null,[d,g]=u.useState(a.reference),m=xs((f,p,h)=>{r.current.openEvent=f?p:void 0,l.emit("openchange",{open:f,event:p,reason:h,nested:i}),n?.(f,p,h)}),b=u.useMemo(()=>({setPositionReference:g}),[]),c=u.useMemo(()=>({reference:d||a.reference||null,floating:a.floating||null,domReference:a.reference}),[d,a.reference,a.floating]);return u.useMemo(()=>({dataRef:r,open:s,onOpenChange:m,elements:c,events:l,floatingId:o,refs:b}),[s,m,c,l,o,b])}function Pr(e){e===void 0&&(e={});const{nodeId:s}=e,n=Rr({...e,elements:{reference:null,floating:null,...e.elements}}),a=e.rootContext||n,o=a.elements,[r,l]=u.useState(null),[i,d]=u.useState(null),m=o?.reference||r,b=u.useRef(null),c=Nr();Xe(()=>{m&&(b.current=m)},[m]);const f=Yn({...e,elements:{...o,...i&&{reference:i}}}),p=u.useCallback(x=>{const y=Ce(x)?{getBoundingClientRect:()=>x.getBoundingClientRect(),contextElement:x}:x;d(y),f.refs.setReference(y)},[f.refs]),h=u.useCallback(x=>{(Ce(x)||x===null)&&(b.current=x,l(x)),(Ce(f.refs.reference.current)||f.refs.reference.current===null||x!==null&&!Ce(x))&&f.refs.setReference(x)},[f.refs]),v=u.useMemo(()=>({...f.refs,setReference:h,setPositionReference:p,domReference:b}),[f.refs,h,p]),S=u.useMemo(()=>({...f.elements,domReference:m}),[f.elements,m]),M=u.useMemo(()=>({...f,...a,refs:v,elements:S,nodeId:s}),[f,v,S,s,a]);return Xe(()=>{a.dataRef.current.floatingContext=M;const x=c?.nodesRef.current.find(y=>y.id===s);x&&(x.context=M)}),u.useMemo(()=>({...f,context:M,refs:v,elements:S}),[f,v,S,M])}const kt="active",Mt="selected";function Ge(e,s,n){const a=new Map,o=n==="item";let r=e;if(o&&e){const{[kt]:l,[Mt]:i,...d}=e;r=d}return{...n==="floating"&&{tabIndex:-1,[Ar]:""},...r,...s.map(l=>{const i=l?l[n]:null;return typeof i=="function"?e?i(e):null:i}).concat(e).reduce((l,i)=>(i&&Object.entries(i).forEach(d=>{let[g,m]=d;if(!(o&&[kt,Mt].includes(g)))if(g.indexOf("on")===0){if(a.has(g)||a.set(g,[]),typeof m=="function"){var b;(b=a.get(g))==null||b.push(m),l[g]=function(){for(var c,f=arguments.length,p=new Array(f),h=0;h<f;h++)p[h]=arguments[h];return(c=a.get(g))==null?void 0:c.map(v=>v(...p)).find(v=>v!==void 0)}}}else l[g]=m}),l),{})}}function Fr(e){e===void 0&&(e=[]);const s=e.map(i=>i?.reference),n=e.map(i=>i?.floating),a=e.map(i=>i?.item),o=u.useCallback(i=>Ge(i,e,"reference"),s),r=u.useCallback(i=>Ge(i,e,"floating"),n),l=u.useCallback(i=>Ge(i,e,"item"),a);return u.useMemo(()=>({getReferenceProps:o,getFloatingProps:r,getItemProps:l}),[o,r,l])}function wt(e,s){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:s}}}}const Dr=e=>({name:"inner",options:e,async fn(s){const{listRef:n,overflowRef:a,onFallbackChange:o,offset:r=0,index:l=0,minItemsVisible:i=4,referenceOverflowThreshold:d=0,scrollRef:g,...m}=Xn(e,s),{rects:b,elements:{floating:c}}=s,f=n.current[l],p=g?.current||c,h=c.clientTop||p.clientTop,v=c.clientTop!==0,S=p.clientTop!==0,M=c===p;if(!f)return{};const x={...s,...await $t(-f.offsetTop-c.clientTop-b.reference.height/2-f.offsetHeight/2-r).fn(s)},y=await Be(wt(x,p.scrollHeight+h+c.clientTop),m),k=await Be(x,{...m,elementContext:"reference"}),j=Ue(0,y.top),E=x.y+j,w=Zn(Ue(0,p.scrollHeight+(v&&M||S?h*2:0)-j-Ue(0,y.bottom)));if(p.style.maxHeight=w+"px",p.scrollTop=j,o){const I=p.scrollHeight>p.offsetHeight&&p.offsetHeight<f.offsetHeight*i-1||k.top>=-d||k.bottom>=-d;ae.flushSync(()=>o(I))}return a&&(a.current=await Be(wt({...x,y:E},p.offsetHeight+h+c.clientTop),m)),{y:E}}});function Or(e,s){const{open:n,elements:a}=e,{enabled:o=!0,overflowRef:r,scrollRef:l,onChange:i}=s,d=xs(i),g=u.useRef(!1),m=u.useRef(null),b=u.useRef(null);u.useEffect(()=>{if(!o)return;function f(h){if(h.ctrlKey||!p||r.current==null)return;const v=h.deltaY,S=r.current.top>=-.5,M=r.current.bottom>=-.5,x=p.scrollHeight-p.clientHeight,y=v<0?-1:1,k=v<0?"max":"min";p.scrollHeight<=p.clientHeight||(!S&&v>0||!M&&v<0?(h.preventDefault(),ae.flushSync(()=>{d(j=>j+Math[k](v,x*y))})):/firefox/i.test(Jn())&&(p.scrollTop+=v))}const p=l?.current||a.floating;if(n&&p)return p.addEventListener("wheel",f),requestAnimationFrame(()=>{m.current=p.scrollTop,r.current!=null&&(b.current={...r.current})}),()=>{m.current=null,b.current=null,p.removeEventListener("wheel",f)}},[o,n,a.floating,r,l,d]);const c=u.useMemo(()=>({onKeyDown(){g.current=!0},onWheel(){g.current=!1},onPointerMove(){g.current=!1},onScroll(){const f=l?.current||a.floating;if(!(!r.current||!f||!g.current)){if(m.current!==null){const p=f.scrollTop-m.current;(r.current.bottom<-.5&&p<-1||r.current.top<-.5&&p>1)&&ae.flushSync(()=>d(h=>h+p))}requestAnimationFrame(()=>{m.current=f.scrollTop})}}}),[a.floating,d,r,l]);return u.useMemo(()=>o?{floating:c}:{},[o,c])}let me=u.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});me.displayName="FloatingContext";let at=u.createContext(null);at.displayName="PlacementContext";function Br(e){return u.useMemo(()=>e?typeof e=="string"?{to:e}:e:null,[e])}function Lr(){return u.useContext(me).setReference}function Wr(){return u.useContext(me).getReferenceProps}function $r(){let{getFloatingProps:e,slot:s}=u.useContext(me);return u.useCallback((...n)=>Object.assign({},e(...n),{"data-anchor":s.anchor}),[e,s])}function Ur(e=null){e===!1&&(e=null),typeof e=="string"&&(e={to:e});let s=u.useContext(at),n=u.useMemo(()=>e,[JSON.stringify(e,(o,r)=>{var l;return(l=r?.outerHTML)!=null?l:r})]);oe(()=>{s?.(n??null)},[s,n]);let a=u.useContext(me);return u.useMemo(()=>[a.setFloating,e?a.styles:{}],[a.setFloating,e,a.styles])}let Et=4;function Hr({children:e,enabled:s=!0}){let[n,a]=u.useState(null),[o,r]=u.useState(0),l=u.useRef(null),[i,d]=u.useState(null);Vr(i);let g=s&&n!==null&&i!==null,{to:m="bottom",gap:b=0,offset:c=0,padding:f=0,inner:p}=Gr(n,i),[h,v="center"]=m.split(" ");oe(()=>{g&&r(0)},[g]);let{refs:S,floatingStyles:M,context:x}=Pr({open:g,placement:h==="selection"?v==="center"?"bottom":`bottom-${v}`:v==="center"?`${h}`:`${h}-${v}`,strategy:"absolute",transform:!1,middleware:[$t({mainAxis:h==="selection"?0:b,crossAxis:c}),ea({padding:f}),h!=="selection"&&ta({padding:f}),h==="selection"&&p?Dr({...p,padding:f,overflowRef:l,offset:o,minItemsVisible:Et,referenceOverflowThreshold:f,onFallbackChange(N){var H,_;if(!N)return;let O=x.elements.floating;if(!O)return;let P=parseFloat(getComputedStyle(O).scrollPaddingBottom)||0,F=Math.min(Et,O.childElementCount),C=0,Q=0;for(let W of(_=(H=x.elements.floating)==null?void 0:H.childNodes)!=null?_:[])if(W instanceof HTMLElement){let V=W.offsetTop,te=V+W.clientHeight+P,fe=O.scrollTop,ge=fe+O.clientHeight;if(V>=fe&&te<=ge)F--;else{Q=Math.max(0,Math.min(te,ge)-Math.max(V,fe)),C=W.clientHeight;break}}F>=1&&r(W=>{let V=C*F-Q+P;return W>=V?W:V})}}):null,sa({padding:f,apply({availableWidth:N,availableHeight:H,elements:_}){Object.assign(_.floating.style,{overflow:"auto",maxWidth:`${N}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${H}px)`})}})].filter(Boolean),whileElementsMounted:Ps}),[y=h,k=v]=x.placement.split("-");h==="selection"&&(y="selection");let j=u.useMemo(()=>({anchor:[y,k].filter(Boolean).join(" ")}),[y,k]),E=Or(x,{overflowRef:l,onChange:r}),{getReferenceProps:w,getFloatingProps:I}=Fr([E]),R=L(N=>{d(N),S.setFloating(N)});return u.createElement(at.Provider,{value:a},u.createElement(me.Provider,{value:{setFloating:R,setReference:S.setReference,styles:M,getReferenceProps:w,getFloatingProps:I,slot:j}},e))}function Vr(e){oe(()=>{if(!e)return;let s=new MutationObserver(()=>{let n=window.getComputedStyle(e).maxHeight,a=parseFloat(n);if(isNaN(a))return;let o=parseInt(n);isNaN(o)||a!==o&&(e.style.maxHeight=`${Math.ceil(a)}px`)});return s.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{s.disconnect()}},[e])}function Gr(e,s){var n,a,o;let r=qe((n=e?.gap)!=null?n:"var(--anchor-gap, 0)",s),l=qe((a=e?.offset)!=null?a:"var(--anchor-offset, 0)",s),i=qe((o=e?.padding)!=null?o:"var(--anchor-padding, 0)",s);return{...e,gap:r,offset:l,padding:i}}function qe(e,s,n=void 0){let a=Ut(),o=L((d,g)=>{if(d==null)return[n,null];if(typeof d=="number")return[d,null];if(typeof d=="string"){if(!g)return[n,null];let m=It(d,g);return[m,b=>{let c=ps(d);{let f=c.map(p=>window.getComputedStyle(g).getPropertyValue(p));a.requestAnimationFrame(function p(){a.nextFrame(p);let h=!1;for(let[S,M]of c.entries()){let x=window.getComputedStyle(g).getPropertyValue(M);if(f[S]!==x){f[S]=x,h=!0;break}}if(!h)return;let v=It(d,g);m!==v&&(b(v),m=v)})}return a.dispose}]}return[n,null]}),r=u.useMemo(()=>o(e,s)[0],[e,s]),[l=r,i]=u.useState();return oe(()=>{let[d,g]=o(e,s);if(i(d),!!g)return g(i)},[e,s]),l}function ps(e){let s=/var\((.*)\)/.exec(e);if(s){let n=s[1].indexOf(",");if(n===-1)return[s[1]];let a=s[1].slice(0,n).trim(),o=s[1].slice(n+1).trim();return o?[a,...ps(o)]:[a]}return[]}function It(e,s){let n=document.createElement("div");s.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",e,"important");let a=parseFloat(window.getComputedStyle(n).marginTop)||0;return s.removeChild(n),a}var qr=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(qr||{}),zr=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(zr||{}),Kr=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetItemsElement=8]="SetItemsElement",e))(Kr||{});function ze(e,s=n=>n){let n=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,a=_a(s(e.items.slice()),r=>r.dataRef.current.domRef.current),o=n?a.indexOf(n):null;return o===-1&&(o=null),{items:a,activeItemIndex:o}}let Qr={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,s)=>{var n,a,o,r,l;if(e.menuState===1)return e;let i={...e,searchQuery:"",activationTrigger:(n=s.trigger)!=null?n:1,__demoMode:!1};if(s.focus===$.Nothing)return{...i,activeItemIndex:null};if(s.focus===$.Specific)return{...i,activeItemIndex:e.items.findIndex(m=>m.id===s.id)};if(s.focus===$.Previous){let m=e.activeItemIndex;if(m!==null){let b=e.items[m].dataRef.current.domRef,c=He(s,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});if(c!==null){let f=e.items[c].dataRef.current.domRef;if(((a=b.current)==null?void 0:a.previousElementSibling)===f.current||((o=f.current)==null?void 0:o.previousElementSibling)===null)return{...i,activeItemIndex:c}}}}else if(s.focus===$.Next){let m=e.activeItemIndex;if(m!==null){let b=e.items[m].dataRef.current.domRef,c=He(s,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});if(c!==null){let f=e.items[c].dataRef.current.domRef;if(((r=b.current)==null?void 0:r.nextElementSibling)===f.current||((l=f.current)==null?void 0:l.nextElementSibling)===null)return{...i,activeItemIndex:c}}}}let d=ze(e),g=He(s,{resolveItems:()=>d.items,resolveActiveIndex:()=>d.activeItemIndex,resolveId:m=>m.id,resolveDisabled:m=>m.dataRef.current.disabled});return{...i,...d,activeItemIndex:g}},3:(e,s)=>{let n=e.searchQuery!==""?0:1,a=e.searchQuery+s.value.toLowerCase(),o=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+n).concat(e.items.slice(0,e.activeItemIndex+n)):e.items).find(l=>{var i;return((i=l.dataRef.current.textValue)==null?void 0:i.startsWith(a))&&!l.dataRef.current.disabled}),r=o?e.items.indexOf(o):-1;return r===-1||r===e.activeItemIndex?{...e,searchQuery:a}:{...e,searchQuery:a,activeItemIndex:r,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,s)=>{let n=ze(e,a=>[...a,{id:s.id,dataRef:s.dataRef}]);return{...e,...n}},6:(e,s)=>{let n=ze(e,a=>{let o=a.findIndex(r=>r.id===s.id);return o!==-1&&a.splice(o,1),a});return{...e,...n,activationTrigger:1}},7:(e,s)=>e.buttonElement===s.element?e:{...e,buttonElement:s.element},8:(e,s)=>e.itemsElement===s.element?e:{...e,itemsElement:s.element}},ot=u.createContext(null);ot.displayName="MenuContext";function Pe(e){let s=u.useContext(ot);if(s===null){let n=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Pe),n}return s}function Yr(e,s){return Ht(s.type,Qr,e,s)}let Xr=u.Fragment;function Zr(e,s){let{__demoMode:n=!1,...a}=e,o=u.useReducer(Yr,{__demoMode:n,menuState:n?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:r,itemsElement:l,buttonElement:i},d]=o,g=Re(s);na(r===0,[i,l],(f,p)=>{d({type:1}),aa(p,oa.Loose)||(f.preventDefault(),i?.focus())});let m=L(()=>{d({type:1})}),b=u.useMemo(()=>({open:r===0,close:m}),[r,m]),c={ref:g};return ne.createElement(Hr,null,ne.createElement(ot.Provider,{value:o},ne.createElement(ra,{value:Ht(r,{0:Ee.Open,1:Ee.Closed})},ce({ourProps:c,theirProps:a,slot:b,defaultTag:Xr,name:"Menu"}))))}let Jr="button";function el(e,s){var n;let a=u.useId(),{id:o=`headlessui-menu-button-${a}`,disabled:r=!1,autoFocus:l=!1,...i}=e,[d,g]=Pe("Menu.Button"),m=Wr(),b=la(),c=Re(s,Lr(),L(w=>g({type:7,element:w}))),f=L(w=>{switch(w.key){case B.Space:case B.Enter:case B.ArrowDown:w.preventDefault(),w.stopPropagation(),ae.flushSync(()=>g({type:0})),g({type:2,focus:$.First});break;case B.ArrowUp:w.preventDefault(),w.stopPropagation(),ae.flushSync(()=>g({type:0})),g({type:2,focus:$.Last});break}}),p=L(w=>{switch(w.key){case B.Space:w.preventDefault();break}}),h=L(w=>{var I;if(ia(w.currentTarget))return w.preventDefault();r||(d.menuState===0?(ae.flushSync(()=>g({type:1})),(I=d.buttonElement)==null||I.focus({preventScroll:!0})):(w.preventDefault(),g({type:0})))}),{isFocusVisible:v,focusProps:S}=ca({autoFocus:l}),{isHovered:M,hoverProps:x}=ua({isDisabled:r}),{pressed:y,pressProps:k}=da({disabled:r}),j=u.useMemo(()=>({open:d.menuState===0,active:y||d.menuState===0,disabled:r,hover:M,focus:v,autofocus:l}),[d,M,v,y,r,l]),E=Vt(m(),{ref:c,id:o,type:ma(e,d.buttonElement),"aria-haspopup":"menu","aria-controls":(n=d.itemsElement)==null?void 0:n.id,"aria-expanded":d.menuState===0,disabled:r||void 0,autoFocus:l,onKeyDown:f,onKeyUp:p,onClick:h},S,x,k);return ce({mergeRefs:b,ourProps:E,theirProps:i,slot:j,defaultTag:Jr,name:"Menu.Button"})}let tl="div",sl=xt.RenderStrategy|xt.Static;function nl(e,s){var n,a;let o=u.useId(),{id:r=`headlessui-menu-items-${o}`,anchor:l,portal:i=!1,modal:d=!0,transition:g=!1,...m}=e,b=Br(l),[c,f]=Pe("Menu.Items"),[p,h]=Ur(b),v=$r(),[S,M]=u.useState(null),x=Re(s,b?p:null,L(C=>f({type:8,element:C})),M),y=fa(c.itemsElement);b&&(i=!0);let k=ga(),[j,E]=xa(g,S,k!==null?(k&Ee.Open)===Ee.Open:c.menuState===0);pa(j,c.buttonElement,()=>{f({type:1})});let w=c.__demoMode?!1:d&&c.menuState===0;ha(w,y);let I=c.__demoMode?!1:d&&c.menuState===0;va(I,{allowed:u.useCallback(()=>[c.buttonElement,c.itemsElement],[c.buttonElement,c.itemsElement])});let R=c.menuState!==0,N=ba(R,c.buttonElement)?!1:j;u.useEffect(()=>{let C=c.itemsElement;C&&c.menuState===0&&C!==y?.activeElement&&C.focus({preventScroll:!0})},[c.menuState,c.itemsElement,y]),ya(c.menuState===0,{container:c.itemsElement,accept(C){return C.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:C.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(C){C.setAttribute("role","none")}});let H=Ut(),_=L(C=>{var Q,W,V;switch(H.dispose(),C.key){case B.Space:if(c.searchQuery!=="")return C.preventDefault(),C.stopPropagation(),f({type:3,value:C.key});case B.Enter:if(C.preventDefault(),C.stopPropagation(),f({type:1}),c.activeItemIndex!==null){let{dataRef:te}=c.items[c.activeItemIndex];(W=(Q=te.current)==null?void 0:Q.domRef.current)==null||W.click()}Gt(c.buttonElement);break;case B.ArrowDown:return C.preventDefault(),C.stopPropagation(),f({type:2,focus:$.Next});case B.ArrowUp:return C.preventDefault(),C.stopPropagation(),f({type:2,focus:$.Previous});case B.Home:case B.PageUp:return C.preventDefault(),C.stopPropagation(),f({type:2,focus:$.First});case B.End:case B.PageDown:return C.preventDefault(),C.stopPropagation(),f({type:2,focus:$.Last});case B.Escape:C.preventDefault(),C.stopPropagation(),ae.flushSync(()=>f({type:1})),(V=c.buttonElement)==null||V.focus({preventScroll:!0});break;case B.Tab:C.preventDefault(),C.stopPropagation(),ae.flushSync(()=>f({type:1})),Sa(c.buttonElement,C.shiftKey?pt.Previous:pt.Next);break;default:C.key.length===1&&(f({type:3,value:C.key}),H.setTimeout(()=>f({type:4}),350));break}}),O=L(C=>{switch(C.key){case B.Space:C.preventDefault();break}}),P=u.useMemo(()=>({open:c.menuState===0}),[c.menuState]),F=Vt(b?v():{},{"aria-activedescendant":c.activeItemIndex===null||(n=c.items[c.activeItemIndex])==null?void 0:n.id,"aria-labelledby":(a=c.buttonElement)==null?void 0:a.id,id:r,onKeyDown:_,onKeyUp:O,role:"menu",tabIndex:c.menuState===0?0:void 0,ref:x,style:{...m.style,...h,"--button-width":Ca(c.buttonElement,!0).width},...ja(E)});return ne.createElement(ka,{enabled:i?e.static||j:!1},ce({ourProps:F,theirProps:m,slot:P,defaultTag:tl,features:sl,visible:N,name:"Menu.Items"}))}let al=u.Fragment;function ol(e,s){let n=u.useId(),{id:a=`headlessui-menu-item-${n}`,disabled:o=!1,...r}=e,[l,i]=Pe("Menu.Item"),d=l.activeItemIndex!==null?l.items[l.activeItemIndex].id===a:!1,g=u.useRef(null),m=Re(s,g);oe(()=>{if(!l.__demoMode&&l.menuState===0&&d&&l.activationTrigger!==0)return Ma().requestAnimationFrame(()=>{var I,R;(R=(I=g.current)==null?void 0:I.scrollIntoView)==null||R.call(I,{block:"nearest"})})},[l.__demoMode,g,d,l.menuState,l.activationTrigger,l.activeItemIndex]);let b=wa(g),c=u.useRef({disabled:o,domRef:g,get textValue(){return b()}});oe(()=>{c.current.disabled=o},[c,o]),oe(()=>(i({type:5,id:a,dataRef:c}),()=>i({type:6,id:a})),[c,a]);let f=L(()=>{i({type:1})}),p=L(I=>{if(o)return I.preventDefault();i({type:1}),Gt(l.buttonElement)}),h=L(()=>{if(o)return i({type:2,focus:$.Nothing});i({type:2,focus:$.Specific,id:a})}),v=Ea(),S=L(I=>{v.update(I),!o&&(d||i({type:2,focus:$.Specific,id:a,trigger:0}))}),M=L(I=>{v.wasMoved(I)&&(o||d||i({type:2,focus:$.Specific,id:a,trigger:0}))}),x=L(I=>{v.wasMoved(I)&&(o||d&&i({type:2,focus:$.Nothing}))}),[y,k]=qt(),[j,E]=Ia(),w=u.useMemo(()=>({active:d,focus:d,disabled:o,close:f}),[d,o,f]);return ne.createElement(k,null,ne.createElement(E,null,ce({ourProps:{id:a,ref:m,role:"menuitem",tabIndex:o===!0?void 0:-1,"aria-disabled":o===!0?!0:void 0,"aria-labelledby":y,"aria-describedby":j,disabled:void 0,onClick:p,onFocus:h,onPointerEnter:S,onMouseEnter:S,onPointerMove:M,onMouseMove:M,onPointerLeave:x,onMouseLeave:x},theirProps:r,slot:w,defaultTag:al,name:"Menu.Item"})))}let rl="div";function ll(e,s){let[n,a]=qt();return ne.createElement(a,null,ce({ourProps:{ref:s,"aria-labelledby":n,role:"group"},theirProps:e,slot:{},defaultTag:rl,name:"Menu.Section"}))}let il="header";function cl(e,s){let n=u.useId(),{id:a=`headlessui-menu-heading-${n}`,...o}=e,r=Ta();oe(()=>r.register(a),[a,r.register]);let l={id:a,ref:s,role:"presentation",...r.props};return ce({ourProps:l,theirProps:o,slot:{},defaultTag:il,name:"Menu.Heading"})}let ul="div";function dl(e,s){return ce({ourProps:{ref:s,role:"separator"},theirProps:e,slot:{},defaultTag:ul,name:"Menu.Separator"})}let ml=ie(Zr),fl=ie(el),gl=ie(nl),xl=ie(ol),pl=ie(ll),hl=ie(cl),vl=ie(dl),he=Object.assign(ml,{Button:fl,Items:gl,Item:xl,Section:pl,Heading:hl,Separator:vl});function bl({show:e,appear:s,children:n}){return t.jsx(Na,{as:u.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",show:e,appear:s,children:n})}function se({onClick:e,href:s,target:n,children:a,disabled:o,icon:r,testId:l}){const i=ye();return t.jsx(he.Item,{disabled:o,children:({active:d})=>t.jsxs(Fe,{onClick:e,href:s,target:n,className:A({"bg-token-sidebar-surface-secondary":d,"hover:bg-token-sidebar-surface-secondary":!d&&!o||i}),"data-testid":l,children:[r&&t.jsx(r,{className:"icon-md"}),a]})})}function yl({to:e,children:s,icon:n}){return t.jsx(he.Item,{children:({active:a})=>t.jsx(Fs,{to:e,children:t.jsxs(Fe,{$as:"span",className:A(a?"bg-token-sidebar-surface-secondary":"cursor-pointer"),children:[n&&t.jsx(n,{className:"icon-md"}),s]})})})}re.a`p-2 rounded-md hover:bg-black/10 hover:dark:bg-white/10 cursor-pointer`;const Fe=re.a`flex gap-2 rounded p-2.5 text-sm cursor-pointer focus:ring-0 hover:bg-token-main-surface-secondary radix-disabled:pointer-events-none radix-disabled:opacity-50 group items-center`,Jl=re(Fe)`border dark:border-white/20 min-h-0 hover:bg-gray-500/10 h-10 rounded-lg border-[rgba(0,0,0,0.1)]`,Ze=re.div`h-px bg-token-border-light my-1.5`,ei=re(Fe)`${e=>e.$active?"bg-token-sidebar-surface-secondary":"hover:bg-token-sidebar-surface-secondary"}`,Sl=ve(()=>be(()=>import("./ilte4zfawaj4noly.js"),__vite__mapDeps([31,1,2,3,5,6,32,33,34,35,15,36,37])));function ti({onClickSettings:e}){const s=ye();return t.jsxs(he,{as:"div",className:A(!s&&"group relative"),children:[t.jsx(Ml,{}),t.jsx(bl,{children:t.jsx(he.Items,{className:A("popover absolute bottom-full z-50 mb-1 overflow-hidden rounded-lg border border-token-border-light bg-token-main-surface-primary p-1.5 shadow-lg outline-none",s&&"left-3 w-[var(--screen-sidebar-popover-min-width)]",!s&&"left-0 w-full"),children:t.jsx(kl,{onClickSettings:e})})})]})}function hs(){const e=!le()?.isEnterprisey(),s=q(),n=st(),a=Je();return n?t.jsxs("div",{className:"flex items-center justify-between gap-2 py-2 pl-5 pr-4",children:[t.jsx("div",{className:"text-sm text-token-text-secondary",children:n?.email}),e&&t.jsx(ee,{label:s.formatMessage(J.addWorkspaceTooltip),side:"right",children:t.jsx("button",{onClick:()=>es(a,"profile menu"),children:t.jsx(Do,{className:"icon-sm text-token-text-primary"})})})]}):null}function Cl(){const e=le();return e==null?t.jsx(t.Fragment,{children:t.jsx("div",{className:"w-full px-3 py-2",children:t.jsx(ke,{})})}):t.jsxs(t.Fragment,{children:[t.jsx(hs,{}),t.jsx("div",{className:"flex h-11 w-full items-center justify-start gap-3 px-3 py-1 text-sm",children:t.jsx(bs,{workspace:e,isLoading:!1,currentWorkspaceId:e.id,showCheck:!1})})]})}function vs({menuItemComponent:e}){const s=tt(),n=Tt(),{data:a}=Ne(),o=le(),[r,l]=u.useState(!1),i=st(),d=q(),g=_t();if(!o||!a)return null;const m=o.isWorkspaceAccount(),b=a.accountItems.length>1,c=a.accountItems,f=Aa([c.find(h=>h.isPersonalAccount()),...c.filter(h=>!h.isPersonalAccount())]);if(f.sort((h,v)=>h.isPersonalAccount()?1:v.isPersonalAccount()?-1:0),!b)return m?t.jsx(Cl,{}):t.jsx(t.Fragment,{children:t.jsx("div",{className:"ml-3 mr-2 py-2 text-sm text-token-text-secondary",children:i?.email})});const p=f.map(h=>t.jsx(e,{disabled:h.isDeactivated(),onClick:()=>{if(h.isDeactivated()||h.id===o?.id)return;l(!0);const{willRedirect:v}=Ds(n,h.id,s,d,g);v||Os()},className:"radix-disabled:pointer-events-auto radix-disabled:hover:bg-transparent",children:h.isDeactivated()?t.jsx(jl,{workspace:h,isLoading:r}):t.jsx(bs,{workspace:h,isLoading:r,currentWorkspaceId:o?.id})},h.id));return t.jsxs(t.Fragment,{children:[t.jsx(hs,{}),t.jsx(D.Separator,{}),p]})}function bs({workspace:e,isLoading:s,currentWorkspaceId:n,showCheck:a=!0}){const o=e.canAccessWithCurrentSession,r=!s&&a&&e.id===n;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex w-full items-center gap-2.5",children:[t.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:t.jsx(nt,{iconSize:"small",workspace:e,className:A({"flex-shrink-0":!0})})}),t.jsx("div",{className:"line-clamp-1 text-token-text-primary",children:zt(q(),e)}),s&&t.jsx(ke,{}),r&&t.jsx("span",{className:"text-token-text-primary",children:t.jsx(No,{className:"icon-sm"})}),!o&&t.jsx("span",{className:"text-token-text-primary",children:t.jsx(Ao,{className:"icon-sm"})})]}),!o&&t.jsx("div",{className:"rowDivClassName",children:t.jsx("small",{className:"text-token-text-secondary",children:t.jsx(T,{...e.ssoConnectionName?J.authenticateWithSSOToAccessWorkspace:J.authenticateWithoutSSOToAccessWorkspace})})})]})}function jl({workspace:e,isLoading:s}){const n=q(),a=e.isOwnerOfAccount(),[o,r]=u.useState(!1),l=Ra(e.id);return u.useEffect(()=>{l!=null&&o&&(X.setPurchaseWorkspaceData({minimumSeats:Math.max(l,ht),existingAccount:e}),r(!1))},[l,o,e]),t.jsxs(t.Fragment,{children:[t.jsxs(ee,{className:"flex w-full flex-1 items-center gap-2.5",label:n.formatMessage(J.disabledWorkspaceTooltip),sideOffset:20,side:"right",children:[t.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:t.jsx(Ro,{className:"icon-sm flex-shrink-0 opacity-30"})}),t.jsx("div",{className:"truncate opacity-30",children:zt(n,e)})]}),s&&t.jsx(ke,{}),!s&&t.jsxs(D.Root,{children:[t.jsx(D.Trigger,{className:"rounded text-center hover:bg-token-main-surface-secondary",children:t.jsx(Po,{className:"icon-sm m-1"})}),t.jsx(D.Portal,{children:t.jsxs(D.Content,{children:[a&&t.jsx(t.Fragment,{children:t.jsx(D.Item,{onClick:()=>{l==null?r(!0):X.setPurchaseWorkspaceData({minimumSeats:Math.max(l,ht),existingAccount:e})},children:o?t.jsx(ke,{}):t.jsx(T,{id:"navigation.reactivateWorkspace",defaultMessage:"Reactivate workspace"})})}),t.jsx(D.Item,{onClick:()=>{X.setLeaveWorkspaceData(e)},children:t.jsx(T,{id:"navigation.leaveWorkspace",defaultMessage:"Leave workspace"})})]})})]})]})}function kl({onClickSettings:e}){const{data:s}=Ne(),n=le(),a=Kt(),o=Qt(),{openModal:r}=Yt(),l=Nt("3905879930");var i=n?.isTeam()??!1,d=!1;if(i&&(d=l.config.get("enabled",!1)),!n||!s)return null;const g=n.isWorkspaceAccount(),m=!a;return t.jsxs("nav",{children:[t.jsx(vs,{menuItemComponent:se}),t.jsx(Ze,{}),g?t.jsx(Zt,{menuItemComponent:se,routedMenuItemComponent:yl}):t.jsx(Xt,{menuItemComponent:se}),m&&t.jsx(se,{href:Pa(),target:"_blank",onClick:()=>{U.logEvent(G.clickFaqLink)},icon:Fo,children:t.jsx(T,{...J.helpAndFaq})}),t.jsx(se,{onClick:e,icon:os,testId:"accounts-settings-button",children:t.jsx(T,{...J.settings})}),i&&d&&t.jsxs(t.Fragment,{children:[t.jsx(se,{onClick:()=>{X.openModal(Jt.InviteUsersToWorkspace),U.logEvent(G.accountMemberInviteButton,{location:"dropdown-menu-click"}),Me.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"dropdown-menu-click",text:"AddTeammates",step:"OpenModal"})},icon:rs,children:t.jsx(T,{...J.addTeammatesButton})}),t.jsx(Sl,{workspace:n})]}),o&&t.jsx(wl,{openDownloadModal:r}),t.jsx(Ze,{}),t.jsx(se,{onClick:()=>{U.logEvent(G.clickLogOut,{eventSource:"mouse"}),U.logLogOutButtonClicked({location:"account_switcher_menu"}),At()},icon:ls,children:t.jsx(T,{...J.logOut})})]})}function Ml(){return st()?t.jsx(El,{}):null}function wl({openDownloadModal:e}){return t.jsxs("span",{children:[t.jsx(Ze,{}),t.jsx(se,{icon:is,onClick:()=>{U.logEvent(G.accountMenuClickDownloadApp),e()},children:t.jsx(T,{...J.downloadApp})})]})}function El(){const{data:e}=Ne(),s=le(),n=Fa(),a=Da(),o=ye();if(!s||!e)return null;const r=s.isWorkspaceAccount(),l=e.accountItems.length>1;return t.jsxs(he.Button,{className:A("flex w-full max-w-[100%] items-center gap-2 rounded-lg text-sm group-ui-open:bg-token-sidebar-surface-secondary",o&&"px-2 py-1.5 hover:bg-token-main-surface-secondary",!o&&"p-2 hover:bg-token-sidebar-surface-secondary"),"data-testid":"accounts-profile-button",children:[t.jsx("div",{className:"flex-shrink-0",style:{viewTransitionName:"var(--vt-profile-avatar-sidebar)"},children:t.jsx(nt,{iconSize:"gizmo"})}),t.jsxs("div",{className:"relative -top-px grow -space-y-px truncate text-start text-token-text-primary",children:[t.jsx("div",{dir:"auto",children:a}),r||l?t.jsx("div",{className:"truncate text-xs text-token-text-secondary",dir:"auto",children:n}):null]})]})}const J=_e({helpAndFaq:{id:"navigation.helpAndFaq",defaultMessage:"Help & FAQ"},settings:{id:"navigation.settings",defaultMessage:"Settings"},logOut:{id:"navigation.logOut",defaultMessage:"Log out"},accountSwitcherTitle:{id:"navigation.accountSwitcherTitle",defaultMessage:"Workspaces"},defaultWorkspaceTitle:{id:"useWorkspaces.defaultWorkspaceTitle",defaultMessage:"Untitled Workspace"},addWorkspaceTooltip:{id:"navigation.addWorkspaceTooltip",defaultMessage:"Create a Team workspace"},disabledWorkspaceTooltip:{id:"navigation.disabledWorkspaceTooltip",defaultMessage:"This workspace has been deactivated"},downloadApp:{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"},authenticateWithSSOToAccessWorkspace:{id:"CV7pdM",defaultMessage:"Authenticate with SSO to access this workspace"},authenticateWithoutSSOToAccessWorkspace:{id:"zfCWFh",defaultMessage:"Authenticate without SSO to access this workspace"},addTeammatesButton:{id:"inviteMemberButton.inviteMemberButton",defaultMessage:"Add Teammates"}});function Il({citationMetadata:e,noBottomBorder:s=!1,sourceFeedback:n,setSourceFeedback:a}){const o=q(),[r,l]=u.useMemo(()=>{if(e.type!=="file")return["",""];const m=e.name.split(".");return m.length>1?[m.slice(0,-1).join("."),m[m.length-1]]:[e.name,""]},[e]),i=u.useMemo(()=>ts(Rt.GDRIVE,l),[l]),d=u.useMemo(()=>{if(e.type==="file"&&e.extra?.cloud_doc_url)try{return new URL(e.extra.cloud_doc_url).hostname}catch{return}},[e]),g=u.useCallback(m=>{a({rating:m,tags:[]})},[a]);return e.type!=="file"?null:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-row items-center justify-between py-2",children:[t.jsxs("div",{className:"max-width-full mr-2 flex grow flex-row items-center overflow-hidden",children:[t.jsx(i,{className:"mr-2 flex-shrink-0 flex-grow-0"}),t.jsx("a",{href:e.extra?.cloud_doc_url,className:"text-token-primary flex-grow-1 flex-shrink-1 overflow-hidden text-ellipsis whitespace-nowrap text-sm",target:"_blank",rel:"noreferrer",children:r}),d&&t.jsx("div",{className:"ml-2 text-sm text-token-text-secondary",children:d})]}),t.jsxs("div",{className:"flex shrink-0 flex-row items-center",children:[t.jsx("button",{className:"rounded-md p-1 hover:bg-token-main-surface-secondary",children:n?.rating==="thumbsUp"?t.jsx(cs,{className:"icon-md-heavy text-token-text-primary",onClick:()=>g(void 0)}):t.jsx(Oo,{className:"icon-md-heavy text-token-text-secondary",onClick:()=>g("thumbsUp")})}),t.jsx("button",{className:"rounded-md p-1 hover:bg-token-main-surface-secondary",children:n?.rating==="thumbsDown"?t.jsx(us,{className:"icon-md-heavy text-token-text-primary",onClick:()=>g(void 0)}):t.jsx(Bo,{className:"icon-md-heavy text-token-text-secondary",onClick:()=>g("thumbsDown")})})]})]}),n?.rating&&t.jsx("div",{className:"mb-4 flex flex-row",children:(n.rating==="thumbsDown"?Oa:Ba).map(m=>t.jsx(Vo,{className:"mr-2",$selected:n.tags.includes(m),onClick:()=>a({...n,tags:n.tags.includes(m)?n.tags.filter(b=>b!==m):[...n.tags,m]}),children:La(m,o)},m))}),!s&&t.jsx("div",{className:"w-full border-[0.5px] border-token-border-light"})]})}function Tl({documentId:e,title:s,externalUrl:n,noBottomBorder:a=!1,shouldHaveBeenIncluded:o,setShouldHaveBeenIncluded:r}){const[l,i]=u.useMemo(()=>{const m=s.split(".");return m.length>1?[m.slice(0,-1).join("."),m[m.length-1]]:[s,""]},[s]),d=u.useMemo(()=>ts(Rt.GDRIVE,i),[i]),g=u.useMemo(()=>{if(n)try{return new URL(n).hostname}catch{return}},[n]);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-row items-center justify-between py-2",children:[t.jsxs("div",{className:"max-width-full mr-2 flex grow flex-row items-center overflow-hidden",children:[t.jsx(d,{className:"mr-2 flex-shrink-0 flex-grow-0"}),t.jsx("a",{href:n,className:"text-token-primary flex-grow-1 flex-shrink-1 overflow-hidden text-ellipsis whitespace-nowrap text-sm",target:"_blank",rel:"noreferrer",children:l}),g&&t.jsx("div",{className:"ml-2 text-sm text-token-text-secondary",children:g})]}),t.jsx("div",{className:"flex shrink-0 flex-row items-center px-2",children:t.jsx(ss,{checked:o,onChange:m=>r?.(m.currentTarget.checked),id:`should-have-been-included-${e}`})})]}),!a&&t.jsx("div",{className:"w-full border-[0.5px] border-token-border-light"})]})}const _l="considered-source-should-have-been-used";function Nl({citations:e,rating:s,onSubmit:n,onCancel:a,messageId:o,conversationId:r,nodeId:l,conversationTree:i}){const d=q(),g=_t(),[m,b]=u.useState(""),[c,f]=u.useState(()=>{const x={};for(const y of e)y.metadata?.type==="file"&&(x[y.metadata.id]={rating:void 0,tags:[],url:y.metadata.extra?.cloud_doc_url});return x}),p=u.useMemo(()=>{const x=new Set,y=[];for(const k of e)!k.metadata||k.metadata.type!=="file"||x.has(k.metadata.id)||(y.push(k.metadata),x.add(k.metadata.id));return y},[e]),[h,v]=u.useState(!0),S=u.useMemo(()=>{const x={hasQuery:!1,lastAssistantMessage:null,lastUserMessage:null,referencedSyncedFiles:[]};if(!i||!l||!i.containsNodeOrMessageId(l))return x;const y=Wa(i,{messageId:l,entireConversation:!0});for(const k of y.messages)switch(k.type){case"fetch":case"generic_file_search_tool":case"system":continue;case"result":{k.result.chunks.forEach(j=>{j.documentId&&j.documentId.startsWith("S")&&!x.referencedSyncedFiles.some(E=>E.fileId===j.documentId)&&!p.some(E=>E.type==="file"&&E.id===j.documentId)&&x.referencedSyncedFiles.push({fileId:j.documentId,title:j.title})});continue}case"query":{x.hasQuery=!0;continue}case"visible_text":{if(k.author===dt.User){if(!x.lastUserMessage){const j=i.getConversationTurns(k.id),E=j[j.length-1].messages,w=E[E.length-1];x.lastUserMessage=w}}else if(k.author===dt.Assistant&&!x.lastAssistantMessage){const j=i.getConversationTurns(k.id),E=j[j.length-1].messages,w=E[E.length-1];x.lastAssistantMessage=w,x.lastUserMessage=null}continue}}return x},[i,p,l]),M=u.useCallback(async x=>{const y={...x,additionalSources:m,sourcesFeedback:c,consentedToShareConvoLink:h};Pt.submitCaMessageFeedback({feedback_format:Ye.ALPHA,message_id:o,conversation_id:r,text:y.textFeedback,rating:s,tags:y.tags,tag_choices:y.tagChoices,additional_sources:y.additionalSources,sources_feedback:y.sourcesFeedback,consented_to_share_convo_link:y.consentedToShareConvoLink}),g.success("Thanks for providing feedback!"),n?.(y)},[m,c,h,o,r,s,g,n]);return t.jsxs(Go,{multiple:!0,allowEmptySubmit:!0,onSubmit:M,onCancel:a,tagOptions:s==="thumbsDown"?vt(Ua,d):vt(Ha,d),modalOnly:!0,modalTitle:t.jsxs("div",{className:"flex items-center gap-2",children:[s==="thumbsDown"?t.jsx(us,{className:"mb-[-6px]"}):t.jsx(cs,{className:"mb-[-6px]"}),t.jsx(T,{id:"h5nasL",defaultMessage:"Provide feedback"})]}),children:[p.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("h3",{className:"mt-6 text-base font-semibold",children:t.jsx(T,{id:"G6+7UX",defaultMessage:"Sources"})}),t.jsx("div",{children:p.map((x,y)=>x?.type!=="file"?null:t.jsx(Il,{citationMetadata:x,noBottomBorder:y===p.length-1,sourceFeedback:c[x.id],setSourceFeedback:k=>f(j=>({...j,[x.id]:{...k,url:x.extra?.cloud_doc_url}}))},x.id))})]}),S.referencedSyncedFiles.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mt-6 flex items-baseline justify-between",children:[t.jsxs("div",{className:"flex-start flex",children:[t.jsx("h3",{className:"text-base font-semibold",children:t.jsx(T,{id:"xvBe/T",defaultMessage:"Considered Sources"})}),t.jsx("p",{className:"ml-2 text-token-text-secondary",children:t.jsx(T,{id:"nX81fN",defaultMessage:"({numSources} sources)",values:{numSources:S.referencedSyncedFiles.length}})})]}),t.jsx("p",{className:"text-sm text-token-text-tertiary",children:t.jsx(T,{id:"0+Uivl",defaultMessage:"Good Source?"})})]}),t.jsx("div",{className:"mt-2 max-h-[200px] overflow-auto",children:S.referencedSyncedFiles.map((x,y)=>{const k=x.fileId.split("--")[1];if(!k)return null;const j=`https://drive.google.com/file/d/${k}`;return t.jsx(Tl,{title:x.title,documentId:x.fileId,externalUrl:j,noBottomBorder:y===S.referencedSyncedFiles.length-1,shouldHaveBeenIncluded:!!c[x.fileId],setShouldHaveBeenIncluded:E=>f(w=>{const I={...Object.fromEntries(Object.entries(w).filter(([R])=>R!==x.fileId))};return E&&(I[x.fileId]={tags:[_l],rating:"thumbsUp",url:j}),I})},x.fileId)})})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("p",{className:"text-sm text-token-text-primary",children:t.jsx(T,{id:"1ApJVo",defaultMessage:"Add any additional sources"})}),t.jsx($a,{name:"feedback",className:"mt-2",placeholder:d.formatMessage({id:"CAFeedbackModal.additionalSourcePlaceholder",defaultMessage:"(Optional) Additional sources"}),value:m,onChange:x=>b(x.target.value)})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"mb-2 text-base font-semibold",children:t.jsx(T,{id:"9NcQBu",defaultMessage:"Latest Exchange"})}),t.jsx("div",{className:"p-2",children:t.jsxs("div",{className:"mb-4",children:[S.lastUserMessage&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"mb-1 pl-4 text-xs text-token-text-secondary",children:t.jsx(T,{id:"QTWrtR",defaultMessage:"Your message"})}),t.jsx("div",{className:"flex justify-start",children:t.jsx("p",{className:"relative max-w-[70%] rounded-3xl bg-[#f4f4f4] px-5 py-2.5 dark:bg-token-main-surface-secondary",children:S.lastUserMessage?t.jsx(St,{message:S.lastUserMessage,isCompletionInProgress:!1,clientThreadId:r,isUserTurn:!1,turnIndex:0,isFeedbackEnabled:!1,showEditButton:!1,onEnterEdit:()=>null,onRequestMoreCompletions:()=>null}):null})})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("p",{className:"mb-1 pl-4 text-xs text-token-text-secondary",children:t.jsx(T,{id:"ZCTm4h",defaultMessage:"ChatGPT's response"})}),t.jsx("div",{className:"relative rounded-lg bg-token-main-surface-secondary p-4 text-sm",children:S.lastAssistantMessage?t.jsx(St,{message:S.lastAssistantMessage,isCompletionInProgress:!1,clientThreadId:r,isUserTurn:!1,turnIndex:1,isFeedbackEnabled:!1,showEditButton:!1,onEnterEdit:()=>null,onRequestMoreCompletions:()=>null}):null})]})]})}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"mt-6 text-base font-semibold",children:t.jsx(T,{id:"c95uEW",defaultMessage:"Full conversation"})}),t.jsx("p",{className:"mb-2 mt-1 text-sm text-token-text-secondary",children:t.jsx(T,{id:"3E3ZSm",defaultMessage:"If previous portions of this conversation are important to understand your feedback, we encourage you to include it."})}),t.jsx(ss,{id:"consented-to-share-entire-convo",label:d.formatMessage({id:"5CC8r8",defaultMessage:"Share Entire Conversation"}),checked:h,onChange:x=>{v(x.currentTarget.checked)}})]})]})]})}const Al=ve(()=>be(()=>import("./sso-kd6s8mrtse4xhjco.js").then(e=>e.C),__vite__mapDeps([38,1,2,3,5,6,18,8,39,36,37,25,40,41,42,43,44,45,46,47,26,24,19,48,49,50,51,52,53,34,35,15,54,55,56,57,58,59,60,61,62,63])).then(e=>e.CADogfoodingFeedbackModal).catch(()=>()=>null));function Rl(e){const s=Va();if(!s)return null;switch(s){case Ye.ALPHA:return t.jsx(Nl,{...e});case Ye.DOGFOODING:return t.jsx(Al,{...e})}}function Pl({clientThreadId:e,currentModelId:s,defaultModelId:n,onCompletionFinished:a,onThreadCreated:o,preRequestCompletion:r}){const l=Ga(),i=tt(),{isUnauthenticated:d}=et(),g=qa(e),m=Tt(),b=za(e),c=le(),f=Ka(e),p=Qa(),h=Ft(),{config:v}=Bs("1013114931"),S=v.get("show_follow_ups",!1)&&c?.isPersonalAccount(),M=!p.displayingSideBySideFeedback&&S,x=u.useCallback(_=>{const P=Y.getTree(e).getLeafFromNode(_);Y.setThreadCurrentLeafId(e,P.id)},[e]),y=Ya(s),[k,j]=u.useState(),E=u.useCallback(({nodeId:_,messageId:O,rating:P})=>{const F=Y.getServerThreadId(e);U.logEvent(G.thumbRating,{id:O,threadId:F,rating:P,model:s});const C=Y.getTree(e),Q=C.getNodeByIdOrMessageId(_);if(F!==void 0&&!y&&Pt.submitMessageFeedback({message_id:O,conversation_id:F,rating:P}),Y.updateTree(e,W=>{W.updateNodeMetadata(_,{rating:P})}),y){j(t.jsx(Rl,{citations:Q.message.metadata?.citations??[],rating:P,conversationId:F??"",messageId:O,onSubmit:()=>{j(void 0)},onCancel:()=>j(void 0),conversationTree:C,nodeId:_},`${_}-${P}`));return}},[e,s,y]),w=u.useCallback(_=>{if(_==null||(a?.(_),h)||(b?.kind===Ls.GizmoInteraction&&Xa.handleGizmoInteracted(m,b.gizmo_id),!(f||M)))return;const P=Y.getThreadCurrentLeafId(_),F=Y.getTree(_).getMessage(P);Za(F)||Ja(F)||eo(_,F.id,s)},[b,s,a,m,f,M,h]),I=to({clientThreadId:e,continuingFromSharedConversationId:g,onCompletionFinished:w,onCreate:o}),R=u.useCallback(()=>{const _=Y.getThreadCurrentLeafId(e);if(_==null)return;const P=Y.getTree(e).getBranchFromLeaf(_);so.abortRequests(P.map(F=>F.id))},[e]),N=u.useCallback(_=>no({cancelRequests:R,clientThreadId:e,currentModelId:s,debugSettings:l,defaultModelId:n,isUnauthenticated:d,navigateToAuth:i,preRequestCompletion:r,requestCompletion:I,..._}),[R,e,s,l,n,d,i,r,I]),H=u.useCallback((_,O,P,F=!0,C="none",Q)=>{const V=Y.getTree(e).getParentPromptNode(_).id;N({type:Ws.Variant,promptId:V,eventMetadata:O,cancelActiveRequests:!1,focusOnNewCompletion:F,useDefaultModel:Q,completionMetadata:{variantPurpose:C,conversationMode:ao.getConversationMode(e)},turnTracker:P})},[e,N]);return{caModal:k,onRequestCompletion:N,onRequestMoreCompletions:H,onChangeItemInView:x,onChangeRating:E,cancelRequests:R}}function ys(){return{caModal:null,clientThreadId:"",focusedObject:null,currentModelId:"",isModelLoaded:!1,isEmbeddedInFocusedView:!1,isInstalledApp:!1,isCompanionWindow:!1,conversationLeafId:"",onNewThread:()=>{throw new Error("onNewThread not implemented")},onRequestCompletion:()=>{throw new Error("onRequestCompletion not implemented")},onChangeItemInView:()=>{throw new Error("onChangeItemInView not implemented")},onChangeRating:()=>{throw new Error("onChangeRating not implemented")},onRequestMoreCompletions:()=>{throw new Error("onRequestMoreCompletions not implemented")},resetThread:()=>{throw new Error("resetThread not implemented")}}}const Ss=u.createContext(ys());function Fl(){try{return u.useContext(Ss)}catch{return ys()}}function si({children:e,clientThreadId:s,setClientThreadId:n,prefetchSearch:a}){const{createNewThread:o,onThreadCreated:r,resetThread:l}=oo({clientThreadId:s,setClientThreadId:n}),i=ro(),d=lo(s),g=io(s),m=co(),b=i.id,c=d??b,f=$s(),p=uo(),h=mo(),{caModal:v,onRequestCompletion:S,onChangeItemInView:M,onChangeRating:x,onRequestMoreCompletions:y}=Pl({clientThreadId:s,currentModelId:c,defaultModelId:i.id,onThreadCreated:r});return t.jsx(Ss.Provider,{value:{caModal:v,clientThreadId:s,currentModelId:c,isModelLoaded:!!d,isEmbeddedInFocusedView:m,isInstalledApp:p,isCompanionWindow:f,focusedObject:h,conversationLeafId:g,onNewThread:o,onRequestCompletion:S,onChangeItemInView:M,onChangeRating:x,onRequestMoreCompletions:y,resetThread:l,prefetchSearch:a},children:e})}const Dl=ve(()=>be(()=>import("./ilte4zfawaj4noly.js"),__vite__mapDeps([31,1,2,3,5,6,32,33,34,35,15,36,37])));function ni({showShareButton:e,showProfileDropdown:s,clientThreadId:n}){const a=bo(n),o=q(),r=Lt(),{layer:l}=we("1547743984");yo(n);const{onNewThread:i}=Fl(),{titleSource:d}=So(n);d===Co.NewChat&&jo(n);const g=l.get("show_share_button_text",!1),m=o.formatMessage({id:"GizmoInformation.shareChat",defaultMessage:"Share"}),b=ye(),c=()=>X.openSharingModal(a),f=!1,p=o.formatMessage({id:"TO+loE",defaultMessage:"New Chat"});return t.jsxs(t.Fragment,{children:[!1,r&&t.jsx(ko,{}),!1,e&&a&&t.jsx(bt,{clientThreadId:n,children:g?t.jsx(Ke,{onClick:c,icon:Ve,label:m,"data-testid":"share-chat-button",color:"secondary",className:"text-token-text-primary",style:{display:"var(--screen-size-hidden-on-compact-mode)",viewTransitionName:"var(--vt_share_chat_wide_button)"},children:m}):t.jsx(ee,{label:o.formatMessage({id:"CPEfES",defaultMessage:"Share chat"}),children:t.jsx(Ae,{"data-testid":"share-chat-button",onClick:()=>X.openSharingModal(a),icon:Ve,style:{viewTransitionName:"var(--vt_share_chat_compact_button)"}})})}),b&&e&&a&&t.jsx(bt,{clientThreadId:n,children:t.jsx(ee,{label:m,children:t.jsx(yt,{style:{display:"var(--screen-size-hidden-on-wide-mode)",viewTransitionName:"var(--vt_share_chat_compact_button)"},onClick:c,icon:t.jsx(Ve,{}),label:m})})}),b&&!f&&t.jsx(ee,{label:p,children:t.jsx("div",{style:{display:"var(--sidebar_is_open_and_pinned, none)"},children:t.jsx(yt,{className:zs.sidebarIcon,icon:t.jsx(ds,{}),onClick:()=>i(),label:p,style:{display:"var(--screen-size-hidden-on-wide-mode)"}})})}),s&&t.jsx(Bl,{clientThreadId:n}),!1]})}function Ol({to:e,children:s,icon:n}){const a=Je();return t.jsx(D.Item,{icon:n,onSelect:()=>a(e),children:s})}function Bl({clientThreadId:e}){const{isUnauthenticated:s}=et();return s?t.jsx(ql,{}):t.jsx(Ll,{clientThreadId:e})}function Ll({clientThreadId:e}){const{data:s}=Ne(),n=le(),a=n?.isPlus()??!1,o=n?.isWorkspaceAccount()??!1,{openSettings:r}=fo(),l=Qt(),i=Ul(e??"none"),{openModal:d}=Yt(),g=ye(),{layer:m}=we("2888142241"),b=Nt("3905879930"),c=q();var f=n?.isTeam()??!1,p=!1;f&&(p=b.config.get("enabled",!1));const{doesUserHaveAnyAccountsWithPlusFeatures:h}=Us(),{layer:v}=we("2670443078");if(!n||!s)return null;const S=s.accountItems.length>1;let M=a;!o&&!a&&h&&v.get("is_gating_fix_enabled",!1)&&(M=h);const x=!o&&!M&&m.get("is_upgrade_in_settings",!1);return t.jsxs(Hs,{contentClassName:A(g&&"max-w-[256px] min-w-[256px] w-[256px]"),triggerButton:t.jsx("button",{onClick:()=>{U.logEvent(G.accountOpenProfileMenu),Me.logEvent("chatgpt_account_open_profile_menu")},"aria-label":c.formatMessage({id:"wz2MQV",defaultMessage:"Open Profile Menu"}),"data-testid":"profile-button",className:"flex h-10 w-10 items-center justify-center rounded-full hover:bg-token-main-surface-secondary focus-visible:bg-token-main-surface-secondary focus-visible:outline-0",style:g?{display:"var(--screen-size-hidden-on-compact-mode, flex)"}:void 0,children:t.jsx(nt,{iconSize:"medium"})}),children:[S&&t.jsx(vs,{menuItemComponent:D.Item}),S?t.jsx(D.Separator,{}):null,o?t.jsx(Zt,{menuItemComponent:D.Item,routedMenuItemComponent:Ol}):t.jsx(Xt,{menuItemComponent:D.Item}),t.jsx(D.Item,{icon:os,onClick:()=>r(),"data-testid":"settings-menu-item",children:t.jsx(T,{defaultMessage:"Settings",id:"navigation.settings.0"})}),t.jsx(D.Separator,{}),f&&p&&t.jsxs(t.Fragment,{children:[t.jsx(D.Item,{"data-testid":"settings-menu-item-invite-teammates",onClick:()=>{X.openModal(Jt.InviteUsersToWorkspace),U.logEvent(G.accountMemberInviteButton,{eventSource:"mouse",location:"profile_drop_down"}),Me.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"dropdown-menu-click",text:"AddTeammates",step:"OpenModal"})},icon:rs,children:t.jsx(T,{...Cs.addTeammatesButton})}),t.jsx(Dl,{workspace:n})]}),l&&t.jsx($l,{openDownloadModal:d}),x&&t.jsx(Vl,{}),i&&t.jsx(Hl,{}),(x||l||i)&&t.jsx(D.Separator,{}),t.jsx(D.Item,{onClick:()=>{U.logEvent(G.clickLogOut,{eventSource:"mouse"}),U.logLogOutButtonClicked({location:"profile_drop_down"}),At()},"data-testid":"log-out-menu-item",icon:ls,children:t.jsx(T,{defaultMessage:"Log out",id:"navigation.logOut.0"})})]})}function Wl({onClick:e,className:s,testId:n}){const a=q(),o=Ft(),r=o?a.formatMessage({id:"yqd/J5",defaultMessage:"Clear chat"}):a.formatMessage({id:"OFyxqj",defaultMessage:"New chat"});return t.jsx(ee,{sideOffset:4,label:r,className:A("flex",s),children:t.jsx(Ae,{onClick:()=>{X.closePopoverNavSidebar(),e()},icon:o?Uo:ds,surfaceContext:"secondary","aria-label":r,"data-testid":n})})}function ai({clientThreadId:e}){const[s]=ns(o=>[o.activeStageSidebar]),n=as(),a=Mo({clientThreadId:e,location:"Navigation actions"});return!n&&!s?null:t.jsxs("div",{className:"flex items-center",children:[t.jsx(Gl,{}),t.jsx(Wl,{onClick:a})]})}function $l({openDownloadModal:e}){return t.jsx("span",{children:t.jsx(D.Item,{icon:is,onClick:()=>{e(),U.logEvent(G.accountMenuClickDownloadApp)},children:t.jsx(T,{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"})})})}const Ul=e=>{const{value:s}=Vs("2634628831"),n=Gs(()=>document.documentElement.dataset.searchExtension==="1"),a=go(e,qs.Search);return!n&&a&&xo()&&s},Hl=()=>t.jsx("span",{children:t.jsx(D.Item,{icon:Lo,onClick:()=>{window.open(po),U.logEventWithStatsig(G.chatgptBrowserExtensionUserMenuClicked,"chatgpt_browser_extension_user_menu_clicked")},children:t.jsx(T,{id:"E5VPz/",defaultMessage:"Get ChatGPT search extension"})})});function Vl(){const e=Je(),n=le()?.wasPaidCustomer()??!1,a=()=>{Me.logEvent("chatgpt_plus_upgrade_in_settings_menu_clicked"),U.logEvent(G.plusUpgradeInSettingsMenuClicked),es(e,"Upper right settings menu")};return t.jsx(D.Item,{icon:Wo,onClick:a,children:n?t.jsx(T,{id:"navigation.renewPlus",defaultMessage:"Renew Plus"}):t.jsx(T,{id:"navigation.upgradePlan",defaultMessage:"Upgrade Plan"})})}function Gl(){const e=q(),[s]=ns(r=>[r.activeStageSidebar]),n=as(),a=Kt(),{isUnauthenticated:o}=et();return!s&&!n||!a||o?null:t.jsx(ee,{label:e.formatMessage({id:"cElEQV",defaultMessage:"Open sidebar"}),className:"flex",children:t.jsx(Ae,{"aria-label":e.formatMessage({id:"pV/Etp",defaultMessage:"Open sidebar"}),onClick:X.toggleNavSidebar,icon:$o,surfaceContext:"primary"})})}function ql(){const e=tt(),s=ho(),n=vo(Cs.signUpCta),{layer:a}=we("3637408529"),o=a.get("is_desktop_primary_auth_button_on_right",!1),r=()=>{e({authType:"login",callback:m=>{U.logLogInButtonClicked({location:"Chat header",provider:m})}})},l=()=>{e({authType:"signup",callback:m=>{U.logSignUpButtonClicked({location:"Chat header",provider:m})}})},i=t.jsx(Ke,{onClick:r,color:s?"primary":"secondary",size:"small","data-testid":"login-button",children:t.jsx(T,{id:"B1SN7b",defaultMessage:"Log in"})},"login"),d=t.jsx(Ke,{color:s?"secondary":"primary",onClick:l,size:"small","data-testid":"signup-button",children:t.jsx(T,{...n})},"signup"),g=s?[i,d]:[d,i];return t.jsx("div",{className:"flex items-center justify-center gap-2",children:o?g.reverse():g})}const Cs=_e({signUpCta:{id:"P6cySK",defaultMessage:"Sign up"},addTeammatesButton:{id:"inviteMemberButton.inviteMemberButton",defaultMessage:"Add Teammates"}});export{or as A,Il as C,ms as D,Gl as E,zo as L,Hr as M,Wl as N,qo as O,Ll as P,Ur as R,yr as T,ei as U,bl as a,$r as b,si as c,Fe as d,gr as e,St as f,Jl as g,ti as h,Ss as i,_l as j,de as k,Bl as l,lr as m,fr as n,ni as o,ai as p,Pl as q,Fl as u,Br as x,Lr as y};
//# sourceMappingURL=batco5mjkqikbslw.js.map
