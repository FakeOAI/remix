import{r as d,cg as q,J as M,S as b,P as y,d as w,j as e,bA as $,aG as _,l as Y,aC as f,K,a3 as H,n as G,I as V,O as W,R as J}from"./lj2b9v3ilohzzubf.js";import{bQ as X,bR as Z,aa as T,bS as ee,bT as te,bU as se,bV as ne,bW as oe,bX as ae,bY as ie,bZ as re,b_ as le,b as ce,N as de,b$ as ue,c0 as pe,c1 as ge,c2 as me,c3 as fe,c4 as xe,c5 as he,c6 as be,a8 as ye,p as we}from"./m2xe8hrs3fe8d0zo.js";import{aE as Se}from"./np8fo7dxv82gt6zv.js";import{C as _e}from"./bhbrwbqgjt2pxoro.js";import"./ih9daw890a94om4n.js";import{m as j}from"./utt1v4s8vubsyl62.js";import"./h2vwtx24g9nva0dp.js";import"./d3oipwmaenjajggo.js";import"./o545f88g8hpm6119.js";import"./dsellp5bliow2765.js";import"./leetci8n826xoeaw.js";import"./n985yc0bql5eas8a.js";import"./otlsz2b7ph0d84bq.js";import"./i8x718i0ayf9d2nr.js";function je(t,n){const{data:o,isLoading:l,isSuccess:a,isError:i}=Y({queryKey:["onboardingSteps",t,n],queryFn:()=>W.createOnboardingSteps(void 0,t,n)});return{steps:o?.steps??[],isLoading:l,isSuccess:a,isError:i}}function k({children:t,className:n}){return e.jsx(j.div,{className:n,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.25},exit:{opacity:0,y:-10},children:t})}function Me(){return e.jsx(k,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(f,{...r.preparingOnboardingExperience})})})}function ke({setIsInWelcomePage:t}){const n=ee();return d.useEffect(()=>{n&&setTimeout(()=>{t(!1)},2500)},[n,t]),n?e.jsx(k,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(f,{...r.niceToMeetYou,values:{name:n.name}})})}):null}function ve(t){const n=te(),o=M(),l=K(),a=se(t);let i=ne(t);const c=oe(a,i),s=ae(a,i);return d.useCallback(async p=>{const g="text/plain",x=new Blob([p],{type:g}),h=new File([x],"My_File.txt",{type:g});return ie.uploadFile(n,re(h),h,le.Retrieval,s,o,l,void 0,c?.attachments)},[n,o,l,s,c?.attachments])}function Ye({clientThreadId:t,setClientThreadId:n}){const[o,l]=d.useState(!0),{isOpen:a,setIsOpen:i,markAsViewed:c}=X(),[s,p]=d.useState(0),[g,x]=d.useState(new Set(["usage_question"])),[h,A]=d.useState([]),[L,O]=d.useState(),{steps:u,isLoading:v,isError:C}=je(h,L),P=Pe({clientThreadId:t,setClientThreadId:n}),U=ve(t),{layer:Q}=q("717266490"),R=Q.get("keep_onboarding_after_dismiss",!1),F=M();if(d.useEffect(()=>{a&&(b.logEvent("chatgpt_onboarding_flow_shown"),y.logEvent(w.onboardingShown))},[a]),d.useEffect(()=>{C&&(c(),b.logEvent("chatgpt_onboarding_flow_error"),y.logEvent(w.onboardingError))},[C,c]),d.useEffect(()=>{if(!(v||!u[s])&&!g.has(u[s].step_type)){x(N=>new Set([...N,u[s].step_type]));const m=u[s].step_prompt;m&&(P({stepPrompt:m}),u[s].step_type==="file_upload"&&u[s].additional_info&&U(u[s].additional_info))}},[s,v,g,P,u,U]),C)return null;const S=u[s],E=m=>{i(!1),m&&!R&&c(),s===u.length-1?(b.logEvent("chatgpt_onboarding_flow_finished"),y.logEvent(w.onboardingFinished)):(b.logEvent("chatgpt_onboarding_flow_dismissed",null,{step_type:S?.step_type,step_index:s.toString()}),y.logEvent(w.onboardingDismissed,{step_type:S?.step_type,step_index:s.toString()}))},z=(m,N)=>{A(m),O(N),p(1),b.logEvent("chatgpt_onboarding_usage_question_selected",null,{main_usages:m.join(", ")}),y.logEvent(w.onboardingUsageQuestionSelected,{main_usages:m.join(", ")})},B=()=>{p(m=>m+1),b.logEvent("chatgpt_onboarding_usage_question_skipped"),y.logEvent(w.onboardingUsageQuestionSkipped)};return e.jsx($,{isOpen:a,onClose:()=>E(!1),type:"success",size:"fullscreen",noPadding:!0,className:"w-full",children:e.jsx(Z,{clientThreadId:t,children:e.jsxs("div",{className:"flex h-full max-h-full flex-col bg-gradient-to-b from-brand-blue-800/15 to-gray-50 dark:from-brand-blue-800/15 dark:to-token-main-surface-primary",children:[e.jsxs("div",{className:"absolute left-0 top-0 z-10 flex w-full items-center justify-between bg-none px-4",style:{minHeight:"var(--screen-thread-header-min-height,60px)"},children:[u&&u.length>0&&e.jsx("div",{className:"absolute left-0 top-0 h-2 w-full",children:e.jsx(j.div,{className:"h-1.5 bg-token-main-surface-primary-inverse",initial:{width:"0%",opacity:0},animate:{width:`${(s+1)/u.length*100}%`,opacity:1},transition:{duration:.3}})}),s>0?e.jsx(_,{onClick:()=>p(s-1),color:"ghost",className:"border-none",icon:Se}):e.jsx("div",{}),S?.step_type==="usage_question"?e.jsx(_,{onClick:B,color:"ghost",className:"border-none",children:F.formatMessage(r.skip)}):e.jsx(_,{onClick:()=>E(!0),color:"ghost",className:"border-none",children:F.formatMessage(r.close)})]}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center overflow-hidden",children:e.jsx(T,{mode:"wait",children:o?e.jsx(ke,{setIsInWelcomePage:l},"welcome"):v?e.jsx(Me,{},"loading"):S?.step_type==="usage_question"?e.jsx(Ce,{onEnterUserInfo:z},"usage-question"):["dalle","file_upload","canvas","voice"].includes(S.step_type)?e.jsx(Te,{step:S,gotoStep:p,stepIndex:s,totalSteps:u.length,endOnboarding:E,clientThreadId:t},"tools-onboarding"):null})})]})})})}function Ce({onEnterUserInfo:t}){const[n,o]=d.useState([]),[l,a]=d.useState(0);return e.jsx(T,{children:l===0?e.jsx(Ee,{onSelectMainUsages:i=>{o(i),a(1)}}):e.jsx(Ne,{mainUsages:n,onEnterSelfDescription:i=>{t(n,i)}})})}function Ee({onSelectMainUsages:t}){const[n,o]=d.useState(new Set),l=M();return e.jsxs(k,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(f,{...r.mainWayToUse})}),e.jsx("p",{className:"mb-6 text-base text-token-text-secondary",children:e.jsx(f,{...r.helpMeCurateWhatToShow})})]}),e.jsx("div",{className:"flex flex-col items-start justify-start gap-5",children:["school","work","personalTasks","funAndEntertainment"].map(a=>e.jsx(ce,{id:`main-usage-${a}`,checked:n.has(a),onChange:i=>o(c=>{const s=new Set(c);return i.target.checked?s.add(a):s.delete(a),s}),label:e.jsx("span",{className:"cursor-pointer",children:l.formatMessage(r[a])})},a))}),e.jsx(_,{size:"medium",color:"primary",onClick:()=>t(Array.from(n)),className:"mt-10",children:e.jsx(f,{...r.next})})]})}function Ne({mainUsages:t,onEnterSelfDescription:n}){const[o,l]=d.useState(),[a,i]=d.useState(!1),c=M(),s=d.useMemo(()=>t.includes("school")?r.exampleSchoolSelfDescription:t.includes("work")?r.exampleWorkSelfDescription:t.includes("funAndEntertainment")?r.exampleFunAndEntertainmentSelfDescription:r.examplePersonalTasksSelfDescription,[t]),{layer:p}=q("717266490"),g=p.get("write_custom_instructions_in_onboarding",!1),x=async()=>{try{g&&o&&(i(!0),await W.createOrUpdateUserSystemMessage({aboutUserMessage:o,aboutModelMessage:"",disabledTools:[],enabled:!0}))}finally{i(!1),n(o)}};return e.jsxs(k,{className:"flex w-[640px] flex-col items-start",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"mb-4 text-3xl font-medium leading-9 text-token-text-primary",children:[e.jsx(f,{...r.oneLastQuestion}),e.jsx("br",{}),e.jsx(f,{...r.anythingElseYouWantMeToKnow})]}),e.jsx("p",{className:"text-base text-token-text-secondary",children:e.jsx(f,{...r.helpMeCurateWhatToShow})})]}),e.jsx(de,{className:"mt-10 rounded border border-token-border-light bg-token-main-surface-primary p-5 !text-base",placeholder:c.formatMessage(s),rows:4,value:o,onChange:h=>l(h.target.value)}),e.jsx(_,{size:"medium",color:"primary",onClick:x,className:"mt-10",loading:a,disabled:a,children:e.jsx(f,{...r.submit})})]})}function Te({step:t,gotoStep:n,stepIndex:o,totalSteps:l,endOnboarding:a,clientThreadId:i}){const c=ue({clientThreadId:i}),s=pe(),p=M(),g=o===l-1,x=()=>{o<l-1?(n(o+1),b.logEvent("chatgpt_onboarding_flow_next_clicked",null,{source_step_type:t?.step_type,source_step_index:o.toString()}),y.logEvent(w.onboardingNextClicked,{source_step_type:t?.step_type,source_step_index:o.toString()})):(a(!0),s())};return e.jsxs(k,{className:"flex h-full w-full flex-row pl-24 pr-16",children:[e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center",children:e.jsxs(j.div,{className:"flex flex-1 flex-col items-start justify-center gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs(T,{mode:"wait",children:[e.jsx(j.h1,{className:"mb-2 text-3xl font-medium text-token-text-primary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.title?t.title:I[t.step_type]?p.formatMessage(I[t.step_type]):null},`title-${o}`),e.jsx(j.p,{className:"mb-6 text-base text-token-text-secondary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.subtitle?t.subtitle:D[t.step_type]?p.formatMessage(D[t.step_type]):null},`subtitle-${o}`)]}),e.jsx(_,{size:"large",color:"primary",onClick:x,loading:c,disabled:c,children:e.jsx(f,{...g?r.finish:r.next})})]})}),e.jsx("div",{className:"relative flex h-full flex-1 flex-col pb-16 pt-16",children:e.jsx("div",{className:"h-full w-full overflow-auto rounded-[30px] bg-token-main-surface-primary shadow-2xl shadow-token-border-xlight",children:e.jsx(_e,{hideHeader:!0,hideTools:!0,embedded:!0})})})]})}const Pe=({clientThreadId:t,setClientThreadId:n})=>{const o=ge(t),l=me(),{onThreadCreated:a}=fe({clientThreadId:t,setClientThreadId:n}),{onRequestCompletion:i}=xe({clientThreadId:t,currentModelId:o,defaultModelId:l.id,onThreadCreated:a}),c=he(t);return d.useCallback(({stepPrompt:s})=>{const p=new be,g=`${c}-nextPrompt`,x=()=>{we.updateTree(t,h=>{h.addNode(g,s,c,J.User,void 0,void 0)})};i({type:H.Next,promptId:g,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!0,completionMetadata:{conversationMode:G(ye.getConversationMode(t))},updateTree:x,turnTracker:p})},[t,i,c])},r=V({skip:{defaultMessage:"Skip",id:"chatgpt.new-onboarding.skip"},close:{defaultMessage:"Close",id:"chatgpt.new-onboarding.close"},submit:{defaultMessage:"Submit",id:"chatgpt.new-onboarding.submit"},next:{defaultMessage:"Next",id:"chatgpt.new-onboarding.next"},finish:{defaultMessage:"Finish",id:"chatgpt.new-onboarding.finish"},mainWayToUse:{defaultMessage:"What’s the main way you’ll use ChatGPT?",id:"chatgpt.new-onboarding.main-way-to-use"},school:{defaultMessage:"School",id:"chatgpt.new-onboarding.school"},work:{defaultMessage:"Work",id:"chatgpt.new-onboarding.work"},personalTasks:{defaultMessage:"Personal tasks",id:"chatgpt.new-onboarding.personal-tasks"},funAndEntertainment:{defaultMessage:"Fun and entertainment",id:"chatgpt.new-onboarding.fun-and-entertainment"},niceToMeetYou:{defaultMessage:"Nice to meet you, {name}!",id:"chatgpt.new-onboarding.nice-to-meet-you-with-name"},preparingOnboardingExperience:{defaultMessage:"Preparing your onboarding experience...",id:"chatgpt.new-onboarding.preparing-onboarding-experience"},oneLastQuestion:{defaultMessage:"One last question -",id:"chatgpt.new-onboarding.one-last-question"},anythingElseYouWantMeToKnow:{defaultMessage:"Anything else you'd like me to know?",id:"chatgpt.new-onboarding.anything-else-you-want-me-to-know"},helpMeCurateWhatToShow:{defaultMessage:"This will help me curate what to show you next.",id:"chatgpt.new-onboarding.help-me-curate-what-to-show"},exampleSchoolSelfDescription:{defaultMessage:"I'm a college student studying computer science, and I love to play the guitar.",id:"chatgpt.new-onboarding.example-school-self-description"},exampleWorkSelfDescription:{defaultMessage:"I'm a graphic designer based in Berlin, and I enjoy painting and attending art exhibitions.",id:"chatgpt.new-onboarding.example-work-self-description"},examplePersonalTasksSelfDescription:{defaultMessage:"I live in Sydney and love cooking new recipes and planning travel itineraries.",id:"chatgpt.new-onboarding.example-personal-tasks-self-description"},exampleFunAndEntertainmentSelfDescription:{defaultMessage:"I'm a music enthusiast based in Nashville, and I can talk for hours about guitar techniques and songwriting.",id:"chatgpt.new-onboarding.example-fun-and-entertainment-self-description"}}),I={usage_question:r.mainWayToUse},D={usage_question:r.helpMeCurateWhatToShow};export{Me as LoadingState,Ye as default};
//# sourceMappingURL=et5pgbnvaq8d6kko.js.map
