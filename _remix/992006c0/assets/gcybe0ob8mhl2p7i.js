import{r as h,j as e,c as E,M as x,v as q,L as we}from"./nqo5y2f0dorhrqsr.js";import{h4 as Ie,eQ as _,b8 as a,hz as Fe,hA as U,hB as Te,hC as ee,hD as Me,hE as A,hF as te,hG as se,hH as D,hI as Pe,hJ as ne,aU as Ee,hh as De,eD as Oe,hK as _e,hL as Ue,hM as Ae,hN as Le,hO as Be,hP as Re,hQ as ze,f0 as Ge,eE as He,hR as R,hS as Y,hT as Xe,hU as z,hV as Ze,bx as Ve,hW as Qe,hX as We,hY as $e,hZ as H,h_ as Ye,aL as Ke,h$ as Je,i0 as qe,i1 as et,i2 as oe,cg as tt,i3 as st,i4 as nt,hm as ot,eV as rt,h5 as it,dm as at,i5 as lt,i6 as ct,i7 as dt,k as ut,i8 as K,i9 as mt,ia as xt}from"./ob2kjer3jenmmp3x.js";import{as as N,cg as re,bd as ht,av as X,V as ft,F as Z,bM as O,bL as ie,aZ as G,P as ae,e as le,b2 as gt,d_ as ce,bZ as pt,bo as jt,b$ as vt,bB as bt,fE as yt,dY as St}from"./cupmtu2e3gr6f9u2.js";import{S as Ct}from"./jujg8edbx5xm3whm.js";import{P as Nt}from"./nh1qwxf7uo20o2cg.js";import"./djpe2ctqrsum97u7.js";import"./lcg8hjmelswuvhqa.js";import"./jia4v37079g3n9z8.js";import"./koia3902t4l8lyfh.js";const kt=[null,"#F14D42","#E36E30","#B98618","#DB9F1E","#3DCB40","#30A633","#27C0A6","#16B7DB","#6490F0","#0088FF","#1D53BF","#512AEB","#875BE1","#EE4D83","#E659C2"];function wt({color:t,active:n,onClick:s}){const o=E();return e.jsx("button",{onClick:()=>s(t),className:"flex h-10 w-10 items-center justify-center rounded-full bg-token-text-primary can-hover:hover:scale-110 can-hover:active:scale-100","aria-label":t??o.formatMessage(a.defaultColor),style:{backgroundColor:t??void 0},children:n&&e.jsx(Fe,{className:"h-6 w-6 text-token-main-surface-primary"})})}function It({currentTheme:t,onSelect:n}){return e.jsx("div",{className:"m-4 grid grid-cols-4 gap-4",children:kt.map(s=>e.jsx(wt,{active:s===t,color:s,onClick:o=>{n(o)}},s))})}const Ft=({currentTheme:t,isPopoverOpen:n,...s},o)=>e.jsxs("button",{ref:o,...s,className:"group relative flex h-[60px] w-[60px] items-center justify-center",children:[e.jsx("div",{className:N("absolute flex h-full w-full items-center justify-center rounded-full",t&&"opacity-10",!t&&"bg-token-main-surface-secondary"),style:{backgroundColor:t??void 0}}),e.jsx("div",{className:"relative flex h-full w-full items-center justify-center",children:e.jsx(Ie,{className:"icon-lg duration-200 ease-out can-hover:group-hover:scale-110",style:{color:t}})}),e.jsx("div",{className:N("absolute bottom-0 right-0 flex h-6 w-6 scale-0 items-center justify-center rounded-full border border-token-border-light bg-token-main-surface-primary text-token-text-secondary opacity-0 drop-shadow-sm duration-200 ease-out group-hover:scale-100 group-hover:opacity-100",n&&"scale-100"),children:e.jsx(_,{className:"h-[18px] w-[18px] rounded-full text-token-text-secondary"})})]}),Tt=h.forwardRef(Ft);function V({file:t,fileName:n,fileId:s,gizmoId:o}){const i=U(n)&&s!=null,r=Te(t&&ee(t)?t:null,n,s,o,void 0);return i?e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-[#129FBF] bg-cover bg-center text-white",style:{backgroundImage:`url(${r})`},children:!r&&e.jsx(Me,{className:"icon-lg"})}):null}function Mt({gizmoId:t,gizmoName:n,pendingFiles:s,files:o,modelCapacityUsed:i,interpreterOnlyFileIds:r,onAddFiles:l,removePendingFile:c,pendingFileUpsertMutationsRef:d}){return s.length===0&&o.length===0?e.jsx(Ot,{gizmoName:n,onAddFiles:l}):e.jsx("div",{children:e.jsx(Pt,{gizmoId:t,modelCapacityUsed:i,files:o,pendingFiles:s,interpreterOnlyFileIds:r,removePendingFile:c,pendingFileUpsertMutationsRef:d})})}function Pt({gizmoId:t,modelCapacityUsed:n,files:s,pendingFiles:o,interpreterOnlyFileIds:i,removePendingFile:r,pendingFileUpsertMutationsRef:l}){const c=A();return s.length===0&&o.length===0?null:e.jsxs("div",{className:"overflow-hidden rounded-lg border border-token-border-light",children:[n&&n>1?e.jsxs("div",{className:"border-b border-token-border-light bg-gray-50 px-4 py-3 text-xs text-token-text-secondary dark:bg-gray-750",children:[e.jsx("div",{className:"font-medium",children:e.jsx(x,{...a.tooManyFilesTitle})}),e.jsx("div",{children:e.jsx(x,{...a.tooManyFilesDescription})})]}):null,s.map(d=>e.jsx(Dt,{gizmoId:t,gizmoFile:d,interpreterOnly:i.includes(d.file_id),onDelete:async()=>{const u=new Promise(p=>{l.current.push({id:t,mutationId:q(),update:j=>{const g=j.files.filter(y=>y.file_id!==d.file_id);return{...j,files:g}},onSuccess:p})});return te(t)({gizmoId:t,upsertProjectMutation:c,pendingFileUpsertMutationsRef:l}),u}},d.file_id)),o.map(d=>e.jsx(Et,{interpreterOnly:i.includes(d.tempId),pendingFile:d,onDelete:async()=>r(d.tempId)},d.tempId))]})}function de(){return e.jsx(ht,{sideOffset:0,label:e.jsx("div",{className:"text-balance",children:e.jsx(x,{...a.interpreterOnlyFileDescription})}),side:"bottom",size:"small",children:e.jsxs("div",{className:"truncate",children:[e.jsx(x,{...a.interpreteronlyLabel}),e.jsx(Ee,{className:"icon-sm relative bottom-[1px] ml-1 inline-block"})]})})}function Et({pendingFile:t,onDelete:n,interpreterOnly:s}){const o=t.file.name,r=(ee(t.file)&&t.file?.type.startsWith("image/")||U(o))&&e.jsx(V,{file:t.file,fileName:o,fileId:t.fileId??void 0,gizmoId:t.gizmoId??void 0});return e.jsx(ue,{interpreterOnly:s,onDelete:n,children:e.jsx(se,{icon:r,fileName:t.file.name,loadingPercentage:t.status===D.Uploading?t.progress:void 0,customFileDescription:s?e.jsx(de,{}):void 0})})}function Dt({gizmoFile:t,gizmoId:n,interpreterOnly:s,onDelete:o}){const i=t.name,l=U(i)&&t.file_id!=null&&e.jsx(V,{fileName:i,fileId:t.file_id,gizmoId:n});return e.jsx(ue,{interpreterOnly:s,onDelete:o,children:e.jsx(se,{icon:l,fileName:t.name,customFileDescription:s?e.jsx(de,{}):void 0})})}function ue({children:t,onDelete:n,interpreterOnly:s}){const[o,i]=h.useState(!1);return e.jsxs("div",{className:N("group flex w-full justify-between border-b border-token-border-light px-3 py-2 text-sm last:border-b-0",s&&"grayscale"),children:[e.jsx("div",{className:"w-10/12 can-hover:w-full can-hover:group-hover:w-11/12",children:t}),e.jsx("div",{className:N("flex shrink-0 grow-0 bg-token-main-surface-primary pl-1 can-hover:group-hover:flex",!o&&"can-hover:hidden"),children:o?e.jsx("div",{className:"flex h-full w-6 items-center justify-center",children:e.jsx(re,{})}):e.jsx("button",{onClick:async()=>{n&&(i(!0),await n(),i(!1))},children:e.jsx(Pe,{className:"text-token-secondary rounded-full hover:bg-token-main-surface-secondary dark:hover:bg-token-main-surface-tertiary"})})})]})}function Ot({gizmoName:t,onAddFiles:n}){return e.jsx("div",{className:"flex h-full cursor-pointer items-center justify-center rounded-lg border border-token-border-light px-4 py-3 active:bg-token-main-surface-tertiary",onClick:n,children:e.jsxs("div",{className:"flex flex-col items-center gap-2 py-4 text-sm text-token-text-secondary",children:[e.jsx(ne,{}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"max-w-100 text-token-text-secondary",children:e.jsx(x,{...a.emptyFileInstructions,values:{gizmoNameText:e.jsx("span",{className:"font-bold",children:e.jsx(x,{...a.emptyFileGizmoName,values:{gizmoName:t}})},"gizmoNameText")}})})})]})})}const me=X.div`text-sm text-red-500`,_t=X.textarea`w-full text-sm overflow-y-auto overflow-x-clip rounded-lg border px-3 py-2 focus:ring-2 focus:ring-token-text-primary border-token-border-medium bg-token-main-surface-primary`,B=20;function xe({onClose:t,gizmo:n}){const s=E(),[o,i]=h.useState(n?.gizmo?.instructions||""),r=A(),l=Z(),c=[];o?.length>R&&c.push(s.formatMessage(a.instructionsTooLong,{length:R}));const d=g=>{i(g.target.value)},u=()=>{t()},f=async()=>{try{await r.mutateAsync({update:{instructions:o??""},id:n.gizmo.id}),t()}catch(g){const y=ce(g);l.danger(y??"Error",{duration:2})}},p=e.jsx(O.Button,{title:s.formatMessage(a.save),color:"primary",onClick:f,loading:r.isPending,disabled:c.length>0}),j=e.jsx(O.Button,{title:s.formatMessage(a.cancel),color:"secondary",onClick:u,disabled:r.isPending});return e.jsx(ie,{className:"min-h-72 max-w-[820px] md:min-h-[600px]",isOpen:!0,showCloseButton:!r.isPending,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",title:e.jsx("div",{className:"h-8",children:s.formatMessage(a.editCustomInstructionsTitle)}),onClose:()=>{r.isPending||t()},children:e.jsxs("div",{className:"flex h-full flex-col px-6 pb-7 pt-0",children:[e.jsx("div",{className:"text-sm font-medium",children:s.formatMessage(a.editCustomInstructionsSubtitle)}),e.jsx("div",{className:"text-sm text-token-text-secondary",children:s.formatMessage(a.editCustomInstructionsDescription)}),e.jsx(_t,{autoFocus:!0,placeholder:s.formatMessage(a.projectInstructionsPlaceholder),className:"mb-1 mt-4 min-h-24 w-full flex-grow resize-none rounded-md bg-token-main-surface-primary",onChange:d,value:o,disabled:r.isPending}),c.map(g=>e.jsx(me,{className:"mt-1",children:g},g)),e.jsx(O.Actions,{primaryButton:p,secondaryButton:j})]})})}function Ut({gizmoId:t,gizmoName:n,gizmoEditorData:s,openFileDialog:o,pendingFiles:i,setVersion:r,pendingFileUpsertMutationsRef:l,currentModelConfig:c}){const d=s?.files?.reduce((m,v)=>m+(v.file_size_tokens??0),0)??0,u=s?.contextStuffingBudget;let f;u&&(f=d/u,d>0&&f<.01&&(f=.01));const p=s?.files??[],j=Array.from(i.current.values()).filter(m=>p.every(v=>v.file_id!==m.fileId)),g=j.filter(m=>c!=null&&z(c,m.file.type,m.file.name)===G.CodeInterpreter),y=p.filter(m=>c!=null&&m.type!=null&&z(c,m.type,m.name)===G.CodeInterpreter),k=[...g.map(m=>m.tempId),...y.map(m=>m.file_id)];return e.jsx(Mt,{gizmoId:t,gizmoName:n,pendingFiles:j,pendingFileUpsertMutationsRef:l,files:p,modelCapacityUsed:f,interpreterOnlyFileIds:k,onAddFiles:o,removePendingFile:m=>{i.current.delete(m),r(v=>v+1)}})}const At=h.forwardRef(function({gizmo:n,showInstructions:s=!0,setIsDirty:o},i){const r=E(),[l,c]=h.useState(!1),d=A(),u=De(n),f=Oe(u),{data:p}=_e(),j=p?.modelsList.find(S=>S.tags.includes(ft.GPT_4o))??p?.modelsList.find(S=>S.id===Ue),g=Z(),[y,k]=h.useState(0),m=h.useRef(new Map),v=h.useRef([]);h.useEffect(()=>{o&&o(()=>()=>m.current.size>0||v.current.length>0)},[m,v,o]);const pe=Ae(j,void 0),je=S=>{S.some(({errors:w})=>w.length!==1||w[0]?.code!==Ze.TooManyFiles)?g.danger(r.formatMessage(a.unknownError),{duration:2}):g.danger(r.formatMessage(a.dragTooManyFilesError,{MAX_FILES_PER_PROJECT:B}),{duration:2})},ve=async S=>{ae.logEvent(le.uploadFile,{client:"web",eventSource:"mouse",intent:"gizmo"});const w=u.id;S.length>0&&await Promise.all(S.map(I=>{const L=Ve(I);m.current.set(L,{tempId:L,gizmoId:w,file:I,status:D.Uploading,progress:1,fileId:null,cdnUrl:null}),Qe(L,I,r,g,{kind:gt.Gizmo,gizmoId:w},{onFileUploaded:async(b,T,M,F)=>{const C=m.current.get(b);C?.fileId&&C?.fileId&&(v.current.push({id:n.gizmo.id,mutationId:q(),update:P=>{if(!C.fileId)return P;const ke=[...P.files??[],{file_id:C.fileId,name:C.file.name,size:C.file.size,type:F?.mimeType??We(C.file),last_modified:C.file.lastModified,file_size_tokens:F?.fileTokenSize}];return{...P,files:ke}},onSuccess:()=>{m.current.delete(b),k(P=>P+1)}}),te(n.gizmo.id)({gizmoId:n.gizmo.id,upsertProjectMutation:d,pendingFileUpsertMutationsRef:v}))},onFileCreated:(b,T,M)=>{m.current.set(b,{tempId:b,gizmoId:w,file:I,status:D.Uploading,progress:1,...m.current.get(b),fileId:T,cdnUrl:M}),k(F=>F+1)},onFileUploadProgress:(b,T)=>{const M=m.current.get(b);M?.status===D.Uploading&&m.current.set(b,{...M,progress:T>95?95:T}),k(F=>F+1)},onError:b=>{m.current.delete(b)}},{usesRetrievalIndex:j!=null&&z(j,I.type,I.name)===G.Retrieval})}))},Q=Le(pe),W=Be(Q),be=m.current.size+u.files.length,{open:$,getInputProps:ye,getRootProps:Se,isDragAccept:Ce,isDragReject:Ne}=Re({noClick:!0,noDragEventsBubbling:!0,onDropAccepted:ve,onDropRejected:je,multiple:!0,maxSize:ze,maxFiles:B-be,...Q});return h.useImperativeHandle(i,()=>({openFileDialog:$})),e.jsxs("div",{...Se({className:"relative h-full px-6"}),children:[e.jsx("input",{...ye()}),s&&e.jsxs(Ge,{children:[e.jsx("button",{className:"w-full",onClick:()=>c(!0),children:e.jsx("div",{className:"w-full rounded-lg border border-token-border-light text-left text-sm",children:u?.instructions?.length?e.jsx("div",{className:"mx-4 my-3 line-clamp-4",children:u.instructions}):e.jsxs("div",{className:"flex h-full w-full items-center px-4 py-3 text-token-text-secondary",children:[e.jsx("div",{className:"flex-1",children:e.jsx(x,{...a.addCustomInstructions})}),e.jsx(_,{className:"icon-sm"})]})})}),f.includes(He.GizmoInstructionsTooLong)?e.jsx(me,{className:"mt-1",children:e.jsx(x,{...a.instructionsTooLong,values:{length:R}})}):null]}),l&&e.jsx(xe,{gizmo:n,onClose:()=>{c(!1)}}),e.jsx(Ut,{gizmoId:n.gizmo.id,gizmoName:n.gizmo.display.name,gizmoEditorData:u,openFileDialog:$,pendingFiles:m,pendingFileUpsertMutationsRef:v,setVersion:k,currentModelConfig:j}),Ce&&e.jsxs(Y,{children:[e.jsx(Xe,{}),e.jsx("h3",{children:e.jsx(x,{...a.dragInstructions})}),e.jsx("h4",{className:"w-2/3 text-center",children:W.length>0?W.join(", "):e.jsx(x,{...a.dragAllAccepted})})]}),Ne&&e.jsxs(Y,{children:[e.jsx(Ct,{className:"icon-2xl"}),e.jsx("h3",{children:e.jsx(x,{...a.dragTooManyFiles})}),e.jsx("h4",{className:"w-2/3 text-center",children:e.jsx(x,{...a.dragTooManyFilesDescription,values:{MAX_FILES_PER_PROJECT:B}})})]})]})});function Lt({gizmo:t,onClose:n}){const s=E(),[o,i]=h.useState(!1),[r,l]=h.useState(()=>()=>!1),c=h.useRef(null),d=h.useCallback(()=>{c.current?.openFileDialog()},[c]);return e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"min-h-72 max-w-[820px] md:min-h-[600px]",isOpen:!0,showCloseButton:!0,hideSeparator:!0,noPadding:!0,size:"custom",type:"success",onClose:()=>{r()?i(!0):n()},children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx(O.TitleBar,{$hasSeparator:!1,children:e.jsxs("div",{className:"flex w-full items-center gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(pt,{className:"text-lg font-semibold leading-6 text-token-text-primary",children:e.jsx(x,{...a.projectFilesModalTitle})})}),e.jsx(jt,{color:"secondary",onClick:d,children:e.jsx(x,{...a.addFilesButtonLabel})}),e.jsx(vt,{asChild:!0,className:"sm:mt-0",children:e.jsx(bt,{onClick:n})})]})}),e.jsx("div",{className:"mb-6 flex-grow overflow-y-auto pt-0",children:e.jsx(At,{ref:c,gizmo:t,showInstructions:!1,setIsDirty:l})})]})}),o&&e.jsx($e,{isOpen:!0,title:s.formatMessage(a.projectFilesUnsavedChangesTitle),description:"",primaryButtonColor:"danger",confirmText:s.formatMessage(a.projectFilesUnsavedChangesConfirm),onClose:()=>{i(!1)},onConfirm:()=>{n()},children:e.jsx("div",{className:"text-sm",id:"snorlax-unsaved-changes-description",children:e.jsx(x,{...a.projectFilesUnsavedChangesDescription})})})]})}function Bt({gizmo:t}){return e.jsxs("div",{className:"mt-6 grid grid-cols-1 items-start gap-5 xs:grid-cols-2",children:[e.jsx(Rt,{gizmo:t}),e.jsx(Gt,{gizmo:t})]})}function he({header:t,context:n,contextClassName:s="",icon:o,modal:i,onClick:r,isModalOpen:l=!1}){return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:r,className:"group/snorlax-control-tile relative h-full rounded-2xl border border-token-border-xlight bg-token-main-surface-primary shadow-xxs hover:bg-token-main-surface-secondary active:bg-token-main-surface-tertiary active:drop-shadow-none",children:e.jsxs("div",{className:"relative mx-5 my-4 flex items-center justify-between gap-3 overflow-hidden",children:[e.jsxs("div",{className:"w-full grow text-left",children:[e.jsx("div",{className:"text-sm font-medium",children:t}),e.jsx("div",{className:N("text-xs text-token-text-secondary",s),children:n})]}),o]})}),l&&i]})}function Rt({gizmo:t}){const{files:n}=t,s=!n.length,o=H(t.gizmo.id),[i,r]=h.useState(!1),l=i&&e.jsx(Lt,{gizmo:t,onClose:()=>{r(!1)}}),c=()=>r(!0);let d,u,f;if(s)d=e.jsx(x,{...a.addFilesButtonLabel}),u=e.jsx(x,{...a.filesControlDescription}),f=e.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[e.jsx("div",{className:"absolute h-full w-full rounded-full bg-token-main-surface-secondary opacity-5",style:{backgroundColor:o??void 0}}),e.jsx(ne,{className:"icon-md h-5 w-5",style:{color:o}})]});else{const j=n.slice(0,3);d=e.jsx(x,{...a.projectFilesModalTitle}),u=e.jsx(x,{...a.filesCount,values:{count:n.length}}),f=e.jsx("div",{className:"relative flex h-10 w-20 shrink-0 items-center justify-center rounded-full",children:j.toReversed().map((g,y)=>e.jsx(zt,{file:g,index:y,gizmoId:t.gizmo.id},g.id))})}return e.jsx(he,{isModalOpen:i,modal:l,onClick:c,header:d,context:u,icon:f})}function zt({file:t,index:n,gizmoId:s}){const o=t.name,r=U(o)&&t.file_id!=null&&e.jsx(V,{fileName:o,fileId:t.file_id,gizmoId:s});return e.jsx("div",{className:"absolute right-0 top-0 h-10 w-10 overflow-hidden rounded-xl border-2 border-token-main-surface-primary group-hover/snorlax-control-tile:border-token-main-surface-secondary",style:{transform:`translateX(${n*-20}px)`},children:r||e.jsx(Ye,{className:"h-9 w-9 flex-shrink-0",filename:t.name,contextConnectorInfo:void 0})})}function Gt({gizmo:t}){const{instructions:n}=t.gizmo,s=!n.length,o=H(t.gizmo.id),[i,r]=h.useState(!1),l=i&&e.jsx(xe,{gizmo:t,onClose:()=>{r(!1)}}),c=()=>r(!0);let d,u,f,p;return s?(d=e.jsx(x,{...a.customInstructionsTitle}),u=e.jsx(x,{...a.customInstructionsDescription}),f=e.jsxs("div",{className:"relative flex h-10 w-10 shrink-0 items-center justify-center rounded-full",children:[e.jsx("div",{className:"absolute h-full w-full rounded-full bg-token-main-surface-secondary opacity-5",style:{backgroundColor:o??void 0}}),e.jsx(_,{className:"icon-md h-5 w-5",style:{color:o}})]})):(d=e.jsx(x,{...a.editCustomInstructionsTitle}),p="overflow-hidden text-ellipsis whitespace-nowrap",u=n),e.jsx(he,{isModalOpen:i,modal:l,onClick:c,header:d,context:u,icon:f,contextClassName:p})}const fe=X.h3`p4 overflow-hidden text-ellipsis break-all py-3 px-4 text-xs font-semibold text-token-text-secondary`,J=new Map;function Ht(t){const n=J.get(t);if(n)return n;const s=ut(Xt,2e3,{trailing:!0});return J.set(t,s),s}async function Xt({gizmoId:t,upsertProjectMutation:n,toaster:s}){const o=xt,i=K(o.getState(),"theme",t);try{i!==void 0&&await n.mutateAsync({id:t,update:{theme:i??void 0}}),K(o.getState(),"theme",t)===i&&mt(t,"theme")}catch(r){const l=ce(r);s.warning(l??"Error",{duration:2})}}function Zt({gizmoId:t,theme:n,upsertProjectMutation:s,toaster:o}){dt(t,"theme",n),Ht(t)({gizmoId:t,upsertProjectMutation:s,toaster:o})}function Vt({gizmo:t}){const n=t.gizmo.display.emoji,s=H(t.gizmo.id),o=st(),i=A(),[r,l]=h.useState(!1),c=Z();if(o&&n)return e.jsx(nt,{emoji:n,className:"icon-lg text-2xl"});const d=u=>{u!==s&&Zt({gizmoId:t.gizmo.id,theme:u,upsertProjectMutation:i,toaster:c})};return e.jsx(ot,{open:r,sideOffset:4,alignOffset:7,side:"bottom",alignAgainstAnchor:"start",size:"none",modal:!0,onOpenChange:u=>l(u),triggerButton:e.jsx(Tt,{currentTheme:s,isPopoverOpen:r}),children:e.jsx(It,{currentTheme:s,onSelect:d})})}function Qt({gizmo:t}){return e.jsxs("div",{className:"mb-6 flex w-full flex-col px-4",children:[e.jsx(Vt,{gizmo:t}),e.jsxs("button",{className:"group ml-1 mt-3 self-start text-balance text-left text-4xl font-semibold hover:text-token-text-secondary",onClick:()=>{oe.setShowProjectSettingsModal(!0)},children:[t.gizmo.display.name,e.jsx(_,{className:"icon-lg ml-2.5 inline-block text-token-text-secondary opacity-0 group-hover:opacity-100 motion-safe:transition-opacity motion-safe:duration-100"})]})]})}function ge({children:t}){return e.jsx("div",{className:"group relative flex flex-col gap-1 p-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(rt,{className:"icon-md text-token-sidebar-icon"}),t]})})}function Wt({conversation:t,gizmo:n}){const s=yt(t.id)??t.title,[o,i]=h.useState(!1);h.useEffect(()=>St(it,{editTitleInMainScreen:({serverThreadId:c})=>{c===t.id&&i(!0)}}),[t.id]);const{snippet:r}=t,l=e.jsxs(ge,{children:[e.jsxs("div",{className:"flex-grow overflow-hidden group-hover:mr-5",children:[o?e.jsx(lt,{conversation:t,onClose:()=>{i(!1)}}):e.jsx("div",{className:"text-sm font-medium",children:s}),r&&e.jsx("div",{className:"truncate text-sm text-token-text-secondary",children:r})]}),!o&&e.jsx($t,{conversation:t})]});return o?l:e.jsx(we,{to:at(t.id,n),children:l})}function $t({conversation:t}){const[n,s]=h.useState(!1);return e.jsx("div",{className:N("absolute bottom-0 top-0 items-center gap-1.5 pr-4 ltr:right-0 rtl:left-0",n?"flex":"hidden can-hover:group-hover:flex"),onClick:o=>{o.preventDefault()},children:e.jsx(ct,{conversation:t,conversationTitle:t.title,onOpenChange:o=>{s(o),o&&ae.logEvent(le.conversationHistoryItemOpenMenu,{conversationId:t.id})},inMainScreen:!0})})}function Yt({gizmo:t}){const{items:n,hasNextPage:s,fetchNextPage:o,isLoading:i,isFetchingNextPage:r}=tt(t.gizmo.id),l=h.useRef(null),c=h.useCallback(u=>{i||u==null||(l.current?.disconnect(),l.current=new IntersectionObserver(f=>{f[0].isIntersecting&&s&&o()}),l.current.observe(u))},[i,s,o]);h.useEffect(()=>()=>{l.current?.disconnect()},[]);const d=n.length;return e.jsxs("div",{className:"mb-14 mt-6",children:[d||i?e.jsx(Jt,{gizmo:t,items:n??[],hasNextPage:s,infiniteScrollTriggerElementRef:c}):e.jsx(Kt,{}),r&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(re,{})})]})}function Kt(){return e.jsxs(e.Fragment,{children:[e.jsx(fe,{children:e.jsx(x,{...a.emptyChatsInProjectTitle})}),e.jsx("ol",{children:Array.from({length:5}).map((n,s)=>e.jsx("li",{style:{opacity:1-s*.2,transition:"opacity 0.3s ease-in-out"},className:N(s!==4&&"border-b border-token-border-xlight"),children:e.jsx(ge,{children:e.jsxs("div",{className:"my-2 flex w-full flex-col gap-2",children:[e.jsx("div",{className:"h-2 w-2/12 rounded-full bg-token-main-surface-tertiary"}),e.jsx("div",{className:"h-2 w-5/12 rounded-full bg-token-main-surface-tertiary"})]})})},s))})]})}function Jt({gizmo:t,items:n,hasNextPage:s,infiniteScrollTriggerElementRef:o}){const i=n.length;return e.jsxs(e.Fragment,{children:[e.jsx(fe,{children:e.jsx(x,{...a.chatsInProjectTitle})}),e.jsx("ol",{children:n.map((r,l)=>{const c=s&&l===n.length-3?o:void 0;return e.jsx("li",{ref:c,className:N("first:rounded-t-lg last:rounded-b-lg hover:bg-token-main-surface-secondary",l!==i-1&&"border-b border-token-border-xlight"),children:e.jsx(Wt,{conversation:r,gizmo:t})},r.id)})})]})}function cs({clientThreadId:t,gizmoId:n,currentModelId:s,onRequestCompletion:o}){const i=E(),{data:r}=Ke(n),l=Je(c=>c.showProjectSettingsModal);return r?e.jsxs(qe,{isStaticSharedThread:!1,withVerticalPadding:!1,withHorizontalPadding:!0,clientThreadId:t,fullHeight:!0,children:[e.jsx(Qt,{gizmo:r}),e.jsx(Nt,{clientThreadId:t,isNewThread:!0,currentModelId:s,onRequestCompletion:o,hideHeader:!0,showPromptStarters:!1}),e.jsx(Bt,{gizmo:r}),e.jsx(Yt,{gizmo:r}),l&&e.jsx(et,{modalTitle:i.formatMessage(a.projectSettingsTitle),submitButtonTitle:i.formatMessage(a.projectSettingsSubmitButton),gizmo:r,onClose:()=>{oe.setShowProjectSettingsModal(!1)}},n)]}):null}export{cs as SnorlaxSplashScreen};
//# sourceMappingURL=gcybe0ob8mhl2p7i.js.map
