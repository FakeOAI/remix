const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ei514gsjc0obnebc.js","assets/nhth9ejvp1y38gpf.js","assets/j7o3ku4ystlh3gs9.js","assets/root-i54zhw2b.css","assets/pdsi9ig2nufco8yv.js","assets/conversation-small-ict01xsi.css","assets/i5sv5y5gruib3xfa.js","assets/dtflysr404lsk4o9.js","assets/mfj415wp2kzbofro.js","assets/ef7i8cnsnjwg6cb4.js","assets/m8z27nzcdqlfi2wy.js","assets/djym0t15fkaljjnz.js","assets/nvza0kae4ixs2irp.js","assets/dqt8vapwgdv2t4a7.js","assets/lufuaq56v5g343ut.js","assets/h880g7w86m78fpxi.js","assets/b9i3h6jrv605lfsp.js","assets/textdoc-sandpack-code-preview-mk0lbw6o.css"])))=>i.map(i=>d[i]);
import{aE as on,aF as rn,a6 as l,ar as V,r as C,aj as B,aK as rt,c4 as ee,R as Oe,a7 as an,d2 as ln,aY as re,ak as be,bR as un,bS as cn,bT as fn,a8 as dn,h as At,l as mn,g6 as at,b as it,j as kt,al as hn,a0 as pn}from"./nhth9ejvp1y38gpf.js";import{jk as j,fQ as _,lv as gn,dK as vn,fG as Cn,dJ as Tn,dM as yn,lw as xn,bp as Dt,k0 as It,k1 as ae,lx as Nt,jO as lt,bH as X,jV as ie,B as wn,ly as xe,hK as Lt,fT as le,lz as we,hI as En,jE as Pt,hC as _t,lA as Ot,Z as L,jU as Sn,lB as bn,lf as Mn,fp as An,cl as kn,lc as Dn,lC as In,ce as Nn,dj as Ln,v as ut,lD as P,lE as Pn,lF as Rt,lG as _n,lH as On,d as Rn,lI as jn,lJ as Hn,lK as $n,fF as Un,lL as qn,lM as Fn,fw as Bn,lN as Vn,fy as Gn,lO as zn,j$ as Yn,hD as Wn,fz as Jn,fA as Qn,hF as Xn,lP as Zn,b1 as Kn,lQ as es,lR as ts,lS as ns,lT as ss,_ as ct,lU as os,lV as rs,k2 as as,lW as ft,lX as is,jH as te}from"./pdsi9ig2nufco8yv.js";import{O as ls,k as se,l as us,A as cs,m as fs,D as ds}from"./mfj415wp2kzbofro.js";import{e as ms,C as hs}from"./cecry7adp0vq1lf7.js";import{S as ps}from"./ibjqkle5a79o3ujj.js";import{C as Ee,a0 as gs,$ as vs,S as Q,a1 as dt}from"./dtflysr404lsk4o9.js";import{m as oe}from"./m8z27nzcdqlfi2wy.js";import{D as Cs}from"./jcu9x0cjixuya53l.js";import{ad as Ts,ar as ys,ah as xs,bY as ws,bZ as Es,x as Ss,aO as bs,B as Ms}from"./j7o3ku4ystlh3gs9.js";import{i as As}from"./l5nst029wr6o369g.js";import{C as ks}from"./ofo3fx489scoaaw9.js";import{P as Ds}from"./djym0t15fkaljjnz.js";import{u as Is}from"./enor1i9cpis82iny.js";import{u as Ns}from"./gdzrn191qzrz1ytf.js";var Re=(t=>(t.Close="close",t.Loaded="loaded",t.Streaming="streaming",t.Download="download",t))(Re||{});function Ls(t){return t.includes("'react'")||t.includes('"react"')}function Ps(t,e){switch(t){case j.CODE_HTML:return"static";case j.CODE_REACT:return"react";case j.CODE_JAVASCRIPT:case j.CODE_TYPESCRIPT:return Ls(e)?"react":void 0;default:return}}function jt(t,e){return Ps(t,e)!=null}function mt(){if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof global<"u")return global;if(typeof self<"u")return self;throw new Error("Unable to locate global object.")}function _s(){const t=eval;function e(n){return n==="this"?mt():t(n)}try{mt().eval=e}catch(n){_.logError("Failed to polyfill eval",n)}}_s();const Os=on(()=>rn(()=>import("./ei514gsjc0obnebc.js").then(t=>t.t),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17])).then(t=>t.TextdocSandpackCodePreview),{fallback:()=>l.jsx("div",{className:"h-full w-full",children:"Failed to load"}),loading:()=>l.jsx("div",{className:"h-full w-full"})});function Rs(t){return l.jsx(Os,{...t})}function js({hidden:t,isStreaming:e,textdocContent:n,textdocType:s}){return s===j.CODE_HTML?l.jsx(ps,{className:V("min-h-full w-full",{hidden:t}),srcDoc:n}):l.jsx(Rs,{hidden:t,isStreaming:e,textdocContent:n,textdocType:s})}const ht=(t=[])=>t.filter(({status:e})=>e!==gn.DISMISSED),Hs=({isTextdocStreaming:t,isRequestActive:e,value:n,comments:s})=>{const[o,r]=C.useState(!1);return C.useEffect(()=>{t&&o&&(r(!1),Ee.reset())},[n,s]),C.useEffect(()=>{e||(r(!1),Ee.reset())},[e]),[o,r]};function $s({onClickRestore:t,onClickResetLatest:e}){const n=B();return l.jsx(oe.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{bounce:0,duration:.24},className:"absolute bottom-0 left-0 z-30 w-full items-center border-t border-gray-100 bg-token-main-surface-primary p-6 shadow-[0_-4px_32px_rgba(0,0,0,0.08)] @container dark:border-token-border-xlight dark:shadow-[0_-4px_32px_rgba(0,0,0,0.12)] lg:border-l",children:l.jsxs("div",{className:"mx-auto flex max-w-[48rem] flex-col flex-wrap justify-center gap-5 @2xl:flex-row @2xl:justify-between",children:[l.jsxs("div",{className:"flex flex-col px-2 text-center @2xl:text-start",children:[l.jsx("span",{className:"text-md text-wrap font-semibold",children:n.formatMessage({id:"gt23pb",defaultMessage:"You are viewing a previous version"})}),l.jsx("span",{className:"text-wrap text-sm text-token-text-secondary",children:n.formatMessage({id:"sAlUJn",defaultMessage:"Restore this version to make edits"})})]}),l.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4",children:[l.jsx(rt,{as:"button",color:"primary",onClick:t,children:n.formatMessage({id:"+cddAb",defaultMessage:"Restore this version"})}),l.jsx(rt,{as:"button",color:"secondary",onClick:e,children:n.formatMessage({id:"qCD3eu",defaultMessage:"Back to latest version"})})]})]})})}const Us={type:"spring",damping:35,stiffness:300},qs=({clientThreadId:t,turn:e})=>{const n=vn(),s=Cn(e.messages);return l.jsxs(oe.div,{className:"absolute left-0 right-0 top-0 z-10 -translate-y-full",children:[l.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-vert-light-gradient dark:bg-vert-dark-gradient"}),l.jsx(oe.div,{className:"flex items-center px-6 py-2",initial:{opacity:.75,translateX:-50,translateY:"100%"},animate:{opacity:1,translateX:0,translateY:"0"},exit:{opacity:0,translateY:20},transition:Us,children:l.jsx(ks,{clientThreadId:t,onChangeItemInView:ee,onRequestCompletion:async o=>ee(o),onRequestMoreCompletions:ee,groupedMessagesToRender:s,allGroupedMessages:s,isEditing:!1,isUserTurn:!0,turnIndex:0,isCompletionRequestInProgress:!1,isFeedbackEnabled:!1,isFinalTurn:!1,hasActiveRequest:n,showEditButton:!1,handleEnterEdit:ee,handleExitEdit:ee})})]},"user-message")},Fs=({clientThreadId:t})=>{const e=Tn(t),n=yn(t,e),{lastUserTurn:s,lastAssistantTurn:o}=C.useMemo(()=>{let a=null,i=null;for(let f=n.length-1;f>0;f--){const u=n[f];if(!a&&u.role===Oe.User?a=u:!i&&u.role===Oe.Assistant&&(i=u),a&&i)break}return{lastUserTurn:a,lastAssistantTurn:i}},[n]),r=s&&!o?.messages.find(({message:a})=>a.recipient?.startsWith(xn));return l.jsx(Dt,{initial:!1,children:r&&l.jsx(qs,{turn:s,clientThreadId:t})})},Bs=({isRequestActive:t=!1,clientThreadId:e,onCancel:n,onSubmit:s,onSubmitAccelerator:o,acceleratorActions:r=[]})=>{const[a,i]=C.useState(!1),[f,u]=C.useState(""),[c,d]=C.useState(!0),h=B(),[x,g]=C.useState(!1),m=gs(),v=()=>{s?.(f),u("")},T=p=>{const{metaKey:S,shiftKey:y,key:A}=p;A==="Enter"&&f.trim()&&!(y||S)&&(v(),p.preventDefault())};return l.jsxs(l.Fragment,{children:[a&&!m&&l.jsx(ls,{zIndexKey:"acceleratorsOverlay",className:"bg-white/95 dark:bg-black/85"}),l.jsx("div",{className:"relative mb-3 flex flex-1 justify-center",children:l.jsxs("div",{className:"mx-6 max-w-2xl flex-1",children:[l.jsx(Fs,{clientThreadId:e}),l.jsx("div",{className:"flex flex-auto items-start",children:l.jsx("div",{className:V("flex min-h-12 flex-auto items-center bg-[#f4f4f4] py-1 pl-6 pr-2 dark:bg-token-main-surface-secondary",{"rounded-full":c,"rounded-2xl":!c,"bg-transparent":x}),children:l.jsxs("div",{className:"relative flex flex-auto items-center self-stretch",children:[l.jsx(As,{placeholder:h.formatMessage({id:"zrUbTJ",defaultMessage:"Ask ChatGPT to edit"}),disabled:t,value:f,className:V("w-full resize-none border-0 bg-transparent p-0 text-token-text-primary outline-0 placeholder:text-token-text-secondary focus:ring-0 focus-visible:ring-0",{"opacity-0":x}),maxRows:4,onChange:({target:{value:p}})=>u(p),onKeyDown:T,onHeightChange:(p,{rowHeight:S})=>d(Math.floor(p/S)<=1)}),f?l.jsx(oe.button,{className:V("dark h-8 w-8 rounded-full bg-token-main-surface-primary text-center dark:bg-token-main-surface-primary",{"self-end":!c}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},onMouseDown:()=>v(),children:l.jsx(Ts,{className:"h-8 w-8 text-token-text-primary"})}):(r?.length??0)>0&&l.jsx(vs,{disableHint:!0,disableOverlay:!0,isEmbeddedInPromptArea:!0,isRequestActive:t,actions:r,onCancel:n,onExpandedChange:p=>{m||g(p),i(p)},onSubmit:o,right:0,bottom:4})]})})})]})})]})};function O(){}O.prototype={diff:function(e,n){var s,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=o.callback;typeof o=="function"&&(r=o,o={});var a=this;function i(y){return y=a.postProcess(y,o),r?(setTimeout(function(){r(y)},0),!0):y}e=this.castInput(e,o),n=this.castInput(n,o),e=this.removeEmpty(this.tokenize(e,o)),n=this.removeEmpty(this.tokenize(n,o));var f=n.length,u=e.length,c=1,d=f+u;o.maxEditLength!=null&&(d=Math.min(d,o.maxEditLength));var h=(s=o.timeout)!==null&&s!==void 0?s:1/0,x=Date.now()+h,g=[{oldPos:-1,lastComponent:void 0}],m=this.extractCommon(g[0],n,e,0,o);if(g[0].oldPos+1>=u&&m+1>=f)return i(pt(a,g[0].lastComponent,n,e,a.useLongestToken));var v=-1/0,T=1/0;function p(){for(var y=Math.max(v,-c);y<=Math.min(T,c);y+=2){var A=void 0,M=g[y-1],I=g[y+1];M&&(g[y-1]=void 0);var b=!1;if(I){var H=I.oldPos-y;b=I&&0<=H&&H<f}var $=M&&M.oldPos+1<u;if(!b&&!$){g[y]=void 0;continue}if(!$||b&&M.oldPos<I.oldPos?A=a.addToPath(I,!0,!1,0,o):A=a.addToPath(M,!1,!0,1,o),m=a.extractCommon(A,n,e,y,o),A.oldPos+1>=u&&m+1>=f)return i(pt(a,A.lastComponent,n,e,a.useLongestToken));g[y]=A,A.oldPos+1>=u&&(T=Math.min(T,y-1)),m+1>=f&&(v=Math.max(v,y+1))}c++}if(r)(function y(){setTimeout(function(){if(c>d||Date.now()>x)return r();p()||y()},0)})();else for(;c<=d&&Date.now()<=x;){var S=p();if(S)return S}},addToPath:function(e,n,s,o,r){var a=e.lastComponent;return a&&!r.oneChangePerToken&&a.added===n&&a.removed===s?{oldPos:e.oldPos+o,lastComponent:{count:a.count+1,added:n,removed:s,previousComponent:a.previousComponent}}:{oldPos:e.oldPos+o,lastComponent:{count:1,added:n,removed:s,previousComponent:a}}},extractCommon:function(e,n,s,o,r){for(var a=n.length,i=s.length,f=e.oldPos,u=f-o,c=0;u+1<a&&f+1<i&&this.equals(s[f+1],n[u+1],r);)u++,f++,c++,r.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return c&&!r.oneChangePerToken&&(e.lastComponent={count:c,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=f,u},equals:function(e,n,s){return s.comparator?s.comparator(e,n):e===n||s.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],s=0;s<e.length;s++)e[s]&&n.push(e[s]);return n},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function pt(t,e,n,s,o){for(var r=[],a;e;)r.push(e),a=e.previousComponent,delete e.previousComponent,e=a;r.reverse();for(var i=0,f=r.length,u=0,c=0;i<f;i++){var d=r[i];if(d.removed)d.value=t.join(s.slice(c,c+d.count)),c+=d.count;else{if(!d.added&&o){var h=n.slice(u,u+d.count);h=h.map(function(x,g){var m=s[c+g];return m.length>x.length?m:x}),d.value=t.join(h)}else d.value=t.join(n.slice(u,u+d.count));u+=d.count,d.added||(c+=d.count)}}return r}function gt(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function vt(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function je(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function He(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function ne(t,e){return je(t,e,"")}function Te(t,e){return He(t,e,"")}function Ct(t,e){return e.slice(0,Vs(t,e))}function Vs(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var s=e.length;t.length<e.length&&(s=t.length);var o=Array(s),r=0;o[0]=0;for(var a=1;a<s;a++){for(e[a]==e[r]?o[a]=o[r]:o[a]=r;r>0&&e[a]!=e[r];)r=o[r];e[a]==e[r]&&r++}r=0;for(var i=n;i<t.length;i++){for(;r>0&&t[i]!=e[r];)r=o[r];t[i]==e[r]&&r++}return r}var Se="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Gs=new RegExp("[".concat(Se,"]+|\\s+|[^").concat(Se,"]"),"ug"),Me=new O;Me.equals=function(t,e,n){return n.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t.trim()===e.trim()};Me.tokenize=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(e.intlSegmenter.segment(t),function(r){return r.segment})}else n=t.match(Gs)||[];var s=[],o=null;return n.forEach(function(r){/\s/.test(r)?o==null?s.push(r):s.push(s.pop()+r):/\s/.test(o)?s[s.length-1]==o?s.push(s.pop()+r):s.push(o+r):s.push(r),o=r}),s};Me.join=function(t){return t.map(function(e,n){return n==0?e:e.replace(/^\s+/,"")}).join("")};Me.postProcess=function(t,e){if(!t||e.oneChangePerToken)return t;var n=null,s=null,o=null;return t.forEach(function(r){r.added?s=r:r.removed?o=r:((s||o)&&Tt(n,o,s,r),n=r,s=null,o=null)}),(s||o)&&Tt(n,o,s,null),t};function Tt(t,e,n,s){if(e&&n){var o=e.value.match(/^\s*/)[0],r=e.value.match(/\s*$/)[0],a=n.value.match(/^\s*/)[0],i=n.value.match(/\s*$/)[0];if(t){var f=gt(o,a);t.value=He(t.value,a,f),e.value=ne(e.value,f),n.value=ne(n.value,f)}if(s){var u=vt(r,i);s.value=je(s.value,i,u),e.value=Te(e.value,u),n.value=Te(n.value,u)}}else if(n)t&&(n.value=n.value.replace(/^\s*/,"")),s&&(s.value=s.value.replace(/^\s*/,""));else if(t&&s){var c=s.value.match(/^\s*/)[0],d=e.value.match(/^\s*/)[0],h=e.value.match(/\s*$/)[0],x=gt(c,d);e.value=ne(e.value,x);var g=vt(ne(c,x),h);e.value=Te(e.value,g),s.value=je(s.value,c,g),t.value=He(t.value,c,c.slice(0,c.length-g.length))}else if(s){var m=s.value.match(/^\s*/)[0],v=e.value.match(/\s*$/)[0],T=Ct(v,m);e.value=Te(e.value,T)}else if(t){var p=t.value.match(/\s*$/)[0],S=e.value.match(/^\s*/)[0],y=Ct(p,S);e.value=ne(e.value,y)}}var zs=new O;zs.tokenize=function(t){var e=new RegExp("(\\r?\\n)|[".concat(Se,"]+|[^\\S\\n\\r]+|[^").concat(Se,"]"),"ug");return t.match(e)||[]};var Ae=new O;Ae.tokenize=function(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],s=t.split(/(\n|\r\n)/);s[s.length-1]||s.pop();for(var o=0;o<s.length;o++){var r=s[o];o%2&&!e.newlineIsToken?n[n.length-1]+=r:n.push(r)}return n};Ae.equals=function(t,e,n){return n.ignoreWhitespace?((!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),O.prototype.equals.call(this,t,e,n)};function Ys(t,e,n){return Ae.diff(t,e,n)}var Ws=new O;Ws.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Js=new O;Js.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function $e(t){"@babel/helpers - typeof";return $e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$e(t)}var ue=new O;ue.useLongestToken=!0;ue.tokenize=Ae.tokenize;ue.castInput=function(t,e){var n=e.undefinedReplacement,s=e.stringifyReplacer,o=s===void 0?function(r,a){return typeof a>"u"?n:a}:s;return typeof t=="string"?t:JSON.stringify(Ue(t,null,null,o),o,"  ")};ue.equals=function(t,e,n){return O.prototype.equals.call(ue,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),n)};function Ue(t,e,n,s,o){e=e||[],n=n||[],s&&(t=s(o,t));var r;for(r=0;r<e.length;r+=1)if(e[r]===t)return n[r];var a;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),n.push(a),r=0;r<t.length;r+=1)a[r]=Ue(t[r],e,n,s,o);return e.pop(),n.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),$e(t)==="object"&&t!==null){e.push(t),a={},n.push(a);var i=[],f;for(f in t)Object.prototype.hasOwnProperty.call(t,f)&&i.push(f);for(i.sort(),r=0;r<i.length;r+=1)f=i[r],a[f]=Ue(t[f],e,n,s,f);e.pop(),n.pop()}else a=t;return a}var qe=new O;qe.tokenize=function(t){return t.slice()};qe.join=qe.removeEmpty=function(t){return t};var ye=(t=>(t.ADDED="added",t.REMOVED="removed",t.UNCHANGED="unchanged",t))(ye||{});function Fe(t){if(t==="")return 0;const e=t.split(`
`).length;return t.endsWith(`
`)?e-1:e}function Qs(t,e){return Ys(t,e,{newlineIsToken:!0}).map(s=>({count:s.count??Fe(s.value),value:s.value,type:s.added?"added":s.removed?"removed":"unchanged"}))}function Xs(t){let e="";for(const{type:n,value:s}of t)(n==="added"||n==="unchanged")&&(e+=s);return e}function Zs(t,e){const n=Fe(e),s=to(t,n);return{changes:Qs(s,e),numLinesDiffed:n}}function Ks(t){const e=[...t],n=[],s=[];for(;e.length>0;){const o=e[e.length-1];if(o.type===ye.REMOVED)e.pop(),o.type===ye.REMOVED&&n.unshift(o);else if(o.type===ye.ADDED)e.pop(),s.unshift(o);else break}return{prunedChanges:[...e,...s],prunedRemovedChanges:n}}function eo(t,e){const{changes:n,numLinesDiffed:s}=Zs(t,e),{prunedChanges:o,prunedRemovedChanges:r}=Ks(n),a=Xs(o),i=r.map(u=>u.value).join(`
`),f=Ht(t,s,"start");return{content:a+i+f,numLinesDiffed:Fe(a)}}function to(t,e){if(e<=0)return"";let n=0,s=t.length;for(let o=0;o<t.length;o++)if(t[o]===`
`&&(n++,n===e)){s=o+1;break}return t.substring(0,s)}function Ht(t,e,n="start"){if(e<=0)return t;if(n==="start"){let a=0;for(let i=0;i<t.length;i++)if(t[i]===`
`&&(a++,a===e))return t.substring(i+1);return""}let s=0,o=-1;const r=t.endsWith(`
`)?e+1:e;for(let a=t.length-1;a>=0;a--)if(t[a]===`
`&&(s++,s===r)){o=a;break}return o===-1?"":t.substring(0,o+1)}function no(t,e){const n=t?.type??j.LOADING,s=t?.content??"",o=It(t);if(!ae(n)||e==null||!o||!Nt(t))return{content:s,currentlyStreamingLineIndex:null};const r=Ht(s,1,"end");if(r==="")return{content:e.content,currentlyStreamingLineIndex:0};const a=eo(e.content,r);return{content:a.content,currentlyStreamingLineIndex:a.numLinesDiffed}}function so(t,e){const n=new Set(t.map(i=>i.id)),s=new Set(e.map(i=>i.id)),o=t.filter(i=>!s.has(i.id)).map(i=>({...i,diffStatus:lt.REMOVED})),r=e.filter(i=>!n.has(i.id)).map(i=>({...i,diffStatus:lt.ADDED})),a=t.filter(i=>s.has(i.id));return o.concat(r,a)}function oo({textdocVersion:t}){const e=B(),n=an(),[s,o]=C.useState(!1),r=ln(),a=C.useRef(t?.content??"");C.useEffect(()=>{a.current=t?.content??""},[t]);const i=f=>{s||(r(()=>{_.logButtonClick(ie.COPY,{contentLength:a.current.length,textdocType:t?.type}),wn(a.current,n,f)},0),o(!0),r(()=>o(!1),2e3))};return l.jsx(re,{label:e.formatMessage(ro.copy),children:l.jsx(X,{icon:s?ys:xs,onClick:i})})}const ro=be({copy:{id:"rbIYfo",defaultMessage:"Copy"}});function ao({disabled:t=!1,textdocId:e,version:n,isHistorical:s,isShowingChanges:o,latestVersionInt:r,nextVersion:a,previousVersion:i,onHoverPrevious:f,textdocType:u}){const c=B(),d=n==null||n===1,h=n!=null&&n>1;return d&&!s?null:l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx(re,{label:h&&c.formatMessage({id:"PoD5+8",defaultMessage:"Previous version"}),children:l.jsx(X,{disabled:!h||t,icon:ws,onMouseOver:f,onClick:()=>{_.logButtonClick(ie.HISTORY_PREVIOUS,{textdocType:u,isShowingChanges:o,textdocId:e,versionInt:n}),e&&n&&h&&xe(e,{beforeVersion:n},o&&i!=null?i:void 0)}})}),l.jsx(re,{label:s&&c.formatMessage({id:"PJ8YVJ",defaultMessage:"Next version"}),children:l.jsx(X,{disabled:!s||t,icon:Es,onClick:()=>{_.logButtonClick(ie.HISTORY_NEXT,{textdocType:u,isShowingChanges:o,textdocId:e,versionInt:n}),s&&(a?xe(e,{version:a},o?a:void 0):o&&r?Lt(e,r,null):le(e))}})})]})}function io({disabled:t=!1,isShowingCodePreview:e,onClick:n}){const[s,o]=C.useState(!1),r=B(),a=()=>{o(!0)},i=()=>{o(!1)};return l.jsx(re,{label:e?r.formatMessage(yt.hidePreview):r.formatMessage(yt.showPreview),children:l.jsx(X,{disabled:t,onMouseEnter:a,onMouseLeave:i,icon:Ss,onClick:n,className:V("transition-colors",{[we.hoverActive]:s&&e,[we.active]:!s&&e})})})}const yt=be({showPreview:{id:"m61vYn",defaultMessage:"Preview code"},hidePreview:{id:"ot1Rmq",defaultMessage:"Preview code"}});function lo({disabled:t=!1,textdocId:e,textdocType:n,history:s,version:o,isShowingChanges:r,latestVersionInt:a,onMouseEnter:i}){const f=B(),[u,c]=C.useState(!1),d=()=>{s?xe(e,s):le(e)},h=(o?.versionInt??0)>1,x=()=>{_.logButtonClick(ie.SHOW_CHANGES,{textdocType:n,textdocId:e,versionInt:o?.versionInt,latestVersionInt:a}),o?.versionInt!=null&&Lt(e,o.versionInt,s)},g=()=>{c(!0),i?.()},m=()=>{c(!1)};return l.jsx(re,{label:h&&f.formatMessage(r?xt.hideChanges:xt.showChanges),children:l.jsx(X,{icon:bs,disabled:!h||t,onClick:r?d:x,onMouseEnter:g,onMouseLeave:m,className:V("transition-colors",{[we.hoverActive]:u&&r&&h,[we.active]:!u&&r&&h,"!bg-transparent":!u&&!r&&h})})})}const xt=be({done:{id:"0MCBfo",defaultMessage:"Done"},showChanges:{id:"3jMGNS",defaultMessage:"Show changes"},hideChanges:{id:"HWiQSk",defaultMessage:"Hide changes"}}),uo=800,co=100,wt=100,fo=({textdocId:t,isHistoricalVersion:e,nextHistoricalTextdocVersion:n,previousHistoricalTextdocVersion:s,textdocVersion:o,readonlyReason:r,history:a,latestVersionInt:i,hasDebug:f,contentWidth:u,isEmbedded:c,isPersisting:d,isShowChangesFeatureEnabled:h,isShowingChanges:x,hideHistoryActions:g=!1,prefetchHistoricalTextdocVersion:m,restoreHistoricalTextdocVersion:v,setShowDebugView:T,onClickCodePreview:p,onClose:S,isShowingCodePreview:y})=>{const A=En(o?.title??""),[{width:M},I]=Pt(),b=u-M-co-wt>0,H=_t(),$=Ot(),U=o==null?!1:jt(o.type,o.content),D=V("transition-opacity duration-500",r===L.Streaming&&"pointer-events-none opacity-0");return l.jsxs(se.Header,{children:[l.jsxs("div",{className:"flex flex-1 items-center leading-[0]",children:[l.jsx(se.CloseButton,{onClick:S}),b&&l.jsx("div",{className:"flex flex-row items-center gap-2.5",children:l.jsx(se.Title,{style:{maxWidth:u-M-wt},children:A||l.jsx("div",{className:"w-52",children:l.jsx(Ds,{lines:1,size:"base",width:100,widthVariance:0})})})}),d&&l.jsx(Sn,{size:12,className:"pl-2 text-token-text-secondary"})]}),l.jsxs("div",{className:"flex select-none items-center gap-2 leading-[0]",ref:I,children:[l.jsxs("div",{className:"flex items-center gap-2",children:[f&&u>uo&&l.jsx(X,{icon:Ms,onClick:()=>T(G=>!G)}),!g&&l.jsx("div",{className:D,children:l.jsx(ao,{disabled:r===L.Streaming,textdocId:t,isHistorical:e,isShowingChanges:x,version:o?.versionInt,previousVersion:s?.versionInt,nextVersion:n?.versionInt,readonlyReason:r,onHoverPrevious:m,onClickRestore:v,textdocType:o?.type,latestVersionInt:i})}),!g&&h&&l.jsx("div",{className:D,children:l.jsx(lo,{disabled:r===L.Streaming,textdocId:t,textdocType:o?.type,history:a,version:o,isShowingChanges:x,latestVersionInt:i,onMouseEnter:()=>{o?.versionInt&&H(t,o.versionInt),m()}})}),$&&U&&l.jsx(io,{disabled:o?.versionInt==null,onClick:p,isShowingCodePreview:y}),l.jsx(oo,{textdocVersion:o})]}),!c&&l.jsx(us,{})]})]})},mo=/\s/,ho=30;function Et(t,e){const n=t.indexOf(e);return n===-1?!1:t.indexOf(e,n+e.length)===-1}function F(t,e){return mo.test(t[e])}function St(t,e,n=!1){if(e===0||n&&F(t,e-1))return e;for(;e>0&&F(t,e-1);)e--;for(;e>0&&!F(t,e-1);)e--;return F(t,e)&&e++,e}function bt(t,e,n=!1){if(e===t.length||n&&F(t,e))return e;for(;e<t.length&&F(t,e);)e++;for(;e<t.length&&!F(t,e);)e++;return F(t,e-1)&&e--,e}function po(t,e,n=!0,s=ho){if(t.start<0||t.end>e.length||t.start>t.end)throw new Error("Invalid commentSourceRange provided.");const o=e.substring(t.start,t.end);let r=t.start,a=t.end;n&&(r=St(e,r,!0),a=bt(e,a,!0));let i=e.substring(r,t.start),f=e.substring(t.end,a),u=`${i}${o}${f}`;if(Et(e,u)&&(s==null||u.length>=s))return{before:i,after:f,allSurrounding:u};let c=r,d=a,h=!0;for(;h&&(s==null||u.length<s);){let x=!1;const g=c>0?St(e,c):c;g<c&&(c=g,x=!0);const m=d<e.length?bt(e,d):d;if(m>d&&(d=m,x=!0),x){const v=e.substring(c,t.start),T=e.substring(t.end,d),p=`${v}${o}${T}`;if(Et(e,p)&&(s==null||p.length>=s))return{before:v,after:T,allSurrounding:p};i=v,f=T,u=p}else h=!1}return{before:i,after:f,allSurrounding:u}}const ce="# Context",fe="# Instructions";function de(t,e,n){if(e==null||n==null)return`The user is referring to the entire text of "${t}".`;const s=`
## Selected Text
The user has selected this text in "${t}" in particular:
${e}
`.trim();return n.allSurrounding===e?s:`
${s}

## Surrounding Context
Here is the surrounding context:
${n.allSurrounding}
`.trim()}function $t(t,e){return t==null||e==null?"entire document":t===e.allSurrounding?"selected text":"surrounding context"}function Ut(t){return`For the update pattern, create a regex which exactly matches the ${t}. Edit just this string in order to fullfill the user's request. NEVER rewrite the entire document. Instead, ALWAYS edit ONLY the ${t}. The only exception to this rule is if the ${t} includes markdown lists or tables. In that case, fully rewrite the document using ".*" as the regex update pattern.`.trim()}function go(t,e,n,s){if(!ae(e)&&n&&s){const o=$t(n,s);return`
${ce}
The user requests that you directly edit the document.

${de(t,n,s)}

${fe}
Use the update_textdoc tool to make this edit. ${Ut(o)}`.trim()}return`
${ce}
The user requests that you directly edit the document.

${de(t,n,s)}

${fe}
Use the update_textdoc tool to make this edit. You MUST fully rewrite the entire document by using ".*" as the update regex pattern.`.trim()}function vo(t,e,n){return`
${ce}
The user requests that you add comments about some text.

${de(t,e,n)}

${fe}
Do not respond to the user's question directly, just leave comments.`.trim()}function Co(t,e){return ae(t)?e==="entire document"?` If you choose to update the ${e}, you MUST fully rewrite the ${e} by using ".*" as the update regex pattern.`:` If you choose to update the ${e}, you MUST fully rewrite the entire document by using ".*" as the update regex pattern. When you do so, ONLY modify the ${e} and rewrite other sections exactly as is, except for parts that must change based on this update`:e==="entire document"?"":` If you choose to update the ${e}, follow these instructions: ${Ut(e)}`}function To(t,e,n,s){const o=$t(n,s),r=Co(e,o);return`
${ce}
${de(t,n,s)}

${fe}
The user would like you perform one of the following actions:
- Update the ${o} via the \`update_textdoc\` tool.${r}
- Explain the selected text via chat, or answer a general question about the selected text (no tool call required).
- Comment on the ${o} with feedback via the \`comment_textdoc\` tool. This should only be used if the user very explicitly asks for feedback, critique, or comments.

Based on the user's request, choose the appropriate action.
`.trim()}function yo(t,e,n){return`
${ce}
${de(t,e,n)}

${fe}
The user would like you to create a new textdoc.
`.trim()}function xo(t,e,n,s=null,o=null){switch(n){case Q.ASK:return To(t,e,s,o);case Q.CREATE_TEXTDOC:return yo(t,s,o);case Q.EDIT:return go(t,e,s,o);case Q.COMMENT:return vo(t,s,o)}}function wo(t){switch(t){case P.ACCELERATOR:case P.ACCEPT_COMMENT:return!0;case P.ASK_CHATGPT:case P.FULL_SCREEN_SUBMIT:return!1}}function Eo(t,e){switch(e){case P.ASK_CHATGPT:case P.ACCEPT_COMMENT:case P.FULL_SCREEN_SUBMIT:return t.formatMessage(bo.askChatGPT);case P.ACCELERATOR:return}}const So=(t,e)=>{const n=B(),{tags:s}=bn(t),o=Mn(),r=An(t),a=kn(t)??o.id,i=Dn({clientThreadId:t});return C.useCallback(async({content:f,sourceRange:u,action:c,userMessageType:d,acceleratorMetadata:h,selectionMetadata:x})=>{if(e?.versionInt==null)return;const{textdocId:g,type:m,versionInt:v,content:T}=e;let p,S=null;u&&u.start!==u.end&&(p=T.slice(u.start,u.end),S=po(u,T));const y=xo(g,m,c,p,S),M=In(y,{exclude_after_next_user_message:!0}),I=performance.now(),b=await un(),[H,$,U]=await Promise.all([cn.getEnforcementToken(b),Nn.getEnforcementToken(b),fn.getEnforcementToken(b)]),D=new Ln,G=ut.getThreadCurrentLeafId(t),z=`${G}-nextPrompt`;ut.updateTree(t,ke=>{ke.addNode(z,f,G,Oe.User,void 0,{canvas:{textdoc_id:g,textdoc_type:m,version:v,textdoc_content_length:T.length,user_message_type:d,accelerator_metadata:h,selection_metadata:x},is_visually_hidden_from_conversation:wo(d),targeted_reply:p,targeted_reply_label:Eo(n,d),open_in_canvas_view:{type:"canvas_textdoc",id:g}})}),i({model:a,completionType:dn.Next,parentNodeId:z,metadata:{eventSource:"mouse"},completionMetadata:r?{conversationMode:r}:void 0,chatReq:b,arkoseToken:H??null,turnstileToken:$??null,proofToken:U??null,preflightTime:performance.now()-I,appendMessages:[M],turnTracker:D})},[e,s,t,i,a,r,n])},bo=be({askChatGPT:{id:"h5ANdM",defaultMessage:"Asked ChatGPT"}});function Mo(t){const e=/\[([^\]]+)\]\((https?:\/\/[^\s)]+|www\.[^\s)]+)\)/gi,n=new Set,s=t.matchAll(e);for(const o of s){const r=o[2];try{let a=r;a.startsWith("www.")&&(a="http://"+r),new URL(a),n.add(r)}catch{}}return n}const Ao=async({lastVersion:t,textdocId:e,content:n,comments:s})=>{const o=Pn(s,n);return(await At.safePost("/textdoc/{textdoc_id}",{parameters:{path:{textdoc_id:e}},requestBody:{version:t,content:n,comments:o}})).version},ko=()=>{const t=C.useRef([]),e=C.useRef(null),{mutateAsync:n,isPending:s}=mn({mutationKey:["canvas","textdoc","persist"],mutationFn:Ao});return[C.useCallback(async(r,a,i)=>{const f=new AbortController,c=(async()=>{const[g]=t.current;try{await g?.promise}catch(m){_.logError("Saving document",m)}if(!f.signal.aborted)try{const m=Math.max(e.current??0,r.versionInt??Rt);let v="";try{at(a)?v=a():v=a}catch(y){_.logError("Serializing document",y)}let T=[];try{at(i)?T=i():T=i}catch(y){_.logError("Adjusting comments",y)}const{textdocId:p}=r;_n({textdocId:p,basedOnVersionInt:m,content:v,comments:T});const S=await n({textdocId:p,lastVersion:m,content:v,comments:T});On({textdocId:p,basedOnVersionInt:m,newVersion:S}),e.current=S}catch(m){_.logError("Error saving document",m)}finally{t.current.shift()}})(),d={abort:()=>f.abort(),promise:c},[h,x]=t.current;return x&&(x.abort(),t.current=h?[h]:[]),t.current=h?[h,d]:[d],c},[n]),t,s]},Do=3e3,Io=t=>{const[e,n,s]=ko(),o=B(),r=C.useRef(null),a=C.useCallback(Rn(e,Do,{leading:!1}),[e]),i=jn(t);return C.useEffect(()=>{if(!i)return;const u=it(window,{pagehide:()=>a.flush(),beforeunload:d=>{a.flush(),d.returnValue=o.formatMessage({id:"QZrKwi",defaultMessage:"You have a canvas save in progress."})}}),c=it(document,{visibilitychange:()=>a.flush(),keydown:()=>{r.current="keyboard"},mousemove:()=>{r.current!=="mouse"&&a.flush(),r.current="mouse"}});return()=>{r.current=null,c(),u()}},[o,i,a]),C.useEffect(()=>()=>{a.flush()},[t,a]),Hn(async()=>{await a.flush(),await Promise.allSettled(n.current?.map(({promise:u})=>u)??[])}),[C.useCallback((u,c,d)=>{const{textdocId:h}=u;return $n(h),a(u,c,d)},[a]),a.flush,s||i]};function No(t,e,n){const s=kt(),o=n!=null&&e!=null,{data:r,error:a,fetchNextPage:i,hasNextPage:f,isFetching:u}=hn(Mt(t,e,o)),c=C.useCallback(async()=>{const m=e!=null;await s.prefetchInfiniteQuery(Mt(t,e,m))},[s,t,e]);C.useEffect(()=>{const m=e;return()=>{s.removeQueries({queryKey:qt(t,m),exact:!0})}},[s,t,e]);const[d,h,x,g]=C.useMemo(()=>{if(r&&n){const v=r.pages.flatMap(p=>p),T=v.findIndex(p=>"beforeVersion"in n?(p.versionInt??Rt)<n.beforeVersion:p.versionInt===n.version);if(T!==-1)return[T===v.length-1,v[T],T>0?v[T-1]:null,T<v.length-1?v[T+1]:null]}const m=r?.pages.flatMap(v=>v)??[];return[!0,null,null,m.length===0?null:m[0]]},[r,n]);return C.useEffect(()=>{!u&&o&&f&&d&&i()},[u,o,f,d,i]),C.useEffect(()=>{!h&&a&&le(t)},[h,a,t]),{historicalTextdocVersion:h,nextHistoricalTextdocVersion:x,prefetchHistoricalTextdocVersion:c,previousHistoricalTextdocVersion:g}}function qt(t,e=null){return["textdocHistory",t,e]}function Mt(t,e,n=!0){return{queryKey:qt(t,e),queryFn:({pageParam:s})=>Lo(t,s),initialPageParam:e??void 0,getNextPageParam:s=>{const o=Un(s)?.versionInt;if(o&&o>1)return o},enabled:n,staleTime:1/0,retry:2}}async function Lo(t,e){return e===void 0?[]:(await At.safeGet("/textdoc/{textdoc_id}/history",{parameters:{path:{textdoc_id:t},query:{before_version:e}}})).previous_doc_states.map(({id:s,version:o,textdoc_type:r,title:a,content:i,updated_at:f,comments:u})=>({textdocId:s,versionInt:o,messageId:null,title:a,type:qn(r),content:i,status:Fn.COMPLETE,createdAt:Bn(f),comments:Vn(u,i)}))}const Jo=({isFullScreen:t=!1,isEmbedded:e=!1,hideHeader:n=!1,readonlyReason:s,clientThreadId:o,focusedTextdoc:r,onClose:a,isAnimating:i=!1,width:f,hideBottomComposer:u=!1})=>{const{textdocId:c,history:d,showChangesAtVersion:h=null}=r,x=Ot(),[g,m,v]=Io(c),{targetedContent:T}=Gn(),p=zn(),[S,y]=C.useState(!1),A=Yn(c),M=Wn(),I=Jn(o),b=Qn(I),[H,$]=Pt(),U=Xn(),{data:D,isLoading:G}=Zn(c,U?h:null),[z,ke]=C.useState(!1),R=A?.versions??[],Be=R[0]?.versionInt,{historicalTextdocVersion:me,nextHistoricalTextdocVersion:Ft,previousHistoricalTextdocVersion:Ve,prefetchHistoricalTextdocVersion:Bt}=No(c,Be,d),Vt=_t();C.useEffect(()=>{Ee.reset()},[c]);const Ge=R.length>0?R[R.length-1]:null,De=R.length>1?R[R.length-2]:null,ze=Kn(o),{restoreHistoricalTextdocVersion:Ye,optimisticRestoredTextdocVersion:Gt}=es(ze,Ge,me),Z=d!=null,E=Z?me:Ge,he=U&&h!=null,pe=So(o,E),We=i||!U?null:D,ge=(()=>{if(i||E==null)return[];const w=ht(E.comments);return!he&&me!=null?me.comments:!he||D==null?w:D.contentBefore!==D.contentAfter?[]:so(D.commentsBefore,D.commentsAfter)})(),Y=E?.type??j.LOADING,zt=ts(),K=It(E),Ie=Nt(E),Yt=ns(E),Wt=Ns(M);C.useEffect(()=>{R.length===0&&!M&&Wt&&a?.()},[R.length,M]);const Jt=!!s&&s!==L.OldVersion,{content:W,currentlyStreamingLineIndex:Je}=D?.contentBefore!=null&&!ae(Y)?{content:D.contentBefore,currentlyStreamingLineIndex:null}:no(E,De),Qt=Is(ze,Array.from(Mo(W))),[ve,Ne]=Hs({value:W,isRequestActive:b,isTextdocStreaming:K,comments:ge}),Qe=ss(E);C.useEffect(()=>{c&&ct().sendMessage({type:Re.Loaded})},[c]);const Xe=zt===os.LAST_TURN||ve||v;C.useEffect(()=>{ct().sendMessage({type:Re.Streaming,streaming:Xe})},[Xe]);const Xt=({getSerializedDocument:w,getAdjustedComments:k})=>{E&&g(E,w,k)},Zt=w=>{if(!E)return;const k=w.doc.toString();g(E,k,w.field(ms,!1)??[])},Ze=(w,k,q,J)=>{Ne(!0),pe({action:k,content:w,userMessageType:P.ASK_CHATGPT,sourceRange:q,selectionMetadata:{selection_type:J,selection_position_range:q}})},Ke=({id:w})=>{Qe(w,ft.DISMISS),Ee.reset()},et=async w=>{Ne(!0);const{id:k,at:q,content:J}=w;if(await Qe(k,ft.ACCEPT)===!1)return Ne(!1);pe({content:J,userMessageType:P.ACCEPT_COMMENT,sourceRange:q,action:Q.EDIT,selectionMetadata:{selection_type:dt.SELECTION,selection_position_range:q}})},Le=(w,k,q)=>{const{action:J}=q;pe({action:J,content:k,sourceRange:w,userMessageType:P.ACCELERATOR,acceleratorMetadata:{action:J,id:q.id,prompt:k},selectionMetadata:w!=null?{selection_type:dt.SELECTION,selection_position_range:w}:void 0})},Kt=w=>{pe({action:Q.EDIT,content:w,userMessageType:P.FULL_SCREEN_SUBMIT})},en=pn(),tn=kt(),nn=rs(),tt=w=>nn?.[w]??w,Pe=()=>is({clientThreadId:o,currentRequestId:I,queryClient:tn,isHistoryAndTrainingDisabled:en}),sn=()=>{d?xe(c,d):le(c)};let N=s;Z?N=L.OldVersion:he?N=L.ShowingChanges:Gt!=null?N=L.Restoring:(K||b)&&(N=L.Streaming);let Ce=null;const nt=i||N!=null||ve,st=()=>{if(i&&ge.length>0)return te.ALL_HIDDEN;if(N==null)return te.ENABLED;switch(N){case L.Streaming:return te.ENABLED;case L.ShowingChanges:case L.OldVersion:return te.COMMENTS_READONLY;default:return te.ALL_HIDDEN}},ot=t||i;let _e=[];switch(Y){case j.LOADING:Ce=l.jsx(ds,{});break;case j.DOCUMENT:Ce=l.jsx(fs,{value:W,comments:ge,previousValue:De?.content,previousComments:ht(De?.comments),isRewriting:Ie,isAnimatingFromPreview:i,getStableCommentId:tt,diff:We,isRequestActive:b,isDisabled:N!=null||M,isWaitingForCommentResponse:ve,hideAccelerators:ot,hideToolbar:nt,hideEditOverlay:i,commentsMode:st(),readonlyReason:N,onBlur:m,onSave:m,onChange:Xt,onCancelRequest:Pe,targetedContent:T,onAddComment:Ze,onAcceptComment:et,onDismissComment:Ke,onSubmitAccelerator:Le,onExitShowChanges:sn,safeUrls:Qt,width:f,modelCursor:K&&!Ie?E?.modelCursor:void 0,shouldResetSelection:E?.versionInt===1}),_e=Cs;break;default:if(ae(Y)){const w=jt(Y,W),k=l.jsx(cs,{id:"codemirror",getStableCommentId:tt,language:as(Y),value:W,comments:ge,hideAccelerators:ot,commentsMode:st(),hideToolbar:nt,onSubmitAccelerator:Le,currentlyStreamingLineIndex:Je??null,readonlyReason:N,isRequestActive:b,isWaitingForCommentResponse:ve,onChange:Zt,onCancelRequest:Pe,onAddComment:Ze,onDismissComment:Ke,onAcceptComment:et,textdocDiff:We??void 0,modelCursor:K&&Je==null?E?.modelCursor:void 0});Ce=!x||!w?k:l.jsxs(l.Fragment,{children:[l.jsx("div",{style:{display:z?"none":"block"},children:k}),l.jsx(js,{hidden:!z,isStreaming:K,textdocContent:W,textdocType:Y})]}),_e=hs}}return l.jsxs(se,{children:[!n&&l.jsx(fo,{textdocId:c,isHistoricalVersion:Z,nextHistoricalTextdocVersion:Ft,previousHistoricalTextdocVersion:Ve,textdocVersion:E,readonlyReason:N,history:d,hasDebug:p,contentWidth:H.width,isEmbedded:e,isPersisting:v,isShowChangesFeatureEnabled:U,isShowingChanges:he,latestVersionInt:Be,hideHistoryActions:N===L.QueryParam,prefetchHistoricalTextdocVersion:()=>{Bt();const w=Ve?.versionInt;w!=null&&Vt(c,w)},restoreHistoricalTextdocVersion:Ye,setShowDebugView:y,onClose:()=>{_.logButtonClick(ie.CLOSE_TEXTDOC,{textdocType:E?.type}),a?.()},onClickCodePreview:()=>ke(w=>!w),isShowingCodePreview:z}),l.jsxs(se.Content,{ref:$,scrollToBottomMode:Yt?"bottom":"top",shouldScrollToTop:Ie,isLoading:G,children:[!1,Ce]}),l.jsx(Dt,{children:Z&&!Jt&&l.jsx($s,{onClickRestore:Ye,onClickResetLatest:()=>le(c)})}),t&&!Z&&!u&&l.jsx(Bs,{isRequestActive:b,clientThreadId:o,onSubmitAccelerator:Le,onSubmit:Kt,onCancel:Pe,acceleratorActions:_e})]})};export{Re as C,Jo as T,Ps as g,Ls as i};
//# sourceMappingURL=lkz2wc6g58lw9uxt.js.map
