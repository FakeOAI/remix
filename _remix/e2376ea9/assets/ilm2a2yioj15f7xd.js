const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ofki223f9gafzadm.js","assets/b0yd4b4kjz1x36ki.js","assets/coaq057lk9sfedb2.js","assets/root-cqviwlml.css","assets/n7vysb43mvr66fkq.js","assets/b96clgxumfjg5jjm.js","assets/conversation-small-cll5buey.css","assets/kw9ddor7oc85so5w.js","assets/ft25f52m4p13jgsj.js","assets/gpnvgzf5z64pz2xq.js","assets/kijk5r3n5jelj3fs.js","assets/lbpxnfn5p1or57tl.js","assets/jq2hxkuwup9sbzd1.js","assets/gxew3rrjdpssi4tj.js","assets/gq2lbdmvy6z6tosm.js","assets/t9r7h8rmfls9uxnn.js","assets/is-scrollable-element-i34sjb0l.css","assets/bas431hizjukducs.js","assets/khpgin38dhkqymea.js","assets/jb9kjkhndho3i15k.js","assets/dytnb75iigquej3g.js","assets/srbowbdpouoh01hw.js","assets/dbv04stdtm3q06nn.js","assets/code-composer-ne11stli.css","assets/m7vu7trjg7yk6nzm.js","assets/jc6gngctatb0a9m2.js","assets/bgqd7ey0b4i969e8.js","assets/o7zmevufoyh5evw5.js","assets/ch3fbob6y9piq6yp.js","assets/ef38p94ksr4o7qe8.js","assets/iyibwghquy0bm3wp.js","assets/hz589o2bwen3t40l.js","assets/document-composer-ofhzvcxp.css","assets/hg2kwixl1elebwsk.js","assets/hwhe50kanygvsey7.js","assets/d3y72ugnrmac5z1v.js","assets/ouq6veviynf598aw.js","assets/e9lafxuzyeh4418f.js","assets/sso-bx19kqnmjvbfrjzw.js","assets/dzbx94o45p4esajs.js","assets/g4ofuk9htasmtqks.js","assets/kwzd2ud86lof83xs.js","assets/x9xdt5388dun1wvh.js","assets/dupwdowatzoauhyu.js","assets/itghwucfyv5ciib7.js","assets/gajd2yx9i9b9t2oc.js","assets/k8sxqq2ueid5dadq.js","assets/mzbn4wmshmqa9j6u.js","assets/983a0dy92b3ronpv.js","assets/entf7qdz51qx48wu.js","assets/kqwdyvkaaavvn8k3.js","assets/bx0aifzgdr9bfkq7.js","assets/m3hemkfxio0zh920.js","assets/lcbadnbjsrg4ayya.js","assets/bdp6yanyb7apkmag.js","assets/dhsz3b9x2u6upy3g.js","assets/o8264e2vw9xozwfl.js","assets/hdjllv1xvunjal7c.js","assets/jb7pwluksxlgqmm7.js","assets/iej0cupg2dqkmejt.js","assets/m742eas88ukppp7n.js","assets/ecwo4mmk67f8cloj.js","assets/jk8w36bsokizpx57.js","assets/eg1obrepv9nobkuo.js","assets/c3mzt1qwgy8ysm2n.js"])))=>i.map(i=>d[i]);
import{a6 as o,ar as re,aw as Fe,r as w,aj as xe,aY as _e,ak as lt,aE as Ve,aF as ze,fo as Ts,aO as En,d as ue,fL as Rs,fM as js,aG as H,c1 as Mt,D as Ce,fC as As,fD as Bs,bR as Ns,fN as Fs,at as Ae,n as kn,fO as gt,bD as Be,bE as Ds,fK as Ps,cF as Os,j as Dt,bp as ut,a3 as De,a7 as Cn,cm as Us,ck as Ls,b0 as st,dq as In,P as le,S as Pe,ca as Mn,Z as Pt,aZ as Tn,R as rt,K as He,b1 as ke,fP as Tt,cb as $s,fQ as Rn,v as Ws,bK as qs,bJ as Hs,h as Qt,fR as Gs,fS as Jt,fT as Xt,fU as Vs,fV as zs,J as Ks,a0 as Qs,a8 as tt,am as Js,O as Xs,bO as Ys,bP as Yt,bQ as Zt,aB as Ot,an as jn,bG as Zs,I as er,di as tr,bs as ot,a2 as nr,w as sr,a9 as rr,a5 as or,aK as Rt,fm as ir}from"./b0yd4b4kjz1x36ki.js";import{k1 as ar,bS as cr,l2 as lr,l3 as ur,jV as dr,l4 as fr,c7 as Ke,k2 as An,k0 as hr,l5 as mr,l6 as en,g$ as pr,g_ as gr,kN as xr,gH as yr,kt as wr,ku as Bn,kV as vr,k3 as tn,Z as _r,jI as Nn,l7 as br,kg as Sr,gQ as Er,l8 as kr,l9 as Cr,la as Ir,lb as Mr,lc as Tr,gS as Fn,kh as Dn,gK as Rr,ld as jr,iq as Ut,ir as Ar,fz as Pn,iz as Lt,j6 as On,le as Un,lf as Br,lg as jt,gL as At,lh as Nr,li as Fr,lj as Dr,lk as Pr,ll as Or,lm as Ur,ln as Lr,lo as $r,lp as Wr,lq as qr,U as Ie,jS as Hr,jP as xt,lr as yt,ls as Gr,lt as Vr,lu as zr,jO as Kr,lv as Qr,iP as Jr,jU as Xr,lw as Yr,jR as Zr,iD as wt,bO as eo,lx as to,ly as Ln,lz as no,lA as Ye,lB as so,lC as $n,lD as vt,lE as ro,lF as oo,aV as Ne,lG as io,lH as ao,lI as co,ax as he,lJ as Wn,aq as nn,ar as Oe,as as dt,aC as lo,b1 as uo,b2 as fo,aF as ho,aG as qn,aH as it,aI as Ue,aU as mo,b3 as fe,lK as pe,b4 as po,aJ as go,aK as xo,aL as yo,aN as Hn,aM as wo,au as vo,aR as _o,aS as bo,aW as So,aX as Eo,lL as ko,lM as Co,lN as Io,lO as Mo,aZ as sn,lP as Gn,a_ as To,aT as Ro,b0 as jo,lQ as Ao,lR as Bo,lS as No,lT as Vn,lU as Fo,lV as Do,lW as _t,lX as Po,g1 as Oo,c8 as Qe,m as $t,aa as Wt,c as Uo,jw as qt,di as zn,cs as rn,p as Kn,lY as Qn,lZ as Jn,l_ as Xn,l$ as Yn,aj as Lo,ae as Zn,by as $o,m0 as Wo,q as es,m1 as ts,a as ns,e as qo,C as Bt,T as Ho,m2 as Go,m3 as Ht,m4 as Vo,m5 as zo,m6 as Ko,m7 as de,m8 as Qo,m9 as nt,ma as Ze,mb as Jo,mc as ss,md as Xo,me as Yo,mf as Le,mg as Zo,mh as on,mi as ei,mj as ti,mk as an,ml as ni,mm as si,mn as cn,fL as ri,X as ae,cT as oi,mo as ii,mp as ai,i_ as rs,mq as ci,cB as ln,mr as li,ms as ui,mt as di,z as fi,mu as hi,dP as mi,mv as pi,mw as gi,mx as xi,ck as yi,my as wi,mz as vi,mA as _i,mB as bi,a8 as Si,j5 as Ei,kz as ki,cW as Ci,ef as Ii,dv as Mi,gu as Ti,f1 as Ri,mC as ji,jK as Ai,mD as Bi,ce as os,bF as is,n as Ni,o as Fi,bd as Di,cR as Pi,mE as un,cq as dn,mF as Oi}from"./b96clgxumfjg5jjm.js";import{X as Ui,b as Li,g as ft,bW as $i,d as Wi,ae as qi,s as Hi,P as Gi,a0 as Vi,r as zi,aZ as as,bu as cs,bA as ls,bX as us,K as Ki,aj as ds,bo as Qi,ai as fs,bp as Ji,a6 as Xi,bv as Yi,aK as Zi,aI as ea,$ as hs,b4 as bt}from"./coaq057lk9sfedb2.js";import{D as te,B as ta}from"./khpgin38dhkqymea.js";import{u as na}from"./jb9kjkhndho3i15k.js";import{B as sa,T as ra,I as oa}from"./srbowbdpouoh01hw.js";import{P as at}from"./dbv04stdtm3q06nn.js";import{m as ct}from"./ft25f52m4p13jgsj.js";function ia({className:s,zIndexKey:t,onClick:r}){return o.jsx(ct.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:re("absolute inset-0",s,ar[t]),onClick:r})}function aa({zIndexKey:s,onClick:t}){return o.jsx(ia,{zIndexKey:s,onClick:t,className:"bg-gray-50/50 dark:bg-black/50"})}const ca=({onScroll:s})=>(lr(({scrollTop:t})=>{s?.(t)}),null),la=({shouldScrollToTop:s})=>{const t=ur();return w.useEffect(()=>{s===!0&&t({behavior:"smooth"})},[s,t]),null},ua=()=>{const s=dr();w.useEffect(()=>{s({behavior:"smooth"})},[s]);const[t]=fr();return t?null:o.jsx("button",{onClick:()=>s({behavior:"smooth"}),className:"absolute bottom-5 right-1/2 z-10 flex h-8 w-8 translate-x-1/2 cursor-pointer items-center justify-center rounded-full border border-token-border-light bg-token-main-surface-primary bg-clip-padding text-token-text-secondary",children:o.jsx(Ui,{className:"icon-md text-token-text-primary"})})},da=Fe.section`w-full h-full flex flex-col popover bg-token-main-surface-primary`,fa=({children:s,onScroll:t,shouldScrollToTop:r,scrollToBottomMode:c="top",isLoading:l=!1},d)=>o.jsxs("main",{className:"relative flex min-h-0 flex-auto flex-grow flex-col",ref:d,children:[o.jsx(cr,{children:l&&o.jsx(aa,{zIndexKey:"textdocDiffLoadingOverlay"})}),o.jsxs(sa,{followButtonClassName:"hidden",initialScrollBehavior:"auto",className:"h-full",mode:c,children:[s,c==="bottom"&&o.jsx(ua,{}),o.jsx(ca,{onScroll:t}),o.jsx(la,{shouldScrollToTop:r})]})]}),ha=w.forwardRef(fa),ma=Fe.header`flex items-center justify-between p-3 h-14`,pa=Fe.h2`ml-2.5 text-base text-lg text-gray-700 dark:text-token-text-secondary truncate`,ga=({onClick:s})=>{const t=xe();return o.jsx(_e,{label:t.formatMessage(xa.close),children:o.jsx(Ke,{icon:Li,onClick:s})})},$e=({children:s})=>o.jsx(da,{children:s});$e.Title=pa;$e.CloseButton=ga;$e.Header=ma;$e.Content=ha;const xa=lt({close:{id:"Bix/Kd",defaultMessage:"Close"}}),ya=Ve(()=>ze(()=>import("./ofki223f9gafzadm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(s=>s.CodeComposer),{loading:()=>o.jsx("div",{className:An.code,children:o.jsx("div",{className:"h-full w-full px-4",children:o.jsx(at,{lines:20})})})}),wa=s=>o.jsx(ya,{...s}),ms=()=>{const[{width:s},t]=hr(),r=s>=en+pr?en:gr;return o.jsx("div",{className:re(An.document,"mt-4"),ref:t,style:{margin:`0 ${mr}px`},children:o.jsx("div",{style:{width:r},children:o.jsx(at,{lines:20})})})},va=Ve(()=>ze(()=>import("./m7vu7trjg7yk6nzm.js"),__vite__mapDeps([24,1,2,3,11,5,6,10,4,7,8,12,13,14,15,16,25,26,27,28,29,30,31,18,19,20,21,22,32])).then(s=>s.DocumentComposer),{loading:ms}),_a=s=>o.jsx(va,{...s}),ba=({onScroll:s,textdocId:t})=>{const r=xr(t),{windowWidth:c}=Ts(p=>p,{windowWidth:0,windowHeight:0});if(!r)return null;const{versions:l}=r,d=yr(l),f=wr(d);let a=null;switch(d?.type){case Nn.DOCUMENT:a=o.jsx(_a,{value:d.content,comments:[],isRequestActive:f,isPreview:!0,isDisabled:!0,hideAccelerators:!0,commentsMode:tn.ALL_HIDDEN,hideToolbar:!0,hideEditOverlay:!0,width:c,modelCursor:d.modelCursor});break;default:d&&Bn(d.type)&&(a=o.jsx(wa,{id:"codemirror",currentlyStreamingLineIndex:null,language:vr(d.type),value:d.content,commentsMode:tn.ALL_HIDDEN,hideToolbar:!0,hideAccelerators:!0,comments:[],readonlyReason:_r.Streaming,isRequestActive:f}))}return o.jsx($e,{children:o.jsx($e.Content,{onScroll:s,children:a})})},Sa=w.memo(ba);function Ea(s,t){switch(s){case"presentation":return o.jsx(Tr,{});case"table":return o.jsx(Mr,{});case"chart":return o.jsx(Ir,{});case Nn.DOCUMENT:return o.jsx(ft,{className:re("icon-md",{"text-token-text-primary":t,"text-token-text-tertiary":!t})});default:return Bn(s)?o.jsx(kr,{className:re("icon-md",{"text-token-text-primary":t,"text-token-text-tertiary":!t})}):o.jsx(Cr,{})}}const ka=({isHovered:s=!1})=>{const t=xe();return o.jsx(_e,{label:t.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:o.jsx(ct.div,{role:"button",animate:{opacity:s?1:.64},whileHover:{opacity:1},transition:{type:"tween",duration:.18},className:"text-token-text-secondary transition-colors",children:o.jsx($i,{className:"icon-md"})})})},Ca=({isCanvasOpen:s,isFocused:t,isHovered:r,isInlinePreview:c,size:l})=>s?t?"0px 2px 6px 0px rgba(0, 0, 0, 0.06)":"0px 2px 6px 0px rgba(0, 0, 0, 0)":c?r||t?`0px ${l==="large"?12:4}px ${l==="large"?32:10}px 0px rgba(0, 0, 0, 0.064)`:`0px ${l==="large"?6:4}px ${l==="large"?14:4}px 0px rgba(0, 0, 0, 0.04)`:"0px 2px 6px 0px rgba(0, 0, 0, 0)",Ia=({textdocId:s,isInlinePreview:t=!1,isStreaming:r=!1,isDisabled:c=!1,isFocused:l=!1,isCanvasOpen:d=!1,marginBottom:f,size:a="large",onClick:p,children:y,name:_,type:k})=>{const m=w.useRef(null),[x,S]=w.useState(!1),[E]=w.useState(()=>br(100,180,!1)),{resolvedTheme:I}=En(),A=I==="dark",N=k?o.jsx("span",{className:re("flex-shrink-0 transition-[filter]",{grayscale:!l&&!x}),children:Ea(k,l&&d)}):o.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center overflow-hidden",children:o.jsx(at,{lines:1,size:"base",width:100,widthVariance:0})}),b=_?o.jsx("span",{className:"min-w-0 truncate",children:_}):o.jsx("div",{className:"flex h-5 flex-grow items-center overflow-hidden",style:{width:E},children:o.jsx(at,{lines:1,size:"base",width:100,widthVariance:0})}),M=r&&o.jsx(Sr,{size:20,className:re("flex-shrink-0",l?"text-blue-selection":"text-token-text-secondary")}),R=()=>{!m.current||c||(Fn.logButtonClick(Dn.MESSAGE_ATTACHMENT,{type:k}),Rr(m.current),p?.())},B=a==="large"?100:50,D=`${A?"rgba(0,0,0,0)":"rgba(255,255,255,0)"}, ${A?"#2f2f2f":"#ffffff"}`;return o.jsxs(ct.div,{role:"button",id:Er(s),initial:{opacity:r?0:1,scale:r?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:.72},className:re("popover relative flex select-none flex-col overflow-hidden border bg-token-main-surface-primary transition-shadow duration-500",c?"cursor-default":"cursor-pointer",{"border-token-text-tertiary font-medium dark:border-gray-600":l&&d,"font-regular":!l,"border-token-border-light":!x&&!l,"border-token-border-medium":x&&!l,"flex min-w-0 max-w-full flex-shrink flex-grow-0 items-center justify-between self-start rounded-xl":d||!t,"w-full rounded-2xl":!d&&t}),onMouseEnter:()=>!c&&S(!0),onMouseLeave:()=>S(!1),onClick:R,ref:m,style:{marginBottom:f,height:d||!t?void 0:a==="large"?"24rem":"10rem",width:a==="small"?"300px":void 0,boxShadow:Ca({isCanvasOpen:d,isFocused:l,isHovered:x,isInlinePreview:t,size:a})},children:[o.jsxs("div",{className:re("flex w-full min-w-0 items-center justify-between gap-2 self-start border-token-border-light px-4 transition-colors duration-700",{"border-token-border-light":!x&&!l,"border-token-border-medium":x&&!l,"text-sm font-medium text-token-text-primary":!d&&x&&t,"py-2":d||!t,"py-3":!d&&t,"text-sm font-medium text-token-text-secondary":!d&&!x&&t}),children:[o.jsxs("div",{className:re("flex min-w-0 items-center",{"gap-2":d||!t,"gap-3.5":!d&&t}),children:[N,b]}),d?o.jsx(ct.span,{animate:M?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:M}):t&&!c?o.jsx(ka,{isHovered:x}):null]}),o.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!d&&y,t&&!d&&o.jsx("div",{className:"absolute bottom-0 z-20 h-24 w-full transition-colors",style:{height:B,background:`linear-gradient(${D})`}}),t&&a==="small"&&!d&&o.jsx("div",{className:"absolute bottom-0 right-0 top-0 z-20 transition-colors",style:{width:B,background:`linear-gradient(to right, ${D})`}})]})]})},Ma=({type:s,name:t,isStreaming:r=!1,isFocused:c=!1,onClick:l,textdocId:d,isFetching:f=!1,isCanvasOpen:a=!1,isInlinePreview:p=!1})=>{const[y,_]=w.useState(!1),k=x=>{_(x>0)},m=a||!p?12:!a&&p?16:void 0;return o.jsx(Ia,{name:t,isFocused:c,isCanvasOpen:a,textdocId:d,type:s,isInlinePreview:p,isStreaming:r,onClick:l,marginBottom:m,children:p&&o.jsx("div",{className:re("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-light":y,"border-transparent":!y}),children:f?o.jsx(ms,{}):!!d&&o.jsx(Sa,{onScroll:k,textdocId:d})})})},Ta=({textdocId:s})=>{const t=jr(p=>p?.resolveTempTextdocId[s]??s),r=Ut(t),c=Ar(t),l=Pn();if(!r)return null;const d=()=>{Lt(t)},{title:f,type:a}=r;return o.jsx("div",{className:"flex w-full justify-end",children:o.jsx(Ma,{textdocId:t,type:a,name:f,isFocused:c,isCanvasOpen:l,onClick:d,isInlinePreview:!0})})},Ra=({messages:s})=>{const[t]=s,r=t?.message.metadata?.canvas;return!r||r.user_message_type!=null?null:o.jsx(o.Fragment,{children:r.pasted_textdocs?.map(({tempId:c})=>o.jsx(Ta,{textdocId:c},c))})};function ps({attachments:s,citations:t,contentReferences:r,className:c,clientThreadId:l,displayParts:d,isCompletionInProgress:f,id:a,isActivelyStreaming:p,isUserTurn:y,turnIndex:_,isFeedbackEnabled:k,messages:m,onRequestMoreCompletions:x,parts:S,prevGroupedMessageType:E,prevGroupedMessages:I,showEditButton:A,onEnterEdit:N,size:b="medium"}){const M=On(),R=m.length>1,{flagSeverity:B,shouldHideContent:D}=Un(R?void 0:m[0]),F=!S.some($=>$!==""),P=m[0].message.metadata?.targeted_reply_label??m[0].message.metadata?.targeted_reply;return w.useEffect(()=>{const $=m[0].message;if($.author.metadata?.real_author===`tool:${Br.SEARCHGPT}`&&!F){const W=$.metadata?.search_source;jt.logEvent(ue.searchToolRequestTimeToFirstTextToken,l,$.id,{search_source:W},()=>{W===Rs.InstantQuery&&js.logEvent(ue.searchToolPageLoadTimeToFirstTextToken,{message_id:$.id})})}},[l,F,m]),w.useEffect(()=>{if(!F)switch(E){case At.Browsing:jt.logEvent(ue.browsingTimeToFirstTextToken,l,m[0].message.id);break}},[F,m,l,E]),o.jsxs("div",{"data-message-author-role":m[0].message.author.role,"data-message-id":m[0].message.id,dir:"auto",className:re(c,"text-message flex w-full flex-col items-end gap-2 whitespace-normal break-words [.text-message+&]:mt-5"),"data-message-model-slug":m[0].message.metadata?.model_slug,children:[P&&o.jsxs("div",{className:"mb-1 ml-6 mt-1 flex items-start gap-1.5 text-sm font-normal text-token-text-tertiary sm:ml-7 lg:ml-8",children:[o.jsx(Wi,{className:"icon-md mt-1 shrink-0"}),o.jsx("p",{className:"mr-2 line-clamp-3",children:P})]}),y&&M&&o.jsx(Ra,{messages:m}),o.jsx(Nr,{messages:m}),o.jsx(ja,{parts:S,attachments:s,isUserTurn:y,isCompletionInProgress:f,turnIndex:_,displayParts:d,isActivelyStreaming:p,shouldHideContent:D,showEditButton:A,onEnterEdit:N,clientThreadId:l,id:a,isEmpty:F,prevGroupedMessageType:E,prevGroupedMessages:I,flagSeverity:B,messages:m,citations:t,contentReferences:r,size:b}),o.jsx(Fr,{message:R?void 0:m[0],id:a,isFeedbackEnabled:k,onRequestMoreCompletions:x,clientThreadId:l,isUserTurn:y}),o.jsx(Dr,{isUserTurn:y,message:R?void 0:m[0]}),!y&&!p&&I&&E===At.SearchResult&&o.jsx(Pr,{messages:I})]})}function ja({clientThreadId:s,id:t,displayParts:r,isCompletionInProgress:c,turnIndex:l,isActivelyStreaming:d,shouldHideContent:f,showEditButton:a=!1,onEnterEdit:p,isEmpty:y,prevGroupedMessageType:_,prevGroupedMessages:k,messages:m,citations:x,contentReferences:S,size:E,isUserTurn:I,parts:A,attachments:N}){const b=xe(),M=w.useRef(!1),R=Or(r),[B,D]=w.useState({}),[F,P]=w.useState(!1),$=Ur(),{streamingContext:W}=Lr();w.useEffect(()=>{$&&(W.setOnStylesUpdatedCallback(D),W.onStreamingChanged(c),W.setOnResetCallback(()=>P(!1)),c&&(P(!0),D(W.createTopLevelStyles())))},[$,c,W]);const Y=$r(),O=m[0].message.metadata?.gizmo_id,q=m[0].message.metadata?.serialization_metadata,Q=Wr(m[0].message).length,V=w.useMemo(()=>({clientThreadId:s,messageId:t,turnIndex:l}),[s,t,l]),j=qr(m[0].message),z=!!O&&Y.includes(O),G=w.useCallback(()=>{Ie.toggleChatThreadFlyout(s,l,t)},[s,l,t]),oe=o.jsx(Vr,{parts:A,attachments:N,isUserTurn:I,clientThreadId:s},"files-and-tables"),T=!!(N?.length||r.some(L=>L.type==="images")),C=Hr();function ie(L,X){const K=_===At.CodeInterpreter?k?.map(Se=>Se.message):void 0,{text:Z,contentReferences:we}=zr(X,x,S,z);let ce=we;C&&(ce=we.filter(Se=>Se.type!=="attribution"));const{processedText:Me,displayedContentReferences:ve}=Kr(Z,ce,d?void 0:K,!1,d);Me.includes(Qr)&&!M.current&&(M.current=!0,Ce.addError(new Error("Failed replaceTextWithDirectives"),{text:Me,displayedContentReferences:ve}));const ye=m[0].message,Je=ye.metadata?.message_locale;let qe=o.jsx(Jr,{clientThreadId:s,messageId:t,isStreamingOrProcessing:F,size:E,className:re(d&&!$&&"result-streaming",j&&"headers-v2"),children:Me===""?"&#8203;":Me});if(Je!=null){const Se=As(Je,!1);Se!=null&&(qe=o.jsx(Bs,{locale:Se,children:qe}))}return o.jsx(Xr.Provider,{value:{analyticsMetadata:V,message:ye,contentReferences:ve,onShowSearchResults:G,numImageResults:Q,isActivelyStreaming:d,useSafeUrls:!0},children:qe},L)}const me=r.map((L,X)=>{if(L.type==="transcription"){const K=f?null:L.text;let Z=null;if(I&&f)Z=o.jsx("span",{className:"italic opacity-30",children:o.jsx(H,{...et.contentRemoved})});else if(I&&K!=null)Z=K.trim().length===0?o.jsx("span",{className:"italic opacity-30",children:o.jsx(xt,{text:b.formatMessage(et.transcriptUnavailable),customSymbolOffsets:void 0})}):o.jsx("span",{className:"italic opacity-65",children:o.jsx(xt,{text:`“${K.trim()}”`,customSymbolOffsets:void 0})});else if(!I&&K!=null)return ie(X,K);return o.jsx(yt,{containsImagesOrAttachments:T,isUserTurn:I,showEditButton:a,onEnterEdit:p,children:Z},X)}else if(L.type==="text"){const K=f?null:L.text;return!y&&!f&&!I?ie(X,R):y&&d&&!I?$?o.jsx("div",{className:"pulsing-dot"},X):o.jsx("div",{className:"result-streaming",children:o.jsx("span",{children:o.jsx("pre",{})})},X):o.jsx(yt,{containsImagesOrAttachments:T,isUserTurn:I,showEditButton:a,onEnterEdit:p,children:I&&f?o.jsx("span",{className:"italic opacity-30",children:o.jsx(H,{...et.contentRemoved})}):K?o.jsx(xt,{text:K,customSymbolOffsets:q?.custom_symbol_offsets}):null},X)}else if(L.type==="images"){const K=m[0].message.metadata?.attachments??[];return o.jsx(Gr,{assets:L.imageAssets,attachments:K},X)}else return null}),be=r.findIndex(L=>L.type==="text");if(be!==-1?me.splice(be,0,oe):me.push(oe),f&&I)me.length=0,me.push(o.jsx(yt,{containsImagesOrAttachments:T,isUserTurn:I,onEnterEdit:Mt,children:o.jsx("span",{className:"italic opacity-30",children:o.jsx(H,{...et.contentRemoved})})}));else if(f&&!I)return null;return o.jsx("div",{className:re("flex w-full flex-col gap-1 empty:hidden",I&&"items-end rtl:items-start",!I&&"first:pt-[3px]",F&&"streaming-response"),style:B,children:me})}const et=lt({contentRemoved:{id:"textMessage.contentRemoved",defaultMessage:"Content removed"},transcriptUnavailable:{id:"textMessage.transcriptUnavailable",defaultMessage:"Transcript Unavailable"}});function Aa(s){const{isActivelyStreaming:t,...r}=s,c=Ns(),l=c?.includes("debug")??!1,d=s.messages[s.messages.length-1].message.id,[f,a]=w.useState([]),p=w.useRef(void 0);return p.current===void 0&&(p.current=c?.includes(Fs)??!1?new Yr(s.parts,a,t,void 0,{debug:l}):new Zr(s.parts,a,t)),w.useEffect(()=>{p.current!=null&&(p.current.onMessagePartsUpdated(s.parts,t),p.current.isBuffering()&&wt.addDelayedRenderingMessage(d))},[s.parts,d,t]),w.useEffect(()=>{p.current!=null&&!p.current.isBuffering()&&wt.removeDelayedRenderingMessage(d)},[f,d]),w.useEffect(()=>()=>wt.removeDelayedRenderingMessage(d),[d]),w.useEffect(()=>()=>{p.current!=null&&(p.current.destroy(),p.current=void 0)},[]),o.jsx(ps,{...r,displayParts:f,isActivelyStreaming:t||p.current?.isBuffering()})}function Ba({message:s,isCompletionInProgress:t,clientThreadId:r,className:c,isUserTurn:l,turnIndex:d,isFeedbackEnabled:f,prevGroupedMessageType:a,prevGroupedMessages:p,showEditButton:y,onEnterEdit:_,onRequestMoreCompletions:k}){const m=w.useMemo(()=>"parts"in s.message.content?s.message.content.parts:[eo(s.message)],[s]);return o.jsx(Na,{parts:m,messages:[s],isCompletionInProgress:t,className:c,citations:s.message.metadata?.citations,contentReferences:s.message.metadata?.content_references,attachments:s.message.metadata?.attachments,isUserTurn:l,turnIndex:d,id:s.nodeId,isFeedbackEnabled:f,onRequestMoreCompletions:k,clientThreadId:r,showEditButton:y,onEnterEdit:_,prevGroupedMessageType:a,prevGroupedMessages:p})}const fn=Ae.memo(Ba);function Na(s){const t=s.messages.length>1,{flagSeverity:r}=Un(t?void 0:s.messages[0]),c=r!=="danger"&&s.isCompletionInProgress,l=!s.parts.some(f=>f!==""),[d]=w.useState(()=>!s.isUserTurn&&(s.isCompletionInProgress||l));return d?o.jsx(Aa,{...s,isActivelyStreaming:c}):o.jsx(ps,{...s,displayParts:to({isUserTurn:s.isUserTurn,parts:s.parts}),isActivelyStreaming:c})}const Fa=({children:s})=>{const t=Ln();return t?.length?o.jsxs(te.Root,{children:[o.jsx(te.Trigger,{className:"h-10 px-2",children:s}),o.jsx(te.Content,{align:"end",onCloseAutoFocus:r=>r.preventDefault(),children:t.map(r=>o.jsx(Da,{textdocId:r},r))})]}):null},Da=({textdocId:s})=>{const t=kn(Ut(s));return o.jsx(te.Item,{icon:ft,onClick:()=>{Fn.logButtonClick(Dn.FILE_DRAWER_ITEM),Lt(t.textdocId)},children:t.title})},Pa=()=>{const s=xe(),t=Ln(),r=Pn();if(!t||r)return null;const c=t.length;return c===1?o.jsx(Oa,{textdocId:t[0]}):o.jsx(Fa,{children:o.jsx(_e,{label:s.formatMessage({id:"xX2Zyt",defaultMessage:"Open canvas"}),children:o.jsxs("div",{className:"flex items-center gap-1 text-token-text-secondary",children:[o.jsx(ft,{className:"icon-xl-heavy"}),c]})})})},Oa=({textdocId:s})=>{const t=xe(),r=kn(Ut(s));return o.jsx(_e,{label:t.formatMessage({id:"xX2Zyt",defaultMessage:"Open canvas"}),children:o.jsx(Ke,{onClick:()=>Lt(r.textdocId),icon:ft})})},gs={...Ds},Ua=gs.useInsertionEffect,La=Ua||(s=>s());function xs(s){const t=w.useRef(()=>{});return La(()=>{t.current=s}),w.useCallback(function(){for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return t.current==null?void 0:t.current(...c)},[])}var Nt=typeof document<"u"?w.useLayoutEffect:w.useEffect;let hn=!1,$a=0;const mn=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+$a++;function Wa(){const[s,t]=w.useState(()=>hn?mn():void 0);return Nt(()=>{s==null&&t(mn())},[]),w.useEffect(()=>{hn=!0},[]),s}const qa=gs.useId,Ha=qa||Wa;function Ga(){const s=new Map;return{emit(t,r){var c;(c=s.get(t))==null||c.forEach(l=>l(r))},on(t,r){s.set(t,[...s.get(t)||[],r])},off(t,r){var c;s.set(t,((c=s.get(t))==null?void 0:c.filter(l=>l!==r))||[])}}}const Va=w.createContext(null),za=w.createContext(null),Ka=()=>{var s;return((s=w.useContext(Va))==null?void 0:s.id)||null},Qa=()=>w.useContext(za),Ja="data-floating-ui-focusable";function Xa(s){const{open:t=!1,onOpenChange:r,elements:c}=s,l=Ha(),d=w.useRef({}),[f]=w.useState(()=>Ga()),a=Ka()!=null,[p,y]=w.useState(c.reference),_=xs((x,S,E)=>{d.current.openEvent=x?S:void 0,f.emit("openchange",{open:x,event:S,reason:E,nested:a}),r?.(x,S,E)}),k=w.useMemo(()=>({setPositionReference:y}),[]),m=w.useMemo(()=>({reference:p||c.reference||null,floating:c.floating||null,domReference:c.reference}),[p,c.reference,c.floating]);return w.useMemo(()=>({dataRef:d,open:t,onOpenChange:_,elements:m,events:f,floatingId:l,refs:k}),[t,_,m,f,l,k])}function Ya(s){s===void 0&&(s={});const{nodeId:t}=s,r=Xa({...s,elements:{reference:null,floating:null,...s.elements}}),c=s.rootContext||r,l=c.elements,[d,f]=w.useState(null),[a,p]=w.useState(null),_=l?.reference||d,k=w.useRef(null),m=Qa();Nt(()=>{_&&(k.current=_)},[_]);const x=no({...s,elements:{...l,...a&&{reference:a}}}),S=w.useCallback(b=>{const M=Ye(b)?{getBoundingClientRect:()=>b.getBoundingClientRect(),contextElement:b}:b;p(M),x.refs.setReference(M)},[x.refs]),E=w.useCallback(b=>{(Ye(b)||b===null)&&(k.current=b,f(b)),(Ye(x.refs.reference.current)||x.refs.reference.current===null||b!==null&&!Ye(b))&&x.refs.setReference(b)},[x.refs]),I=w.useMemo(()=>({...x.refs,setReference:E,setPositionReference:S,domReference:k}),[x.refs,E,S]),A=w.useMemo(()=>({...x.elements,domReference:_}),[x.elements,_]),N=w.useMemo(()=>({...x,...c,refs:I,elements:A,nodeId:t}),[x,I,A,t,c]);return Nt(()=>{c.dataRef.current.floatingContext=N;const b=m?.nodesRef.current.find(M=>M.id===t);b&&(b.context=N)}),w.useMemo(()=>({...x,context:N,refs:I,elements:A}),[x,I,A,N])}const pn="active",gn="selected";function St(s,t,r){const c=new Map,l=r==="item";let d=s;if(l&&s){const{[pn]:f,[gn]:a,...p}=s;d=p}return{...r==="floating"&&{tabIndex:-1,[Ja]:""},...d,...t.map(f=>{const a=f?f[r]:null;return typeof a=="function"?s?a(s):null:a}).concat(s).reduce((f,a)=>(a&&Object.entries(a).forEach(p=>{let[y,_]=p;if(!(l&&[pn,gn].includes(y)))if(y.indexOf("on")===0){if(c.has(y)||c.set(y,[]),typeof _=="function"){var k;(k=c.get(y))==null||k.push(_),f[y]=function(){for(var m,x=arguments.length,S=new Array(x),E=0;E<x;E++)S[E]=arguments[E];return(m=c.get(y))==null?void 0:m.map(I=>I(...S)).find(I=>I!==void 0)}}}else f[y]=_}),f),{})}}function Za(s){s===void 0&&(s=[]);const t=s.map(a=>a?.reference),r=s.map(a=>a?.floating),c=s.map(a=>a?.item),l=w.useCallback(a=>St(a,s,"reference"),t),d=w.useCallback(a=>St(a,s,"floating"),r),f=w.useCallback(a=>St(a,s,"item"),c);return w.useMemo(()=>({getReferenceProps:l,getFloatingProps:d,getItemProps:f}),[l,d,f])}function xn(s,t){return{...s,rects:{...s.rects,floating:{...s.rects.floating,height:t}}}}const ec=s=>({name:"inner",options:s,async fn(t){const{listRef:r,overflowRef:c,onFallbackChange:l,offset:d=0,index:f=0,minItemsVisible:a=4,referenceOverflowThreshold:p=0,scrollRef:y,..._}=so(s,t),{rects:k,elements:{floating:m}}=t,x=r.current[f],S=y?.current||m,E=m.clientTop||S.clientTop,I=m.clientTop!==0,A=S.clientTop!==0,N=m===S;if(!x)return{};const b={...t,...await $n(-x.offsetTop-m.clientTop-k.reference.height/2-x.offsetHeight/2-d).fn(t)},M=await gt(xn(b,S.scrollHeight+E+m.clientTop),_),R=await gt(b,{..._,elementContext:"reference"}),B=vt(0,M.top),D=b.y+B,F=ro(vt(0,S.scrollHeight+(I&&N||A?E*2:0)-B-vt(0,M.bottom)));if(S.style.maxHeight=F+"px",S.scrollTop=B,l){const P=S.scrollHeight>S.offsetHeight&&S.offsetHeight<x.offsetHeight*a-1||R.top>=-p||R.bottom>=-p;Be.flushSync(()=>l(P))}return c&&(c.current=await gt(xn({...b,y:D},S.offsetHeight+E+m.clientTop),_)),{y:D}}});function tc(s,t){const{open:r,elements:c}=s,{enabled:l=!0,overflowRef:d,scrollRef:f,onChange:a}=t,p=xs(a),y=w.useRef(!1),_=w.useRef(null),k=w.useRef(null);w.useEffect(()=>{if(!l)return;function x(E){if(E.ctrlKey||!S||d.current==null)return;const I=E.deltaY,A=d.current.top>=-.5,N=d.current.bottom>=-.5,b=S.scrollHeight-S.clientHeight,M=I<0?-1:1,R=I<0?"max":"min";S.scrollHeight<=S.clientHeight||(!A&&I>0||!N&&I<0?(E.preventDefault(),Be.flushSync(()=>{p(B=>B+Math[R](I,b*M))})):/firefox/i.test(oo())&&(S.scrollTop+=I))}const S=f?.current||c.floating;if(r&&S)return S.addEventListener("wheel",x),requestAnimationFrame(()=>{_.current=S.scrollTop,d.current!=null&&(k.current={...d.current})}),()=>{_.current=null,k.current=null,S.removeEventListener("wheel",x)}},[l,r,c.floating,d,f,p]);const m=w.useMemo(()=>({onKeyDown(){y.current=!0},onWheel(){y.current=!1},onPointerMove(){y.current=!1},onScroll(){const x=f?.current||c.floating;if(!(!d.current||!x||!y.current)){if(_.current!==null){const S=x.scrollTop-_.current;(d.current.bottom<-.5&&S<-1||d.current.top<-.5&&S>1)&&Be.flushSync(()=>p(E=>E+S))}requestAnimationFrame(()=>{_.current=x.scrollTop})}}}),[c.floating,p,d,f]);return w.useMemo(()=>l?{floating:m}:{},[l,m])}let We=w.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});We.displayName="FloatingContext";let Gt=w.createContext(null);Gt.displayName="PlacementContext";function nc(s){return w.useMemo(()=>s?typeof s=="string"?{to:s}:s:null,[s])}function sc(){return w.useContext(We).setReference}function rc(){return w.useContext(We).getReferenceProps}function oc(){let{getFloatingProps:s,slot:t}=w.useContext(We);return w.useCallback((...r)=>Object.assign({},s(...r),{"data-anchor":t.anchor}),[s,t])}function ic(s=null){s===!1&&(s=null),typeof s=="string"&&(s={to:s});let t=w.useContext(Gt),r=w.useMemo(()=>s,[JSON.stringify(s,(l,d)=>{var f;return(f=d?.outerHTML)!=null?f:d})]);Ne(()=>{t?.(r??null)},[t,r]);let c=w.useContext(We);return w.useMemo(()=>[c.setFloating,s?c.styles:{}],[c.setFloating,s,c.styles])}let yn=4;function ac({children:s,enabled:t=!0}){let[r,c]=w.useState(null),[l,d]=w.useState(0),f=w.useRef(null),[a,p]=w.useState(null);cc(a);let y=t&&r!==null&&a!==null,{to:_="bottom",gap:k=0,offset:m=0,padding:x=0,inner:S}=lc(r,a),[E,I="center"]=_.split(" ");Ne(()=>{y&&d(0)},[y]);let{refs:A,floatingStyles:N,context:b}=Ya({open:y,placement:E==="selection"?I==="center"?"bottom":`bottom-${I}`:I==="center"?`${E}`:`${E}-${I}`,strategy:"absolute",transform:!1,middleware:[$n({mainAxis:E==="selection"?0:k,crossAxis:m}),io({padding:x}),E!=="selection"&&ao({padding:x}),E==="selection"&&S?ec({...S,padding:x,overflowRef:f,offset:l,minItemsVisible:yn,referenceOverflowThreshold:x,onFallbackChange(W){var Y,O;if(!W)return;let q=b.elements.floating;if(!q)return;let Q=parseFloat(getComputedStyle(q).scrollPaddingBottom)||0,V=Math.min(yn,q.childElementCount),j=0,z=0;for(let G of(O=(Y=b.elements.floating)==null?void 0:Y.childNodes)!=null?O:[])if(G instanceof HTMLElement){let oe=G.offsetTop,T=oe+G.clientHeight+Q,C=q.scrollTop,ie=C+q.clientHeight;if(oe>=C&&T<=ie)V--;else{z=Math.max(0,Math.min(T,ie)-Math.max(oe,C)),j=G.clientHeight;break}}V>=1&&d(G=>{let oe=j*V-z+Q;return G>=oe?G:oe})}}):null,co({padding:x,apply({availableWidth:W,availableHeight:Y,elements:O}){Object.assign(O.floating.style,{overflow:"auto",maxWidth:`${W}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${Y}px)`})}})].filter(Boolean),whileElementsMounted:Ps}),[M=E,R=I]=b.placement.split("-");E==="selection"&&(M="selection");let B=w.useMemo(()=>({anchor:[M,R].filter(Boolean).join(" ")}),[M,R]),D=tc(b,{overflowRef:f,onChange:d}),{getReferenceProps:F,getFloatingProps:P}=Za([D]),$=he(W=>{p(W),A.setFloating(W)});return w.createElement(Gt.Provider,{value:c},w.createElement(We.Provider,{value:{setFloating:$,setReference:A.setReference,styles:N,getReferenceProps:F,getFloatingProps:P,slot:B}},s))}function cc(s){Ne(()=>{if(!s)return;let t=new MutationObserver(()=>{let r=window.getComputedStyle(s).maxHeight,c=parseFloat(r);if(isNaN(c))return;let l=parseInt(r);isNaN(l)||c!==l&&(s.style.maxHeight=`${Math.ceil(c)}px`)});return t.observe(s,{attributes:!0,attributeFilter:["style"]}),()=>{t.disconnect()}},[s])}function lc(s,t){var r,c,l;let d=Et((r=s?.gap)!=null?r:"var(--anchor-gap, 0)",t),f=Et((c=s?.offset)!=null?c:"var(--anchor-offset, 0)",t),a=Et((l=s?.padding)!=null?l:"var(--anchor-padding, 0)",t);return{...s,gap:d,offset:f,padding:a}}function Et(s,t,r=void 0){let c=Wn(),l=he((p,y)=>{if(p==null)return[r,null];if(typeof p=="number")return[p,null];if(typeof p=="string"){if(!y)return[r,null];let _=wn(p,y);return[_,k=>{let m=ys(p);{let x=m.map(S=>window.getComputedStyle(y).getPropertyValue(S));c.requestAnimationFrame(function S(){c.nextFrame(S);let E=!1;for(let[A,N]of m.entries()){let b=window.getComputedStyle(y).getPropertyValue(N);if(x[A]!==b){x[A]=b,E=!0;break}}if(!E)return;let I=wn(p,y);_!==I&&(k(I),_=I)})}return c.dispose}]}return[r,null]}),d=w.useMemo(()=>l(s,t)[0],[s,t]),[f=d,a]=w.useState();return Ne(()=>{let[p,y]=l(s,t);if(a(p),!!y)return y(a)},[s,t]),f}function ys(s){let t=/var\((.*)\)/.exec(s);if(t){let r=t[1].indexOf(",");if(r===-1)return[t[1]];let c=t[1].slice(0,r).trim(),l=t[1].slice(r+1).trim();return l?[c,...ys(l)]:[c]}return[]}function wn(s,t){let r=document.createElement("div");t.appendChild(r),r.style.setProperty("margin-top","0px","important"),r.style.setProperty("margin-top",s,"important");let c=parseFloat(window.getComputedStyle(r).marginTop)||0;return t.removeChild(r),c}var uc=(s=>(s[s.Open=0]="Open",s[s.Closed=1]="Closed",s))(uc||{}),dc=(s=>(s[s.Pointer=0]="Pointer",s[s.Other=1]="Other",s))(dc||{}),fc=(s=>(s[s.OpenMenu=0]="OpenMenu",s[s.CloseMenu=1]="CloseMenu",s[s.GoToItem=2]="GoToItem",s[s.Search=3]="Search",s[s.ClearSearch=4]="ClearSearch",s[s.RegisterItem=5]="RegisterItem",s[s.UnregisterItem=6]="UnregisterItem",s[s.SetButtonElement=7]="SetButtonElement",s[s.SetItemsElement=8]="SetItemsElement",s))(fc||{});function kt(s,t=r=>r){let r=s.activeItemIndex!==null?s.items[s.activeItemIndex]:null,c=Po(t(s.items.slice()),d=>d.dataRef.current.domRef.current),l=r?c.indexOf(r):null;return l===-1&&(l=null),{items:c,activeItemIndex:l}}let hc={1(s){return s.menuState===1?s:{...s,activeItemIndex:null,menuState:1}},0(s){return s.menuState===0?s:{...s,__demoMode:!1,menuState:0}},2:(s,t)=>{var r,c,l,d,f;if(s.menuState===1)return s;let a={...s,searchQuery:"",activationTrigger:(r=t.trigger)!=null?r:1,__demoMode:!1};if(t.focus===pe.Nothing)return{...a,activeItemIndex:null};if(t.focus===pe.Specific)return{...a,activeItemIndex:s.items.findIndex(_=>_.id===t.id)};if(t.focus===pe.Previous){let _=s.activeItemIndex;if(_!==null){let k=s.items[_].dataRef.current.domRef,m=_t(t,{resolveItems:()=>s.items,resolveActiveIndex:()=>s.activeItemIndex,resolveId:x=>x.id,resolveDisabled:x=>x.dataRef.current.disabled});if(m!==null){let x=s.items[m].dataRef.current.domRef;if(((c=k.current)==null?void 0:c.previousElementSibling)===x.current||((l=x.current)==null?void 0:l.previousElementSibling)===null)return{...a,activeItemIndex:m}}}}else if(t.focus===pe.Next){let _=s.activeItemIndex;if(_!==null){let k=s.items[_].dataRef.current.domRef,m=_t(t,{resolveItems:()=>s.items,resolveActiveIndex:()=>s.activeItemIndex,resolveId:x=>x.id,resolveDisabled:x=>x.dataRef.current.disabled});if(m!==null){let x=s.items[m].dataRef.current.domRef;if(((d=k.current)==null?void 0:d.nextElementSibling)===x.current||((f=x.current)==null?void 0:f.nextElementSibling)===null)return{...a,activeItemIndex:m}}}}let p=kt(s),y=_t(t,{resolveItems:()=>p.items,resolveActiveIndex:()=>p.activeItemIndex,resolveId:_=>_.id,resolveDisabled:_=>_.dataRef.current.disabled});return{...a,...p,activeItemIndex:y}},3:(s,t)=>{let r=s.searchQuery!==""?0:1,c=s.searchQuery+t.value.toLowerCase(),l=(s.activeItemIndex!==null?s.items.slice(s.activeItemIndex+r).concat(s.items.slice(0,s.activeItemIndex+r)):s.items).find(f=>{var a;return((a=f.dataRef.current.textValue)==null?void 0:a.startsWith(c))&&!f.dataRef.current.disabled}),d=l?s.items.indexOf(l):-1;return d===-1||d===s.activeItemIndex?{...s,searchQuery:c}:{...s,searchQuery:c,activeItemIndex:d,activationTrigger:1}},4(s){return s.searchQuery===""?s:{...s,searchQuery:"",searchActiveItemIndex:null}},5:(s,t)=>{let r=kt(s,c=>[...c,{id:t.id,dataRef:t.dataRef}]);return{...s,...r}},6:(s,t)=>{let r=kt(s,c=>{let l=c.findIndex(d=>d.id===t.id);return l!==-1&&c.splice(l,1),c});return{...s,...r,activationTrigger:1}},7:(s,t)=>s.buttonElement===t.element?s:{...s,buttonElement:t.element},8:(s,t)=>s.itemsElement===t.element?s:{...s,itemsElement:t.element}},Vt=w.createContext(null);Vt.displayName="MenuContext";function ht(s){let t=w.useContext(Vt);if(t===null){let r=new Error(`<${s} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,ht),r}return t}function mc(s,t){return qn(t.type,hc,s,t)}let pc=w.Fragment;function gc(s,t){let{__demoMode:r=!1,...c}=s,l=w.useReducer(mc,{__demoMode:r,menuState:r?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:d,itemsElement:f,buttonElement:a},p]=l,y=dt(t);lo(d===0,[a,f],(x,S)=>{p({type:1}),uo(S,fo.Loose)||(x.preventDefault(),a?.focus())});let _=he(()=>{p({type:1})}),k=w.useMemo(()=>({open:d===0,close:_}),[d,_]),m={ref:y};return Ae.createElement(ac,null,Ae.createElement(Vt.Provider,{value:l},Ae.createElement(ho,{value:qn(d,{0:it.Open,1:it.Closed})},Ue({ourProps:m,theirProps:c,slot:k,defaultTag:pc,name:"Menu"}))))}let xc="button";function yc(s,t){var r;let c=w.useId(),{id:l=`headlessui-menu-button-${c}`,disabled:d=!1,autoFocus:f=!1,...a}=s,[p,y]=ht("Menu.Button"),_=rc(),k=mo(),m=dt(t,sc(),he(F=>y({type:7,element:F}))),x=he(F=>{switch(F.key){case fe.Space:case fe.Enter:case fe.ArrowDown:F.preventDefault(),F.stopPropagation(),Be.flushSync(()=>y({type:0})),y({type:2,focus:pe.First});break;case fe.ArrowUp:F.preventDefault(),F.stopPropagation(),Be.flushSync(()=>y({type:0})),y({type:2,focus:pe.Last});break}}),S=he(F=>{switch(F.key){case fe.Space:F.preventDefault();break}}),E=he(F=>{var P;if(po(F.currentTarget))return F.preventDefault();d||(p.menuState===0?(Be.flushSync(()=>y({type:1})),(P=p.buttonElement)==null||P.focus({preventScroll:!0})):(F.preventDefault(),y({type:0})))}),{isFocusVisible:I,focusProps:A}=go({autoFocus:f}),{isHovered:N,hoverProps:b}=xo({isDisabled:d}),{pressed:M,pressProps:R}=yo({disabled:d}),B=w.useMemo(()=>({open:p.menuState===0,active:M||p.menuState===0,disabled:d,hover:N,focus:I,autofocus:f}),[p,N,I,M,d,f]),D=Hn(_(),{ref:m,id:l,type:wo(s,p.buttonElement),"aria-haspopup":"menu","aria-controls":(r=p.itemsElement)==null?void 0:r.id,"aria-expanded":p.menuState===0,disabled:d||void 0,autoFocus:f,onKeyDown:x,onKeyUp:S,onClick:E},A,b,R);return Ue({mergeRefs:k,ourProps:D,theirProps:a,slot:B,defaultTag:xc,name:"Menu.Button"})}let wc="div",vc=nn.RenderStrategy|nn.Static;function _c(s,t){var r,c;let l=w.useId(),{id:d=`headlessui-menu-items-${l}`,anchor:f,portal:a=!1,modal:p=!0,transition:y=!1,..._}=s,k=nc(f),[m,x]=ht("Menu.Items"),[S,E]=ic(k),I=oc(),[A,N]=w.useState(null),b=dt(t,k?S:null,he(j=>x({type:8,element:j})),N),M=vo(m.itemsElement);k&&(a=!0);let R=_o(),[B,D]=bo(y,A,R!==null?(R&it.Open)===it.Open:m.menuState===0);So(B,m.buttonElement,()=>{x({type:1})});let F=m.__demoMode?!1:p&&m.menuState===0;Eo(F,M);let P=m.__demoMode?!1:p&&m.menuState===0;ko(P,{allowed:w.useCallback(()=>[m.buttonElement,m.itemsElement],[m.buttonElement,m.itemsElement])});let $=m.menuState!==0,W=Co($,m.buttonElement)?!1:B;w.useEffect(()=>{let j=m.itemsElement;j&&m.menuState===0&&j!==M?.activeElement&&j.focus({preventScroll:!0})},[m.menuState,m.itemsElement,M]),Io(m.menuState===0,{container:m.itemsElement,accept(j){return j.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:j.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(j){j.setAttribute("role","none")}});let Y=Wn(),O=he(j=>{var z,G,oe;switch(Y.dispose(),j.key){case fe.Space:if(m.searchQuery!=="")return j.preventDefault(),j.stopPropagation(),x({type:3,value:j.key});case fe.Enter:if(j.preventDefault(),j.stopPropagation(),x({type:1}),m.activeItemIndex!==null){let{dataRef:T}=m.items[m.activeItemIndex];(G=(z=T.current)==null?void 0:z.domRef.current)==null||G.click()}Gn(m.buttonElement);break;case fe.ArrowDown:return j.preventDefault(),j.stopPropagation(),x({type:2,focus:pe.Next});case fe.ArrowUp:return j.preventDefault(),j.stopPropagation(),x({type:2,focus:pe.Previous});case fe.Home:case fe.PageUp:return j.preventDefault(),j.stopPropagation(),x({type:2,focus:pe.First});case fe.End:case fe.PageDown:return j.preventDefault(),j.stopPropagation(),x({type:2,focus:pe.Last});case fe.Escape:j.preventDefault(),j.stopPropagation(),Be.flushSync(()=>x({type:1})),(oe=m.buttonElement)==null||oe.focus({preventScroll:!0});break;case fe.Tab:j.preventDefault(),j.stopPropagation(),Be.flushSync(()=>x({type:1})),Mo(m.buttonElement,j.shiftKey?sn.Previous:sn.Next);break;default:j.key.length===1&&(x({type:3,value:j.key}),Y.setTimeout(()=>x({type:4}),350));break}}),q=he(j=>{switch(j.key){case fe.Space:j.preventDefault();break}}),Q=w.useMemo(()=>({open:m.menuState===0}),[m.menuState]),V=Hn(k?I():{},{"aria-activedescendant":m.activeItemIndex===null||(r=m.items[m.activeItemIndex])==null?void 0:r.id,"aria-labelledby":(c=m.buttonElement)==null?void 0:c.id,id:d,onKeyDown:O,onKeyUp:q,role:"menu",tabIndex:m.menuState===0?0:void 0,ref:b,style:{..._.style,...E,"--button-width":To(m.buttonElement,!0).width},...Ro(D)});return Ae.createElement(jo,{enabled:a?s.static||B:!1},Ue({ourProps:V,theirProps:_,slot:Q,defaultTag:wc,features:vc,visible:W,name:"Menu.Items"}))}let bc=w.Fragment;function Sc(s,t){let r=w.useId(),{id:c=`headlessui-menu-item-${r}`,disabled:l=!1,...d}=s,[f,a]=ht("Menu.Item"),p=f.activeItemIndex!==null?f.items[f.activeItemIndex].id===c:!1,y=w.useRef(null),_=dt(t,y);Ne(()=>{if(!f.__demoMode&&f.menuState===0&&p&&f.activationTrigger!==0)return Ao().requestAnimationFrame(()=>{var P,$;($=(P=y.current)==null?void 0:P.scrollIntoView)==null||$.call(P,{block:"nearest"})})},[f.__demoMode,y,p,f.menuState,f.activationTrigger,f.activeItemIndex]);let k=Bo(y),m=w.useRef({disabled:l,domRef:y,get textValue(){return k()}});Ne(()=>{m.current.disabled=l},[m,l]),Ne(()=>(a({type:5,id:c,dataRef:m}),()=>a({type:6,id:c})),[m,c]);let x=he(()=>{a({type:1})}),S=he(P=>{if(l)return P.preventDefault();a({type:1}),Gn(f.buttonElement)}),E=he(()=>{if(l)return a({type:2,focus:pe.Nothing});a({type:2,focus:pe.Specific,id:c})}),I=No(),A=he(P=>{I.update(P),!l&&(p||a({type:2,focus:pe.Specific,id:c,trigger:0}))}),N=he(P=>{I.wasMoved(P)&&(l||p||a({type:2,focus:pe.Specific,id:c,trigger:0}))}),b=he(P=>{I.wasMoved(P)&&(l||p&&a({type:2,focus:pe.Nothing}))}),[M,R]=Vn(),[B,D]=Fo(),F=w.useMemo(()=>({active:p,focus:p,disabled:l,close:x}),[p,l,x]);return Ae.createElement(R,null,Ae.createElement(D,null,Ue({ourProps:{id:c,ref:_,role:"menuitem",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-labelledby":M,"aria-describedby":B,disabled:void 0,onClick:S,onFocus:E,onPointerEnter:A,onMouseEnter:A,onPointerMove:N,onMouseMove:N,onPointerLeave:b,onMouseLeave:b},theirProps:d,slot:F,defaultTag:bc,name:"Menu.Item"})))}let Ec="div";function kc(s,t){let[r,c]=Vn();return Ae.createElement(c,null,Ue({ourProps:{ref:t,"aria-labelledby":r,role:"group"},theirProps:s,slot:{},defaultTag:Ec,name:"Menu.Section"}))}let Cc="header";function Ic(s,t){let r=w.useId(),{id:c=`headlessui-menu-heading-${r}`,...l}=s,d=Do();Ne(()=>d.register(c),[c,d.register]);let f={id:c,ref:t,role:"presentation",...d.props};return Ue({ourProps:f,theirProps:l,slot:{},defaultTag:Cc,name:"Menu.Heading"})}let Mc="div";function Tc(s,t){return Ue({ourProps:{ref:t,role:"separator"},theirProps:s,slot:{},defaultTag:Mc,name:"Menu.Separator"})}let Rc=Oe(gc),jc=Oe(yc),Ac=Oe(_c),Bc=Oe(Sc),Nc=Oe(kc),Fc=Oe(Ic),Dc=Oe(Tc),Ge=Object.assign(Rc,{Button:jc,Items:Ac,Item:Bc,Section:Nc,Heading:Fc,Separator:Dc});function Pc({show:s,appear:t,children:r}){return o.jsx(Oo,{as:w.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",show:s,appear:t,children:r})}function je({onClick:s,href:t,target:r,children:c,disabled:l,icon:d,testId:f}){const a=Qe();return o.jsx(Ge.Item,{disabled:l,children:({active:p})=>o.jsxs(mt,{onClick:s,href:t,target:r,className:re({"bg-token-sidebar-surface-secondary":p,"hover:bg-token-sidebar-surface-secondary":!p&&!l||a}),"data-testid":f,children:[d&&o.jsx(d,{className:"icon-md"}),c]})})}function Oc({to:s,children:t,icon:r}){return o.jsx(Ge.Item,{children:({active:c})=>o.jsx(Os,{to:s,children:o.jsxs(mt,{$as:"span",className:re(c?"bg-token-sidebar-surface-secondary":"cursor-pointer"),children:[r&&o.jsx(r,{className:"icon-md"}),t]})})})}Fe.a`p-2 rounded-md hover:bg-black/10 hover:dark:bg-white/10 cursor-pointer`;const mt=Fe.a`flex gap-2 rounded p-2.5 text-sm cursor-pointer focus:ring-0 hover:bg-token-main-surface-secondary radix-disabled:pointer-events-none radix-disabled:opacity-50 group items-center`,Wl=Fe(mt)`border dark:border-white/20 min-h-0 hover:bg-gray-500/10 h-10 rounded-lg border-[rgba(0,0,0,0.1)]`,Ft=Fe.div`h-px bg-token-border-light my-1.5`,ql=Fe(mt)`${s=>s.$active?"bg-token-sidebar-surface-secondary":"hover:bg-token-sidebar-surface-secondary"}`,Uc=Ve(()=>ze(()=>import("./hg2kwixl1elebwsk.js"),__vite__mapDeps([33,1,2,3,5,6,34,35,36,37,15,20])));function Hl({onClickSettings:s}){const t=Qe();return o.jsxs(Ge,{as:"div",className:re(!t&&"group relative"),children:[o.jsx(qc,{}),o.jsx(Pc,{children:o.jsx(Ge.Items,{className:re("popover absolute bottom-full z-50 mb-1 overflow-hidden rounded-lg border border-token-border-light bg-token-main-surface-primary p-1.5 shadow-lg outline-none",t&&"left-3 w-[var(--screen-sidebar-popover-min-width)]",!t&&"left-0 w-full"),children:o.jsx(Wc,{onClickSettings:s})})})]})}function ws(){const s=!De()?.isEnterprisey(),t=xe(),r=Wt(),c=Pt();return r?o.jsxs("div",{className:"flex items-center justify-between gap-2 py-2 pl-5 pr-4",children:[o.jsx("div",{className:"text-sm text-token-text-secondary",children:r?.email}),s&&o.jsx(_e,{label:t.formatMessage(Te.addWorkspaceTooltip),side:"right",children:o.jsx("button",{onClick:()=>es(c,"profile menu"),children:o.jsx(Ki,{className:"icon-sm text-token-text-primary"})})})]}):null}function Lc(){const s=De();return s==null?o.jsx(o.Fragment,{children:o.jsx("div",{className:"w-full px-3 py-2",children:o.jsx(st,{})})}):o.jsxs(o.Fragment,{children:[o.jsx(ws,{}),o.jsx("div",{className:"flex h-11 w-full items-center justify-start gap-3 px-3 py-1 text-sm",children:o.jsx(_s,{workspace:s,isLoading:!1,currentWorkspaceId:s.id,showCheck:!1})})]})}function vs({menuItemComponent:s}){const t=$t(),r=Dt(),{data:c}=ut(),l=De(),[d,f]=w.useState(!1),a=Wt(),p=xe(),y=Cn();if(!l||!c)return null;const _=l.isWorkspaceAccount(),k=c.accountItems.length>1,m=c.accountItems,x=Uo([m.find(E=>E.isPersonalAccount()),...m.filter(E=>!E.isPersonalAccount())]);if(x.sort((E,I)=>E.isPersonalAccount()?1:I.isPersonalAccount()?-1:0),!k)return _?o.jsx(Lc,{}):o.jsx(o.Fragment,{children:o.jsx("div",{className:"ml-3 mr-2 py-2 text-sm text-token-text-secondary",children:a?.email})});const S=x.map(E=>o.jsx(s,{disabled:E.isDeactivated(),onClick:()=>{if(E.isDeactivated()||E.id===l?.id)return;f(!0);const{willRedirect:I}=Us(r,E.id,t,p,y);I||Ls()},className:"radix-disabled:pointer-events-auto radix-disabled:hover:bg-transparent",children:E.isDeactivated()?o.jsx($c,{workspace:E,isLoading:d}):o.jsx(_s,{workspace:E,isLoading:d,currentWorkspaceId:l?.id})},E.id));return o.jsxs(o.Fragment,{children:[o.jsx(ws,{}),o.jsx(te.Separator,{}),S]})}function _s({workspace:s,isLoading:t,currentWorkspaceId:r,showCheck:c=!0}){const l=s.canAccessWithCurrentSession,d=!t&&c&&s.id===r;return o.jsxs("div",{children:[o.jsxs("div",{className:"flex w-full items-center gap-2.5",children:[o.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:o.jsx(qt,{iconSize:"small",workspace:s,className:re({"flex-shrink-0":!0})})}),o.jsx("div",{className:"line-clamp-1 text-token-text-primary",children:zn(xe(),s)}),t&&o.jsx(st,{}),d&&o.jsx("span",{className:"text-token-text-primary",children:o.jsx(qi,{className:"icon-sm"})}),!l&&o.jsx("span",{className:"text-token-text-primary",children:o.jsx(Hi,{className:"icon-sm"})})]}),!l&&o.jsx("div",{className:"rowDivClassName",children:o.jsx("small",{className:"text-token-text-secondary",children:o.jsx(H,{...s.ssoConnectionName?Te.authenticateWithSSOToAccessWorkspace:Te.authenticateWithoutSSOToAccessWorkspace})})})]})}function $c({workspace:s,isLoading:t}){const r=xe(),c=s.isOwnerOfAccount(),[l,d]=w.useState(!1),f=na(s.id);return w.useEffect(()=>{f!=null&&l&&(Ie.setPurchaseWorkspaceData({minimumSeats:Math.max(f,rn),existingAccount:s}),d(!1))},[f,l,s]),o.jsxs(o.Fragment,{children:[o.jsxs(_e,{className:"flex w-full flex-1 items-center gap-2.5",label:r.formatMessage(Te.disabledWorkspaceTooltip),sideOffset:20,side:"right",children:[o.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:o.jsx(Gi,{className:"icon-sm flex-shrink-0 opacity-30"})}),o.jsx("div",{className:"truncate opacity-30",children:zn(r,s)})]}),t&&o.jsx(st,{}),!t&&o.jsxs(te.Root,{children:[o.jsx(te.Trigger,{className:"rounded text-center hover:bg-token-main-surface-secondary",children:o.jsx(Vi,{className:"icon-sm m-1"})}),o.jsx(te.Portal,{children:o.jsxs(te.Content,{children:[c&&o.jsx(o.Fragment,{children:o.jsx(te.Item,{onClick:()=>{f==null?d(!0):Ie.setPurchaseWorkspaceData({minimumSeats:Math.max(f,rn),existingAccount:s})},children:l?o.jsx(st,{}):o.jsx(H,{id:"navigation.reactivateWorkspace",defaultMessage:"Reactivate workspace"})})}),o.jsx(te.Item,{onClick:()=>{Ie.setLeaveWorkspaceData(s)},children:o.jsx(H,{id:"navigation.leaveWorkspace",defaultMessage:"Leave workspace"})})]})})]})]})}function Wc({onClickSettings:s}){const{data:t}=ut(),r=De(),c=Kn(),l=Qn(),{openModal:d}=Jn(),f=In("3905879930");var a=r?.isTeam()??!1,p=!1;if(a&&(p=f.config.get("enabled",!1)),!r||!t)return null;const y=r.isWorkspaceAccount(),_=!c;return o.jsxs("nav",{children:[o.jsx(vs,{menuItemComponent:je}),o.jsx(Ft,{}),y?o.jsx(Yn,{menuItemComponent:je,routedMenuItemComponent:Oc}):o.jsx(Xn,{menuItemComponent:je}),_&&o.jsx(je,{href:Lo(),target:"_blank",onClick:()=>{le.logEvent(ue.clickFaqLink)},icon:zi,children:o.jsx(H,{...Te.helpAndFaq})}),o.jsx(je,{onClick:s,icon:as,testId:"accounts-settings-button",children:o.jsx(H,{...Te.settings})}),a&&p&&o.jsxs(o.Fragment,{children:[o.jsx(je,{onClick:()=>{Ie.openModal(Zn.InviteUsersToWorkspace),le.logEvent(ue.accountMemberInviteButton,{location:"dropdown-menu-click"}),Pe.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"dropdown-menu-click",text:"AddTeammates",step:"OpenModal"})},icon:cs,children:o.jsx(H,{...Te.addTeammatesButton})}),o.jsx(Uc,{workspace:r})]}),l&&o.jsx(Hc,{openDownloadModal:d}),o.jsx(Ft,{}),o.jsx(je,{onClick:()=>{le.logEvent(ue.clickLogOut,{eventSource:"mouse"}),Mn()},icon:ls,children:o.jsx(H,{...Te.logOut})})]})}function qc(){return Wt()?o.jsx(Gc,{}):null}function Hc({openDownloadModal:s}){return o.jsxs("span",{children:[o.jsx(Ft,{}),o.jsx(je,{icon:us,onClick:()=>{le.logEvent(ue.accountMenuClickDownloadApp),s()},children:o.jsx(H,{...Te.downloadApp})})]})}function Gc(){const{data:s}=ut(),t=De(),r=$o(),c=Wo(),l=Qe();if(!t||!s)return null;const d=t.isWorkspaceAccount(),f=s.accountItems.length>1;return o.jsxs(Ge.Button,{className:re("flex w-full max-w-[100%] items-center gap-2 rounded-lg text-sm group-ui-open:bg-token-sidebar-surface-secondary",l&&"px-2 py-1.5 hover:bg-token-main-surface-secondary",!l&&"p-2 hover:bg-token-sidebar-surface-secondary"),"data-testid":"accounts-profile-button",children:[o.jsx("div",{className:"flex-shrink-0",style:{viewTransitionName:"var(--vt-profile-avatar-sidebar)"},children:o.jsx(qt,{iconSize:"gizmo"})}),o.jsxs("div",{className:"relative -top-px grow -space-y-px truncate text-start text-token-text-primary",children:[o.jsx("div",{dir:"auto",children:c}),d||f?o.jsx("div",{className:"truncate text-xs text-token-text-secondary",dir:"auto",children:r}):null]})]})}const Te=lt({helpAndFaq:{id:"navigation.helpAndFaq",defaultMessage:"Help & FAQ"},settings:{id:"navigation.settings",defaultMessage:"Settings"},logOut:{id:"navigation.logOut",defaultMessage:"Log out"},accountSwitcherTitle:{id:"navigation.accountSwitcherTitle",defaultMessage:"Workspaces"},defaultWorkspaceTitle:{id:"useWorkspaces.defaultWorkspaceTitle",defaultMessage:"Untitled Workspace"},addWorkspaceTooltip:{id:"navigation.addWorkspaceTooltip",defaultMessage:"Create a Team workspace"},disabledWorkspaceTooltip:{id:"navigation.disabledWorkspaceTooltip",defaultMessage:"This workspace has been deactivated"},downloadApp:{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"},authenticateWithSSOToAccessWorkspace:{id:"CV7pdM",defaultMessage:"Authenticate with SSO to access this workspace"},authenticateWithoutSSOToAccessWorkspace:{id:"zfCWFh",defaultMessage:"Authenticate without SSO to access this workspace"},addTeammatesButton:{id:"inviteMemberButton.inviteMemberButton",defaultMessage:"Add Teammates"}}),Vc=["Not relevant","Out of date","Content is wrong"],zc=["Relevant","Up to date","Accurate"];function Kc({citationMetadata:s,noBottomBorder:t=!1,sourceFeedback:r,setSourceFeedback:c}){const[l,d]=w.useMemo(()=>{if(s.type!=="file")return["",""];const y=s.name.split(".");return y.length>1?[y.slice(0,-1).join("."),y[y.length-1]]:[s.name,""]},[s]),f=w.useMemo(()=>ts(Tn.GDRIVE,d),[d]),a=w.useMemo(()=>{if(s.type==="file"&&s.extra?.cloud_doc_url)try{return new URL(s.extra.cloud_doc_url).hostname}catch{return}},[s]),p=w.useCallback(y=>{c({rating:y,tags:[]})},[c]);return s.type!=="file"?null:o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-row items-center justify-between py-2",children:[o.jsxs("div",{className:"max-width-full mr-2 flex grow flex-row items-center overflow-hidden",children:[o.jsx(f,{className:"mr-2 flex-shrink-0 flex-grow-0"}),o.jsx("a",{href:s.extra?.cloud_doc_url,className:"text-token-primary flex-grow-1 flex-shrink-1 overflow-hidden text-ellipsis whitespace-nowrap text-sm",target:"_blank",rel:"noreferrer",children:l}),a&&o.jsx("div",{className:"ml-2 text-sm text-token-text-secondary",children:a})]}),o.jsxs("div",{className:"flex shrink-0 flex-row items-center",children:[o.jsx("button",{className:"rounded-md p-1 hover:bg-token-main-surface-secondary",children:r?.rating==="thumbsUp"?o.jsx(ds,{className:"icon-md-heavy text-token-text-primary",onClick:()=>p(void 0)}):o.jsx(Qi,{className:"icon-md-heavy text-token-text-secondary",onClick:()=>p("thumbsUp")})}),o.jsx("button",{className:"rounded-md p-1 hover:bg-token-main-surface-secondary",children:r?.rating==="thumbsDown"?o.jsx(fs,{className:"icon-md-heavy text-token-text-primary",onClick:()=>p(void 0)}):o.jsx(Ji,{className:"icon-md-heavy text-token-text-secondary",onClick:()=>p("thumbsDown")})})]})]}),r?.rating&&o.jsx("div",{className:"mb-4 flex flex-row",children:(r.rating==="thumbsDown"?Vc:zc).map(y=>o.jsx(ra,{className:"mr-2",$selected:r.tags.includes(y),onClick:()=>c({...r,tags:r.tags.includes(y)?r.tags.filter(_=>_!==y):[...r.tags,y]}),children:y},y))}),!t&&o.jsx("div",{className:"w-full border-[0.5px] border-token-border-light"})]})}function Qc({documentId:s,title:t,externalUrl:r,noBottomBorder:c=!1,shouldHaveBeenIncluded:l,setShouldHaveBeenIncluded:d}){const[f,a]=w.useMemo(()=>{const _=t.split(".");return _.length>1?[_.slice(0,-1).join("."),_[_.length-1]]:[t,""]},[t]),p=w.useMemo(()=>ts(Tn.GDRIVE,a),[a]),y=w.useMemo(()=>{if(r)try{return new URL(r).hostname}catch{return}},[r]);return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex flex-row items-center justify-between py-2",children:[o.jsxs("div",{className:"max-width-full mr-2 flex grow flex-row items-center overflow-hidden",children:[o.jsx(p,{className:"mr-2 flex-shrink-0 flex-grow-0"}),o.jsx("a",{href:r,className:"text-token-primary flex-grow-1 flex-shrink-1 overflow-hidden text-ellipsis whitespace-nowrap text-sm",target:"_blank",rel:"noreferrer",children:f}),y&&o.jsx("div",{className:"ml-2 text-sm text-token-text-secondary",children:y})]}),o.jsx("div",{className:"flex shrink-0 flex-row items-center px-2",children:o.jsx(ns,{checked:l,onChange:_=>d?.(_.currentTarget.checked),id:`should-have-been-included-${s}`})})]}),!c&&o.jsx("div",{className:"w-full border-[0.5px] border-token-border-light"})]})}const Jc=["Not relevant","Missing sources","Inaccurate information","I don't like it","Don't like the style","Content is wrong","Model being lazy","Used the wrong tool","Should't have used Browser","Used an incorrect fact about me","Didn't follow instructions","Other"],Xc=["Good sources","Answered my question","I like it","Other"],Yc="considered-source-should-have-been-used";function Zc({citations:s,rating:t,onSubmit:r,onCancel:c,messageId:l,conversationId:d,nodeId:f,conversationTree:a}){const p=xe(),y=Cn(),[_,k]=w.useState(""),[m,x]=w.useState(()=>{const b={};for(const M of s)M.metadata?.type==="file"&&(b[M.metadata.id]={rating:void 0,tags:[],url:M.metadata.extra?.cloud_doc_url});return b}),S=w.useMemo(()=>{const b=new Set,M=[];for(const R of s)!R.metadata||R.metadata.type!=="file"||b.has(R.metadata.id)||(M.push(R.metadata),b.add(R.metadata.id));return M},[s]),[E,I]=w.useState(!0),A=w.useMemo(()=>{const b={hasQuery:!1,lastAssistantMessage:null,lastUserMessage:null,referencedSyncedFiles:[]};if(!a||!f||!a.containsNodeOrMessageId(f))return b;const M=qo(a,{messageId:f,entireConversation:!0});for(const R of M.messages)switch(R.type){case"fetch":case"generic_file_search_tool":case"system":continue;case"result":{R.result.chunks.forEach(B=>{B.documentId&&B.documentId.startsWith("S")&&!b.referencedSyncedFiles.some(D=>D.fileId===B.documentId)&&!S.some(D=>D.type==="file"&&D.id===B.documentId)&&b.referencedSyncedFiles.push({fileId:B.documentId,title:B.title})});continue}case"query":{b.hasQuery=!0;continue}case"visible_text":{if(R.author===rt.User){if(!b.lastUserMessage){const B=a.getConversationTurns(R.id),D=B[B.length-1].messages,F=D[D.length-1];b.lastUserMessage=F}}else if(R.author===rt.Assistant&&!b.lastAssistantMessage){const B=a.getConversationTurns(R.id),D=B[B.length-1].messages,F=D[D.length-1];b.lastAssistantMessage=F,b.lastUserMessage=null}continue}}return b},[a,S,f]),N=w.useCallback(async b=>{const M={...b,additionalSources:_,sourcesFeedback:m,consentedToShareConvoLink:E};He.submitCaMessageFeedback({feedback_format:Bt.ALPHA,message_id:l,conversation_id:d,text:M.textFeedback,rating:t,tags:M.tags,tag_choices:M.tagChoices,additional_sources:M.additionalSources,sources_feedback:M.sourcesFeedback,consented_to_share_convo_link:M.consentedToShareConvoLink}),y.success("Thanks for providing feedback!"),r?.(M)},[_,m,E,l,d,t,y,r]);return o.jsxs(oa,{multiple:!0,allowEmptySubmit:!0,onSubmit:N,onCancel:c,tagOptions:(t==="thumbsDown"?Jc:Xc).map(b=>({label:b,value:b})),modalOnly:!0,modalTitle:o.jsxs("div",{className:"flex items-center gap-2",children:[t==="thumbsDown"?o.jsx(fs,{className:"mb-[-6px]"}):o.jsx(ds,{className:"mb-[-6px]"}),o.jsx(H,{id:"h5nasL",defaultMessage:"Provide feedback"})]}),children:[S.length>0&&o.jsxs(o.Fragment,{children:[o.jsx("h3",{className:"mt-6 text-base font-semibold",children:o.jsx(H,{id:"G6+7UX",defaultMessage:"Sources"})}),o.jsx("div",{children:S.map((b,M)=>b?.type!=="file"?null:o.jsx(Kc,{citationMetadata:b,noBottomBorder:M===S.length-1,sourceFeedback:m[b.id],setSourceFeedback:R=>x(B=>({...B,[b.id]:{...R,url:b.extra?.cloud_doc_url}}))},b.id))})]}),A.referencedSyncedFiles.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mt-6 flex items-baseline justify-between",children:[o.jsxs("div",{className:"flex-start flex",children:[o.jsx("h3",{className:"text-base font-semibold",children:o.jsx(H,{id:"xvBe/T",defaultMessage:"Considered Sources"})}),o.jsx("p",{className:"ml-2 text-token-text-secondary",children:o.jsx(H,{id:"nX81fN",defaultMessage:"({numSources} sources)",values:{numSources:A.referencedSyncedFiles.length}})})]}),o.jsx("p",{className:"text-sm text-token-text-tertiary",children:o.jsx(H,{id:"0+Uivl",defaultMessage:"Good Source?"})})]}),o.jsx("div",{className:"mt-2 max-h-[200px] overflow-auto",children:A.referencedSyncedFiles.map((b,M)=>{const R=b.fileId.split("--")[1];if(!R)return null;const B=`https://drive.google.com/file/d/${R}`;return o.jsx(Qc,{title:b.title,documentId:b.fileId,externalUrl:B,noBottomBorder:M===A.referencedSyncedFiles.length-1,shouldHaveBeenIncluded:!!m[b.fileId],setShouldHaveBeenIncluded:D=>x(F=>{const P={...Object.fromEntries(Object.entries(F).filter(([$])=>$!==b.fileId))};return D&&(P[b.fileId]={tags:[Yc],rating:"thumbsUp",url:B}),P})},b.fileId)})})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("p",{className:"text-sm text-token-text-primary",children:o.jsx(H,{id:"1ApJVo",defaultMessage:"Add any additional sources"})}),o.jsx(Ho,{name:"feedback",className:"mt-2",placeholder:p.formatMessage({id:"CAFeedbackModal.additionalSourcePlaceholder",defaultMessage:"(Optional) Additional sources"}),value:_,onChange:b=>k(b.target.value)})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx("h3",{className:"mb-2 text-base font-semibold",children:o.jsx(H,{id:"9NcQBu",defaultMessage:"Latest Exchange"})}),o.jsx("div",{className:"p-2",children:o.jsxs("div",{className:"mb-4",children:[A.lastUserMessage&&o.jsxs("div",{className:"mb-4",children:[o.jsx("p",{className:"mb-1 pl-4 text-xs text-token-text-secondary",children:o.jsx(H,{id:"QTWrtR",defaultMessage:"Your message"})}),o.jsx("div",{className:"flex justify-start",children:o.jsx("p",{className:"relative max-w-[70%] rounded-3xl bg-[#f4f4f4] px-5 py-2.5 dark:bg-token-main-surface-secondary",children:A.lastUserMessage?o.jsx(fn,{message:A.lastUserMessage,isCompletionInProgress:!1,clientThreadId:d,isUserTurn:!1,turnIndex:0,isFeedbackEnabled:!1,showEditButton:!1,onEnterEdit:()=>null,onRequestMoreCompletions:()=>null}):null})})]}),o.jsxs("div",{className:"mb-2",children:[o.jsx("p",{className:"mb-1 pl-4 text-xs text-token-text-secondary",children:o.jsx(H,{id:"ZCTm4h",defaultMessage:"ChatGPT's response"})}),o.jsx("div",{className:"relative rounded-lg bg-token-main-surface-secondary p-4 text-sm",children:A.lastAssistantMessage?o.jsx(fn,{message:A.lastAssistantMessage,isCompletionInProgress:!1,clientThreadId:d,isUserTurn:!1,turnIndex:1,isFeedbackEnabled:!1,showEditButton:!1,onEnterEdit:()=>null,onRequestMoreCompletions:()=>null}):null})]})]})}),o.jsxs("div",{className:"mt-4",children:[o.jsx("h3",{className:"mt-6 text-base font-semibold",children:o.jsx(H,{id:"c95uEW",defaultMessage:"Full conversation"})}),o.jsx("p",{className:"mb-2 mt-1 text-sm text-token-text-secondary",children:o.jsx(H,{id:"3E3ZSm",defaultMessage:"If previous portions of this conversation are important to understand your feedback, we encourage you to include it."})}),o.jsx(ns,{id:"consented-to-share-entire-convo",label:p.formatMessage({id:"5CC8r8",defaultMessage:"Share Entire Conversation"}),checked:E,onChange:b=>{I(b.currentTarget.checked)}})]})]})]})}const el=Ve(()=>ze(()=>import("./sso-bx19kqnmjvbfrjzw.js").then(s=>s.C),__vite__mapDeps([38,1,2,3,5,6,21,8,39,20,27,40,41,42,43,44,45,46,18,47,28,26,22,48,49,50,51,52,53,36,37,15,54,55,56,57,58,59,60,61,62,63,64])).then(s=>s.CADogfoodingFeedbackModal).catch(()=>()=>null));function tl(s){const t=Go();if(!t)return null;switch(t){case Bt.ALPHA:return o.jsx(Zc,{...s});case Bt.DOGFOODING:return o.jsx(el,{...s})}}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(s){const t=Vo,r=zo,c=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;s.Buffer=a,s.SlowBuffer=N,s.INSPECT_MAX_BYTES=50;const l=2147483647;s.kMaxLength=l,a.TYPED_ARRAY_SUPPORT=d(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function d(){try{const i=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(i,e),i.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function f(i){if(i>l)throw new RangeError('The value "'+i+'" is invalid for option "size"');const e=new Uint8Array(i);return Object.setPrototypeOf(e,a.prototype),e}function a(i,e,n){if(typeof i=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return k(i)}return p(i,e,n)}a.poolSize=8192;function p(i,e,n){if(typeof i=="string")return m(i,e);if(ArrayBuffer.isView(i))return S(i);if(i==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i);if(Ee(i,ArrayBuffer)||i&&Ee(i.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ee(i,SharedArrayBuffer)||i&&Ee(i.buffer,SharedArrayBuffer)))return E(i,e,n);if(typeof i=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const u=i.valueOf&&i.valueOf();if(u!=null&&u!==i)return a.from(u,e,n);const h=I(i);if(h)return h;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof i[Symbol.toPrimitive]=="function")return a.from(i[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof i)}a.from=function(i,e,n){return p(i,e,n)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function y(i){if(typeof i!="number")throw new TypeError('"size" argument must be of type number');if(i<0)throw new RangeError('The value "'+i+'" is invalid for option "size"')}function _(i,e,n){return y(i),i<=0?f(i):e!==void 0?typeof n=="string"?f(i).fill(e,n):f(i).fill(e):f(i)}a.alloc=function(i,e,n){return _(i,e,n)};function k(i){return y(i),f(i<0?0:A(i)|0)}a.allocUnsafe=function(i){return k(i)},a.allocUnsafeSlow=function(i){return k(i)};function m(i,e){if((typeof e!="string"||e==="")&&(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=b(i,e)|0;let u=f(n);const h=u.write(i,e);return h!==n&&(u=u.slice(0,h)),u}function x(i){const e=i.length<0?0:A(i.length)|0,n=f(e);for(let u=0;u<e;u+=1)n[u]=i[u]&255;return n}function S(i){if(Ee(i,Uint8Array)){const e=new Uint8Array(i);return E(e.buffer,e.byteOffset,e.byteLength)}return x(i)}function E(i,e,n){if(e<0||i.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(i.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let u;return e===void 0&&n===void 0?u=new Uint8Array(i):n===void 0?u=new Uint8Array(i,e):u=new Uint8Array(i,e,n),Object.setPrototypeOf(u,a.prototype),u}function I(i){if(a.isBuffer(i)){const e=A(i.length)|0,n=f(e);return n.length===0||i.copy(n,0,0,e),n}if(i.length!==void 0)return typeof i.length!="number"||pt(i.length)?f(0):x(i);if(i.type==="Buffer"&&Array.isArray(i.data))return x(i.data)}function A(i){if(i>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return i|0}function N(i){return+i!=i&&(i=0),a.alloc(+i)}a.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==a.prototype},a.compare=function(e,n){if(Ee(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),Ee(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),!a.isBuffer(e)||!a.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===n)return 0;let u=e.length,h=n.length;for(let g=0,v=Math.min(u,h);g<v;++g)if(e[g]!==n[g]){u=e[g],h=n[g];break}return u<h?-1:h<u?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,n){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return a.alloc(0);let u;if(n===void 0)for(n=0,u=0;u<e.length;++u)n+=e[u].length;const h=a.allocUnsafe(n);let g=0;for(u=0;u<e.length;++u){let v=e[u];if(Ee(v,Uint8Array))g+v.length>h.length?(a.isBuffer(v)||(v=a.from(v)),v.copy(h,g)):Uint8Array.prototype.set.call(h,v,g);else if(a.isBuffer(v))v.copy(h,g);else throw new TypeError('"list" argument must be an Array of Buffers');g+=v.length}return h};function b(i,e){if(a.isBuffer(i))return i.length;if(ArrayBuffer.isView(i)||Ee(i,ArrayBuffer))return i.byteLength;if(typeof i!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof i);const n=i.length,u=arguments.length>2&&arguments[2]===!0;if(!u&&n===0)return 0;let h=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Se(i).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return Kt(i).length;default:if(h)return u?-1:Se(i).length;e=(""+e).toLowerCase(),h=!0}}a.byteLength=b;function M(i,e,n){let u=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0,e>>>=0,n<=e))return"";for(i||(i="utf8");;)switch(i){case"hex":return G(this,e,n);case"utf8":case"utf-8":return q(this,e,n);case"ascii":return j(this,e,n);case"latin1":case"binary":return z(this,e,n);case"base64":return O(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,e,n);default:if(u)throw new TypeError("Unknown encoding: "+i);i=(i+"").toLowerCase(),u=!0}}a.prototype._isBuffer=!0;function R(i,e,n){const u=i[e];i[e]=i[n],i[n]=u}a.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<e;n+=2)R(this,n,n+1);return this},a.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<e;n+=4)R(this,n,n+3),R(this,n+1,n+2);return this},a.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<e;n+=8)R(this,n,n+7),R(this,n+1,n+6),R(this,n+2,n+5),R(this,n+3,n+4);return this},a.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?q(this,0,e):M.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:a.compare(this,e)===0},a.prototype.inspect=function(){let e="";const n=s.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},c&&(a.prototype[c]=a.prototype.inspect),a.prototype.compare=function(e,n,u,h,g){if(Ee(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(n===void 0&&(n=0),u===void 0&&(u=e?e.length:0),h===void 0&&(h=0),g===void 0&&(g=this.length),n<0||u>e.length||h<0||g>this.length)throw new RangeError("out of range index");if(h>=g&&n>=u)return 0;if(h>=g)return-1;if(n>=u)return 1;if(n>>>=0,u>>>=0,h>>>=0,g>>>=0,this===e)return 0;let v=g-h,U=u-n;const ne=Math.min(v,U),ee=this.slice(h,g),se=e.slice(n,u);for(let J=0;J<ne;++J)if(ee[J]!==se[J]){v=ee[J],U=se[J];break}return v<U?-1:U<v?1:0};function B(i,e,n,u,h){if(i.length===0)return-1;if(typeof n=="string"?(u=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,pt(n)&&(n=h?0:i.length-1),n<0&&(n=i.length+n),n>=i.length){if(h)return-1;n=i.length-1}else if(n<0)if(h)n=0;else return-1;if(typeof e=="string"&&(e=a.from(e,u)),a.isBuffer(e))return e.length===0?-1:D(i,e,n,u,h);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?h?Uint8Array.prototype.indexOf.call(i,e,n):Uint8Array.prototype.lastIndexOf.call(i,e,n):D(i,[e],n,u,h);throw new TypeError("val must be string, number or Buffer")}function D(i,e,n,u,h){let g=1,v=i.length,U=e.length;if(u!==void 0&&(u=String(u).toLowerCase(),u==="ucs2"||u==="ucs-2"||u==="utf16le"||u==="utf-16le")){if(i.length<2||e.length<2)return-1;g=2,v/=2,U/=2,n/=2}function ne(se,J){return g===1?se[J]:se.readUInt16BE(J*g)}let ee;if(h){let se=-1;for(ee=n;ee<v;ee++)if(ne(i,ee)===ne(e,se===-1?0:ee-se)){if(se===-1&&(se=ee),ee-se+1===U)return se*g}else se!==-1&&(ee-=ee-se),se=-1}else for(n+U>v&&(n=v-U),ee=n;ee>=0;ee--){let se=!0;for(let J=0;J<U;J++)if(ne(i,ee+J)!==ne(e,J)){se=!1;break}if(se)return ee}return-1}a.prototype.includes=function(e,n,u){return this.indexOf(e,n,u)!==-1},a.prototype.indexOf=function(e,n,u){return B(this,e,n,u,!0)},a.prototype.lastIndexOf=function(e,n,u){return B(this,e,n,u,!1)};function F(i,e,n,u){n=Number(n)||0;const h=i.length-n;u?(u=Number(u),u>h&&(u=h)):u=h;const g=e.length;u>g/2&&(u=g/2);let v;for(v=0;v<u;++v){const U=parseInt(e.substr(v*2,2),16);if(pt(U))return v;i[n+v]=U}return v}function P(i,e,n,u){return Xe(Se(e,i.length-n),i,n,u)}function $(i,e,n,u){return Xe(ks(e),i,n,u)}function W(i,e,n,u){return Xe(Kt(e),i,n,u)}function Y(i,e,n,u){return Xe(Cs(e,i.length-n),i,n,u)}a.prototype.write=function(e,n,u,h){if(n===void 0)h="utf8",u=this.length,n=0;else if(u===void 0&&typeof n=="string")h=n,u=this.length,n=0;else if(isFinite(n))n=n>>>0,isFinite(u)?(u=u>>>0,h===void 0&&(h="utf8")):(h=u,u=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const g=this.length-n;if((u===void 0||u>g)&&(u=g),e.length>0&&(u<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");h||(h="utf8");let v=!1;for(;;)switch(h){case"hex":return F(this,e,n,u);case"utf8":case"utf-8":return P(this,e,n,u);case"ascii":case"latin1":case"binary":return $(this,e,n,u);case"base64":return W(this,e,n,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,e,n,u);default:if(v)throw new TypeError("Unknown encoding: "+h);h=(""+h).toLowerCase(),v=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function O(i,e,n){return e===0&&n===i.length?t.fromByteArray(i):t.fromByteArray(i.slice(e,n))}function q(i,e,n){n=Math.min(i.length,n);const u=[];let h=e;for(;h<n;){const g=i[h];let v=null,U=g>239?4:g>223?3:g>191?2:1;if(h+U<=n){let ne,ee,se,J;switch(U){case 1:g<128&&(v=g);break;case 2:ne=i[h+1],(ne&192)===128&&(J=(g&31)<<6|ne&63,J>127&&(v=J));break;case 3:ne=i[h+1],ee=i[h+2],(ne&192)===128&&(ee&192)===128&&(J=(g&15)<<12|(ne&63)<<6|ee&63,J>2047&&(J<55296||J>57343)&&(v=J));break;case 4:ne=i[h+1],ee=i[h+2],se=i[h+3],(ne&192)===128&&(ee&192)===128&&(se&192)===128&&(J=(g&15)<<18|(ne&63)<<12|(ee&63)<<6|se&63,J>65535&&J<1114112&&(v=J))}}v===null?(v=65533,U=1):v>65535&&(v-=65536,u.push(v>>>10&1023|55296),v=56320|v&1023),u.push(v),h+=U}return V(u)}const Q=4096;function V(i){const e=i.length;if(e<=Q)return String.fromCharCode.apply(String,i);let n="",u=0;for(;u<e;)n+=String.fromCharCode.apply(String,i.slice(u,u+=Q));return n}function j(i,e,n){let u="";n=Math.min(i.length,n);for(let h=e;h<n;++h)u+=String.fromCharCode(i[h]&127);return u}function z(i,e,n){let u="";n=Math.min(i.length,n);for(let h=e;h<n;++h)u+=String.fromCharCode(i[h]);return u}function G(i,e,n){const u=i.length;(!e||e<0)&&(e=0),(!n||n<0||n>u)&&(n=u);let h="";for(let g=e;g<n;++g)h+=Is[i[g]];return h}function oe(i,e,n){const u=i.slice(e,n);let h="";for(let g=0;g<u.length-1;g+=2)h+=String.fromCharCode(u[g]+u[g+1]*256);return h}a.prototype.slice=function(e,n){const u=this.length;e=~~e,n=n===void 0?u:~~n,e<0?(e+=u,e<0&&(e=0)):e>u&&(e=u),n<0?(n+=u,n<0&&(n=0)):n>u&&(n=u),n<e&&(n=e);const h=this.subarray(e,n);return Object.setPrototypeOf(h,a.prototype),h};function T(i,e,n){if(i%1!==0||i<0)throw new RangeError("offset is not uint");if(i+e>n)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(e,n,u){e=e>>>0,n=n>>>0,u||T(e,n,this.length);let h=this[e],g=1,v=0;for(;++v<n&&(g*=256);)h+=this[e+v]*g;return h},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,n,u){e=e>>>0,n=n>>>0,u||T(e,n,this.length);let h=this[e+--n],g=1;for(;n>0&&(g*=256);)h+=this[e+--n]*g;return h},a.prototype.readUint8=a.prototype.readUInt8=function(e,n){return e=e>>>0,n||T(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,n){return e=e>>>0,n||T(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,n){return e=e>>>0,n||T(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,n){return e=e>>>0,n||T(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,n){return e=e>>>0,n||T(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=Re(function(e){e=e>>>0,ve(e,"offset");const n=this[e],u=this[e+7];(n===void 0||u===void 0)&&ye(e,this.length-8);const h=n+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,g=this[++e]+this[++e]*2**8+this[++e]*2**16+u*2**24;return BigInt(h)+(BigInt(g)<<BigInt(32))}),a.prototype.readBigUInt64BE=Re(function(e){e=e>>>0,ve(e,"offset");const n=this[e],u=this[e+7];(n===void 0||u===void 0)&&ye(e,this.length-8);const h=n*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],g=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+u;return(BigInt(h)<<BigInt(32))+BigInt(g)}),a.prototype.readIntLE=function(e,n,u){e=e>>>0,n=n>>>0,u||T(e,n,this.length);let h=this[e],g=1,v=0;for(;++v<n&&(g*=256);)h+=this[e+v]*g;return g*=128,h>=g&&(h-=Math.pow(2,8*n)),h},a.prototype.readIntBE=function(e,n,u){e=e>>>0,n=n>>>0,u||T(e,n,this.length);let h=n,g=1,v=this[e+--h];for(;h>0&&(g*=256);)v+=this[e+--h]*g;return g*=128,v>=g&&(v-=Math.pow(2,8*n)),v},a.prototype.readInt8=function(e,n){return e=e>>>0,n||T(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},a.prototype.readInt16LE=function(e,n){e=e>>>0,n||T(e,2,this.length);const u=this[e]|this[e+1]<<8;return u&32768?u|4294901760:u},a.prototype.readInt16BE=function(e,n){e=e>>>0,n||T(e,2,this.length);const u=this[e+1]|this[e]<<8;return u&32768?u|4294901760:u},a.prototype.readInt32LE=function(e,n){return e=e>>>0,n||T(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,n){return e=e>>>0,n||T(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=Re(function(e){e=e>>>0,ve(e,"offset");const n=this[e],u=this[e+7];(n===void 0||u===void 0)&&ye(e,this.length-8);const h=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(u<<24);return(BigInt(h)<<BigInt(32))+BigInt(n+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),a.prototype.readBigInt64BE=Re(function(e){e=e>>>0,ve(e,"offset");const n=this[e],u=this[e+7];(n===void 0||u===void 0)&&ye(e,this.length-8);const h=(n<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(h)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+u)}),a.prototype.readFloatLE=function(e,n){return e=e>>>0,n||T(e,4,this.length),r.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,n){return e=e>>>0,n||T(e,4,this.length),r.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,n){return e=e>>>0,n||T(e,8,this.length),r.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,n){return e=e>>>0,n||T(e,8,this.length),r.read(this,e,!1,52,8)};function C(i,e,n,u,h,g){if(!a.isBuffer(i))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>h||e<g)throw new RangeError('"value" argument is out of bounds');if(n+u>i.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,n,u,h){if(e=+e,n=n>>>0,u=u>>>0,!h){const U=Math.pow(2,8*u)-1;C(this,e,n,u,U,0)}let g=1,v=0;for(this[n]=e&255;++v<u&&(g*=256);)this[n+v]=e/g&255;return n+u},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,n,u,h){if(e=+e,n=n>>>0,u=u>>>0,!h){const U=Math.pow(2,8*u)-1;C(this,e,n,u,U,0)}let g=u-1,v=1;for(this[n+g]=e&255;--g>=0&&(v*=256);)this[n+g]=e/v&255;return n+u},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,1,255,0),this[n]=e&255,n+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,2,65535,0),this[n]=e&255,this[n+1]=e>>>8,n+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,2,65535,0),this[n]=e>>>8,this[n+1]=e&255,n+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,4,4294967295,0),this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=e&255,n+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,4,4294967295,0),this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e&255,n+4};function ie(i,e,n,u,h){Me(e,u,h,i,n,7);let g=Number(e&BigInt(4294967295));i[n++]=g,g=g>>8,i[n++]=g,g=g>>8,i[n++]=g,g=g>>8,i[n++]=g;let v=Number(e>>BigInt(32)&BigInt(4294967295));return i[n++]=v,v=v>>8,i[n++]=v,v=v>>8,i[n++]=v,v=v>>8,i[n++]=v,n}function me(i,e,n,u,h){Me(e,u,h,i,n,7);let g=Number(e&BigInt(4294967295));i[n+7]=g,g=g>>8,i[n+6]=g,g=g>>8,i[n+5]=g,g=g>>8,i[n+4]=g;let v=Number(e>>BigInt(32)&BigInt(4294967295));return i[n+3]=v,v=v>>8,i[n+2]=v,v=v>>8,i[n+1]=v,v=v>>8,i[n]=v,n+8}a.prototype.writeBigUInt64LE=Re(function(e,n=0){return ie(this,e,n,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Re(function(e,n=0){return me(this,e,n,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(e,n,u,h){if(e=+e,n=n>>>0,!h){const ne=Math.pow(2,8*u-1);C(this,e,n,u,ne-1,-ne)}let g=0,v=1,U=0;for(this[n]=e&255;++g<u&&(v*=256);)e<0&&U===0&&this[n+g-1]!==0&&(U=1),this[n+g]=(e/v>>0)-U&255;return n+u},a.prototype.writeIntBE=function(e,n,u,h){if(e=+e,n=n>>>0,!h){const ne=Math.pow(2,8*u-1);C(this,e,n,u,ne-1,-ne)}let g=u-1,v=1,U=0;for(this[n+g]=e&255;--g>=0&&(v*=256);)e<0&&U===0&&this[n+g+1]!==0&&(U=1),this[n+g]=(e/v>>0)-U&255;return n+u},a.prototype.writeInt8=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,1,127,-128),e<0&&(e=255+e+1),this[n]=e&255,n+1},a.prototype.writeInt16LE=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,2,32767,-32768),this[n]=e&255,this[n+1]=e>>>8,n+2},a.prototype.writeInt16BE=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,2,32767,-32768),this[n]=e>>>8,this[n+1]=e&255,n+2},a.prototype.writeInt32LE=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,4,2147483647,-2147483648),this[n]=e&255,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24,n+4},a.prototype.writeInt32BE=function(e,n,u){return e=+e,n=n>>>0,u||C(this,e,n,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e&255,n+4},a.prototype.writeBigInt64LE=Re(function(e,n=0){return ie(this,e,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Re(function(e,n=0){return me(this,e,n,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function be(i,e,n,u,h,g){if(n+u>i.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(i,e,n,u,h){return e=+e,n=n>>>0,h||be(i,e,n,4),r.write(i,e,n,u,23,4),n+4}a.prototype.writeFloatLE=function(e,n,u){return L(this,e,n,!0,u)},a.prototype.writeFloatBE=function(e,n,u){return L(this,e,n,!1,u)};function X(i,e,n,u,h){return e=+e,n=n>>>0,h||be(i,e,n,8),r.write(i,e,n,u,52,8),n+8}a.prototype.writeDoubleLE=function(e,n,u){return X(this,e,n,!0,u)},a.prototype.writeDoubleBE=function(e,n,u){return X(this,e,n,!1,u)},a.prototype.copy=function(e,n,u,h){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(u||(u=0),!h&&h!==0&&(h=this.length),n>=e.length&&(n=e.length),n||(n=0),h>0&&h<u&&(h=u),h===u||e.length===0||this.length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(u<0||u>=this.length)throw new RangeError("Index out of range");if(h<0)throw new RangeError("sourceEnd out of bounds");h>this.length&&(h=this.length),e.length-n<h-u&&(h=e.length-n+u);const g=h-u;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(n,u,h):Uint8Array.prototype.set.call(e,this.subarray(u,h),n),g},a.prototype.fill=function(e,n,u,h){if(typeof e=="string"){if(typeof n=="string"?(h=n,n=0,u=this.length):typeof u=="string"&&(h=u,u=this.length),h!==void 0&&typeof h!="string")throw new TypeError("encoding must be a string");if(typeof h=="string"&&!a.isEncoding(h))throw new TypeError("Unknown encoding: "+h);if(e.length===1){const v=e.charCodeAt(0);(h==="utf8"&&v<128||h==="latin1")&&(e=v)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(n<0||this.length<n||this.length<u)throw new RangeError("Out of range index");if(u<=n)return this;n=n>>>0,u=u===void 0?this.length:u>>>0,e||(e=0);let g;if(typeof e=="number")for(g=n;g<u;++g)this[g]=e;else{const v=a.isBuffer(e)?e:a.from(e,h),U=v.length;if(U===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(g=0;g<u-n;++g)this[g+n]=v[g%U]}return this};const K={};function Z(i,e,n){K[i]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${i}]`,this.stack,delete this.name}get code(){return i}set code(h){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:h,writable:!0})}toString(){return`${this.name} [${i}]: ${this.message}`}}}Z("ERR_BUFFER_OUT_OF_BOUNDS",function(i){return i?`${i} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Z("ERR_INVALID_ARG_TYPE",function(i,e){return`The "${i}" argument must be of type number. Received type ${typeof e}`},TypeError),Z("ERR_OUT_OF_RANGE",function(i,e,n){let u=`The value of "${i}" is out of range.`,h=n;return Number.isInteger(n)&&Math.abs(n)>2**32?h=we(String(n)):typeof n=="bigint"&&(h=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(h=we(h)),h+="n"),u+=` It must be ${e}. Received ${h}`,u},RangeError);function we(i){let e="",n=i.length;const u=i[0]==="-"?1:0;for(;n>=u+4;n-=3)e=`_${i.slice(n-3,n)}${e}`;return`${i.slice(0,n)}${e}`}function ce(i,e,n){ve(e,"offset"),(i[e]===void 0||i[e+n]===void 0)&&ye(e,i.length-(n+1))}function Me(i,e,n,u,h,g){if(i>n||i<e){const v=typeof e=="bigint"?"n":"";let U;throw e===0||e===BigInt(0)?U=`>= 0${v} and < 2${v} ** ${(g+1)*8}${v}`:U=`>= -(2${v} ** ${(g+1)*8-1}${v}) and < 2 ** ${(g+1)*8-1}${v}`,new K.ERR_OUT_OF_RANGE("value",U,i)}ce(u,h,g)}function ve(i,e){if(typeof i!="number")throw new K.ERR_INVALID_ARG_TYPE(e,"number",i)}function ye(i,e,n){throw Math.floor(i)!==i?(ve(i,n),new K.ERR_OUT_OF_RANGE("offset","an integer",i)):e<0?new K.ERR_BUFFER_OUT_OF_BOUNDS:new K.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,i)}const Je=/[^+/0-9A-Za-z-_]/g;function qe(i){if(i=i.split("=")[0],i=i.trim().replace(Je,""),i.length<2)return"";for(;i.length%4!==0;)i=i+"=";return i}function Se(i,e){e=e||1/0;let n;const u=i.length;let h=null;const g=[];for(let v=0;v<u;++v){if(n=i.charCodeAt(v),n>55295&&n<57344){if(!h){if(n>56319){(e-=3)>-1&&g.push(239,191,189);continue}else if(v+1===u){(e-=3)>-1&&g.push(239,191,189);continue}h=n;continue}if(n<56320){(e-=3)>-1&&g.push(239,191,189),h=n;continue}n=(h-55296<<10|n-56320)+65536}else h&&(e-=3)>-1&&g.push(239,191,189);if(h=null,n<128){if((e-=1)<0)break;g.push(n)}else if(n<2048){if((e-=2)<0)break;g.push(n>>6|192,n&63|128)}else if(n<65536){if((e-=3)<0)break;g.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((e-=4)<0)break;g.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return g}function ks(i){const e=[];for(let n=0;n<i.length;++n)e.push(i.charCodeAt(n)&255);return e}function Cs(i,e){let n,u,h;const g=[];for(let v=0;v<i.length&&!((e-=2)<0);++v)n=i.charCodeAt(v),u=n>>8,h=n%256,g.push(h),g.push(u);return g}function Kt(i){return t.toByteArray(qe(i))}function Xe(i,e,n,u){let h;for(h=0;h<u&&!(h+n>=e.length||h>=i.length);++h)e[h+n]=i[h];return h}function Ee(i,e){return i instanceof e||i!=null&&i.constructor!=null&&i.constructor.name!=null&&i.constructor.name===e.name}function pt(i){return i!==i}const Is=function(){const i="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const u=n*16;for(let h=0;h<16;++h)e[u+h]=i[n]+i[h]}return e}();function Re(i){return typeof BigInt>"u"?Ms:i}function Ms(){throw new Error("BigInt not supported")}})(Ht);function nl(s){if(typeof s!="string")throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!s)throw new Error("No input");const t=JSON.parse(s),r=t;let c;if(r.type==="system")if(r.event==="connected")c=Object.assign(Object.assign({},t),{kind:"connected"});else if(r.event==="disconnected")c=Object.assign(Object.assign({},t),{kind:"disconnected"});else return null;else if(r.type==="message")if(r.from==="group"){const l=_n(t.data,t.dataType);if(l===null)return null;c=Object.assign(Object.assign({},t),{data:l,kind:"groupData"})}else if(r.from==="server"){const l=_n(t.data,t.dataType);if(l===null)return null;c=Object.assign(Object.assign({},t),{data:l,kind:"serverData"})}else return null;else if(r.type==="ack")c=Object.assign(Object.assign({},t),{kind:"ack"});else return null;return c}function sl(s){let t;switch(s.kind){case"joinGroup":{t={type:"joinGroup",group:s.group,ackId:s.ackId};break}case"leaveGroup":{t={type:"leaveGroup",group:s.group,ackId:s.ackId};break}case"sendEvent":{t={type:"event",event:s.event,ackId:s.ackId,dataType:s.dataType,data:vn(s.data,s.dataType)};break}case"sendToGroup":{t={type:"sendToGroup",group:s.group,ackId:s.ackId,dataType:s.dataType,data:vn(s.data,s.dataType),noEcho:s.noEcho};break}case"sequenceAck":{t={type:"sequenceAck",sequenceId:s.sequenceId};break}default:throw new Error(`Unsupported type: ${s.kind}`)}return JSON.stringify(t)}function vn(s,t){switch(t){case"text":{if(typeof s!="string")throw new TypeError("Message must be a string.");return s}case"json":return s;case"binary":case"protobuf":{if(s instanceof ArrayBuffer)return Ht.Buffer.from(s).toString("base64");throw new TypeError("Message must be a ArrayBuffer")}}}function _n(s,t){if(t==="text"){if(typeof s!="string")throw new TypeError("Message must be a string when dataType is text");return s}else{if(t==="json")return s;if(t==="binary"||t==="protobuf"){const r=Ht.Buffer.from(s,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}else return null}}class rl{constructor(){this.isReliableSubProtocol=!0,this.name="json.reliable.webpubsub.azure.v1"}parseMessages(t){return nl(t)}writeMessage(t){return sl(t)}}const ol=()=>new rl;var ge;(function(s){s.Stopped="Stopped",s.Disconnected="Disconnected",s.Connecting="Connecting",s.Connected="Connected",s.Recovering="Recovering"})(ge||(ge={}));class il{nextAckId(){return this._ackId=this._ackId+1,this._ackId}constructor(t,r){this._quickSequenceAckDiff=300,this._activeTimeoutInMs=2e4,this._emitter=new Ko,this._isStopping=!1,this._isInitialConnected=!1,typeof t=="string"?this._credential={getClientAccessUrl:t}:this._credential=t,r==null&&(r={}),this._buildDefaultOptions(r),this._options=r,this._messageRetryPolicy=new bn(this._options.messageRetryOptions),this._reconnectRetryPolicy=new bn(this._options.reconnectRetryOptions),this._protocol=this._options.protocol,this._groupMap=new Map,this._ackMap=new Map,this._sequenceId=new ll,this._state=ge.Stopped,this._ackId=0}async start(t){if(this._isStopping)throw new Error("Can't start a client during stopping");if(this._state!==ge.Stopped)throw new Error("Client can be only started when it's Stopped");let r;t&&(r=t.abortSignal),this._activeKeepaliveTask||(this._activeKeepaliveTask=this._getActiveKeepaliveTask());try{await this._startCore(r)}catch(c){throw this._changeState(ge.Stopped),this._activeKeepaliveTask&&(this._activeKeepaliveTask.abort(),this._activeKeepaliveTask=void 0),this._isStopping=!1,c}}async _startFromRestarting(t){if(this._state!==ge.Disconnected)throw new Error("Client can be only restarted when it's Disconnected");try{de.verbose("Staring reconnecting."),await this._startCore(t)}catch(r){throw this._changeState(ge.Disconnected),r}}async _startCore(t){if(this._changeState(ge.Connecting),de.info("Staring a new connection"),this._sequenceId.reset(),this._isInitialConnected=!1,this._lastCloseEvent=void 0,this._lastDisconnectedMessage=void 0,this._connectionId=void 0,this._reconnectionToken=void 0,this._uri=void 0,typeof this._credential.getClientAccessUrl=="string"?this._uri=this._credential.getClientAccessUrl:this._uri=await this._credential.getClientAccessUrl({abortSignal:t}),typeof this._uri!="string")throw new Error(`The clientAccessUrl must be a string but currently it's ${typeof this._uri}`);await this._connectCore(this._uri)}stop(){this._state===ge.Stopped||this._isStopping||(this._isStopping=!0,this._wsClient&&this._wsClient.isOpen()?this._wsClient.close():this._isStopping=!1,this._activeKeepaliveTask&&(this._activeKeepaliveTask.abort(),this._activeKeepaliveTask=void 0))}on(t,r){this._emitter.on(t,r)}off(t,r){this._emitter.removeListener(t,r)}_emitEvent(t,r){this._emitter.emit(t,r)}async sendEvent(t,r,c,l){return await this._operationExecuteWithRetry(()=>this._sendEventAttempt(t,r,c,l),l?.abortSignal)}async _sendEventAttempt(t,r,c,l){var d;if(!((d=l?.fireAndForget)!==null&&d!==void 0?d:!1))return await this._sendMessageWithAckId(p=>({kind:"sendEvent",dataType:c,data:r,ackId:p,event:t}),l?.ackId,l?.abortSignal);const a={kind:"sendEvent",dataType:c,data:r,event:t};return await this._sendMessage(a,l?.abortSignal),{isDuplicated:!1}}async joinGroup(t,r){return await this._operationExecuteWithRetry(()=>this._joinGroupAttempt(t,r),r?.abortSignal)}async _joinGroupAttempt(t,r){const c=this._getOrAddGroup(t),l=await this._joinGroupCore(t,r);return c.isJoined=!0,l}async _joinGroupCore(t,r){return await this._sendMessageWithAckId(c=>({group:t,ackId:c,kind:"joinGroup"}),r?.ackId,r?.abortSignal)}async leaveGroup(t,r){return await this._operationExecuteWithRetry(()=>this._leaveGroupAttempt(t,r),r?.abortSignal)}async _leaveGroupAttempt(t,r){const c=this._getOrAddGroup(t),l=await this._sendMessageWithAckId(d=>({group:t,ackId:d,kind:"leaveGroup"}),r?.ackId,r?.abortSignal);return c.isJoined=!1,l}async sendToGroup(t,r,c,l){return await this._operationExecuteWithRetry(()=>this._sendToGroupAttempt(t,r,c,l),l?.abortSignal)}async _sendToGroupAttempt(t,r,c,l){var d,f;const a=(d=l?.fireAndForget)!==null&&d!==void 0?d:!1,p=(f=l?.noEcho)!==null&&f!==void 0?f:!1;if(!a)return await this._sendMessageWithAckId(_=>({kind:"sendToGroup",group:t,dataType:c,data:r,ackId:_,noEcho:p}),l?.ackId,l?.abortSignal);const y={kind:"sendToGroup",group:t,dataType:c,data:r,noEcho:p};return await this._sendMessage(y,l?.abortSignal),{isDuplicated:!1}}_getWebSocketClientFactory(){return new Qo}async _trySendSequenceAck(){if(!this._protocol.isReliableSubProtocol)return;const[t,r]=this._sequenceId.tryGetSequenceId();if(t&&r){const c={kind:"sequenceAck",sequenceId:r};try{await this._sendMessage(c)}catch{this._sequenceId.tryUpdate(r)}}}_connectCore(t){if(this._isStopping)throw new Error("Can't start a client during stopping");return new Promise((r,c)=>{const l=this._wsClient=this._getWebSocketClientFactory().create(t,this._protocol.name);l.onopen(()=>{if(this._isStopping){try{l.close()}catch{}c(new Error("The client is stopped"))}de.verbose("WebSocket connection has opened"),this._changeState(ge.Connected),this._protocol.isReliableSubProtocol&&(this._sequenceAckTask!=null&&this._sequenceAckTask.abort(),this._sequenceAckTask=new Sn(async()=>{await this._trySendSequenceAck()},1e3)),r()}),l.onerror(d=>{this._sequenceAckTask!=null&&this._sequenceAckTask.abort(),c(d)}),l.onclose((d,f)=>{this._state===ge.Connected?(de.verbose("WebSocket closed after open"),this._sequenceAckTask!=null&&this._sequenceAckTask.abort(),de.info(`WebSocket connection closed. Code: ${d}, Reason: ${f}`),this._lastCloseEvent={code:d,reason:f},this._handleConnectionClose.call(this)):(de.verbose("WebSocket closed before open"),c(new Error(`Failed to start WebSocket: ${d}`)))}),l.onmessage(d=>{const f=m=>{if(this._ackMap.has(m.ackId)){const x=this._ackMap.get(m.ackId);this._ackMap.delete(m.ackId);const S=m.error!=null&&m.error.name==="Duplicate";m.success||S?x.resolve({ackId:m.ackId,isDuplicated:S}):x.reject(new Ze("Failed to send message.",{ackId:m.ackId,errorDetail:m.error}))}},a=async m=>{if(this._connectionId=m.connectionId,this._reconnectionToken=m.reconnectionToken,!this._isInitialConnected){if(this._isInitialConnected=!0,this._options.autoRejoinGroups){const x=[];this._groupMap.forEach(S=>{S.isJoined&&x.push((async()=>{try{await this._joinGroupCore(S.name)}catch(E){this._safeEmitRejoinGroupFailed(S.name,E)}})())});try{await Promise.all(x)}catch{}}this._safeEmitConnected(m.connectionId,m.userId)}},p=m=>{this._lastDisconnectedMessage=m},y=m=>{if(m.sequenceId!=null){const x=this._sequenceId.tryUpdate(m.sequenceId);if(x===0)return;x>this._quickSequenceAckDiff&&this._trySendSequenceAck()}this._safeEmitGroupMessage(m)},_=m=>{if(m.sequenceId!=null){const x=this._sequenceId.tryUpdate(m.sequenceId);if(x===0)return;x>this._quickSequenceAckDiff&&this._trySendSequenceAck()}this._safeEmitServerMessage(m)};let k;try{let m;if(Array.isArray(d)?m=Buffer.concat(d):m=d,k=this._protocol.parseMessages(m),k===null)return}catch(m){throw de.warning("An error occurred while parsing the message from service",m),m}Array.isArray(k)||(k=[k]),k.forEach(m=>{try{switch(m.kind){case"ack":{f(m);break}case"connected":{a(m);break}case"disconnected":{p(m);break}case"groupData":{y(m);break}case"serverData":{_(m);break}}}catch(x){de.warning(`An error occurred while handling the message with kind: ${m.kind} from service`,x)}})})})}async _handleConnectionCloseAndNoRecovery(){this._state=ge.Disconnected,this._safeEmitDisconnected(this._connectionId,this._lastDisconnectedMessage),this._options.autoReconnect?await this._autoReconnect():await this._handleConnectionStopped()}async _autoReconnect(){let t=!1,r=0;try{for(;!this._isStopping;)try{await this._startFromRestarting(),t=!0;break}catch(c){de.warning("An attempt to reconnect connection failed.",c),r++;const l=this._reconnectRetryPolicy.nextRetryDelayInMs(r);if(l==null)break;try{de.verbose(`Delay time for reconnect attempt ${r}: ${l}`),await nt(l)}catch{}}}finally{t||this._handleConnectionStopped()}}_handleConnectionStopped(){this._isStopping=!1,this._state=ge.Stopped,this._safeEmitStopped()}_getActiveKeepaliveTask(){return new Sn(async()=>{this._sequenceId.tryUpdate(0)},this._activeTimeoutInMs)}async _sendMessage(t,r){if(!this._wsClient||!this._wsClient.isOpen())throw new Error("The connection is not connected.");const c=this._protocol.writeMessage(t);await this._wsClient.send(c,r)}async _sendMessageWithAckId(t,r,c){r==null&&(r=this.nextAckId());const l=t(r);this._ackMap.has(r)||this._ackMap.set(r,new cl(r));const d=this._ackMap.get(r);try{await this._sendMessage(l,c)}catch(f){this._ackMap.delete(r);let a="";throw f instanceof Error&&(a=f.message),new Ze(a,{ackId:r})}if(c)try{return await Jo(d.promise(),c)}catch(f){throw f instanceof Error&&f.name==="AbortError"?new Ze("Cancelled by abortSignal",{ackId:r}):f}return await d.promise()}async _handleConnectionClose(){if(this._ackMap.forEach((l,d)=>{this._ackMap.delete(d)&&l.reject(new Ze("Connection is disconnected before receive ack from the service",{ackId:l.ackId}))}),this._isStopping){de.warning("The client is stopping state. Stop recovery."),this._handleConnectionCloseAndNoRecovery();return}if(this._lastCloseEvent&&this._lastCloseEvent.code===1008){de.warning("The websocket close with status code 1008. Stop recovery."),this._handleConnectionCloseAndNoRecovery();return}if(!this._protocol.isReliableSubProtocol){de.warning("The protocol is not reliable, recovery is not applicable"),this._handleConnectionCloseAndNoRecovery();return}const t=this._buildRecoveryUri();if(!t){de.warning("Connection id or reconnection token is not available"),this._handleConnectionCloseAndNoRecovery();return}let r=!1;this._state=ge.Recovering;const c=ss.timeout(30*1e3);try{for(;!c.aborted||this._isStopping;)try{await this._connectCore.call(this,t),r=!0;return}catch{await nt(1e3)}}finally{r||(de.warning("Recovery attempts failed more then 30 seconds or the client is stopping"),this._handleConnectionCloseAndNoRecovery())}}_safeEmitConnected(t,r){this._emitEvent("connected",{connectionId:t,userId:r})}_safeEmitDisconnected(t,r){this._emitEvent("disconnected",{connectionId:t,message:r})}_safeEmitGroupMessage(t){this._emitEvent("group-message",{message:t})}_safeEmitServerMessage(t){this._emitEvent("server-message",{message:t})}_safeEmitStopped(){this._emitEvent("stopped",{})}_safeEmitRejoinGroupFailed(t,r){this._emitEvent("rejoin-group-failed",{group:t,error:r})}_buildDefaultOptions(t){return t.autoReconnect==null&&(t.autoReconnect=!0),t.autoRejoinGroups==null&&(t.autoRejoinGroups=!0),t.protocol==null&&(t.protocol=ol()),this._buildMessageRetryOptions(t),this._buildReconnectRetryOptions(t),t}_buildMessageRetryOptions(t){t.messageRetryOptions||(t.messageRetryOptions={}),(t.messageRetryOptions.maxRetries==null||t.messageRetryOptions.maxRetries<0)&&(t.messageRetryOptions.maxRetries=3),(t.messageRetryOptions.retryDelayInMs==null||t.messageRetryOptions.retryDelayInMs<0)&&(t.messageRetryOptions.retryDelayInMs=1e3),(t.messageRetryOptions.maxRetryDelayInMs==null||t.messageRetryOptions.maxRetryDelayInMs<0)&&(t.messageRetryOptions.maxRetryDelayInMs=3e4),t.messageRetryOptions.mode==null&&(t.messageRetryOptions.mode="Fixed")}_buildReconnectRetryOptions(t){t.reconnectRetryOptions||(t.reconnectRetryOptions={}),(t.reconnectRetryOptions.maxRetries==null||t.reconnectRetryOptions.maxRetries<0)&&(t.reconnectRetryOptions.maxRetries=Number.MAX_VALUE),(t.reconnectRetryOptions.retryDelayInMs==null||t.reconnectRetryOptions.retryDelayInMs<0)&&(t.reconnectRetryOptions.retryDelayInMs=1e3),(t.reconnectRetryOptions.maxRetryDelayInMs==null||t.reconnectRetryOptions.maxRetryDelayInMs<0)&&(t.reconnectRetryOptions.maxRetryDelayInMs=3e4),t.reconnectRetryOptions.mode==null&&(t.reconnectRetryOptions.mode="Fixed")}_buildRecoveryUri(){if(this._connectionId&&this._reconnectionToken&&this._uri){const t=new URL(this._uri);return t.searchParams.append("awps_connection_id",this._connectionId),t.searchParams.append("awps_reconnection_token",this._reconnectionToken),t.toString()}return null}_getOrAddGroup(t){return this._groupMap.has(t)||this._groupMap.set(t,new al(t)),this._groupMap.get(t)}_changeState(t){de.verbose(`The client state transfer from ${this._state.toString()} to ${t.toString()}`),this._state=t}async _operationExecuteWithRetry(t,r){let c=0;for(;;)try{return await t.call(this)}catch(l){c++;const d=this._messageRetryPolicy.nextRetryDelayInMs(c);if(d==null||(await nt(d),r?.aborted))throw l}}}class bn{constructor(t){this._retryOptions=t,this._maxRetriesToGetMaxDelay=Math.ceil(Math.log2(this._retryOptions.maxRetryDelayInMs)-Math.log2(this._retryOptions.retryDelayInMs)+1)}nextRetryDelayInMs(t){return t>this._retryOptions.maxRetries?null:this._retryOptions.mode==="Fixed"?this._retryOptions.retryDelayInMs:this._calculateExponentialDelay(t)}_calculateExponentialDelay(t){return t>=this._maxRetriesToGetMaxDelay?this._retryOptions.maxRetryDelayInMs:(1<<t-1)*this._retryOptions.retryDelayInMs}}class al{constructor(t){this.isJoined=!1,this.name=t}}class cl{constructor(t){this._promise=new Promise((r,c)=>{this._resolve=r,this._reject=c}),this.ackId=t}promise(){return this._promise}resolve(t){this._resolve(t)}reject(t){this._reject(t)}}class ll{constructor(){this._sequenceId=0,this._isUpdate=!1}tryUpdate(t){if(this._isUpdate=!0,t>this._sequenceId){const r=t-this._sequenceId;return this._sequenceId=t,r}return 0}tryGetSequenceId(){return this._isUpdate?(this._isUpdate=!1,[!0,this._sequenceId]):[!1,null]}reset(){this._sequenceId=0,this._isUpdate=!1}}class Sn{constructor(t,r,c){this._func=t,this._abortController=new ss,this._interval=r,this._obj=c,this._start()}abort(){try{this._abortController.abort()}catch{}}async _start(){const t=this._abortController.signal;for(;!t.aborted;)try{await this._func(this._obj)}catch{}finally{await nt(this._interval)}}}const ul=1e3*60*60,dl=1e3*30;class fl{client;handler;terminationTimeout=null;connectionUrl;expiresAt;connected=!1;websocketRequestId=null;conversationId=null;secondaryTypeBasedHandlers=new Map;constructor(t,r,c,l=null,d=new Map){this.connectionUrl=r,this.expiresAt=c,this.client=new il({getClientAccessUrl:()=>t(this.connectionUrl,this.expiresAt)},{autoReconnect:!0,reconnectRetryOptions:{maxRetries:5,retryDelayInMs:100,maxRetryDelayInMs:1e4,mode:"Exponential"}}),this.handler=l,this.secondaryTypeBasedHandlers=d}async start(){const t=r=>{if(this.secondaryTypeBasedHandlers.has(r.message.data.type)){const c=this.secondaryTypeBasedHandlers.get(r.message.data.type);if(!c)return;c(r.message.data)}else{const c=r.message.data.body,l=atob(c).trim();if(l.startsWith("data: ")){const d=l.replace("data: ",""),f=this.handler;if(!f)return;f({conversationId:r.message.data.conversation_id,responseId:r.message.data.response_id,message:{id:"",event:"",data:d},websocketRequestId:r.message.data.websocket_request_id})}}};this.client.on("group-message",r=>t(r)),this.client.on("server-message",r=>t(r)),this.client.on("connected",()=>{this.connected=!0}),this.client.on("disconnected",()=>{this.connected=!1}),await this.client.start()}addSecondaryTypeHandler(t,r){this.secondaryTypeBasedHandlers.set(t,r)}isConnected(){return this.connected}async stop(t){t&&this.conversationId!==t||this.websocketRequestId&&await He.stopWebsocketConversation(this.websocketRequestId)}setHandler(t,r,c,l){!this.handler&&this.websocketRequestId===c||(this.handler!=null&&this.websocketRequestId!==c&&($s.warn("[websockets] Overwriting existing handler without silencing. This may indicate a race condition."),le.logEvent(ue.asyncHandlerOverwritten,{originalWebsocketRequestId:this.websocketRequestId,newWebsocketRequestId:c,conversationId:t,responseId:r})),this.websocketRequestId=c,this.conversationId=t,this.handler=d=>{(d.websocketRequestId===c||d.conversationId===t&&d.responseId===r)&&l(d.message)})}silence(){this.handler=null}close(){this.client.stop()}scheduleForTermination(t){this.terminationTimeout=setTimeout(()=>{this.close(),t()},ul)}preventTermination(){this.terminationTimeout&&(clearTimeout(this.terminationTimeout),this.terminationTimeout=null)}updateConnectionUrl(t,r){this.connectionUrl=t,this.expiresAt=r}}class hl{activeSocketMap=new Map;secondaryTypeBasedHandlers=new Map;async register(){const t=await He.postRegisterWebsocket();t.wss_url&&(this.getOrCreateSocket(t.wss_url,new Date(t.expires_at),!0),t.fallback_wss_url&&this.getOrCreateSocket(t.fallback_wss_url,new Date(t.expires_at),!1))}async registerIfNotConnected(){if(this.activeSocketMap.size===0){await this.register();return}for(const t of this.activeSocketMap.values())if(!t.isConnected()){await this.register();return}}isWebsocketConnected(){for(const t of this.activeSocketMap.values())if(t.isConnected())return!0;return this.activeSocketMap.size>0&&Ce.addError("Cannot connect to any websocket."),!1}async getOrCreateSocket(t,r,c){const l=t.split("?")[0];let d;const f=this.activeSocketMap.get(l);if(f&&f.isConnected())f.preventTermination(),f.updateConnectionUrl(t,r),d=f;else{f&&f.close(),d=new fl(async(a,p)=>{if(new Date<new Date(p.getTime()-5*1e3))return a;const y=await He.postRegisterWebsocket();return c?y.wss_url:y.fallback_wss_url??""},t,r,null,this.secondaryTypeBasedHandlers),this.activeSocketMap.set(l,d);try{await d.start()}catch(a){throw Ce.addError(new Error("Error occurred while starting websocket: ",{cause:a})),a}}return d}preSetupWebsocket(t,r,c){for(const l of this.activeSocketMap.values())this.setupWebSocketHandler(l,null,null,null,t,r,c)}addSecondaryTypeHandler(t,r){this.secondaryTypeBasedHandlers.set(t,r);for(const c of this.activeSocketMap.values())c.addSecondaryTypeHandler(t,r)}hasSecondaryTypeHandler(t){return this.secondaryTypeBasedHandlers.has(t)}async processWebSocketConversationStream(t,r,c,l,d,f,a,p,y){const _=[this.getOrCreateSocket(t,c,!0)];r&&_.push(this.getOrCreateSocket(r,c,!1));const k=await Promise.allSettled(_),m=k[0].status==="fulfilled"?k[0].value:null,x=k.length>1&&k[1].status==="fulfilled"?k[1].value:null;if((!m||!m.isConnected())&&Ce.addError(`Cannot connect to primary websocket, websocketRequestId: ${f}, token: ${t.substring(0,t.indexOf("access_token="))}`),(!m||!m.isConnected())&&(!x||!x.isConnected()))throw r&&Ce.addError(`Cannot connect to fallback websocket, websocketRequestId: ${f}, token: ${r.substring(0,r.indexOf("access_token="))}`),ke.createWithErrorMessage("websocket","server",`An error occurred while connecting to the websocket. ${Tt}`);let S=setTimeout(()=>{Ce.addError(`WebSocket took too long to respond: ${d}, ${l}, ${f}, ${t.substring(0,60)}...${t.slice(-20)}`,{supportsWebSockets:"WebSocket"in window&&window.WebSocket.CLOSING===2})},dl);const E=I=>(y&&(clearTimeout(y),y=null),S&&(clearTimeout(S),S=null),a(I));m&&this.setupWebSocketHandler(m,t,l,d,f,E,p),x&&r&&this.setupWebSocketHandler(x,r,l,d,f,E,p)}async stopConversation(t){for(const r of this.activeSocketMap.values())await r.stop(t)}setupWebSocketHandler(t,r,c,l,d,f,a){t.setHandler(c,l,d,f),this.secondaryTypeBasedHandlers.forEach((y,_)=>{t.addSecondaryTypeHandler(_,y)});const p=()=>{r?t.scheduleForTermination(()=>{this.activeSocketMap.delete(r.split("?")[0])}):(this.stopConversation(c),t.silence())};a.addEventListener("abort",p)}}const zt=new hl;function ml(s){return{webSocketUrl:s.wss_url,fallbackWebSocketUrl:s.fallback_wss_url,conversationId:s.conversation_id,responseId:s.response_id,expiresAt:s.expires_at&&new Date(s.expires_at),websocketRequestId:s.websocket_request_id}}async function pl(s,t,r){return zt.preSetupWebsocket(s,t,r)}async function gl(s,t,r,c,l,d,f,a,p){return zt.processWebSocketConversationStream(s,t,r,c,l,d,f,a,p)}const xl=1e3*30,Ct=Rn.getTracer("completion");class It extends Error{}function yl(s,t,r,c){return(async(d=null)=>{Xo()&&await Yo();const f=new AbortController,a="threadId"in t?t.threadId:void 0,p="continueFromSharedConversationId"in t?t.continueFromSharedConversationId:void 0,y=Ws(),_=Pe.checkGate("1987334402"),k=Pe.checkGate("2964350589"),m=[_&&Le.V1,k&&Le.V1_TEST].filter(Boolean),x={action:t.completionType,messages:t.messages.length>0?t.messages:void 0,conversation_id:a,continue_from_shared_conversation_id:a!=null?void 0:p,parent_message_id:t.parentMessageId,model:t.model,timezone_offset_min:new Date().getTimezoneOffset(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,variant_purpose:t.completionMetadata?.variantPurpose,suggestions:t.completionMetadata?.suggestions?t.completionMetadata.suggestions.map(T=>Zo(T)):void 0,chosen_suggestion:t.completionMetadata?.suggestion?{type:t.completionMetadata.suggestion.type,index:t.completionMetadata.suggestionIndex,source:t.completionMetadata?.suggestion.type===on.Autocomplete?t.completionMetadata.suggestion.source:void 0,user_input:t.completionMetadata?.suggestion.type===on.Autocomplete?t.completionMetadata.suggestion.userInput:void 0}:void 0,history_and_training_disabled:t.historyDisabled,juice:t.completionMetadata?.juice,conversation_mode:t.completionMetadata?.conversationMode,force_paragen:t.forceParagen,force_paragen_model_slug:t.forceParagenModel,force_indepth_feedback:t.forceIndepthFeedback,force_rate_limit:t.forceRateLimit,reset_rate_limits:t.resetRateLimits,disable_system_content_toggling:t.disableSystemContentToggling,websocket_request_id:y,source:t.completionMetadata?.source,system_hints:t.completionMetadata?.systemHints,prefetch_ids:t.completionMetadata?.prefetchIds,force_use_sse:!zt.isWebsocketConnected(),supported_encodings:m,conversation_origin:t.conversationOrigin,force_use_search:t.forceUseSearch,client_reported_search_source:t.completionMetadata?.searchSource,client_contextual_info:t.contextualInfo,paragen_stream_type_override:t.paragenStreamType==="none"?null:t.paragenStreamType,paragen_cot_summary_display_override:t.paragenCotSummaryDisplay},S=Pe.checkGate("1113464293");S&&(x.supports_buffering=!0),t.turnTracker.stream_buffering=S;let E,I;const A=qs(s);Hs(A)?(I="https://chatgpt.com/backend-anon",E=Qt.getUnauthHeaders().additionalHeaders):(I="https://chatgpt.com/backend-api",E=Qt.getAuthedHeadersWithAccessToken(A?.accessToken));const N=`${I}/conversation`;let b=!0,M=!0;const R=Gs(t.chatReq,d??t.arkoseToken,t.turnstileToken,t.proofToken,null),B={...E,...ei(),...R};let D,F,P;Ct.startActiveSpan("completion.response",T=>{D=Ct.startSpan("completion.first_response"),F=Ct.startSpan("completion.first_token"),P=T});const $=Rn.setSpan(Jt.active(),P);let W=null,Y=null,O,q=!1,Q=!1;function V(){Q||(Q=!0,r({type:"done"}),an())}function j(T){if(t.turnTracker.onBytesReceived(T.data),T.data==="[DONE]")f.abort(),P.end(),V();else if(T.event!=="ping")try{let C=JSON.parse(T.data);if(T.event==="delta_encoding")if(C===Le.V1||C===Le.V1_TEST)W=C,t.turnTracker.stream_encoding=W??void 0,Y=new ni;else{Ce.addError(`[completion-delta] unknown delta encoding: ${C}`);return}else if(T.event==="delta"){if(!Y){Ce.addError("[completion-delta] delta event before delta_encoding");return}const ie=Y.applyDelta(C);if(W===Le.V1_TEST){!q&&!Ks(ie,O)&&(q=!0,Ce.addError("[completion-delta] delta resulted in a different object",{differences:si(ie,O)}));return}else C=ie}else W===Le.V1_TEST&&!q&&(O=C);if(C.error){const ie=ke.createWithErrorMessage(N,"server",C.error);throw r({type:"error",error:ie}),ie}else"type"in C?C.type==="gizmo_inline_review"?r({type:"gizmo_inline_review",gizmoId:C.gizmo_id}):C.type==="title_generation"?r({type:"title_generation",title:C.title,conversation_id:C.conversation_id}):C.type==="moderation"?r({type:"moderation",conversationId:C.conversation_id,messageId:C.message_id,isCompletion:C.is_completion,flagged:C.moderation_response.flagged,blocked:C.moderation_response.blocked,disclaimers:C.moderation_response.disclaimers,metadata:C.moderation_response.metadata}):C.type==="url_moderation"?r({type:"url_moderation",conversationId:C.conversation_id,messageId:C.message_id,url:C.url_moderation_result.full_url,isSafe:C.url_moderation_result.is_safe}):C.type==="num_variants_in_stream"?r({type:"num_variants_in_stream",num_variants_in_stream:C.num_variants_in_stream,display_treatment:C.display_treatment}):C.type==="conversation_detail_metadata"?r(C):C.type==="message_stream_complete"&&V():(r({type:"message",message:C.message,conversationId:C.conversation_id}),M&&(M=!1,D.end()),b&&C.message.author.role==="assistant"&&C.message.content.content_type==="text"&&C.message.content.parts[0]!==""&&(b=!1,F.end()))}catch(C){if(C instanceof ke)throw C}}let z=null,G=setTimeout(()=>{z===!0?(le.logEvent(ue.asyncResponseWaitTooLong,{}),t.turnTracker.logCompletion({type:cn.Error,error:{reason:"timeout",message:"Async Response Took Too Long to Come Back"}})):z===!1&&(le.logEvent(ue.sseResponseWaitTooLong,{}),t.turnTracker.logCompletion({type:cn.Error,error:{reason:"timeout",message:"SSE Response Took Too Long to Come Back"}}))},xl);return pl(y,j,f.signal),Jt.with($,()=>(t.profiler?.logTiming("fetch_event_source"),ti(N,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",...B},body:JSON.stringify(x),signal:f.signal,openWhenHidden:!0,async onopen(T){const C=T.headers.get("content-type")??"",ie=T.headers.get("Cf-Ray")??null;if(T.ok&&C.includes("text/event-stream")){z=!1,c(ie,t.model,t.turnTracker);return}else if(C.includes("application/json")){const me=await T.json(),{webSocketUrl:be,fallbackWebSocketUrl:L,conversationId:X,responseId:K,expiresAt:Z,websocketRequestId:we}=ml(me);if(be!=null&&X!=null&&K!=null&&we!=null&&Z){z=!0,c(ie,t.model,t.turnTracker);try{await gl(be,L,Z,X,K,we,j,f.signal,G)}catch(ce){ce instanceof ke&&r({type:"error",error:ce})}throw new It}else{const ce=new ke(N,T.status,me);if(ce.isServerError())throw ce;if((ce?.code==="expired_session_key"||ce?.code==="invalid_api_key"||ce?.code==="token_expired")&&typeof window<"u"&&window._oaiHandleSessionExpired?.("stream",JSON.stringify(ce)),ce?.code==="deactivated_workspace"){window.location.href.includes("/workspace/deactivated")||(window.location.href="/workspace/deactivated");return}throw ce}}else{const me=await T.text();throw new ke(N,T.status,{detail:{message:Xt,code:"unexpected_content_type",contentType:C,text:me?.substring(0,1e3)}})}},onmessage:T=>{if(z)throw ke.createWithErrorMessage(N,"server",Xt);G&&(clearTimeout(G),G=null),j(T)},onerror(T){let C=T instanceof Error?T:new Error(JSON.stringify(T));throw C instanceof It||z||(C.message==="Failed to fetch"&&(C=ke.createWithErrorMessage(N,"server",`An error occurred. Either the engine you requested does not exist or there was another issue processing your request. ${Tt}`)),C.message==="network error"&&(C=ke.createWithErrorMessage(N,"client",`A network error occurred. Please check your connection and try again. ${Tt}`)),Vs("fetch-error:conversation:new-message",{url:N,message:C?.message}),r({type:"error",error:C}),an(C)),C}}))).catch(async T=>{T instanceof It||(T instanceof ke?zs(T):Ce.addError(T),t.turnTracker.handleRawError(T.message??"Something went wrong",T.status))}),f})()}function wl({clientThreadId:s,continuingFromSharedConversationId:t,onCompletionFinished:r=Mt,onCreate:c=Mt}){const l=Dt(),{resolvedTheme:d}=En(),f=d==="dark",a=w.useRef(r),p=Qs();a.current=r;const y=w.useCallback(async function({model:_,completionType:k,parentNodeId:m,metadata:x,focusOnNewCompletion:S=!0,completionMetadata:E,chatReq:I,arkoseToken:A,turnstileToken:N,proofToken:b,preflightTime:M,extraStreamParams:R,appendMessages:B,updateTree:D,turnTracker:F,profiler:P}){ri.publish({kind:"requestCompletion"});const $=ae.getTree(s);ae.retainThread(s);const W=ui(),Y=`${ci}${s}-${W}`,O=`${s}-${W}`;D?.();const q=$.getNodeByIdOrMessageId(m),V={gizmo_id:q.message.metadata?.gizmo_id};E?.juice!=null&&(V.snorkle_status=1),ae.updateTree(s,L=>{L.addNode(Y,"",m,rt.Assistant,void 0,V)}),S&&ae.setThreadCurrentLeafId(s,Y);let j,z=[],G=$.getNodeByIdOrMessageId(q.parentId);for(;G!=null&&(G.metadata?.isPlaceholderTemplateAssistantWelcomeMessage===!0||G.metadata?.isClientCreatedSystemMessage===!0);){const L=G.message;z.unshift(L);const X=$.getNodeByIdOrMessageId(G.parentId);j=X.message?.id??X.id,G=X}if(k===tt.Next||k===tt.Variant){const L=$.getNodeByIdOrMessageId(q.parentId);if(j??=L.message?.id??L.id,z.push(q.message),B){let X=m;ae.updateTree(s,K=>{for(const Z of B)K.insertNodeBefore(Y,{id:Z.id,message:Z,parentId:X,children:[]}),X=Z.id}),z.push(...B)}z=vl(z,R)}else j??=q.message.id;const oe=ae.getServerThreadId(s);oe===void 0&&oi(s)&&ae.updateInitialThreadDataForNewThread(s,_);async function T(L,X){const K=performance.now(),Z=await Ys();Yt.initializeAndGatherData(Z),ln.initializeAndGatherData(Z),Zt.initializeAndGatherData(Z),ae.updateTree(s,ve=>{for(const ye of X)ve.addNode(ye.id,ye,L,rt.Assistant,{completionSampleFinishTime:Date.now()}),L=ye.id}),ae.setThreadCurrentLeafId(s,L);const we=await Yt.getEnforcementToken(Z),ce=await ln.getEnforcementToken(Z),Me=await Zt.getEnforcementToken(Z);y({model:_,completionType:tt.Next,parentNodeId:L,metadata:{},chatReq:Z,arkoseToken:we??null,turnstileToken:ce??null,proofToken:Me??null,preflightTime:performance.now()-K,extraStreamParams:R,turnTracker:F})}F.updateAttachmentCount(z);const C=new ii(l,s,Y,k,_,x.eventSource,c,O,T,(...L)=>a.current(...L),F,p),ie=(L,X,K)=>{L&&K.onReceivedRequestId(L),di(O,X,L,M)},me={is_dark_mode:f,time_since_loaded:Math.floor(performance.now()/1e3),page_height:window?.innerHeight,page_width:window?.innerWidth,pixel_ratio:window?.devicePixelRatio,screen_height:window?.screen?.height,screen_width:window?.screen?.width},be=await yl(l,{conversationOrigin:ae.getConversationOrigin(s),model:_,completionType:k,threadId:oe,continueFromSharedConversationId:t,historyDisabled:p,parentMessageId:j,messages:z,chatReq:I,arkoseToken:A??null,turnstileToken:N??null,proofToken:b??null,completionMetadata:E,...R,turnTracker:F,profiler:P,contextualInfo:me},C.handleResponse,ie);ai(s,{source:Js.CLIENT,value:Xs.STREAMING}),rs.addRequest(Y,be,F),jt.onCompletionRequestStarted(Y)},[s,l,c,t,p,f]);return y}const vl=(s,t)=>{let r=s;return t?.forceUseSearch===!1&&s.length>0&&(r=s.map(c=>{const{system_hints:l,...d}=c.metadata||{};return{...c,metadata:{...d,system_hints:l?.filter(f=>f!==li.Search)}}})),r};function _l({clientThreadId:s,currentModelId:t,defaultModelId:r,onCompletionFinished:c,onThreadCreated:l,preRequestCompletion:d}){const f=fi(),a=$t(),{isUnauthenticated:p}=Ot(),y=hi(s),_=Dt(),k=mi(s),m=De(),x=pi(s),S=gi(),E=jn(),{config:I}=Zs("1013114931"),A=I.get("show_follow_ups",!1)&&m?.isPersonalAccount(),N=!S.displayingSideBySideFeedback&&A,b=w.useCallback(O=>{const Q=ae.getTree(s).getLeafFromNode(O);ae.setThreadCurrentLeafId(s,Q.id)},[s]),M=xi(t),[R,B]=w.useState(),D=w.useCallback(({nodeId:O,messageId:q,rating:Q})=>{const V=ae.getServerThreadId(s);le.logEvent(ue.thumbRating,{id:q,threadId:V,rating:Q,model:t});const j=ae.getTree(s),z=j.getNodeByIdOrMessageId(O);if(V!==void 0&&!M&&He.submitMessageFeedback({message_id:q,conversation_id:V,rating:Q}),ae.updateTree(s,G=>{G.updateNodeMetadata(O,{rating:Q})}),M){B(o.jsx(tl,{citations:z.message.metadata?.citations??[],rating:Q,conversationId:V??"",messageId:q,onSubmit:()=>{B(void 0)},onCancel:()=>B(void 0),conversationTree:j,nodeId:O},`${O}-${Q}`));return}},[s,t,M]),F=w.useCallback(O=>{if(O==null||(c?.(O),E)||(k?.kind===er.GizmoInteraction&&yi.handleGizmoInteracted(_,k.gizmo_id),!(x||N)))return;const Q=ae.getThreadCurrentLeafId(O),V=ae.getTree(O).getMessage(Q);wi(V)||vi(V)||_i(O,V.id,t)},[k,t,c,_,x,N,E]),P=wl({clientThreadId:s,continuingFromSharedConversationId:y,onCompletionFinished:F,onCreate:l}),$=w.useCallback(()=>{const O=ae.getThreadCurrentLeafId(s);if(O==null)return;const Q=ae.getTree(s).getBranchFromLeaf(O);rs.abortRequests(Q.map(V=>V.id))},[s]),W=w.useCallback(O=>bi({cancelRequests:$,clientThreadId:s,currentModelId:t,debugSettings:f,defaultModelId:r,isUnauthenticated:p,navigateToAuth:a,preRequestCompletion:d,requestCompletion:P,...O}),[$,s,t,f,r,p,a,d,P]),Y=w.useCallback((O,q,Q,V=!0,j="none",z)=>{const oe=ae.getTree(s).getParentPromptNode(O).id;W({type:tt.Variant,promptId:oe,eventMetadata:q,cancelActiveRequests:!1,focusOnNewCompletion:V,useDefaultModel:z,completionMetadata:{variantPurpose:j,conversationMode:Si.getConversationMode(s)},turnTracker:Q})},[s,W]);return{caModal:R,onRequestCompletion:W,onRequestMoreCompletions:Y,onChangeItemInView:b,onChangeRating:D,cancelRequests:$}}function bs(){return{caModal:null,clientThreadId:"",focusedObject:null,currentModelId:"",isModelLoaded:!1,isInstalledApp:!1,isCompanionWindow:!1,conversationLeafId:"",onNewThread:()=>{throw new Error("onNewThread not implemented")},onRequestCompletion:()=>{throw new Error("onRequestCompletion not implemented")},onChangeItemInView:()=>{throw new Error("onChangeItemInView not implemented")},onChangeRating:()=>{throw new Error("onChangeRating not implemented")},onRequestMoreCompletions:()=>{throw new Error("onRequestMoreCompletions not implemented")},resetThread:()=>{throw new Error("resetThread not implemented")}}}const Ss=w.createContext(bs());function bl(){try{return w.useContext(Ss)}catch{return bs()}}function Vl({children:s,clientThreadId:t,setClientThreadId:r,prefetchSearch:c}){const{createNewThread:l,onThreadCreated:d,resetThread:f}=Ei({clientThreadId:t,setClientThreadId:r}),a=ki(),p=Ci(t),y=Ii(t),_=a.id,k=p??_,m=tr(),x=Mi(),S=Ti(),{caModal:E,onRequestCompletion:I,onChangeItemInView:A,onChangeRating:N,onRequestMoreCompletions:b}=_l({clientThreadId:t,currentModelId:k,defaultModelId:a.id,onThreadCreated:d});return o.jsx(Ss.Provider,{value:{caModal:E,clientThreadId:t,currentModelId:k,isModelLoaded:!!p,isInstalledApp:x,isCompanionWindow:m,focusedObject:S,conversationLeafId:y,onNewThread:l,onRequestCompletion:I,onChangeItemInView:A,onChangeRating:N,onRequestMoreCompletions:b,resetThread:f,prefetchSearch:c},children:s})}const Sl=Ve(()=>ze(()=>import("./hg2kwixl1elebwsk.js"),__vite__mapDeps([33,1,2,3,5,6,34,35,36,37,15,20])));function zl({showShareButton:s,showProfileDropdown:t,clientThreadId:r}){const c=Di(r),l=xe(),d=On(),{layer:f}=ot("1547743984");Pi(r);const{onNewThread:a}=bl(),p=f.get("show_share_button_text",!1),y=l.formatMessage({id:"GizmoInformation.shareChat",defaultMessage:"Share"}),_=Qe(),k=()=>Ie.openSharingModal(c),m=!1,x=l.formatMessage({id:"TO+loE",defaultMessage:"New Chat"});return o.jsxs(o.Fragment,{children:[!1,d&&o.jsx(Pa,{}),!1,s&&c&&o.jsx(un,{clientThreadId:r,children:p?o.jsx(Rt,{onClick:k,icon:bt,label:y,"data-testid":"share-chat-button",color:"secondary",className:"text-token-text-primary",style:{display:"var(--screen-size-hidden-on-compact-mode)",viewTransitionName:"var(--vt_share_chat_wide_button)"},children:y}):o.jsx(_e,{label:l.formatMessage({id:"CPEfES",defaultMessage:"Share chat"}),children:o.jsx(Ke,{"data-testid":"share-chat-button",onClick:()=>Ie.openSharingModal(c),icon:bt,style:{viewTransitionName:"var(--vt_share_chat_compact_button)"}})})}),_&&s&&c&&o.jsx(un,{clientThreadId:r,children:o.jsx(_e,{label:y,children:o.jsx(dn,{style:{display:"var(--screen-size-hidden-on-wide-mode)",viewTransitionName:"var(--vt_share_chat_compact_button)"},onClick:k,icon:o.jsx(bt,{}),label:y})})}),_&&!m&&o.jsx(_e,{label:x,children:o.jsx("div",{style:{display:"var(--sidebar_is_open_and_pinned, none)"},children:o.jsx(dn,{className:ir.sidebarIcon,icon:o.jsx(hs,{}),onClick:()=>a(),label:x,style:{display:"var(--screen-size-hidden-on-wide-mode)"}})})}),t&&o.jsx(kl,{clientThreadId:r})]})}function El({to:s,children:t,icon:r}){const c=Pt();return o.jsx(te.Item,{icon:r,onSelect:()=>c(s),children:t})}function kl({clientThreadId:s}){const{isUnauthenticated:t}=Ot();return t?o.jsx(Bl,{}):o.jsx(Cl,{clientThreadId:s})}function Cl({clientThreadId:s}){const{data:t}=ut(),r=De(),c=r?.isPlus()??!1,l=r?.isWorkspaceAccount()??!1,{openSettings:d}=Ri(),f=Qn(),a=Tl(s??"none"),{openModal:p}=Jn(),y=Qe(),{layer:_}=ot("2888142241"),k=In("3905879930"),m=xe();var x=r?.isTeam()??!1,S=!1;x&&(S=k.config.get("enabled",!1));const{doesUserHaveAnyAccountsWithPlusFeatures:E}=nr(),{layer:I}=ot("2670443078");if(!r||!t)return null;const A=t.accountItems.length>1;let N=c;!l&&!c&&E&&I.get("is_gating_fix_enabled",!1)&&(N=E);const b=!l&&!N&&_.get("is_upgrade_in_settings",!1);return o.jsxs(ta,{contentClassName:re(y&&"max-w-[256px] min-w-[256px] w-[256px]"),triggerButton:o.jsx("button",{onClick:()=>{le.logEvent(ue.accountOpenProfileMenu),Pe.logEvent("chatgpt_account_open_profile_menu")},"aria-label":m.formatMessage({id:"wz2MQV",defaultMessage:"Open Profile Menu"}),"data-testid":"profile-button",className:"flex h-10 w-10 items-center justify-center rounded-full hover:bg-token-main-surface-secondary focus-visible:bg-token-main-surface-secondary focus-visible:outline-0",style:y?{display:"var(--screen-size-hidden-on-compact-mode, flex)"}:void 0,children:o.jsx(qt,{iconSize:"medium"})}),children:[A&&o.jsx(vs,{menuItemComponent:te.Item}),A?o.jsx(te.Separator,{}):null,l?o.jsx(Yn,{menuItemComponent:te.Item,routedMenuItemComponent:El}):o.jsx(Xn,{menuItemComponent:te.Item}),o.jsx(te.Item,{icon:as,onClick:()=>d(),"data-testid":"settings-menu-item",children:o.jsx(H,{defaultMessage:"Settings",id:"navigation.settings.0"})}),o.jsx(te.Separator,{}),x&&S&&o.jsxs(o.Fragment,{children:[o.jsx(te.Item,{"data-testid":"settings-menu-item-invite-teammates",onClick:()=>{Ie.openModal(Zn.InviteUsersToWorkspace),le.logEvent(ue.accountMemberInviteButton,{eventSource:"mouse",location:"profile_drop_down"}),Pe.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"dropdown-menu-click",text:"AddTeammates",step:"OpenModal"})},icon:cs,children:o.jsx(H,{...Es.addTeammatesButton})}),o.jsx(Sl,{workspace:r})]}),f&&o.jsx(Ml,{openDownloadModal:p}),b&&o.jsx(jl,{}),a&&o.jsx(Rl,{}),(b||f||a)&&o.jsx(te.Separator,{}),o.jsx(te.Item,{onClick:()=>{le.logEvent(ue.clickLogOut,{eventSource:"mouse"}),le.logLogOutButtonClicked({location:"profile_drop_down"}),Mn()},"data-testid":"log-out-menu-item",icon:ls,children:o.jsx(H,{defaultMessage:"Log out",id:"navigation.logOut.0"})})]})}function Il({onClick:s,className:t,testId:r}){const c=xe(),l=jn(),d=l?c.formatMessage({id:"yqd/J5",defaultMessage:"Clear chat"}):c.formatMessage({id:"OFyxqj",defaultMessage:"New chat"});return o.jsx(_e,{sideOffset:4,label:d,className:re("flex",t),children:o.jsx(Ke,{onClick:()=>{Ie.closePopoverNavSidebar(),s()},icon:l?ea:hs,surfaceContext:"secondary","aria-label":d,"data-testid":r})})}function Kl({clientThreadId:s}){const[t]=os(l=>[l.activeStageSidebar]),r=is(),c=Oi({clientThreadId:s,location:"Navigation actions"});return!r&&!t?null:o.jsxs("div",{className:"flex items-center",children:[o.jsx(Al,{}),o.jsx(Il,{onClick:c})]})}function Ml({openDownloadModal:s}){return o.jsx("span",{children:o.jsx(te.Item,{icon:us,onClick:()=>{s(),le.logEvent(ue.accountMenuClickDownloadApp)},children:o.jsx(H,{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"})})})}const Tl=s=>{const{value:t}=sr("2634628831"),r=rr(()=>document.documentElement.dataset.searchExtension==="1"),c=ji(s,or.Search);return!r&&c&&Ai()&&t},Rl=()=>o.jsx("span",{children:o.jsx(te.Item,{icon:Xi,onClick:()=>{window.open(Bi),le.logEventWithStatsig(ue.chatgptBrowserExtensionUserMenuClicked,"chatgpt_browser_extension_user_menu_clicked")},children:o.jsx(H,{id:"E5VPz/",defaultMessage:"Get ChatGPT search extension"})})});function jl(){const s=Pt(),r=De()?.wasPaidCustomer()??!1,c=()=>{Pe.logEvent("chatgpt_plus_upgrade_in_settings_menu_clicked"),le.logEvent(ue.plusUpgradeInSettingsMenuClicked),es(s,"Upper right settings menu")};return o.jsx(te.Item,{icon:Yi,onClick:c,children:r?o.jsx(H,{id:"navigation.renewPlus",defaultMessage:"Renew Plus"}):o.jsx(H,{id:"navigation.upgradePlan",defaultMessage:"Upgrade Plan"})})}function Al(){const s=xe(),[t]=os(d=>[d.activeStageSidebar]),r=is(),c=Kn(),{isUnauthenticated:l}=Ot();return!t&&!r||!c||l?null:o.jsx(_e,{label:s.formatMessage({id:"cElEQV",defaultMessage:"Open sidebar"}),className:"flex",children:o.jsx(Ke,{"aria-label":s.formatMessage({id:"pV/Etp",defaultMessage:"Open sidebar"}),onClick:Ie.toggleNavSidebar,icon:Zi,surfaceContext:"primary"})})}function Bl(){const s=$t(),t=Ni(),r=Fi(Es.signUpCta),{layer:c}=ot("3637408529"),l=c.get("is_desktop_primary_auth_button_on_right",!1),d=()=>{s({authType:"login",callback:_=>{le.logLogInButtonClicked({location:"Chat header",provider:_})}})},f=()=>{s({authType:"signup",callback:_=>{le.logSignUpButtonClicked({location:"Chat header",provider:_})}})},a=o.jsx(Rt,{onClick:d,color:t?"primary":"secondary",size:"small","data-testid":"login-button",children:o.jsx(H,{id:"B1SN7b",defaultMessage:"Log in"})},"login"),p=o.jsx(Rt,{color:t?"secondary":"primary",onClick:f,size:"small","data-testid":"signup-button",children:o.jsx(H,{...r})},"signup"),y=t?[a,p]:[p,a];return o.jsx("div",{className:"flex items-center justify-center gap-2",children:l?y.reverse():y})}const Es=lt({signUpCta:{id:"P6cySK",defaultMessage:"Sign up"},addTeammatesButton:{id:"inviteMemberButton.inviteMemberButton",defaultMessage:"Add Teammates"}});export{wa as A,Kc as C,ms as D,Al as E,aa as L,ac as M,Il as N,ia as O,Pc as P,ic as R,Na as T,ql as U,Cl as a,oc as b,Ss as c,Vl as d,zl as e,Kl as f,mt as g,Wl as h,Hl as i,Ma as j,fn as k,$e as l,kl as m,wl as n,_a as o,Ia as p,_l as q,bl as u,zt as w,nc as x,sc as y};
//# sourceMappingURL=ilm2a2yioj15f7xd.js.map
