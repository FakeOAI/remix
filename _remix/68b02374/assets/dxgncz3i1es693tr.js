const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/l6q6id4qdfd6ttgt.js","assets/bki90rofpmxzesnj.js","assets/izne22sv20stjku4.js","assets/nc3bx7y5k0rlmtca.js","assets/ign6lc5qqsbgzj3q.js","assets/wrbxtg8dgsjl2z0d.js","assets/root-lbfis1cw.css","assets/f2jm88xc868xaf4h.js","assets/conversation-small-9gmhsapt.css","assets/lc5t42k1qhi0m0nv.js","assets/m2s7nrbf41ve6nvh.js","assets/odhn2e8eru1zj48u.js","assets/syqtrgo5xyrulm04.js","assets/lfslwklj0w7o2iv1.js","assets/e3vtmyn8hkdv1qt3.js","assets/fctryjik2hvcole2.js","assets/97n2sddo0kt3mxt7.js","assets/hh4uqt8fwrewd2n3.js","assets/dseck4fe311mjmeu.js","assets/c5od2z6nlz2wgytj.js","assets/lxnj1r1djy5hefrq.js","assets/nbgat0tit3oogh89.js","assets/kns20daoml3jhjvb.js","assets/csdhhr7q8702lo0g.js","assets/j22k2jvq891e9l91.js","assets/mgn4nm9air4gffun.js","assets/f74vdve44brijz1h.js","assets/myddwse0eypiiic3.js","assets/dq49str5yz9max4y.js","assets/uqbfr1w95a2ebszz.js","assets/k2wgqbgbioizhj10.js","assets/oo7rmsn6cx5gu6kf.js","assets/oy5sysxnxt2ofpl2.js","assets/h63123d5e7ltn562.js"])))=>i.map(i=>d[i]);
import{ao as N,a$ as ut,i as ao,g as io,g2 as co,j as u,ak as A,n as te,r as v,J as Ae,fG as lo,b as dt,aF as uo,cG as ft,am as R,bw as fo,ar as mt}from"./ign6lc5qqsbgzj3q.js";import{i as b,E as le,Z as B,j as pt,k as gt,H as mo,G as j,l as po,T as Fe,C as He}from"./m2s7nrbf41ve6nvh.js";import{c as go,S as ho,H as vo,x as Co,t as m}from"./izne22sv20stjku4.js";import{E as xo,a5 as re,a6 as $,a7 as O,a8 as ge,a9 as Eo,aa as he,ab as Ye,ac as yo,ad as _o,ae as bo,af as No,a2 as V,ag as ht,ah as vt}from"./nc3bx7y5k0rlmtca.js";import{jz as To,a8 as X,g4 as D,bs as Ct,lp as Po,nd as So,iR as ko,fY as oe,cG as xt,jv as W,oI as Pe,oJ as Io,oK as Mo,oL as $e,$ as Ao,a as Ro,b as wo,e as Oo,d as Lo,g6 as Do,oM as jo,g7 as Bo}from"./f2jm88xc868xaf4h.js";import{m as L}from"./lc5t42k1qhi0m0nv.js";import{b$ as Go,c0 as Vo,ac as Fo,b as Ho,c1 as Yo}from"./wrbxtg8dgsjl2z0d.js";import{d as $o}from"./g1b1ozz3akvltlk6.js";import{T as Uo,P as Et,f as Ko,c as zo,i as Xo,e as Wo,D as Ue,d as yt}from"./fctryjik2hvcole2.js";import{u as ve}from"./lfslwklj0w7o2iv1.js";import{u as qo}from"./lxnj1r1djy5hefrq.js";import{i as Jo}from"./97n2sddo0kt3mxt7.js";const Zo="_modelCursor_1mtn0_1",Is={modelCursor:Zo},Qo=(...e)=>o=>{e.forEach(t=>{if(typeof t=="function")t(o);else if(t){const n=t;n.current=o}})};function I(e){return new go(ho.define(e))}const Ke=()=>N(()=>import("./pbl95wx6493wq92j.js"),[]).then(e=>I(e.shell)),_t={[b.bash]:Ke,[b.zsh]:Ke,[b.swift]:()=>N(()=>import("./pijqfo56g5y7ss6b.js"),[]).then(e=>I(e.swift)),[b.css]:()=>N(()=>import("./l6q6id4qdfd6ttgt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.css()),[b.html]:()=>N(()=>import("./nbgat0tit3oogh89.js"),__vite__mapDeps([21,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,0,22])).then(e=>e.html()),[b.javascript]:()=>N(()=>import("./kns20daoml3jhjvb.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.javascript({jsx:!0,typescript:!1})),[b.typescript]:()=>N(()=>import("./kns20daoml3jhjvb.js"),__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.javascript({jsx:!0,typescript:!0})),[b.json]:()=>N(()=>import("./csdhhr7q8702lo0g.js"),__vite__mapDeps([23,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.json()),[b.python]:()=>N(()=>import("./j22k2jvq891e9l91.js"),__vite__mapDeps([24,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.python()),[b.sql]:()=>N(()=>import("./mgn4nm9air4gffun.js"),__vite__mapDeps([25,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1])).then(e=>e.sql()),[b.go]:()=>N(()=>import("./f74vdve44brijz1h.js"),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.go()),[b.yaml]:()=>N(()=>import("./myddwse0eypiiic3.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.yaml()),[b.java]:()=>N(()=>import("./dq49str5yz9max4y.js"),__vite__mapDeps([28,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.java()),[b.rust]:()=>N(()=>import("./uqbfr1w95a2ebszz.js"),__vite__mapDeps([29,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.rust()),[b.cpp]:()=>N(()=>import("./k2wgqbgbioizhj10.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.cpp()),[b.php]:()=>N(()=>import("./oo7rmsn6cx5gu6kf.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,0,22])).then(e=>e.php()),[b.xml]:()=>N(()=>import("./oy5sysxnxt2ofpl2.js"),__vite__mapDeps([32,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.xml()),[b.vue]:()=>N(()=>import("./h63123d5e7ltn562.js"),__vite__mapDeps([33,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,1,0,22])).then(e=>e.vue()),[b.ruby]:()=>N(()=>import("./e4lhyu305wu0fcut.js"),[]).then(e=>I(e.ruby)),[b.haskell]:()=>N(()=>import("./bf6r3t2rw7f01so5.js"),[]).then(e=>I(e.haskell)),[b.kotlin]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.kotlin)),[b.csharp]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.csharp)),[b.c]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.c)),[b.objectivec]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.objectiveC)),[b.r]:()=>N(()=>import("./n0t2rpizlasjzcxa.js"),[]).then(e=>I(e.r)),[b.lua]:()=>N(()=>import("./harowmpdmpnd9wki.js"),[]).then(e=>I(e.lua)),[b.dart]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.dart)),[b.scala]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.scala)),[b.perl]:()=>N(()=>import("./gq1ss5v2zpbborxl.js"),[]).then(e=>I(e.perl)),[b.commonlisp]:()=>N(()=>import("./jr6cjysmysifr6mr.js"),[]).then(e=>I(e.commonLisp)),[b.clojure]:()=>N(()=>import("./gf1tfl9d2himhfic.js"),[]).then(e=>I(e.clojure)),[b.ocaml]:()=>N(()=>import("./khji33iw1sxityyt.js"),[]).then(e=>I(e.oCaml)),[b.powershell]:()=>N(()=>import("./i9u5kd7kvamutmln.js"),[]).then(e=>I(e.powerShell)),[b.verilog]:()=>N(()=>import("./fix340p09fldyqxz.js"),[]).then(e=>I(e.verilog)),[b.dockerfile]:()=>N(()=>import("./cgm5tyzi32u32j10.js"),[]).then(e=>I(e.dockerFile)),[b.other]:()=>null},en=e=>e in _t,ue={},Ms=async e=>{if(ue[e]!=null)return ue[e];if(en(e)){const o=await _t[e]();return ue[e]=o,o}return null},As=e=>ue[e]??null;var bt=e=>{var{theme:o,settings:t={},styles:n=[]}=e,r={".cm-gutters":{}},s={};t.background&&(s.backgroundColor=t.background),t.backgroundImage&&(s.backgroundImage=t.backgroundImage),t.foreground&&(s.color=t.foreground),t.fontSize&&(s.fontSize=t.fontSize),(t.background||t.foreground)&&(r["&"]=s),t.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:t.fontFamily}),t.gutterBackground&&(r[".cm-gutters"].backgroundColor=t.gutterBackground),t.gutterForeground&&(r[".cm-gutters"].color=t.gutterForeground),t.gutterBorder&&(r[".cm-gutters"].borderRightColor=t.gutterBorder),t.caret&&(r[".cm-content"]={caretColor:t.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:t.caret});var a={};t.gutterActiveForeground&&(a.color=t.gutterActiveForeground),t.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:t.lineHighlight},a.backgroundColor=t.lineHighlight),r[".cm-activeLineGutter"]=a,t.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:t.selection+" !important"}),t.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:t.selectionMatch});var i=xo.theme(r,{dark:o==="dark"}),c=vo.define(n),l=[i,Co(c)];return l},tn={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#f0f0f0",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},on=[{tag:[m.keyword,m.operatorKeyword,m.modifier,m.color,m.constant(m.name),m.standard(m.name),m.standard(m.tagName),m.special(m.brace),m.atom,m.bool,m.special(m.variableName)],color:"#0000ff"},{tag:[m.moduleKeyword,m.controlKeyword],color:"#af00db"},{tag:[m.name,m.deleted,m.character,m.macroName,m.propertyName,m.variableName,m.labelName,m.definition(m.name)],color:"#0070c1"},{tag:m.heading,fontWeight:"bold",color:"#0070c1"},{tag:[m.typeName,m.className,m.tagName,m.number,m.changed,m.annotation,m.self,m.namespace],color:"#267f99"},{tag:[m.function(m.variableName),m.function(m.propertyName)],color:"#795e26"},{tag:[m.number],color:"#098658"},{tag:[m.operator,m.punctuation,m.separator,m.url,m.escape,m.regexp],color:"#383a42"},{tag:[m.regexp],color:"#af00db"},{tag:[m.special(m.string),m.processingInstruction,m.string,m.inserted],color:"#a31515"},{tag:[m.angleBracket],color:"#383a42"},{tag:m.strong,fontWeight:"bold"},{tag:m.emphasis,fontStyle:"italic"},{tag:m.strikethrough,textDecoration:"line-through"},{tag:[m.meta,m.comment],color:"#008000"},{tag:m.link,color:"#4078f2",textDecoration:"underline"},{tag:m.invalid,color:"#e45649"}];function nn(e){var{theme:o="dark",settings:t={},styles:n=[]}=e||{};return bt({theme:o,settings:ut({},tn,t),styles:[...on,...n]})}var Rs=nn(),rn={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},sn=[{tag:[m.keyword,m.operatorKeyword,m.modifier,m.color,m.constant(m.name),m.standard(m.name),m.standard(m.tagName),m.special(m.brace),m.atom,m.bool,m.special(m.variableName)],color:"#569cd6"},{tag:[m.controlKeyword,m.moduleKeyword],color:"#c586c0"},{tag:[m.name,m.deleted,m.character,m.macroName,m.propertyName,m.variableName,m.labelName,m.definition(m.name)],color:"#9cdcfe"},{tag:m.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[m.typeName,m.className,m.tagName,m.number,m.changed,m.annotation,m.self,m.namespace],color:"#4ec9b0"},{tag:[m.function(m.variableName),m.function(m.propertyName)],color:"#dcdcaa"},{tag:[m.number],color:"#b5cea8"},{tag:[m.operator,m.punctuation,m.separator,m.url,m.escape,m.regexp],color:"#d4d4d4"},{tag:[m.regexp],color:"#d16969"},{tag:[m.special(m.string),m.processingInstruction,m.string,m.inserted],color:"#ce9178"},{tag:[m.angleBracket],color:"#808080"},{tag:m.strong,fontWeight:"bold"},{tag:m.emphasis,fontStyle:"italic"},{tag:m.strikethrough,textDecoration:"line-through"},{tag:[m.meta,m.comment],color:"#6a9955"},{tag:m.link,color:"#6a9955",textDecoration:"underline"},{tag:m.invalid,color:"#ff0000"}];function an(e){var{theme:o="dark",settings:t={},styles:n=[]}=e||{};return bt({theme:o,settings:ut({},rn,t),styles:[...sn,...n]})}var ws=an(),cn=ao;function ln(e){return typeof e=="function"?e:cn}var un=ln,dn=co,fn=un,mn=To,pn=9007199254740991,be=4294967295,gn=Math.min;function hn(e,o){if(e=mn(e),e<1||e>pn)return[];var t=be,n=gn(e,be);o=fn(o),e-=be;for(var r=dn(n,o);++t<e;)o(t);return r}var vn=hn;const Cn=io(vn),xn=e=>u.jsx(L.div,{className:"dark:bg-white-400 aspect-square rounded-full bg-gray-400",animate:{translateY:["0%","-50%","0%","0%","0%"]},style:{translateX:.5,width:3,height:3},transition:{repeat:1/0,type:"keyframes",delay:e/10,duration:.7}},e),En=()=>u.jsx(L.div,{className:"grid h-full max-w-full flex-1 grid-cols-3 items-center gap-[0.4] p-1",children:Cn(3,e=>xn(e))});function yn(e){switch(e){case"dark_gray":return{normal:"text-token-text-secondary dark:text-white-400",hover:"cursor-pointer hover:text-token-text-primary group-hover:text-token-text-primary"};case"light_gray":return{normal:"text-gray-400",hover:"cursor-pointer hover:text-token-text-secondary group-hover:text-token-text-secondary"}}}function Re({children:e,className:o,onClick:t,isClickable:n=!1,theme:r="dark_gray"}){const s=yn(r),a=(t!=null||n)&&s.hover;return u.jsxs("div",{className:A("relative inline-block h-[20px] w-[20px] shrink-0 transition-opacity",o,a,s.normal),onClick:t,children:[e?u.jsx(Go,{className:"h-[20px] w-[20px] shrink-0"}):u.jsx(Vo,{className:"h-[20px] w-[20px] shrink-0"}),u.jsx("span",{className:A("absolute inset-0 flex items-center justify-center text-[8px] font-black",a,s.normal),children:e})]})}function Ce(){return u.jsx(Re,{theme:"light_gray",children:u.jsx(En,{})})}function _n({count:e,isLoading:o,onClick:t}){return o?u.jsx(Ce,{}):u.jsx(Re,{onClick:t,theme:"dark_gray",children:e})}function bn({isLoading:e=!1,onClick:o}){return e?u.jsx(Ce,{}):u.jsx(Re,{isClickable:!0,onClick:o,theme:"light_gray"})}var H=(e=>(e[e.up=-1]="up",e[e.down=1]="down",e))(H||{}),de=(e=>(e.COMMENT="comment",e.COMPOSER="composer",e))(de||{}),w=(e=>(e.COLLAPSED="collapsed",e.EXPANDED="expanded",e))(w||{});const Nt=([e,o],[t,n])=>{const r=e+o,s=t+n;return e<s&&t<r},Se=([e,o])=>e+o,J=e=>{if(e.type===w.COLLAPSED)return[e.offsetY??0,0];const{offsetY:o,shiftY:t=0,height:n=0}=e,r=o+t;return t<0?[r,n+Math.abs(t)]:[r,n]},Nn=(e,o,t)=>{if(!Nt(e,o))return null;const[n,r]=e,s=n+r,[a,i]=o,c=a+i,l=a-s,d=c-n;return t===H.up?l:d};var Tt=(e=>(e.ABOVE="above",e.BELOW="below",e))(Tt||{});function ee(e,o){return te(e.coordsAtPos(o))}const ze=360,Tn=250,Pt=44,Xe=.5,We=[.5,.9,1],Pn=[1,.75,.2],Sn=({onClose:e,onSubmit:o,opensOverDocument:t=!1,opensFromGutter:n=!1,gutterHasComments:r=!1},s)=>{const a=Ae(),i=v.useRef(null),c=v.useRef(!1),[l,d]=v.useState(""),[f,p]=v.useState(!0),g=()=>{d(""),e?.(c.current)},h=(T=l)=>{c.current=!0,o?.(T),d("")},x=lo(({windowWidth:T})=>t?T<ze+100?Tn:ze:le,0),C={};n&&(C.top=-12),t&&n?C.right=0:C.left=0;let E="";n&&!t?E="8px 50%":n&&t?E="calc(100% + 8px) 50%":t&&(E="center left");let y=0;n&&!t&&r&&(y=gt);const k=T=>{const{metaKey:P,shiftKey:S,key:M}=T;M==="Enter"&&l&&!(S||P)?(h(),T.preventDefault()):M==="Escape"&&(d(""),e?.(!1))},_=a.formatMessage({id:"VvfbvY",defaultMessage:"Edit or explain..."});return u.jsx(L.div,{ref:Qo(i,s),className:A("absolute flex items-center",B.commentComposer),style:{...C,minHeight:Pt},transition:{type:"spring",bounce:.18,duration:.48},initial:{translateX:0},animate:{translateX:y},exit:{translateX:0},children:u.jsx(L.div,{className:A("no-scrollbar relative z-10 flex items-center overflow-x-hidden border border-token-border-light",pt,{"rounded-full":f,"rounded-2xl":!f}),initial:{width:t?le:24,scaleX:t?Xe:void 0,scale:t?void 0:Xe},animate:{width:x,scaleX:t?We:void 0,scale:t?void 0:We},exit:{filter:"blur(16px)",scale:t?void 0:Pn,width:t?le:24,opacity:t?0:[1,1,0]},transition:{type:"spring",bounce:t?.14:0,duration:.28,scale:{type:"tween",duration:.2},opacity:{type:"tween",time:[0,.95,1]}},style:{transformOrigin:E},children:u.jsxs(L.div,{className:"relative z-0 flex w-full items-center bg-token-main-surface-primary px-4 py-2.5",children:[u.jsx(L.div,{className:"backdrop-saturate-25 absolute inset-0 z-[-1] bg-gray-50/75 backdrop-blur-3xl dark:bg-gray-700/75",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.2}}),u.jsx(Jo,{"aria-placeholder":_,value:l,className:"w-full resize-none border-0 bg-transparent px-1 py-0 pr-2 text-token-text-primary outline-0 placeholder:text-token-text-secondary focus:ring-0 focus-visible:ring-0",autoFocus:!0,maxRows:4,onBlur:g,onHeightChange:(T,{rowHeight:P})=>{p(Math.floor(T/P)<=1)},onChange:({target:{value:T}})=>d(T),onKeyDown:k}),!l&&u.jsx("span",{"aria-hidden":!0,className:"absolute inline-block text-nowrap pl-1 text-token-text-secondary",children:_}),u.jsx(L.button,{className:A("-mr-1.5 h-6 w-6 rounded-full bg-black text-center dark:bg-white",{"self-end":!f}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},onMouseDown:()=>h(),children:u.jsx(Fo,{className:"h-6 w-6 text-white dark:text-black"})})]})})})},St=v.forwardRef(Sn),kn=(e,o)=>{if(o?.type!==$.SELECTION)return null;try{const{from:t,to:n}=o,{top:r}=e.dom.getBoundingClientRect(),{bottom:s,top:a}=ee(e,t),{bottom:i}=ee(e,n),c=ge(e)?-30:-24;let l=s-r+c;const d=a-r;return l=i-r+8,{composerTop:l,loadingTop:d}}catch(t){return D.logError("Invalid position in SelectionCommentComposer",t),null}},In=({toolbarPosition:e,composerRect:o,view:t})=>{let{width:n,height:r}=o;if(r||=Pt,t==null||e==null)return null;const{right:s,left:a}=t.dom.getBoundingClientRect(),{left:i,top:c,aboveOrBelow:l,toolbarSize:d}=e,f=c-(l===Tt.ABOVE&&r!==0?r-d.height:0),p=Eo(t)?12:0;return{left:Math.min(i,s-a-n-p),composerTop:f,aboveOrBelow:l}},Mn=({toolbarPosition:e,commentingOn:o,isWaitingForCommentResponse:t=!1,onAddComment:n})=>{const r=re()(),[s,a]=ve(),i=In({view:r,toolbarPosition:e,composerRect:s});if(r==null||i==null)return null;const{left:c,composerTop:l}=i,d=f=>{if(o?.type!==$.SELECTION)return;const{action:p,sourceRange:g}=o;n?.(f,p,g,o.type)};return u.jsx(X,{children:o?.type===$.SELECTION&&!t&&u.jsx("div",{className:A("absolute",B.commentComposer),style:{left:c,top:l},children:u.jsx(St,{opensOverDocument:!0,onClose:f=>{f||(O.cancelCommentingOn(),r&&ge(r)&&!r.state.selection.empty&&r.dispatch(r.state.tr.setSelection(new Uo(r.state.selection.$from))),document.getSelection()?.removeAllRanges())},onSubmit:d,ref:a})},"composer")})};function kt(e,o){return o?e.getState(o)??null:null}function An(e){return e.nodeSize-2}function Rn(e,o){return o>=0&&o<=An(e)}class U{constructor(o,t,n={}){this.match=o,this.match=o,this.handler=typeof t=="string"?wn(t):t,this.undoable=n.undoable!==!1,this.inCode=n.inCode||!1}}function wn(e){return function(o,t,n,r){let s=e;if(t[1]){let a=t[0].lastIndexOf(t[1]);s+=t[0].slice(a+t[1].length),n+=a;let i=n-r;i>0&&(s=t[0].slice(a-i,a)+s,n=r)}return o.tr.insertText(s,n,r)}}const On=500;function Os({rules:e}){let o=new Et({state:{init(){return null},apply(t,n){let r=t.getMeta(this);return r||(t.selectionSet||t.docChanged?null:n)}},props:{handleTextInput(t,n,r,s){return qe(t,n,r,s,e,o)},handleDOMEvents:{compositionend:t=>{setTimeout(()=>{let{$cursor:n}=t.state.selection;n&&qe(t,n.pos,n.pos,"",e,o)})}}},isInputRules:!0});return o}function qe(e,o,t,n,r,s){if(e.composing)return!1;let a=e.state,i=a.doc.resolve(o),c=i.parent.textBetween(Math.max(0,i.parentOffset-On),i.parentOffset,null,"￼")+n;for(let l=0;l<r.length;l++){let d=r[l];if(i.parent.type.spec.code){if(!d.inCode)continue}else if(d.inCode==="only")continue;let f=d.match.exec(c),p=f&&d.handler(a,f,o-(f[0].length-n.length),t);if(p)return d.undoable&&p.setMeta(s,{transform:p,from:o,to:t,text:n}),e.dispatch(p),!0}return!1}new U(/--$/,"—");new U(/\.\.\.$/,"…");new U(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“");new U(/"$/,"”");new U(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘");new U(/'$/,"’");function Ls(e,o,t=null,n){return new U(e,(r,s,a,i)=>{let c=t instanceof Function?t(s):t,l=r.tr.delete(a,i),d=l.doc.resolve(a),f=d.blockRange(),p=f&&Ko(f,o,c);if(!p)return null;l.wrap(f,p);let g=l.doc.resolve(a-1).nodeBefore;return g&&g.type==o&&zo(l.doc,a-1)&&(!n||n(s,g))&&l.join(a-1),l})}function Ln(e,o,t=null){return new U(e,(n,r,s,a)=>{let i=n.doc.resolve(s),c=t instanceof Function?t(r):t;return i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),o)?n.tr.delete(s,a).setBlockType(s,s,o,c):null})}function we(e,o,t,n={}){if(e==null)return null;const r=(Array.isArray(t)?t:[t]).filter(Ct),s=o.nodes[e].createAndFill(n,r);return s??null}const Dn={content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},jn="paragraph";class It extends he{unistNodeName(){return jn}static proseMirrorNodeName(){return"paragraph"}proseMirrorNodeSpec(){return Dn}unistNodeToProseMirrorNodes({schema:o,convertedChildren:t,attrs:n}){return we(this.proseMirrorNodeName(),o,t,n)}proseMirrorNodeToUnistNodes(o,t){return[{type:this.unistNodeName(),children:t}]}}const Bn=(e,o,t,n)=>e.value?o.text(e.value,[o.marks.startend.create(t),...n??[]]):null;class ne extends he{unistNodeName(){return"text"}static proseMirrorNodeName(){return"text"}proseMirrorNodeSpec(){return{group:"inline"}}unistNodeToProseMirrorNodes({node:o,schema:t,attrs:n}){return Bn(o,t,n)}proseMirrorNodeToUnistNodes(o){return[{type:this.unistNodeName(),value:o.text??""}]}}class q extends he{static isAtStart(o,t){return o.selection.empty?t!==void 0?t.endOfTextblock("backward",o):o.selection.$anchor.parentOffset>0:!1}static headingLevelCommandBuilder(o,t,n){return(r,s,a)=>{if(n&&!q.isAtStart(r,a))return!1;const{$anchor:i}=r.selection,c=i.parent;if(c.type.name!=="heading")return!1;const l=c.attrs.level+t;if(l<0||l>6)return!1;if(s===void 0)return!0;const d=i.before(i.depth);return l>0?s(r.tr.setNodeMarkup(d,void 0,{level:l})):s(r.tr.setNodeMarkup(d,o.nodes.paragraph)),!0}}dependencies(){return[new It,new ne]}unistNodeName(){return"heading"}static proseMirrorNodeName(){return"heading"}proseMirrorNodeSpec(){return{attrs:{level:{default:1}},content:"text*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(o){return["h"+o.attrs.level.toString(),0]}}}proseMirrorInputRules(o){return[Ln(/^\s{0,3}(#{1,6})\s$/,o.nodes[this.proseMirrorNodeName()],t=>({level:t[1].length}))]}proseMirrorKeymap(o){const t={Tab:q.headingLevelCommandBuilder(o,1,!1),"#":q.headingLevelCommandBuilder(o,1,!0),"Shift-Tab":q.headingLevelCommandBuilder(o,-1,!1)};for(let n=1;n<=6;n++)t[`Shift-Mod-${n.toString()}`]=$o(o.nodes[this.proseMirrorNodeName()],{level:n});return t}unistNodeToProseMirrorNodes({node:o,schema:t,convertedChildren:n,attrs:r}){const{depth:s}=o;return we(this.proseMirrorNodeName(),t,n,{...r,level:s})}proseMirrorNodeToUnistNodes(o,t){return[{type:this.unistNodeName(),depth:o.attrs.level,children:t}]}}const Je=(e,o,t)=>{const n=t==="min"?0:o.length-1;for(let r=n;t==="min"?r<o.length:r>=0;t==="min"?r++:r--){const{sourcePos:s,pmPos:a}=o[r];if(s===e)return a;if(t==="min"&&s>e||t==="max"&&s<e)return t==="min"?o[r-1]?.pmPos??a:a}return null};class Gn extends he{unistNodeName(){return"root"}static proseMirrorNodeName(){return"doc"}proseMirrorNodeSpec(){return{content:"block+"}}unistNodeToProseMirrorNodes({schema:o,convertedChildren:t,attrs:n}){return we(this.proseMirrorNodeName(),o,t,n)}proseMirrorNodeToUnistNodes(o,t){return[{type:this.unistNodeName(),children:t}]}}const Ze=(e,o)=>{if(!o)return!1;const[t,n]=o;return e>=t&&e<n},Mt=(e,o)=>e.pmPos-o.pmPos,Qe=(e,o)=>{const t=o[o.length-1].sourcePos;return Math.min(Math.max(e,0),t)},et=(e,o)=>{const t=oe(o)?.sourcePos??0;return Math.min(Math.max(e,0),t)},tt=({positions:e,sourcePos:o,sourceEndPos:t})=>{const n=[];for(let r=0;r<e.length;r++){const s=e[r],{sourcePos:a,leafSourceRange:i,isClose:c=!1}=s;if(t!=null&&a>t)break;const l=e[r+1]??null,d=f=>{let p=e[f];if(p==null)return f;let g=e[f+1],{leafSourceRange:h}=p;for(;p.nodeTypeName!==ne.proseMirrorNodeName()&&!p.isClose&&g!=null&&!Ze(o,h);)n.push(g),p=g,g=e[f+2],h=p.leafSourceRange,f++;return f};if(a===o&&!c||Ze(o,i))n.push(s),r=d(r);else if(a<=o&&(l?.sourcePos??Number.POSITIVE_INFINITY)>=o){let f=r+1;const p=[];for(;e[f]?.isClose===!0;)p.push(f),f++;if(e[f]){const{sourcePos:g}=e[f];do n.push(e[f]);while(e[++f].sourcePos===g);f=d(f-1)}else{(a===o||c)&&n.push(s);for(const g of p)n.push(e[g])}r=f}}return n.sort(Mt)},ot=({positions:e,sourcePos:o})=>{const t=[],n=r=>{r&&t.push(r)};for(let r=0;r<e.length;r++){const s=e[r],{sourcePos:a}=s;if(o==null||a>o)break;const i=e[r-1]??null,c=e[r+1]??null,l=o>a&&o<(c?.sourcePos??-1),d=s.nodeTypeName===ne.proseMirrorNodeName();if(a===o||l&&!d){if(s.isClose&&!i?.isClose&&s.nodeTypeName===i?.nodeTypeName||!s.isClose&&c.isClose&&s.nodeTypeName===c.nodeTypeName||s.isClose&&i?.isClose||!s.isClose&&i!=null&&i?.nodeTypeName!==ne.proseMirrorNodeName()){n(i);let h=r-2,x=e[h];for(;h>=0&&x.isClose;)n(x),x=e[--h]}let f=r,p=s,g=p;do n(p),g=p,p=e[++f];while(p?.sourcePos===o||p?.depth<g?.depth);break}else if(l&&d){let f=r+1,p=e[f];for(;p?.isClose;)n(p),p=e[++f];break}}return t.sort(Mt)},Vn=e=>{const o=new So(ko.GetPositionTransformer,{debug:!1});o.startBlock("get_positition_transformer");const t=new Map;e.descendants((s,a)=>{const i=Ye(s);if(!i)return;const{start:c,end:l}=i,d=s.type.name,{depth:f}=e.resolve(a);if(t.set(a,{pmPos:a,sourcePos:c,leafSourceRange:s.isBlock?void 0:[c,l],depth:f,nodeTypeName:d,isClose:!1,parentNodeTypeNameStack:[]}),s.isBlock){const p=a+s.nodeSize-1;t.set(p,{pmPos:p,sourcePos:l,depth:e.resolve(p).depth,nodeTypeName:d,isClose:!0,parentNodeTypeNameStack:[]})}if(s.isText)for(let p=0;p<(s.text?.length??0);p++){const g=a+p;t.set(g,{pmPos:g,sourcePos:c+p,depth:f,nodeTypeName:d,isClose:!1,parentNodeTypeNameStack:[]})}}),t.set(e.content.size,{pmPos:e.content.size,nodeTypeName:e.type.name,depth:0,isClose:!0,sourcePos:te(Ye(e)).end,parentNodeTypeNameStack:[]});const n=Array.from(t.entries()).sort(([s],[a])=>s-a).map(([,s])=>s),r=[Gn.proseMirrorNodeName()];for(const s of n)s.isClose?(s.parentNodeTypeNameStack=r.concat(),r.pop()):(s.parentNodeTypeNameStack=r.concat(),s.nodeTypeName!==ne.proseMirrorNodeName()&&oe(r)!==s.nodeTypeName&&r.push(s.nodeTypeName));return o.endBlock("get_positition_transformer"),{positions:n,pmRangeToSourceRange:({start:s,end:a})=>({start:n[Math.max(s,0)].sourcePos,end:n[Math.min(a,n.length-1)].sourcePos}),sourceStartToPmPos:s=>tt({sourcePos:Qe(s,n),positions:n,sourceEndPos:null}),sourceEndToPmPos:s=>ot({sourcePos:et(s,n),positions:n}),sourceRangeToPmRange:s=>{o.startBlock("source_range_to_pm_range");const{start:a,end:i}=s,c=et(i,n),l=tt({sourcePos:Qe(a,n),sourceEndPos:c,positions:n}),d=ot({sourcePos:c,positions:n});return o.endBlock("source_range_to_pm_range"),{start:l,end:d}}}},Fn=Po(Vn);function Hn(e,o){const t=Un(e);if(t.length===0)return o;let n=o;return t.forEach(r=>{n=Yn(r,n)}),n}function Yn(e,o){return yo(o,{start:e.from,end:e.to},$n(e))}function $n(e){return e.slice.size-(e.to-e.from)}function Un(e){return e.steps.filter(o=>o instanceof Xo)}const fe=new Wo("comments");function nt(e,o){const{sourceRangeToPmRange:t}=Fn(e),n=o.map(({id:r,at:s})=>{const{start:a,end:i}=t(s),c=Je(s.start,a,"max"),l=Je(s.end,i,"min");return l==null||c==null?null:[r,{start:c,end:l}]}).filter(Ct);return new Map(n)}function Kn(e,o){const{type:t}=o;if(t===$.SELECTION){const{from:s,to:a}=o;return[s,a]}const{pos:n}=o,r=n+(e.nodeAt(n)?.nodeSize??0);return[n,r]}const rt=(e,o,t=null,n=null)=>{const r=[],s=Array.from(o.entries()).reverse(),a=new Map(e.map(i=>[i.id,i]));for(const[i,c]of s){const l=a.get(i),p=bo({isHovered:t===i,isFocused:n===i,isCode:!1,diffStatus:l?.diffStatus});r.push(yt.inline(c.start,c.end,{class:p,"data-comment-id":i,nodeName:"span"}))}return r},Ds=e=>new Et({key:fe,state:{init:(o,{doc:t})=>{const n=nt(t,e);return{comments:e,commentingOn:null,hoveredOnBlock:null,hoveredCommentId:null,focusedCommentId:null,decorations:rt(e,n),positions:n}},apply:(o,t)=>{const n=o.getMeta(fe)??{},r=n.comments,s=r??t.comments,a=r!=null?nt(o.doc,s):t.positions;let i=n.commentingOn;i===void 0&&(i=t.commentingOn);let c=n.hoveredCommentId;c===void 0&&(c=t.hoveredCommentId);let l=n.focusedCommentId;l===void 0&&(l=t.focusedCommentId);const d=Hn(o,a),f=_o(s,d);return{comments:f,commentingOn:i,hoveredCommentId:c,focusedCommentId:l,decorations:rt(f,d,c,l),positions:d}}},props:{handleClickOn:(o,t,n,r,s)=>{const{target:a}=s;if(a instanceof HTMLElement){const{commentId:i}=a.dataset;if(!i)return;O.focusComment(i)}},handleDOMEvents:{mouseover(o,t){const{target:n}=t;if(n instanceof HTMLElement){const{commentId:r}=n.dataset;r?O.mouseEnterComment(r):O.mouseLeaveComment()}}},decorations(o){const t=this.getState(o);if(!t)return Ue.empty;const{commentingOn:n,decorations:r}=t,{doc:s}=o;if(n){const[a,i]=Kn(s,n);a!=null&&i!=null&&r.push(yt.inline(a,i,{class:mo.document},{comment:{pattern:n}}))}return Ue.create(s,r.concat())}}});function zn(e,o,t){const n=e+o;for(const r of t.values()){const s=r.start,a=r.end;if(e<a&&s<n)return!0}return!1}const Xn=50,Wn=200,qn=[It.proseMirrorNodeName(),q.proseMirrorNodeName()],Jn=e=>e?e.isBlock:!1,Zn=e=>{if(!e)return!1;const{isBlock:o,type:{name:t}}=e;return o&&qn.includes(t)},Qn=(e,o,t,n)=>{const r=e.posAtCoords({left:o,top:t});if(r==null)return;const{pos:s,inside:a}=r;if(a===-1)return;const{state:i}=e;let c=s,l=i.doc.nodeAt(c);for(;!Jn(l)&&c>=0;)c--,l=i.doc.nodeAt(c);if(!l||!Zn(l))return;const d=n!=null&&zn(c,l.nodeSize,n);return{node:l,nodeHasComment:d,pos:c}};function er(e,o,t){const n=Qn(e,o.x,o.y,t);if(n==null)return null;const{node:r,pos:s,nodeHasComment:a}=n,{top:i}=e.coordsAtPos(0);function c(){const g=s+1;return Rn(e.state.doc,g)&&e.state.doc.nodeAt(g)?.isText?e.coordsAtPos(g).top:e.coordsAtPos(s).top}const l=c(),d=l-i;return{height:e.coordsAtPos(s+r.nodeSize-1).bottom-l,nodeHasComment:a,mouseEnteredAt:Date.now(),yOffset:d,pos:s}}function tr(e){const o=v.useRef(!1),t=v.useRef(!1),[n,r]=v.useState(null),s=No(),a=s()?.dom,i=v.useRef(!1),c=V(({visibleBlockCommentLauncher_DEBUG_ONLY:f})=>f),l=v.useCallback(xt(f=>{o.current=!0;const{commentingOn:p}=V.getState();if(t.current||p!=null)return;const g=s();if(g==null||!o.current)return r(null);const{dom:h,state:x}=g,C=kt(fe,x)?.positions;if(C==null)return r(null);const E=er(g,f,C);if(E==null||E.nodeHasComment&&e===j.COLLAPSED){r(null);return}if(i.current&&E.yOffset!==n?.yOffset){r(null);return}const y=g.coordsAtPos(0),k=h.getBoundingClientRect().width,T=(f.x-y.left)/k>=Xn/100;r(T?E:null)},Wn),[s,i,n]);v.useEffect(()=>{if(a!=null)return dt(a,{mouseenter:()=>{o.current=!0,t.current=!1},mouseleave:({relatedTarget:f})=>{if(l.cancel(),f instanceof HTMLElement&&f.closest("[data-block-comment-launcher]")){t.current=!0;return}t.current=!1,o.current=!1,V.getState().commentingOn==null&&r(null)},mousemove:l})},[s,a,e,l]);const d=v.useCallback(({relatedTarget:f})=>{const{commentingOn:p}=V.getState();p==null&&f!==a&&(t.current=!1,r(null))},[a]);return{visibleBlockComment:c??n,handleMouseLeave:d,onComposerVisibleChange:f=>{i.current=f}}}const or=({isWaitingForCommentResponse:e=!1,opensOverDocument:o=!1,hasComments:t=!1,activeBlockComment:n,composerRef:r,onLaunchComposer:s,onMouseLeave:a,onSubmit:i})=>{const[c,l]=v.useState(!1),{yOffset:d,height:f,pos:p}=n,g=()=>{l(!0),s?.(),D.logButtonClick(W.BLOCK_COMMENT_LAUNCHER),O.startCommentingOn({type:$.BLOCK,pos:p})},h=E=>{E||(l(!1),O.cancelCommentingOn())},x=E=>{l(!1),i?.(E)};v.useEffect(()=>()=>{O.mouseLeaveBlock()},[]);const C=t&&c?o?-88:88:0;return u.jsx(L.div,{className:A("pointer-events-auto absolute flex h-6 w-5 origin-[14px_50%] items-start after:absolute after:-inset-4 after:content-['']",B.commentComposer),initial:!1,animate:{opacity:1},exit:{opacity:0},transition:{type:"spring",duration:.2,bounce:.1},style:{top:0,height:f,translateY:d},onMouseLeave:a,"data-block-comment-launcher":!0,children:u.jsxs(X,{children:[c?u.jsx(St,{ref:r,opensFromGutter:!0,onClose:h,onSubmit:x,gutterHasComments:t,opensOverDocument:o},"composer"):null,u.jsx(L.button,{initial:{opacity:0},animate:{opacity:c?0:1,translateX:C},transition:{duration:.15,translateX:{type:"spring",bounce:.18,duration:.48}},className:"group absolute z-10 flex h-6 gap-1 bg-transparent after:absolute after:-inset-y-4 after:-left-1 after:-right-4 after:content-['']",onClick:g,onMouseEnter:()=>O.mouseEnterBlock(p),onMouseLeave:()=>O.mouseLeaveBlock(),disabled:c||e,children:u.jsx(bn,{isLoading:e})},"launcer")]})})},nr=({isWaitingForCommentResponse:e=!1,isRequestActive:o=!1,hasComments:t=!1,composerRef:n,gutterMode:r,onAddComment:s})=>{const a=ht(),{visibleBlockComment:i,handleMouseLeave:c,onComposerVisibleChange:l}=tr(r),d=f=>{if(!i||!a)return;const{doc:p}=a,{pos:g}=i,h=p.nodeAt(g);if(!h)return;const{attrs:{start:x,end:C}}=h;s?.(f,vt.ASK,{start:x,end:C},$.BLOCK)};return u.jsx(X,{onExitComplete:()=>l(!1),children:i&&a&&(e||!o)&&u.jsx(or,{composerRef:n,isWaitingForCommentResponse:e,opensOverDocument:r===j.COLLAPSED,activeBlockComment:i,hasComments:t,onSubmit:d,onMouseLeave:c,onLaunchComposer:()=>l(!0)},"launcher")})},At={type:"spring",bounce:.12,duration:.5},Rt="opacity-50",rr=({count:e,offsetY:o,isLoading:t=!1,onClick:n})=>u.jsx(L.div,{className:A("absolute",B.collapsedComment),initial:{opacity:0},animate:{opacity:1},style:{translateY:o},transition:At,exit:{opacity:0},children:u.jsx(_n,{count:e,isLoading:t,onClick:n})}),sr=({isFocused:e,isHovered:o})=>{const t=e||o?"grow font-medium text-token-text-primary transition-colors":"grow font-medium text-token-text-secondary transition-colors",n=e||o?"opacity-100 transition":"opacity-75 transition";return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:n,children:u.jsx("div",{className:"gizmo-bot-avatar rounded-full",children:u.jsx(Io,{size:"gizmoConversation",iconName:"openai"})})}),u.jsx("span",{className:t,children:"ChatGPT"})]})},ar=({comment:e,isFocused:o,isSomeCommentFocused:t,isHovered:n})=>{const r=e.diffStatus===Pe.REMOVED;return u.jsx("div",{className:A("mt-2 text-token-text-primary transition-all",{"opacity-80":!o&&!t&&!n&&!r,"opacity-40":!o&&t&&!n&&!r,[Rt]:r}),children:e.content})},ir=({left:e,right:o,comment:t,disableAnimations:n=!1,onClick:r,onMouseEnter:s,onMouseLeave:a,onAccept:i,onDismiss:c,translateY:l,isFocused:d=!1,isSomeCommentFocused:f=!1,disableActions:p=!1,isHovered:g=!1},h)=>{const[x,C]=v.useState(!1),E=t.diffStatus===Pe.ADDED,y=t.diffStatus===Pe.REMOVED,k=t.diffStatus!=null,_=()=>{C(!0),s?.()},T=()=>{C(!1),a?.()},P=Ae(),S=d||x&&!f;return u.jsx(L.div,{ref:h,className:A("absolute",B.expandedComment,{"cursor-default":d,"cursor-pointer":!d,[B.expandedCommentFocused]:d,[B.expandedCommentHovered]:g}),style:{left:e,right:o},initial:n?!1:{translateY:l,scale:.85,opacity:0},animate:n?void 0:{translateY:l,scale:d?1:.97,opacity:1},exit:n?void 0:{scale:.85,opacity:0,filter:"blur(16px)"},transition:At,onClick:r,onMouseEnter:p?void 0:_,onMouseLeave:p?void 0:T,"data-comment-id":t.id,children:u.jsxs("div",{className:A("flex min-h-8 flex-col overflow-hidden rounded-2xl border p-4 pt-2 text-left text-sm transition-all",{"border-transparent bg-gray-50 dark:bg-gray-800":!d&&!g,"border-token-border-light bg-token-main-surface-primary":g&&!d,"border-token-border-light bg-token-main-surface-primary shadow-xl":d||x&&!f,"relative after:absolute after:bottom-0 after:left-0 after:top-0 after:w-1":k,"after:bg-green-500":E,"after:bg-red-500":y}),style:{width:le},children:[u.jsxs("div",{className:A("flex h-8 flex-row items-center gap-2.5",{[Rt]:y}),children:[u.jsx(sr,{isFocused:d,isHovered:g}),u.jsx("button",{className:A("-mr-1 rounded-full bg-transparent p-1 text-token-text-secondary",{"cursor-pointer hover:bg-gray-100 hover:text-token-text-primary dark:hover:bg-gray-700":!p,"cursor-not-allowed":p}),onClick:c,disabled:p,"aria-label":P.formatMessage({id:"fYDa3C",defaultMessage:"Dismiss comment"}),children:u.jsx(Ho,{className:"icon-sm"})})]}),u.jsx(ar,{comment:t,isFocused:d,isHovered:g,isSomeCommentFocused:f}),u.jsx(X,{initial:!1,children:S&&u.jsx(L.div,{initial:n?!1:{opacity:0,height:0},animate:{opacity:1,height:"auto",transition:{opacity:{delay:.14,duration:.2},height:{bounce:0,duration:.2}}},exit:n?void 0:{opacity:0,height:0,transition:{opacity:{duration:.08},height:{bounce:0,duration:.2}}},className:"flex items-center justify-start",children:u.jsx("div",{className:"mt-2.5",children:u.jsx(uo,{color:"secondary",onClick:i,disabled:p,children:P.formatMessage({id:"WIW5OL",defaultMessage:"Apply"})})})})})]})})},wt=v.forwardRef(ir),cr=({offsetY:e,opensOverDocument:o=!1,disableActions:t=!1,isFocused:n=!1,isSomeCommentFocused:r=!1,onAccept:s,onClick:a,onDismiss:i,onMouseEnter:c,onMouseLeave:l,comment:d,isHovered:f=!1})=>{const p=v.useRef(null);return v.useEffect(()=>dt(document,{mousedown:({target:g})=>{g instanceof HTMLElement&&!g.closest("[data-comment-id]")&&!p.current?.contains(g)&&O.blurComment()}})),u.jsx(wt,{ref:p,comment:d,disableActions:t,onAccept:s,onDismiss:i,onMouseEnter:c,onMouseLeave:l,isSomeCommentFocused:r,isHovered:f,onClick:a,translateY:e,isFocused:n,left:o?void 0:gt,right:o?po:void 0})},lr=({onAcceptComment:e,onDismissComment:o,disableActions:t=!1,entry:n,isGutterCollapsed:r=!1,isHovered:s=!1,isFocused:a=!1,isSomeCommentFocused:i=!1})=>{const{offsetY:c,type:l}=n,[d,f]=Mo();let p=null;if(l===w.COLLAPSED)p=!a&&u.jsx(rr,{offsetY:c,count:n.count,onClick:()=>{D.logButtonClick(W.COLLAPSED_COMMENT),O.focusComment(n.children[0])}},"collapsed");else{const{comment:g}=n;if(g==null||g.content===""||g.status===$e.DISMISSED)p=null;else if(g.status===$e.ACCEPT_INITIATED)p=u.jsx("div",{className:"absolute",style:{top:c},children:u.jsx(Ce,{})},"loading");else{const{id:h}=g;p=u.jsx(cr,{isSomeCommentFocused:i,isHovered:s,isFocused:a,offsetY:c,disableActions:t,onClick:()=>{D.logButtonClick(W.EXPANDED_COMMENT),O.focusComment(h)},onMouseEnter:()=>O.mouseEnterComment(h),onMouseLeave:()=>O.mouseLeaveComment(),comment:g,onAccept:()=>{D.logButtonClick(W.COMMENT_ACCEPT,{commentId:h}),e?.(h)},onDismiss:()=>{D.logButtonClick(W.COMMENT_DISMISS,{commentId:h}),o?.(h)},opensOverDocument:r},"expanded")}}return u.jsx(X,{onExitComplete:()=>f?.(),children:d&&p})},st=({onMeasureHeight:e,comment:o,isFocused:t=!1})=>{const[{height:n},r]=ve();return ft(()=>{e?.(n)},[n]),u.jsx(wt,{ref:r,comment:o,isFocused:t,disableAnimations:!0})},ur=({comments:e,onMeasure:o,getStableCommentId:t})=>{const n=v.useRef(new Map),r=v.useRef(new Map),s=v.useRef(null),a=(i,c,l=!1)=>{c&&(l?r.current.set(t(i),c):n.current.set(t(i),c),s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{o?.({focusedHeights:new Map(r.current),heights:new Map(n.current)}),s.current=null}))};return e?.length?u.jsxs("div",{className:"pointer-events-none invisible fixed left-0 top-0 overflow-clip","aria-hidden":"true",children:[e.map(i=>u.jsx(st,{comment:i,onMeasureHeight:c=>a(i.id,c)},t(i.id))),e.map(i=>u.jsx(st,{isFocused:!0,comment:i,onMeasureHeight:c=>a(i.id,c,!0)},`${t(i.id)}-focused`))]}):null},at=(e,o,t)=>{let n=t+o;for(;o===H.down?n<e.length:n>-1;){const r=e[n],s=e[n-o],a=Nn(J(r),J(s),o);if(a!=null&&r.type!==w.COLLAPSED)r.shiftY+=a;else break;n+=o}},it=(e,o)=>{for(const t of o){const{index:n,amount:r}=t,s=e[n];s.type===w.EXPANDED&&(s.shiftY+=r),at(e,H.down,n),at(e,H.up,n);for(const a of e)a.type!==w.COLLAPSED&&(a.offsetY+=a.shiftY,a.shiftY=0)}},dr=(e,o)=>{const t=[],[n,r]=o,s=n+r;for(let a=0;a<e.length;a++){const i=e[a],[c]=J(i),l=[c,i.type===w.EXPANDED?i.height:0],[d,f]=l;if(Nt(l,o)){const p=d+f,g=n-p,h=s-d,C=(Math.abs(g)<Math.abs(h)?H.up:H.down)===H.up?g:h;t.push({index:a,amount:C})}}return t},fr=({gutterMode:e,focusedCommentId:o,gutterPositions:t,getCommentKey:n,getComment:r})=>{if(!t?.size)return[];const s=new Map,a=[];let i=null,c=-1;for(const d of t.values()){if(d.type===de.COMPOSER){i=[d.offsetY,d.height];continue}const{commentId:f,height:p,collapsedOffsetY:g,offsetY:h}=d;if(e===j.EXPANDED){const E=oe(a),y=E?Se(J(E)):0;let k=h;E&&k<=y&&(k=y),s.set(f,{originalOffsetY:h,offsetY:k}),o===f&&(c=a.length),a.push({key:n(f),comment:r(f),type:w.EXPANDED,height:p,offsetY:k,shiftY:0});continue}let x=a.findIndex(({offsetY:E,type:y})=>y===w.COLLAPSED&&E===g),C=a[x]??null;if(!C)C={key:a.length,type:w.COLLAPSED,offsetY:h,count:1,children:[f]},x=a.length,a.push(C);else{if(C.type!==w.COLLAPSED)throw new Error("Collapsed parent type expected to be collapsed");C.count+=1,C.children.push(f),C.offsetY=g}o===f&&(c=x)}const l=a[c];if(e===j.COLLAPSED&&l?.type===w.COLLAPSED){const d=[];for(let f=0;f<l.children.length;f++){const p=l.children[f];p===o&&(c+=f+1);const g=oe(d),h=g?Se(J(g)):0,x=t.get(p)?.offsetY??0,C=Math.max(h,x);s.set(p,{originalOffsetY:x,offsetY:C}),d.push({type:w.EXPANDED,key:n(p),comment:r(p),offsetY:C,height:t.get(p)?.height??0,shiftY:0})}a.splice(c,0,...d)}if(o){const d=s.get(o);if(!d)return a;const{offsetY:f,originalOffsetY:p}=d,g=p-f,h=[{amount:g,index:c}];let x=c+1;for(;x<a.length;){const C=a[x],{type:E}=C;let y=g;if(E===w.EXPANDED&&C.comment?.id){const{offsetY:k,originalOffsetY:_}=te(s.get(C.comment.id));if(k===_)break;y=Math.max(_-k,g)}else break;h.push({amount:y,index:x}),x++}h.length&&it(a,h)}else if(e!==j.COLLAPSED&&i){const d=dr(a,i);it(a,d)}return a},mr=e=>{try{return fr(e)}catch(o){return D.logError("Generating comment gutter entries",o),[]}},pr=e=>"length"in e?e.length===0:e.nodeSize===0,Ne=12,gr=({composerHeight:e,getCommentHeight:o,getCollapsedStartPos:t,commentingOn:n,commentPositions:r,view:s})=>{if(!r||!s||pr(s.state.doc))return null;const{top:a}=s.dom.getBoundingClientRect(),i=Array.from(r.entries()).sort(([l,d],[f,p])=>d.start-p.start),c=new Map;for(const[l,{start:d}]of i)try{const f=t?.(d)??d,{top:p}=ee(s,f),{top:g}=ee(s,d),h=g-a,x=p-a,C=(o(l)??0)+Ne;c.set(l,{commentId:l,height:C,collapsedOffsetY:x,offsetY:h,type:de.COMMENT})}catch{continue}if(n?.type===$.BLOCK){const{pos:l}=n;try{const{top:d}=ee(s,l),p=d-a-Ne;c.set("block-composer",{type:de.COMPOSER,height:(e??0)+Ne,offsetY:p})}catch{}}return c},Ot=(e,o)=>o.nodeAt(e)?.isBlock?e+1:Ot(e-1,o);function hr(e){const o=ht(),n=re()?.();if(!n)return null;if(ge(n)){if(!o)return null;const r=kt(fe,o);return r?r.positions:null}return new Map(e.map(r=>[r.id,r.at]))}const vr=({gutterMode:e,focusedCommentId:o,commentingOn:t,comments:n,getStableId:r})=>{const[{height:s},a]=ve(),i=re(),[c,l]=v.useState(()=>new Map),[d,f]=v.useState(()=>new Map),p=v.useCallback(({focusedHeights:_,heights:T})=>{l(_),f(T)},[]),g=_=>{const T=r(_);return _===o?c.get(T)??0:d.get(T)??0},h=i(),x=h!=null&&ge(h)?_=>Ot(_,h.state.doc):void 0,C=new Map(n?.map(_=>[r(_.id),_])),E=hr(n),y=gr({composerHeight:s,commentingOn:t,getCommentHeight:g,getCollapsedStartPos:x,commentPositions:E,view:h}),k=mr({gutterMode:e,gutterPositions:y,focusedCommentId:o,getComment:_=>C.get(r(_))??null,getCommentKey:r});return{blockComposerRef:a,onMeasureComments:p,gutterEntries:k}};function Cr(){const o=re()(),t=V(({commentingOn:s})=>s),r=o==null?null:kn(o,t);return r==null?null:u.jsx(L.div,{className:"absolute",style:{top:r.loadingTop},initial:!1,animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{delay:.2},children:u.jsx(Ce,{})},"selection-loading")}const xr=e=>u.jsx("div",{className:"absolute",style:{top:Se(J(e))},children:u.jsx("div",{className:"h-[max(3rem,18vh)] w-1"})}),js=({availableWidth:e,comments:o,commentsMode:t,disableBlockComments:n=!1,isRequestActive:r=!1,isWaitingForCommentResponse:s=!1,onAddComment:a,onAcceptComment:i,onDismissComment:c,getStableCommentId:l})=>{const d=V(({focusedCommentId:S})=>S),f=V(({hoveredCommentId:S})=>S),p=V(({commentingOn:S})=>S),g=e<Fe?j.COLLAPSED:j.EXPANDED,{onMeasureComments:h,blockComposerRef:x,gutterEntries:C}=vr({comments:o,getStableId:l,gutterMode:g,focusedCommentId:d,commentingOn:p}),E=C.length>0,y=p!=null&&!s&&p.type!=="selection"||E,_=(()=>{if(!y)return 0;switch(g){case j.COLLAPSED:return 0;case j.EXPANDED:return Fe}})(),T=p?.type==="selection",P=oe(C);return u.jsxs(L.div,{className:A("pointer-events-none relative flex h-full flex-shrink-0",B.commentGutter,g===j.COLLAPSED&&_?"basis-[32px]":"basis-0"),initial:{width:0,opacity:0},animate:{width:_,opacity:1},exit:{width:0,opacity:0},children:[u.jsx(ur,{getStableCommentId:l,comments:o,onMeasure:h}),u.jsxs("div",{className:A("pointer-events-auto absolute bottom-0 left-0 top-0 w-0 overflow-visible",{"pl-2":y||!n}),children:[u.jsx(X,{children:C.map(S=>{const{key:M,type:ae}=S,ie=!!d&&ae===w.EXPANDED&&S.comment?.id===d,Q=!!d&&S.type===w.COLLAPSED&&S.children.includes(d);return u.jsx(lr,{isGutterCollapsed:g===j.COLLAPSED,isSomeCommentFocused:!!p||!!d,isHovered:ae===w.EXPANDED&&S.comment?.id===f,isFocused:ie||Q,entry:S,disableActions:r||s||t===He.COMMENTS_READONLY,onAcceptComment:K=>{try{i?.(te(o?.find(G=>G.id===K)))}catch(G){D.logError(`Comment ${K} not found`,G)}},onDismissComment:K=>{try{c?.(te(o?.find(G=>G.id===K)))}catch(G){D.logError(`Comment ${K} not found`,G)}}},M)})}),E&&P&&u.jsx(xr,{...P}),t===He.ENABLED&&!T&&!n&&u.jsx(nr,{composerRef:x,gutterMode:g,onAddComment:a,isWaitingForCommentResponse:s,isRequestActive:r,hasComments:E}),s&&T&&u.jsx(Cr,{})]})]})};function Y(e,o,{checkForDefaultPrevented:t=!0}={}){return function(r){if(e?.(r),t===!1||!r.defaultPrevented)return o?.(r)}}function xe(e,o=[]){let t=[];function n(s,a){const i=v.createContext(a),c=t.length;t=[...t,a];function l(f){const{scope:p,children:g,...h}=f,x=p?.[e][c]||i,C=v.useMemo(()=>h,Object.values(h));return u.jsx(x.Provider,{value:C,children:g})}function d(f,p){const g=p?.[e][c]||i,h=v.useContext(g);if(h)return h;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${s}\``)}return l.displayName=s+"Provider",[l,d]}const r=()=>{const s=t.map(a=>v.createContext(a));return function(i){const c=i?.[e]||s;return v.useMemo(()=>({[`__scope${e}`]:{...i,[e]:c}}),[i,c])}};return r.scopeName=e,[n,Er(r,...o)]}function Er(...e){const o=e[0];if(e.length===1)return o;const t=()=>{const n=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const a=n.reduce((i,{useScope:c,scopeName:l})=>{const f=c(s)[`__scope${l}`];return{...i,...f}},{});return v.useMemo(()=>({[`__scope${o.scopeName}`]:a}),[a])}};return t.scopeName=o.scopeName,t}function yr(e,o){typeof e=="function"?e(o):e!=null&&(e.current=o)}function Lt(...e){return o=>e.forEach(t=>yr(t,o))}function ke(...e){return v.useCallback(Lt(...e),e)}var me=v.forwardRef((e,o)=>{const{children:t,...n}=e,r=v.Children.toArray(t),s=r.find(br);if(s){const a=s.props.children,i=r.map(c=>c===s?v.Children.count(a)>1?v.Children.only(null):v.isValidElement(a)?a.props.children:null:c);return u.jsx(Ie,{...n,ref:o,children:v.isValidElement(a)?v.cloneElement(a,void 0,i):null})}return u.jsx(Ie,{...n,ref:o,children:t})});me.displayName="Slot";var Ie=v.forwardRef((e,o)=>{const{children:t,...n}=e;if(v.isValidElement(t)){const r=Tr(t);return v.cloneElement(t,{...Nr(n,t.props),ref:o?Lt(o,r):r})}return v.Children.count(t)>1?v.Children.only(null):null});Ie.displayName="SlotClone";var _r=({children:e})=>u.jsx(u.Fragment,{children:e});function br(e){return v.isValidElement(e)&&e.type===_r}function Nr(e,o){const t={...o};for(const n in o){const r=e[n],s=o[n];/^on[A-Z]/.test(n)?r&&s?t[n]=(...i)=>{s(...i),r(...i)}:r&&(t[n]=r):n==="style"?t[n]={...r,...s}:n==="className"&&(t[n]=[r,s].filter(Boolean).join(" "))}return{...e,...t}}function Tr(e){let o=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=o&&"isReactWarning"in o&&o.isReactWarning;return t?e.ref:(o=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=o&&"isReactWarning"in o&&o.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}function Pr(e){const o=e+"CollectionProvider",[t,n]=xe(o),[r,s]=t(o,{collectionRef:{current:null},itemMap:new Map}),a=g=>{const{scope:h,children:x}=g,C=R.useRef(null),E=R.useRef(new Map).current;return u.jsx(r,{scope:h,itemMap:E,collectionRef:C,children:x})};a.displayName=o;const i=e+"CollectionSlot",c=R.forwardRef((g,h)=>{const{scope:x,children:C}=g,E=s(i,x),y=ke(h,E.collectionRef);return u.jsx(me,{ref:y,children:C})});c.displayName=i;const l=e+"CollectionItemSlot",d="data-radix-collection-item",f=R.forwardRef((g,h)=>{const{scope:x,children:C,...E}=g,y=R.useRef(null),k=ke(h,y),_=s(l,x);return R.useEffect(()=>(_.itemMap.set(y,{ref:y,...E}),()=>void _.itemMap.delete(y))),u.jsx(me,{[d]:"",ref:k,children:C})});f.displayName=l;function p(g){const h=s(e+"CollectionConsumer",g);return R.useCallback(()=>{const C=h.collectionRef.current;if(!C)return[];const E=Array.from(C.querySelectorAll(`[${d}]`));return Array.from(h.itemMap.values()).sort((_,T)=>E.indexOf(_.ref.current)-E.indexOf(T.ref.current))},[h.collectionRef,h.itemMap])}return[{Provider:a,Slot:c,ItemSlot:f},p,n]}var Sr=globalThis?.document?v.useLayoutEffect:()=>{},kr=fo.useId||(()=>{}),Ir=0;function Mr(e){const[o,t]=v.useState(kr());return Sr(()=>{t(n=>n??String(Ir++))},[e]),o?`radix-${o}`:""}var Ar=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],F=Ar.reduce((e,o)=>{const t=v.forwardRef((n,r)=>{const{asChild:s,...a}=n,i=s?me:o;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),u.jsx(i,{...a,ref:r})});return t.displayName=`Primitive.${o}`,{...e,[o]:t}},{});function Oe(e){const o=v.useRef(e);return v.useEffect(()=>{o.current=e}),v.useMemo(()=>(...t)=>o.current?.(...t),[])}function Ee({prop:e,defaultProp:o,onChange:t=()=>{}}){const[n,r]=Rr({defaultProp:o,onChange:t}),s=e!==void 0,a=s?e:n,i=Oe(t),c=v.useCallback(l=>{if(s){const f=typeof l=="function"?l(e):l;f!==e&&i(f)}else r(l)},[s,e,r,i]);return[a,c]}function Rr({defaultProp:e,onChange:o}){const t=v.useState(e),[n]=t,r=v.useRef(n),s=Oe(o);return v.useEffect(()=>{r.current!==n&&(s(n),r.current=n)},[n,r,s]),t}var wr=v.createContext(void 0);function Le(e){const o=v.useContext(wr);return e||o||"ltr"}var Te="rovingFocusGroup.onEntryFocus",Or={bubbles:!1,cancelable:!0},ye="RovingFocusGroup",[Me,Dt,Lr]=Pr(ye),[Dr,_e]=xe(ye,[Lr]),[jr,Br]=Dr(ye),jt=v.forwardRef((e,o)=>u.jsx(Me.Provider,{scope:e.__scopeRovingFocusGroup,children:u.jsx(Me.Slot,{scope:e.__scopeRovingFocusGroup,children:u.jsx(Gr,{...e,ref:o})})}));jt.displayName=ye;var Gr=v.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:r=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:c,onEntryFocus:l,preventScrollOnEntryFocus:d=!1,...f}=e,p=v.useRef(null),g=ke(o,p),h=Le(s),[x=null,C]=Ee({prop:a,defaultProp:i,onChange:c}),[E,y]=v.useState(!1),k=Oe(l),_=Dt(t),T=v.useRef(!1),[P,S]=v.useState(0);return v.useEffect(()=>{const M=p.current;if(M)return M.addEventListener(Te,k),()=>M.removeEventListener(Te,k)},[k]),u.jsx(jr,{scope:t,orientation:n,dir:h,loop:r,currentTabStopId:x,onItemFocus:v.useCallback(M=>C(M),[C]),onItemShiftTab:v.useCallback(()=>y(!0),[]),onFocusableItemAdd:v.useCallback(()=>S(M=>M+1),[]),onFocusableItemRemove:v.useCallback(()=>S(M=>M-1),[]),children:u.jsx(F.div,{tabIndex:E||P===0?-1:0,"data-orientation":n,...f,ref:g,style:{outline:"none",...e.style},onMouseDown:Y(e.onMouseDown,()=>{T.current=!0}),onFocus:Y(e.onFocus,M=>{const ae=!T.current;if(M.target===M.currentTarget&&ae&&!E){const ie=new CustomEvent(Te,Or);if(M.currentTarget.dispatchEvent(ie),!ie.defaultPrevented){const Q=_().filter(z=>z.focusable),K=Q.find(z=>z.active),G=Q.find(z=>z.id===x),so=[K,G,...Q].filter(Boolean).map(z=>z.ref.current);Vt(so,d)}}T.current=!1}),onBlur:Y(e.onBlur,()=>y(!1))})})}),Bt="RovingFocusGroupItem",Gt=v.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:r=!1,tabStopId:s,...a}=e,i=Mr(),c=s||i,l=Br(Bt,t),d=l.currentTabStopId===c,f=Dt(t),{onFocusableItemAdd:p,onFocusableItemRemove:g}=l;return v.useEffect(()=>{if(n)return p(),()=>g()},[n,p,g]),u.jsx(Me.ItemSlot,{scope:t,id:c,focusable:n,active:r,children:u.jsx(F.span,{tabIndex:d?0:-1,"data-orientation":l.orientation,...a,ref:o,onMouseDown:Y(e.onMouseDown,h=>{n?l.onItemFocus(c):h.preventDefault()}),onFocus:Y(e.onFocus,()=>l.onItemFocus(c)),onKeyDown:Y(e.onKeyDown,h=>{if(h.key==="Tab"&&h.shiftKey){l.onItemShiftTab();return}if(h.target!==h.currentTarget)return;const x=Hr(h,l.orientation,l.dir);if(x!==void 0){if(h.metaKey||h.ctrlKey||h.altKey||h.shiftKey)return;h.preventDefault();let E=f().filter(y=>y.focusable).map(y=>y.ref.current);if(x==="last")E.reverse();else if(x==="prev"||x==="next"){x==="prev"&&E.reverse();const y=E.indexOf(h.currentTarget);E=l.loop?Yr(E,y+1):E.slice(y+1)}setTimeout(()=>Vt(E))}})})})});Gt.displayName=Bt;var Vr={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Fr(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Hr(e,o,t){const n=Fr(e.key,t);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Vr[n]}function Vt(e,o=!1){const t=document.activeElement;for(const n of e)if(n===t||(n.focus({preventScroll:o}),document.activeElement!==t))return}function Yr(e,o){return e.map((t,n)=>e[(o+n)%e.length])}var Ft=jt,De=Gt,$r="Separator",ct="horizontal",Ur=["horizontal","vertical"],Ht=v.forwardRef((e,o)=>{const{decorative:t,orientation:n=ct,...r}=e,s=Kr(n)?n:ct,i=t?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return u.jsx(F.div,{"data-orientation":s,...i,...r,ref:o})});Ht.displayName=$r;function Kr(e){return Ur.includes(e)}var zr=Ht,Xr="Toggle",Yt=v.forwardRef((e,o)=>{const{pressed:t,defaultPressed:n=!1,onPressedChange:r,...s}=e,[a=!1,i]=Ee({prop:t,onChange:r,defaultProp:n});return u.jsx(F.button,{type:"button","aria-pressed":a,"data-state":a?"on":"off","data-disabled":e.disabled?"":void 0,...s,ref:o,onClick:Y(e.onClick,()=>{e.disabled||i(!a)})})});Yt.displayName=Xr;var Z="ToggleGroup",[$t,Ut]=xe(Z,[_e]),Kt=_e(),je=R.forwardRef((e,o)=>{const{type:t,...n}=e;if(t==="single"){const r=n;return u.jsx(Wr,{...r,ref:o})}if(t==="multiple"){const r=n;return u.jsx(qr,{...r,ref:o})}throw new Error(`Missing prop \`type\` expected on \`${Z}\``)});je.displayName=Z;var[zt,Xt]=$t(Z),Wr=R.forwardRef((e,o)=>{const{value:t,defaultValue:n,onValueChange:r=()=>{},...s}=e,[a,i]=Ee({prop:t,defaultProp:n,onChange:r});return u.jsx(zt,{scope:e.__scopeToggleGroup,type:"single",value:a?[a]:[],onItemActivate:i,onItemDeactivate:R.useCallback(()=>i(""),[i]),children:u.jsx(Wt,{...s,ref:o})})}),qr=R.forwardRef((e,o)=>{const{value:t,defaultValue:n,onValueChange:r=()=>{},...s}=e,[a=[],i]=Ee({prop:t,defaultProp:n,onChange:r}),c=R.useCallback(d=>i((f=[])=>[...f,d]),[i]),l=R.useCallback(d=>i((f=[])=>f.filter(p=>p!==d)),[i]);return u.jsx(zt,{scope:e.__scopeToggleGroup,type:"multiple",value:a,onItemActivate:c,onItemDeactivate:l,children:u.jsx(Wt,{...s,ref:o})})});je.displayName=Z;var[Jr,Zr]=$t(Z),Wt=R.forwardRef((e,o)=>{const{__scopeToggleGroup:t,disabled:n=!1,rovingFocus:r=!0,orientation:s,dir:a,loop:i=!0,...c}=e,l=Kt(t),d=Le(a),f={role:"group",dir:d,...c};return u.jsx(Jr,{scope:t,rovingFocus:r,disabled:n,children:r?u.jsx(Ft,{asChild:!0,...l,orientation:s,dir:d,loop:i,children:u.jsx(F.div,{...f,ref:o})}):u.jsx(F.div,{...f,ref:o})})}),pe="ToggleGroupItem",qt=R.forwardRef((e,o)=>{const t=Xt(pe,e.__scopeToggleGroup),n=Zr(pe,e.__scopeToggleGroup),r=Kt(e.__scopeToggleGroup),s=t.value.includes(e.value),a=n.disabled||e.disabled,i={...e,pressed:s,disabled:a},c=R.useRef(null);return n.rovingFocus?u.jsx(De,{asChild:!0,...r,focusable:!a,active:s,ref:c,children:u.jsx(lt,{...i,ref:o})}):u.jsx(lt,{...i,ref:o})});qt.displayName=pe;var lt=R.forwardRef((e,o)=>{const{__scopeToggleGroup:t,value:n,...r}=e,s=Xt(pe,t),a={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},i=s.type==="single"?a:void 0;return u.jsx(Yt,{...i,...r,ref:o,onPressedChange:c=>{c?s.onItemActivate(n):s.onItemDeactivate(n)}})}),Qr=je,es=qt,Be="Toolbar",[ts,Bs]=xe(Be,[_e,Ut]),Ge=_e(),Jt=Ut(),[os,Zt]=ts(Be),Qt=v.forwardRef((e,o)=>{const{__scopeToolbar:t,orientation:n="horizontal",dir:r,loop:s=!0,...a}=e,i=Ge(t),c=Le(r);return u.jsx(os,{scope:t,orientation:n,dir:c,children:u.jsx(Ft,{asChild:!0,...i,orientation:n,dir:c,loop:s,children:u.jsx(F.div,{role:"toolbar","aria-orientation":n,dir:c,...a,ref:o})})})});Qt.displayName=Be;var eo="ToolbarSeparator",to=v.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Zt(eo,t);return u.jsx(zr,{orientation:r.orientation==="horizontal"?"vertical":"horizontal",...n,ref:o})});to.displayName=eo;var ns="ToolbarButton",Ve=v.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Ge(t);return u.jsx(De,{asChild:!0,...r,focusable:!e.disabled,children:u.jsx(F.button,{type:"button",...n,ref:o})})});Ve.displayName=ns;var rs="ToolbarLink",ss=v.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Ge(t);return u.jsx(De,{asChild:!0,...r,focusable:!0,children:u.jsx(F.a,{...n,ref:o,onKeyDown:Y(e.onKeyDown,s=>{s.key===" "&&s.currentTarget.click()})})})});ss.displayName=rs;var oo="ToolbarToggleGroup",as=v.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Zt(oo,t),s=Jt(t);return u.jsx(Qr,{"data-orientation":r.orientation,dir:r.dir,...s,...n,ref:o,rovingFocus:!1})});as.displayName=oo;var is="ToolbarToggleItem",cs=v.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Jt(t),s={__scopeToolbar:e.__scopeToolbar};return u.jsx(Ve,{asChild:!0,...s,children:u.jsx(es,{...r,...n,ref:o})})});cs.displayName=is;var ls=Qt,us=to,ds=(e=>(e.CODE="code",e.WRITING="writing",e))(ds||{});const se=({children:e,toolbarType:o})=>u.jsx(ls,{className:A("m-0 flex h-10 w-fit min-w-0 flex-shrink items-center overflow-hidden rounded-xl border border-token-border-light bg-token-main-surface-primary",pt,o==="code"?"p-0":"p-1"),children:e}),no=({icon:e,hideLabel:o,label:t})=>u.jsxs(u.Fragment,{children:[u.jsx(e,{className:A("icon-sm",{"mr-0.5 text-token-text-tertiary":!o,"text-token-text-primary":o})}),!o&&u.jsx("span",{className:"truncate text-sm text-token-text-primary",children:t})]}),ro=mt(Ve)`flex h-full items-center gap-1 rounded-lg px-2.5 hover:bg-[#f5f5f5] dark:hover:bg-token-main-surface-secondary`,fs=({label:e,icon:o,hideLabel:t=!1,onClick:n,onMouseDown:r})=>u.jsx(ro,{onClick:n,"aria-label":t?e:void 0,onMouseDown:r,children:u.jsx(no,{icon:o,hideLabel:t,label:e})}),ms=({icon:e,hideLabel:o,label:t,children:n})=>u.jsxs(Ao,{children:[u.jsx(Ro,{asChild:!0,children:u.jsx(ro,{"aria-label":o?t:void 0,children:u.jsx(no,{icon:e,hideLabel:o,label:t})})}),u.jsx(wo,{children:u.jsx(Oo,{align:"end",className:B.toolbar,sideOffset:8,children:n})})]});se.Separator=mt(us)`mx-1 p-0 list-none h-full w-[1px] bg-token-border-light`;se.Action=fs;se.Popover=ms;const ps=({getSelectionRange:e})=>{const o=Ae(),t=()=>{const n=e();if(n==null)return;const{from:r,to:s,sourceFrom:a,sourceTo:i}=n;if(r==null||s==null||a==null||i==null){D.logError("Missing selection range on targeted edit",n);return}const c=vt.ASK;D.logButtonClick(W.TOOLBAR_ASK_CHATGPT,{action:c,sourceFrom:a,sourceTo:i}),O.startCommentingOn({type:$.SELECTION,from:r,to:s,sourceRange:{start:a,end:i},action:c})};return u.jsx(se.Action,{label:o.formatMessage({id:"wOaJUU",defaultMessage:"Ask ChatGPT"}),onClick:t,icon:Yo})},Gs=({getEditorDom:e,getToolbarPosition:o,getSelectionRange:t,toolbarType:n,children:r,onAddComment:s,isWaitingForCommentResponse:a=!1})=>{const[{height:i,width:c},l]=ve(),[d,f]=v.useState(!0),[p,g]=v.useState(!1),h=e(),x=V(({commentingOn:P})=>P),[C,E]=v.useState(null),y=v.useCallback(()=>{const P=e(),S=document.getSelection();return!S||S.type!=="Range"||S.isCollapsed||!P?.contains(S.anchorNode)},[e]);v.useEffect(()=>{const P=Lo(()=>{g(!0)},200,{leading:!0}),S=()=>{P.cancel(),g(!1)};return h?.addEventListener("pointerdown",P,{passive:!0}),document.addEventListener("pointerup",S,{passive:!0}),()=>{h?.removeEventListener("pointerdown",P),document.removeEventListener("pointerup",S)}},[h]),v.useEffect(()=>{const P=()=>{f(y())};return document.addEventListener("selectionchange",P,{passive:!0}),()=>{document.removeEventListener("selectionchange",P)}},[y]),ft(()=>{if(d||y())return f(!0);try{const P=o({width:c,height:i});P!=null&&E(P)}catch(P){D.logError("Invalid position in getToolbarPosition",P)}},[i,c,d,y,o]);const k=u.jsxs(se,{toolbarType:n,children:[u.jsx(ps,{getSelectionRange:t}),r]}),_=!d&&!x&&C!=null,T=qo(_);return v.useEffect(()=>{!_&&T&&!x&&h?.focus()},[h,T,_,x]),u.jsxs(u.Fragment,{children:[u.jsx("div",{"aria-hidden":"true",className:"pointer-events-none invisible fixed left-0 top-0 h-0 overflow-clip",children:u.jsx("div",{ref:l,children:k})}),u.jsx(X,{children:_&&u.jsx(L.div,{initial:{opacity:0,scale:.95},animate:{opacity:p?0:1,scale:p?.95:1},style:{top:C.top,left:C.left},exit:{opacity:0,scale:.95},transition:{type:"spring",bounce:.1,duration:.1,delay:p?0:.1},className:A("absolute",B.toolbar,p?"pointer-events-none":"pointer-events-auto"),children:k})}),u.jsx(Mn,{toolbarPosition:C,commentingOn:x,isWaitingForCommentResponse:a,onAddComment:s})]})};function gs(e){let o=e;for(;o;){const n=window.getComputedStyle(o).overflowY;if(n==="auto"||n==="scroll")return o;o=o.parentElement}return null}function Vs(e,o){const t=re(),n=Do(),r=t();v.useEffect(()=>{const s=r?.dom;if(!s||e.length===0)return;const a=()=>{if(!n)return;const{textdocId:d,history:f}=n;f?jo(d,f):Bo(d)},i=gs(s),c=d=>{d.key==="Escape"&&a()};window.document.addEventListener("keydown",c,{passive:!0});const l=o?xt(o,100):null;return i&&l&&i.addEventListener("scroll",l,{passive:!0}),()=>{window.document.removeEventListener("keydown",c),l&&(i&&i.removeEventListener("scroll",l),l.cancel())}},[r,n,e,o])}let ce=null;function Fs(){if(ce!=null)return ce;if(typeof window>"u")return 0;const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);try{ce=e.offsetWidth-e.clientWidth}finally{document.body.removeChild(e)}return ce}function Hs(e){return e==null?null:e.scrollHeight>e.clientHeight}export{Tt as A,An as B,js as C,pr as D,se as E,q as H,U as I,Dn as P,Gn as R,Gs as T,Rs as a,As as b,ds as c,Fs as d,ne as e,nn as f,Ms as g,ws as h,Hs as i,we as j,Bn as k,jn as l,Qo as m,It as n,Os as o,Fn as p,Je as q,Rn as r,Is as s,Ln as t,Vs as u,an as v,Ls as w,Ds as x,kt as y,fe as z};
//# sourceMappingURL=dxgncz3i1es693tr.js.map
