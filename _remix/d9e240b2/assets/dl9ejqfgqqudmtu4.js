import{fh as _e,fi as te,cK as Pe,fj as L,r as m,af as Me,bH as ze,bj as ie,P as x,b_ as $,aO as ae,dT as Ge,u as f,aS as N,j as ue,d6 as ve,d as se,fk as Te,l as Ee,aL as W,R as Ce,eb as we,eI as be,v as De,fl as Le,dn as ce,a as P,h as v,aI as re}from"./dox08siw8jpmvomc.js";import{cD as le,cG as V,dE as qe,f_ as Fe,f$ as Re,cK as y,g0 as He,bY as Ue,ch as D,ad as u,g1 as Ae,e_ as Qe,eW as Ke,g2 as xe,g3 as Ie}from"./fc5wvqf6bpwfisto.js";import{T as G,G as Oe,a as Ne}from"./jsdkerkdejse6xvb.js";function ke({clientThreadId:e}){const t=G.getThreadCurrentLeafId(e),r=G.getTree(e).getMessage(t).metadata?.model_switcher_deny??[],n={};r.forEach(i=>{const{slug:a,context:l,reason:d,description:c}=i,g=n[a]??{},h=g[l]??[];h.push({reason:d,description:c}),g[l]=h,n[a]=g});const o=_e();for(const{resets_after:i,model_slug:a}of o)[te.CONVERSATION,te.REGENERATE].forEach(l=>{const d=n[a]??{},c=d[l]??[],g={reason:Pe.RATE_LIMIT,resetsAfter:i};c.push(g),d[l]=c,n[a]=d});return n}const dt="text-davinci-002-render-sha",mt="gpt-4",gt="gpt-4o",ft="o1-preview",yt="o1-mini",I=le({slug:V,max_tokens:4097,title:"Default",description:"",tags:[L.GPT_3_5],product_features:{}}),Be=({default_model:e,tagline:t,color:s,human_category_name:r,category:n,human_category_short_name:o,human_category_shorter_name:i,subscription_level:a,short_explainer:l,subcategory:d,is_beta:c,...g})=>({color:s,tagline:t,defaultModel:e,label:r,shortLabel:o,description:l,shorterLabel:i??o,subscriptionLevel:a,categoryId:n,subcategory:d,isBeta:c,...g}),je=({icon:e,icon_filled_src:t,icon_outline_src:s})=>({iconName:e,iconFilledSrc:t,iconOutlineSrc:s}),$e=({group:e,human_group_name:t,human_group_short_name:s,model_ids:r})=>({group:e,label:t,shortLabel:s,modelIds:r});function We(){return N({retry:5,queryKey:["modelIcons"],queryFn:async()=>await ue.getModelIcons().then(e=>Object.fromEntries(Object.entries(e).map(([t,s])=>[t,je(s)])))})}function Ve(e){return N({retry:5,queryKey:["models",{isHistoryDisabled:e}],queryFn:async()=>await ue.getModels(e).then(t=>{const{models:s,internal_groups:r,categories:n}=t,o=s.map(le);return{categories:n.concat().reverse().map(Be),groups:r?.map($e)??[],modelsList:o,modelsMap:Object.fromEntries(o.map(i=>[i.id,i]))}})})}function T(){const e=Ge();return f(Ve(e))}function ht(){return f(We())}function Ye({isRegen:e=!1}={}){const{isLoading:t,data:{categories:s=[],groups:r=[]}={}}=T(),n=m.useMemo(()=>e?s.filter(o=>o.is_regenerate_category!==!1):s.filter(o=>!o.is_regenerate_category),[s,e]);return{isLoading:t,categories:n,groups:r??[]}}function St(){const{categories:e}=Ye();return!!e.find(({categoryId:t})=>t===qe.GPT4o)}function pt(){const{data:e}=T();return m.useMemo(()=>e?new Set(Object.keys(e.modelsMap)):new Set([V]),[e])}const Ze={[V]:I};function Je(){const{data:e}=T();return e?.modelsMap??Ze}function de(e,t,s){let r=L.GPT_3_5;return s?r=L.GPT_4:t&&(r=L.GPT_4o),e?.modelsList.find(n=>n.tags.includes(r))??e?.modelsList[0]??I}function _t(e=!1){const t=Me(),s=ze(),[,r]=ie();return m.useCallback(({location:n,modelId:o})=>{const i=t.pathname.includes("/g/");e||i?(x.logNewChatButtonClicked({location:n}),s({pathname:"/",search:`?model=${encodeURIComponent(o)}`})):(r(a=>(a.set("model",o),a)),x.logNewChatButtonClicked({location:n}))},[e,t,s,r])}function Pt(){const{data:{categories:e=[]}={}}=T(),{doesUserHaveAnyAccountsWithPlusFeatures:t}=$();return t?null:e.find(Fe)?.defaultModel??null}function Xe(e){return Oe(e)}function me(e){const t=Xe(e),s=Je();return m.useMemo(()=>t==null?I:s[t]??I,[t,s])}function et(e,t){return me(e).enabledTools?.includes(t)??!1}function Mt(e){const t=Re(),s=me(e),r=m.useMemo(()=>!t.isSuccess||!t.data?[]:t.data,[t.data,t.isSuccess]),n=ke({clientThreadId:e});return m.useMemo(()=>{const i=new Set(s.enabledTools||[]);return r.filter(a=>!(!(a.requiredFeatures.length===0||a.requiredFeatures.every(c=>i.has(c)))||!(a.requiredModels.length===0||a.requiredModels.some(c=>!n[c]))))},[r,s,n])}function zt(){const{data:e}=T(),{doesUserHaveAnyAccountsWithPlusFeatures:t}=$(),s=ae();return de(e,!!t,!!s?.isEnterprisey())}const ne=e=>({turn_index:e.turnIndex,thread_id:e.threadId,conversation_id:e.clientThreadId?G.getServerThreadId(e.clientThreadId):void 0,message_id:e?.messageId}),tt="hints";class O extends ve()(t=>({persistedSystemHints:new Set(t),persistedSystemHintTriggers:{}})){static getPersistedSystemHints=({persistedSystemHints:t})=>t;addPersistedSystemHint=(t,s,r)=>{t===y.Search&&x.logEventWithStatsig(se.searchModeEngaged,"search_mode_engaged",{...ne(s),triggerSource:r}),this.setState(({persistedSystemHints:n,persistedSystemHintTriggers:o})=>({persistedSystemHints:new Set(n).add(t),persistedSystemHintTriggers:{...o,[t]:r}}))};removePersistedSystemHint=(t,s)=>{t===y.Search&&x.logEventWithStatsig(se.searchModeDisabled,"search_mode_disabled",ne(s)),this.setState(({persistedSystemHints:r,persistedSystemHintTriggers:n})=>{const o=new Set(r);o.delete(t);const i={...n};return delete i[t],{persistedSystemHints:o,persistedSystemHintTriggers:i}})};getPersistedSystemHintTrigger=t=>{if(this.getState().persistedSystemHints.has(t))return this.getState().persistedSystemHintTriggers[t]};clearPersistedSystemHintTrigger=t=>{this.setState(({persistedSystemHints:s,persistedSystemHintTriggers:r})=>{const n={...r};return delete n[t],{persistedSystemHints:new Set(s),persistedSystemHintTriggers:n}})}}const Gt=()=>O.useState(O.getPersistedSystemHints);function vt({children:e,clientThreadId:t,currentLeafId:s}){const r=et(t,Te.Search),o=G.getLastMessgageSystemHints(t,s).includes(y.Search)&&r,[i]=m.useState(()=>new O(o?[y.Search]:[]));return m.useEffect(()=>{const a=i.getState().persistedSystemHints;o&&!a.has(y.Search)&&i?.addPersistedSystemHint(y.Search,{clientThreadId:t,turnIndex:0})},[o,i,t]),Ee.jsx(O.Provider,{store:i,children:e})}function st(e){const t=new Set;if(e){const s=e.split(",");Array.isArray(s)&&s.forEach(r=>{Object.values(y).includes(r)&&t.add(r)})}return t}const K="q",j="m";function Tt(e){const{clientThreadId:t,currentLeafId:s,handleRequestCompletion:r}=e,n=m.useRef(!1),{isLoading:o,data:i}=T(),{doesUserHaveAnyAccountsWithPlusFeatures:a,isLoading:l}=$(),d=ae(),[c,g]=ie(),h=W(),F=m.useCallback((S,C,M,z)=>{G.updateTree(t,p=>{p.addNode(S,M,C,Ce.User,void 0,z)})},[t]),Z=m.useCallback(async(S,{content:C,attachments:M},z,p,w,b)=>{const U=s,A=M.length>0?{attachments:M}:{};A.system_hints=p.systemHints,F(S,U,C,A),r({type:we.Next,promptId:S,requestedModelId:b,eventMetadata:z,cancelActiveRequests:!0,completionMetadata:p,turnTracker:w})},[F,r,s]),R=be(()=>window.location.pathname)??null,J=He();let X=!o&&!l&&R!=null;const[H,E]=m.useState(!0);return m.useEffect(()=>{if(!H||n.current)return;const S=Ne.getConversationMode(t);if(!X||S==null)return;if(!nt(R)||rt(R)&&J===void 0||G.getServerThreadId(t)!=null){E(!1);return}const C=(()=>{try{return Object.fromEntries(new URLSearchParams(location.hash.slice(1)).entries())}catch{return{}}})(),M={...Object.fromEntries(c),...C},{[K]:z,[j]:p,[tt]:w}=M,b=(typeof z=="string"?z:null)??(typeof p=="string"?p:null);if(!b||!b.trim()){E(!1);return}const U=st(w),A=De();n.current=!0;let k=i?.modelsList;U.has(y.Search)&&(k=k?.filter(Q=>Q.enabledTools?.includes(y.Search)));const ee=i&&de({...i,modelsList:k??[]},!!a,!!d?.isEnterprisey());if(ee==null){h.warning("No model available for this request"),E(!1);return}const he=new Ue,Se=w?.includes(y.Search);(e.prefetchSearchPromise??Promise.resolve(null)).then(Q=>{g(pe=>{const B=new URLSearchParams(pe);return B.delete(K),B.delete(j),B}),Z(A,{content:b,attachments:[]},{eventSource:"url"},{conversationMode:S,source:"instant-query",systemHints:w?Array.from(U):void 0,prefetchIds:Q!=null?[Q]:void 0,searchSource:Se?Le.URL_SEARCH_HINT:void 0},he,ee?.id),E(!1)})},[o,l,X,R,i,a,d,Z,H,t,J,h,e.prefetchSearchPromise,c,g]),H&&(e.prefetchSearchPromise!=null||c.has(K)||c.has(j)?!0:(E(!1),!1))}function rt(e){return ge(e)}function ge(e){return e==null?!1:/^\/g\/[\w-]+$/.test(e)}function nt(e){return e==null?!1:e==="/"||ge(e)}const Et="GPT Builder";function Ct(e){if(e)return`ChatGPT - ${e}`}function Y(e){return e.gizmo.short_url??e.gizmo.id??"-"}function fe(e){return`/g/${e}`}function wt(e){return`https://chatgpt.com${fe(e)}`}function ot(e){return fe(Y(e))}function bt(e,t){const s=new URLSearchParams;return t!=null&&s.set(K,t),Ae(new URL(`${ot(e)}?${s}`,"https://chatgpt.com"))}function Dt(e){return`/g/${Y(e)}`}function Lt(e){return Qe(e)&&e.gizmo.live_version===0||Ke(e)&&e.liveVersion===0}function qt(e,t){return f({queryKey:["gizmos","discovery",{locale:e,isAnon:t}],queryFn:async()=>u.getGizmoDiscovery(e,t)})}function Ft({cutId:e,locale:t,limit:s,cursor:r,enabled:n=!0}){return ce({queryKey:["gizmos","discovery",{cutId:e,locale:t,limit:s}],queryFn:async({pageParam:o})=>u.getGizmoDiscoveryCut(e,{locale:t,cursor:o,limit:s}),initialPageParam:r,getNextPageParam:o=>o.list.cursor??void 0,enabled:n})}function Rt(){return f({queryKey:["gizmos","pinned"],queryFn:async()=>u.getGizmoPinned()})}function q(){return N({queryKey:["gizmos","bootstrap"],queryFn:async()=>u.getGizmoBootstrap().then(e=>({gizmos:e.gizmos.map(t=>({resource:t.resource,flair:t.flair}))}))})}function Ht(){return f(q())}function oe(e,t){const s=e.filter(n=>n.resource.gizmo.id!==t.resource.gizmo.id);let r=s.findIndex(n=>n.flair.kind===D.Recent);return r===-1&&(r=s.length),s.splice(r,0,t),s}const Ut={handleGizmoInteracted(e,t){const s=e.getQueryData(_(e,t).queryKey);s!=null&&e.setQueryData(q().queryKey,r=>{if(r==null)return r;const n=r.gizmos.find(o=>o.resource.gizmo.id===t);return n?.flair.kind===D.FirstParty||n?.flair.kind===D.SidebarKeep?r:{gizmos:oe(r.gizmos,{resource:s,flair:{kind:D.Recent}})}})},handleGizmoSidebarKeep(e,t){const s=e.getQueryData(_(e,t).queryKey);s!=null&&e.setQueryData(q().queryKey,r=>r==null?r:{gizmos:oe(r.gizmos,{resource:s,flair:{kind:D.SidebarKeep}})})},handleGizmoSidebarHide(e,t){e.setQueryData(q().queryKey,s=>s?.gizmos.some(r=>r.resource.gizmo.id===t)?{gizmos:s.gizmos.filter(r=>r.resource.gizmo.id!==t)}:s)}};function At(e,t=!1){const s=P();return f(_(s,e,t))}function Qt({gizmoId:e,draft:t,version:s}){const r=P(),n=s?{queryKey:["gizmo","version",{gizmoId:e,version:s}],queryFn:async()=>u.getVersion({gizmoId:e,version:s}),enabled:e!=null}:_(r,e,t);return f(n)}function Kt(e,t){return f({queryKey:["gizmo","userActionSettings",{gizmoId:e}],queryFn:async()=>u.getUserActionSettings(e),enabled:e!=null&&t})}function _(e,t,s=!1){return N({queryKey:["gizmo",{gizmoId:t},{draft:s}],queryFn:async()=>u.getGizmo(t,s),enabled:t!=null,initialData:()=>{if(s===!0)return;const r=e.getQueryData(q().queryKey);if(r!=null)return r.gizmos.find(o=>o.resource.gizmo.id===t)?.resource;const n=e.getQueryData(["gizmos","discovery"]);if(n!=null)for(const o of n.cuts){const i=o.list.items.find(a=>a.resource.gizmo.id===t)?.resource;if(i!=null)return i}}})}function xt(e,t){return e.fetchQuery(_(e,t))}function It(e){return f({queryKey:["gizmo",{search:e}],queryFn:async()=>u.getGizmoSearch(e),enabled:e.length>0})}function Ot(e,t){return f({queryKey:["gizmo-search-workspace",{search:e}],queryFn:async()=>u.getGizmoSearchForWorkspace(e),enabled:e.length>0&&t})}function Nt(e,t=!1,s=!1,r=null){return ce({queryKey:[s?"gizmo-search-workspace":"gizmo",{query:e,cursor:r}],queryFn:async({pageParam:n})=>s?u.getGizmoSearchForWorkspace(e,r=n):u.getGizmoSearch(e,r=n),initialPageParam:r,getNextPageParam:n=>n.cursor??void 0,enabled:t})}function kt(){const e=P();return v({mutationFn:async({gizmoId:t,editorData:s})=>{const{instructions:r,name:n,description:o,profilePictureId:i,profilePictureUrl:a,promptStarters:l,tools:d,files:c,trainingDisabled:g}=s,h={instructions:r,display:{name:n,description:o,profile_pic_id:i,profile_picture_url:a,prompt_starters:l},tools:d,files:c.map(F=>({...F,location:xe.FILE_SERVICE})),training_disabled:g};return u.upsertDraft(h,t)},onSettled:t=>{t&&(e.setQueryData(_(e,t.gizmo.id,!0).queryKey,t),e.invalidateQueries({queryKey:["gizmos","mine"],refetchType:"none"}))}})}function Bt(){const e=P();return v({mutationFn:async({gizmoId:t,data:s})=>{const{sharingRecipient:r,categories:n}=s,o=await u.promoteDraft({sharing:s.sharingSubjects&&s.sharingSubjects.length>0?s.sharingSubjects:{recipient:r},categories:n},t);if(o.error)throw new Ie(o);return o.resource},onSettled:t=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"}),e.invalidateQueries({queryKey:["gizmos","pinned"],refetchType:"none"}),t&&e.setQueryData(_(e,t.gizmo.id,!1).queryKey,t)}})}function jt(){const e=P();return v({mutationFn:async({gizmoId:t})=>u.deleteGizmo(t),onSettled:()=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"})}})}function $t(){const e=P(),t=W();return v({mutationFn:async({name:s,hideName:r,websiteUrl:n,willReceiveSupportEmails:o})=>u.updateBuilderProfile({name:s,hide_name:r,website_url:n,will_receive_support_emails:o}),onSuccess:s=>{e.setQueryData(["builderProfile"],s)},onError:s=>{t.warning(s.message)}})}function Wt(){return f({queryKey:["builderProfile"],queryFn:async()=>u.getBuilderProfile()})}function Vt(){return v({mutationFn:async({gizmoId:e})=>u.copyGizmo({gizmoId:e})})}function Yt(){return f({queryKey:["gizmoCategories"],queryFn:async()=>u.getCategories()})}function Zt(e,t){return!!(t!=null&&[re.PrimaryAssistant,re.GizmoInteraction].includes(t)&&e?.includes(L.GPT_4))}function Jt(e,t){const s=P(),r=W();return v({mutationFn:async({rating:n,message:o,includeFrom:i})=>{await u.upsertUserReview(e,n,o,i)},onSuccess:async()=>{s.invalidateQueries({queryKey:["gizmo","review",{gizmoId:e}]})},onError:n=>{r.danger(n.message)}})}function Xt(e,t){return t?`/g/${Y(t)}/c/${e}`:`/c/${e}`}function es(){return"/gpts"}function ts(){return"/gpts/mine"}function ye(e){return e?`/gpts/editor/${e}`:"/gpts/editor"}function ss(e){const t=it();return e==null?t:ye(e)}function it(e){return ye(e)}function rs(e){try{const t=new URL(e);return t.hostname=t.hostname.replace(/^(www\.|web\.|mbasic\.|mobile\.)(secure\.)?/,""),t.pathname="",[...t.searchParams.keys()].forEach(s=>t.searchParams.delete(s)),t.toString()}catch{return e}}function at(e){if(!e)return null;try{return new URL(e).hostname}catch{return null}}function ns(e){const t=at(e);return t?t.replace(/^www\./,""):e}export{Zt as $,gt as A,Rt as B,wt as C,bt as D,Vt as E,rs as F,Ut as G,Kt as H,ss as I,Gt as J,me as K,ts as L,Wt as M,$t as N,Yt as O,O as P,Qt as Q,T as R,mt as S,kt as T,Bt as U,_ as V,xt as W,pt as X,et as Y,Mt as Z,Je as _,At as a,Et as a0,ft as a1,yt as a2,ht as a3,ke as a4,Pt as a5,dt as a6,Tt as a7,St as b,ot as c,Jt as d,jt as e,Dt as f,Xt as g,It as h,Ot as i,Ft as j,Nt as k,qt as l,es as m,ye as n,ns as o,Ht as p,zt as q,Xe as r,fe as s,vt as t,_t as u,Ct as v,Lt as w,it as x,Ye as y,ne as z};
//# sourceMappingURL=dl9ejqfgqqudmtu4.js.map
