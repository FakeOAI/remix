import{j as t,O as M,r as w,a7 as S,d6 as D,M as N,bi as P,c as F}from"./n62zftee9av9wxib.js";import{bM as b,bN as j,bO as C,A as k,bP as O}from"./o7uqz2086hs2sxty.js";import{a as z,b2 as A}from"./cwe5tk2381hhmaki.js";import{m as _,n as G,o as $,p as q}from"./otwiqv3ij3chyjvy.js";import{g as U}from"./kqwdyvkaaavvn8k3.js";import{u as X}from"./mxf3lui0u94u5izp.js";import{m as E}from"./gqih2li7wtf179yn.js";import"./nm9i3dg6yq3exjkz.js";import"./ewowfsm6mt6yl8be.js";function re({clientThreadId:s}){const e=b.useCurrentImage();if(!e)return null;const{image:r,source:a,turnIndex:o}=e;if(a==null||s==null||o==null)return t.jsx(d,{image:r});const i=_(s,o);return t.jsx(d,{image:r,group:i,turnIndex:o,groupSource:a})}function ae(){const s=b.useCurrentImage();if(!s)return null;const{image:e,source:r}=s;if(r==null)return t.jsx(d,{image:e});switch(r){case j.ImagesTab:return t.jsx(B,{image:e});case j.Turn:return t.jsx(H,{image:e})}}function B({image:s}){const{imageResults:e}=G();return t.jsx(d,{image:s,group:e,groupSource:j.ImagesTab})}function H({image:s}){const{imageResults:e}=$();return t.jsx(d,{image:s,group:e,groupSource:j.Turn})}const L=M.div`grow flex items-start p-8`;function T({title:s,urls:e}){const r=e[0],{data:a,isError:o}=q(r);if(e.length===0)return;if(o)return e.length>1?t.jsx(T,{title:s,urls:e.slice(1)}):t.jsx("div",{className:"flex h-full grow items-center justify-center",children:t.jsx("div",{className:"flex h-96 w-96 items-center justify-center bg-white/10",children:t.jsx(A,{className:"h-12 w-12 text-token-text-tertiary"})})});const i="max-w-[100vw] sm:max-w-[calc(100vw-10rem)] object-scale-down h-full";return a!=null?t.jsx(E.img,{src:r,alt:s,initial:{opacity:0},animate:{opacity:1},className:i}):t.jsx("div",{className:F("w-full animate-pulse bg-white/10",i)})}const J={enter:s=>({x:s>0?1e3:-1e3,opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:s=>({zIndex:0,x:s<0?1e3:-1e3,opacity:0})},R=1e4,K=(s,e)=>Math.abs(s)*e;function d({image:s,group:e,groupSource:r,turnIndex:a}){const o=X((s==null?void 0:s.url)??""),i=b.useCurrentImage(),l=b.useStore(),v=i==null?void 0:i.mountDirection;w.useEffect(()=>{var g,p;(p=(g=window==null?void 0:window.history)==null?void 0:g.state)!=null&&p.imageModalOpen||window.history.pushState({imageModalOpen:!0},"",window.location.href);const n=()=>{var x,y;(y=(x=window==null?void 0:window.history)==null?void 0:x.state)!=null&&y.imageModalOpen||l.setCurrentImage(void 0)};return window.addEventListener("popstate",n),()=>window.removeEventListener("popstate",n)},[l]);const I=()=>{window.history.go(-1),l.setCurrentImage(void 0)},c=e==null?void 0:e.findIndex(n=>S(s,n)),m=(e==null?void 0:e.length)??1,u=c!=null&&m>1,f=w.useCallback(()=>{!u||e==null||l.setCurrentImage({image:e[(c+1)%e.length],source:r,mountDirection:C.FromRight,turnIndex:a})},[u,e,l,c,r,a]),h=w.useCallback(()=>{!u||e==null||l.setCurrentImage({image:e[(c-1+e.length)%e.length],source:r,mountDirection:C.FromLeft,turnIndex:a})},[u,e,l,c,r,a]);return w.useEffect(()=>D(document,{keydown:n=>{n.key==="ArrowRight"?f():n.key==="ArrowLeft"&&h()}}),[f,h]),t.jsx(k,{children:s&&t.jsx(N.Root,{isOpen:!0,onClose:I,children:t.jsx(N.Overlay,{children:t.jsxs(P,{className:"flex h-full w-full flex-col bg-black/95",children:[t.jsxs("div",{className:"relative flex w-full grow justify-center overflow-hidden",children:[t.jsxs("div",{className:"absolute right-4 top-4 flex items-center sm:right-6 sm:top-6",children:[u&&t.jsxs("div",{className:"shrink-0 px-4 py-2 text-token-text-tertiary",children:[c+1," / ",m]}),t.jsx("button",{onClick:n=>{n.stopPropagation(),I()},className:"flex h-9 w-9 items-center justify-center outline-none hover:opacity-70",children:t.jsx(z,{className:"h-6 w-6 text-gray-400"})})]}),m>1&&t.jsx(L,{className:"cursor-w-resize",onClick:n=>{n.stopPropagation(),h()}}),t.jsx(k,{initial:!1,custom:v,children:t.jsx(E.div,{variants:J,custom:v??0,className:"absolute bottom-4 top-24",initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2}},drag:m>1?"x":!1,dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(n,{offset:g,velocity:p})=>{const x=K(g.x,p.x);x<-R?f():x>R&&h()},children:t.jsx(T,{title:s.title,urls:[s.content_url.replace(/^http:\/\//,"https://"),s.thumbnail_url]})},c)}),m>1&&t.jsx(L,{className:"cursor-e-resize",onClick:n=>{n.stopPropagation(),f()}})]}),t.jsx("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex min-h-20 w-full shrink-0 items-center gap-8 px-6 pb-3 pt-8 text-sm hover:opacity-70 sm:px-8 sm:pb-8",children:t.jsxs("div",{className:"flex grow flex-col gap-0.5 overflow-hidden pr-2",children:[t.jsxs("div",{className:"flex items-center gap-2 truncate text-token-text-tertiary",children:[t.jsx(O,{url:s.content_url,className:"rounded",size:16}),o.data??U(s.url)]}),t.jsx("div",{className:"truncate font-semibold text-white",children:s.title})]})})]})})})})}export{re as ImageLightbox,ae as ImageLightboxSearchGPT,d as ImageResultModal};
//# sourceMappingURL=b3ooheeprckefqzk.js.map
