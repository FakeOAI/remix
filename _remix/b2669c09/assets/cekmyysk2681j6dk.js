const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/h47okjej55rdaxb0.js","assets/nsy83w0n36p6tt3y.js","assets/bctc00rk8vlqdgt7.js","assets/m469opoz1mkbvhuc.js","assets/bmls73y1gwdy9wkg.js","assets/ggdh7pjp5xcwrnsg.js","assets/mkisucl9ntf4tsct.js","assets/root-pebmx3ar.css","assets/conversation-small-cll5buey.css","assets/ga5s79t7codos54i.js","assets/nrk2wv4lcsm4aots.js","assets/jp106jrxp4bfcof8.js","assets/nn7abvtqye2kbvi4.js","assets/ofl8v1acfagq5bb7.js","assets/byh20kidpgjmgfje.js","assets/bvmv4im6saihms8x.js","assets/ncdxtihmnz7uzs2q.js","assets/ioh3yma6lma1f2tx.js","assets/f7pbuz9n7jc1m90v.js","assets/ry8yvnh99dahtrha.js","assets/jkxlt9rtggccetnk.js","assets/ol6oz5ym28raltgk.js","assets/ejj4go3j2v7qycqx.js","assets/gzoio6oye21kcfa0.js","assets/n4okdvbrbd9jb2rf.js","assets/eilds8o1il33snqk.js","assets/jaovxw19yhb7twod.js","assets/g5czx0ahy3oxek9g.js","assets/bajets3foye3wvx5.js","assets/jd20oxy3dwnwxpda.js","assets/le6dsqa0ibtkhvel.js","assets/kmheyka0de034arm.js","assets/u5ec21gyvn5vwkfk.js","assets/j9drwkxjdxocyjzm.js","assets/ikg36dq392gk39ni.js","assets/hbby18negs2v8jsj.js","assets/gk03l7mp58lrqmew.js","assets/mxlm7vtmq13hi7h1.js"])))=>i.map(i=>d[i]);
import{$ as N,aE as nt,i as qt,g as Jt,fp as Zt,y as c,O as M,n as ie,r as g,X as Me,f6 as Qt,d7 as rt,av as eo,c7 as st,T as R,bc as to,W as at}from"./ggdh7pjp5xcwrnsg.js";import{mm as y,mi as oo,mn as se,iR as B,mo as it,mp as ct,iQ as fe,aD as X,fV as D,bJ as no,eM as ro,co as so,mq as j,j5 as W,i_ as Ne,mr as ao,ms as io,mt as co,kv as Fe,dA as Te,iV as He,iT as $e,$ as lo,i as uo,j as fo,k as mo,h as po}from"./bmls73y1gwdy9wkg.js";import{c as go,S as ho,H as vo,x as Co,t as d}from"./bctc00rk8vlqdgt7.js";import{E as xo,a2 as me,a1 as Y,C as w,a3 as pe,a4 as Eo,a5 as ge,a6 as _o,b as bo,u as yo,e as No,a7 as To,_ as V,a8 as lt,S as ut}from"./m469opoz1mkbvhuc.js";import{m as k}from"./jp106jrxp4bfcof8.js";import{c5 as So,c6 as Po,bT as Ao,S as Io,c7 as Oo}from"./mkisucl9ntf4tsct.js";import{b as Mo}from"./yot2fjqimw4pijvg.js";import{d as Ro,P as dt,f as Lo,c as wo,q as ko,j as Do,D as Ye,i as ft}from"./ga5s79t7codos54i.js";import{u as jo}from"./mkb41zrkd7newj0c.js";import{i as Bo}from"./jp5qlnpzclk315dp.js";const Go="_modelCursor_1mtn0_1",ms={modelCursor:Go},Vo=(...e)=>o=>{e.forEach(t=>{if(typeof t=="function")t(o);else if(t){const n=t;n.current=o}})};function I(e){return new go(ho.define(e))}const Ue=()=>N(()=>import("./pbl95wx6493wq92j.js"),[]).then(e=>I(e.shell)),mt={[y.bash]:Ue,[y.zsh]:Ue,[y.swift]:()=>N(()=>import("./pijqfo56g5y7ss6b.js"),[]).then(e=>I(e.swift)),[y.css]:()=>N(()=>import("./h47okjej55rdaxb0.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.css()),[y.html]:()=>N(()=>import("./eilds8o1il33snqk.js"),__vite__mapDeps([25,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,0,26])).then(e=>e.html()),[y.javascript]:()=>N(()=>import("./jaovxw19yhb7twod.js"),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.javascript({jsx:!0,typescript:!1})),[y.typescript]:()=>N(()=>import("./jaovxw19yhb7twod.js"),__vite__mapDeps([26,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.javascript({jsx:!0,typescript:!0})),[y.json]:()=>N(()=>import("./g5czx0ahy3oxek9g.js"),__vite__mapDeps([27,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.json()),[y.python]:()=>N(()=>import("./bajets3foye3wvx5.js"),__vite__mapDeps([28,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.python()),[y.sql]:()=>N(()=>import("./jd20oxy3dwnwxpda.js"),__vite__mapDeps([29,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,1])).then(e=>e.sql()),[y.go]:()=>N(()=>import("./le6dsqa0ibtkhvel.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.go()),[y.yaml]:()=>N(()=>import("./kmheyka0de034arm.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.yaml()),[y.java]:()=>N(()=>import("./u5ec21gyvn5vwkfk.js"),__vite__mapDeps([32,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.java()),[y.rust]:()=>N(()=>import("./j9drwkxjdxocyjzm.js"),__vite__mapDeps([33,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.rust()),[y.cpp]:()=>N(()=>import("./ikg36dq392gk39ni.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.cpp()),[y.php]:()=>N(()=>import("./hbby18negs2v8jsj.js"),__vite__mapDeps([35,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,26])).then(e=>e.php()),[y.xml]:()=>N(()=>import("./gk03l7mp58lrqmew.js"),__vite__mapDeps([36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24])).then(e=>e.xml()),[y.vue]:()=>N(()=>import("./mxlm7vtmq13hi7h1.js"),__vite__mapDeps([37,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,1,0,26])).then(e=>e.vue()),[y.ruby]:()=>N(()=>import("./e4lhyu305wu0fcut.js"),[]).then(e=>I(e.ruby)),[y.haskell]:()=>N(()=>import("./bf6r3t2rw7f01so5.js"),[]).then(e=>I(e.haskell)),[y.kotlin]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.kotlin)),[y.csharp]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.csharp)),[y.c]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.c)),[y.objectivec]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.objectiveC)),[y.r]:()=>N(()=>import("./n0t2rpizlasjzcxa.js"),[]).then(e=>I(e.r)),[y.lua]:()=>N(()=>import("./harowmpdmpnd9wki.js"),[]).then(e=>I(e.lua)),[y.dart]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.dart)),[y.scala]:()=>N(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(e=>I(e.scala)),[y.perl]:()=>N(()=>import("./gq1ss5v2zpbborxl.js"),[]).then(e=>I(e.perl)),[y.commonlisp]:()=>N(()=>import("./jr6cjysmysifr6mr.js"),[]).then(e=>I(e.commonLisp)),[y.clojure]:()=>N(()=>import("./gf1tfl9d2himhfic.js"),[]).then(e=>I(e.clojure)),[y.ocaml]:()=>N(()=>import("./khji33iw1sxityyt.js"),[]).then(e=>I(e.oCaml)),[y.powershell]:()=>N(()=>import("./i9u5kd7kvamutmln.js"),[]).then(e=>I(e.powerShell)),[y.verilog]:()=>N(()=>import("./fix340p09fldyqxz.js"),[]).then(e=>I(e.verilog)),[y.dockerfile]:()=>N(()=>import("./cgm5tyzi32u32j10.js"),[]).then(e=>I(e.dockerFile)),[y.other]:()=>null},Fo=e=>e in mt,ae={},ps=async e=>{if(ae[e]!=null)return ae[e];if(Fo(e)){const o=await mt[e]();return ae[e]=o,o}return null},gs=e=>ae[e]??null;var pt=e=>{var{theme:o,settings:t={},styles:n=[]}=e,r={".cm-gutters":{}},s={};t.background&&(s.backgroundColor=t.background),t.backgroundImage&&(s.backgroundImage=t.backgroundImage),t.foreground&&(s.color=t.foreground),t.fontSize&&(s.fontSize=t.fontSize),(t.background||t.foreground)&&(r["&"]=s),t.fontFamily&&(r["&.cm-editor .cm-scroller"]={fontFamily:t.fontFamily}),t.gutterBackground&&(r[".cm-gutters"].backgroundColor=t.gutterBackground),t.gutterForeground&&(r[".cm-gutters"].color=t.gutterForeground),t.gutterBorder&&(r[".cm-gutters"].borderRightColor=t.gutterBorder),t.caret&&(r[".cm-content"]={caretColor:t.caret},r[".cm-cursor, .cm-dropCursor"]={borderLeftColor:t.caret});var a={};t.gutterActiveForeground&&(a.color=t.gutterActiveForeground),t.lineHighlight&&(r[".cm-activeLine"]={backgroundColor:t.lineHighlight},a.backgroundColor=t.lineHighlight),r[".cm-activeLineGutter"]=a,t.selection&&(r["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:t.selection+" !important"}),t.selectionMatch&&(r["& .cm-selectionMatch"]={backgroundColor:t.selectionMatch});var i=xo.theme(r,{dark:o==="dark"}),l=vo.define(n),u=[i,Co(l)];return u},Ho={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#f0f0f0",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},$o=[{tag:[d.keyword,d.operatorKeyword,d.modifier,d.color,d.constant(d.name),d.standard(d.name),d.standard(d.tagName),d.special(d.brace),d.atom,d.bool,d.special(d.variableName)],color:"#0000ff"},{tag:[d.moduleKeyword,d.controlKeyword],color:"#af00db"},{tag:[d.name,d.deleted,d.character,d.macroName,d.propertyName,d.variableName,d.labelName,d.definition(d.name)],color:"#0070c1"},{tag:d.heading,fontWeight:"bold",color:"#0070c1"},{tag:[d.typeName,d.className,d.tagName,d.number,d.changed,d.annotation,d.self,d.namespace],color:"#267f99"},{tag:[d.function(d.variableName),d.function(d.propertyName)],color:"#795e26"},{tag:[d.number],color:"#098658"},{tag:[d.operator,d.punctuation,d.separator,d.url,d.escape,d.regexp],color:"#383a42"},{tag:[d.regexp],color:"#af00db"},{tag:[d.special(d.string),d.processingInstruction,d.string,d.inserted],color:"#a31515"},{tag:[d.angleBracket],color:"#383a42"},{tag:d.strong,fontWeight:"bold"},{tag:d.emphasis,fontStyle:"italic"},{tag:d.strikethrough,textDecoration:"line-through"},{tag:[d.meta,d.comment],color:"#008000"},{tag:d.link,color:"#4078f2",textDecoration:"underline"},{tag:d.invalid,color:"#e45649"}];function Yo(e){var{theme:o="dark",settings:t={},styles:n=[]}=e||{};return pt({theme:o,settings:nt({},Ho,t),styles:[...$o,...n]})}var hs=Yo(),Uo={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},Ko=[{tag:[d.keyword,d.operatorKeyword,d.modifier,d.color,d.constant(d.name),d.standard(d.name),d.standard(d.tagName),d.special(d.brace),d.atom,d.bool,d.special(d.variableName)],color:"#569cd6"},{tag:[d.controlKeyword,d.moduleKeyword],color:"#c586c0"},{tag:[d.name,d.deleted,d.character,d.macroName,d.propertyName,d.variableName,d.labelName,d.definition(d.name)],color:"#9cdcfe"},{tag:d.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[d.typeName,d.className,d.tagName,d.number,d.changed,d.annotation,d.self,d.namespace],color:"#4ec9b0"},{tag:[d.function(d.variableName),d.function(d.propertyName)],color:"#dcdcaa"},{tag:[d.number],color:"#b5cea8"},{tag:[d.operator,d.punctuation,d.separator,d.url,d.escape,d.regexp],color:"#d4d4d4"},{tag:[d.regexp],color:"#d16969"},{tag:[d.special(d.string),d.processingInstruction,d.string,d.inserted],color:"#ce9178"},{tag:[d.angleBracket],color:"#808080"},{tag:d.strong,fontWeight:"bold"},{tag:d.emphasis,fontStyle:"italic"},{tag:d.strikethrough,textDecoration:"line-through"},{tag:[d.meta,d.comment],color:"#6a9955"},{tag:d.link,color:"#6a9955",textDecoration:"underline"},{tag:d.invalid,color:"#ff0000"}];function zo(e){var{theme:o="dark",settings:t={},styles:n=[]}=e||{};return pt({theme:o,settings:nt({},Uo,t),styles:[...Ko,...n]})}var vs=zo(),Xo=qt;function Wo(e){return typeof e=="function"?e:Xo}var qo=Wo,Jo=Zt,Zo=qo,Qo=oo,en=9007199254740991,_e=4294967295,tn=Math.min;function on(e,o){if(e=Qo(e),e<1||e>en)return[];var t=_e,n=tn(e,_e);o=Zo(o),e-=_e;for(var r=Jo(n,o);++t<e;)o(t);return r}var nn=on;const rn=Jt(nn),sn=e=>c.jsx(k.div,{className:"dark:bg-white-400 aspect-square rounded-full bg-gray-400",animate:{translateY:["0%","-50%","0%","0%","0%"]},style:{translateX:.5,width:3,height:3},transition:{repeat:1/0,type:"keyframes",delay:e/10,duration:.7}},e),an=()=>c.jsx(k.div,{className:"grid h-full max-w-full flex-1 grid-cols-3 items-center gap-[0.4] p-1",children:rn(3,e=>sn(e))});function cn(e){switch(e){case"dark_gray":return{normal:"text-token-text-secondary dark:text-white-400",hover:"cursor-pointer hover:text-token-text-primary group-hover:text-token-text-primary"};case"light_gray":return{normal:"text-gray-400",hover:"cursor-pointer hover:text-token-text-secondary group-hover:text-token-text-secondary"}}}function Re({children:e,className:o,onClick:t,isClickable:n=!1,theme:r="dark_gray"}){const s=cn(r),a=(t!=null||n)&&s.hover;return c.jsxs("div",{className:M("relative inline-block h-[20px] w-[20px] shrink-0 transition-opacity",o,a,s.normal),onClick:t,children:[e?c.jsx(So,{className:"h-[20px] w-[20px] shrink-0"}):c.jsx(Po,{className:"h-[20px] w-[20px] shrink-0"}),c.jsx("span",{className:M("absolute inset-0 flex items-center justify-center text-[8px] font-black",a,s.normal),children:e})]})}function he(){return c.jsx(Re,{theme:"light_gray",children:c.jsx(an,{})})}function ln({count:e,isLoading:o,onClick:t}){return o?c.jsx(he,{}):c.jsx(Re,{onClick:t,theme:"dark_gray",children:e})}function un({isLoading:e=!1,onClick:o}){return e?c.jsx(he,{}):c.jsx(Re,{isClickable:!0,onClick:o,theme:"light_gray"})}var H=(e=>(e[e.up=-1]="up",e[e.down=1]="down",e))(H||{}),ce=(e=>(e.COMMENT="comment",e.COMPOSER="composer",e))(ce||{}),L=(e=>(e.COLLAPSED="collapsed",e.EXPANDED="expanded",e))(L||{});const gt=([e,o],[t,n])=>{const r=e+o,s=t+n;return e<s&&t<r},Se=([e,o])=>e+o,J=e=>{if(e.type===L.COLLAPSED)return[e.offsetY??0,0];const{offsetY:o,shiftY:t=0,height:n=0}=e,r=o+t;return t<0?[r,n+Math.abs(t)]:[r,n]},dn=(e,o,t)=>{if(!gt(e,o))return null;const[n,r]=e,s=n+r,[a,i]=o,l=a+i,u=a-s,f=l-n;return t===H.up?u:f};var ht=(e=>(e.ABOVE="above",e.BELOW="below",e))(ht||{});function ee(e,o){return ie(e.coordsAtPos(o))}const Ke=360,fn=250,vt=44,ze=.5,Xe=[.5,.9,1],mn=[1,.75,.2],pn=({onClose:e,onSubmit:o,opensOverDocument:t=!1,opensFromGutter:n=!1,gutterHasComments:r=!1},s)=>{const a=Me(),i=g.useRef(null),l=g.useRef(!1),[u,f]=g.useState(""),[m,p]=g.useState(!0),h=()=>{f(""),e?.(l.current)},v=(T=u)=>{l.current=!0,o?.(T),f("")},x=Qt(({windowWidth:T})=>t?T<Ke+100?fn:Ke:se,0),C={};n&&(C.top=-12),t&&n?C.right=0:C.left=0;let E="";n&&!t?E="8px 50%":n&&t?E="calc(100% + 8px) 50%":t&&(E="center left");let _=0;n&&!t&&r&&(_=ct);const A=T=>{const{metaKey:S,shiftKey:P,key:O}=T;O==="Enter"&&u&&!(P||S)?(v(),T.preventDefault()):O==="Escape"&&(f(""),e?.(!1))},b=a.formatMessage({id:"VvfbvY",defaultMessage:"Edit or explain..."});return c.jsx(k.div,{ref:Vo(i,s),className:M("absolute flex items-center",B.commentComposer),style:{...C,minHeight:vt},transition:{type:"spring",bounce:.18,duration:.48},initial:{translateX:0},animate:{translateX:_},exit:{translateX:0},children:c.jsx(k.div,{className:M("no-scrollbar relative z-10 flex items-center overflow-x-hidden border border-token-border-light",it,{"rounded-full":m,"rounded-2xl":!m}),initial:{width:t?se:24,scaleX:t?ze:void 0,scale:t?void 0:ze},animate:{width:x,scaleX:t?Xe:void 0,scale:t?void 0:Xe},exit:{filter:"blur(16px)",scale:t?void 0:mn,width:t?se:24,opacity:t?0:[1,1,0]},transition:{type:"spring",bounce:t?.14:0,duration:.28,scale:{type:"tween",duration:.2},opacity:{type:"tween",time:[0,.95,1]}},style:{transformOrigin:E},children:c.jsxs(k.div,{className:"relative z-0 flex w-full items-center bg-token-main-surface-primary px-4 py-2.5",children:[c.jsx(k.div,{className:"backdrop-saturate-25 absolute inset-0 z-[-1] bg-gray-50/75 backdrop-blur-3xl dark:bg-gray-700/75",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.2}}),c.jsx(Bo,{"aria-placeholder":b,value:u,className:"w-full resize-none border-0 bg-transparent px-1 py-0 pr-2 text-token-text-primary outline-0 placeholder:text-token-text-secondary focus:ring-0 focus-visible:ring-0",autoFocus:!0,maxRows:4,onBlur:h,onHeightChange:(T,{rowHeight:S})=>{p(Math.floor(T/S)<=1)},onChange:({target:{value:T}})=>f(T),onKeyDown:A}),!u&&c.jsx("span",{"aria-hidden":!0,className:"absolute inline-block text-nowrap pl-1 text-token-text-secondary",children:b}),c.jsx(k.button,{className:M("-mr-1.5 h-6 w-6 rounded-full bg-black text-center dark:bg-white",{"self-end":!m}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},onMouseDown:()=>v(),children:c.jsx(Ao,{className:"h-6 w-6 text-white dark:text-black"})})]})})})},Ct=g.forwardRef(pn),gn=(e,o)=>{if(o?.type!==Y.SELECTION)return null;try{const{from:t,to:n}=o,{top:r}=e.dom.getBoundingClientRect(),{bottom:s,top:a}=ee(e,t),{bottom:i}=ee(e,n),l=pe(e)?-30:-24;let u=s-r+l;const f=a-r;return u=i-r+8,{composerTop:u,loadingTop:f}}catch(t){return D.logError("Invalid position in SelectionCommentComposer",t),null}},hn=({toolbarPosition:e,composerRect:o,view:t})=>{let{width:n,height:r}=o;if(r||=vt,t==null||e==null)return null;const{right:s,left:a}=t.dom.getBoundingClientRect(),{left:i,top:l,aboveOrBelow:u,toolbarSize:f}=e,m=l-(u===ht.ABOVE&&r!==0?r-f.height:0),p=Eo(t)?12:0;return{left:Math.min(i,s-a-n-p),composerTop:m,aboveOrBelow:u}},vn=({toolbarPosition:e,commentingOn:o,isWaitingForCommentResponse:t=!1,onAddComment:n})=>{const r=me()(),[s,a]=fe(),i=hn({view:r,toolbarPosition:e,composerRect:s});if(r==null||i==null)return null;const{left:l,composerTop:u}=i,f=m=>{if(o?.type!==Y.SELECTION)return;const{action:p,sourceRange:h}=o;n?.(m,p,h,o.type)};return c.jsx(X,{children:o?.type===Y.SELECTION&&!t&&c.jsx("div",{className:M("absolute",B.commentComposer),style:{left:l,top:u},children:c.jsx(Ct,{opensOverDocument:!0,onClose:m=>{m||(w.cancelCommentingOn(),r&&pe(r)&&!r.state.selection.empty&&r.dispatch(r.state.tr.setSelection(new Ro(r.state.selection.$from))),document.getSelection()?.removeAllRanges())},onSubmit:f,ref:a})},"composer")})};function xt(e,o){return o?e.getState(o)??null:null}function Cn(e){return e.nodeSize-2}function xn(e,o){return o>=0&&o<=Cn(e)}class U{constructor(o,t,n={}){this.match=o,this.match=o,this.handler=typeof t=="string"?En(t):t,this.undoable=n.undoable!==!1,this.inCode=n.inCode||!1}}function En(e){return function(o,t,n,r){let s=e;if(t[1]){let a=t[0].lastIndexOf(t[1]);s+=t[0].slice(a+t[1].length),n+=a;let i=n-r;i>0&&(s=t[0].slice(a-i,a)+s,n=r)}return o.tr.insertText(s,n,r)}}const _n=500;function Cs({rules:e}){let o=new dt({state:{init(){return null},apply(t,n){let r=t.getMeta(this);return r||(t.selectionSet||t.docChanged?null:n)}},props:{handleTextInput(t,n,r,s){return We(t,n,r,s,e,o)},handleDOMEvents:{compositionend:t=>{setTimeout(()=>{let{$cursor:n}=t.state.selection;n&&We(t,n.pos,n.pos,"",e,o)})}}},isInputRules:!0});return o}function We(e,o,t,n,r,s){if(e.composing)return!1;let a=e.state,i=a.doc.resolve(o),l=i.parent.textBetween(Math.max(0,i.parentOffset-_n),i.parentOffset,null,"￼")+n;for(let u=0;u<r.length;u++){let f=r[u];if(i.parent.type.spec.code){if(!f.inCode)continue}else if(f.inCode==="only")continue;let m=f.match.exec(l),p=m&&f.handler(a,m,o-(m[0].length-n.length),t);if(p)return f.undoable&&p.setMeta(s,{transform:p,from:o,to:t,text:n}),e.dispatch(p),!0}return!1}new U(/--$/,"—");new U(/\.\.\.$/,"…");new U(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“");new U(/"$/,"”");new U(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘");new U(/'$/,"’");function xs(e,o,t=null,n){return new U(e,(r,s,a,i)=>{let l=t instanceof Function?t(s):t,u=r.tr.delete(a,i),f=u.doc.resolve(a),m=f.blockRange(),p=m&&Lo(m,o,l);if(!p)return null;u.wrap(m,p);let h=u.doc.resolve(a-1).nodeBefore;return h&&h.type==o&&wo(u.doc,a-1)&&(!n||n(s,h))&&u.join(a-1),u})}function bn(e,o,t=null){return new U(e,(n,r,s,a)=>{let i=n.doc.resolve(s),l=t instanceof Function?t(r):t;return i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),o)?n.tr.delete(s,a).setBlockType(s,s,o,l):null})}function Le(e,o,t,n={}){if(e==null)return null;const r=(Array.isArray(t)?t:[t]).filter(no),s=o.nodes[e].createAndFill(n,r);return s??null}const yn={content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},Nn="paragraph";class Et extends ge{unistNodeName(){return Nn}static proseMirrorNodeName(){return"paragraph"}proseMirrorNodeSpec(){return yn}unistNodeToProseMirrorNodes({schema:o,convertedChildren:t,attrs:n}){return Le(this.proseMirrorNodeName(),o,t,n)}proseMirrorNodeToUnistNodes(o,t){return[{type:this.unistNodeName(),children:t}]}}const Tn=(e,o,t,n)=>e.value?o.text(e.value,[o.marks.startend.create(t),...n??[]]):null;class Sn extends ge{unistNodeName(){return"text"}static proseMirrorNodeName(){return"text"}proseMirrorNodeSpec(){return{group:"inline"}}unistNodeToProseMirrorNodes({node:o,schema:t,attrs:n}){return Tn(o,t,n)}proseMirrorNodeToUnistNodes(o){return[{type:this.unistNodeName(),value:o.text??""}]}}class q extends ge{static isAtStart(o,t){return o.selection.empty?t!==void 0?t.endOfTextblock("backward",o):o.selection.$anchor.parentOffset>0:!1}static headingLevelCommandBuilder(o,t,n){return(r,s,a)=>{if(n&&!q.isAtStart(r,a))return!1;const{$anchor:i}=r.selection,l=i.parent;if(l.type.name!=="heading")return!1;const u=l.attrs.level+t;if(u<0||u>6)return!1;if(s===void 0)return!0;const f=i.before(i.depth);return u>0?s(r.tr.setNodeMarkup(f,void 0,{level:u})):s(r.tr.setNodeMarkup(f,o.nodes.paragraph)),!0}}dependencies(){return[new Et,new Sn]}unistNodeName(){return"heading"}static proseMirrorNodeName(){return"heading"}proseMirrorNodeSpec(){return{attrs:{level:{default:1}},content:"text*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(o){return["h"+o.attrs.level.toString(),0]}}}proseMirrorInputRules(o){return[bn(/^\s{0,3}(#{1,6})\s$/,o.nodes[this.proseMirrorNodeName()],t=>({level:t[1].length}))]}proseMirrorKeymap(o){const t={Tab:q.headingLevelCommandBuilder(o,1,!1),"#":q.headingLevelCommandBuilder(o,1,!0),"Shift-Tab":q.headingLevelCommandBuilder(o,-1,!1)};for(let n=1;n<=6;n++)t[`Shift-Mod-${n.toString()}`]=Mo(o.nodes[this.proseMirrorNodeName()],{level:n});return t}unistNodeToProseMirrorNodes({node:o,schema:t,convertedChildren:n,attrs:r}){const{depth:s}=o;return Le(this.proseMirrorNodeName(),t,n,{...r,level:s})}proseMirrorNodeToUnistNodes(o,t){return[{type:this.unistNodeName(),depth:o.attrs.level,children:t}]}}class Pn extends ge{unistNodeName(){return"root"}static proseMirrorNodeName(){return"doc"}proseMirrorNodeSpec(){return{content:"block+"}}unistNodeToProseMirrorNodes({schema:o,convertedChildren:t,attrs:n}){return Le(this.proseMirrorNodeName(),o,t,n)}proseMirrorNodeToUnistNodes(o,t){return[{type:this.unistNodeName(),children:t}]}}function Pe(e,o,t=0,n=null){let r=!1;return e.forEach((s,a)=>{Pe(s,o,t+a+(e.type.name===Pn.proseMirrorNodeName()?0:1),e)===!1&&(r=!0)}),r?r?!1:void 0:o(e,t,n)}function An(e,o){const t=new Array(o.length).fill(-1),n=()=>!t.includes(-1);let r=!1;const s=(a,i)=>{const l=_o(a);if(l==null)return;const{start:u,end:f}=l;for(let m=0;m<o.length;m++){const p=o[m];t[m]===-1&&(p>=u&&p<f&&(a.type.name!=="doc"||r)||p==f&&r||p<u&&p<f&&r&&p>=0)&&(p===f&&(t[m]=i+a.nodeSize),a.content.size===0&&(a.text?.length??0)===0?t[m]=i:t[m]=Math.min(i+Math.max(p-u,0),i+a.nodeSize))}if(n())return!1};Pe(e,s),r=!0,n()||Pe(e,s);for(let a=0;a<t.length;a++)t[a]===-1&&(o[a]<=0?t[a]=0:t[a]=e.nodeSize-2);return t}function In(e,o){const t=Rn(e);if(t.length===0)return o;let n=o;return t.forEach(r=>{n=On(r,n)}),n}function On(e,o){return bo(o,{start:e.from,end:e.to},Mn(e))}function Mn(e){return e.slice.size-(e.to-e.from)}function Rn(e){return e.steps.filter(o=>o instanceof ko)}const le=new Do("comments");function qe(e,o){const t=o.map(s=>s.at.start),n=o.map(s=>s.at.end),r=An(e,[...t,...n]);return new Map(o.map((s,a)=>[s.id,{start:r[a],end:r[a+o.length]}]))}function Ln(e,o){const{type:t}=o;if(t===Y.SELECTION){const{from:s,to:a}=o;return[s,a]}const{pos:n}=o,r=n+(e.nodeAt(n)?.nodeSize??0);return[n,r]}const Je=(e,o,t=null,n=null)=>{const r=[],s=Array.from(o.entries()).reverse(),a=new Map(e.map(i=>[i.id,i]));for(const[i,l]of s){const u=a.get(i),p=No({isHovered:t===i,isFocused:n===i,isCode:!1,diffStatus:u?.diffStatus});r.push(ft.inline(l.start,l.end,{class:p,"data-comment-id":i,nodeName:"span"}))}return r},Es=e=>new dt({key:le,state:{init:(o,{doc:t})=>{const n=qe(t,e);return{comments:e,commentingOn:null,hoveredOnBlock:null,hoveredCommentId:null,focusedCommentId:null,decorations:Je(e,n),positions:n}},apply:(o,t)=>{const n=o.getMeta(le)??{},r=n.comments,s=r??t.comments,a=r!=null?qe(o.doc,s):t.positions;let i=n.commentingOn;i===void 0&&(i=t.commentingOn);let l=n.hoveredCommentId;l===void 0&&(l=t.hoveredCommentId);let u=n.focusedCommentId;u===void 0&&(u=t.focusedCommentId);const f=In(o,a),m=yo(s,f);return{comments:m,commentingOn:i,hoveredCommentId:l,focusedCommentId:u,decorations:Je(m,f,l,u),positions:f}}},props:{handleClickOn:(o,t,n,r,s)=>{const{target:a}=s;if(a instanceof HTMLElement){const{commentId:i}=a.dataset;if(!i)return;w.focusComment(i)}},handleDOMEvents:{mouseover(o,t){const{target:n}=t;if(n instanceof HTMLElement){const{commentId:r}=n.dataset;r?w.mouseEnterComment(r):w.mouseLeaveComment()}}},decorations(o){const t=this.getState(o);if(!t)return Ye.empty;const{commentingOn:n,decorations:r}=t,{doc:s}=o;if(n){const[a,i]=Ln(s,n);a!=null&&i!=null&&r.push(ft.inline(a,i,{class:ro.document},{comment:{pattern:n}}))}return Ye.create(s,r.concat())}}});function wn(e,o,t){const n=e+o;for(const r of t.values()){const s=r.start,a=r.end;if(e<a&&s<n)return!0}return!1}const kn=50,Dn=200,jn=[Et.proseMirrorNodeName(),q.proseMirrorNodeName()],Bn=e=>e?e.isBlock:!1,Gn=e=>{if(!e)return!1;const{isBlock:o,type:{name:t}}=e;return o&&jn.includes(t)},Vn=(e,o,t,n)=>{const r=e.posAtCoords({left:o,top:t});if(r==null)return;const{pos:s,inside:a}=r;if(a===-1)return;const{state:i}=e;let l=s,u=i.doc.nodeAt(l);for(;!Bn(u)&&l>=0;)l--,u=i.doc.nodeAt(l);if(!u||!Gn(u))return;const f=n!=null&&wn(l,u.nodeSize,n);return{node:u,nodeHasComment:f,pos:l}};function Fn(e,o,t){const n=Vn(e,o.x,o.y,t);if(n==null)return null;const{node:r,pos:s,nodeHasComment:a}=n,{top:i}=e.coordsAtPos(0);function l(){const h=s+1;return xn(e.state.doc,h)&&e.state.doc.nodeAt(h)?.isText?e.coordsAtPos(h).top:e.coordsAtPos(s).top}const u=l(),f=u-i;return{height:e.coordsAtPos(s+r.nodeSize-1).bottom-u,nodeHasComment:a,mouseEnteredAt:Date.now(),yOffset:f,pos:s}}function Hn(e){const o=g.useRef(!1),t=g.useRef(!1),[n,r]=g.useState(null),s=To(),a=s()?.dom,i=g.useRef(!1),l=V(({visibleBlockCommentLauncher_DEBUG_ONLY:m})=>m),u=g.useCallback(so(m=>{o.current=!0;const{commentingOn:p}=V.getState();if(t.current||p!=null)return;const h=s();if(h==null||!o.current)return r(null);const{dom:v,state:x}=h,C=xt(le,x)?.positions;if(C==null)return r(null);const E=Fn(h,m,C);if(E==null||E.nodeHasComment&&e===j.COLLAPSED){r(null);return}if(i.current&&E.yOffset!==n?.yOffset){r(null);return}const _=h.coordsAtPos(0),A=v.getBoundingClientRect().width,T=(m.x-_.left)/A>=kn/100;r(T?E:null)},Dn),[s,i,n]);g.useEffect(()=>{if(a!=null)return rt(a,{mouseenter:()=>{o.current=!0,t.current=!1},mouseleave:({relatedTarget:m})=>{if(u.cancel(),m instanceof HTMLElement&&m.closest("[data-block-comment-launcher]")){t.current=!0;return}t.current=!1,o.current=!1,V.getState().commentingOn==null&&r(null)},mousemove:u})},[s,a,e,u]);const f=g.useCallback(({relatedTarget:m})=>{const{commentingOn:p}=V.getState();p==null&&m!==a&&(t.current=!1,r(null))},[a]);return{visibleBlockComment:l??n,handleMouseLeave:f,onComposerVisibleChange:m=>{i.current=m}}}const $n=({isWaitingForCommentResponse:e=!1,opensOverDocument:o=!1,hasComments:t=!1,activeBlockComment:n,composerRef:r,onLaunchComposer:s,onMouseLeave:a,onSubmit:i})=>{const[l,u]=g.useState(!1),{yOffset:f,height:m,pos:p}=n,h=()=>{u(!0),s?.(),D.logButtonClick(W.BLOCK_COMMENT_LAUNCHER),w.startCommentingOn({type:Y.BLOCK,pos:p})},v=E=>{E||(u(!1),w.cancelCommentingOn())},x=E=>{u(!1),i?.(E)};g.useEffect(()=>()=>{w.mouseLeaveBlock()},[]);const C=t&&l?o?-88:88:0;return c.jsx(k.div,{className:M("pointer-events-auto absolute flex h-6 w-5 origin-[14px_50%] items-start after:absolute after:-inset-4 after:content-['']",B.commentComposer),initial:!1,animate:{opacity:1},exit:{opacity:0},transition:{type:"spring",duration:.2,bounce:.1},style:{top:0,height:m,translateY:f},onMouseLeave:a,"data-block-comment-launcher":!0,children:c.jsxs(X,{children:[l?c.jsx(Ct,{ref:r,opensFromGutter:!0,onClose:v,onSubmit:x,gutterHasComments:t,opensOverDocument:o},"composer"):null,c.jsx(k.button,{initial:{opacity:0},animate:{opacity:l?0:1,translateX:C},transition:{duration:.15,translateX:{type:"spring",bounce:.18,duration:.48}},className:"group absolute z-10 flex h-6 gap-1 bg-transparent after:absolute after:-inset-y-4 after:-left-1 after:-right-4 after:content-['']",onClick:h,onMouseEnter:()=>w.mouseEnterBlock(p),onMouseLeave:()=>w.mouseLeaveBlock(),disabled:l||e,children:c.jsx(un,{isLoading:e})},"launcer")]})})},Yn=({isWaitingForCommentResponse:e=!1,isRequestActive:o=!1,hasComments:t=!1,composerRef:n,gutterMode:r,onAddComment:s})=>{const a=lt(),{visibleBlockComment:i,handleMouseLeave:l,onComposerVisibleChange:u}=Hn(r),f=m=>{if(!i||!a)return;const{doc:p}=a,{pos:h}=i,v=p.nodeAt(h);if(!v)return;const{attrs:{start:x,end:C}}=v;s?.(m,ut.ASK,{start:x,end:C},Y.BLOCK)};return c.jsx(X,{onExitComplete:()=>u(!1),children:i&&a&&(e||!o)&&c.jsx($n,{composerRef:n,isWaitingForCommentResponse:e,opensOverDocument:r===j.COLLAPSED,activeBlockComment:i,hasComments:t,onSubmit:f,onMouseLeave:l,onLaunchComposer:()=>u(!0)},"launcher")})},_t={type:"spring",bounce:.12,duration:.5},bt="opacity-50",Un=({count:e,offsetY:o,isLoading:t=!1,onClick:n})=>c.jsx(k.div,{className:M("absolute",B.collapsedComment),initial:{opacity:0},animate:{opacity:1},style:{translateY:o},transition:_t,exit:{opacity:0},children:c.jsx(ln,{count:e,isLoading:t,onClick:n})}),Kn=({isFocused:e,isHovered:o})=>{const t=e||o?"grow font-medium text-token-text-primary transition-colors":"grow font-medium text-token-text-secondary transition-colors",n=e||o?"opacity-100 transition":"opacity-75 transition";return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:n,children:c.jsx("div",{className:"gizmo-bot-avatar rounded-full",children:c.jsx(ao,{size:"gizmoConversation",iconName:"openai"})})}),c.jsx("span",{className:t,children:"ChatGPT"})]})},zn=({comment:e,isFocused:o,isSomeCommentFocused:t,isHovered:n})=>{const r=e.diffStatus===Ne.REMOVED;return c.jsx("div",{className:M("mt-2 text-token-text-primary transition-all",{"opacity-80":!o&&!t&&!n&&!r,"opacity-40":!o&&t&&!n&&!r,[bt]:r}),children:e.content})},Xn=({left:e,right:o,comment:t,disableAnimations:n=!1,onClick:r,onMouseEnter:s,onMouseLeave:a,onAccept:i,onDismiss:l,translateY:u,isFocused:f=!1,isSomeCommentFocused:m=!1,disableActions:p=!1,isHovered:h=!1},v)=>{const[x,C]=g.useState(!1),E=t.diffStatus===Ne.ADDED,_=t.diffStatus===Ne.REMOVED,A=t.diffStatus!=null,b=()=>{C(!0),s?.()},T=()=>{C(!1),a?.()},S=Me(),P=f||x&&!m;return c.jsx(k.div,{ref:v,className:M("absolute",B.expandedComment,{"cursor-default":f,"cursor-pointer":!f,[B.expandedCommentFocused]:f,[B.expandedCommentHovered]:h}),style:{left:e,right:o},initial:n?!1:{translateY:u,scale:.85,opacity:0},animate:n?void 0:{translateY:u,scale:f?1:.97,opacity:1},exit:n?void 0:{scale:.85,opacity:0,filter:"blur(16px)"},transition:_t,onClick:r,onMouseEnter:p?void 0:b,onMouseLeave:p?void 0:T,"data-comment-id":t.id,children:c.jsxs("div",{className:M("flex min-h-8 flex-col overflow-hidden rounded-2xl border p-4 pt-2 text-left text-sm transition-all",{"border-transparent bg-gray-50 dark:bg-gray-800":!f&&!h,"border-token-border-light bg-token-main-surface-primary":h&&!f,"border-token-border-light bg-token-main-surface-primary shadow-xl":f||x&&!m,"relative after:absolute after:bottom-0 after:left-0 after:top-0 after:w-1":A,"after:bg-green-500":E,"after:bg-red-500":_}),style:{width:se},children:[c.jsxs("div",{className:M("flex h-8 flex-row items-center gap-2.5",{[bt]:_}),children:[c.jsx(Kn,{isFocused:f,isHovered:h}),c.jsx("button",{className:M("-mr-1 rounded-full bg-transparent p-1 text-token-text-secondary",{"cursor-pointer hover:bg-gray-100 hover:text-token-text-primary dark:hover:bg-gray-700":!p,"cursor-not-allowed":p}),onClick:l,disabled:p,"aria-label":S.formatMessage({id:"fYDa3C",defaultMessage:"Dismiss comment"}),children:c.jsx(Io,{className:"icon-sm"})})]}),c.jsx(zn,{comment:t,isFocused:f,isHovered:h,isSomeCommentFocused:m}),c.jsx(X,{initial:!1,children:P&&c.jsx(k.div,{initial:n?!1:{opacity:0,height:0},animate:{opacity:1,height:"auto",transition:{opacity:{delay:.14,duration:.2},height:{bounce:0,duration:.2}}},exit:n?void 0:{opacity:0,height:0,transition:{opacity:{duration:.08},height:{bounce:0,duration:.2}}},className:"flex items-center justify-start",children:c.jsx("div",{className:"mt-2.5",children:c.jsx(eo,{color:"secondary",onClick:i,disabled:p,children:S.formatMessage({id:"WIW5OL",defaultMessage:"Apply"})})})})})]})})},yt=g.forwardRef(Xn),Wn=({offsetY:e,opensOverDocument:o=!1,disableActions:t=!1,isFocused:n=!1,isSomeCommentFocused:r=!1,onAccept:s,onClick:a,onDismiss:i,onMouseEnter:l,onMouseLeave:u,comment:f,isHovered:m=!1})=>{const p=g.useRef(null);return g.useEffect(()=>rt(document,{mousedown:({target:h})=>{h instanceof HTMLElement&&!h.closest("[data-comment-id]")&&!p.current?.contains(h)&&w.blurComment()}})),c.jsx(yt,{ref:p,comment:f,disableActions:t,onAccept:s,onDismiss:i,onMouseEnter:l,onMouseLeave:u,isSomeCommentFocused:r,isHovered:m,onClick:a,translateY:e,isFocused:n,left:o?void 0:ct,right:o?io:void 0})},qn=({onAcceptComment:e,onDismissComment:o,disableActions:t=!1,entry:n,isGutterCollapsed:r=!1,isHovered:s=!1,isFocused:a=!1,isSomeCommentFocused:i=!1})=>{const{offsetY:l,type:u}=n,[f,m]=co();let p=null;if(u===L.COLLAPSED)p=!a&&c.jsx(Un,{offsetY:l,count:n.count,onClick:()=>{D.logButtonClick(W.COLLAPSED_COMMENT),w.focusComment(n.children[0])}},"collapsed");else{const{comment:h}=n;if(h==null||h.content===""||h.status===Fe.DISMISSED)p=null;else if(h.status===Fe.ACCEPT_INITIATED)p=c.jsx("div",{className:"absolute",style:{top:l},children:c.jsx(he,{})},"loading");else{const{id:v}=h;p=c.jsx(Wn,{isSomeCommentFocused:i,isHovered:s,isFocused:a,offsetY:l,disableActions:t,onClick:()=>{D.logButtonClick(W.EXPANDED_COMMENT),w.focusComment(v)},onMouseEnter:()=>w.mouseEnterComment(v),onMouseLeave:()=>w.mouseLeaveComment(),comment:h,onAccept:()=>{D.logButtonClick(W.COMMENT_ACCEPT,{commentId:v}),e?.(v)},onDismiss:()=>{D.logButtonClick(W.COMMENT_DISMISS,{commentId:v}),o?.(v)},opensOverDocument:r},"expanded")}}return c.jsx(X,{onExitComplete:()=>m?.(),children:f&&p})},Ze=({onMeasureHeight:e,comment:o,isFocused:t=!1})=>{const[{height:n},r]=fe();return st(()=>{e?.(n)},[n]),c.jsx(yt,{ref:r,comment:o,isFocused:t,disableAnimations:!0})},Jn=({comments:e,onMeasure:o,getStableCommentId:t})=>{const n=g.useRef(new Map),r=g.useRef(new Map),s=g.useRef(null),a=(i,l,u=!1)=>{l&&(u?r.current.set(t(i),l):n.current.set(t(i),l),s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{o?.({focusedHeights:new Map(r.current),heights:new Map(n.current)}),s.current=null}))};return e?.length?c.jsxs("div",{className:"pointer-events-none invisible fixed left-0 top-0 overflow-clip","aria-hidden":"true",children:[e.map(i=>c.jsx(Ze,{comment:i,onMeasureHeight:l=>a(i.id,l)},t(i.id))),e.map(i=>c.jsx(Ze,{isFocused:!0,comment:i,onMeasureHeight:l=>a(i.id,l,!0)},`${t(i.id)}-focused`))]}):null},Qe=(e,o,t)=>{let n=t+o;for(;o===H.down?n<e.length:n>-1;){const r=e[n],s=e[n-o],a=dn(J(r),J(s),o);if(a!=null&&r.type!==L.COLLAPSED)r.shiftY+=a;else break;n+=o}},et=(e,o)=>{for(const t of o){const{index:n,amount:r}=t,s=e[n];s.type===L.EXPANDED&&(s.shiftY+=r),Qe(e,H.down,n),Qe(e,H.up,n);for(const a of e)a.type!==L.COLLAPSED&&(a.offsetY+=a.shiftY,a.shiftY=0)}},Zn=(e,o)=>{const t=[],[n,r]=o,s=n+r;for(let a=0;a<e.length;a++){const i=e[a],[l]=J(i),u=[l,i.type===L.EXPANDED?i.height:0],[f,m]=u;if(gt(u,o)){const p=f+m,h=n-p,v=s-f,C=(Math.abs(h)<Math.abs(v)?H.up:H.down)===H.up?h:v;t.push({index:a,amount:C})}}return t},Qn=({gutterMode:e,focusedCommentId:o,gutterPositions:t,getCommentKey:n,getComment:r})=>{if(!t?.size)return[];const s=new Map,a=[];let i=null,l=-1;for(const f of t.values()){if(f.type===ce.COMPOSER){i=[f.offsetY,f.height];continue}const{commentId:m,height:p,collapsedOffsetY:h,offsetY:v}=f;if(e===j.EXPANDED){const E=Te(a),_=E?Se(J(E)):0;let A=v;E&&A<=_&&(A=_),s.set(m,{originalOffsetY:v,offsetY:A}),o===m&&(l=a.length),a.push({key:n(m),comment:r(m),type:L.EXPANDED,height:p,offsetY:A,shiftY:0});continue}let x=a.findIndex(({offsetY:E,type:_})=>_===L.COLLAPSED&&E===h),C=a[x]??null;if(!C)C={key:a.length,type:L.COLLAPSED,offsetY:v,count:1,children:[m]},x=a.length,a.push(C);else{if(C.type!==L.COLLAPSED)throw new Error("Collapsed parent type expected to be collapsed");C.count+=1,C.children.push(m),C.offsetY=h}o===m&&(l=x)}const u=a[l];if(e===j.COLLAPSED&&u?.type===L.COLLAPSED){const f=[];for(let m=0;m<u.children.length;m++){const p=u.children[m];p===o&&(l+=m+1);const h=Te(f),v=h?Se(J(h)):0,x=t.get(p)?.offsetY??0,C=Math.max(v,x);s.set(p,{originalOffsetY:x,offsetY:C}),f.push({type:L.EXPANDED,key:n(p),comment:r(p),offsetY:C,height:t.get(p)?.height??0,shiftY:0})}a.splice(l,0,...f)}if(o){const f=s.get(o);if(!f)return a;const{offsetY:m,originalOffsetY:p}=f,h=p-m,v=[{amount:h,index:l}];let x=l+1;for(;x<a.length;){const C=a[x],{type:E}=C;let _=h;if(E===L.EXPANDED&&C.comment?.id){const{offsetY:A,originalOffsetY:b}=ie(s.get(C.comment.id));if(A===b)break;_=Math.max(b-A,h)}else break;v.push({amount:_,index:x}),x++}v.length&&et(a,v)}else if(e!==j.COLLAPSED&&i){const f=Zn(a,i);et(a,f)}return a},er=e=>{try{return Qn(e)}catch(o){return D.logError("Generating comment gutter entries",o),[]}},tr=e=>"length"in e?e.length===0:e.nodeSize===0,be=12,or=({composerHeight:e,getCommentHeight:o,getCollapsedStartPos:t,commentingOn:n,commentPositions:r,view:s})=>{if(!r||!s||tr(s.state.doc))return null;const{top:a}=s.dom.getBoundingClientRect(),i=Array.from(r.entries()).sort(([u,f],[m,p])=>f.start-p.start),l=new Map;for(const[u,{start:f}]of i)try{const m=t?.(f)??f,{top:p}=ee(s,m),{top:h}=ee(s,f),v=h-a,x=p-a,C=(o(u)??0)+be;l.set(u,{commentId:u,height:C,collapsedOffsetY:x,offsetY:v,type:ce.COMMENT})}catch{continue}if(n?.type===Y.BLOCK){const{pos:u}=n;try{const{top:f}=ee(s,u),p=f-a-be;l.set("block-composer",{type:ce.COMPOSER,height:(e??0)+be,offsetY:p})}catch{}}return l},Nt=(e,o)=>o.nodeAt(e)?.isBlock?e+1:Nt(e-1,o);function nr(e){const o=lt(),n=me()?.();if(!n)return null;if(pe(n)){if(!o)return null;const r=xt(le,o);return r?r.positions:null}return new Map(e.map(r=>[r.id,r.at]))}const rr=({gutterMode:e,focusedCommentId:o,commentingOn:t,comments:n,getStableId:r})=>{const[{height:s},a]=fe(),i=me(),[l,u]=g.useState(()=>new Map),[f,m]=g.useState(()=>new Map),p=g.useCallback(({focusedHeights:b,heights:T})=>{u(b),m(T)},[]),h=b=>{const T=r(b);return b===o?l.get(T)??0:f.get(T)??0},v=i(),x=v!=null&&pe(v)?b=>Nt(b,v.state.doc):void 0,C=new Map(n?.map(b=>[r(b.id),b])),E=nr(n),_=or({composerHeight:s,commentingOn:t,getCommentHeight:h,getCollapsedStartPos:x,commentPositions:E,view:v}),A=er({gutterMode:e,gutterPositions:_,focusedCommentId:o,getComment:b=>C.get(r(b))??null,getCommentKey:r});return{blockComposerRef:a,onMeasureComments:p,gutterEntries:A}};function sr(){const o=me()(),t=V(({commentingOn:s})=>s),r=o==null?null:gn(o,t);return r==null?null:c.jsx(k.div,{className:"absolute",style:{top:r.loadingTop},initial:!1,animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{delay:.2},children:c.jsx(he,{})},"selection-loading")}const ar=e=>c.jsx("div",{className:"absolute",style:{top:Se(J(e))},children:c.jsx("div",{className:"h-[max(3rem,18vh)] w-1"})}),_s=({availableWidth:e,comments:o,commentsMode:t,disableBlockComments:n=!1,isRequestActive:r=!1,isWaitingForCommentResponse:s=!1,onAddComment:a,onAcceptComment:i,onDismissComment:l,getStableCommentId:u})=>{const f=V(({focusedCommentId:P})=>P),m=V(({hoveredCommentId:P})=>P),p=V(({commentingOn:P})=>P),h=e<He?j.COLLAPSED:j.EXPANDED,{onMeasureComments:v,blockComposerRef:x,gutterEntries:C}=rr({comments:o,getStableId:u,gutterMode:h,focusedCommentId:f,commentingOn:p}),E=C.length>0,_=p!=null&&!s&&p.type!=="selection"||E,b=(()=>{if(!_)return 0;switch(h){case j.COLLAPSED:return 0;case j.EXPANDED:return He}})(),T=p?.type==="selection",S=Te(C);return c.jsxs(k.div,{className:M("pointer-events-none relative flex h-full flex-shrink-0",B.commentGutter,h===j.COLLAPSED&&b?"basis-[32px]":"basis-0"),initial:{width:0,opacity:0},animate:{width:b,opacity:1},exit:{width:0,opacity:0},children:[c.jsx(Jn,{getStableCommentId:u,comments:o,onMeasure:v}),c.jsxs("div",{className:M("pointer-events-auto absolute bottom-0 left-0 top-0 w-0 overflow-visible",{"pl-2":_||!n}),children:[c.jsx(X,{children:C.map(P=>{const{key:O,type:oe}=P,ne=!!f&&oe===L.EXPANDED&&P.comment?.id===f,Q=!!f&&P.type===L.COLLAPSED&&P.children.includes(f);return c.jsx(qn,{isGutterCollapsed:h===j.COLLAPSED,isSomeCommentFocused:!!p||!!f,isHovered:oe===L.EXPANDED&&P.comment?.id===m,isFocused:ne||Q,entry:P,disableActions:r||s||t===$e.COMMENTS_READONLY,onAcceptComment:K=>{try{i?.(ie(o?.find(G=>G.id===K)))}catch(G){D.logError(`Comment ${K} not found`,G)}},onDismissComment:K=>{try{l?.(ie(o?.find(G=>G.id===K)))}catch(G){D.logError(`Comment ${K} not found`,G)}}},O)})}),E&&S&&c.jsx(ar,{...S}),t===$e.ENABLED&&!T&&!n&&c.jsx(Yn,{composerRef:x,gutterMode:h,onAddComment:a,isWaitingForCommentResponse:s,isRequestActive:r,hasComments:E}),s&&T&&c.jsx(sr,{})]})]})};function $(e,o,{checkForDefaultPrevented:t=!0}={}){return function(r){if(e?.(r),t===!1||!r.defaultPrevented)return o?.(r)}}function ve(e,o=[]){let t=[];function n(s,a){const i=g.createContext(a),l=t.length;t=[...t,a];function u(m){const{scope:p,children:h,...v}=m,x=p?.[e][l]||i,C=g.useMemo(()=>v,Object.values(v));return c.jsx(x.Provider,{value:C,children:h})}function f(m,p){const h=p?.[e][l]||i,v=g.useContext(h);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${m}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,f]}const r=()=>{const s=t.map(a=>g.createContext(a));return function(i){const l=i?.[e]||s;return g.useMemo(()=>({[`__scope${e}`]:{...i,[e]:l}}),[i,l])}};return r.scopeName=e,[n,ir(r,...o)]}function ir(...e){const o=e[0];if(e.length===1)return o;const t=()=>{const n=e.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(s){const a=n.reduce((i,{useScope:l,scopeName:u})=>{const m=l(s)[`__scope${u}`];return{...i,...m}},{});return g.useMemo(()=>({[`__scope${o.scopeName}`]:a}),[a])}};return t.scopeName=o.scopeName,t}function cr(e,o){typeof e=="function"?e(o):e!=null&&(e.current=o)}function Tt(...e){return o=>e.forEach(t=>cr(t,o))}function Ae(...e){return g.useCallback(Tt(...e),e)}var ue=g.forwardRef((e,o)=>{const{children:t,...n}=e,r=g.Children.toArray(t),s=r.find(ur);if(s){const a=s.props.children,i=r.map(l=>l===s?g.Children.count(a)>1?g.Children.only(null):g.isValidElement(a)?a.props.children:null:l);return c.jsx(Ie,{...n,ref:o,children:g.isValidElement(a)?g.cloneElement(a,void 0,i):null})}return c.jsx(Ie,{...n,ref:o,children:t})});ue.displayName="Slot";var Ie=g.forwardRef((e,o)=>{const{children:t,...n}=e;if(g.isValidElement(t)){const r=fr(t);return g.cloneElement(t,{...dr(n,t.props),ref:o?Tt(o,r):r})}return g.Children.count(t)>1?g.Children.only(null):null});Ie.displayName="SlotClone";var lr=({children:e})=>c.jsx(c.Fragment,{children:e});function ur(e){return g.isValidElement(e)&&e.type===lr}function dr(e,o){const t={...o};for(const n in o){const r=e[n],s=o[n];/^on[A-Z]/.test(n)?r&&s?t[n]=(...i)=>{s(...i),r(...i)}:r&&(t[n]=r):n==="style"?t[n]={...r,...s}:n==="className"&&(t[n]=[r,s].filter(Boolean).join(" "))}return{...e,...t}}function fr(e){let o=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=o&&"isReactWarning"in o&&o.isReactWarning;return t?e.ref:(o=Object.getOwnPropertyDescriptor(e,"ref")?.get,t=o&&"isReactWarning"in o&&o.isReactWarning,t?e.props.ref:e.props.ref||e.ref)}function mr(e){const o=e+"CollectionProvider",[t,n]=ve(o),[r,s]=t(o,{collectionRef:{current:null},itemMap:new Map}),a=h=>{const{scope:v,children:x}=h,C=R.useRef(null),E=R.useRef(new Map).current;return c.jsx(r,{scope:v,itemMap:E,collectionRef:C,children:x})};a.displayName=o;const i=e+"CollectionSlot",l=R.forwardRef((h,v)=>{const{scope:x,children:C}=h,E=s(i,x),_=Ae(v,E.collectionRef);return c.jsx(ue,{ref:_,children:C})});l.displayName=i;const u=e+"CollectionItemSlot",f="data-radix-collection-item",m=R.forwardRef((h,v)=>{const{scope:x,children:C,...E}=h,_=R.useRef(null),A=Ae(v,_),b=s(u,x);return R.useEffect(()=>(b.itemMap.set(_,{ref:_,...E}),()=>void b.itemMap.delete(_))),c.jsx(ue,{[f]:"",ref:A,children:C})});m.displayName=u;function p(h){const v=s(e+"CollectionConsumer",h);return R.useCallback(()=>{const C=v.collectionRef.current;if(!C)return[];const E=Array.from(C.querySelectorAll(`[${f}]`));return Array.from(v.itemMap.values()).sort((b,T)=>E.indexOf(b.ref.current)-E.indexOf(T.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:l,ItemSlot:m},p,n]}var pr=globalThis?.document?g.useLayoutEffect:()=>{},gr=to.useId||(()=>{}),hr=0;function vr(e){const[o,t]=g.useState(gr());return pr(()=>{t(n=>n??String(hr++))},[e]),o?`radix-${o}`:""}var Cr=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],F=Cr.reduce((e,o)=>{const t=g.forwardRef((n,r)=>{const{asChild:s,...a}=n,i=s?ue:o;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),c.jsx(i,{...a,ref:r})});return t.displayName=`Primitive.${o}`,{...e,[o]:t}},{});function we(e){const o=g.useRef(e);return g.useEffect(()=>{o.current=e}),g.useMemo(()=>(...t)=>o.current?.(...t),[])}function Ce({prop:e,defaultProp:o,onChange:t=()=>{}}){const[n,r]=xr({defaultProp:o,onChange:t}),s=e!==void 0,a=s?e:n,i=we(t),l=g.useCallback(u=>{if(s){const m=typeof u=="function"?u(e):u;m!==e&&i(m)}else r(u)},[s,e,r,i]);return[a,l]}function xr({defaultProp:e,onChange:o}){const t=g.useState(e),[n]=t,r=g.useRef(n),s=we(o);return g.useEffect(()=>{r.current!==n&&(s(n),r.current=n)},[n,r,s]),t}var Er=g.createContext(void 0);function ke(e){const o=g.useContext(Er);return e||o||"ltr"}var ye="rovingFocusGroup.onEntryFocus",_r={bubbles:!1,cancelable:!0},xe="RovingFocusGroup",[Oe,St,br]=mr(xe),[yr,Ee]=ve(xe,[br]),[Nr,Tr]=yr(xe),Pt=g.forwardRef((e,o)=>c.jsx(Oe.Provider,{scope:e.__scopeRovingFocusGroup,children:c.jsx(Oe.Slot,{scope:e.__scopeRovingFocusGroup,children:c.jsx(Sr,{...e,ref:o})})}));Pt.displayName=xe;var Sr=g.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:r=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:i,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:f=!1,...m}=e,p=g.useRef(null),h=Ae(o,p),v=ke(s),[x=null,C]=Ce({prop:a,defaultProp:i,onChange:l}),[E,_]=g.useState(!1),A=we(u),b=St(t),T=g.useRef(!1),[S,P]=g.useState(0);return g.useEffect(()=>{const O=p.current;if(O)return O.addEventListener(ye,A),()=>O.removeEventListener(ye,A)},[A]),c.jsx(Nr,{scope:t,orientation:n,dir:v,loop:r,currentTabStopId:x,onItemFocus:g.useCallback(O=>C(O),[C]),onItemShiftTab:g.useCallback(()=>_(!0),[]),onFocusableItemAdd:g.useCallback(()=>P(O=>O+1),[]),onFocusableItemRemove:g.useCallback(()=>P(O=>O-1),[]),children:c.jsx(F.div,{tabIndex:E||S===0?-1:0,"data-orientation":n,...m,ref:h,style:{outline:"none",...e.style},onMouseDown:$(e.onMouseDown,()=>{T.current=!0}),onFocus:$(e.onFocus,O=>{const oe=!T.current;if(O.target===O.currentTarget&&oe&&!E){const ne=new CustomEvent(ye,_r);if(O.currentTarget.dispatchEvent(ne),!ne.defaultPrevented){const Q=b().filter(z=>z.focusable),K=Q.find(z=>z.active),G=Q.find(z=>z.id===x),Wt=[K,G,...Q].filter(Boolean).map(z=>z.ref.current);Ot(Wt,f)}}T.current=!1}),onBlur:$(e.onBlur,()=>_(!1))})})}),At="RovingFocusGroupItem",It=g.forwardRef((e,o)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:r=!1,tabStopId:s,...a}=e,i=vr(),l=s||i,u=Tr(At,t),f=u.currentTabStopId===l,m=St(t),{onFocusableItemAdd:p,onFocusableItemRemove:h}=u;return g.useEffect(()=>{if(n)return p(),()=>h()},[n,p,h]),c.jsx(Oe.ItemSlot,{scope:t,id:l,focusable:n,active:r,children:c.jsx(F.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...a,ref:o,onMouseDown:$(e.onMouseDown,v=>{n?u.onItemFocus(l):v.preventDefault()}),onFocus:$(e.onFocus,()=>u.onItemFocus(l)),onKeyDown:$(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=Ir(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let E=m().filter(_=>_.focusable).map(_=>_.ref.current);if(x==="last")E.reverse();else if(x==="prev"||x==="next"){x==="prev"&&E.reverse();const _=E.indexOf(v.currentTarget);E=u.loop?Or(E,_+1):E.slice(_+1)}setTimeout(()=>Ot(E))}})})})});It.displayName=At;var Pr={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Ar(e,o){return o!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Ir(e,o,t){const n=Ar(e.key,t);if(!(o==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(o==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return Pr[n]}function Ot(e,o=!1){const t=document.activeElement;for(const n of e)if(n===t||(n.focus({preventScroll:o}),document.activeElement!==t))return}function Or(e,o){return e.map((t,n)=>e[(o+n)%e.length])}var Mt=Pt,De=It,Mr="Separator",tt="horizontal",Rr=["horizontal","vertical"],Rt=g.forwardRef((e,o)=>{const{decorative:t,orientation:n=tt,...r}=e,s=Lr(n)?n:tt,i=t?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return c.jsx(F.div,{"data-orientation":s,...i,...r,ref:o})});Rt.displayName=Mr;function Lr(e){return Rr.includes(e)}var wr=Rt,kr="Toggle",Lt=g.forwardRef((e,o)=>{const{pressed:t,defaultPressed:n=!1,onPressedChange:r,...s}=e,[a=!1,i]=Ce({prop:t,onChange:r,defaultProp:n});return c.jsx(F.button,{type:"button","aria-pressed":a,"data-state":a?"on":"off","data-disabled":e.disabled?"":void 0,...s,ref:o,onClick:$(e.onClick,()=>{e.disabled||i(!a)})})});Lt.displayName=kr;var Z="ToggleGroup",[wt,kt]=ve(Z,[Ee]),Dt=Ee(),je=R.forwardRef((e,o)=>{const{type:t,...n}=e;if(t==="single"){const r=n;return c.jsx(Dr,{...r,ref:o})}if(t==="multiple"){const r=n;return c.jsx(jr,{...r,ref:o})}throw new Error(`Missing prop \`type\` expected on \`${Z}\``)});je.displayName=Z;var[jt,Bt]=wt(Z),Dr=R.forwardRef((e,o)=>{const{value:t,defaultValue:n,onValueChange:r=()=>{},...s}=e,[a,i]=Ce({prop:t,defaultProp:n,onChange:r});return c.jsx(jt,{scope:e.__scopeToggleGroup,type:"single",value:a?[a]:[],onItemActivate:i,onItemDeactivate:R.useCallback(()=>i(""),[i]),children:c.jsx(Gt,{...s,ref:o})})}),jr=R.forwardRef((e,o)=>{const{value:t,defaultValue:n,onValueChange:r=()=>{},...s}=e,[a=[],i]=Ce({prop:t,defaultProp:n,onChange:r}),l=R.useCallback(f=>i((m=[])=>[...m,f]),[i]),u=R.useCallback(f=>i((m=[])=>m.filter(p=>p!==f)),[i]);return c.jsx(jt,{scope:e.__scopeToggleGroup,type:"multiple",value:a,onItemActivate:l,onItemDeactivate:u,children:c.jsx(Gt,{...s,ref:o})})});je.displayName=Z;var[Br,Gr]=wt(Z),Gt=R.forwardRef((e,o)=>{const{__scopeToggleGroup:t,disabled:n=!1,rovingFocus:r=!0,orientation:s,dir:a,loop:i=!0,...l}=e,u=Dt(t),f=ke(a),m={role:"group",dir:f,...l};return c.jsx(Br,{scope:t,rovingFocus:r,disabled:n,children:r?c.jsx(Mt,{asChild:!0,...u,orientation:s,dir:f,loop:i,children:c.jsx(F.div,{...m,ref:o})}):c.jsx(F.div,{...m,ref:o})})}),de="ToggleGroupItem",Vt=R.forwardRef((e,o)=>{const t=Bt(de,e.__scopeToggleGroup),n=Gr(de,e.__scopeToggleGroup),r=Dt(e.__scopeToggleGroup),s=t.value.includes(e.value),a=n.disabled||e.disabled,i={...e,pressed:s,disabled:a},l=R.useRef(null);return n.rovingFocus?c.jsx(De,{asChild:!0,...r,focusable:!a,active:s,ref:l,children:c.jsx(ot,{...i,ref:o})}):c.jsx(ot,{...i,ref:o})});Vt.displayName=de;var ot=R.forwardRef((e,o)=>{const{__scopeToggleGroup:t,value:n,...r}=e,s=Bt(de,t),a={role:"radio","aria-checked":e.pressed,"aria-pressed":void 0},i=s.type==="single"?a:void 0;return c.jsx(Lt,{...i,...r,ref:o,onPressedChange:l=>{l?s.onItemActivate(n):s.onItemDeactivate(n)}})}),Vr=je,Fr=Vt,Be="Toolbar",[Hr,bs]=ve(Be,[Ee,kt]),Ge=Ee(),Ft=kt(),[$r,Ht]=Hr(Be),$t=g.forwardRef((e,o)=>{const{__scopeToolbar:t,orientation:n="horizontal",dir:r,loop:s=!0,...a}=e,i=Ge(t),l=ke(r);return c.jsx($r,{scope:t,orientation:n,dir:l,children:c.jsx(Mt,{asChild:!0,...i,orientation:n,dir:l,loop:s,children:c.jsx(F.div,{role:"toolbar","aria-orientation":n,dir:l,...a,ref:o})})})});$t.displayName=Be;var Yt="ToolbarSeparator",Ut=g.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Ht(Yt,t);return c.jsx(wr,{orientation:r.orientation==="horizontal"?"vertical":"horizontal",...n,ref:o})});Ut.displayName=Yt;var Yr="ToolbarButton",Ve=g.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Ge(t);return c.jsx(De,{asChild:!0,...r,focusable:!e.disabled,children:c.jsx(F.button,{type:"button",...n,ref:o})})});Ve.displayName=Yr;var Ur="ToolbarLink",Kr=g.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Ge(t);return c.jsx(De,{asChild:!0,...r,focusable:!0,children:c.jsx(F.a,{...n,ref:o,onKeyDown:$(e.onKeyDown,s=>{s.key===" "&&s.currentTarget.click()})})})});Kr.displayName=Ur;var Kt="ToolbarToggleGroup",zr=g.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Ht(Kt,t),s=Ft(t);return c.jsx(Vr,{"data-orientation":r.orientation,dir:r.dir,...s,...n,ref:o,rovingFocus:!1})});zr.displayName=Kt;var Xr="ToolbarToggleItem",Wr=g.forwardRef((e,o)=>{const{__scopeToolbar:t,...n}=e,r=Ft(t),s={__scopeToolbar:e.__scopeToolbar};return c.jsx(Ve,{asChild:!0,...s,children:c.jsx(Fr,{...r,...n,ref:o})})});Wr.displayName=Xr;var qr=$t,Jr=Ut,Zr=(e=>(e.CODE="code",e.WRITING="writing",e))(Zr||{});const te=({children:e,toolbarType:o})=>c.jsx(qr,{className:M("m-0 flex h-10 w-fit min-w-0 flex-shrink items-center overflow-hidden rounded-xl border border-token-border-light bg-token-main-surface-primary",it,o==="code"?"p-0":"p-1"),children:e}),zt=({icon:e,hideLabel:o,label:t})=>c.jsxs(c.Fragment,{children:[c.jsx(e,{className:M("icon-sm",{"mr-0.5 text-token-text-tertiary":!o,"text-token-text-primary":o})}),!o&&c.jsx("span",{className:"truncate text-sm text-token-text-primary",children:t})]}),Xt=at(Ve)`flex h-full items-center gap-1 rounded-lg px-2.5 hover:bg-[#f5f5f5] dark:hover:bg-token-main-surface-secondary`,Qr=({label:e,icon:o,hideLabel:t=!1,onClick:n,onMouseDown:r})=>c.jsx(Xt,{onClick:n,"aria-label":t?e:void 0,onMouseDown:r,children:c.jsx(zt,{icon:o,hideLabel:t,label:e})}),es=({icon:e,hideLabel:o,label:t,children:n})=>c.jsxs(lo,{children:[c.jsx(uo,{asChild:!0,children:c.jsx(Xt,{"aria-label":o?t:void 0,children:c.jsx(zt,{icon:e,hideLabel:o,label:t})})}),c.jsx(fo,{children:c.jsx(mo,{align:"end",className:B.toolbar,sideOffset:8,children:n})})]});te.Separator=at(Jr)`mx-1 p-0 list-none h-full w-[1px] bg-token-border-light`;te.Action=Qr;te.Popover=es;const ts=({getSelectionRange:e})=>{const o=Me(),t=()=>{const n=e();if(n==null)return;const{from:r,to:s,sourceFrom:a,sourceTo:i}=n;if(r==null||s==null||a==null||i==null){D.logError("Missing selection range on targeted edit",n);return}const l=ut.ASK;D.logButtonClick(W.TOOLBAR_ASK_CHATGPT,{action:l,sourceFrom:a,sourceTo:i}),w.startCommentingOn({type:Y.SELECTION,from:r,to:s,sourceRange:{start:a,end:i},action:l})};return c.jsx(te.Action,{label:o.formatMessage({id:"wOaJUU",defaultMessage:"Ask ChatGPT"}),onClick:t,icon:Oo})},ys=({getEditorDom:e,getToolbarPosition:o,getSelectionRange:t,toolbarType:n,children:r,onAddComment:s,isWaitingForCommentResponse:a=!1})=>{const[{height:i,width:l},u]=fe(),[f,m]=g.useState(!0),[p,h]=g.useState(!1),v=e(),x=V(({commentingOn:S})=>S),[C,E]=g.useState(null),_=g.useCallback(()=>{const S=e(),P=document.getSelection();return!P||P.type!=="Range"||P.isCollapsed||!S?.contains(P.anchorNode)},[e]);g.useEffect(()=>{const S=po(()=>{h(!0)},200,{leading:!0}),P=()=>{S.cancel(),h(!1)};return v?.addEventListener("pointerdown",S,{passive:!0}),document.addEventListener("pointerup",P,{passive:!0}),()=>{v?.removeEventListener("pointerdown",S),document.removeEventListener("pointerup",P)}},[v]),g.useEffect(()=>{const S=()=>{m(_())};return document.addEventListener("selectionchange",S,{passive:!0}),()=>{document.removeEventListener("selectionchange",S)}},[_]),st(()=>{if(f||_())return m(!0);try{const S=o({width:l,height:i});S!=null&&E(S)}catch(S){D.logError("Invalid position in getToolbarPosition",S)}},[i,l,f,_,o]);const A=c.jsxs(te,{toolbarType:n,children:[c.jsx(ts,{getSelectionRange:t}),r]}),b=!f&&!x&&C!=null,T=jo(b);return g.useEffect(()=>{!b&&T&&!x&&v?.focus()},[v,T,b,x]),c.jsxs(c.Fragment,{children:[c.jsx("div",{"aria-hidden":"true",className:"pointer-events-none invisible fixed left-0 top-0 h-0 overflow-clip",children:c.jsx("div",{ref:u,children:A})}),c.jsx(X,{children:b&&c.jsx(k.div,{initial:{opacity:0,scale:.95},animate:{opacity:p?0:1,scale:p?.95:1},style:{top:C.top,left:C.left},exit:{opacity:0,scale:.95},transition:{type:"spring",bounce:.1,duration:.1,delay:p?0:.1},className:M("absolute",B.toolbar,p?"pointer-events-none":"pointer-events-auto"),children:A})}),c.jsx(vn,{toolbarPosition:C,commentingOn:x,isWaitingForCommentResponse:a,onAddComment:s})]})};let re=null;function Ns(){if(re!=null)return re;if(typeof window>"u")return 0;const e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.position="absolute",e.style.top="-9999px",document.body.appendChild(e);try{re=e.offsetWidth-e.clientWidth}finally{document.body.removeChild(e)}return re}function Ts(e){return e==null?null:e.scrollHeight>e.clientHeight}export{ht as A,te as B,_s as C,q as H,U as I,yn as P,Pn as R,ys as T,hs as a,gs as b,Zr as c,Ns as d,Sn as e,Yo as f,ps as g,vs as h,Ts as i,Le as j,Tn as k,Nn as l,Vo as m,Et as n,Cs as o,An as p,xn as q,Es as r,ms as s,bn as t,xt as u,zo as v,xs as w,le as x,Cn as y,tr as z};
//# sourceMappingURL=cekmyysk2681j6dk.js.map
