import{m as e,aJ as c,r as u,gz as U,az as $,z as B,e as H,bA as L,dY as W,f7 as J,bJ as C,P as A,d as P,bo as Q,bi as V}from"./mzam3ouqlxkj0hfr.js";import{u as X}from"./dohbd6zym1844qog.js";import{cU as Y,ba as q}from"./k7ruw8ncrx0bmwhu.js";import{e as Z,d as O}from"./n08xtfzmwu8pfk96.js";import{P as G}from"./fm8m33kwt8yj6vzf.js";import{aQ as I}from"./m03lm9pbifqbvgam.js";import"./ey8xraplhgymlrza.js";function D({title:a,content:t,buttons:r,time:s,icon:l,size:n="default",progressBar:d,disabled:o=!1,onClick:m}){const h=o?"border-token-dot-color border-opacity-10":"border-[rgba(0,0,0,0.1)] dark:border-[rgba(255,255,255,0.1)]",S=n==="small"?`w-[380px] pr-[15px] pl-[20px] pt-[13px] pb-[10px] ${o?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",f=m?"cursor-pointer":"",g=n==="small"?"text-[15px]":"";return e.jsxs("div",{className:c("inline-flex flex-col items-start justify-start rounded-2xl border",h,"bg-token-main-surface-primary dark:bg-token-main-surface-secondary",S,f,g),onClick:m,style:n==="small"&&!o?{boxShadow:"rgba(0, 0, 0, 0.06) 0px 2px 6px 0px"}:void 0,children:[e.jsxs("div",{className:c("flex flex-col items-start justify-start self-stretch",n!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:c("inline-flex items-start justify-start self-stretch",n!=="small"&&"gap-2"),children:[e.jsx("div",{className:c("shrink grow basis-0 font-medium leading-normal",o?"text-token-text-secondary":"text-token-text-primary"),children:a}),e.jsx("div",{className:"relative h-6 w-6"}),!o&&(l||e.jsx(I,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:c("flex w-full flex-col items-start justify-start",n==="small"&&"mt-[-2px]"),children:e.jsx("div",{className:c("inline-flex w-full items-start justify-start self-stretch rounded",n==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:c("w-full font-normal leading-relaxed",o?"text-token-text-tertiary":"text-token-text-secondary"),children:t})})})]}),d?e.jsxs("div",{className:c("mb-2 inline-flex items-center justify-between self-stretch",r?.length&&"mt-[-10px]"),children:[d,r]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[s&&e.jsx("div",{className:"shrink grow basis-0 text-[15px] font-normal leading-normal text-token-text-tertiary",children:s}),e.jsx("div",{className:"flex gap-2",children:r})]})]})}const ee={strong:a=>{const{node:t,children:r,...s}=a;return e.jsx("strong",{...s,className:c(s.className,"font-semibold text-token-text-primary"),children:r})},p:a=>{const{node:t,children:r,...s}=a;return e.jsx("p",{...s,className:c(s.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:r})}};function se({message:a,isExpandable:t}){const s=a.create_time?new Date(a.create_time*1e3):Date.now(),l=X(+s,48e4);return e.jsx(G,{percentage:l,className:c("mr-4",t?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-l)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function te({isExpandable:a,handleOpenSidebarSummarizer:t,summarizationHeadline:r,latestTitle:s,message:l}){return e.jsx("div",{className:"py-2",children:e.jsx(D,{buttons:[e.jsx(Q,{onClick:t,color:"secondary",className:"!h-[38px] text-[15px] font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(V,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")],title:r,time:null,icon:e.jsx("div",{className:""}),content:`${s}...`,size:"small",progressBar:e.jsx(se,{message:l,isExpandable:a})})})}function ae({handleOpenSidebarSummarizer:a,summarizationHeadline:t,message:r}){return e.jsx("div",{className:"py-2",children:e.jsx(D,{buttons:[],title:t,time:null,content:r.metadata?.finished_text??"",size:"small",disabled:!0,onClick:a})})}function z({completionInProgress:a,latestTitle:t,message:r,summaryText:s,isExpandable:l,disableExpansion:n,onOpenAnalytics:d,handleOpenSidebarSummarizer:o}){return e.jsx(Z,{status:a?O.Running:O.Finished,highlightedCommand:a?t:r.metadata?.finished_text??"",onOpenAnalytics:d,onClick:o,children:s&&l&&!n?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(q,{componentOverrides:ee,className:"not-prose leading-6",children:s})}):null})}function me({messages:a,isStreaming:t,isLastMessage:r,clientThreadId:s,currentGroupedMessageIndex:l,turnIndex:n}){const[d,o]=u.useState(""),[m,h]=u.useState(!1),f=U(s)===$.STREAMING,g=f||t,i=a[0].message,k=i.id,w=B.getServerThreadId(s),x=H(i),b=i.metadata?.summarization_headline,R=t&&b!=null,{toggleThreadSidebar:j}=L(),M=W(),p=J(),F=i.metadata?.model_slug?.startsWith("o1")&&i.metadata?.model_slug?.endsWith("o"),K=Y(),y=u.useCallback(()=>{M&&p&&p.type==="summarizer"&&p.clientThreadId===s&&p.turnIndex===n?C({className:"close-thread-sidebar",update:()=>{j({type:"summarizer",clientThreadId:s,currentGroupedMessageIndex:l,turnIndex:n})}}):C({className:"open-thread-sidebar",update:()=>{j({type:"summarizer",clientThreadId:s,currentGroupedMessageIndex:l,turnIndex:n})}})},[j,s,l,n,M,p]);u.useEffect(()=>{const _=/\*\*(.*?)(?:\*\*|\n|$)/g;let T,N="";for(;(T=_.exec(x))!=null;)N=T[1].trim();N?o(N):i.metadata?.initial_text!=null&&o(i.metadata.initial_text)},[x,i.metadata?.initial_text]),u.useEffect(()=>{x.length>0&&h(!0)},[x]);const v=u.useMemo(()=>({client_thread_id:s,message_id:k,conversationId:w}),[s,k,w]);u.useEffect(()=>{m&&A.logEvent(P.receivedA8KM123Message,v)},[m]);const E=u.useCallback(()=>{A.logEvent(P.openedA8KM123Message,{...v,isStreaming:t})},[v,t]);return K?F?f&&r||t?e.jsx(te,{isExpandable:m,handleOpenSidebarSummarizer:y,summarizationHeadline:b??null,latestTitle:d,message:i}):e.jsx(ae,{handleOpenSidebarSummarizer:y,summarizationHeadline:b??null,message:i}):e.jsx(z,{completionInProgress:g,latestTitle:d,message:i,onOpenAnalytics:E,handleOpenSidebarSummarizer:m||!t?y:void 0}):e.jsx(z,{completionInProgress:g,latestTitle:d,message:i,onOpenAnalytics:E,summaryText:x,isExpandable:m,disableExpansion:R})}export{ee as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,me as default};
//# sourceMappingURL=l5ink01f0owdvbqe.js.map
