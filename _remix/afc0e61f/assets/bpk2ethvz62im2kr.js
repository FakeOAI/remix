import{r as g,H as M,j as e,I as F,a7 as w,K as i,eT as A,aJ as N,ar as E,N as _,O as B,aN as Y,bg as X,aD as q,c as T,u as se,R as G,X as ae}from"./g03cv0vnbvl8m3c2.js";import{u as K,c as D,d as te,a as ne}from"./l4uit5cl0nxbx9ra.js";import{fA as m,at as V,fB as z,fC as Q,fD as J,fE as ie,b0 as le,bN as oe,as as re,fF as ce,bO as de,fG as ue,fH as H,j as Z,bp as me,ch as ge}from"./gmkdbvu1z26nwc2g.js";import{c as fe}from"./iej0cupg2dqkmejt.js";import{L as xe}from"./g7xobhms297lv26h.js";import{B as pe,D as P}from"./n9q5bh7vev7iwsyk.js";import{a2 as he,bj as je,bw as Me,bx as be,x as ve,u as ye,F as Se}from"./j195nb71p8a82xgt.js";import{a as Ne,b as we}from"./it5ktmhwskfo5934.js";import{a as Ce,d as O,e as U,g as W,f as Be,c as Ie,A as Pe}from"./djocap6tiyzxa216.js";import{b as Le}from"./i5i8nugvrizce3g0.js";import"./eures2un3wat4y5c.js";import"./l96f7w2szip0jok2.js";import"./ehbm1zqqfzs830yn.js";import"./cyppwuh4tm8za18x.js";import"./fa4f1ia3usj74vpi.js";import"./gxyfa8bzj9e3bb0u.js";import"./b1on5s28kk8b6csw.js";import"./dqfyttymd4coz9an.js";import"./mnqbywahik5dd7p9.js";import"./muo2qre3uu4yfgpg.js";import"./ovfymur2r3wc7zsu.js";var C=(s=>(s.FLEXIBLE="month",s.ANNUAL="year",s))(C||{});const Te=fe(C);function Ee({isOpen:s,onClose:n,initialTeamBillingType:t,renewalDate:a,accountId:c}){const[r,o]=g.useState(t),[l,u]=g.useState(!1),p=function(){u(!l)},[f,h]=g.useState(!1),b=ke[r],x=M(),v=K(c),y=async()=>{h(!0);try{await v.mutateAsync({accountId:c,updatedPriceInterval:r==="month"?"month":"year",updatedSeats:void 0}),h(!1),w.success(x.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),u(!1),n()}catch{w.warning(x.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{h(!1)}};return e.jsx(F,{type:"success",isOpen:s,onClose:()=>{u(!1),o(t),n()},size:"custom",className:"max-w-xl",noPadding:!0,title:l?x.formatMessage({id:"teamBilling.changeBillingScheduleConfirmTitle",defaultMessage:"Confirm changes"}):x.formatMessage({id:"teamBilling.changeBillingScheduleTitle",defaultMessage:"Change billing schedule"}),showCloseButton:!0,children:l?e.jsx(De,{selectedPlan:r,initialTeamBillingType:t,renewalDate:a,selectedPlanData:b,handleUpdate:y,isUpdating:f}):e.jsx(_e,{setSelectedPlan:o,selectedPlan:r,initialTeamBillingType:t,toggleConfirmPage:p,renewalDate:a})})}function _e({selectedPlan:s,setSelectedPlan:n,initialTeamBillingType:t,toggleConfirmPage:a,renewalDate:c}){const r=M();return e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-flow-row grid-cols-2",children:e.jsxs(V,{className:"col-span-2 grid md:col-span-2 md:grid-cols-2",defaultValue:s,onValueChange:o=>{Te(o)&&n(o)},children:[e.jsx(z,{billingType:"month",...Q}),e.jsx(z,{billingType:"year",...J})]})}),e.jsx("hr",{}),e.jsxs("div",{className:"m-4 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-token-text-secondary",children:e.jsx(i,{...m.changeEffectDate,values:{date:e.jsx(A,{value:c,year:"numeric",month:"long",day:"numeric"})}})}),e.jsx(N,{title:r.formatMessage(m.continueToPricePreview),disabled:s===t,color:"primary",onClick:()=>{a()}})]})]})}function De({initialTeamBillingType:s,selectedPlan:n,renewalDate:t,selectedPlanData:a,handleUpdate:c,isUpdating:r}){const o=M();return e.jsxs("div",{className:"p-4",children:[e.jsx("span",{className:"text-sm",children:e.jsx(i,{...m.confirmPageChangeEffectDate,values:{current_plan:s==="month"?"Flexible (monthly)":"Annual",new_plan:n==="month"?"Flexible (monthly)":"Annual",date:e.jsx(A,{value:t,year:"numeric",month:"long",day:"numeric"})}})}),e.jsxs("div",{className:"mt-4 flex flex-col bg-token-main-surface-secondary p-4",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...a.name})}),e.jsx("span",{className:"text-sm",children:e.jsx(i,{...a.cost,values:{s:(...l)=>e.jsx(ie,{children:l})}})}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:e.jsx(i,{...a.structure})})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(N,{title:o.formatMessage(m.confirmChange),color:"primary",onClick:c,loading:r})})]})}const ke={month:{name:m.flexiblePlanName,cost:m.flexiblePlanCost,structure:m.teamsCostStructure},year:{name:m.annualPlanName,cost:m.annualPlanCost,structure:m.teamsCostStructure}};function ze({isOpen:s,onClose:n}){const t=M(),{data:a,isLoading:c}=D(),r=E(),o=te(r==null?void 0:r.id),l=le(),[u,p]=g.useState(""),[f,h]=g.useState(!1),b=(l==null?void 0:l.email)&&u.toLowerCase()==l.email.toLowerCase(),[x,v]=g.useState(a&&!a.will_renew);if(c||!r||!a)return null;const y=async()=>{h(!0);try{await o.mutateAsync(r.id),v(!0)}catch{w.warning(t.formatMessage(j.errorCancellingSubscription),{hasCloseButton:!0})}finally{h(!1)}};return e.jsx(F,{type:"success",onClose:n,showCloseButton:!0,isOpen:s,className:"",title:e.jsx("span",{className:"text-lg",children:e.jsx(i,{...j.cancelPlan})}),children:x?e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:e.jsx(i,{...j.successfullyCanceled})}),a.active_until!=null&&e.jsx("p",{className:"text-sm text-token-text-primary",children:e.jsx(i,{...j.retainUntil,values:{expiryDate:new Date(a.active_until)}})}),e.jsx("div",{className:"mt-6 flex w-full flex-row justify-end",children:e.jsx(N,{title:t.formatMessage(j.doneButton),color:"primary",onClick:n,disabled:f})})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex w-full items-center gap-4",children:[e.jsx(oe,{src:r.data.profilePictureUrl,size:"large"}),e.jsxs("div",{className:"flex-col",children:[e.jsx("p",{className:"font-semibold",children:r.data.name}),e.jsx("p",{className:"text-sm text-token-text-secondary",children:e.jsx(i,{...j.membersCount,values:{count:a.seats_entitled}})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:e.jsx(i,{...j.areYouSure})}),e.jsxs("ul",{className:"list-disc pl-5 text-sm text-token-text-secondary",children:[e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.dataUnavailable})}),a.active_until!=null&&e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.retainUntil,values:{expiryDate:new Date(a.active_until)}})}),e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.retainEmailAccess})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:e.jsx(i,{...j.enterEmailToConfirm})}),e.jsx(re,{type:"text",name:"user-email",placeholder:"abcd@acme.com",onChange:S=>{p(S.target.value)}})]})]}),e.jsxs("div",{className:"mt-6 flex w-full flex-row justify-end",children:[e.jsx(N,{title:t.formatMessage(j.keepSubscriptionButton),onClick:n,disabled:f}),e.jsx(N,{title:t.formatMessage(j.cancelSubscriptionButton),onClick:y,disabled:!b,loading:f,color:"danger",className:"ml-2"})]})]})})}const j=_({dataUnavailable:{id:"cancelTeamPlanModal.dataUnavailable",defaultMessage:"All workspace data including chat history and settings will not be available."},cancelPlan:{id:"cancelTeamPlanModal.cancelPlan",defaultMessage:"Cancel subscription"},retainUntil:{id:"cancelTeamPlanModal.retainUntil",defaultMessage:"You will retain access to the workspace until the end of your billing cycle on {expiryDate, date, long}."},retainEmailAccess:{id:"cancelTeamPlanModal.retainEmailAccess",defaultMessage:"You will still be able to use ChatGPT with the other workspaces associated with this email address."},errorCancellingSubscription:{id:"cancelTeamPlanModal.errorCancellingSubscription",defaultMessage:"There was a problem cancelling your subscription."},areYouSure:{id:"cancelTeamPlanModal.areYouSure",defaultMessage:"Are you sure?"},enterEmailToConfirm:{id:"cancelTeamPlanModal.enterEmailToConfirm",defaultMessage:"Enter your Email address to confirm"},emailPlaceholder:{id:"cancelTeamPlanModal.emailPlaceholder",defaultMessage:"abcd@acme.com"},doneButton:{id:"cancelTeamPlanModal.doneButton",defaultMessage:"Done"},keepSubscriptionButton:{id:"cancelTeamPlanModal.keepSubscriptionButton",defaultMessage:"Keep subscription"},cancelSubscriptionButton:{id:"cancelTeamPlanModal.cancelSubscriptionButton",defaultMessage:"Cancel subscription"},successfullyCanceled:{id:"cancelTeamPlanModal.successfullyCanceled",defaultMessage:"You have successfully canceled your subscription."},membersCount:{id:"yourComponent.membersCount",defaultMessage:"{count, plural, one {# member} other {# members}}"}}),Oe=25*12,Ue=30,Fe=B.p`text-base font-semibold mb-3 mt-3`;function Ae({isOpen:s,onClose:n,initialTeamBillingType:t,initialSeats:a,accountId:c,renewalDate:r}){const o=M(),[l,u]=g.useState(a),[p,f]=g.useState(!1),h=function(){f(!p)},[b,x]=g.useState(!1),v=He[t],y=t==="month"?Q:J,S=K(c),I=async()=>{x(!0);try{await S.mutateAsync({accountId:c,updatedPriceInterval:void 0,updatedSeats:l}),x(!1),w.success(o.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),f(!1),n()}catch{w.warning(o.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{x(!1)}};return e.jsx(F,{type:"success",isOpen:s,onClose:()=>{f(!1),u(a),n()},size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:p?o.formatMessage({id:"teamsManageSeatsModal.title",defaultMessage:"Manage seats"}):o.formatMessage({id:"teamsManageSeatsModalConfirmPage.title",defaultMessage:"Review"}),children:p?e.jsx($e,{numSeats:l,initialSeats:a,handleUpdate:I,isUpdating:b,renewalDate:r,accountId:c}):e.jsx(Re,{initialTeamBillingType:t,selectedPlanBillingInfo:y,numSeats:l,initialSeats:a,setNumSeats:u,selectedPlanData:v,toggleConfirmPage:h})})}function Re({initialTeamBillingType:s,selectedPlanBillingInfo:n,numSeats:t,initialSeats:a,setNumSeats:c,selectedPlanData:r,toggleConfirmPage:o}){const l=M();return e.jsxs("div",{className:"grid grid-flow-row grid-cols-2",children:[e.jsx(V,{className:"col-span-2 grid md:col-span-1 md:grid-cols-1",defaultValue:s,children:e.jsx(z,{billingType:s,...n})}),e.jsxs("div",{className:"col-span-3 overflow-hidden border-l border-token-main-surface-tertiary bg-token-main-surface-secondary p-6 md:col-span-1",children:[e.jsx("label",{className:"mb-3 block text-base font-semibold",htmlFor:"seats",children:e.jsx(i,{...m.seatsTitle})}),e.jsx(ce,{numSeats:t,minSeats:a,setNumSeats:c}),e.jsx(de,{}),e.jsx(Fe,{children:e.jsx(i,{...m.summaryTitle})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"mb-2",children:e.jsx(i,{...r.name})}),e.jsxs(ue,{children:[e.jsx(H,{children:e.jsx(i,{...r.billed})}),e.jsx(H,{children:e.jsx("b",{children:e.jsx(i,{...r.total,values:{totalCost:(t||0)*(s==="year"?Oe:Ue)}})})})]})]})]}),e.jsx("hr",{}),e.jsx("div",{className:"m-4 flex justify-end",children:e.jsx(N,{title:l.formatMessage({id:"teamsManageSeatsModal.continue",defaultMessage:"Continue"}),disabled:t===a,onClick:()=>{o()},color:"primary"})})]})}function $e({numSeats:s,initialSeats:n,renewalDate:t,handleUpdate:a,isUpdating:c,accountId:r}){const o=M(),{data:l,isError:u,isLoading:p}=ne(r,s);if(p)return e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(Y,{})});if(!(u||!l))return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.additionalSeats",defaultMessage:"{additionalSeats} additional seats",values:{additionalSeats:s-n}})}),e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.additionalSeatsTotal",defaultMessage:"${totalCost}",values:{totalCost:(l.total_amount/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:e.jsx(i,{id:"teamsManageSeatsModal.proratedAmountMessage",defaultMessage:"Prorated amount until next billing cycle"})}),e.jsx("span",{className:"mt-4 flex flex-col bg-token-main-surface-secondary p-4 text-sm text-token-text-secondary",children:e.jsx(i,{id:"teamsManageSeatsModal.chargeMessage",defaultMessage:"You will be charged for {numSeats} total seats at your next renewal on {date}",values:{numSeats:s,date:e.jsx(A,{value:t,year:"numeric",month:"long",day:"numeric"})}})}),e.jsx("hr",{className:"mt-4"}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.subTotal",defaultMessage:"Subtotal"})}),e.jsx("span",{children:e.jsx(i,{id:"teamsManageSeatsModal.subtotalPrice",defaultMessage:"${totalCost}",values:{totalCost:(l.amount_excluding_tax/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.tax",defaultMessage:"Tax"})}),e.jsx("span",{children:e.jsx(i,{id:"teamsManageSeatsModal.taxAmount",defaultMessage:"${tax}",values:{tax:(l.tax_amount/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.totalDueToday",defaultMessage:"Total due today"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.totalDueTodayAmount",defaultMessage:"${totalCost}",values:{totalCost:(l.total_amount/100).toFixed(2)}})})]}),e.jsx("hr",{className:"mt-4"}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(N,{title:o.formatMessage({id:"teamsManageSeatsModal.payNow",defaultMessage:"Pay now"}),color:"primary",onClick:a,loading:c})})]})}const He={month:{name:m.flexiblePlanSelected,billed:{id:"teamManageSeatsModal.flexiblePlanBilled",defaultMessage:"Price billed monthly",description:"Summary billing of selected plan"},total:m.flexiblePlanTotal},year:{name:m.annualPlanSelected,billed:{id:"teamManageSeatsModal.flexiblePlanBilled",defaultMessage:"Price billed annually",description:"Summary billing of selected plan"},total:m.annualPlanTotal}};function We({numInUse:s,numAllocated:n,isTeam:t,subscriptionWillRenew:a,subscriptionBillingPeriod:c,accountId:r,subscriptionRenewalDate:o}){var v;const u=Math.max(n,s)>10?Ye:Ke,p=(v=q("3954884439"))==null?void 0:v.value,[f,h]=g.useState(!1),b=function(){h(!f)},x=c==="monthly"?C.FLEXIBLE:C.ANNUAL;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"mt-1 text-left text-sm",children:e.jsx(i,{...$.description,values:{num:`${s}/${n}`}})}),t&&a&&p&&e.jsx(X,{color:"secondary",className:"text-right",onClick:b,children:e.jsx(i,{id:"components.business.NumSeats.manageSeats",defaultMessage:"Manage seats"})}),e.jsx(Ae,{isOpen:f,onClose:b,initialTeamBillingType:x,initialSeats:n,accountId:r,renewalDate:o})]}),e.jsx(u,{numInUse:s,numAllocated:n})]})}function Ye({numAllocated:s,numInUse:n}){const t=M(),a=n>s,c=a?100:n/s*100,r=a?s/n*100:100;return e.jsx("div",{className:T("relative w-full rounded-full",a?"bg-orange-500":"bg-token-main-surface-primary"),children:e.jsxs("div",{className:"relative h-4",style:{width:`${r}%`},children:[e.jsx("div",{className:T("h-4 overflow-hidden rounded-l-full bg-green-600",n===s&&"rounded-r-full"),style:{width:`${c}%`}}),n!==s&&a&&e.jsx("div",{className:"absolute right-0 top-[-3px] bg-token-main-surface-primary",children:e.jsx(Z,{label:t.formatMessage($.dividerTooltip,{count:s}),children:e.jsx(ee,{className:"px-1 py-0.5"})})})]})})}const ee=({className:s})=>e.jsxs("div",{className:T("flex flex-col gap-0.5",s),children:[e.jsx(L,{}),e.jsx(L,{}),e.jsx(L,{}),e.jsx(L,{})]}),R=B.div`h-4 w-4 rounded-full`,Xe=B(R)`bg-green-600`,qe=B(R)`bg-token-main-surface-tertiary`,Ge=B(R)`bg-orange-500`,L=B.span`w-[3px] h-[3px] bg-gray-400 dark:bg-gray-500 rounded-full`;function Ke({numAllocated:s,numInUse:n}){const t=M(),a=n>s,c=g.useMemo(()=>Array.from(Array(a?n:s).keys()),[a,s,n]);return e.jsx("div",{className:"flex items-center gap-2",children:c.map(r=>{let o=Ge,l=null;return r<n&&!a?o=Xe:r<s&&!a&&(o=qe),r===s-1&&(l=e.jsx(Z,{label:t.formatMessage($.dividerTooltip,{count:s}),children:e.jsx(ee,{})})),e.jsxs(e.Fragment,{children:[e.jsx(o,{},r),l]})})})}const $=_({dividerTooltip:{defaultMessage:"Your team has {count, plural, =0 {no seats} one {# seat} other {# seats}} purchased",id:"components.business.NumSeats.dividerTooltip"},description:{defaultMessage:"{num} seats in use",id:"components.business.NumSeats.description"}});function Ve(s,n){const t=M();return se({queryKey:["organization-invoices",{...s,options:n}],queryFn:async()=>await G.getInvoices(s,n).catch(a=>{throw w.danger(t.formatMessage(Je.invoicesLoadError,{error:a.message})),a}),enabled:"account_id"in s||"organization_id"in s})}function Qe(s){const n=E(),t=n==null?void 0:n.id,a=(n==null?void 0:n.data.organizationId)??void 0,c=n==null?void 0:n.isEnterprisey();return Ve(c?{organization_id:a}:{account_id:t},s)}const Je=_({invoicesLoadError:{id:"organizationBillingInfo.invoicesLoadError.0",defaultMessage:"Failed to load invoices. Contact support@openai.com if error persists."}});function Ze(){const{data:s,isLoading:n,isError:t}=D(),a=E(),[c,r]=g.useState(!1),o=function(){r(!c)};if(n)return e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx(Y,{})});if(t||!s||!a)return null;const l=s.active_until!=null,u=(s==null?void 0:s.seats_in_use)>(s==null?void 0:s.seats_entitled);return e.jsx(e.Fragment,{children:e.jsxs(O,{children:[e.jsx(U,{children:e.jsx(i,{...d.planTitle})}),e.jsx("hr",{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:a!=null&&a.isEnterprise()?l?e.jsx(i,{...d.activeEnterpriseLicense}):a!=null&&a.isResellerHosted()?e.jsx(i,{...d.resellerHostedEnterpriseLicense}):e.jsx(i,{...d.pendingEnterpriseLicense}):a!=null&&a.isEdu()?l?e.jsx(i,{...d.activeEduLicense}):a!=null&&a.isResellerHosted()?e.jsx(i,{...d.resellerHostedEduLicense}):e.jsx(i,{...d.pendingEduLicense}):l?s.non_profit_org_discount_applied?e.jsx(i,{...d.activeTeamLicenseNonProfitOrg}):e.jsx(i,{...d.activeTeamLicense}):e.jsx(i,{...d.pendingTeamLicense})}),s.active_until!=null&&e.jsx(Be,{className:"mt-1",children:a!=null&&a.isEnterprisey()?e.jsx(i,{...d.licenseExpiry,values:{expiryDate:new Date(s.active_until)}}):s.will_renew?e.jsx(i,{...d.renewalDate,values:{expiryDate:new Date(s.active_until)}}):e.jsx(i,{...d.deactivateDate,values:{expiryDate:new Date(s.active_until)}})})]}),e.jsx(es,{isOpen:c,onDropdownOpen:o})]}),e.jsx("hr",{}),l&&e.jsxs("div",{children:[e.jsx(W,{children:e.jsx(i,{...d.seatsTitle})}),e.jsx(ts,{isTeam:(a==null?void 0:a.isTeam())??!1,accountId:a.id}),(a==null?void 0:a.isTeam())&&u&&e.jsxs("span",{className:"text-sm text-token-text-secondary",children:[e.jsx(i,{...d.teamsAutochargeMessage}),e.jsx(xe,{className:"pl-1",openNewTab:!0,href:"https://help.openai.com/en/articles/8792536-manage-billing-on-the-chatgpt-team-subscription-plan",children:e.jsx(i,{...d.billingLearnMore})})]})]}),e.jsx("hr",{})]})})}function es({isOpen:s,onDropdownOpen:n}){var I;const[t,a]=g.useState(!1),c=ae(),r=M(),o=E(),{data:l}=D(),[u,p]=g.useState(!1),f=function(){p(!u)},[h,b]=g.useState(!1),x=function(){b(!h)},v=(I=q("1318146997"))==null?void 0:I.value;if(!o||!o.isTeam()||!l)return;const y=async()=>{a(!0);try{const k=await G.fetchCustomerPortalUrl(o==null?void 0:o.getWorkspaceId());c.push(k.url)}catch{w.warning(r.formatMessage(d.stripeErrorWarning),{hasCloseButton:!0})}finally{a(!1)}},S=(l==null?void 0:l.billing_period)==="monthly"?C.FLEXIBLE:C.ANNUAL;return e.jsxs(pe,{open:s,size:"default",triggerButton:e.jsx(X,{color:"secondary",onClick:n,icon:he,children:e.jsx(i,{...d.manageLicenseBtn})}),children:[e.jsx(P.Item,{icon:je,onClick:y,children:e.jsx(i,{...d.managePaymentMethod})}),l.will_renew&&v&&e.jsx(P.Item,{icon:Me,onClick:()=>{x()},children:e.jsx(i,{...d.manageBillingSchedule})}),l.active_until!=null&&e.jsx(Ee,{isOpen:h,onClose:x,initialTeamBillingType:S,renewalDate:new Date(l.active_until),accountId:o.id}),(l==null?void 0:l.will_renew)&&e.jsx(P.Separator,{}),(l==null?void 0:l.will_renew)&&e.jsx(P.Item,{icon:be,color:"danger",onClick:()=>{f()},children:e.jsx(i,{...d.cancelSubscriptionBtn})}),e.jsx(ze,{isOpen:u,onClose:f})]})}function ss({invoice:s}){const n=(s==null?void 0:s.status_transitions.paid_at)!=null&&new Date(s.status_transitions.paid_at*1e3),t=s&&new Date(s.due_date*1e3),a=s&&new Date(s.created*1e3);return e.jsxs(Pe,{className:"items-center",children:[e.jsxs("div",{className:"flex grow flex-col gap-1",children:[e.jsx("span",{children:a?e.jsx(i,{...d.invoiceName,values:{createdDate:a}}):e.jsx(i,{...d.defaultInvoiceName})}),s!=null&&s.paid&&n!=null?e.jsx("div",{className:"text-xs text-token-text-secondary",children:e.jsx(i,{...d.paidInvoice,values:{invoiceDate:n}})}):s&&e.jsx("div",{className:"text-xs text-green-600",children:e.jsx(i,{...d.upcomingInvoice,values:{invoiceDate:t}})})]}),e.jsx("a",{href:s==null?void 0:s.hosted_invoice_url,className:T("mx-auto",(s==null?void 0:s.hosted_invoice_url)==null&&"cursor-not-allowed opacity-20"),target:"_blank",rel:"noreferrer",children:e.jsx(Se,{className:"icon-sm text-green-600"})})]})}function as(){const[s,n]=g.useState({limit:5}),{data:t,isError:a}=Qe(s),c=s.startingAfter!=null||s.endingBefore!=null&&(t==null?void 0:t.has_more),r=s.endingBefore!=null||(t==null?void 0:t.has_more)&&s.endingBefore==null;return a||t==null?e.jsxs(O,{children:[e.jsx(U,{children:e.jsx(i,{...d.invoicesTitle})}),e.jsx(ge,{children:e.jsx(i,{...d.noInvoices})})]}):e.jsxs(O,{children:[e.jsx(U,{children:e.jsx(i,{...d.invoicesTitle})}),e.jsx(Ie,{children:t.data.map(o=>e.jsx(ss,{invoice:o},o.id))}),e.jsxs("div",{className:"flex",children:[c&&e.jsx("button",{onClick:()=>{t&&n(o=>({...o,endingBefore:t.data[0].id,startingAfter:void 0}))},children:e.jsx(ve,{className:"icon-sm"})}),e.jsx("div",{className:"flex-grow"}),r&&e.jsx("button",{onClick:()=>{t&&n(o=>({...o,startingAfter:t.data[t.data.length-1].id,endingBefore:void 0}))},children:e.jsx(ye,{className:"icon-sm"})})]})]})}function ts({isTeam:s,accountId:n}){const{data:t,isLoading:a,isError:c}=D();return c||!t||a||!t.billing_period||!t.active_until?null:e.jsx(We,{numInUse:t.seats_in_use,numAllocated:t.seats_entitled,isTeam:s,subscriptionWillRenew:t.will_renew,subscriptionBillingPeriod:t.billing_period,subscriptionRenewalDate:new Date(t.active_until),accountId:n})}function ns(){const s=me(a=>a.currentWorkspace),n=s==null?void 0:s.organizationId,t=M();return n===void 0?null:e.jsxs(e.Fragment,{children:[e.jsx(Ne,{title:t.formatMessage(d.title),subtitle:t.formatMessage(d.subtitle)}),e.jsx(we,{children:e.jsxs(Ce,{children:[e.jsx(Ze,{}),e.jsx(as,{})]})})]})}const d=_({title:{id:"organizationBillingInfo.title.1",defaultMessage:"Billing"},subtitle:{id:"organizationBillingInfo.subtitle",defaultMessage:"Only workspace owners can view and change these settings"},planTitle:{id:"organizationBillingInfo.planTitle",defaultMessage:"Plan"},activeEnterpriseLicense:{id:"organizationBillingInfo.activeEnterpriseLicense",defaultMessage:"Enterprise License"},pendingEnterpriseLicense:{id:"organizationBillingInfo.pendingEnterpriseLicense",defaultMessage:"Enterprise License (pending activation)"},resellerHostedEnterpriseLicense:{id:"organizationBillingInfo.resellerHostedEnterpriseLicense",defaultMessage:"Enterprise License"},activeEduLicense:{id:"organizationBillingInfo.activeEduLicense",defaultMessage:"Edu License"},pendingEduLicense:{id:"organizationBillingInfo.pendingEduLicense",defaultMessage:"Edu License (pending activation)"},resellerHostedEduLicense:{id:"organizationBillingInfo.resellerHostedEduLicense",defaultMessage:"Edu License"},activeTeamLicense:{id:"organizationBillingInfo.activeTeamLicense",defaultMessage:"Team License"},activeTeamLicenseNonProfitOrg:{id:"organizationBillingInfo.activeTeamLicenseNonProfitOrg",defaultMessage:"Team License (Non Profit Discount)"},pendingTeamLicense:{id:"organizationBillingInfo.pendingTeamLicense",defaultMessage:"Team License (pending activation)"},licenseExpiry:{id:"organizationBillingInfo.licenseExpiry",defaultMessage:"Active until {expiryDate, date, long}"},renewalDate:{id:"organizationBillingInfo.renewalDate",defaultMessage:"Renews on {expiryDate, date, long}"},deactivateDate:{id:"organizationBillingInfo.deactivateDate",defaultMessage:"Deactivates on {expiryDate, date, long}"},seatsTitle:{id:"organizationBillingInfo.seatsTitle",defaultMessage:"Seats"},seatsInUse:{id:"organizationBillingInfo.seatsInUse",defaultMessage:"{numSeats} in use ({numSeatsPct})"},invoicesTitle:{id:"organizationBillingInfo.invoicesTitle",defaultMessage:"Invoices"},invoiceName:{id:"organizationBillingInfo.invoiceName",defaultMessage:"Invoice: {createdDate, date, long}"},defaultInvoiceName:{id:"organizationBillingInfo.defaultInvoiceName",defaultMessage:"Invoice"},paidInvoice:{id:"organizationBillingInfo.paidInvoice",defaultMessage:"Paid: {invoiceDate, date, long}"},upcomingInvoice:{id:"organizationBillingInfo.upcomingInvoice",defaultMessage:"Due: {invoiceDate, date, long}"},noInvoices:{id:"organizationBillingInfo.noInvoices",defaultMessage:"No invoices found"},manageSubscription:{id:"organizationBillingInfo.manageSubscription",defaultMessage:"Manage subscription"},cancelSubscriptionBtn:{id:"organizationBillingInfo.cancelSubscriptionBtn",defaultMessage:"Cancel subscription"},manageLicenseBtn:{id:"organizationBillingInfo.manageLicenseBtn",defaultMessage:"Manage license"},managePaymentMethod:{id:"organizationBillingInfo.managePaymentMethod",defaultMessage:"Payment method"},manageBillingSchedule:{id:"organizationBillingInfo.manageSchedule",defaultMessage:"Billing schedule"},stripeErrorWarning:{id:"organizationBillingInfo.stripeErrorWarning",defaultMessage:"Error loading account information"},teamsAutochargeMessage:{id:"organizationBillingInfo.teamsAutochargeMessage",defaultMessage:"Your additional seats will be included on your next invoice."},billingLearnMore:{id:"organizationBillingInfo.billingLearnMore",defaultMessage:"Learn more"}});function Cs(){return Le(),e.jsx(ns,{})}export{Cs as default};
//# sourceMappingURL=bpk2ethvz62im2kr.js.map
