import{eZ as ae,e_ as $,ct as ce,e$ as b,r as m,dq as le,bo as fe,f0 as me,P as j,f1 as ye,u as y,e6 as I,ar as Z,av as U,R as X,X as de,cQ as ge,e4 as pe,bk as he,bq as Me,a7 as O,bF as J,E as S,F as v,bR as W}from"./g03cv0vnbvl8m3c2.js";import{bZ as ee,B as x,bE as _e,ea as ze,eb as Se,ec as Ge,ed as Pe,ee as V,bv as Ce,ef as ve,eg as F,aN as a,eh as Ee,ei as qe,ej as Fe,ek as be,el as we}from"./gmkdbvu1z26nwc2g.js";import{T as D,y as Te,g as Le}from"./eures2un3wat4y5c.js";function Re({clientThreadId:e}){var i;const t=D.getThreadCurrentLeafId(e),n=((i=D.getTree(e).getMessage(t).metadata)==null?void 0:i.model_switcher_deny)??[],s={};n.forEach(u=>{const{slug:f,context:c,reason:l,description:g}=u,d=s[f]??{},h=d[c]??[];h.push({reason:l,description:g}),d[c]=h,s[f]=d});const o=ae();for(const{resets_after:u,model_slug:f}of o)[$.CONVERSATION,$.REGENERATE].forEach(c=>{const l=s[f]??{},g=l[c]??[],d={reason:ce.RATE_LIMIT,resetsAfter:u};g.push(d),l[c]=g,s[f]=l});return s}const et="text-davinci-002-render-sha",tt="gpt-4",rt="gpt-4o",nt="o1-preview",st="o1-mini",Q=ee({slug:x,max_tokens:4097,title:"Default",description:"",tags:[b.GPT_3_5],product_features:{}}),De=({default_model:e,tagline:t,color:r,human_category_name:n,category:s,human_category_short_name:o,human_category_shorter_name:i,subscription_level:u,short_explainer:f,subcategory:c,...l})=>({color:r,tagline:t,defaultModel:e,label:n,shortLabel:o,description:f,shorterLabel:i??o,subscriptionLevel:u,categoryId:s,subcategory:c,...l}),Qe=({icon:e,icon_filled_src:t,icon_outline_src:r})=>({iconName:e,iconFilledSrc:t,iconOutlineSrc:r}),Ue=({group:e,human_group_name:t,human_group_short_name:r,model_ids:n})=>({group:e,label:t,shortLabel:r,modelIds:n});function Ae(){return U({retry:5,queryKey:["modelIcons"],queryFn:async()=>await X.getModelIcons().then(e=>Object.fromEntries(Object.entries(e).map(([t,r])=>[t,Qe(r)])))})}function Ke(e){return U({retry:5,queryKey:["models",{isHistoryDisabled:e}],queryFn:async()=>await X.getModels(e).then(t=>{const{models:r,internal_groups:n,categories:s}=t,o=r.map(ee);return{categories:s.concat().reverse().map(De),groups:(n==null?void 0:n.map(Ue))??[],modelsList:o,modelsMap:Object.fromEntries(o.map(i=>[i.id,i]))}})})}function E(){const e=ye();return y(Ke(e))}function ot(){return y(Ae())}function Ie({isRegen:e=!1}={}){const{isLoading:t,data:{categories:r=[],groups:n=[]}={}}=E(),s=m.useMemo(()=>e?r.filter(o=>o.is_regenerate_category!==!1):r.filter(o=>!o.is_regenerate_category),[r,e]);return{isLoading:t,categories:s,groups:n??[]}}function it(){const{categories:e}=Ie();return!!e.find(({categoryId:t})=>t===_e.GPT4o)}function ut(){const{data:e}=E();return m.useMemo(()=>e?new Set(Object.keys(e.modelsMap)):new Set([x]),[e])}const Oe={[x]:Q};function xe(){const{data:e}=E();return(e==null?void 0:e.modelsMap)??Oe}function te(e,t,r){let n=b.GPT_3_5;return r?n=b.GPT_4:t&&(n=b.GPT_4o),(e==null?void 0:e.modelsList.find(s=>s.tags.includes(n)))??(e==null?void 0:e.modelsList[0])??Q}function at(e=!1){const t=le(),r=fe(),[,n]=me();return m.useCallback(({location:s,modelId:o})=>{const i=t.pathname.includes("/g/");e||i?(j.logNewChatButtonClicked({location:s}),r({pathname:"/",search:`?model=${encodeURIComponent(o)}`})):(n(u=>(u.set("model",encodeURIComponent(o)),u)),j.logNewChatButtonClicked({location:s}))},[e,t,r,n])}function ct(){const{data:{categories:e=[]}={}}=E(),{doesUserHaveAnyAccountsWithPlusFeatures:t}=I();if(t)return null;const r=e.find(ze);return(r==null?void 0:r.defaultModel)??null}function He(e){return Te(e)}function Ne(e){const t=He(e),r=xe();return m.useMemo(()=>t==null?Q:r[t]??Q,[t,r])}function lt(e,t){const r=ke(e);return m.useMemo(()=>r.some(n=>n.systemHint===t),[r,t])}function ke(e){const t=Se(),r=Ne(e),n=m.useMemo(()=>!t.isSuccess||!t.data?[]:t.data,[t.data,t.isSuccess]),s=Re({clientThreadId:e});return m.useMemo(()=>{const i=new Set(r.enabledTools||[]);return n.filter(u=>!(!(u.requiredFeatures.length===0||u.requiredFeatures.every(l=>i.has(l)))||!(u.requiredModels.length===0||u.requiredModels.some(l=>!s[l]))))},[n,r,s])}function ft(e){return decodeURIComponent(e.model??"")||null}function mt(){const{data:e}=E(),{doesUserHaveAnyAccountsWithPlusFeatures:t}=I(),r=Z();return te(e,!!t,!!(r!=null&&r.isEnterprise()))}const re="q",Be="m";function yt(e){const{clientThreadId:t,currentLeafId:r,handleRequestCompletion:n}=e,s=m.useRef(!1),{isLoading:o,data:i}=E(),{doesUserHaveAnyAccountsWithPlusFeatures:u,isLoading:f}=I(),c=Z(),l=de(),g=m.useCallback((M,G,_,P)=>{D.updateTree(t,C=>{C.addNode(M,_,G,ge.User,void 0,P)})},[t]),d=m.useCallback(async(M,{content:G,attachments:_},P,C,q,L)=>{const K=r,p=_.length>0?{attachments:_}:{};p.system_hints=C.systemHints,g(M,K,G,p),n({type:pe.Next,promptId:M,requestedModelId:L,eventMetadata:P,cancelActiveRequests:!0,completionMetadata:C,turnTracker:q})},[g,n,r]),h=he(()=>window.location.pathname)??null,N=Ge();let k=!o&&!f&&h!=null;const[A,T]=m.useState(!0);return m.useEffect(()=>{if(!A||s.current)return;const M=Le.getConversationMode(t);if(!k||M==null)return;if(!je(h)||$e(h)&&N===void 0||D.getServerThreadId(t)!=null){T(!1);return}const{[re]:G,[Be]:_,[ve]:P,...C}=l.query,q=(typeof G=="string"?G:null)??(typeof _=="string"?_:null);if(!q||!q.trim()){T(!1);return}const L=Pe(P),K=Me();s.current=!0;let p=i==null?void 0:i.modelsList;L.has(V.Search)&&(p=p==null?void 0:p.filter(ue=>{var B;return(B=ue.enabledTools)==null?void 0:B.includes(V.Search)}));const R=i&&te({...i,modelsList:p??[]},!!u,!!(c!=null&&c.isEnterprise()));if(l.replace({query:C},void 0,{shallow:!0}),R==null){O.warning("No model available for this request"),T(!1);return}const ie=new Ce;d(K,{content:q,attachments:[]},{eventSource:"url"},{conversationMode:M,source:"instant-query",systemHints:P?Array.from(L):void 0},ie,R==null?void 0:R.id),T(!1)},[o,f,k,h,l,i,u,c,d,A,t,N]),A}function $e(e){return ne(e)}function ne(e){return e==null?!1:/^\/g\/[\w-]+$/.test(e)}function je(e){return e==null?!1:e==="/"||ne(e)}const dt="GPT Builder";function gt(e){if(e)return`ChatGPT - ${e}`}function H(e){return e.gizmo.short_url??e.gizmo.id??"-"}function se(e){return`/g/${e}`}function pt(e){return`https://chatgpt.com${se(e)}`}function We(e){return se(H(e))}function ht(e,t){const r=new URLSearchParams;return t!=null&&r.set(re,t),Ee(new URL(`${We(e)}?${r}`,"https://chatgpt.com"))}function Mt(e){return`/g/${H(e)}`}function _t(e){return qe(e)&&e.gizmo.live_version===0||Fe(e)&&e.liveVersion===0}function zt(e,t){return y({queryKey:["gizmos","discovery",{locale:e,isAnon:t}],queryFn:async()=>a.getGizmoDiscovery(e,t)})}function St({cutId:e,locale:t,limit:r,cursor:n,enabled:s=!0}){return J({queryKey:["gizmos","discovery",{cutId:e,locale:t,limit:r}],queryFn:async({pageParam:o})=>a.getGizmoDiscoveryCut(e,{locale:t,cursor:o,limit:r}),initialPageParam:n,getNextPageParam:o=>o.list.cursor??void 0,enabled:s})}function Gt(){return y({queryKey:["gizmos","pinned"],queryFn:async()=>a.getGizmoPinned()})}function w(){return U({queryKey:["gizmos","bootstrap"],queryFn:async()=>a.getGizmoBootstrap().then(e=>({gizmos:e.gizmos.map(t=>({resource:t.resource,flair:t.flair}))}))})}function Pt(){return y(w())}function Y(e,t){const r=e.filter(s=>s.resource.gizmo.id!==t.resource.gizmo.id);let n=r.findIndex(s=>s.flair.kind===F.Recent);return n===-1&&(n=r.length),r.splice(n,0,t),r}const Ct={handleGizmoInteracted(e,t){const r=e.getQueryData(z(e,t).queryKey);r!=null&&e.setQueryData(w().queryKey,n=>{if(n==null)return n;const s=n.gizmos.find(o=>o.resource.gizmo.id===t);return(s==null?void 0:s.flair.kind)===F.FirstParty||(s==null?void 0:s.flair.kind)===F.SidebarKeep?n:{gizmos:Y(n.gizmos,{resource:r,flair:{kind:F.Recent}})}})},handleGizmoSidebarKeep(e,t){const r=e.getQueryData(z(e,t).queryKey);r!=null&&e.setQueryData(w().queryKey,n=>n==null?n:{gizmos:Y(n.gizmos,{resource:r,flair:{kind:F.SidebarKeep}})})},handleGizmoSidebarHide(e,t){e.setQueryData(w().queryKey,r=>r!=null&&r.gizmos.some(n=>n.resource.gizmo.id===t)?{gizmos:r.gizmos.filter(n=>n.resource.gizmo.id!==t)}:r)}};function vt(e,t=!1){const r=S();return y(z(r,e,t))}function Et({gizmoId:e,draft:t,version:r}){const n=S(),s=r?{queryKey:["gizmo","version",{gizmoId:e,version:r}],queryFn:async()=>a.getVersion({gizmoId:e,version:r}),enabled:e!=null}:z(n,e,t);return y(s)}function qt(e,t){return y({queryKey:["gizmo","userActionSettings",{gizmoId:e}],queryFn:async()=>a.getUserActionSettings(e),enabled:e!=null&&t})}function z(e,t,r=!1){return U({queryKey:["gizmo",{gizmoId:t},{draft:r}],queryFn:async()=>a.getGizmo(t,r),enabled:t!=null,initialData:()=>{var o,i;if(r===!0)return;const n=e.getQueryData(w().queryKey);if(n!=null)return(o=n.gizmos.find(u=>u.resource.gizmo.id===t))==null?void 0:o.resource;const s=e.getQueryData(["gizmos","discovery"]);if(s!=null)for(const u of s.cuts){const f=(i=u.list.items.find(c=>c.resource.gizmo.id===t))==null?void 0:i.resource;if(f!=null)return f}}})}function Ft(e,t){return e.fetchQuery(z(e,t))}function bt(e){return y({queryKey:["gizmo",{search:e}],queryFn:async()=>a.getGizmoSearch(e),enabled:e.length>0})}function wt(e,t){return y({queryKey:["gizmo-search-workspace",{search:e}],queryFn:async()=>a.getGizmoSearchForWorkspace(e),enabled:e.length>0&&t})}function Tt(e,t=!1,r=!1,n=null){return J({queryKey:[r?"gizmo-search-workspace":"gizmo",{query:e,cursor:n}],queryFn:async({pageParam:s})=>r?a.getGizmoSearchForWorkspace(e,n=s):a.getGizmoSearch(e,n=s),initialPageParam:n,getNextPageParam:s=>s.cursor??void 0,enabled:t})}function Lt(){const e=S();return v({mutationFn:async({gizmoId:t,editorData:r})=>{const{instructions:n,name:s,description:o,profilePictureId:i,profilePictureUrl:u,promptStarters:f,tools:c,files:l,trainingDisabled:g}=r;return a.upsertDraft({instructions:n,display:{name:s,description:o,profile_pic_id:i,profile_picture_url:u,prompt_starters:f},tools:c,files:l.map(d=>({...d,location:be.FILE_SERVICE})),training_disabled:g},t)},onSettled:t=>{t&&(e.setQueryData(z(e,t.gizmo.id,!0).queryKey,t),e.invalidateQueries({queryKey:["gizmos","mine"],refetchType:"none"}))}})}function Rt(){const e=S();return v({mutationFn:async({gizmoId:t,data:r})=>{const{sharingRecipient:n,categories:s}=r,o=await a.promoteDraft({sharing:r.sharingSubjects&&r.sharingSubjects.length>0?r.sharingSubjects:{recipient:n},categories:s},t);if(o.error)throw new we(o);return o.resource},onSettled:t=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"}),e.invalidateQueries({queryKey:["gizmos","pinned"],refetchType:"none"}),t&&e.setQueryData(z(e,t.gizmo.id,!1).queryKey,t)}})}function Dt(){const e=S();return v({mutationFn:async({gizmoId:t})=>a.deleteGizmo(t),onSettled:()=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"})}})}function Qt(){const e=S();return v({mutationFn:async({name:t,hideName:r,websiteUrl:n,willReceiveSupportEmails:s})=>a.updateBuilderProfile({name:t,hide_name:r,website_url:n,will_receive_support_emails:s}),onSuccess:t=>{e.setQueryData(["builderProfile"],t)},onError:t=>{O.warning(t.message)}})}function Ut(){return y({queryKey:["builderProfile"],queryFn:async()=>a.getBuilderProfile()})}function At(){return v({mutationFn:async({gizmoId:e})=>a.copyGizmo({gizmoId:e})})}function Kt(){return y({queryKey:["gizmoCategories"],queryFn:async()=>a.getCategories()})}function It(e,t){return!!(t!=null&&[W.PrimaryAssistant,W.GizmoInteraction].includes(t)&&(e!=null&&e.includes(b.GPT_4)))}function Ot(e,t){const r=S();return v({mutationFn:async({rating:n,message:s,includeFrom:o})=>{await a.upsertUserReview(e,n,s,o)},onSuccess:async()=>{r.invalidateQueries({queryKey:["gizmo","review",{gizmoId:e}]})},onError:n=>{O.danger(n.message)}})}function xt(e,t){return t?`/g/${H(t)}/c/${e}`:`/c/${e}`}function Ht(){return"/gpts"}function Nt(){return"/gpts/mine"}function oe(e){return e?`/gpts/editor/${e}`:"/gpts/editor"}function kt(e){const t=Ve();return e==null?t:oe(e)}function Ve(e){return oe(e)}function Bt(e){try{const t=new URL(e);return t.hostname=t.hostname.replace(/^(www\.|web\.|mbasic\.|mobile\.)(secure\.)?/,""),t.pathname="",[...t.searchParams.keys()].forEach(r=>t.searchParams.delete(r)),t.toString()}catch{return e}}function Ye(e){if(!e)return null;try{return new URL(e).hostname}catch{return null}}function $t(e){const t=Ye(e);return t?t.replace(/^www\./,""):e}export{st as $,Ne as A,Nt as B,Ht as C,bt as D,wt as E,Tt as F,rt as G,zt as H,Ut as I,Qt as J,Kt as K,Et as L,E as M,tt as N,Lt as O,Rt as P,z as Q,se as R,ut as S,ft as T,Ft as U,ke as V,xe as W,lt as X,It as Y,dt as Z,nt as _,He as a,ot as a0,Re as a1,ct as a2,et as a3,yt as a4,Ie as b,mt as c,vt as d,it as e,Ot as f,xt as g,Dt as h,Mt as i,_t as j,oe as k,We as l,Ve as m,$t as n,Pt as o,gt as p,Ct as q,St as r,Gt as s,pt as t,at as u,ht as v,Bt as w,qt as x,kt as y,At as z};
//# sourceMappingURL=fa4f1ia3usj74vpi.js.map
