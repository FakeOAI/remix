import{K as u,L as d,r as g,eh as m,ao as l,bA as y,a8 as T,cl as f,aJ as p,h as v,j as R,D as A,ei as C}from"./ib63zzsfkf72wln1.js";import{cB as r,cC as H,cD as P}from"./fhv3hyfwgezymfbi.js";import{P as S,r as E}from"./bskmkizi274hjpny.js";import{s as b}from"./nowowewg8zs7o552.js";import{e as L,i as M,T as I}from"./ilsfcvf8qm64jji1.js";const D="prompt-textarea";function G(){document.getElementById(D)?.focus()}const K={getAndReset:(e,s)=>{const t=u.getItem(d.RestoreMessageAfterOauthRedirect);return u.removeItem(d.RestoreMessageAfterOauthRedirect),!t||t.userId!==e||s!==t.serverThreadId||Date.now()>t.expiresAt?null:t},set:(e,s,t)=>{const a={userId:e,serverThreadId:s,inputText:t,expiresAt:Date.now()+6e4};u.setItem(d.RestoreMessageAfterOauthRedirect,a)}},q=()=>S.useState(S.getPersistedSystemHints).has(r.Search),z=()=>{const e=S.useStore(),s=g.useCallback(()=>e.getPersistedSystemHintTrigger(r.Search),[e]),t=g.useCallback(()=>e.clearPersistedSystemHintTrigger(r.Search),[e]),a=g.useCallback((o,n,i)=>{(o?e.addPersistedSystemHint:e.removePersistedSystemHint)(r.Search,n,i)},[e]);return{getSearchModeTrigger:s,clearSearchModeTrigger:t,setThreadSearchMode:a}},x=1e3;function N(e){return e&&e.length>x&&!m().shift&&l.checkGate("1508312659")}async function O(e,s){const t=P(e),a=t??await R.getConversation(e);return s==null&&t&&(s=!0),t||A.addTiming("chatgpt.web.chatPage.loadExistingConversation"),I.initThreadFromServerData(e,a,s,void 0,s),b(a.conversation_id,a.async_status?{source:C.SERVER,value:a.async_status}:null),a}const j=e=>{const s=y(),{pathname:t}=T(),a=f(),o=L(),n=p();v({queryKey:["conversation",e],queryFn:()=>O(e).catch(i=>{const c=H(t),h=c!=null?E(c):"/";throw s(h),n.danger(`Unable to load conversation ${e}`,{testId:"conversation-fetch-error-toaster"}),i}),enabled:!M(e)&&!a&&!o,refetchOnMount:!0})};export{K as P,D as T,j as a,q as b,O as f,N as i,G as t,z as u};
//# sourceMappingURL=nbp7wfexn6ecviwe.js.map
