import{J as G,r as g,Z as M,j as e,aq as K,m as q,W as R,ak as p,bA as Z,bB as Q,cU as V,dP as J,aB as F,aU as O,aw as A,ee as k,au as Y,av as X,f3 as $}from"./f2udakjpoavu4gos.js";import{a2 as P,a_ as ee,cb as te,fC as se,kb as z,cv as ae,b9 as ne,cQ as ie,kc as re,kd as oe,aV as L,f4 as le,cB as ce,ke as de,eH as ue,a5 as me,f3 as ge,ji as fe,jj as xe,q as pe,kf as y,kg as j,kh as I,ki as he,kj as x,ca as Se,kk as be,cF as ve,kl as je,em as Ce,km as E,aW as w,kn as ke,ko as ye,kp as Ne,kq as C,kr as ze,g4 as Ie,en as Ge,ks as Me,kt as Te,ku as Fe,fz as Oe,kv as Ae}from"./sfdamp1qo3tlrbo9.js";import{as as Pe,bC as Le,aw as Ee,K as we,bf as _e,L as Be}from"./ml8qzer8gjkdgre1.js";import{m as _}from"./bomnvk8yicq90eph.js";import{a as Ue}from"./gl0adgh982hb5wsf.js";import{U as De,P as He}from"./npkx6d28cct04tdy.js";function B({gizmo:t,historyDisabled:n,section:s,onClick:o,isActive:r,hideOverflowMenu:i=!1}){const{clientThreadId:d}=P();ee(d);const c=G(),[u,a]=g.useState(!1),[l,m]=g.useState(!1),[f,h]=g.useState(!1),S=M(),b=!!t?.gizmo.tags?.includes(te.FirstParty),T=!1;let H=!1;const[W,Xe]=g.useState(0);let v;if(t!=null)v=t.gizmo.display.name||se;else{if(S==null)return null;n?v=c.formatMessage(z.clearChat):S.canInteractWithGizmos()?v=oe:v=c.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(_.div,{whileTap:{scale:.98},onMouseEnter:()=>{m(!0)},onMouseLeave:()=>{m(!1)},children:e.jsx(ae,{loggingGizmoId:t?.gizmo.id??"primary",href:t!=null?ne(t):"/",onClick:o,showActiveIndicator:H,icon:e.jsx(ie,{gizmoId:t?.gizmo.id,isFirstParty:t==null||b,src:t?.gizmo.display.profile_picture_url,className:"h-6 w-6"}),isMenuOpen:u,label:v,hoverLeftIcon:l&&t&&T&&W&&e.jsx("button",{onClick:N=>{N.preventDefault(),h(!f)},className:"flex text-token-text-secondary hover:text-token-text-primary",children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:f?e.jsx(Pe,{className:"icon-md"}):e.jsx(Le,{className:"icon-md"})})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(l||u)&&t!=null&&!T&&!i&&e.jsx("div",{className:"text-token-text-tertiary",onClick:N=>{N.preventDefault()},children:e.jsx(re,{gizmo:t,isOpen:u,setIsOpen:a,section:s})}),!i&&e.jsx(K,{side:"right",label:c.formatMessage(n?z.clearChat:z.newChat),className:"flex items-center",children:e.jsx("button",{className:u?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:n?e.jsx(Ee,{className:"icon-md"}):e.jsx(we,{className:"icon-md"})})})]})})}),!1]})}function We({isActive:t,isNewConversation:n}){const s=q(),o=R(),r=L();return e.jsx("div",{className:p(r?"":"bg-token-sidebar-surface-primary","pt-0"),children:e.jsx(B,{gizmo:void 0,isActive:t,onClick:i=>{Z(Q(s))&&!n&&(i.preventDefault(),le(o))}})})}function U(){const t=G(),n=ce(),s=t.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(de,{children:e.jsx(_.div,{whileTap:{scale:.98},children:e.jsx(V,{to:ue(),onClick:()=>{n.activeSidebar==="popover-nav"&&me.setActiveSidebar(!1)},children:e.jsx(ge,{icon:_e,"data-testid":"explore-gpts-button",children:s})},"explore")})})}const Ke=2;function qe(t,n,s,o){const r=pe(t,a=>a.flair.kind),i=[...r[y.FirstParty]?.map(({resource:a})=>({gizmo:a,section:j.Keep}))??[],...r[y.SidebarKeep]?.map(({resource:a})=>({gizmo:a,section:j.Keep}))??[],...r[y.Recent]?.slice(0,o?r[y.Recent]?.length:Ke).map(({resource:a})=>({gizmo:a,section:j.Recents}))??[]],d=i.length>s+1,c=(d||o)&&!n&&i.length>s?i.slice(0,s):i,u=[...c.filter(({section:a})=>a===j.Keep),...c.filter(({section:a})=>a===j.Recents)];return{listItems:n?u.slice(I):u,itemsLeft:i.length-c.length,needsToCollapseItems:d}}function D({gizmo:t,currentGizmoId:n,maxToShowOnLoad:s,hideOverflowMenu:o=!1}){const r=g.useRef(!1),i=!s,d=L(),{listItems:c}=qe(t,i,s??0,d);g.useEffect(()=>{c.length>0&&!r.current&&(fe({namespace:xe.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),r.current=!0)},[c]);function u(a,l){const m=e.jsx(B,{gizmo:a,isActive:a.gizmo.id===n,section:l,hideOverflowMenu:o},a.gizmo.id);return d?e.jsx("li",{children:m}):m}return e.jsxs("div",{children:[c.map(({gizmo:a,section:l},m)=>e.jsxs(g.Fragment,{children:[m>1&&l!==c[m-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),u(a,l)]},m)),!d&&e.jsx(U,{})]})}function Re({currentGizmoId:t,gizmos:n,onClick:s}){const{isSidebarFlyoutOpen:o,onSidebarFlyoutOpenChange:r}=he(),i=o(x.Gizmo);return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(J,{onOpenChange:d=>r(x.Gizmo,d),side:"right",sideOffset:4,open:i,contentAlign:"end",triggerButton:e.jsxs("button",{className:p("flex flex-1 select-none items-center gap-2 rounded-lg px-2 py-2.5 text-sm tracking-condensed text-token-text-secondary hover:bg-token-main-surface-secondary focus:ring-0",i&&"bg-token-main-surface-secondary"),onClick:s,children:[e.jsx(Be,{className:p("icon-md mr-1 font-semibold text-token-sidebar-icon")}),e.jsx("span",{className:"text-left",children:e.jsx(F,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(O,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(D,{gizmo:n,currentGizmoId:t,hideOverflowMenu:!0})})})})})})}function Ze({currentGizmoId:t}){const{data:{gizmos:n}={}}=Se();let s=n;const o=!s||s?.length===0,r=s&&s?.length>I;return o?null:e.jsx(e.Fragment,{children:e.jsxs(be,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(F,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(U,{}),e.jsx(We,{isActive:t===void 0,isNewConversation:!0}),e.jsx(D,{gizmo:s??[],currentGizmoId:t,maxToShowOnLoad:I}),r&&e.jsx(O,{children:e.jsx(Re,{currentGizmoId:t,gizmos:s??[]})})]})})}function Qe({clientThreadId:t}){const n=M(),s=ve(t),{isUnauthenticated:o}=A();return o?null:e.jsxs("div",{className:p(k.screenContent),children:[null,e.jsx(je,{clientThreadId:t}),n?.canInteractWithGizmos()?e.jsx(Ze,{currentGizmoId:s}):null]})}function Ve(){const t=M(),n=t?.data==null,{isUnauthenticated:s}=A(),{openSettings:o}=Ce(),[r]=g.useState(()=>{const l=Y.getCookie(X.Workspace);return typeof l=="string"&&l!==$}),i=G(),{store:d,actions:c}=E(),u=d(l=>l.mode);if(!t||r&&n)return null;const a=s?e.jsx(De,{}):e.jsx(Ue,{onClickSettings:()=>o()});return e.jsxs(w,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[a,e.jsx("div",{className:k.togglePinWrapper,children:e.jsx(ke,{tooltipSideOffset:14,className:k.pinSidebarAction,icon:e.jsx(ye,{}),onActivate:l=>{l.preventDefault(),l.persist(),Ne.togglePinSidebar(l,c,u===C.Floating?C.Pinned:C.Floating)},label:u===C.Floating?i.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):i.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:ze.FloatingOrPinned})})]})}function Je(){return e.jsx(w,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(He,{})})}function Ye(){return e.jsxs(Ie,{className:p(k.screenTrailingBarContainer),children:[e.jsx(Ge,{}),e.jsx(Je,{}),e.jsx(Ve,{})]})}function it(){const{clientThreadId:t,onNewThread:n}=P(),[s,o]=g.useState(!1),[r,i]=g.useState(!1),[d,c]=g.useState(!1),{store:u,actions:a}=E(),l=g.useCallback(f=>f===x.Conversation?s:f===x.Gizmo?r:f===x.Conversation2?d:!1,[s,r,d]),m=g.useCallback((f,h)=>{const S=b=>{f===x.Conversation?o(b):f===x.Gizmo?i(b):f===x.Conversation2&&c(b)};if(h){S(h);return}setTimeout(()=>{S(h)},100)},[]);return Me(()=>{m(x.Conversation,!1),m(x.Gizmo,!1),m(x.Conversation2,!1),window.matchMedia("(max-width: 700px)").matches&&u.getState().mode===C.Floating&&setTimeout(()=>{a.closeSidebar()},100)}),e.jsxs(Te,{value:{isSidebarFlyoutOpen:l,onSidebarFlyoutOpenChange:m},children:[e.jsx(Fe,{}),e.jsx(Oe,{anchor:"vertical",className:p(k.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Ae,{onNewThread:n}),trackLeading:!0,trailing:e.jsx(Ye,{}),children:e.jsx(Qe,{clientThreadId:t})})]})}export{it as C,We as D,D as G};
//# sourceMappingURL=hdp76dkdga55bhk0.js.map
