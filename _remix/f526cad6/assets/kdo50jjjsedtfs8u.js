import{x as p,ab as x,q as l,m as t,aW as v,aS as d,bf as h,y as u,d as M}from"./lj034xtwgajnbw80.js";import{a_ as f,a$ as T,b0 as b,b1 as C}from"./hwys1cva3r0syt2i.js";import{J as _}from"./b6cy1eq07lpymojm.js";import{m as O}from"./kg90shbkih4fj2ta.js";const k=s=>{for(const e of s.concat().reverse()){if("messages"in e)return e.messages[e.messages.length-1].nodeId;if("message"in e)return e.message.nodeId}},y=({clientThreadId:s,lastMessageNodeId:e})=>{const n=v(s),r=f({clientThreadId:s,conversationMode:n}),i=async()=>{T();const a=[l.CANMORE],o=new b;r({id:e,eventMetadata:{eventSource:"mouse"},systemMessage:"The user has requested the canvas tool be disabled for this conversation. You should not call the tool again.",systemMessageMetadata:{disable_tool_ids:a},turnTracker:o});const c=u.getTree(s),m=c.getConversationTurns(e).length,g=c.getParentPromptNode(e).message.id;C.logEventWithStatsig(M.canvasOptOutClicked,"chatgpt_canvas_opt_out_clicked",{num_turns:String(m),user_message_id:g}),u.setDisabledToolsForThread(s,a)};return t.jsxs(O.div,{className:"flex flex-wrap gap-2 pt-[3px]",initial:{opacity:0},animate:{opacity:1},children:[t.jsx(d,{id:"9NFVc4",defaultMessage:"Don't want me to use canvas?"}),t.jsxs("button",{onClick:i,className:"inline-flex min-h-5 w-fit select-none items-center text-start text-token-text-secondary hover:text-token-text-primary",children:[t.jsx(d,{id:"cXTG4f",defaultMessage:"I can answer in chat instead"}),t.jsx(_,{className:"icon-md text-token-text-secondary"})]})]})},S=()=>h()?.includes("canvas_opt_out"),F=({clientThreadId:s,groupedMessages:e,isFinalTurn:n,hasActiveRequest:r})=>{const i=S(),a=p(()=>x.getThreadDisabledToolIds(s)),o=k(e);return i&&n&&!r&&!a?.includes(l.CANMORE)&&o&&t.jsx(y,{clientThreadId:s,lastMessageNodeId:o})};export{F as CanvasOptOutMessage};
//# sourceMappingURL=kdo50jjjsedtfs8u.js.map
