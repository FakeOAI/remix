const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kd2lvasdkvet4n1t.js","assets/m22vykpz3ufxnjxd.js","assets/hfrc69bv614p09qd.js","assets/root-hfasch8z.css","assets/h96qd92qx1wl4bxm.js","assets/conversation-small-eplmind9.css","assets/n13zt2dg444thhb4.js","assets/fzgvnbvf1g102okb.js","assets/fjsffie7vnsc9yaf.js","assets/b1vymk3b6yc5d4ka.js","assets/miejut141tryjzs3.js","assets/i5939eroqfuo9u68.js","assets/kx976eoy7979gedm.js","assets/fou1aww09tcwalkv.js","assets/c1lxfkqsix2qq9xn.js","assets/nlwsujzlezcq2s8r.js","assets/crdiwge7dpbiv50m.js","assets/el9udrhj2ej66c1f.js","assets/kq2l3r1bxeoezqj0.js","assets/ks6fijcy00ptjpoc.js","assets/iut8qntwjhdqfd1c.js"])))=>i.map(i=>d[i]);
import{r as c,aD as W,aE as ee,ao as R,P as S,a as E,V as L,bU as H,f3 as x,f4 as B,bA as te,l as s,m as b,cj as se,Q as ae,u as P,bp as ne,aK as re,j as N,Z as w,a0 as ie}from"./m22vykpz3ufxnjxd.js";import{dR as oe,dS as le,dT as U,dU as de,dO as A,dV as ce,H as ue,J as fe,bG as Y,c as me,dW as he,dX as ye,dY as ge,dZ as q,d_ as pe,dP as be}from"./h96qd92qx1wl4bxm.js";import{b as ve,g as xe}from"./n13zt2dg444thhb4.js";import{b as Te,r as k,s as Se}from"./i5939eroqfuo9u68.js";import{f as Ee}from"./miejut141tryjzs3.js";import{t as Ne,v as V,w as Ie,s as we,T as $}from"./fzgvnbvf1g102okb.js";import{G as z}from"./b1vymk3b6yc5d4ka.js";import{a7 as Ce}from"./hfrc69bv614p09qd.js";import{m as ke}from"./fjsffie7vnsc9yaf.js";function je(e,t,r){const{title:a,titleSource:n}=Ne(e),[i,l]=c.useState(!1),d=a??t,o=c.useRef(d);return c.useEffect(()=>(r&&n===V.Generated&&d!==o.current&&l(!0),()=>{o.current=d}),[r,d,n]),{isTypingEffect:i,resolvedTitle:d}}const _e=W(()=>ee(()=>import("./kd2lvasdkvet4n1t.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.GizmoConversationOptionsDropdown)),De=new Date(2024,8,24,13);function Me(e){R.checkGate("3922476776")||oe.abortAllRequests(),S.logEvent(E.loadThread,{threadId:e})}function Oe({conversation:e,conversationTitle:t,onOpenChange:r,testId:a}){const n=L(),{isUnauthenticated:i}=ae(),{eligible:l,markAsViewed:d}=ue(fe.ArchiveConversationOnboarding),o=we(e.id),[h,g]=c.useState(!1),u=P(),f=ne(),v=re();return c.useEffect(()=>B(z,{deleteChat:({serverThreadId:m})=>{m===e.id&&g(!0)},archiveChat:async({serverThreadId:m})=>{m===e.id&&(await N.patchConversation(e.id,{is_archived:!0}),k(u),R.logEvent("chatgpt_conversation_archived"),S.logEvent(E.conversationArchived),l&&(v.info(n.formatMessage({defaultMessage:"You can view archived chats in Settings",id:"HistoryGizmoItem.archiveChatOnboarding"}),{duration:10,hasCloseButton:!0}),d()),o&&Y(f))}}),[f,v,u,l,e.id,n,o,d]),i?null:s.jsxs(s.Fragment,{children:[s.jsx(me,{label:n.formatMessage({id:"tJPHEQ",defaultMessage:"Options"}),sideOffset:4,side:"top",children:s.jsx(_e,{clientThreadId:e.id,onOpenChange:r,children:s.jsx("button",{className:"flex items-center justify-center text-token-text-secondary transition hover:text-token-text-primary radix-state-open:text-token-text-secondary","data-testid":a,children:s.jsx(Ce,{className:"icon-md"})})})}),h&&s.jsx(he,{title:t,handleDelete:()=>{N.patchConversation(e.id,{is_visible:!1}).then(()=>{k(u),R.logEvent("chatgpt_conversation_deleted"),S.logEvent(E.conversationDeleted)}),o&&Y(f)},onClose:()=>{g(!1)}})]})}function Re({conversation:e,onClose:t}){const[r,a]=c.useState(e.title),n=P();function i(){r!==e.title&&($.setTitle(e.id,r,V.User),S.logEvent(E.renameThread,{threadId:e.id,content:r}),N.patchConversation(e.id,{title:r}).then(()=>{k(n)}))}return s.jsx("input",{type:"text",value:r,onChange:l=>{a(l.target.value)},onKeyDown:l=>{switch(l.key){case"Escape":t();break;case"Enter":i(),t();break}},onBlur:()=>{i(),t()},autoFocus:!0,className:"w-full border border-token-border-light bg-transparent p-0 text-sm"})}const K=5,Le=3e3;function Pe({threadId:e}){const t=P(),r=c.useRef(!1),a=c.useRef(null);return c.useEffect(()=>{async function n(){r.current=!0;const i=await Ee(e);if(i.async_status===x.FINISHED){k(t),$.initThreadFromServerData(e,i,!0,void 0,!0);return}if(i.async_status!==x.PENDING)return;const l=i.update_time??0;U(new Date,new Date(l*1e3))<K?a.current=window.setTimeout(n,Le):N.clearConversationStatus(e)}return r.current||n(),()=>{a.current&&window.clearTimeout(a.current)}},[t,e]),null}function Ae({conversation:e,isActive:t,elementRef:r,isPrimaryBackgroundColor:a,testId:n}){const i=L(),[l,d]=c.useState(!1),[o,h]=c.useState(!1),{value:g}=H("3922476776"),{value:u}=H("232791851"),f=Te(e.id),v=Ie(e.id),m=le(v),y=U(new Date,new Date(e.update_time??0))<K,I=e.update_time&&de(new Date(e.update_time),De),j=f===x.PENDING&&y,_=u&&!t&&!m&&I&&f===x.FINISHED,D=u&&!t&&(m||j),M=u&&f===x.PENDING&&!m&&y,T=c.useRef(!1);c.useEffect(()=>{!T.current&&!m&&f===x.FINISHED&&t&&g&&(async()=>(T.current=!0,await N.clearConversationStatus(e.id),Se(e.id,null),T.current=!1))()},[g,t,e.id,f,m]),c.useEffect(()=>B(z,{editTitle:({serverThreadId:p})=>{(p?p===e.id:t)&&d(!0)}}),[e.id,t]);const F=i.formatMessage({id:"mpXAeu",defaultMessage:"New chat"}),{resolvedTitle:O,isTypingEffect:X}=je(e.id,e.title,t),Q=te(),J=X&&t&&Q,{data:Z}=ve(e.conversation_template_id??void 0),G=A();return s.jsxs("div",{className:b("no-draggable group relative rounded-lg active:opacity-90",t?"bg-token-sidebar-surface-secondary":"hover:bg-token-sidebar-surface-secondary",o&&!t&&"bg-token-sidebar-surface-secondary"),children:[M&&s.jsx(Pe,{threadId:e.id}),s.jsx(se,{to:xe(e.id,Z),onClick:p=>{p.metaKey||p.ctrlKey||t||Me(e.id)},onDoubleClick:()=>{d(!0)},ref:r,className:"flex items-center gap-2 p-2",style:{maskImage:G?"var(--sidebar-mask":void 0},children:s.jsxs("div",{className:b("relative grow overflow-hidden whitespace-nowrap",D&&"loading-shimmer"),dir:"auto",children:[J?s.jsx(ce,{text:O||F}):O||F,!G&&s.jsx("div",{className:b("absolute bottom-0 top-0 to-transparent ltr:right-0 ltr:bg-gradient-to-l rtl:left-0 rtl:bg-gradient-to-r",a?t||!t&&o?"from-token-sidebar-surface-secondary":"from-token-main-surface-primary":!1,a?!1:t||!t&&o?"from-token-sidebar-surface-secondary":"from-token-sidebar-surface-primary",{"from-token-main-surface-primary can-hover:group-hover:from-token-sidebar-surface-secondary":a&&!t&&!o,"from-token-sidebar-surface-primary can-hover:group-hover:from-token-sidebar-surface-secondary":!a&&!t&&!o,"w-10 from-60%":t||o,"w-8 from-0% can-hover:group-hover:w-10 can-hover:group-hover:from-60%":!t&&!o})})]})}),l?s.jsx("div",{className:"absolute bottom-0 left-[7px] right-2 top-0 flex items-center bg-token-sidebar-surface-secondary",children:s.jsx(Re,{conversation:e,onClose:()=>{d(!1)}})}):_?s.jsx("div",{className:"absolute bottom-0 top-0 flex items-center gap-1.5 pr-2 ltr:right-0 rtl:left-0",children:s.jsx("div",{className:"h-2 w-2 rounded-full bg-blue-selection"})}):s.jsx("div",{className:b("absolute bottom-0 top-0 items-center gap-1.5 pr-2 ltr:right-0 rtl:left-0",t||o?"flex":"hidden can-hover:group-hover:flex"),children:s.jsx(Oe,{conversation:e,conversationTitle:O??e.title,onOpenChange:p=>{h(p),p&&S.logEvent(E.conversationHistoryItemOpenMenu,{conversationId:e.id})},testId:`${n}-options`})})]})}const Fe={initial:({isNew:e})=>e?{opacity:0,height:0,overflow:"hidden"}:{},animate:()=>({opacity:1,height:"auto"}),exit:()=>({opacity:0,height:0})};function Ge({elementRef:e,item:t,isActive:r,isFirstItem:a,isExistingItem:n,isPrimaryBackgroundColor:i,testId:l}){const d=A();return s.jsx(ke.li,{className:b("relative",a&&!d?"z-[15]":""),layout:"position",custom:{isNew:!n},variants:Fe,initial:"initial",animate:"animate",exit:"exit","data-testid":l,children:s.jsx(Ae,{isPrimaryBackgroundColor:i,conversation:t,isActive:r,elementRef:e,testId:l})})}const C=ie({historyBucketToday:{id:"history.bucket.today",defaultMessage:"Today"},historyBucketYesterday:{id:"history.bucket.yesterday",defaultMessage:"Yesterday"},historyBucketLastSeven:{id:"history.bucket.lastSeven",defaultMessage:"Previous 7 Days"},historyBucketLastThirty:{id:"history.bucket.lastThirty",defaultMessage:"Previous 30 Days"}}),He=5;function Qe(e,t){const r=L();return c.useMemo(()=>e.reduce((a,n)=>{const i=new Date(n.update_time??n.create_time??0),l=ye(new Date,i);if(l===0)a.recent.today.items.push(n);else if(l<=1)a.recent.yesterday.items.push(n);else if(l<=7)a.recent.lastSeven.items.push(n);else if(l<=30)a.recent.lastThirty.items.push(n);else if(ge(i)){const d=q(i),o=pe(i),h=`${d}-${o}`;a.dynamicMonths[h]?a.dynamicMonths[h].items.push(n):a.dynamicMonths[h]={label:r.formatDate(i,{month:"long"}),items:[n]}}else{const o=`${q(i)}-`;a.dynamicYears[o]?a.dynamicYears[o].items.push(n):a.dynamicYears[o]={label:r.formatDate(i,{year:"numeric"}),items:[n]}}return a},{recent:{today:{label:s.jsx(w,{...C.historyBucketToday}),items:[]},yesterday:{label:s.jsx(w,{...C.historyBucketYesterday}),items:[]},lastSeven:{label:s.jsx(w,{...C.historyBucketLastSeven}),items:[]},lastThirty:{label:s.jsx(w,{...C.historyBucketLastThirty}),items:[]}},dynamicMonths:{},dynamicYears:{}}),[t,e])}function Je({activeId:e,bucketedItems:t,items:r,hasNextPage:a,isPrimaryBackgroundColor:n,previousItems:i,infiniteScrollTriggerElementRef:l}){const d=A();return s.jsx(s.Fragment,{children:[t.recent,t.dynamicMonths,t.dynamicYears].flatMap((o,h)=>s.jsx(c.Fragment,{children:Object.entries(o).map(([g,{items:u,label:f}],v)=>{if(g!=="today"&&!u.length)return null;const m=!!u.find(y=>r.length>0&&y.id===r[0]?.id);return u.length>0&&s.jsxs("div",{className:b(n&&"first:mt-0","relative mt-5 first:mt-0 last:mb-5"),children:[s.jsx("div",{className:b("sticky z-20",!d&&"bg-token-sidebar-surface-primary",d?"top-[--sidebar-sticky-threshold] mb-2":"top-0"),children:s.jsx("span",{className:"flex h-9 items-center",children:s.jsx(be,{children:f})})}),s.jsx("ol",{children:u.map((y,I)=>{const j=e===y.id,_=m&&I===0,D=i?.find(({id:T})=>T===y.id),M=a&&r[r.length-He-1]?.id===y.id?l:void 0;return s.jsx(Ge,{item:y,isActive:j,isFirstItem:_,isExistingItem:!!D,isPrimaryBackgroundColor:n,elementRef:M,testId:`history-item-${I}`},`history-item-${y.id}-${g}`)})})]},`${g}-${h}-${v}`)})},`category-${h}`))})}export{Je as H,Ge as a,Me as o,Qe as u};
//# sourceMappingURL=mohsml87gd6nkpni.js.map
