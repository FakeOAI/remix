const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/sso-k1m7wpjxj23so5oa.js","assets/bve7stqsvuyp30oy.js","assets/jza0wh4acfmo8aml.js","assets/root-cqviwlml.css","assets/ey0wg4za1oyqifqv.js","assets/conversation-small-cll5buey.css","assets/deec37q0oqrigjkr.js","assets/lk3ytoqve6n2hksk.js","assets/25r7helde3zylny5.js","assets/lcsvs3nxna2cdwpx.js","assets/ljvnn957d5onfwd2.js","assets/horqi5aemy4xy4nt.js","assets/j6nq6u5ihk30ar3w.js","assets/lgalri2sjqq86cvn.js","assets/fdm7sv58kys1c2zt.js","assets/hqdtjjkqdvcgaya7.js","assets/z5xaxocyw24yicho.js","assets/l0aizcanr3np560f.js","assets/j82zhv4etct0sx6n.js","assets/itghwucfyv5ciib7.js","assets/c801z4h43h3egbgq.js","assets/ypv8rtnxs306lddw.js","assets/d7ovfzvwwi9yjepb.js","assets/lmpwyucl1ngauc82.js","assets/jsrfadl5v8j93lbb.js","assets/983a0dy92b3ronpv.js","assets/ghd827kff4vn9o5a.js","assets/kqwdyvkaaavvn8k3.js","assets/envye1cm5974w5v2.js","assets/o2jtswb4jybm6irk.js","assets/jto4fg6t0oa1zrd7.js","assets/ircjim3m6glzdb49.js","assets/e9lafxuzyeh4418f.js","assets/gx6kzw6ihr5wwxge.js","assets/dmweprv8mc5bmc9r.js","assets/dj8kjk2d87xyjech.js","assets/imdg93ud0dqm0sbl.js","assets/d593ay1irlbilqc5.js","assets/mxjlbcmis3fou9jh.js","assets/iej0cupg2dqkmejt.js","assets/h65xpxg1jhhp2wla.js","assets/hwviy28wqecnue05.js","assets/jk8w36bsokizpx57.js","assets/ocnf3ui8jti1f2ip.js","assets/dan2jejzay5j96ch.js","assets/gr5239b2ze2nlypy.js","assets/ctduz57wyq9lw6ot.js","assets/ef6g0xg7qwmvr7fm.js"])))=>i.map(i=>d[i]);
import{r as l,aw as _e,a6 as s,P as V,d as H,aG as R,b3 as ja,ga as Co,bU as Ma,c as Cr,f as jr,ax as wn,aj as ae,ak as je,cB as Cn,aB as Je,c2 as _t,R as ve,ar as A,aZ as Ie,da as jo,bF as Mo,U as Tt,gb as Mr,gc as kr,a7 as Pt,dD as _r,c_ as ka,b0 as ko,bY as _o,aE as Us,aF as Hs,w as ze,a2 as Hn,S as he,aY as is,b7 as rs,aK as Ve,aa as Ws,a5 as To,aJ as _a,a3 as ls,$ as Tr,Z as Ao,bR as Gs,an as Vs,cX as Ar,eK as Wn,I as Ze,aR as kt,bO as Er,bP as Rr,bQ as Nr,s as Pr,bs as Ue,D as jn,O as Eo,a0 as Ir,a8 as Ta,j as Ro,ev as Dr,K as qe,v as No,n as yt,a9 as Fr,X as Gn,gd as Lr,dx as Or,dy as Br,dB as Qt,dz as Aa,dA as zr,c1 as wt,ge as Ur,M as At,aO as Hr,cQ as Wr,a_ as fe,at as Gr,aP as Vr,bL as qr,b6 as $r,gf as Kr,di as Yr}from"./bve7stqsvuyp30oy.js";import{mr as qs,nK as Xr,nL as Qr,bi as $s,em as Zr,nM as Jr,nN as el,gB as Ks,gC as rt,bS as cs,nO as tl,cR as $e,da as Po,dd as Io,f1 as sl,a2 as nl,dz as al,d9 as ol,nP as Ne,nQ as Et,nR as il,nS as rl,nT as ll,nU as cl,nV as ul,mv as dl,ef as lt,nW as hl,nX as ml,X as ee,nY as fl,nZ as ue,n_ as Do,n$ as Fo,o0 as Vn,o1 as gl,o2 as Lo,nm as qn,o3 as $n,o4 as pl,o5 as xl,o6 as Ys,o7 as $t,j2 as Mn,cO as Xs,cJ as Kn,E as Qs,o8 as Oo,o9 as bl,oa as vl,ob as Sl,m_ as Jt,s as Bo,oc as yl,od as wl,oe as Cl,dv as zo,dk as jl,of as Ml,jJ as kl,go as _l,og as Tl,oh as Al,oi as Uo,oj as El,c8 as ct,ok as Rl,ol as Ps,r as Ea,h2 as Nl,ir as Pl,fz as Il,om as Ho,iz as Dl,ku as Fl,on as Wo,oo as Ll,bA as Ol,i2 as Yn,gt as Xn,op as Bl,oq as Go,dZ as es,c_ as Rt,or as Vo,os as qo,cV as Zs,dU as ts,p as $o,ot as He,ou as Ko,ov as zl,ow as Ul,ox as Is,oy as Hl,oz as Wl,oA as Gl,n as Vl,oB as ql,oC as $l,oD as Kl,oE as Yl,oF as Js,oG as Qn,oH as Xl,cL as Yo,oI as Ql,bd as It,oJ as Zl,mC as Xo,oK as Jl,cI as ec,cG as tc,oL as sc,mh as Ds,aa as Zn,fw as Qo,fp as Zo,j0 as Ra,oM as nc,oN as ac,j1 as oc,mZ as ic,n6 as Na,oO as rc,oP as lc,i$ as cc,oQ as uc,fj as Jo,oR as dc,oS as hc,kz as ei,gA as ti,z as Jn,oT as Pa,cB as mc,oU as fc,oV as gc,gb as pc,mX as xc,gc as bc,gd as vc,oW as si,oX as kn,oY as Sc,oZ as yc,o_ as wc,o$ as Cc,p0 as jc,ce as Mc,U as ss,bt as ni,bu as kc,p1 as _c,p2 as Tc,p3 as Ac,p4 as Ec,p5 as Rc,p6 as Nc,p7 as Pc,p8 as Ic,dS as Dc,ge as Fc,a8 as Nt,p9 as Lc,pa as Oc,cg as Bc,pb as zc,pc as Uc,pd as Hc,pe as Wc,pf as Gc,pg as Vc,dO as ea,eg as ta,a7 as sa,ph as ai,pi as na,c$ as ns,pj as qc,pk as $c,pl as Kc,g0 as Qe,iY as Fs,mw as _n,iU as oi,gE as ii,pm as ri,pn as Yc,po as Xc,pp as Qc,cU as aa,cY as Tn,pq as Zc,pr as li,dP as en,ps as Jc,cT as As,pt as An,d as ci,pu as Ia,pv as eu,pw as tu,px as su,cS as nu,py as au,pz as ou,pA as iu,bF as ru,nC as lu,pB as cu,f2 as uu,q as du,pC as hu,pD as ui,pE as di,lq as hi,dX as mu,f8 as fu,pF as gu,jX as pu,le as oa,dI as mi,pG as xu,pH as Kt,pI as bu,bO as fi,pJ as vu,ae as gi,ii as Su,pK as pi,pL as Da,pM as En,pN as yu,gH as Yt,fL as wu,gI as Ls,n5 as Os,pO as Rn,pP as Cu,pQ as ju,pR as Mu,pS as ku,ke as Fa,pT as Ms,gL as Ge,pU as _u,cx as xi,cy as bi,ei as Tu,pV as Au,gq as Eu,lo as Ru,cX as vi,mx as Nu,pW as Pu,pX as Iu,pY as Du,pZ as Fu,dQ as Lu,gG as Ou,p_ as Bu,p$ as zu,q0 as Uu,q1 as Hu,q2 as Wu,q3 as Gu,q4 as Vu,q5 as qu,q6 as $u,cn as Si,jV as Ku,l4 as Yu,l3 as Xu,q7 as Qu,f3 as Zu,q8 as Ju,q9 as yi,h6 as ed,ff as wi,qa as td,fq as sd,k8 as nd,fr as xn,qb as ad,qc as od,fs as id,fg as rd,qd as ld,lm as cd,ln as ud,fC as dd,dj as hd,b9 as md,fA as fd,fB as gd,fD as pd,qe as xd,fk as La,co as bd,cp as vd,jb as Sd,qf as yd,id as wd}from"./ey0wg4za1oyqifqv.js";import{e as us,P as ds,d as Cd,D as jd,T as Nn,g as Md,E as kd,h as _d}from"./cpolvx40ep4lcjwi.js";import{p as Td,k as Pn,c as Oa,h as Ad,u as Ed,r as Ba,g as Rd,i as Nd,n as Pd}from"./jhw40ptxxcdznoc8.js";import{g as Id,c as Dd,C as In,d as Fd}from"./daahzegdvawizu7d.js";import{c1 as Ld,aa as Od,c2 as Bd,bR as zd,ad as Ud,c3 as Hd,d as Ci,bL as Wd,p as Gd,ap as ji,br as Vd,an as Mi,c4 as hs,ae as qd,H as $d,c5 as Kd,aI as tn,bb as Yd,c as Xd,a4 as Qd,c6 as ki,aU as Zd,c7 as Jd,aT as eh,bM as th,E as sh,bo as _i,bp as Ti,b as nh,aj as ah,ai as oh,b4 as ih,P as rh,bt as lh,X as ch,bG as uh}from"./jza0wh4acfmo8aml.js";import{m as te}from"./horqi5aemy4xy4nt.js";import{p as dh,w as Es,q as hh}from"./deec37q0oqrigjkr.js";import{D as G,$ as Ai}from"./lk3ytoqve6n2hksk.js";import{b as mh}from"./gp6erypuqffyucu9.js";import{S as Ei,a as fh,b as gh,G as ph,L as xh,c as bh}from"./mp0614vfts6nkoji.js";import{a as vh,H as Sh}from"./o8uyy9ytn5mdu56y.js";import{I as yh,B as wh}from"./ljvnn957d5onfwd2.js";import{a as Ch}from"./dan2jejzay5j96ch.js";const Ri=new us("transactionEventPlugin"),Dn="prosemirrorDispatchTransaction";function za(e,t){const{eventTarget:n}=Ri.getState(e.state);return n.addEventListener(Dn,t),()=>{n.removeEventListener(Dn,t)}}function jh(e){return new ds({key:Ri,state:{init(){return{eventTarget:e}},apply(t,n){return n}}})}const Rs=new us("customKeymapPlugin");function Mh(e,t){e.dispatch(e.state.tr.setMeta(Rs,{handlers:t}))}function kh(e={handlers:{}}){return new ds({key:Rs,state:{init(){return{...e}},apply(t,n){const a=t.getMeta(Rs);return a?{...n,...a}:n}},props:{handleKeyDown(t,n){const o=Rs.getState(t.state).handlers[n.key];return o?o(n):!1}}})}const it=new us("menuSelectorPlugin");function Ct(e){e.dispatch(e.state.tr.setMeta(it,{active:!1,onMenuAction:void 0}))}function _h(e,t){e.dispatch(e.state.tr.setMeta(it,{active:!0,onMenuAction:t}))}function Th(e={submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[]}){return new ds({key:it,state:{init(){return{...e,active:!1}},apply(t,n){const a=t.getMeta(it);return a?{...n,...a}:n}},props:{handleKeyDown(t,n){const a=it.getState(t.state);return a.active?a.submitKeys.includes(n.key)?(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),a.onMenuAction?.("submit"),Ct(t),!0):a.cancelKeys.includes(n.key)?(n.preventDefault(),a.onMenuAction?.("cancel"),Ct(t),!0):n.key==="ArrowUp"?(n.preventDefault(),a.onMenuAction?.("up"),!0):n.key==="ArrowDown"?(n.preventDefault(),a.onMenuAction?.("down"),!0):(a.checkStrictMatchKeys.includes(n.key)&&a.onMenuAction?.("checkMatch"),!1):!1},handleDOMEvents:{blur:t=>{it.getState(t.state).onMenuAction?.("cancel")}}}})}const Xt=new us("placeholderPlugin");function Ah(e){return new ds({key:Xt,state:{init(){return{placeholder:e}},apply(t,n){return t.getMeta(Xt)?{placeholder:t.getMeta(Xt).placeholder}:n}},props:{decorations(t){const{doc:n}=t;if(n.childCount===1&&n.firstChild?.isTextblock&&n.firstChild.content.size===0){const o=[],{placeholder:i}=Xt.getState(t);return t.doc.descendants((r,c)=>{const u=Cd.node(c,c+r.nodeSize,{class:"placeholder","data-placeholder":i});o.push(u)}),jd.create(n,o)}}}})}const sn="command_token",Eh={group:"inline",inline:!0,atom:!0,content:"text*",attrs:{id:"",hint:""},selectable:!1,draggable:!1,toDOM:e=>["span",{"data-mention-id":e.attrs.id,"data-mention-hint":e.attrs.hint,class:"hint-pill"},e.attrs.hint],parseDOM:[{tag:"span[data-mention-id][data-mention-hint]",getAttrs:e=>{const t=e.getAttribute("data-mention-id"),n=e.getAttribute("data-mention-hint");return{id:t,hint:n}}}]};function Ni(e,t){if(e.depth===0)return;const n=e.before(),o=e.doc.textBetween(n,e.pos,`
`,"\0").match(new RegExp(/(^|\s)\/(\w*)$/));if(o&&o.index!==void 0){const i=o[0].startsWith(" ")?o.index+1:o.index,r=o[0].startsWith(" ")?o[0].length-1:o[0].length,c=e.start()+i,u=c+r,m=c===t?.from;return{range:{from:c,to:u},queryText:o[2],isDismissed:m}}}const as=new us("slashCommandPlugin");function Rh(e){const n=e.state.selection.$from,a=Ni(n,void 0);if(!a)return;const o=e.state.tr;e.dispatch(o.setMeta(as,{...o.getMeta(as),dismissedRange:a.range}))}function Ua(){return{queryText:"",active:!1,range:void 0}}function Nh(e,t,n,a,o,i){let r;if(t.id===qs.Search&&o)r=e.state.tr.delete(n.from,n.to),i(!0);else{const c=e.state.schema.nodes[sn].create({...t},e.state.schema.text(t.hint));r=e.state.tr.replaceWith(n.from,n.to,c),a&&r.insertText(" ",n.from+c.nodeSize)}e.dispatch(r)}function Ha(e){const{active:t,range:n,queryText:a,onHintMatch:o,dismissedRange:i}=e;if(o)return!t||!n||i?.from===n.from?o(void 0):o({text:a,range:n})}function Ph(e){const t=[];return e.descendants(n=>{n.type.name===sn&&typeof n.attrs?.id=="string"&&t.push(n.attrs.id)}),t}function Ih(e){const t=e.state.tr;t.doc.descendants((n,a)=>{n.type.name===sn&&t.insertText(n.textContent,a,a+n.nodeSize)}),t.steps.length>0&&e.dispatch(t)}function Dh(){return new ds({key:as,state:{init(){return Ua()},apply(e,t){const n=e.getMeta(as),a=e.selection,o=a.$from,i=Ni(o,t.dismissedRange),r={...Ua(),...t,...n};return a.from!==a.to?(Ha(r),r):(r.active=!!i,i&&(r.queryText=i.queryText,r.range=i.range,i.isDismissed&&(i.queryText===""&&t.queryText!==""?r.dismissedRange=void 0:r.dismissedRange=i.range)),Ha(r),r)}}})}class nn extends Xr{constructor(t){super(),this.view=t}get document(){return this.view.dom.ownerDocument}isEmpty(){return this.view.state.doc.textContent.trim().length===0}trimLeadingText(t){const a=this.view.state.tr;let o=!1,i=!1;return a.doc.descendants((r,c)=>{o||!r.isText||(o=!0,r.text?.startsWith(t)&&(i=!0,a.insertText(r.text.replace(t,""),c,c+r.text.length)))}),i&&this.view.dispatch(a),i}replaceAll(t,n){const o=this.view.state.tr,i=[];o.doc.descendants((r,c)=>{!r.isText||r.text===void 0||i.push({node:r,pos:c})}),i.reverse(),i.forEach(({node:r,pos:c})=>{!r.isText||r.text===void 0||r.text.includes(t)&&o.insertText(r.text.replaceAll(t,n),c,c+r.text.length)}),this.view.dispatch(o)}appendText(t){this.view.dispatch(this.view.state.tr.insertText(t))}focus(){this.view.focus(),this.view.dispatch(this.view.state.tr.setSelection(Nn.atEnd(this.view.state.doc)))}setText(t){const{tr:n,schema:a}=this.view.state,o=t?a.nodes.paragraph.create(null,a.text(t)):a.nodes.paragraph.create();this.view.dispatch(n.replaceWith(0,this.view.state.doc.content.size,o)),this.view.hasFocus()&&this.view.dispatch(this.view.state.tr.setSelection(Nn.atEnd(this.view.state.doc)))}getCurrentText(){return this.view.state.doc.textContent}hasMultipleLines(){let t=0;return this.view.state.doc.descendants(n=>{n.isBlock&&t++}),t>1}getContentToSend(){return Td(this.view)}resize(){}isReady(){return!!this.view.state.doc}setPlaceholder(t){this.view.dispatch(this.view.state.tr.setMeta(Xt,{placeholder:t}))}getSelectionStart(){return this.view.state.selection.ranges[0].$from.pos}isMenuSelectorActive(){return it.getState(this.view.state).active}registerKeyHandlers(t){Mh(this.view,t)}acceptLegacyKeydown(){return!1}subscribe(t,n){if(t==="change"){const a=()=>n(void 0);return za(this.view,a)}return this.view.dom?.addEventListener(t,n),()=>{this.view.dom?.removeEventListener(t,n)}}useState(t){return l.useSyncExternalStore(n=>za(this.view,n),()=>t(this),()=>t(this))}getSystemHintsFromDoc(){return Ph(this.view.state.tr.doc)}getSystemHints(){const t=this.getSystemHintsFromDoc();return t.length?[t[0]]:[]}replaceSlashCommandTokensWithText(){Ih(this.view)}canShowAutocompletion(){return!this.isMenuSelectorActive()&&!this.getSystemHintsFromDoc().length}}const Wa=_e.div`m-8 flex flex-col items-center`;function Ga(e){return s.jsx(te.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...e})}function Fh({clientThreadId:e}){const n=Qr(e)?.gizmoId,{data:a}=$s(n);return n==null||a==null||!Zr(a)?null:s.jsx(Lh,{gizmoId:n})}function Lh({gizmoId:e}){const[t,n]=l.useState(!1),[a,o]=l.useState(!1),i=Jr(e),r=async u=>{n(!0),setTimeout(()=>{o(!0)},5e3),V.logEvent(H.submitInlineRating,{gizmo_id:e,rating:u}),await i.mutateAsync({rating:u})},c=async()=>{o(!0),V.logEvent(H.dismissInlineRating,{gizmo_id:e}),await i.mutateAsync({})};return l.useEffect(()=>{a||V.logEvent(H.showInlineRating,{gizmo_id:e})},[a,e]),a?null:t?s.jsx(Wa,{children:s.jsxs(Ga,{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"rounded-lg border border-token-border-heavy p-4",children:s.jsxs("div",{className:"flex justify-between gap-2",children:[s.jsx(R,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),s.jsx(ja,{onClick:()=>{o(!0)}})]})}),s.jsx("div",{className:"text-xs text-token-text-tertiary",children:s.jsx(R,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):s.jsx(Wa,{children:s.jsxs(Ga,{className:"flex flex-col items-center gap-4 rounded-lg border border-token-border-heavy p-4",children:[s.jsxs("div",{className:"flex justify-between gap-2",children:[s.jsx(R,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),s.jsx(ja,{onClick:c})]}),s.jsx(el,{rating:void 0,onRating:r})]})})}const Oh=({clientThreadId:e})=>{const t=Co(),n=Ks(e),a=rt(n);l.useEffect(()=>{a&&Ma.dismissBanner()},[a]);const o=t?.is_dismissible?()=>Ma.dismissBanner():void 0;return s.jsx(cs,{children:t&&s.jsx(te.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:s.jsx(tl,{clientThreadId:e,rateLimitInfo:t,onDismiss:o})})})};function Bh(e){const t=Ks(e),n=rt(t),a=Co();return!n&&a!=null}const Fn=window.sessionStorage,Ln=Cr(jr(()=>({memoryFullBannerDismissed:!!Fn?.getItem(wn.MemoryFullBannerDismissed)}))),Pi={dismissBanner(){Ln.setState(e=>{e.memoryFullBannerDismissed=!0}),Fn?.setItem(wn.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){Ln.setState(e=>{e.memoryFullBannerDismissed=!1}),Fn?.removeItem(wn.MemoryFullBannerDismissed)}};function zh(e){const t=$e(e),n=Po(),{data:a}=Io(t,!1,n),o=a!=null,i=o&&a.memoryFullPct>=100,[r,c]=l.useState(!1);l.useEffect(()=>{!i&&o&&(c(!0),Pi.clearDismissedBanner())},[i,o]);const u=Ln(m=>m.memoryFullBannerDismissed);return i&&r&&!u}function Uh(){const e=ae(),{openSettings:t}=sl();return s.jsx(te.div,{initial:{opacity:0},animate:{opacity:1},children:s.jsx(nl,{title:e.formatMessage(ks.memoryFullTitle),content:e.formatMessage(ks.memoryFullTooltip,ks.memoryFullTooltip.values),primaryCtaText:e.formatMessage(ks.memoryManageButton),onPrimaryCtaClick:()=>t(al.Personalization),onDismiss:()=>Pi.dismissBanner()})})}const ks=je({memoryFullTitle:{id:"yRGU2/",defaultMessage:"Memory is full."},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"neUc+N",defaultMessage:"New memories won’t be created until you make space. <a>Learn more</a>",values:{a:e=>s.jsx("a",{href:ol,target:"_blank",rel:"noopener noreferrer",className:"underline",children:e})}}}),Hh=l.memo(function(t){return Wh(t),Gh(t),Vh(),null});function Wh(e){const{store:t}=Ne(),n=t.useSetSharedProps();Cn(()=>{n(e)},[e,n])}function Gh(e){const{clientThreadId:t,canContinue:n}=e,{store:a}=Ne(),o=l.useRef({top:a.useContentAreaApi(Et.HeaderTop),bottom:a.useContentAreaApi(Et.HeaderBottom)}).current,i=Kh(e),r=il(t),{shouldShowBannerSignup:c,shouldShowBannerTermsDisclaimer:u}=Yh(t),m=Bh(t),d=rl(e),f=ll(e),g=zh(t),p=cl(),y=ul(e);Cn(()=>{y.eligible?o.top.set(ue.AdvancedVoiceOnMobileAnnouncement):p?o.top.set(ue.ParagenControls):u?o.top.set(ue.BannerTermsDisclaimer):m?o.top.set(ue.BannersRateLimit):d.eligible?o.top.set(ue.BannerSidekickAnnouncement):f.eligible?o.top.set(ue.SearchBrowserExtensionAnnouncement):i?o.top.set(ue.ItemActions):n?o.top.set(ue.PromptTextareaAction):c?o.top.set(ue.BannerSignup):g?o.top.set(ue.BannerMemoryFull):o.top.set(null)},[o,i,n,u,c,m,d,g,p,y]),Cn(()=>{r&&o.bottom.set(Do.DallePromptControls)},[o,r])}function Vh(){const{store:e}=Ne();l.useEffect(()=>()=>{e.reset()},[e])}function qh(e){const t=Fo(),n=lt(e),a=ee.getTree(e).getLastValidNode(n)?.message?.id;return t?.messageId===a?t.suggestions:[]}function $h(e){return qh(e).length>0}function Kh(e){const t=dl(e.clientThreadId),n=$h(e.clientThreadId);return e.isDisabled?!1:e.isNewThread||t||n}function Yh(e){const{isUnauthenticated:t}=Je(),n=lt(e),{layer:a}=_t("3637408529"),o=a.get("should_show_no_auth_signup_banner",!0),i=hl(g=>g.bannerDisclaimerClientThreadId),r=ml(),c={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1};if(!e)return c;const u=ee.getTree(e),m=u.countMessagesByAuthor(ve.User),d=u.getNodeByIdOrMessageId(n),f=d?.message?.author.role===ve.Assistant&&fl(d.message);return c.shouldShowBannerTermsDisclaimer=f&&t&&m===1&&!r&&(i==null||i===e),c.shouldShowBannerSignup=o&&f&&t&&m>0&&m%5===0,c}function Ii({children:e,className:t,showBackground:n}){return s.jsxs("div",{className:"relative",children:[e,n&&s.jsx(te.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:A("pointer-events-none absolute bottom-0 top-0 h-8 w-8 rounded-full",t)})]})}function Va({entry:e,onClick:t}){const{connectorConfig:n}=Vn();l.useEffect(()=>{if(!open||e.type!==Ie.GDRIVE)return;const c=n.get(Ie.GDRIVE)?.access_token;c&&gl(c)},[n,e.type]);const a=Lo(e.type),o=ae(),i=e.access_token?qa.uploadFromMessage:qa.signinWithMessage;return s.jsx(G.Item,{onClick:t,icon:a,children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx(R,{...i,values:{connectorName:qn(e.type,o)}}),e.type===Ie.O365_BUSINESS&&s.jsx("div",{className:"text-s text-token-text-tertiary",children:s.jsx(R,{...$n.includesSharePoint})})]})},e.id)}const qa=je({signinWithMessage:{id:"ContextConnectorPickerDropdownItem.signInWithMessage",defaultMessage:"Connect to {connectorName}"},uploadFromMessage:{id:"ContextConnectorPickerDropdownItem.uploadWithMessage",defaultMessage:"Add from {connectorName}"}});function Xh({clientThreadId:e,icon:t,setOpen:n,isDisabled:a=!1,highlightTooltip:o=!1}){const i=jo(),r=ae();return a=a||!!i,s.jsxs(s.Fragment,{children:[s.jsx(G.Trigger,{className:"m-0 h-0 w-0 border-none bg-transparent p-0"}),s.jsx(pl,{clientThreadId:e,rateLimitPopup:i,highlightTooltip:o,children:s.jsx(xl,{disabled:a,"aria-disabled":a,"aria-label":r.formatMessage({id:"tA7CXR",defaultMessage:"Attach files"}),onClick:c=>{c.preventDefault(),n(!0)},children:t})})]})}function Qh({connectorEntries:e,onOauthRedirect:t}){const n=ae();return s.jsxs(G.Sub,{children:[s.jsx(G.SubMenuTrigger,{icon:Ld,children:s.jsx("div",{className:"line-clamp-1 text-ellipsis",children:s.jsx(R,{...Zh.connectApps})})}),s.jsx(G.Portal,{children:s.jsx(G.SubContent,{children:e.map(a=>s.jsx(G.Item,{onClick:()=>t(a),icon:Lo(a.type),children:s.jsxs("div",{className:"flex flex-col",children:[qn(a.type,n),a.type===Ie.O365_BUSINESS&&s.jsx("div",{className:"text-s text-token-text-tertiary",children:s.jsx(R,{...$n.includesSharePoint})})]})},a.id))})})]})}const Zh=je({connectApps:{id:"ContextConnectorPicker.connectApps",defaultMessage:"Connect apps"}});function Jh({onOauthRedirect:e,connectors:t}){const n=ae();return s.jsxs(G.Sub,{children:[s.jsx(G.SubMenuTrigger,{icon:Od,children:s.jsx(R,{...em.oneDriveSubmenuName})}),s.jsx(G.Portal,{children:s.jsx(G.SubContent,{children:t.map(a=>a?s.jsx(G.Item,{onClick:()=>e(a),children:s.jsxs("div",{className:"flex flex-col",children:[qn(a.type,n),a.type===Ie.O365_BUSINESS&&s.jsx("div",{className:"text-s text-token-text-tertiary",children:s.jsx(R,{...$n.includesSharePoint})})]})},a.id):null)})})]})}const em=je({oneDriveSubmenuName:{id:"ContextConnectorPickerOneDriveSubmenu.oneDriveSubmenuName",defaultMessage:"Connect to Microsoft OneDrive"}}),tm={"image/jpeg":".jpg","image/png":".png"};function sm({entry:e}){return s.jsx(G.Item,{onClick:e.onClick,icon:e.icon,children:s.jsx(R,{...e.label})},e.key)}function nm(e){const t=ae(),n=Pt(),a=Ys();return l.useCallback(async i=>{const r=`${new Date().toISOString().replaceAll(":","-")}${tm[i.mimeType]}`;$t.uploadFile(a,new File([i.data],r,{type:i.mimeType}),e,t,n,void 0,void 0,Mn.Multimodal)},[a,t,n,e])}function am(e){const t=nm(e),n=om(t),a=im(t);return{desktopConnectors:l.useMemo(()=>Mo?[n,a].filter(i=>i!==void 0):[],[n,a])}}function om(e){const{value:t}=Tt("4204519260");return l.useMemo(()=>{if(t)return{key:"takeScreenshot",label:Di.takeScreenshot,icon:Bd,onClick:async()=>{const n=await Mr();n&&(V.logEvent(H.sidetronScreenshotAttached),await e(n))}}},[t,e])}function im(e){const{value:t}=Tt("239993468");return l.useMemo(()=>{if(t)return{key:"takePhoto",label:Di.takePhoto,icon:zd,onClick:async()=>{const n=await kr();n&&(V.logEvent(H.sidetronPhotoAttached),await e(n))}}},[t,e])}const Di=je({takeScreenshot:{id:"ContextConnectorPickerDropdownItem.takeScreenshotDesktop",defaultMessage:"Take screenshot"},takePhoto:{id:"ContextConnectorPickerDropdownItem.takePhotoDesktop",defaultMessage:"Take photo"}});function rm(){const{connectorConfig:e}=Vn(),t=Xs(),n=zo(),[a,o]=Jt(Bo([...e.values()],d=>!!d.access_token),d=>!!d.access_token),[i,r]=Jt(o,d=>d.type===Ie.O365_PERSONAL||d.type===Ie.O365_BUSINESS),c=!t&&!n&&a.length>0,u=!t&&!n&&!c&&i.length>1;return{unconnectedConnectors:n?[]:u?r:o,showUnconnectedInSubmenu:c,showOneDriveInSubmenu:u}}function lm({clientThreadId:e,icon:t,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,onOauthRedirect:i,uploadType:r,getInputProps:c,openFileDialog:u,isDisabled:m=!1,highlightTooltip:d=!1}){const{currentLocale:f}=_r(),g=ae(),p=Pt(),y=Ys(),h=Xs(),{connectorConfig:S,isLoading:x}=Vn(),j=Kn(Qs.ContextConnectors),{getGizmoId:b}=Oo(),[v,M]=l.useState();l.useEffect(()=>{b?b().then(P=>M(P)):M(void 0)},[b]);const D=l.useRef(null),[T,C]=l.useState(!1),w=l.useRef(!1),k=l.useCallback(()=>{const P=D.current?.files;Array.from(P??[]).forEach(ie=>$t.uploadFile(y,ie,a,g,p,o))},[y,a,g,p,o]),[Y,z]=l.useState(null),N=l.useCallback(()=>z(null),[z]),L=l.useCallback((P,ie)=>$t.uploadPickedFile(y,P,ie,a,n,o,v,g,p),[y,a,n,o,v,g,p]),{openMenu:B,confirmMenuOpened:E}=bl();l.useEffect(()=>{B&&(C(!0),E())},[B,E,C]);const F=l.useCallback(P=>{$t.doContextConnectorOauthRedirect(location.pathname+location.search+location.hash,P,i,ka.Picker),i()},[i]),K=l.useCallback(P=>{$t.uploadPickedFile(y,P,Ie.GDRIVE,a,n,o,v,g,p)},[y,a,n,o,v,g,p]),X=l.useCallback(async P=>{const{access_token:ie}=P;if(!ie){F(P);return}switch(vl(P,ka.Picker),P.type){case Ie.GDRIVE:Sl(f,P.type,ie,De=>De.forEach(K));break;case Ie.O365_PERSONAL:case Ie.O365_BUSINESS:z(P.type);break}},[K,F,z,f]),Q=()=>{V.logEvent(H.openFileViewer,{intent:r.toString()}),u()},U=P=>{if(!P&&w.current&&!x)Q();else if(P&&ye&&!x){Q();return}C(P),P&&(j.eligible&&j.markAsViewed(),V.logEvent(H.composerOpenContextConnectorPicker),w.current=!0,setTimeout(()=>{w.current=!1},250))},[Z,Se]=Jt(Bo([...S.values()],P=>!!P.access_token),P=>!!P.access_token);cm(Z,X);const[de]=Jt(Se,P=>P.type===Ie.O365_PERSONAL||P.type===Ie.O365_BUSINESS),{unconnectedConnectors:oe,showUnconnectedInSubmenu:ne,showOneDriveInSubmenu:Te}=rm(),{desktopConnectors:J}=am(a),ye=!Z.length&&!oe.length&&!J.length,xe=s.jsxs(s.Fragment,{children:[ne&&oe.length>0&&s.jsx(Qh,{connectorEntries:oe,onOauthRedirect:P=>F(P)}),!ne&&oe.map(P=>s.jsx(Va,{entry:P,onClick:()=>X(P)},P.id)),Te&&s.jsx(Jh,{connectors:de,onOauthRedirect:F}),x&&s.jsx(G.Item,{icon:s.jsx(ko,{className:"text-token-text-secondary"})}),(oe.length>0||x)&&s.jsx(G.Separator,{}),Z.map(P=>s.jsx(Va,{entry:P,onClick:()=>X(P)},P.id)),J.map(P=>s.jsx(sm,{entry:P},P.key)),s.jsx(G.Item,{onClick:Q,icon:Ud,children:s.jsx(R,{...h?$a.uploadFileMobile:$a.uploadFile})},"upload")]}),Me=s.jsxs("div",{className:"flex flex-col",children:[s.jsx(yl,{type:Y,onClose:N,uploadPickedFile:L}),s.jsx("input",{onChange:k,...c({className:"hidden"})}),s.jsxs(G.Root,{open:T,onOpenChange:U,children:[s.jsx(Xh,{clientThreadId:e,icon:t,setOpen:U,isDisabled:m,highlightTooltip:d}),s.jsx(G.Portal,{children:s.jsx(G.Content,{size:"large",children:xe})})]}),s.jsx(wl,{hasConnectors:!x&&!ye})]});return{dropdownItems:xe,mainComponent:Me}}function cm(e,t){const{connector:n,clearParam:a}=Cl(),o=e.find(i=>i.type===n&&!!i.access_token);l.useEffect(()=>{o&&(t(o),a())},[o,t,a])}function um(e){const{mainComponent:t}=lm(e);return t}const $a=je({attachFiles:{id:"ContextConnectorPicker.attachFiles",defaultMessage:"Attach files"},uploadFile:{id:"LocalFileDropdownItem.uploadFile",defaultMessage:"Upload from computer"},uploadFileMobile:{id:"LocalFileDropdownItem.uploadFileMobile",defaultMessage:"Upload file"}});function dm({clientThreadId:e,uploadType:t,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,getInputProps:i,openFileDialog:r,onOauthRedirect:c,historyDisabled:u,isDisabled:m,highlightTooltip:d}){const f=zo(),{gdriveStatus:g,o365Status:p}=jl(),y=s.jsx(Hd,{className:u?"text-white":d?"text-brand-blue-800":void 0}),h=g!=="false"||p!=="false"||f;return s.jsx("div",{className:A("relative",m&&"pointer-events-none opacity-30"),children:s.jsx(Ii,{showBackground:d,className:"bg-brand-blue-800/20",children:h?s.jsx(um,{clientThreadId:e,icon:y,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,onOauthRedirect:c,uploadType:t,openFileDialog:r,getInputProps:i,isDisabled:m,highlightTooltip:d}):s.jsx(Ml,{clientThreadId:e,uploadType:t,openFileDialog:r,getInputProps:i,icon:y,isDisabled:m,highlightTooltip:d})})})}function hm(){return Pn({"Shift-Enter":(e,t)=>Oa(e,t),Enter:(e,t)=>window.innerWidth>kl[_l.Medium]?!1:Oa(e,t)})}const mm=["p",0],fm=["br"],gm=new Md({nodes:{paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p",preserveWhitespace:"full"}],toDOM(){return mm}},text:{group:"inline"},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return fm}},[sn]:Eh,doc:{content:"block+"}},marks:{}});function pm(){const e=new EventTarget,t=new kd(null,{state:_d.create({schema:gm,plugins:[Ad(),Th({submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[" "]}),Ah(""),Dh(),hm(),Pn({"Mod-z":Ed,"Mod-y":Ba,"Mod-Shift-z":Ba}),kh(),Pn(mh),jh(e),Rd()]}),dispatchTransaction(n){const a=t.state.apply(n);t.updateState(a),n.docChanged&&e.dispatchEvent(new Event(Dn))},handlePaste(n,a){const o=a.clipboardData?.getData("text/plain");return o===void 0?!1:(Tl(o)||Nd(n,o),!0)},clipboardTextSerializer(n){return Pd(n.content).content}});return t}function xm(){try{return navigator.userAgent.toLocaleLowerCase().includes("firefox")}catch{return!1}}const bm=[A([Al["prosemirror-parent"],"text-token-text-primary","max-h-[25dvh]","max-h-52","overflow-auto",xm()?"firefox":"default-browser"])],vm=({children:e})=>{const[t]=l.useState(()=>new nn(pm()));return e(t)},Ka=({composerController:e,placeholder:t})=>{const n=l.useContext(_o),a=l.useRef(null),o=l.useRef(null),i=l.useRef(!1);return l.useEffect(()=>{if(i.current)return;if(!(e instanceof nn))throw new Error(`Expected instance of ProseMirrorComposerController but got ${e.constructor.name}`);i.current=!0;const r=o.current;if(r!=null){const{value:c,selectionStart:u,selectionEnd:m}=r;e.view.dispatch(e.view.state.tr.insertText(c)),e.view.dispatch(e.view.state.tr.setSelection(Nn.create(e.view.state.doc,u+1,m+1))),r.style.display="none",r.value=""}a.current.appendChild(e.view.dom),e.view.dom.id=Uo,El(e.view.dom),e.view.focus()},[e]),l.useEffect(()=>{e.setPlaceholder(t)},[t,e]),l.useEffect(()=>{e.logPageMount()},[]),s.jsxs("div",{ref:a,className:A(bm),children:[s.jsx("textarea",{className:"block h-10 w-full resize-none border-0 bg-transparent px-0 py-2 text-token-text-primary placeholder:text-token-text-secondary",autoFocus:!0,placeholder:t,ref:o}),s.jsx("script",{nonce:n.cspScriptNonce,suppressHydrationWarning:!0,children:"window.__oai_logHTML?window.__oai_logHTML():window.__oai_SSR_HTML=window.__oai_SSR_HTML||Date.now();requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI||Date.now()}))"})]})},Sm=Us(()=>Hs(()=>import("./sso-k1m7wpjxj23so5oa.js").then(e=>e.b),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).then(e=>({default:e.ComposerRightActions}))),ym=l.forwardRef(function({type:t,placeholder:n,replyRegions:a,state:o,renderFiles:i,leftSideActions:r,onSubmit:c,inputState:u,currentLeafId:m,composerController:d,clientThreadId:f,gizmoId:g,disableReason:p,modelId:y},h){const S=ct(),x=Rl(),{value:j}=ze("1567586774"),{value:b}=ze("1028682714");l.useEffect(()=>{d.focus()},[x?.modelId,d]);const v=M=>{km({target:M.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||d.focus()};return s.jsxs("div",{id:"composer-background",ref:h,className:A("flex w-full flex-col transition-colors contain-inline-size",S&&"backdrop-blur-2xl no-transparency:backdrop-blur-none",S&&t!=="temporary"&&"bg-token-composer-surface",j?"cursor-text rounded-3xl px-2.5 py-1":"gap-1.5 rounded-[26px] px-2.5 py-1.5",!S&&t!=="temporary"&&"bg-[#f4f4f4] dark:bg-token-main-surface-secondary",t==="temporary"&&"dark bg-black"),onClick:v,children:[s.jsx(cs,{initial:!1,children:a.length>0&&s.jsx(te.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:s.jsx(wm,{replyRegions:a})})}),j?s.jsxs(s.Fragment,{children:[i,s.jsx("div",{className:"flex min-h-[44px] items-center px-2",children:s.jsx("div",{className:"max-w-full flex-1",children:d instanceof Ps?s.jsx(Ya,{composerController:d,currentLeafId:m,placeholder:n,inputState:u}):s.jsx(Ka,{composerController:d,placeholder:n})})}),s.jsxs("div",{className:"flex h-[44px] items-center justify-between",children:[s.jsx("div",{className:"flex gap-x-1",children:r}),b?s.jsx(Sm,{inputState:u,state:o,onSubmit:c,composerController:d,clientThreadId:f,gizmoId:g,disableReason:p,modelId:y}):s.jsx(Ea,{inputState:u,state:o,onSubmit:c,composerController:d,clientThreadId:f,gizmoId:g,disableReason:p})]})]}):s.jsx(s.Fragment,{children:s.jsxs("div",{className:"flex items-end gap-1.5 pl-4 md:gap-2",children:[!!r?.length&&s.jsx(te.div,{initial:{opacity:0},animate:{opacity:1},transition:{ease:"easeOut",duration:.06},className:"-ml-2.5 mb-1 flex",children:r},"leftSideActions"),s.jsxs(te.div,{layout:!0,transition:{duration:.1},className:A("flex min-w-0 flex-1 flex-col"),children:[i,d instanceof Ps?s.jsx(Ya,{composerController:d,currentLeafId:m,placeholder:n,inputState:u}):s.jsx(Ka,{composerController:d,placeholder:n})]}),s.jsx("div",{className:"mb-1 me-1",children:s.jsx(Ea,{inputState:u,state:o,onSubmit:c,composerController:d,clientThreadId:f,gizmoId:g,disableReason:p})})]})})]})});function Ya({composerController:e,currentLeafId:t,placeholder:n,inputState:a}){const o=l.useContext(_o);return s.jsxs(s.Fragment,{children:[s.jsx(Nl,{id:Uo,autoFocus:!0,tabIndex:0,"data-id":t,dir:"auto",ref:i=>{if(!(e instanceof Ps))throw new Error("Expected TextAreaComposerController");i!=null&&(e.textArea=i,e.logPageMount())},rows:1,placeholder:n,disabled:a!=="default",className:A("m-0 resize-none border-0 bg-transparent px-0 text-token-text-primary focus:ring-0 focus-visible:ring-0",a==="disabled"&&"text-center",["max-h-[25dvh]","max-h-52"])}),s.jsx("script",{nonce:o.cspScriptNonce,suppressHydrationWarning:!0,children:"requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI??Date.now()}))"})]})}function wm({replyRegions:e}){return s.jsx("div",{className:"flex cursor-auto flex-col divide-y divide-token-border-light overflow-hidden rounded-b-lg rounded-t-[20px] bg-token-main-surface-primary",children:e.map((t,n)=>{switch(t.type){case"text":return s.jsx(Cm,{value:t.value,onRemoveRegion:t.onRemoveRegion},n);case"object":return s.jsx(jm,{value:t.value,onRemoveRegion:t.onRemoveRegion},n);case"mention":case"system_hint":return s.jsx(Mm,{value:t.value,icon:t.icon,onRemoveRegion:t.onRemoveRegion},n)}})})}function Cm({value:e,onRemoveRegion:t}){return s.jsxs(ra,{className:"text-token-text-secondary",children:[s.jsx(la,{children:s.jsx(Ci,{className:"icon-lg-heavy"})}),s.jsx(ca,{children:`“${e}”`}),s.jsx(ia,{onClick:t})]})}function jm({value:e,onRemoveRegion:t}){return s.jsxs(ra,{className:"text-blue-selection",children:[s.jsx(la,{children:s.jsx(Ci,{className:"icon-lg-heavy"})}),s.jsx(ca,{className:"font-semibold",children:e}),s.jsx(ia,{onClick:t})]})}function Mm({value:e,icon:t,onRemoveRegion:n}){return s.jsxs(ra,{children:[s.jsx(la,{className:"mt-0",children:t}),s.jsx(ca,{className:"font-semibold text-token-text-primary",children:e}),s.jsx(ia,{onClick:n})]})}function ia({onClick:e}){return s.jsx("button",{onClick:e,type:"button",className:"flex-shrink-0 text-token-text-secondary",children:s.jsx(Wd,{className:"icon-lg"})})}const ra=_e.div`flex items-start py-2.5 gap-3 pl-3 pr-1.5 text-sm`,la=_e.span`flex-shrink-0 mt-0.5 w-7 h-6 flex justify-center items-center`,ca=_e.span`flex-1 line-clamp-3 py-0.5`;function km({target:e,rootId:t,additonalInteractiveIds:n}){let a=e;for(;a&&a!=null;){if(a.tagName==="BUTTON"||a.tagName==="INPUT"||a.tagName==="TEXTAREA"||a.isContentEditable||n.includes(a.id))return!0;if(a.id===t)return!1;a=a.parentElement}return!1}const _m=e=>{const{metadata:t}=e;return t?.type?Fl(t.type):!1},Tm=({textdocId:e,pastedTextdoc:t,isCanvasOpen:n=!1,isFocused:a=!1})=>{const{content:o,metadata:i}=t;return s.jsxs("div",{className:"group/file-tile relative",children:[s.jsx("button",{onClick:()=>Ho.removePastedContent(e),className:"absolute -left-1 -top-1 z-10 hidden rounded-full border-[3px] border-[#f4f4f4] bg-black p-[2px] text-white group-hover/file-tile:block dark:border-token-main-surface-secondary dark:bg-white dark:text-black",children:s.jsx(Gd,{className:"icon-xs"})}),s.jsx(dh,{isInlinePreview:!0,isCanvasOpen:n,isFocused:a,textdocId:e,name:i?.title??null,type:i?.type??null,size:"small",onClick:()=>Dl(e),children:s.jsx("div",{className:A("whitespace-pre px-4",_m(t)&&"font-mono"),children:o})})]})},Am=({textdocId:e,pastedTextdoc:t})=>{const n=Pl(e),a=Il();return s.jsx(Tm,{isFocused:n,isCanvasOpen:a,pastedTextdoc:t,textdocId:e})};function Em({composerController:e}){const{doesUserHaveAnyAccountsWithPlusFeatures:t}=Hn(),n=ae(),a=Wo();return s.jsxs("div",{className:A("flex justify-between",!a&&"bg-gradient-to-t from-token-main-surface-primary to-transparent px-4"),children:[s.jsx("div",{className:"flex gap-2",children:s.jsx(Nm,{onClickStyle:o=>{Qa(n.formatMessage(o.expandedName??o.name),e)}})}),t&&s.jsx("div",{className:"flex gap-2",children:s.jsx(Rm,{onClickAspectRatio:o=>Qa(n.formatMessage(o.expandedName),e)})})]})}function Rm({onClickAspectRatio:e}){const t=ae();return s.jsxs(G.Root,{onOpenChange:n=>{n&&(he.logEvent(H.dalleOpenAspectRatioDropdown),V.logEvent(H.dalleOpenAspectRatioDropdown))},children:[s.jsxs(On,{$as:G.Trigger,className:"pr-1.5",children:[s.jsx(R,{id:"dalleControls.aspectRatio",defaultMessage:"Aspect Ratio"}),s.jsx(ji,{className:"icon-md"})]}),s.jsx(G.Portal,{children:s.jsx(G.Content,{children:Ll.map(n=>s.jsx(G.Item,{onClick:()=>{e(n),he.logEvent(H.dalleClickAspectRatio,n.name.defaultMessage?.toString()),V.logEvent(H.dalleClickAspectRatio,{aspectRatio:n.name.defaultMessage})},icon:n.icon,children:t.formatMessage(n.name)},n.name.id))})})]})}function Nm({onClickStyle:e}){const[t,n]=l.useState(Xa()),a=Ol(),o=Yn(),i=Xn(),r=ae();let c=2;return i||(o?c=5:a&&(c=3)),s.jsxs(s.Fragment,{children:[t.slice(0,c).map(u=>s.jsx(is,{label:s.jsx(Pm,{style:u}),side:"top",sideOffset:4,customPaddingClassName:"p-1",children:s.jsxs(On,{$as:"button",type:"button",onClick:()=>{e(u),he.logEvent(H.dalleClickStyle,u.name.defaultMessage?.toString()),V.logEvent(H.dalleClickStyle,{style:u.name.defaultMessage})},children:[s.jsx(Vd,{className:"h-4 w-4 text-token-text-tertiary"}),r.formatMessage(u.name)]})},u.name.id)),s.jsx(On,{$as:"button",type:"button",onClick:()=>{n(Xa()),he.logEvent(H.dalleShuffleStyles),V.logEvent(H.dalleShuffleStyles)},children:s.jsx(Bl,{className:"icon-sm text-token-text-tertiary"})}),Go.map(u=>s.jsx("img",{src:u.image.src,alt:r.formatMessage(u.name),width:100,height:100,className:"invisible fixed -left-96 -top-96"},u.name.id))]})}function Pm({style:e}){const t=ae();return s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("img",{src:e.image.src,alt:t.formatMessage(e.name),width:100,height:100,className:"rounded-md"}),s.jsx("div",{className:"text-xs font-medium",children:t.formatMessage(e.name)})]})}function Xa(){return[...Go].sort(()=>Math.random()-.5)}function Im(e,t){const n=t.getCurrentText();return n.trim()===""?e:n.endsWith(",")?` ${e.toLocaleLowerCase()}`:n.endsWith(", ")?e.toLocaleLowerCase():`, ${e.toLocaleLowerCase()}`}function Qa(e,t){const n=Im(e,t);t.appendText(n),es()}const On=_e.div`h-7 bg-token-main-surface-primary border border-token-border-light text-xs hover:bg-token-main-surface-secondary hover:text-token-text-primary px-2.5 radix-state-open:bg-token-main-surface-secondary radix-state-open:text-token-text-primary rounded-full flex flex-nowrap gap-0.5 items-center text-token-text-secondary font-normal`,_s={initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:.1},exit:{opacity:0,scale:.5,transition:{duration:.2}}},Dm=({suggestions:e,onSelectingSuggestedReply:t})=>s.jsx("div",{className:"absolute bottom-full flex w-full max-w-[100vw] grow gap-2 overflow-auto px-1 pb-1 contain-inline-size sm:mb-0 sm:justify-start sm:px-2 sm:pb-0 md:static md:mb-2 md:max-w-none md:justify-center md:overflow-visible",children:e.slice(0,2).map((n,a)=>s.jsx(te.div,{initial:_s.initial,animate:_s.animate,transition:{delay:(a-1)*_s.transition.delay},exit:_s.exit,children:s.jsx(Ve,{as:"button",color:"secondary",size:"small",onClick:()=>{t(n,e,a)},className:"group whitespace-nowrap md:whitespace-normal",children:s.jsx(Lm,{suggestion:n})},a)},a))});function Fm({suggestions:e,onSelectingSuggestedReply:t,clientThreadId:n}){const a=e?.length>0;l.useEffect(()=>{a&&Rt(e,n)},[a,n]);const{isUnauthenticated:o}=Je();return a?e.every(Vo)?s.jsxs(te.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col items-center",children:[o&&s.jsx(rs,{className:"mb-6 h-12 w-12 sm:hidden"}),s.jsx(Ei,{starterPrompts:e,onSelectStarterPrompt:t})]}):e.every(qo)?s.jsx(Dm,{suggestions:e,onSelectingSuggestedReply:t}):null:null}function Lm({suggestion:e}){return qo(e)?s.jsx(s.Fragment,{children:e.text}):Vo(e)?s.jsxs("div",{className:"flex flex-col overflow-hidden",children:[e.title&&s.jsx("div",{className:"truncate font-semibold",children:e.title}),s.jsx("div",{className:A("truncate font-normal",e.title?"opacity-50":""),children:e.body})]}):null}function Om(){const{store:e}=Ne(),t=e.useSharedProps();return t?s.jsx(Bm,{...t}):null}function Bm({clientThreadId:e,suggestions:t}){const n=Zs();return t===void 0||t.length===0?null:s.jsx("div",{children:s.jsx(zm,{children:s.jsx("div",{className:"grow",children:t!==void 0&&s.jsx(Fm,{suggestions:t,onSelectingSuggestedReply:n,clientThreadId:e})})})})}const zm=_e.div`h-full flex ml-1 md:w-full md:m-auto gap-0 md:gap-2 justify-center`,Fi=({className:e,children:t})=>s.jsx(te.div,{className:e,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:t});function Um({currentLeafId:e,canContinue:t,onContinueGenerating:n}){const a=l.useCallback(()=>{const i=new ts;n(e,i),es()},[n,e]);let o=null;return t&&(o=s.jsx(Hm,{onHandleContinueGenerating:a})),o&&s.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:o})}const Hm=({onHandleContinueGenerating:e})=>{const t=$o();return s.jsx(Fi,{children:s.jsxs(Ve,{as:"button",color:"secondary",onClick:e,className:"whitespace-nowrap border-0 md:border",children:[s.jsx(Mi,{className:A("-rotate-180",t?"icon-xs":"icon-sm")}),t&&s.jsx(R,{...He.continueGenerating})]})})},Wm=()=>{const{shouldShowSkipButton:e}=Ko();return e?s.jsx(Fi,{className:"flex justify-center",children:s.jsx(Ve,{as:"button",color:"secondary",onClick:()=>zl.skipParagen(),children:s.jsx(R,{...Gm.skip})})}):null},Gm=je({skip:{id:"dvcUbp",defaultMessage:"Skip"}}),Li=l.memo(function({className:t}){const{store:n}=Ne(),a=n.useIsHeaderContentAreaPopulated();return s.jsx("div",{className:A(t??"absolute bottom-full left-0 right-0",Is.PromptTextareaHeader),children:s.jsx(Ul,{shouldRender:a,contentArea:Et.Header,children:s.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[s.jsx(Oi,{}),s.jsx(Bi,{})]})})})});function Oi(){const{store:e}=Ne(),t=e.useSharedProps(o=>o?.clientThreadId),n=e.useContentAreaId(Et.HeaderTop);let a;switch(n){case ue.AdvancedVoiceOnMobileAnnouncement:a=s.jsx(Gl,{clientThreadId:t});break;case ue.ParagenControls:a=s.jsx(Wm,{});break;case ue.ItemActions:a=s.jsx(Om,{});break;case ue.BannerSignup:a=s.jsx(qm,{});break;case ue.BannerTermsDisclaimer:a=s.jsx($m,{});break;case ue.PromptTextareaAction:a=s.jsx(Km,{});break;case ue.BannersRateLimit:a=s.jsx(Ym,{});break;case ue.BannerSidekickAnnouncement:a=s.jsx(Wl,{});break;case ue.SearchBrowserExtensionAnnouncement:a=s.jsx(Hl,{});break;case ue.BannerMemoryFull:a=s.jsx(Uh,{});break;case ue.Box:a=s.jsxs("div",{className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",s.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",s.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;default:a=null;break}return a}function Bi(){const{store:e}=Ne(),t=e.useContentAreaId(Et.HeaderBottom);let n;switch(t){case Do.DallePromptControls:n=s.jsx(Vm,{});break;default:n=null;break}return n}function Vm(){const{store:e}=Ne(),t=e.useSharedProps(n=>n?.composerController);return t?s.jsx(Em,{composerController:t}):null}function qm(){const{store:e}=Ne(),t=e.useSharedProps(o=>o?.clientThreadId),n=Vl(),a=ql();return t?n?s.jsx($l,{threadId:t,showSignUp:a}):s.jsx(Kl,{threadId:t,showLogin:a}):null}function $m(){const{store:e}=Ne(),t=e.useSharedProps(n=>n?.clientThreadId);return t?s.jsx(Yl,{threadId:t}):null}function Km(){const{store:e}=Ne(),t=e.useSharedProps();return t?s.jsx(Um,{...t}):null}function Ym(){const{store:e}=Ne(),t=e.useSharedProps(n=>n?.clientThreadId);return t?s.jsx(Oh,{clientThreadId:t}):null}function Xm(e){const{value:t}=ze("1567586774");return t?s.jsx(Qm,{...e}):s.jsx(Zm,{...e})}function Qm({composerController:e,isDisabled:t,highlightTooltip:n,clientThreadId:a}){const{setThreadSearchMode:o}=Js(),i=Qn(),r=Xl(),[c,u]=l.useState(!1),m=ae(),d={clientThreadId:a};return s.jsx(zi,{highlightTooltip:n,analyticsMetadata:d,isThreadUsingSearchMode:i,isDisabled:t,children:s.jsxs("button",{className:A("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold disabled:opacity-30",c&&"transition-all duration-150",i||n?"!rounded-2xl bg-blue-250 text-blue-1000 hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:hover:bg-[#1A416A]":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-pressed":i,"aria-label":m.formatMessage({id:"Sl1VH/",defaultMessage:"Search the web"}),disabled:t,onTransitionEnd:()=>u(!1),onClick:f=>{f.stopPropagation(),f.preventDefault(),u(!0),V.logEventWithStatsig(H.composerSearchButtonClicked,"composer_search_button_clicked",d),o(!i,d,Ws.CONVERSATION_COMPOSER_WEB_ICON),/^search\s?$/i.test(e.getCurrentText())&&e.setText(""),e.replaceSlashCommandTokensWithText(),e.focus()},children:[s.jsx(hs,{}),s.jsx(cs,{children:i&&s.jsx(te.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:r?0:.15},children:s.jsx("div",{className:"pl-1 pr-2",children:s.jsx(R,{id:"TbHx8d",defaultMessage:"Search"})})})})]})})}function Zm({composerController:e,highlightTooltip:t,clientThreadId:n,isDisabled:a}){const{setThreadSearchMode:o}=Js(),i={clientThreadId:n};return s.jsx(zi,{highlightTooltip:t,analyticsMetadata:i,isThreadUsingSearchMode:!1,isDisabled:a,children:s.jsx(Ii,{showBackground:t,className:"bg-brand-purple/20",children:s.jsx("button",{className:"flex h-8 w-8 items-center justify-center text-token-text-primary disabled:opacity-30",disabled:a,onClick:()=>{V.logEventWithStatsig(H.composerSearchButtonClicked,"composer_search_button_clicked",i),o(!0,i,Ws.CONVERSATION_COMPOSER_WEB_ICON),/^search\s?$/i.test(e.getCurrentText())&&e.setText(""),e.replaceSlashCommandTokensWithText(),e.focus()},children:s.jsx(hs,{className:A(t&&"text-brand-purple-800 dark:text-brand-purple-600")})})})})}function Jm(){const e=Kn(Qs.hasSeenComposerSearchButtonTooltip);return!e.isLoading&&e.eligible}function zi({children:e,highlightTooltip:t,analyticsMetadata:n,isThreadUsingSearchMode:a,isDisabled:o}){const i=Jm()&&!a,r=Kn(Qs.hasSeenComposerSearchButtonTooltip);return o?s.jsx("div",{children:e}):i?s.jsx(Yo,{side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:s.jsx(R,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:r.markAsViewed,sideOffset:0,className:"!max-w-sm",description:s.jsx(R,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:s.jsx(Ql,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:s.jsx(R,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:s.jsx("div",{children:e})}):s.jsx("div",{children:s.jsx(is,{sideOffset:0,label:s.jsx(R,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"right",open:t||(a?!1:void 0),onOpenChange:c=>{c&&V.logEventWithStatsig(H.composerSearchButtonHovered,"composer_search_button_hovered",n)},children:e})})}function ef({composerController:e,clientThreadId:t}){const n=It(t),{setThreadSearchMode:a}=Js(),i=Zl().size>0,r=Xo(t,To.Search),c=Jl(t),[u,m]=l.useState([]),[d,f]=l.useState(void 0),[g,p]=l.useState(0);l.useEffect(()=>{m(d?c.filter(C=>C.name.toLocaleLowerCase().startsWith(d.text.toLocaleLowerCase())||C.systemHint.toLocaleLowerCase().startsWith(d.text.toLocaleLowerCase())):[])},[d]);const y=e.useState(C=>C.getSystemHints().length>0);l.useEffect(()=>{const C=w=>{f(k=>!k||!w?w:k.text===w.text&&k.range.from===w.range.to&&k.range.to?k:w)};e.view.dispatch(e.view.state.tr.setMeta(as,{onHintMatch:C}))},[e]);const h=i||y||!c.length||!u.length||!d;l.useEffect(()=>{h&&p(0)},[h]);const S=u.length,x=l.useCallback(C=>{p(w=>(C(w)%S+S)%S)},[S]),j=u[g],b=({hintToSave:C=j,expectPerfectMatch:w,appendSpace:k=!0})=>{if(!d||!j||w&&C.name.toLowerCase()!==d.text.toLowerCase())return;V.logEvent(H.systemHintSelected,{system_hint:C.systemHint,conversation_id:n??_a});const Y=d.text+C.name.slice(d.text.length),z={clientThreadId:t};Nh(e.view,{id:C.systemHint,hint:Y},d.range,k,r,N=>a(N,z,Ws.CONVERSATION_COMPOSER_SLASH_SEARCH)),Ct(e.view)},v=l.useRef(b);v.current=b;const M=l.useRef(x);M.current=x;const D=l.useRef(d);D.current=d;const T=e.view;return l.useEffect(()=>(h||_h(T,C=>{C==="up"?M.current(w=>w-1):C==="down"?M.current(w=>w+1):C==="cancel"?(Ct(T),Rh(T)):C==="submit"?(v.current({expectPerfectMatch:!1}),Ct(T)):C==="checkMatch"&&v.current({expectPerfectMatch:!0,appendSpace:!1})}),()=>Ct(T)),[h,T]),l.useEffect(()=>{h||V.logEvent(H.systemHintListOpened,{conversation_id:n??_a})},[h]),h?null:s.jsx(ec,{className:"max-w-60",onMouseDown:C=>{C.preventDefault()},children:u.map((C,w)=>s.jsx("div",{onMouseOver:()=>p(w),onClick:()=>{b({hintToSave:C,expectPerfectMatch:!1}),e.focus()},children:s.jsx(tc,{autoFocus:!1,className:"group rounded-lg px-1 py-2 hover:bg-token-hint-text",spoofHovered:w===g,children:s.jsx(tf,{title:C.name,description:C.description,icon:s.jsx(sc,{svgString:C.logo,className:"icon-lg text-token-text-secondary group-hover:text-white"}),checked:!1})})},C.systemHint))})}function tf({title:e,description:t,icon:n,checked:a}){return s.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-1.5 pl-1.5 pr-3",children:[s.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:n}),s.jsxs("div",{className:"shrink grow basis-0",children:[s.jsx("p",{className:"text-sm font-normal leading-tight text-token-text-primary group-hover:text-white",children:e}),!!t&&s.jsx("p",{className:"text-[13px] font-normal leading-[18px] text-token-text-secondary group-hover:text-white",children:t})]}),a&&s.jsx(qd,{className:A("icon-md text-token-text-primary",{"group-hover:hidden":!a})})]})}function sf({composerController:e,clientThreadId:t}){return e instanceof nn?s.jsx(ef,{composerController:e,clientThreadId:t}):null}function nf({suggestions:e,composerController:t,onSelect:n,onChange:a}){const o=Zs(),i=l.useCallback((d,f,g)=>{n?.(d,f,g),o(d,f,g)},[n,o]),[r,c]=l.useState(-1),[u,m]=l.useState(!1);return l.useEffect(()=>{const d=f=>{if(f.key==="ArrowDown"){const g=r===e.length-1?0:r+1;c(g),a?.(g,!0,e[g])}else if(f.key==="ArrowUp"){f.preventDefault();const g=r<=0?e.length-1:r-1;c(g),a?.(g,!0,e[g])}else f.key==="Enter"&&!f.shiftKey&&e[r]&&i(e[r],e,r)};return t.subscribe("keydown",d)},[e,r,a,i,t]),l.useEffect(()=>t.subscribe("blur",()=>{c(-1),a?.(-1,!1)}),[t,a]),l.useEffect(()=>{if(!u){const d=()=>{m(!0),window.removeEventListener("mousemove",d)};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}}},[u]),l.useEffect(()=>{c(-1),a?.(-1,!1),m(!1)},[e,a]),s.jsx(te.ul,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hidden w-full flex-col p-2.5 group-focus-within:flex group-focus-within:max-lg:flex-col-reverse",children:e.map((d,f)=>s.jsxs(te.li,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:f*.03},exit:{opacity:0,translateY:4},className:"w-full",children:[f>0&&s.jsx("div",{className:A("h-[1px] opacity-60 max-lg:hidden",r===f||r===f-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")}),s.jsxs("button",{className:A("flex w-full cursor-pointer items-center justify-start whitespace-pre-wrap rounded-lg px-2.5 py-3 text-start",r===f?"bg-token-main-surface-secondary":"bg-token-main-surface-primary"),onClick:g=>{g.preventDefault(),i(d,e,f)},onMouseDown:g=>{g.preventDefault()},onMouseEnter:()=>{u&&(c(f),a?.(f,!1,d))},onMouseLeave:()=>{c(-1),a?.(-1,!1,d)},children:[d.icon?s.jsx("span",{className:"mr-4 h-6 w-6 text-token-text-secondary",children:d.icon}):null,s.jsx("span",{className:"whitespace-pre-wrap",children:d.autocompletionChunks&&d.autocompletionChunks.length>0?s.jsx(s.Fragment,{children:d.autocompletionChunks.map((g,p)=>s.jsx("span",{className:A(g.isMatched?"text-token-text-tertiary":"text-token-text-primary"),children:g.text},p))}):s.jsxs(s.Fragment,{children:[s.jsx("span",{className:A(d.type===Ds.Starter?"text-token-text-secondary":"text-token-text-tertiary"),children:d.title}),s.jsx("span",{className:"text-token-text-primary",children:d.body})]})})]}),f>0&&s.jsx("div",{className:A("h-[1px] opacity-60 lg:hidden",r===f||r===f-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")})]},d.id??f))})}function af(e,t){e=e.toLocaleLowerCase();const n=t;t=t.toLocaleLowerCase();const a=[];let o=0;for(let c=0;c<t.length&&(o<e.length&&e[o]===t[c]&&(a.push(c),o++),o!==e.length);c++);const i=[];let r=0;if(a.forEach(c=>{if(c>r){const u=n.slice(r,c);u&&i.push({text:u,isMatched:!1})}i.push({text:n[c],isMatched:!0}),r=c+1}),r<t.length){const c=n.slice(r);c&&i.push({text:c,isMatched:!1})}return of(i)}function of(e){if(e.length===0)return e;let t=[e[0]];for(let a=1;a<e.length;a++){const o=t[t.length-1],i=e[a];o.isMatched===i.isMatched?o.text+=i.text:t.push(i)}const n=t.filter(a=>a.isMatched).reduce((a,o)=>a+o.text.trim().length,0);return t.length<=4&&n>=2?t:[{text:t.map(a=>a.text).join(""),isMatched:!1}]}const rf=1,lf=3e3;function cf({files:e,className:t}){const n=Xs(),a=Ys(),{value:o}=ze("1567586774"),i=Ic();return s.jsxs("div",{className:t,children:[i.map(r=>s.jsx(Am,{pastedTextdoc:r,textdocId:r.tempId},r.tempId)),e.map(r=>s.jsx(Dc,{borderRadius:o?"2xl":"xl",useV2Style:o,width:n?"normal":"wide",onRemoveFileClick:()=>kn.remove(a,r.tempId,"none"),file:r.file,fileId:r.fileId??void 0,contextConnectorInfo:r.contextConnectorInfo,loadingPercentage:r.status===Fc.Uploading?r.progress:void 0},r.tempId))]})}function uf({onAbortCompletion:e,onCreateNewCompletion:t,onContinueGenerating:n,currentModelId:a,clientThreadId:o,isNewThread:i,isCompletionInProgress:r,className:c,disabled:u=!1,disabledReason:m,canPause:d=!1,canContinue:f=!1,suggestions:g,isInteractableSharedThread:p,composerContainerRef:y,composerController:h,autocompletions:S,requiresFileUpload:x,onComposerInput:j,onComposerChange:b,onAutocompleteSelect:v,headerClassName:M,hideHeader:D,setComposerBarElement:T,onTaggingDropdownOpen:C,onTaggingDropdownClose:w}){const k=Zn(),Y=ls(),{isUnauthenticated:z}=Je(),N=ae(),L=Pt(),B=Ys(),E=lt(o),F=Ks(o),[K]=Tr(),X=Ao(),Q=Yn(),{gizmoEditorData:U,mode:Z,getGizmoId:Se}=Oo(),de=Gs(),oe=$o(),ne=Vs(),Te=Xn(),J=It(o),ye=!!Ar(),xe=!!Wn(),[Me,P]=l.useState({}),{setThreadSearchMode:ie,clearSearchModeTrigger:De,getSearchModeTrigger:we}=Js(),I=Qn(),[O,re]=l.useState(!1),[le,se]=l.useState(!1),q=ct(),ce=l.useRef(!1),Ae=Qo(),{value:be}=ze("1567586774"),Ce=a!==null?Ae[a]:void 0;let $=Zo(o),Pe=$&&"gizmo"in $?$.gizmo:void 0;const[me,ge]=l.useState(null);me!==null&&($={gizmo:me,gizmo_id:me.gizmo.id,kind:Ze.GizmoInteraction},Pe=me);const ke=Ra(Ce,$);let ms=!1;nc($)&&Pe?.gizmo.id===ac&&(ms=!0);const an=jo(),fs=!u&&!ms&&ke!==Mn.None&&!z,Ke=oc(Ce,$),Dt=ic(Ce,$);let Ee=Na(_=>_.files);const[Ft]=l.useState(()=>rc());Z==="magic"?Ee=Ee.filter(_=>_.gizmoId!=null):Ee=Ee.filter(_=>_.gizmoId==null);const gs=lc(),ut=Ee.length>0||gs,Lt=Na(cc.hasUploadInProgress),Ot=h.useState(_=>{const pe=uc(_);return typeof Ce?.maxTokens=="number"&&pe>Ce.maxTokens}),Bt=h.useState(_=>!_.isEmpty()),dt=!Ot&&!Lt&&(Bt||ut);Jo(Ee.length>0||Lt||Bt);const et=(ke===Mn.Multimodal?dc:hc)-Ee.length,zt=et<=0,Ye=dt&&!u&&!r&&!xe,[tt,on]=l.useState(!1),ht=ei(),mt=a||ht.id,ft=Xo(o,To.Search),gt=!u&&!Pe&&de?.includes(kt.SearchTool)&&(de?.includes(kt.BrowsingAvailable)||!Y?.isEnterprisey()),Ut=gt&&ft,rn=Ae[mt]?.tags,{targetedContent:ln,setTargetedContent:st}=ti(),Fe=ln?.isFocusedViewContent&&!Te?void 0:ln,{rebaseSystemMessageContent:ps}=Jn();l.useEffect(()=>{if(!k?.id)return;const _=Pa.getAndReset(k?.id,J);_&&h.setText(_.inputText)},[k?.id,J,h]),l.useEffect(()=>{tt!==Ye&&(on(Ye),Ye&&(Er(!0).then(_=>{Rr.startEnforcement(_),mc.startEnforcement(_),Nr.startEnforcement(_)}),de?.includes(kt.SharedWebsocket)&&Es.registerIfNotConnected()))},[Ye,tt,$?.kind,de]);const pt=fc(Ce,$),{handleFileAccepted:fa}=gc(N,Ra(Ce,$),Ke,"mouse",Se,pt?.attachments),{getInputProps:cn,open:un}=pc({disabled:u||!fs||zt,noClick:!0,onDropAccepted:fa,onDropRejected:_=>xc(_,N,L,ke),multiple:!0,maxSize:bc,maxFiles:et,...vc(Dt)}),xs=Pr(Ft),bs=l.useCallback(()=>{h.eraseContent(),xs.clearMessages(),h.resize(rf),si();for(const _ of Ee)kn.remove(B,_.tempId,"none");Ho.markAllAsSent()},[h,xs,Ee,B]),xt=async(_,pe)=>{if(_?.preventDefault(),u||!dt&&!pe||!$||Nt.isLoading(o)!==!1)return;const Oe=new ts;re(!0);const Re=h.getContentToSend(),nt=Lc(Re.content),fn=`${E}-nextPrompt`,Vt=new Oc(Bc.CompletionRequest,{expectedTimingLogs:[{name:"prompt_submitted",expectedInMs:3e3}]}),{content:yr,attachments:ya}=Id(B,nt,Ce,$),gn=[];ps&&gn.push(zc(ps));const pn={...$};"gizmo"in pn&&delete pn.gizmo;let js=h.getSystemHints();I&&(js=[qs.Search]);const wa=we(),wr=I?wa??Ws.CONVERSATION_COMPOSER_WEB_ICON:void 0,Ca=Uc();let qt={promptId:fn,content:yr,eventMetadata:{eventSource:_?"mouse":"keyboard"},completionMetadata:{suggestions:g,conversationMode:pn,systemHints:js,searchSource:wr},messageMetadata:{...ya.length>0&&{attachments:ya},...me&&{gizmo_id:me?.gizmo.id},...Me,...js.length>0&&{system_hints:js},...!!Re.metadata&&{serialization_metadata:Re.metadata},...Ca.length>0&&{canvas:{pasted_textdocs:Ca}}},appendMessages:gn.length>0?gn:void 0,turnTracker:Oe,profiler:Vt};qt=Hc(qt),Fe?.createNewCompletionParams&&(qt=await Fe.createNewCompletionParams(qt)),Vt.logTiming("request_params_ready"),await t(qt),Fe?.onCreateCompletion?.({serverThreadId:J,currentLeafId:E}),Fe?.shouldPersistAcrossMessages!==!0&&st(void 0),ss.hideThreadHeader(),bs(),re(!1),Vt.logTiming("prompt_submitted"),g!==void 0&&(he.logEvent("chatgpt_prompt_ignore_suggestions"),V.logEvent(H.promptIgnoreSuggestions)),I&&wa&&De()},dn=l.useRef(xt);l.useEffect(()=>{dn.current=xt});const hn=_=>{st(_.targetedReply),_.targetedReply&&(h.focus(),V.logEvent(H.targetedReplyButtonClicked,{conversationId:J,sourceMessageId:_.messageId}))},vs=l.useCallback(()=>{Fe?.onCleared?.({serverThreadId:J,currentLeafId:E}),st(void 0),h.focus()},[E,J,Fe,st,h]),Ss={Enter:{validator:_=>{const pe=_.isComposing||_.keyCode===229;return!(le&&ce.current)&&(_.metaKey||(oe||Mo)&&!_.shiftKey&&!pe)},handler:_=>{if(!Ye){Ot&&L.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}_.preventDefault(),xt()}},Escape:{validator:_=>!_.isComposing,handler:_=>{d&&r&&(e("",F),V.logEvent(H.pauseCompletion,{threadId:ee.getServerThreadId(o),currentLeafId:ee.getTree(o).getMessageId(E),eventSource:"keyboard"})),_.target.value===""&&vs()}}},W=l.useRef(Ss);W.current=Ss;const Le=l.useRef(null),We=Sc(rn,$?.kind),[Ht,bt]=l.useState(!1),[mn,ga]=l.useState(!1),ys=We&&Ht,pa=h.isReady();l.useEffect(()=>h.subscribe("keydown",_=>{h.acceptLegacyKeydown()&&W.current[_.key]?.validator(_)&&W.current[_.key].handler(_);const Oe=h.getCurrentText();if(_.key==="@"){const Re=h.getSelectionStart(),nt=Oe.substring(0,Re);(!nt||/\s$/.test(nt)||Re===0)&&(Le.current?.handleClose(),setTimeout(()=>bt(!0),10))}else Ht&&bt(!1);if(_.key==="Escape"&&(ge(null),se(!1)),Ut&&!I){let Re;_.key==="Backspace"?Re=Oe.substring(0,Oe.length-1):Re=Oe+_.key,/^search\s?$/i.test(Re)?ga(!0):mn&&ga(!1)}I&&_.key==="Escape"&&ie(!1,{clientThreadId:o})}),[h,pa,Ht,mn,Ut,I,ie,o]),l.useEffect(()=>{const _=Object.fromEntries(Object.keys(W.current).map(pe=>[pe,Re=>{const nt=W.current[pe];if(!nt||h.acceptLegacyKeydown())return!1;const{validator:fn,handler:Vt}=nt;return fn(Re)?(Vt(Re),!0):!1}]));h.registerKeyHandlers(_)},[h,pa]),l.useEffect(()=>h.subscribe("paste",_=>{yc({filePickerStore:B,event:_,intl:N,toaster:L,clientThreadId:o,conversationMode:$,currentModelConfig:Ce,getEditorGizmoId:Se,modelSupportedImageMimeTypes:Ke})}),[N,o,$,Ce,Se,Ke,h,L,B]);const nr=_=>{ye||ge(_),h.trimLeadingText("@"),es(),bt(!1)},ar=wc(o,Ft,N,Ke,pt?.attachments),or=l.useCallback(_=>{_?.preventDefault(),e("",F),V.logEvent(H.pauseCompletion,{threadId:ee.getServerThreadId(o),currentLeafId:ee.getTree(o).getMessageId(E),eventSource:"mouse"}),es()},[e,o,F,E]),xa=l.useCallback(()=>{Pa.set(k?.id,J,h.getCurrentText())},[J,k?.id,h]);l.useEffect(()=>{U||!O&&!Cc()&&h.focus()},[O,h]),l.useEffect(()=>{U||kn.reset(B)},[a,B,U]),l.useEffect(()=>{(!We&&me||ye)&&ge(null)},[We,me,ye]);const[ir,rr]=(()=>{switch(m){case"workspaceDisallowsGizmo":return[He.disallowedByWorkspacePlaceholder,!0];case"feedbackRequired":return[He.disabledFeedbackPlaceholder,!0];case"noModelsAvailable":return[He.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[He.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[He.loading,!0];case"noTestGizmoId":return[He.noTestGizmoId,!0];default:return p?[He.placeholderWithName,!1]:Fe?.placeholderTextOverride!=null?[Fe.placeholderTextOverride,!1]:[He.placeholderWithName,!1]}})(),lr=N.formatMessage(ir,{name:U!=null?Z==="magic"?jc:U.name||"GPT":Pe?.gizmo.display.name??"ChatGPT"});l.useEffect(()=>h.subscribe("input",()=>{Mc.getState().isThreadHeaderVisible&&ss.hideThreadHeader(),se(!0)}),[h]),l.useEffect(()=>{if(j)return h.subscribe("input",()=>{j?.()})},[h,j]),l.useEffect(()=>{if(b)return h.subscribe("change",()=>{b?.()})},[h,b]),l.useEffect(()=>h.subscribe("focus",()=>{se(!0)}),[h]);const cr={clientThreadId:o,uploadType:ke,modelAcceptedMimeTypes:Dt,modelSupportedImageMimeTypes:Ke,attachmentsProductFeature:pt?.attachments,getInputProps:cn,openFileDialog:un,historyDisabled:ne,onOauthRedirect:xa,highlightTooltip:x&&!ut},Wt=[],ba=!u&&!zt&&(fs||an!=null)&&!I;(be||ba)&&Wt.push(s.jsx(dm,{...cr,isDisabled:!ba},"file-upload-button")),gt&&(!I||be)&&Wt.push(s.jsx(Xm,{composerController:h,highlightTooltip:mn,clientThreadId:o,isDisabled:!Ut||ut},"search-button"));const ur=ut&&s.jsxs(s.Fragment,{children:[Z==="magic"&&s.jsx("div",{className:"m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",children:s.jsx(R,{...He.gizmoKnowledgeWarning})}),s.jsx(cf,{files:Ee,className:A("flex flex-nowrap gap-2 overflow-x-auto",be?"p-1.5":"pb-1.5 pt-[7px]")})]}),dr=rr?"disabled":"default",hr=r&&d,mr=!Ye||O,fr=Wc(Lt,Bt,Ot),ws=hr?"streaming":mr?"disabled":"idle",Gt=l.useRef(null),vt=l.useRef(null),{layer:gr}=Ue("387752763"),{layer:pr}=Ue("51287004"),xr=gr.get("enable_slash_commands",!1)&&(z||!Y?.isFree()||pr.get("enable",!1)),br=a&&[Gc,Vc].includes(a),vr=xr&&$?.kind===Ze.PrimaryAssistant&&!I;l.useEffect(()=>{const _=()=>{Gt.current!=null&&jn.addAction("composer_state_disabled",{threadId:ee.getServerThreadId(o),disabledReason:Gt.current})};if(dt&&ws==="disabled"){let pe="unknown";u?pe=m??"component_disabled_unknown":r?pe="completion_in_progress":xe?pe="thread_hard_blocked":O&&(pe="starting_new_completion_request"),Gt.current!==pe&&(vt.current&&clearTimeout(vt.current),vt.current=setTimeout(_,lf)),Gt.current=pe}else Gt.current=null;return()=>{vt.current&&(clearTimeout(vt.current),vt.current=null)}},[o,dt,ws,u,m,r,xe,O]);const Cs=[];if(I&&!be&&Cs.push({type:"system_hint",value:N.formatMessage(df.searchMode),icon:s.jsx("span",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-brand-purple/15",children:s.jsx(hs,{className:"h-[20px] w-[20px] shrink-0 text-[#814CFF]"})}),onRemoveRegion:()=>{ie(!1,{clientThreadId:o}),h.focus()}}),Fe?.label&&Cs.push({type:Fe.type,value:Fe.label,onRemoveRegion:vs}),me!==null){const _=!!me.gizmo.tags?.includes(ni.FirstParty);Cs.push({type:"mention",value:me.gizmo.display.name,icon:s.jsx(kc,{isFirstParty:_,src:me.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{ge(null),h.focus()}})}l.useEffect(()=>{(!S||S.length===0||!le)&&(ce.current=!1)},[S,le]);const Sr=(_,pe,Oe)=>{ce.current=_>=0,pe&&h.setText(Oe?`${Oe.title}${Oe.body}`:"")},va=le&&S&&S.length>0&&!ys&&!h.hasMultipleLines()&&h.canShowAutocompletion();l.useEffect(()=>{ys?C?.():w?.()},[ys,C,w]);const Sa=ws==="streaming"?or:xt;return s.jsxs(_c.Provider,{value:Ft,children:[s.jsx(Tc,{onOauthRedirect:xa,children:s.jsx("form",{className:c,onSubmit:Sa,children:s.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col",children:[!D&&!q&&s.jsx(Li,{className:M}),s.jsxs("div",{className:"relative h-0",children:[ys&&s.jsx("div",{className:A("absolute bottom-3 w-full space-y-2",Is.TagGpt),children:s.jsx(Ac,{onClick:_=>nr(_),onClose:()=>{bt(!1),h.focus()}})}),vr&&s.jsx("div",{className:A("absolute bottom-3 space-y-2",Is.TagGpt),children:s.jsx(sf,{composerController:h,clientThreadId:o})})]}),s.jsxs("div",{ref:y,className:"group relative flex w-full items-center",children:[i&&K.has("from_template_row")&&s.jsx("button",{type:"button",onClick:()=>{X("/")},className:"mr-2 flex h-8 w-8 items-center justify-center text-token-text-tertiary hover:text-token-text-secondary",children:s.jsx($d,{className:"icon-lg"})}),We&&!!J&&s.jsx(Ec,{ref:Le}),s.jsx(ym,{type:ne?"temporary":"default",ref:T,replyRegions:Cs,placeholder:lr,inputState:dr,composerController:h,leftSideActions:Wt,state:ws,onSubmit:Sa,renderFiles:ur,currentLeafId:E,clientThreadId:o,gizmoId:Pe?.gizmo.id,disableReason:fr,modelId:mt}),va&&s.jsx("div",{className:A("absolute left-0 z-10 box-border w-full bg-token-main-surface-primary max-lg:bottom-full lg:top-full",Wt?.length>0&&Q&&!be?`px-${Wt.length*8}`:"pl-0"),children:s.jsx(nf,{suggestions:S,composerController:h,onSelect:v,onChange:Sr})})]}),s.jsx(Rc,{composerController:h,parsedDocumentHandler:ar})]})})}),s.jsx(Hh,{canUseInlineTagging:We,isDisabled:u,clientThreadId:o,currentLeafId:E,currentRequestId:F,canContinue:f,composerController:h,setPromptInputMetadata:P,suggestions:g,isNewThread:i,onCreateNewCompletion:t,onContinueGenerating:n,onResetState:bs,conversationMode:$,isShowingAutocomplete:!!va}),$!=null&&!br&&Nc.includes($.kind)&&s.jsx(Pc,{onTargetedReply:hn})]})}const df=je({searchMode:{id:"LSO1pB",defaultMessage:"Search the web"}}),hf=({children:e})=>{const[t]=l.useState(()=>new Ps);return e(t)},Ui=({children:e})=>{const{layer:t}=Ue("387752763");return t.get("enable_rich_text_composer",!1)?s.jsx(vm,{children:e}):s.jsx(hf,{children:e})};function mf(e){const t=e.message?.author.role===ve.User,n=e.metadata?.err!=null&&e.metadata?.errCode!==Fs.ContentPolicy,a=e.metadata?.errCode===Fs.ModelIncompatibility;return e.metadata?.canRetry===!1||a?!1:t||n}function ff(e){return e.composerController?s.jsx(Za,{...e,composerController:e.composerController}):s.jsx(Ui,{children:t=>s.jsx(Za,{...e,composerController:t})})}function Za({clientThreadId:e,isNewThread:t,currentModelId:n,showPromptStarters:a,noWrap:o,onRequestCompletion:i,composerContainerRef:r,composerController:c}){const u=ea(),m=ta(),d=sa(g=>{const p=Nt.getCurrentNode(e,g);return mf(p)});if(ai(c),!m&&d)return s.jsx(gf,{clientThreadId:e});const f=s.jsx(s.Fragment,{children:s.jsx(Hi,{composerContainerRef:r,composerController:c,clientThreadId:e,currentModelId:n,isNewThread:t,showPromptStarters:a,onRequestCompletion:i})});return o?f:s.jsxs(s.Fragment,{children:[s.jsx(Fh,{clientThreadId:e}),s.jsx(na,{clientThreadId:e,isStaticSharedThread:u,withVerticalPadding:!1,withHorizontalPadding:!0,children:s.jsx(ns,{children:f})})]})}function gf({clientThreadId:e}){const t=qc(e),n=sa(i=>Nt.getCurrentNode(e,i).metadata?.errCode===$c),a=Kc(i=>i.isoDate),o=lt(e);return n&&a!=null&&a!==""?null:s.jsxs("div",{children:[s.jsx("div",{className:"mb-3 text-center text-xs",children:s.jsx(R,{...Ja.errorGeneratingResponse})}),s.jsx("div",{className:"flex items-center md:mb-4",children:s.jsx(Ve,{as:"button",color:"primary",onClick:()=>{const i=new ts;he.logEvent("chatgpt_regenerate_due_to_error_button_clicked",void 0,Qe({clientThreadId:e})),t({id:o,eventMetadata:{eventSource:"mouse"},conversationMode:Nt.getConversationMode(e),turnTracker:i})},className:"m-auto",icon:Mi,"data-testid":"regenerate-thread-error-button",children:s.jsx(R,{...Ja.regenerateResponse})})})]})}function Hi({clientThreadId:e,currentModelId:t,isNewThread:n,onRequestCompletion:a,showPromptStarters:o,composerContainerRef:i,composerController:r,autocompletions:c,requiresFileUpload:u,onComposerInput:m,onComposerChange:d,onAutocompleteSelect:f,headerClassName:g,hideHeader:p,onTaggingDropdownClose:y,onTaggingDropdownOpen:h}){const S=lt(e),x=Ks(e),j=_n(),{isUnauthenticated:b}=Je(),M=oi(e)===Eo.STREAMING,D=ii({clientThreadId:e,conversationLeafId:S}),T=rt(x),C=ri({clientThreadId:e}),w=!b,k=Ir(),{isOpen:Y,onClose:z}=Yc({type:"just-hit-rate-limit"}),N=l.useCallback((we,I)=>{V.logEvent(H.continueCompletion),a({type:Ta.Continue,promptId:we,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!1,completionMetadata:{conversationMode:Nt.getConversationMode(e)},turnTracker:I})},[a,e]),L=Ro(),B=l.useCallback(async(we,I)=>Dd({clientThreadId:e,currentRequestId:I,isHistoryAndTrainingDisabled:k,queryClient:L}),[e,k,L]),E=l.useCallback(async({promptId:we,content:I,eventMetadata:O,completionMetadata:re,messageMetadata:le,appendMessages:se,turnTracker:q,profiler:ce})=>{const Ae=ee.getThreadCurrentLeafId(e);ee.updateTree(e,be=>{be.addNode(we,I,Ae,ve.User,void 0,le)}),await a({type:Ta.Next,promptId:we,eventMetadata:O,cancelActiveRequests:!0,completionMetadata:re,appendMessages:se,turnTracker:q,profiler:ce})},[e,a]),F=Xc(e,S),K=Qc(e,S),X=!D&&(T||M),Q=l.useMemo(()=>X?!1:!F&&K,[F,K,X]),U=X&&t!=="gpt-4-pbrowse",Z=aa(e),Se=$e(e),de=$s(Se).data,{promptStarters:oe,isSuccess:ne}=Tn(n&&!Z,e,4),Te=Fo(),J=(()=>{if(Te?.messageId===ee.getTree(e).getLastValidNode(S)?.message?.id)return Te?.suggestions;if(o&&!Z&&ne&&!w)return oe})(),ye=Zc(),xe=Dr(),Me=(()=>{if(de?.gizmo.tags?.includes(ni.WorkspaceDisabled)&&!xe)return"workspaceDisallowsGizmo";if(ye.size){if(j.displayingSideBySideFeedback&&j.unskippable)return"feedbackRequired"}else return"noModelsAvailable";const I=Nt.getConversationMode(e);return I?.kind===Ze.GizmoTest&&I.gizmo_id==null?"noTestGizmoId":null})(),P=li(e),ie=en(e),De=Tt("15117983")?.value;return s.jsxs(s.Fragment,{children:[Y?s.jsx(Jc,{onClose:z}):null,De&&ie&&ie.kind===Ze.PrimaryAssistant&&ie.plugin_ids&&ie.plugin_ids.length>0?s.jsx(pf,{}):s.jsx(uf,{composerContainerRef:i,composerController:r,clientThreadId:e,onCreateNewCompletion:E,onAbortCompletion:B,onContinueGenerating:N,currentModelId:t,isNewThread:n,isCompletionInProgress:C,className:"w-full",canContinue:Q,suggestions:J??[],disabled:!!Me,disabledReason:Me??void 0,canPause:U,isInteractableSharedThread:P,autocompletions:c,requiresFileUpload:u,onComposerInput:m,onComposerChange:d,onAutocompleteSelect:f,headerClassName:g,hideHeader:p,onTaggingDropdownClose:y,onTaggingDropdownOpen:h},e)]})}function pf(){return s.jsxs("div",{className:"mx-auto flex max-w-md flex-col items-center justify-center gap-2 rounded-xl border border-token-border-light bg-token-main-surface-primary p-6 shadow-lg",children:[s.jsx("span",{className:"text-token-text-primary",children:s.jsx(R,{id:"PluginsDecrepatedNotice.pluginsDeprecationTitle",defaultMessage:"Conversations with plugins are archived"})}),s.jsx("span",{className:"text-token-text-secondary",children:s.jsx(R,{id:"PluginsDecrepatedNotice.pluginsDeprecationSubtitle",defaultMessage:"Explore GPT Store to find a replacement"})}),s.jsxs("a",{href:"https://chat.openai.com/gpts",className:"text-green-500 hover:cursor-pointer dark:text-green-400",children:[s.jsx(R,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLink",defaultMessage:"Explore GPTs"}),s.jsx("span",{className:"ml-2",children:s.jsx(R,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLinkArrow",defaultMessage:"→"})})]})]})}const Ja=je({errorGeneratingResponse:{id:"PromptTextarea.errorGeneratingResponse",defaultMessage:"There was an error generating a response"},regenerateResponse:{id:"PromptTextarea.regenerateResponse",defaultMessage:"Regenerate"}}),Wi=l.memo(function(){return s.jsxs("div",{className:`flex flex-col gap-2 ${Is.PromptTextareaHeader}`,children:[s.jsx(Oi,{}),s.jsx(Bi,{})]})}),Xg=Object.freeze(Object.defineProperty({__proto__:null,ChatScreenComposerAlerts:Wi},Symbol.toStringTag,{value:"Module"})),bn=4;function xf(e){const{layer:t}=Ue("3533083032"),{layer:n}=_t("3533083032"),{value:a,isLoading:o}=ze("3006519778");return o||!a?!1:e?t.get("enable_new_homepage_anon",!1):n.get("enable_new_homepage_anon",!1)}function bf(){const{layer:e}=_t("4031588851"),t=e.get("autocomplete_qualified_start_date","2099-09-13T00:00:00Z"),n=Zn();return!!n&&n.created*1e3>=new Date(t).getTime()}function vf(e){const{layer:t}=Ue("4031588851"),{layer:n}=_t("4031588851"),{value:a,isLoading:o}=ze("633009675");return o||!a?!1:e?t.get("enable_new_autocomplete_homepage",!1):n.get("enable_new_autocomplete_homepage",!1)}const vn=e=>`${e.title}${e.body}`.toLocaleLowerCase();function Sf(e){return $e(e.clientThreadId),s.jsx(Ui,{children:t=>s.jsx(Mf,{...e,composerController:t})})}function yf({children:e,composerController:t}){const{store:n}=Ne(),[a,o]=l.useState(!1);l.useEffect(()=>t.subscribe("focus",()=>{o(!0)}),[t]),l.useEffect(()=>t.subscribe("blur",()=>{o(!1)}),[t]);const r=!!n.useSharedProps()?.isShowingAutocomplete;return e(r&&a)}function wf({isUnauthenticated:e,shouldShowLegacyStarterPrompts:t,legacyPromptStarters:n,isSendBlocked:a,clientThreadId:o}){return s.jsxs("div",{className:A(e?"justify-end lg:justify-center":"justify-center","flex h-full flex-shrink flex-col items-center overflow-y-hidden text-token-text-primary lg:hidden"),children:[s.jsx("div",{className:A(e&&"flex sm:items-center md:flex-1","flex-shrink-0"),children:s.jsx(rs,{className:"mb-6 h-12 w-12"})}),t&&(n&&n.length>0?s.jsx(Af,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},promptStarters:n,isSendBlocked:a,clientThreadId:o,isSquare:e}):s.jsx(fh,{}))]})}function Cf({composerController:e,isSendBlocked:t,clientThreadId:n,isModelLoaded:a,headlineOption:o,enableNewMobileDesign:i,shouldShowStarterPrompts:r,promptChips:c,onSelectStarterPrompt:u,starterPromptExpanded:m,setStarterPromptExpanded:d}){return s.jsx(yf,{composerController:e,children:f=>s.jsxs(te.div,{initial:{opacity:0},animate:{opacity:f?0:1},exit:{opacity:0},transition:{duration:.1},className:A("justify-center",f?"pointer-events-none":"","flex h-full flex-shrink flex-col items-center overflow-hidden text-token-text-primary lg:hidden"),children:[o==="CHATGPT_LOGO"?s.jsx(rs,{className:"inline-block h-12 w-12"}):s.jsx(Gi,{headlineOption:o,isModelLoaded:a}),s.jsx(te.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:A(!i&&"lg:hidden",!m&&"h-[116px]"),children:r&&s.jsx(qi,{starterPrompts:c,onSelectStarterPrompt:u,disabled:t,clientThreadId:n,onExpand:()=>d(!0),mobileLayout:!0})})]})})}function jf(e,t,n){const a=ze("1468311859").value,o=ze("3664702598").value,{layer:i}=Ue("4031588851"),r=bf(),c=e||t,u=c&&a,m=c&&o&&r;let d="HARDCODED";if(c)if(n){const f=i.get("search_autocomplete_mode","");u&&f&&(d=f)}else m&&(d=i.get("autocomplete_mode","HARDCODED"));return d}function Mf({clientThreadId:e,currentModelId:t,isModelLoaded:n,onRequestCompletion:a,composerController:o,v2HomepageDisclaimer:i}){const r=As(e),c=aa(e),u=Wn(),[m,d]=l.useState([]),{trendingSuggestions:f,fetchTrendingSuggestions:g}=Ef(bn),p=l.useRef(!1),{isUnauthenticated:y}=Je(),h=Yn(),[S,x]=l.useState(!1),j=Qn(),b=ct();ai(o);const v=ze("589604007").value,{layer:M}=_t("4031588851"),{layer:D}=Ue("4031588851"),{layer:T}=_t("3533083032"),{layer:C}=Ue("3533083032"),{promptStarters:w,isSuccess:k}=Tn(r&&!c&&n,e,8,v,!0,t??void 0),{promptStarters:Y,isSuccess:z,isError:N}=Tn(r&&!c&&n,e,4,void 0,void 0,t??void 0),L=h&&!!m.find(I=>!!I.requires_file_upload),B=l.useCallback(I=>{const O=o.getCurrentText();return O&&vn(I).startsWith(O.toLocaleLowerCase())},[o]),E=l.useCallback(I=>{const O=o.getCurrentText(),re=I.title+I.body;return B(I)?{...I,title:O,body:re.slice(O.length)}:{...I,title:re,body:""}},[o,B]),F=l.useCallback((I=!1)=>{d(O=>!O.some(B)&&O.length>0?[]:I?O:O.map(E))},[B,E]),K=(I,O,re)=>{const le=I.title;d([]),o.focus(),o.setText(le),requestAnimationFrame(()=>{const se=(w?.filter(q=>q.theme===I.theme)??[]).map(q=>{const ce=yt(q.oneliner),Ae=ce.startsWith(q.title);return{...q,title:Ae?`${q.title} `:"",body:Ae?q.body:ce,autocompletionChunks:af(le,ce),type:Ds.Autocomplete}});d(se),se.length>0&&Rt(se,e),tu(I,re,e)})};l.useEffect(()=>{const I=m.some(O=>O.theme===An.Search);j&&o.getCurrentText()===""?f.length>0?d(f):g():I&&!j&&d(O=>O.filter(re=>re.theme!==An.Search))},[m,j,f,g,o]);const X=w?.reduce((I,O)=>(O.theme&&!I[O.theme]&&(I[O.theme]=O),I),{}),Q=[];if(X)for(const I in X)Q.push(X[I]);const U=Q&&Q.length>0,Z=!!(k&&U&&n),Se=!!((z||N)&&n),de=bn-m.filter(B).length,oe=y?C.get("enable_new_mobile",!1):D.get("enable_new_mobile",!1),ne=jf(oe,h,j),Te=y?T.get("headline_option","HELP_WITH"):M.get("headline_option","HELP_WITH"),J=M.get("autocomplete_min_char",4),ye=M.get("autocomplete_fetch_interval",200),xe=l.useRef(null),Me=l.useCallback(ci(async I=>{const O=o.getCurrentText();if(!O||O.length<J||O.length>80||o.hasMultipleLines()){d([]);return}if(!p.current&&!(xe.current&&xe.current.length>J&&O.startsWith(xe.current)))try{const re=await qe.generateAutocompletions(O,I,j);if(re.completions.length===0){xe.current=O;return}const le=re.completions.map(se=>({id:No(),type:Ds.Autocomplete,title:se.slice(0,O.length),body:se.slice(O.length),oneliner:se,prompt:se,source:ne})).filter(B).map(E);d(se=>{const q=se.filter(B),ce=le.filter(Ae=>{const be=vn(Ae);return!q.some(Ce=>{const $=vn(Ce);if(be===$)return!0;const Pe=/[\p{P}\p{S}]$/u,me=be.replace(Pe,""),ge=$.replace(Pe,"");return me===$||be===ge||me===ge})}).slice(0,bn-q.length);return[...q,...ce]}),le.length>0&&Rt(le,e)}catch{}},ne==="BING"?150:ye),[o,ne,E,ye]),P=l.useCallback(()=>{F(),de>0&&Me(de)},[Me,F,de]);l.useEffect(()=>{p.current&&d([])},[p]);const ie=l.useMemo(()=>ne==="HARDCODED"?F:P,[ne,P,F]),De=l.useCallback(()=>{o instanceof nn&&F(!0),o.getCurrentText().indexOf(`
`)>0&&d([])},[o,F]),we=l.useCallback((I,O,re)=>{O.forEach(le=>{le.id===I.id&&(le.userInput=o.getCurrentText())}),d([O[re]])},[o]);return s.jsx(s.Fragment,{children:s.jsx(cs,{children:s.jsx("div",{className:"h-full w-full lg:py-[18px]",children:s.jsx(na,{isStaticSharedThread:!1,withVerticalPadding:!1,withHorizontalPadding:!0,clientThreadId:e,fullHeight:!0,children:s.jsxs(Ia,{children:[s.jsx("div",{className:"mb-7 hidden text-center lg:block",children:Te==="CHATGPT_LOGO"?s.jsx(rs,{className:"inline-block h-12 w-12"}):s.jsx(Gi,{headlineOption:Te,isModelLoaded:n})}),!oe&&s.jsx(wf,{isUnauthenticated:y,shouldShowLegacyStarterPrompts:Se,legacyPromptStarters:Y,isSendBlocked:u,clientThreadId:e}),oe&&s.jsx(Cf,{composerController:o,isModelLoaded:n,headlineOption:Te,enableNewMobileDesign:oe,shouldShowStarterPrompts:Z,promptChips:Q,onSelectStarterPrompt:K,starterPromptExpanded:S,setStarterPromptExpanded:x,isSendBlocked:u,clientThreadId:e}),s.jsx("div",{className:A("lg:w-full","lg:absolute lg:bottom-8 lg:left-0"),children:s.jsx(Ia,{children:b?s.jsx(Wi,{}):s.jsx(Li,{className:"block"})})}),s.jsx("div",{className:"w-full",children:s.jsx(Hi,{clientThreadId:e,isNewThread:r,currentModelId:t,onRequestCompletion:a,showPromptStarters:!1,composerController:o,autocompletions:m,requiresFileUpload:L,onComposerInput:ie,onComposerChange:De,onAutocompleteSelect:we,onTaggingDropdownClose:()=>{p.current=!1},onTaggingDropdownOpen:()=>{p.current=!0},hideHeader:!0})}),s.jsx(te.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:A("hidden lg:block",i&&y&&S?"":"h-[70px]"),children:Z&&s.jsx(qi,{starterPrompts:Q,onSelectStarterPrompt:K,disabled:u,clientThreadId:e,onExpand:()=>x(!0)})}),i&&s.jsx("div",{className:"w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px] lg:absolute lg:bottom-0 lg:left-0",children:s.jsx("div",{className:"min-h-4",children:i})})]})})})})})}function Gi({headlineOption:e,isModelLoaded:t}){const n=ae(),[a,o]=l.useState(0),[i,r]=l.useState(!0),c=20,u=n.formatMessage(Rf[e]||Zt.whatCanIHelpWith);return l.useEffect(()=>{if(!t)return;let m;return a<u.length?m=setTimeout(()=>{o(a+1)},c):i&&(m=setTimeout(()=>{r(!1)},500)),()=>clearTimeout(m)},[u,a,i,t]),s.jsxs("div",{className:"relative inline-flex justify-center text-center text-2xl font-semibold leading-9",children:[s.jsx("h1",{children:u.substring(0,a)||"​"}),s.jsx("h1",{className:"result-streaming absolute left-full transition-opacity",style:{opacity:i?1:0},children:s.jsx("span",{})})]})}function Vi({label:e,onClick:t,disabled:n=!1,icon:a}){return s.jsxs("button",{className:"group relative flex h-[42px] items-center gap-1.5 rounded-full border border-token-border-light px-3 py-2 text-start text-[13px] shadow-xxs transition enabled:hover:bg-token-main-surface-secondary disabled:cursor-not-allowed xl:gap-2 xl:text-[14px]",disabled:n,onClick:t,children:[a,s.jsx("span",{className:"max-w-full select-none whitespace-nowrap text-gray-600 transition group-hover:text-token-text-primary dark:text-gray-500",children:e})]})}function kf({starterPrompt:e,starterPrompts:t,index:n,disabled:a,onSelectStarterPrompt:o}){const i=e.theme??e.title,r=Zs(),{mutate:c}=su(),u=e.category==="onboarding"?()=>{c({key:Qs.hasUsedConversationalOnboardingStarterPrompt}),r(e,t,n)}:()=>o(e,t,n);return s.jsx(Vi,{disabled:a,onClick:u,icon:s.jsx(nu,{starterPrompt:e,useV2Colors:!0}),label:i})}function eo({clientThreadId:e,onClick:t}){l.useEffect(()=>{au(e)},[e]);const n=ae();return s.jsx(te.div,{initial:{opacity:0,translateY:5},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:5},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:s.jsx(Vi,{onClick:()=>{ou(e),t()},label:n.formatMessage(Zt.moreStarterPrompts)})})}const _f=5,Tf=3;function qi({starterPrompts:e,onSelectStarterPrompt:t,disabled:n,clientThreadId:a,onExpand:o,mobileLayout:i=!1}){const r=i?Tf:_f,[c,u]=l.useState(r),[m,d]=l.useState(r),[f,g]=l.useState(!1),p=l.useRef(null),y=e.length<=c;l.useEffect(()=>{Rt(e.slice(0,r),a)},[a]),l.useEffect(()=>{if(!f&&!y&&p.current){const S=p.current,x=S.getBoundingClientRect(),j=x.width,b=Array.from(S.children);let v=0;for(let M=0;M<b.length&&b[M].getBoundingClientRect().right-x.left<=j;M++)v++;u(v),d(v),g(!0)}},[e,y,f]);const h=()=>{const S=e.slice(c,e.length).map(x=>({...x,isAdditional:!0}));S.length>0&&Rt(S,a),u(e.length),o()};return s.jsxs("div",{className:A("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",f&&e.length>0?"opacity-100":"opacity-[0.01]",i?"flex-wrap":"flex-nowrap"),children:[s.jsxs("ul",{className:A("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",y||i?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:p,children:[e.slice(0,c).map((S,x)=>s.jsx(te.li,{initial:{opacity:0,...x<m?{translateY:5}:{}},animate:{opacity:1,...x<m?{translateY:0}:{}},exit:{opacity:0,...x<m?{translateY:5}:{}},transition:{duration:.3,delay:x>=m?(x-m)*.06:0,ease:"easeOut"},children:s.jsx(kf,{starterPrompt:S,starterPrompts:e,index:x,disabled:n,onSelectStarterPrompt:t})},S.id??x)),i&&e.length>c&&s.jsx(eo,{clientThreadId:a,onClick:h})]}),!i&&e.length>c&&s.jsx(eo,{clientThreadId:a,onClick:h})]})}function Af({promptStarters:e,isSendBlocked:t,clientThreadId:n,isSquare:a,...o}){l.useEffect(()=>{Rt(e,n)},[n]);const i=Zs();return s.jsx(s.Fragment,{children:a?s.jsx(te.div,{...o,className:"mb-2 w-full flex-shrink overflow-y-hidden",children:s.jsx(ns,{children:s.jsx(Ei,{starterPrompts:e,onSelectStarterPrompt:i,disabled:t})})}):s.jsx(te.div,{...o,className:"flex-shrink overflow-y-hidden",children:s.jsx(gh,{starterPrompts:e,onSelectStarterPrompt:i,disabled:t,cssMobileDisplayLimit:2,marginOverride:"mt-6 lg:mt-12"})})})}const Ef=e=>{const[t,n]=l.useState([]),a=l.useCallback(async()=>{const i=(await qe.generateTrendingSuggestions(e)).suggestions.map((r,c)=>({type:Ds.Starter,title:to(r),body:"",icon:s.jsx(Kd,{}),prompt:to(r),id:`starter-${c}`,theme:An.Search}));n(i)},[e]);return{trendingSuggestions:t,fetchTrendingSuggestions:a}};function to(e){return e.split(" ").map(eu).join(" ")}const Zt=je({whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),Rf={HELP_WITH:Zt.whatCanIHelpWith,WHERE_TO_START:Zt.whereShouldWeStart,ASK_CHATGPT:Zt.askChatgptAnything};function $i({clientThreadId:e}){const t=$e(e),n=ea(),a=ct();return n||a?null:s.jsx(vh,{gizmoId:t,clientThreadId:e})}function Nf({clientThreadId:e,currentModelId:t,isModelLoaded:n,onRequestCompletion:a,enableV2Homepage:o,v2HomepageDisclaimer:i}){const r=Vs();let c=s.jsx(xh,{}),u;return r?(u=s.jsx(Pf,{}),c=s.jsx(rs,{className:"mb-6 h-12 w-12"})):e!=null?(u=o?s.jsx(Sf,{clientThreadId:e,currentModelId:t,isModelLoaded:n,onRequestCompletion:a,v2HomepageDisclaimer:i}):s.jsx(bh,{clientThreadId:e}),c=null):u=s.jsx(If,{}),s.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-token-text-primary",children:[c,u]})}function Pf({gizmo:e}){const t=lu(),n=e?cu(e.tools):!1,a=ls();return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mb-5 text-2xl font-semibold","data-testid":"temporary-chat-label",children:s.jsx(R,{...ot.temporaryChat})}),s.jsxs("div",{className:"max-w-sm text-center text-sm font-normal text-token-text-tertiary",children:[s.jsx(R,{...a?.isWorkspaceAccount()?t?ot.temporaryChatBizMemoryAvailable:ot.temporaryChatBizMemoryUnavailable:t?ot.temporaryChatDescriptionMemoryAvailable:ot.temporaryChatDescriptionMemoryUnavailable}),n&&s.jsx("div",{className:"mt-3",children:s.jsx(R,{...ot.temporaryChatDescriptionGptActions,values:{link:o=>s.jsx("a",{href:"https://help.openai.com/en/articles/8914046-temporary-chat-faq",target:"_blank",className:"underline",rel:"noreferrer",children:o})}})})]})]})}function If(){return s.jsx("div",{className:"mb-5 text-2xl font-semibold",children:s.jsx(R,{...ot.howCanIHelpYouToday})})}function Df({clientThreadId:e,currentModelId:t,isModelLoaded:n,onRequestCompletion:a,enableV2Homepage:o,v2HomepageDisclaimer:i}){const r=$e(e),c=iu(),u=Wn(),{data:m}=$s(r),d=ru(),f=Fr(()=>navigator.windowControlsOverlay);return(c!=null||r!=null)&&m==null?null:s.jsxs("div",{className:"relative h-full",children:[s.jsx("div",{className:f?.visible?A("absolute right-[calc(100dvw-env(titlebar-area-width,100dvw)-env(titlebar-area-x,0))]",d?"left-[env(titlebar-area-x,0)]":"left-0"):"absolute left-0 right-0",children:s.jsx($i,{clientThreadId:e})}),m!=null?s.jsx(ph,{gizmo:m,showStarterPrompts:!0,disableStarterPrompts:u}):s.jsx(Nf,{clientThreadId:e,currentModelId:t,isModelLoaded:n,onRequestCompletion:a,enableV2Homepage:o,v2HomepageDisclaimer:i})]})}const ot=je({temporaryChat:{id:"GizmoLanding.temporaryChat",defaultMessage:"Temporary Chat"},temporaryChatBizMemoryAvailable:{id:"g1opBW",defaultMessage:"This chat won't appear in your history and won't use or create memories."},temporaryChatBizMemoryUnavailable:{id:"fQmbtG",defaultMessage:"This chat won't appear your conversation history."},temporaryChatDescriptionMemoryAvailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryAvailable",defaultMessage:"This chat won't appear in history, use or create memories, or be used to train our models. For safety purposes, we may keep a copy for up to 30 days."},temporaryChatDescriptionMemoryUnavailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryUnavailable",defaultMessage:"This chat won't appear in history or be used to train our models. For safety purposes, we may keep a copy of this chat for up to 30 days."},temporaryChatDescriptionGptActions:{id:"GizmoLanding.temporaryChatDescriptionGptActions",defaultMessage:"Any data shared with a third party through GPT actions are subject to the third party's privacy policy. <link>Learn more</link>"},howCanIHelpYouToday:{id:"GizmoLanding.howCanIHelpYouToday",defaultMessage:"How can I help you today?"}}),jt=({modelSwitcherDeny:e,value:t,label:n,subtitle:a,icon:o,onMouseEnter:i,onMouseLeave:r,onSelect:c,messageModelSlug:u,isHovered:m=!1,shouldShowUpsell:d=!1,className:f,includeCheck:g,includeRegenerate:p,justifyIcon:y,wrapIcon:h=!0})=>{const S=ls(),x=!e,j=!x&&!d,b=Ao(),v=()=>{if(!d){c?.();return}V.logEvent(H.openModalAccountPaymentfromMessageModelPicker),V.logRateLimitGetPlusButtonClicked({type:Gn.RATE_LIMIT,location:"message_model_switcher_dropdown",plan_type:S?.planType??"unknown",is_hard_block:!1,hard_block_reason:"",is_new_conversation:!1}),du(b,"Message model switcher dropdown")};return s.jsx(G.Item,{onSelect:v,onMouseEnter:()=>x&&i?.(),onMouseLeave:()=>x&&r?.(),disabled:j,className:f??"radix-disabled:pointer-events-auto radix-disabled:cursor-not-allowed radix-disabled:hover:bg-transparent",children:s.jsxs(is,{label:e&&s.jsx(uu,{modelSwitcherDeny:e}),className:"flex w-full items-center justify-between gap-2",sideOffset:0,children:[s.jsxs("div",{className:A("flex items-center gap-3",y==="right"&&"w-full"),children:[!!o&&(h?s.jsx("span",{className:A("flex h-7 w-7 items-center justify-center rounded-full bg-token-main-surface-secondary",y==="right"&&"order-10 ml-auto"),children:o}):o),s.jsxs("div",{children:[s.jsx("div",{children:n}),s.jsx("div",{className:A({"text-sm text-token-text-secondary":!j},{"text-sm text-token-text-quaternary":j}),children:a})]})]}),d?s.jsx(Ve,{color:"secondary",size:"small",children:s.jsx(R,{id:"54fmrA",defaultMessage:"Get Plus"})}):s.jsx(Ff,{messageModelSlug:u,isHovered:m,modelSwitcherDeny:e,optionModelSlug:t,includeCheck:g,includeRegenerate:p})]})})},Ff=({modelSwitcherDeny:e,optionModelSlug:t,isHovered:n,messageModelSlug:a,includeRegenerate:o=!0,includeCheck:i=!0})=>{let r=null;if(e)switch(e.reason){case Gn.RATE_LIMIT:r=Qd;break;default:r=Xd;break}if(e)return s.jsx(r,{className:"icon-md"});const c=!!o&&s.jsx(tn,{className:A("icon-md hidden text-token-text-tertiary",{"group-hover:block":n})});return a===t&&i?s.jsxs(s.Fragment,{children:[s.jsx(Yd,{className:A("icon-md text-token-text-primary",{"group-hover:hidden":n})}),c]}):c};function Lf({className:e,clientThreadId:t,message:n,onModelSelect:a,onDropdownChange:o}){const i=ae(),[r,c]=l.useState(null),[u,m]=l.useState(!1),[d,f]=l.useState(!1),g=hu(),p=ui(t),y=$e(t),h=di({clientThreadId:t,message:n}),S=n.message.metadata?.model_slug,{modelOptions:x,modelSlug:j,animateModelLabelOnRender:b,nuxProps:v,messageModelEnabledTools:M}=h,D=hi(n.message),T=M.includes(qs.Search),C=l.useMemo(()=>x.find(E=>E.value==S),[x,S]),{doesUserHaveAnyAccountsWithPlusFeatures:w}=Hn(),k=l.useRef(null),Y=E=>{E||setTimeout(()=>{k.current&&k.current.blur()},10)};if(l.useEffect(()=>{Y(u)},[u]),!g||y)return null;const z=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:i.formatMessage(so.search),icon:s.jsx(hs,{className:"icon-sm"}),condition:T&&!D,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:i.formatMessage(so.nosearch),icon:s.jsx(ki,{className:"icon-sm"}),condition:T&&D,eventName:"chatgpt_regenerate_without_search_button_clicked"}];let N,L;v.shouldRenderNux?(N=Bf,L={title:s.jsx(R,{id:"g/+2Hh",defaultMessage:"Optimized your response"}),description:s.jsx(R,{id:"H0Flqm",defaultMessage:"Used {usedModelName} for a faster response that saves your limited {largestModelName} messages",values:{usedModelName:v.usedModelName,largestModelName:v.largestModelName}}),markAsViewed:v.announcement.markAsViewed}):(N=Of,L={label:p?s.jsx(R,{id:"LBYK9a",defaultMessage:"Change model"}):s.jsx(R,{id:"nygjPN",defaultMessage:"Used {modelName}",values:{modelName:v.usedModelName}})});const B=p&&x.some(E=>os(E,w));return s.jsxs(G.Root,{onOpenChange:E=>{p&&(m(E),o(E),Y(E)),E&&V.logEvent(H.conversationOpenMessageModelSelector,{has_get_plus_button:B})},children:[s.jsx(N,{...L,children:s.jsx(Ai,{ref:k,className:A("cursor-pointer",e),onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),children:s.jsx(Bn,{modelSlug:j,animateModelLabelOnRender:b,isDropdownOpen:u,isRegenerateEnabled:p,isHovered:d})})}),p&&s.jsxs(G.Content,{className:"z-30 origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[x.map(E=>{const F=os(E,w),{value:K,...X}=E;return s.jsx(jt,{value:K,onSelect:()=>{he.logEvent("chatgpt_regenerate_switch_model_button_clicked",K,{requestedModelId:K,...Qe({clientThreadId:t})}),a({requestedModelId:K})},onMouseEnter:()=>c(K),onMouseLeave:()=>c(null),isHovered:r===K,messageModelSlug:n.message.metadata?.model_slug,shouldShowUpsell:F,...X},K)}),!!C&&s.jsxs(s.Fragment,{children:[s.jsx(G.Separator,{}),z.filter(E=>E.condition).map(E=>s.jsx(jt,{onSelect:()=>{he.logEvent(E.eventName,C.value,{requestedModelId:C.value,...Qe({clientThreadId:t})}),a({requestedModelId:C.value,extraStreamParams:E.extraStreamParams})},includeRegenerate:!0,onMouseEnter:()=>c(E.key),onMouseLeave:()=>c(null),isHovered:r===E.key,messageModelSlug:S,includeCheck:!1,...C,label:E.label,subtitle:"",icon:E.icon},E.key))]})]})]})}function Bn({modelSlug:e,animateModelLabelOnRender:t,isDropdownOpen:n,isRegenerateEnabled:a,isHovered:o,isRegenLabel:i=!1,animateShortLabel:r,omitIcon:c}){const[u,m]=l.useState("initial"),{categories:d}=mu({isRegen:!!i});l.useEffect(()=>{if(t){const x=setTimeout(()=>m("show"),500),j=setTimeout(()=>m("initial"),2e3);return()=>{clearTimeout(x),clearTimeout(j)}}m("initial")},[t]);const f=d.find(({defaultModel:x})=>x===e),g=e===gu?{categoryId:"gpt_3.5",shorterLabel:"3.5"}:{},{categoryId:p,shorterLabel:y}=f??g,h={initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"100%"},visible:{opacity:1,paddingLeft:2,width:"100%",transition:{delay:0,duration:0}}},S=n?"visible":o?"show":u;return s.jsxs(te.div,{initial:"initial",animate:S,className:"flex items-center pb-0",children:[!c&&(i?s.jsx(tn,{className:"icon-md"}):p&&s.jsx(fu,{type:"outline",categoryId:p,className:"icon-md h-4 w-4"})),(a||r)&&s.jsx(te.span,{className:"overflow-hidden text-clip whitespace-nowrap text-sm",variants:h,transition:{type:"tween",duration:.18},children:y}),a&&s.jsx(ji,{className:A("icon-sm",{"text-token-text-quaternary":!o&&!i},{"text-token-text-secondary":o&&!i})})]})}function Of({children:e,label:t}){return s.jsx(is,{label:t,sideOffset:0,children:e})}function Bf({children:e,title:t,description:n,markAsViewed:a}){return s.jsx(Yo,{show:!0,side:"bottom",sideOffset:-4,title:t,description:n,badge:"beta",onDismiss:a,dismissOnOutsideClick:!0,children:e})}function os(e,t){const{modelSwitcherDeny:n,subscriptionLevel:a}=e;return!!n&&n.reason===Gn.RATE_LIMIT&&a===Lr.PLUS&&!t}const so=je({search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),zf=l.memo(Lf),St=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Ki=new Set,zn=typeof process=="object"&&process?process:{},Yi=(e,t,n,a)=>{typeof zn.emitWarning=="function"?zn.emitWarning(e,t,n,a):console.error(`[${n}] ${t}: ${e}`)};let Bs=globalThis.AbortController,no=globalThis.AbortSignal;if(typeof Bs>"u"){no=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(a,o){this._onabort.push(o)}},Bs=class{constructor(){t()}signal=new no;abort(a){if(!this.signal.aborted){this.signal.reason=a,this.signal.aborted=!0;for(const o of this.signal._onabort)o(a);this.signal.onabort?.(a)}}};let e=zn.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1";const t=()=>{e&&(e=!1,Yi("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",t))}}const Uf=e=>!Ki.has(e),Xe=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),Xi=e=>Xe(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?Ns:null:null;class Ns extends Array{constructor(t){super(t),this.fill(0)}}class Mt{heap;length;static#l=!1;static create(t){const n=Xi(t);if(!n)return[];Mt.#l=!0;const a=new Mt(t,n);return Mt.#l=!1,a}constructor(t,n){if(!Mt.#l)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new n(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}}class ua{#l;#d;#g;#p;#A;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#x;#n;#s;#e;#c;#h;#r;#o;#b;#i;#v;#S;#m;#y;#M;#u;static unsafeExposeInternals(t){return{starts:t.#S,ttls:t.#m,sizes:t.#v,keyMap:t.#n,keyList:t.#s,valList:t.#e,next:t.#c,prev:t.#h,get head(){return t.#r},get tail(){return t.#o},free:t.#b,isBackgroundFetch:n=>t.#t(n),backgroundFetch:(n,a,o,i)=>t.#N(n,a,o,i),moveToTail:n=>t.#T(n),indexes:n=>t.#w(n),rindexes:n=>t.#C(n),isStale:n=>t.#f(n)}}get max(){return this.#l}get maxSize(){return this.#d}get calculatedSize(){return this.#x}get size(){return this.#a}get fetchMethod(){return this.#A}get dispose(){return this.#g}get disposeAfter(){return this.#p}constructor(t){const{max:n=0,ttl:a,ttlResolution:o=1,ttlAutopurge:i,updateAgeOnGet:r,updateAgeOnHas:c,allowStale:u,dispose:m,disposeAfter:d,noDisposeOnSet:f,noUpdateTTL:g,maxSize:p=0,maxEntrySize:y=0,sizeCalculation:h,fetchMethod:S,noDeleteOnFetchRejection:x,noDeleteOnStaleGet:j,allowStaleOnFetchRejection:b,allowStaleOnFetchAbort:v,ignoreFetchAbort:M}=t;if(n!==0&&!Xe(n))throw new TypeError("max option must be a nonnegative integer");const D=n?Xi(n):Array;if(!D)throw new Error("invalid max value: "+n);if(this.#l=n,this.#d=p,this.maxEntrySize=y||this.#d,this.sizeCalculation=h,this.sizeCalculation){if(!this.#d&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(S!==void 0&&typeof S!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#A=S,this.#M=!!S,this.#n=new Map,this.#s=new Array(n).fill(void 0),this.#e=new Array(n).fill(void 0),this.#c=new D(n),this.#h=new D(n),this.#r=0,this.#o=0,this.#b=Mt.create(n),this.#a=0,this.#x=0,typeof m=="function"&&(this.#g=m),typeof d=="function"?(this.#p=d,this.#i=[]):(this.#p=void 0,this.#i=void 0),this.#y=!!this.#g,this.#u=!!this.#p,this.noDisposeOnSet=!!f,this.noUpdateTTL=!!g,this.noDeleteOnFetchRejection=!!x,this.allowStaleOnFetchRejection=!!b,this.allowStaleOnFetchAbort=!!v,this.ignoreFetchAbort=!!M,this.maxEntrySize!==0){if(this.#d!==0&&!Xe(this.#d))throw new TypeError("maxSize must be a positive integer if specified");if(!Xe(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#O()}if(this.allowStale=!!u,this.noDeleteOnStaleGet=!!j,this.updateAgeOnGet=!!r,this.updateAgeOnHas=!!c,this.ttlResolution=Xe(o)||o===0?o:1,this.ttlAutopurge=!!i,this.ttl=a||0,this.ttl){if(!Xe(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#P()}if(this.#l===0&&this.ttl===0&&this.#d===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#l&&!this.#d){const T="LRU_CACHE_UNBOUNDED";Uf(T)&&(Ki.add(T),Yi("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",T,ua))}}getRemainingTTL(t){return this.#n.has(t)?1/0:0}#P(){const t=new Ns(this.#l),n=new Ns(this.#l);this.#m=t,this.#S=n,this.#I=(i,r,c=St.now())=>{if(n[i]=r!==0?c:0,t[i]=r,r!==0&&this.ttlAutopurge){const u=setTimeout(()=>{this.#f(i)&&this.delete(this.#s[i])},r+1);u.unref&&u.unref()}},this.#k=i=>{n[i]=t[i]!==0?St.now():0},this.#j=(i,r)=>{if(t[r]){const c=t[r],u=n[r];if(!c||!u)return;i.ttl=c,i.start=u,i.now=a||o();const m=i.now-u;i.remainingTTL=c-m}};let a=0;const o=()=>{const i=St.now();if(this.ttlResolution>0){a=i;const r=setTimeout(()=>a=0,this.ttlResolution);r.unref&&r.unref()}return i};this.getRemainingTTL=i=>{const r=this.#n.get(i);if(r===void 0)return 0;const c=t[r],u=n[r];if(!c||!u)return 1/0;const m=(a||o())-u;return c-m},this.#f=i=>{const r=n[i],c=t[i];return!!c&&!!r&&(a||o())-r>c}}#k=()=>{};#j=()=>{};#I=()=>{};#f=()=>!1;#O(){const t=new Ns(this.#l);this.#x=0,this.#v=t,this.#_=n=>{this.#x-=t[n],t[n]=0},this.#D=(n,a,o,i)=>{if(this.#t(a))return 0;if(!Xe(o))if(i){if(typeof i!="function")throw new TypeError("sizeCalculation must be a function");if(o=i(a,n),!Xe(o))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return o},this.#E=(n,a,o)=>{if(t[n]=a,this.#d){const i=this.#d-t[n];for(;this.#x>i;)this.#R(!0)}this.#x+=t[n],o&&(o.entrySize=a,o.totalCalculatedSize=this.#x)}}#_=t=>{};#E=(t,n,a)=>{};#D=(t,n,a,o)=>{if(a||o)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#w({allowStale:t=this.allowStale}={}){if(this.#a)for(let n=this.#o;!(!this.#F(n)||((t||!this.#f(n))&&(yield n),n===this.#r));)n=this.#h[n]}*#C({allowStale:t=this.allowStale}={}){if(this.#a)for(let n=this.#r;!(!this.#F(n)||((t||!this.#f(n))&&(yield n),n===this.#o));)n=this.#c[n]}#F(t){return t!==void 0&&this.#n.get(this.#s[t])===t}*entries(){for(const t of this.#w())this.#e[t]!==void 0&&this.#s[t]!==void 0&&!this.#t(this.#e[t])&&(yield[this.#s[t],this.#e[t]])}*rentries(){for(const t of this.#C())this.#e[t]!==void 0&&this.#s[t]!==void 0&&!this.#t(this.#e[t])&&(yield[this.#s[t],this.#e[t]])}*keys(){for(const t of this.#w()){const n=this.#s[t];n!==void 0&&!this.#t(this.#e[t])&&(yield n)}}*rkeys(){for(const t of this.#C()){const n=this.#s[t];n!==void 0&&!this.#t(this.#e[t])&&(yield n)}}*values(){for(const t of this.#w())this.#e[t]!==void 0&&!this.#t(this.#e[t])&&(yield this.#e[t])}*rvalues(){for(const t of this.#C())this.#e[t]!==void 0&&!this.#t(this.#e[t])&&(yield this.#e[t])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(t,n={}){for(const a of this.#w()){const o=this.#e[a],i=this.#t(o)?o.__staleWhileFetching:o;if(i!==void 0&&t(i,this.#s[a],this))return this.get(this.#s[a],n)}}forEach(t,n=this){for(const a of this.#w()){const o=this.#e[a],i=this.#t(o)?o.__staleWhileFetching:o;i!==void 0&&t.call(n,i,this.#s[a],this)}}rforEach(t,n=this){for(const a of this.#C()){const o=this.#e[a],i=this.#t(o)?o.__staleWhileFetching:o;i!==void 0&&t.call(n,i,this.#s[a],this)}}purgeStale(){let t=!1;for(const n of this.#C({allowStale:!0}))this.#f(n)&&(this.delete(this.#s[n]),t=!0);return t}info(t){const n=this.#n.get(t);if(n===void 0)return;const a=this.#e[n],o=this.#t(a)?a.__staleWhileFetching:a;if(o===void 0)return;const i={value:o};if(this.#m&&this.#S){const r=this.#m[n],c=this.#S[n];if(r&&c){const u=r-(St.now()-c);i.ttl=u,i.start=Date.now()}}return this.#v&&(i.size=this.#v[n]),i}dump(){const t=[];for(const n of this.#w({allowStale:!0})){const a=this.#s[n],o=this.#e[n],i=this.#t(o)?o.__staleWhileFetching:o;if(i===void 0||a===void 0)continue;const r={value:i};if(this.#m&&this.#S){r.ttl=this.#m[n];const c=St.now()-this.#S[n];r.start=Math.floor(Date.now()-c)}this.#v&&(r.size=this.#v[n]),t.unshift([a,r])}return t}load(t){this.clear();for(const[n,a]of t){if(a.start){const o=Date.now()-a.start;a.start=St.now()-o}this.set(n,a.value,a)}}set(t,n,a={}){if(n===void 0)return this.delete(t),this;const{ttl:o=this.ttl,start:i,noDisposeOnSet:r=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:u}=a;let{noUpdateTTL:m=this.noUpdateTTL}=a;const d=this.#D(t,n,a.size||0,c);if(this.maxEntrySize&&d>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),this.delete(t),this;let f=this.#a===0?void 0:this.#n.get(t);if(f===void 0)f=this.#a===0?this.#o:this.#b.length!==0?this.#b.pop():this.#a===this.#l?this.#R(!1):this.#a,this.#s[f]=t,this.#e[f]=n,this.#n.set(t,f),this.#c[this.#o]=f,this.#h[f]=this.#o,this.#o=f,this.#a++,this.#E(f,d,u),u&&(u.set="add"),m=!1;else{this.#T(f);const g=this.#e[f];if(n!==g){if(this.#M&&this.#t(g)){g.__abortController.abort(new Error("replaced"));const{__staleWhileFetching:p}=g;p!==void 0&&!r&&(this.#y&&this.#g?.(p,t,"set"),this.#u&&this.#i?.push([p,t,"set"]))}else r||(this.#y&&this.#g?.(g,t,"set"),this.#u&&this.#i?.push([g,t,"set"]));if(this.#_(f),this.#E(f,d,u),this.#e[f]=n,u){u.set="replace";const p=g&&this.#t(g)?g.__staleWhileFetching:g;p!==void 0&&(u.oldValue=p)}}else u&&(u.set="update")}if(o!==0&&!this.#m&&this.#P(),this.#m&&(m||this.#I(f,o,i),u&&this.#j(u,f)),!r&&this.#u&&this.#i){const g=this.#i;let p;for(;p=g?.shift();)this.#p?.(...p)}return this}pop(){try{for(;this.#a;){const t=this.#e[this.#r];if(this.#R(!0),this.#t(t)){if(t.__staleWhileFetching)return t.__staleWhileFetching}else if(t!==void 0)return t}}finally{if(this.#u&&this.#i){const t=this.#i;let n;for(;n=t?.shift();)this.#p?.(...n)}}}#R(t){const n=this.#r,a=this.#s[n],o=this.#e[n];return this.#M&&this.#t(o)?o.__abortController.abort(new Error("evicted")):(this.#y||this.#u)&&(this.#y&&this.#g?.(o,a,"evict"),this.#u&&this.#i?.push([o,a,"evict"])),this.#_(n),t&&(this.#s[n]=void 0,this.#e[n]=void 0,this.#b.push(n)),this.#a===1?(this.#r=this.#o=0,this.#b.length=0):this.#r=this.#c[n],this.#n.delete(a),this.#a--,n}has(t,n={}){const{updateAgeOnHas:a=this.updateAgeOnHas,status:o}=n,i=this.#n.get(t);if(i!==void 0){const r=this.#e[i];if(this.#t(r)&&r.__staleWhileFetching===void 0)return!1;if(this.#f(i))o&&(o.has="stale",this.#j(o,i));else return a&&this.#k(i),o&&(o.has="hit",this.#j(o,i)),!0}else o&&(o.has="miss");return!1}peek(t,n={}){const{allowStale:a=this.allowStale}=n,o=this.#n.get(t);if(o===void 0||!a&&this.#f(o))return;const i=this.#e[o];return this.#t(i)?i.__staleWhileFetching:i}#N(t,n,a,o){const i=n===void 0?void 0:this.#e[n];if(this.#t(i))return i;const r=new Bs,{signal:c}=a;c?.addEventListener("abort",()=>r.abort(c.reason),{signal:r.signal});const u={signal:r.signal,options:a,context:o},m=(h,S=!1)=>{const{aborted:x}=r.signal,j=a.ignoreFetchAbort&&h!==void 0;if(a.status&&(x&&!S?(a.status.fetchAborted=!0,a.status.fetchError=r.signal.reason,j&&(a.status.fetchAbortIgnored=!0)):a.status.fetchResolved=!0),x&&!j&&!S)return f(r.signal.reason);const b=p;return this.#e[n]===p&&(h===void 0?b.__staleWhileFetching?this.#e[n]=b.__staleWhileFetching:this.delete(t):(a.status&&(a.status.fetchUpdated=!0),this.set(t,h,u.options))),h},d=h=>(a.status&&(a.status.fetchRejected=!0,a.status.fetchError=h),f(h)),f=h=>{const{aborted:S}=r.signal,x=S&&a.allowStaleOnFetchAbort,j=x||a.allowStaleOnFetchRejection,b=j||a.noDeleteOnFetchRejection,v=p;if(this.#e[n]===p&&(!b||v.__staleWhileFetching===void 0?this.delete(t):x||(this.#e[n]=v.__staleWhileFetching)),j)return a.status&&v.__staleWhileFetching!==void 0&&(a.status.returnedStale=!0),v.__staleWhileFetching;if(v.__returned===v)throw h},g=(h,S)=>{const x=this.#A?.(t,i,u);x&&x instanceof Promise&&x.then(j=>h(j===void 0?void 0:j),S),r.signal.addEventListener("abort",()=>{(!a.ignoreFetchAbort||a.allowStaleOnFetchAbort)&&(h(void 0),a.allowStaleOnFetchAbort&&(h=j=>m(j,!0)))})};a.status&&(a.status.fetchDispatched=!0);const p=new Promise(g).then(m,d),y=Object.assign(p,{__abortController:r,__staleWhileFetching:i,__returned:void 0});return n===void 0?(this.set(t,y,{...u.options,status:void 0}),n=this.#n.get(t)):this.#e[n]=y,y}#t(t){if(!this.#M)return!1;const n=t;return!!n&&n instanceof Promise&&n.hasOwnProperty("__staleWhileFetching")&&n.__abortController instanceof Bs}async fetch(t,n={}){const{allowStale:a=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:r=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:u=0,sizeCalculation:m=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,noDeleteOnFetchRejection:f=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:g=this.allowStaleOnFetchRejection,ignoreFetchAbort:p=this.ignoreFetchAbort,allowStaleOnFetchAbort:y=this.allowStaleOnFetchAbort,context:h,forceRefresh:S=!1,status:x,signal:j}=n;if(!this.#M)return x&&(x.fetch="get"),this.get(t,{allowStale:a,updateAgeOnGet:o,noDeleteOnStaleGet:i,status:x});const b={allowStale:a,updateAgeOnGet:o,noDeleteOnStaleGet:i,ttl:r,noDisposeOnSet:c,size:u,sizeCalculation:m,noUpdateTTL:d,noDeleteOnFetchRejection:f,allowStaleOnFetchRejection:g,allowStaleOnFetchAbort:y,ignoreFetchAbort:p,status:x,signal:j};let v=this.#n.get(t);if(v===void 0){x&&(x.fetch="miss");const M=this.#N(t,v,b,h);return M.__returned=M}else{const M=this.#e[v];if(this.#t(M)){const k=a&&M.__staleWhileFetching!==void 0;return x&&(x.fetch="inflight",k&&(x.returnedStale=!0)),k?M.__staleWhileFetching:M.__returned=M}const D=this.#f(v);if(!S&&!D)return x&&(x.fetch="hit"),this.#T(v),o&&this.#k(v),x&&this.#j(x,v),M;const T=this.#N(t,v,b,h),w=T.__staleWhileFetching!==void 0&&a;return x&&(x.fetch=D?"stale":"refresh",w&&D&&(x.returnedStale=!0)),w?T.__staleWhileFetching:T.__returned=T}}get(t,n={}){const{allowStale:a=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:r}=n,c=this.#n.get(t);if(c!==void 0){const u=this.#e[c],m=this.#t(u);return r&&this.#j(r,c),this.#f(c)?(r&&(r.get="stale"),m?(r&&a&&u.__staleWhileFetching!==void 0&&(r.returnedStale=!0),a?u.__staleWhileFetching:void 0):(i||this.delete(t),r&&a&&(r.returnedStale=!0),a?u:void 0)):(r&&(r.get="hit"),m?u.__staleWhileFetching:(this.#T(c),o&&this.#k(c),u))}else r&&(r.get="miss")}#L(t,n){this.#h[n]=t,this.#c[t]=n}#T(t){t!==this.#o&&(t===this.#r?this.#r=this.#c[t]:this.#L(this.#h[t],this.#c[t]),this.#L(this.#o,t),this.#o=t)}delete(t){let n=!1;if(this.#a!==0){const a=this.#n.get(t);if(a!==void 0)if(n=!0,this.#a===1)this.clear();else{this.#_(a);const o=this.#e[a];if(this.#t(o)?o.__abortController.abort(new Error("deleted")):(this.#y||this.#u)&&(this.#y&&this.#g?.(o,t,"delete"),this.#u&&this.#i?.push([o,t,"delete"])),this.#n.delete(t),this.#s[a]=void 0,this.#e[a]=void 0,a===this.#o)this.#o=this.#h[a];else if(a===this.#r)this.#r=this.#c[a];else{const i=this.#h[a];this.#c[i]=this.#c[a];const r=this.#c[a];this.#h[r]=this.#h[a]}this.#a--,this.#b.push(a)}}if(this.#u&&this.#i?.length){const a=this.#i;let o;for(;o=a?.shift();)this.#p?.(...o)}return n}clear(){for(const t of this.#C({allowStale:!0})){const n=this.#e[t];if(this.#t(n))n.__abortController.abort(new Error("deleted"));else{const a=this.#s[t];this.#y&&this.#g?.(n,a,"delete"),this.#u&&this.#i?.push([n,a,"delete"])}}if(this.#n.clear(),this.#e.fill(void 0),this.#s.fill(void 0),this.#m&&this.#S&&(this.#m.fill(0),this.#S.fill(0)),this.#v&&this.#v.fill(0),this.#r=0,this.#o=0,this.#b.length=0,this.#x=0,this.#a=0,this.#u&&this.#i){const t=this.#i;let n;for(;n=t?.shift();)this.#p?.(...n)}}}function Hf({conversationId:e,messageId:t}){const[n,a]=l.useState(!1),o=l.useRef({isMediaSourceAvailable:da(),mediaSourceFormat:ha()??"n/a",playPromise:null,shouldAbortQueuedPlayback:!1}).current,i=ae(),r=Pt(),{voiceName:c}=pu(),u=`${e}.${t}.${c}`,m=Or(),d=Br(h=>h.isPlaying&&h.sourceUrl===Be.get(u)?.src),f=l.useCallback(async()=>{if(!m)return;a(!0);const h={isMediaSourceAvailable:o.isMediaSourceAvailable,format:o.mediaSourceFormat};try{const S=await Wf({key:u,message_id:t,conversation_id:e,voice:c,onStreamingError:x=>{Qt.readAloud.error(x,h),a(!1),r.danger(i.formatMessage(ao.playbackError,{error:x.message}))},onStreamingStart:()=>{a(!1)}});if(o.shouldAbortQueuedPlayback){o.shouldAbortQueuedPlayback=!1;return}m.changeSource(S),o.playPromise=m.play()}catch(S){Qt.readAloud.error(S,h),a(!1),r.danger(i.formatMessage(ao.playbackError,{error:S.message}))}},[m,o,u,t,e,c,r,i]),g=l.useCallback(()=>{const h=Aa();h&&(o.playPromise?o.playPromise.then(()=>{h.stop(),o.playPromise=null}):h.stop())},[o]),p=l.useCallback(()=>{const h=Aa();h&&(h.state.isPlaying&&h.state.sourceUrl===Be.get(u)?.src?g():(Qt.readAloud.click({isMediaSourceAvailable:o.isMediaSourceAvailable,format:o.mediaSourceFormat}),f()))},[u,o,f,g]);l.useEffect(()=>{n&&d&&a(!1)},[n,d]);const y=l.useRef(u);return l.useEffect(()=>{y.current=u}),l.useEffect(()=>(o.shouldAbortQueuedPlayback=!1,()=>{const h=zr();h.isPlaying&&h.sourceUrl===Be.get(y.current)?.src?g():o.shouldAbortQueuedPlayback=!0}),[o,g]),{togglePlayback:p,isPlaying:d,isLoading:n}}async function Qi({message_id:e,conversation_id:t,voice:n}){const a=await qe.synthesize({message_id:e,conversation_id:t,voice:n,format:ha()}),o=a.headers.get("content-type")??"audio/aac";return{response:a,format:o}}async function Wf(e){return da()?Vf(e):Gf(e)}async function Gf({key:e,...t}){const n=Be.get(e);if(n?.blob)return n.src;const{response:a,format:o}=await Qi(t),i=await a.arrayBuffer(),r=new Blob([i],{type:o}),c=Zi({key:e,src:URL.createObjectURL(r),format:o,blob:r});return Be.set(e,c),c.src}async function Vf({key:e,onStreamingError:t,onStreamingStart:n,...a}){let o=Be.get(e);o?.streaming&&(Be.delete(e),o=void 0);let i,r;const c=$f(),u=new c;if(o)i=o,i.src=URL.createObjectURL(u);else{const{format:f,response:g}=await Qi(a);r=g,i=Zi({key:e,src:URL.createObjectURL(u),format:f})}const m=qf(i.id),d={sourceopen:async()=>{m("sourceopen");const f=u.addSourceBuffer(i.format),g=async()=>{f.updating&&await new Promise(p=>f.addEventListener("updateend",p,{once:!0}))};if(i.segments.length&&!i.streaming){m("streaming from cache"),i.streaming=!0,n();for(const p of i.segments)f.appendBuffer(p),await g();u.readyState==="open"&&u.endOfStream(),i.streaming=!1,m("done streaming from cache");return}if(r){m("fetching audio");try{const p=r.body?.getReader();if(!p)return;for(;Be.get(e)?.id===i.id;){const{done:y,value:h}=await p.read();if(y){m("done streaming"),i.streaming=!1,u.readyState==="open"&&u.endOfStream();break}if(!Array.from(u.sourceBuffers).includes(f)){m("stop streaming, source buffer removed"),i.streaming=!1;break}i.streaming||(m("start streaming"),i.streaming=!0,n()),f.appendBuffer(h),i.segments.push(h),await g()}}catch(p){if(m("error while streaming",p),i.streaming=!1,u.readyState==="open")try{u.endOfStream("network")}catch(y){Qt.readAloud.error(y)}Be.delete(e),t(p)}}},sourceclose:()=>{m("sourceclose"),i.streaming&&(i.streaming=!1,Be.get(e)?.id===i.id&&(m("sourceclosed while streaming, cleaning up cache"),Be.delete(e)))},sourceended:wt};for(const[f,g]of Object.entries(d))u.addEventListener(f,()=>{try{return g()}catch(p){Qt.readAloud.error(p)}});return Be.set(e,i),i.src}const ao=je({playbackError:{id:"useVoiceReadAloudAudio.playbackError",defaultMessage:"Failed to play message"}}),qf=e=>wt;function $f(){return da()?window.MediaSource:null}function da(){return!!ha()}function ha(){if("MediaSource"in window){const e=t=>Ur(t)&&MediaSource.isTypeSupported(t);if(e("audio/aac"))return"aac";if(e("audio/mpeg"))return"mp3";if(e("audio/ogg"))return"ogg"}}const Zi=e=>({id:No(),segments:[],streaming:!1,...e}),Be=new ua({max:50,dispose:e=>{URL.revokeObjectURL(e.src)}}),Kf=l.memo(function(t){const n=Tt("1923022511")?.value,a=It(t.conversationId),{errCode:o}=oa(t.message);if(!n||!a||o)return null;const i=mi.getAudioAssetPointers(t.message.message)[0];return i?s.jsx(Yf,{audioAssetPointer:i,conversationId:a}):s.jsx(Xf,{...t,conversationId:a})});function Yf({audioAssetPointer:e,conversationId:t}){const{isLoading:n,isPlaying:a,togglePlayback:o}=xu({audioAssetPointer:e,conversationId:t});return s.jsx(Ji,{onClick:o,isPlaying:a,isLoading:n,playText:zs.replay,playIcon:Zd})}function Xf({conversationId:e,message:t}){const{isLoading:n,isPlaying:a,togglePlayback:o}=Hf({conversationId:e,messageId:t.message.id});return s.jsx(Ji,{onClick:o,isPlaying:a,isLoading:n,playText:zs.play,playIcon:Jd})}function Ji({onClick:e,isPlaying:t,isLoading:n,playText:a,playIcon:o}){let i,r;const c=ae();return n?(i=ko,r=zs.loading):t?(i=eh,r=zs.stop):(i=o,r=a),s.jsx(Kt,{icon:i,label:r?c.formatMessage(r):void 0,disabled:n,onClick:e,style:t||n?{visibility:"visible"}:void 0,testId:"voice-play-turn-action-button"})}const zs={replay:{id:"VoiceReadOutLoudButton.replay",defaultMessage:"Replay",description:"The tooltip for the replay button"},play:{id:"VoiceReadOutLoudButton.play",defaultMessage:"Read aloud",description:"The tooltip for the read aloud button"},stop:{id:"VoiceReadOutLoudButton.stop",defaultMessage:"Stop",description:"The tooltip for the stop button"},loading:{id:"VoiceReadOutLoudButton.loading",defaultMessage:"Loading",description:"The tooltip for the spinner"}},Ts="rounded-lg radix-disabled:pointer-events-auto radix-disabled:cursor-not-allowed";function Qf({className:e,clientThreadId:t,message:n,onModelSelect:a,onDropdownChange:o,canRegenerateResponse:i}){const r=ze("566128514").value,[c,u]=l.useState(null),[m,d]=l.useState(!1),[f,g]=l.useState(!1),p=$e(t),y=di({clientThreadId:t,message:n}),h=n.message.metadata?.model_slug,S=n.message.id,{modelOptions:x,modelSlug:j,animateModelLabelOnRender:b,messageModelEnabledTools:v}=y,M=hi(n.message),D=v.includes(qs.Search),T=l.useMemo(()=>x.find(N=>N.value===h),[x,h]),C=l.useRef(null),{doesUserHaveAnyAccountsWithPlusFeatures:w}=Hn(),k=N=>{N||setTimeout(()=>{C.current&&C.current.blur()},10)};if(l.useEffect(()=>{k(m)},[m]),bu(t))return null;const z=i&&x.some(N=>os(N,w));return p?null:s.jsxs(G.Root,{onOpenChange:N=>{i&&(d(N),o(N),k(N)),N&&V.logEvent(H.conversationOpenMessageModelSelector,{has_get_plus_button:z,is_new_regen_dropdown:!0})},children:[i?s.jsx(Jf,{label:s.jsx(R,{id:"wDs5sz",defaultMessage:"Switch model"}),children:s.jsx(Ai,{ref:C,className:A("cursor-pointer",e),onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:s.jsx(Bn,{modelSlug:j,animateModelLabelOnRender:b,isDropdownOpen:m,isRegenerateEnabled:i,isHovered:f,isRegenLabel:!0,omitIcon:!1})})}):s.jsx("button",{className:A("cursor-pointer",e),onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:s.jsx(Bn,{modelSlug:j,animateModelLabelOnRender:b,isDropdownOpen:!1,isRegenerateEnabled:!1,isHovered:f,omitIcon:r,animateShortLabel:!0})}),i&&s.jsx(G.Portal,{children:s.jsxs(G.Content,{className:"z-30 min-w-fit origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[s.jsx(G.Item,{disabled:!0,className:"pb-0 pt-2",children:s.jsx("span",{className:"text-token-text-secondary",children:s.jsx(R,{id:"bFLh5u",defaultMessage:"Switch model"})})}),s.jsx(Zf,{clientThreadId:t,messageId:S,onModelSelect:a,messageModelSlug:h,omitModelIcons:r,modelOptions:x,setHoveredOption:u,hoveredOption:c,retryOption:T,lastResponseUsedSearch:M,modelSupportsSearch:D,doesUserHaveAnyAccountsWithPlusFeatures:w})]})})]})}function Zf({clientThreadId:e,messageId:t,modelOptions:n,messageModelSlug:a,onModelSelect:o,omitModelIcons:i,setHoveredOption:r,hoveredOption:c,retryOption:u,lastResponseUsedSearch:m,modelSupportsSearch:d,doesUserHaveAnyAccountsWithPlusFeatures:f}){const g=ae(),[p,y]=l.useMemo(()=>Jt(n,b=>b.subcategory),[n]),h=l.useMemo(()=>{const b=new Map;return p.forEach(v=>{const M=v.subcategory;M&&(b.has(M)||b.set(M,[]),b.get(M)?.push(v))}),b},[p]),S=A("icon-sm",i&&"order-10 ml-auto text-token-text-tertiary icon-md"),x=i?"right":"left",j=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:g.formatMessage(Sn.search),icon:s.jsx(hs,{className:S}),condition:d&&!m,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:g.formatMessage(Sn.nosearch),icon:s.jsx(ki,{className:S}),condition:d&&m,eventName:"chatgpt_regenerate_without_search_button_clicked"}];return s.jsxs(s.Fragment,{children:[y.map(b=>{const{value:v,...M}=b;return s.jsx(jt,{value:v,onSelect:()=>{he.logEvent("chatgpt_regenerate_switch_model_button_clicked",v,{requestedModelId:v,...Qe({clientThreadId:e,messageId:t})}),o({requestedModelId:v})},includeRegenerate:!1,onMouseEnter:()=>r(v),onMouseLeave:()=>r(null),isHovered:c===v,messageModelSlug:a,includeCheck:!1,shouldShowUpsell:os(b,f),className:Ts,...M,icon:i?s.jsx("span",{className:S}):M.icon,justifyIcon:x,wrapIcon:!i},v)}),[...h.entries()].map(([b,v])=>s.jsxs(G.Sub,{children:[s.jsx(G.SubMenuTrigger,{children:s.jsx("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:b})}),s.jsx(G.Portal,{children:s.jsx(G.SubContent,{className:"min-w-fit",children:v.map(M=>{const{value:D,...T}=M;return s.jsx(jt,{value:D,onSelect:()=>{he.logEvent("chatgpt_regenerate_switch_model_button_clicked",D,{requestedModelId:D,...Qe({clientThreadId:e,messageId:t})}),o({requestedModelId:D})},includeRegenerate:!1,onMouseEnter:()=>r(D),onMouseLeave:()=>r(null),isHovered:c===D,messageModelSlug:a,includeCheck:!1,className:Ts,...T,icon:null,justifyIcon:x,wrapIcon:!i,shouldShowUpsell:os(M,f)},b+"-"+D)})})})]},b)),!!u&&s.jsxs(s.Fragment,{children:[s.jsx(G.Separator,{}),s.jsx(jt,{onSelect:()=>{he.logEvent("chatgpt_regenerate_try_again_button_clicked",u.value,{requestedModelId:u.value,...Qe({clientThreadId:e,messageId:t})}),o({requestedModelId:u.value})},includeRegenerate:!0,onMouseEnter:()=>r(u.value),onMouseLeave:()=>r(null),messageModelSlug:a,includeCheck:!1,className:Ts,...u,label:g.formatMessage(Sn.tryAgain),subtitle:u.label,icon:s.jsx(tn,{className:S}),justifyIcon:x,wrapIcon:!i},u.value),j.filter(b=>b.condition).map(b=>s.jsx(jt,{onSelect:()=>{he.logEvent(b.eventName,u.value,{requestedModelId:u.value,...Qe({clientThreadId:e,messageId:t})}),o({requestedModelId:u.value,extraStreamParams:b.extraStreamParams})},includeRegenerate:!1,onMouseEnter:()=>r(b.key),onMouseLeave:()=>r(null),isHovered:c===b.key,messageModelSlug:a,includeCheck:!1,className:Ts,...u,label:b.label,subtitle:"",icon:b.icon,justifyIcon:x,wrapIcon:!i},b.key))]})]})}function Jf({children:e,label:t}){return s.jsx(is,{label:t,sideOffset:0,children:e})}const Sn=je({tryAgain:{id:"VbsBGW",defaultMessage:"Try again"},search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),eg=l.memo(Qf);function er(e){return e.find(t=>t.message.author.role===ve.Tool&&t.message.metadata?.pending_memory_info)}function tg(e){return e.filter((t,n)=>{const a=e[n+1],i=a?.message.recipient==="assistant"&&a?.message.author.role===ve.Tool&&a?.message.author.name==="bio"&&fi(a.message).startsWith("Model set context");return t.message.author.role===ve.Assistant&&t.message.recipient==="bio"&&i}).flatMap(t=>{const n=t.message.content.content_type;return n===At.Text?t.message.content.parts:n===At.Code?[t.message.content.text]:[]}).map(lg)}function sg(e){return e.some(t=>t.message.author.role===ve.Assistant&&t.message.recipient==="bio"&&t.message.status==="in_progress")}function ng(e){const{eligible:t,isLoading:n}=vu(),a=l.useMemo(()=>e.length>0,[e]);l.useEffect(()=>{a&&t&&!n&&ss.openModal(gi.GlobalMemoryOnboarding)},[a,t,n])}function ag(e){const[t,n]=l.useState(!1);return{isPopoverOpen:t,setIsPopoverOpen:n,handleTogglePopover:o=>{const i=o??!t;n(i),i&&V.logEvent(H.memoryUpdatePopoverShown,{updateCount:e.length})}}}function tr({memoryWrites:e,popoverState:t,triggerButton:n,isParagen:a,setShowMemoriesModal:o}){return s.jsxs(Su,{open:t.isPopoverOpen,sideOffset:4,side:"bottom",alignAgainstAnchor:"start",size:"none",className:"z-10 min-w-60 max-w-96 text-sm",onOpenChange:i=>t.handleTogglePopover(i),disableAutofocus:!0,triggerButton:n,children:[s.jsx("div",{className:"mb-2 rounded border border-token-border-light bg-token-main-surface-secondary",children:e.map((i,r)=>s.jsx("div",{className:"border-b border-token-border-light px-3 py-2 first-letter:uppercase last:border-b-0",children:i},r))}),a?s.jsx("div",{className:"text-xs text-token-text-tertiary",children:s.jsx(R,{id:"MemoryActionResult.paragenMessage",defaultMessage:"This memory will be saved if you choose this response."})}):s.jsxs("button",{className:"flex w-full items-center justify-between rounded px-3 py-2 font-semibold hover:bg-token-main-surface-secondary",onClick:()=>{o(!0),V.logEvent(H.memoryUpdatePopoverManageButtonClicked,{updateCount:e.length})},children:[s.jsx(R,{id:"MemoryActionResult.manageMemories",defaultMessage:"Manage memories"}),s.jsx(sh,{className:"icon-md -mr-1 text-token-text-tertiary"})]})]})}function og({clientThreadId:e,pendingMessage:t,memoryWrites:n,popoverState:a,setShowMemoriesModal:o}){const i=Pt(),r=ae(),c=ee.getServerThreadId(e),u=ri({clientThreadId:e}),m=n.join(" ");let d=m.slice(0,50).replace(new RegExp("^\\p{L}","u"),g=>g.toLocaleUpperCase()).replace(/\.$/,"");m.length>50&&(d+="...");const f=async g=>{if(!c)throw new Error("Failed to confirm or reject memory update: serverThreadId is not found");const p=t.message.metadata?.pending_memory_info;ee.updateTree(e,y=>{y.updateNodeMessageMetadata(t.nodeId,{pending_memory_info:{...p,is_pending:!1,confirm_result:g}})});try{await qe.confirmOrRejectMemory(t.message.id,c,g)}catch{i.danger(r.formatMessage({id:"memory.confirmOrDenyFail",defaultMessage:"Failed to confirm or reject memory update"})),ee.updateTree(e,h=>{h.updateNodeMessageMetadata(t.nodeId,{pending_memory_info:p})})}};return s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"inline-block text-sm font-semibold text-token-text-tertiary outline-none",children:s.jsx(R,{id:"MemoryActionResult.memoryConfirmation",defaultMessage:"Remember this? {memoryText}",values:{memoryText:s.jsx("div",{className:"inline-block py-1",onMouseOver:()=>a.handleTogglePopover(!0),onMouseOut:()=>a.handleTogglePopover(!1),children:s.jsx(tr,{memoryWrites:n,popoverState:a,triggerButton:s.jsx("button",{className:A("text-left font-normal",a.isPopoverOpen?"text-token-text-secondary":"text-token-text-tertiary"),children:s.jsx(R,{id:"MemoryActionResult.memoryWrapper",defaultMessage:"“{memoryWrites}”",values:{memoryWrites:d}})}),setShowMemoriesModal:o})})}})}),s.jsx(Ve,{className:"ml-3 text-token-text-tertiary hover:text-token-text-primary",size:"xs",color:"secondary",disabled:u,onClick:()=>{f(!0)},children:s.jsx(R,{id:"MemoryActionResult.confirm",defaultMessage:"Yes"})}),s.jsx(Ve,{className:"ml-2 text-token-text-tertiary hover:text-token-text-primary",size:"xs",color:"secondary",disabled:u,onClick:()=>{f(!1)},children:s.jsx(R,{id:"MemoryActionResult.deny",defaultMessage:"No"})})]})}function ig({memoryWrites:e,popoverState:t,isParagen:n,setShowMemoriesModal:a}){return e.length===0?null:s.jsx(s.Fragment,{children:s.jsx("div",{className:"inline-block",onMouseOver:()=>t.handleTogglePopover(!0),onMouseOut:()=>t.handleTogglePopover(!1),children:s.jsx(tr,{memoryWrites:e,popoverState:t,isParagen:n,triggerButton:s.jsxs("button",{className:A("my-1 flex items-center gap-1 text-sm font-semibold outline-none",t.isPopoverOpen?"text-token-text-secondary":"text-token-text-tertiary"),children:[s.jsx(th,{className:"mb-[-1px]"}),e.length===1?s.jsx(R,{id:"MemoryActionResult.memoryWriteSingular.1",defaultMessage:"Memory updated"}):s.jsx(R,{id:"MemoryActionResult.memoryWritePlural.1",defaultMessage:"Memories updated"})]}),setShowMemoriesModal:a})})})}function rg(e){const t=er(e),n=t?.message.metadata?.pending_memory_info?.confirm_result;return t==null?null:n===!0?"confirmed":n===!1?"denied":"pending"}function Un({messages:e,clientThreadId:t,gizmoId:n,isParagen:a}){const o=tg(e),i=ag(o),r=sg(e);ng(o);const[c,u]=l.useState(!1),m=er(e),d=rg(e);return d==="denied"?null:r?s.jsx("div",{className:"result-streaming",children:s.jsx("span",{children:s.jsx("pre",{})})}):s.jsxs(s.Fragment,{children:[d==="pending"?s.jsx(og,{clientThreadId:t,memoryWrites:o,popoverState:i,setShowMemoriesModal:u,pendingMessage:m}):s.jsx(ig,{memoryWrites:o,popoverState:i,isParagen:a,setShowMemoriesModal:u}),c&&s.jsx(Ch,{initialGizmoId:n,onClose:()=>u(!1)})]})}function lg(e){const t=["The user ","The user's ","User ","User's "];for(const n of t)if(e.startsWith(n))return e.slice(n.length);return e}function oo(e,t,n){ee.updateTree(e,a=>{a.updateNodeMetadata(t,{inlineComparisonRating:n})})}function io(e){return{is_dark_mode:e==="dark",time_since_loaded:Math.floor(performance.now()/1e3),page_height:window?.innerHeight,page_width:window?.innerWidth,pixel_ratio:window?.devicePixelRatio,screen_height:window?.screen?.height,screen_width:window?.screen?.width}}const ro=({messages:e})=>{for(const{message:{metadata:t}}of e){const{augmented_paragen_prompt_label:n}=t??{};if(n)return n}};function cg(e){const t=l.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null});return e.stubSideBySideFeedback?s.jsx(sr,{setPreferredFeedback:()=>{},leftVariantId:"left-placeholder",rightVariantId:"right-placeholder",leftTurn:null,rightTurn:null,originalTurn:null,hasActiveRequest:!0,visibilityStateRef:t,...e}):s.jsx(ug,{...e,visibilityStateRef:t})}function ug(e){const{clientThreadId:t,variantIds:n,variantsInStreamInfo:a,turnIndex:o}=e;if(n.length!==2)throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");const i=ma(),[r]=l.useState(()=>Date.now()),c=ta(),{resolvedTheme:u}=Hr(),[m,d]=l.useMemo(()=>pi(n.join(""))()<.5?[0,1]:[1,0],[n[0],n[1]]),f=m<d?"left":"right",g=f==="left"?"right":"left",p=n[m],y=n[d],h=Da(t,p),S=Da(t,y),x=yt(En(t,o,yt(h).id)),j=yt(En(t,o,yt(S).id)),b=f==="left"?x:j,v=f==="left"?j:x,M=a.display_treatment==="unskippable",D=i?"skippable_parallel_2_in_stream:a:2.0":"skippable_parallel_2_in_stream:a:1.5";l.useEffect(()=>(_n.setState({displayingSideBySideFeedback:!0,unskippable:M}),()=>{_n.setState({displayingSideBySideFeedback:!1,unskippable:!1})}),[M]),yu();const T=l.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null});l.useEffect(()=>Wr(wu,{requestCompletion:()=>{const w=Yt(b.messages)?.completionSampleFinishTime,k=Yt(v.messages)?.completionSampleFinishTime;qe.submitMessageComparisonFeedback({feedback_version:D,original_message_id:b.messages[b.messages.length-1]?.message.id,new_message_id:v.messages[v.messages.length-1]?.message.id,conversation_id:ee.getServerThreadId(t),completion_comparison_rating:"skip",new_completion_placement:g,feedback_start_time:r,compare_step_start_time:r,original_completion_load_start_time:r,original_completion_load_end_time:w??0,new_completion_load_start_time:r,new_completion_load_end_time:k??0,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:io(u),...T.current})}}),[x,j,t,r,D,g,b?.messages,v?.messages,u]);const C=w=>{const Y=ee.getTree(t).getLeafFromNode(w);ee.setThreadCurrentLeafId(t,Y.id);const N=w===p===(f==="left"),L=Yt(b.messages)?.completionSampleFinishTime,B=Yt(v.messages)?.completionSampleFinishTime;b.messages.length>0&&oo(t,b.messages[b.messages.length-1].nodeId,N?"original":"new"),v.messages.length>0&&oo(t,v.messages[v.messages.length-1].nodeId,N?"original":"new");let E;L==null||B==null?E=N?"partial_load_comparison_original":"partial_load_comparison_new":E=N?"original":"new",qe.submitMessageComparisonFeedback({feedback_version:D,original_message_id:b.messages[b.messages.length-1]?.message.id,new_message_id:v.messages[v.messages.length-1]?.message.id,conversation_id:ee.getServerThreadId(t),completion_comparison_rating:E,new_completion_placement:g,feedback_start_time:r,compare_step_start_time:r,original_completion_load_start_time:r,original_completion_load_end_time:L??null,new_completion_load_start_time:r,new_completion_load_end_time:B??null,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:io(u),...T.current})};return s.jsx(sr,{...e,setPreferredFeedback:C,leftVariantId:p,rightVariantId:y,leftTurn:x,rightTurn:j,hasActiveRequest:c,originalTurn:b,visibilityStateRef:T})}function dg(e){if(!e.length)return!1;const t=e.filter(n=>n.type===Ge.Text||n.type===Ge.MultiText).filter(n=>n.message.message.status!=="finished_successfully"&&n.message.message.metadata?.snorkle_status!==void 0);return t.length>0&&t.every(n=>{const a=n.message.message.content;return a?.content_type===At.Text&&a.parts.join("")===""})}function sr({setPreferredFeedback:e,leftVariantId:t,rightVariantId:n,leftTurn:a,rightTurn:o,hasActiveRequest:i,originalTurn:r,visibilityStateRef:c,...u}){const{defaultParagenLabel:m,shouldShowParagenLabels:d=!1}=Ko(),f=a&&ro(a)||m,g=o&&ro(o)||m,p=l.useMemo(()=>a?.messages??[],[a?.messages]),y=l.useMemo(()=>o?.messages??[],[o?.messages]),{avatarClassName:h}=u,S=l.useMemo(()=>Ls(p),[p]),x=l.useMemo(()=>Ls(y),[y]),j=Po(),[b,v]=l.useMemo(()=>[S,x].map(K=>dg(K)),[S,x]),M=rt(a?Os.getRequestIdFromConversationTurn(a):"")||b,D=rt(o?Os.getRequestIdFromConversationTurn(o):"")||v,T=a?.role===ve.User,C=o?.role===ve.User,w=l.useRef(null),k=l.useRef(null),Y=l.useRef(null),z=u.stubSideBySideFeedback||b,N=u.stubSideBySideFeedback||v;l.useEffect(()=>{if(w.current&&k.current&&Y.current){const K=Array(11).fill(0).map((Q,U)=>U/10),X=new IntersectionObserver(Q=>Q.forEach(U=>{U.target===k.current?(c.current.left_visibility_initial==null&&(c.current.left_visibility_initial=U.intersectionRatio),c.current.left_visibility_max=Math.max(c.current.left_visibility_max??0,U.intersectionRatio)):U.target===Y.current&&(c.current.right_visibility_initial==null&&(c.current.right_visibility_initial=U.intersectionRatio),c.current.right_visibility_max=Math.max(c.current.right_visibility_max??0,U.intersectionRatio))}),{root:w.current,threshold:K});return X.observe(k.current),X.observe(Y.current),()=>X.disconnect()}},[c]);const{data:L}=Io(void 0,!1,j),B=ma(),E=s.jsx("div",{className:"text-pretty px-6 pb-5 pt-1 text-center text-sm text-token-text-secondary",children:s.jsx(R,{id:"TK934w",defaultMessage:"Which response do you prefer? Responses may take a moment to load."})}),F=ct();return s.jsxs("div",{className:"relative flex flex-col",children:[s.jsxs("div",{className:A("sticky z-[1] text-pretty bg-token-main-surface-primary px-6 text-center text-lg",F&&"top-[var(--thread-leading-height)] pt-3",!F&&"top-[-1px]",B&&!F?"md:top-header-height":F?"":"md:static"),children:[s.jsx(R,{id:"JgCHDY",defaultMessage:"You’re giving feedback on a new version of ChatGPT."}),B?E:null]}),B?null:E,s.jsx("div",{className:"relative -mb-2 snap-x snap-mandatory overflow-x-auto px-3 pb-4 md:px-5 lg:px-10",ref:w,children:s.jsx("div",{className:A(!F&&"min-w-fit"),children:s.jsxs("div",{className:A("mx-auto flex max-w-6xl items-start",B&&!F&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",!B&&!F&&"gap-4 sm:gap-6",B&&F&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",F&&!B&&"gap-4 sm:gap-6"),children:[s.jsxs(lo,{horizontalScrollContainerRef:w,rootElementRef:k,onClick:()=>{e(t)},hasActiveRequest:i,isWaitingOnFirstUserVisibleToken:z,children:[s.jsxs(ho,{children:[s.jsx(Rn,{messages:p,isUserTurn:T,avatarClassName:h}),s.jsx(uo,{children:d?s.jsx("span",{className:"font-bold text-token-text-primary",children:f}):s.jsx(R,{...fo.responseNumber,values:{responseIndex:1}})})]}),B&&z?s.jsx(co,{}):s.jsxs(s.Fragment,{children:[L!=null&&!T&&s.jsx(Un,{clientThreadId:u.clientThreadId,messages:p,isParagen:!0}),s.jsx(In,{...u,groupedMessagesToRender:S,allGroupedMessages:S,isEditing:!1,isUserTurn:T,isCompletionRequestInProgress:M,hasActiveRequest:i,handleEnterEdit:wt,handleExitEdit:wt,shouldGrowContainer:!1}),s.jsx(mo,{turn:a,originalTurn:r})]})]}),s.jsxs(lo,{horizontalScrollContainerRef:w,rootElementRef:Y,onClick:()=>{e(n)},hasActiveRequest:i,isWaitingOnFirstUserVisibleToken:N,children:[s.jsxs(ho,{children:[s.jsx(Rn,{messages:y,isUserTurn:C,avatarClassName:h}),s.jsx(uo,{children:d?s.jsx("span",{className:"font-bold text-token-text-primary",children:g}):s.jsx(R,{...fo.responseNumber,values:{responseIndex:2}})})]}),B&&N?s.jsx(co,{}):s.jsxs(s.Fragment,{children:[L!=null&&!C&&s.jsx(Un,{clientThreadId:u.clientThreadId,messages:y,isParagen:!0}),s.jsx(In,{...u,groupedMessagesToRender:x,allGroupedMessages:x,isEditing:!1,isUserTurn:C,isCompletionRequestInProgress:D,hasActiveRequest:i,handleEnterEdit:wt,handleExitEdit:wt,shouldGrowContainer:!1}),s.jsx(mo,{turn:o,originalTurn:r})]})]})]})})})]})}function lo({horizontalScrollContainerRef:e,rootElementRef:t,onClick:n,children:a,hasActiveRequest:o,isWaitingOnFirstUserVisibleToken:i}){const r=ma(),c=ct(),{scrollX:u}=Cu({layoutEffect:!1,container:e,target:t}),m=ju(),d=Mu(),f=l.useRef(null),g=l.useRef(null),p=l.useRef(null),[y,h]=l.useState(!1),[S,x]=l.useState(!1),[j,b]=l.useState(!1),[v,M]=l.useState(0);l.useEffect(()=>{if(!r)return;const z=new IntersectionObserver(N=>{for(const L of N)L.target===f.current?h(L.isIntersecting):L.target===p.current?b(L.isIntersecting):L.target===g.current&&x(L.isIntersecting)},{root:m?.current,rootMargin:c?`0px 0px -${v}px 0px`:void 0});return f.current&&g.current&&p.current&&(z.observe(f.current),z.observe(g.current),z.observe(p.current)),()=>{z.disconnect()}},[v,r,c,m]);const D=!j&&(S||y),T=ku(u,z=>D?-1*z:0),C=Fa(0);l.useEffect(()=>{if(!r)return;const z=new ResizeObserver(N=>{Ms(N.length===1,"entryList.length === 1");const L=N[0];Ms(L.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),C.set(L.contentBoxSize[0].inlineSize)});return t.current&&z.observe(t.current),()=>{z.disconnect()}},[r,C,t]);const w=Fa(0);l.useEffect(()=>{if(!r)return;const z=new ResizeObserver(N=>{Ms(N.length===1,"entryList.length === 1");const L=N[0];Ms(L.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),w.set(L.contentBoxSize[0].blockSize+16),M(L.contentBoxSize[0].blockSize)});return d.current&&z.observe(d.current),()=>{z.disconnect()}},[r,w,d]);const k=s.jsx(Ve,{className:r?"px-5":"mt-4 self-start",onClick:n,children:s.jsx(R,{id:"U2EAH6",defaultMessage:"I prefer this response"})}),Y=i;return s.jsxs("div",{"data-paragen-root":!0,className:A("relative flex w-full min-w-[min(450px,80vw)] snap-center flex-col gap-1 text-left",c&&r&&"pl-3 pr-5 sm:w-[calc(100cqw-62px)] sm:pl-3 sm:pr-5 md:px-10",!c&&r&&"px-10",r?"min-h-60 py-4":"rounded-2xl border border-token-main-surface-tertiary bg-white p-5 dark:bg-gray-700"),ref:t,children:[s.jsx("div",{className:A("absolute left-0 right-0 top-48 h-px","invisible"),ref:f}),s.jsx("div",{className:A("absolute bottom-0 left-0 right-0 top-48","invisible"),ref:g}),s.jsx("div",{className:A("absolute bottom-0 left-0 right-0 h-px","invisible"),ref:p}),a,r?s.jsx("div",{className:"flex-1"}):null,r?s.jsx("div",{className:"mt-4 min-h-10",children:Y?null:s.jsx(te.div,{style:{translateX:T,width:C,bottom:w},animate:{opacity:100},initial:{opacity:0},transition:{ease:"easeOut",duration:.2,delay:.5},className:A({fixed:D,"z-20 flex w-full justify-center":!0}),children:k})}):o?null:k]})}function co(){return s.jsxs("div",{className:"flex w-full flex-col gap-4 pb-5 pt-3",children:[s.jsx(at,{className:"h-4 w-[75%]"}),s.jsx(at,{className:"h-4 w-[50%]"}),s.jsx(at,{className:"h-4 w-[80%]"}),s.jsx(at,{className:"h-4 w-[55%]"}),s.jsx(at,{className:"h-4 w-[66%]"}),s.jsx(at,{className:"h-4 w-[64%]"}),s.jsx(at,{className:"h-4 w-[48%]"})]})}function ma(){const{layer:e}=Ue("3119715334");return e.get("should-enable-hojicha",!1)}const uo=_e.div`text-sm text-token-text-secondary font-semibold`,ho=_e.div`flex gap-4 items-center mb-1`,at=_e.div`animate-pulse rounded-[4px] bg-token-main-surface-tertiary`;function mo({turn:e,originalTurn:t}){const n=Jn();if(!n.showParagenMetadata||!n.showDebugConversationTurns&&!n.forceParagen||e==null)return null;let a=e===t?"ORIGINAL":"NEW";const i=e.messages[e.messages.length-1]?.message?.metadata?.__internal;if(i){const{model_id:r,model_definition_slug:c,model_definition_virtual_model_id:u,alternative_model_selection_rule:m,augmented_paragen_prompt_group_id:d,augmented_paragen_prompt_id:f,augmented_paragen_prompt:g}=i;r&&(a+=`
Model ID: ${r}`),c&&(a+=`
Model Slug: ${c}`),u&&(a+=`
Virtual Model ID: ${u}`),m&&(a+=`
Alternative Model Rule: ${m}`),d&&(a+=`
Prompt Group ID: ${d}`),f&&(a+=`
Prompt ID: ${f}`),g&&(a+=`
Prompt: ${g}`)}return s.jsx("div",{className:"whitespace-pre-wrap text-sm text-red-500",children:a})}const fo=je({responseNumber:{id:"ConversationTurnTwoUpFeedback.responseNumber",defaultMessage:"Response {responseIndex, number}"}}),go=(...e)=>t=>e.some(n=>n(t)),po=({allGroupedMessages:e})=>e.some(t=>[Ge.Browsing,Ge.RetrievalBrowsing,Ge.ParallelBrowsing].includes(t.type)),xo=({allGroupedMessages:e})=>e.some(t=>t.type===Ge.SearchGPTQuery),bo=({allGroupedMessages:e})=>e.some(t=>t.type===Ge.CodeInterpreter);function hg(e){return!e||!e.instructions?"":typeof e.instructions=="string"?e.instructions:e.instructions.filter(t=>typeof t=="string").join("")}const mg=[{match:go(po,xo),tag:"Shouldn't have searched the web",label:fe({id:"kL047b",defaultMessage:"Shouldn't have searched the web"})},{match:go(po,xo),tag:"Don't like the source it cited",label:fe({id:"OWjzGX",defaultMessage:"Don't like the sources it cited"})},{match:bo,tag:"Shouldn't have run code",label:fe({id:"53w4ay",defaultMessage:"Shouldn't have run code"})},{match:bo,tag:"Couldn't handle my file",label:fe({id:"EkFTQ5",defaultMessage:"Couldn't handle my file"})},{match:({allGroupedMessages:e})=>e.some(t=>t.type===Ge.Dalle),tag:"Shouldn't have created an image",label:fe({id:"S8FRsr",defaultMessage:"Shouldn't have created an image"})},{match:({allGroupedMessages:e})=>e.some(t=>{if(t.type!==Ge.Text)return!1;const{message:n}=t.message,{content:a}=n;return a.content_type===At.Text&&fi(n).match(/^```[\S]+\n/gm)}),tag:"Code was incorrect",label:fe({id:"4EBdQk",defaultMessage:"Code was incorrect"})},{match:({systemContent:e})=>hg(e).includes("Personality")??!1,tag:"Too chatty or casual",label:fe({id:"ATzJKW",defaultMessage:"Too chatty or casual"})},{match:({features:e})=>e.includes(kt.Sunshine),tag:"Shouldn't have used Memory",label:fe({id:"yfUEiz",defaultMessage:"Shouldn't have used Memory"})},{tag:"Don't like the style",label:fe({id:"nGxjdj",defaultMessage:"Don't like the style"})},{tag:"Not factually correct",label:fe({id:"Ke7JtQ",defaultMessage:"Not factually correct"})},{tag:"Didn't fully follow instructions",label:fe({id:"Rdlt9V",defaultMessage:"Didn't fully follow instructions"})},{tag:"Refused when it shouldn't have",label:fe({id:"2yRS/Q",defaultMessage:"Refused when it shouldn't have"})},{tag:"Being lazy",label:fe({id:"14MPmT",defaultMessage:"Being lazy"})},{tag:"Unsafe or problematic",label:fe({id:"02pXBl",defaultMessage:"Unsafe or problematic"})},{tag:"Other",label:fe({id:"WiIGE+",defaultMessage:"Other"})}],fg=[{tag:"I disagree with the policy",label:fe({id:"oKyDLz",defaultMessage:"I disagree with the policy"})},{tag:"This didn't violate the policy",label:fe({id:"7fUkVF",defaultMessage:"This didn't violate the policy"})},{tag:"I don't understand the policy",label:fe({id:"4Cdp6N",defaultMessage:"I don't understand the policy"})},{tag:"This didn't take the full context",label:fe({id:"vnZJDP",defaultMessage:"This didn't take the full context"})}];function gg(e,t,n){return t.filter(a=>!a.match||a.match(n)).map(a=>({value:a.tag,label:e.formatMessage(a.label)}))}function pg(e){const t=e[e.length-1];if(!t)return!1;const n="message"in t?t.message:null;if(n){const{errCode:a}=oa(n);return[Fs.ContentPolicy,Fs.ContentOrTos].includes(a)}else return!1}function xg({clientThreadId:e,conversationMessage:t,currentModelId:n,allGroupedMessages:a}){const o=ae(),i=Gs()??[],r=t.rating,c=_u(e,t.message.id),u=c?.message.content.content_type===At.SystemContent?c?.message.content:null,m=l.useCallback(g=>{const p=ee.getServerThreadId(e);p&&(g.tags.length===0&&!g.textFeedback||(V.logEvent(g.source==="inline"?H.messageFeedbackInlineSubmitted:H.messageFeedbackDialogSubmitted,{id:t.message.id,threadId:p,tags:g.tags,content:g.textFeedback,model:n,rating:r}),he.logEvent(g.source==="inline"?"chatgpt_feedback_inline_submitted":"chatgpt_feedback_dialog_submitted",g.tags?.[0]??null,{id:t.message.id,threadId:p,tag:g.tags?.[0]??"",content:g.textFeedback??"",model:n,rating:r??""}),r&&qe.submitMessageFeedback({message_id:t.message.id,conversation_id:p,rating:r,text:g.textFeedback,tags:g.tags,tag_choices:g.tagChoices})))},[e,t.message,n,r]),d=()=>{V.logEvent(H.messageFeedbackMoreOptionsClicked,{id:t.message.id,threadId:ee.getServerThreadId(e),model:n,rating:r})},f=gg(o,pg(a)?fg:mg,{allGroupedMessages:a,features:i,currentModelId:n,systemContent:u});return r==="thumbsUp"?null:s.jsx(yh,{tagOptions:f,onSubmit:m,onMoreClicked:d})}const vo=[1,2,3,4,10,20,30],bg=.5;function vg({clientThreadId:e,conversationLeafId:t}){const n=xi(bi.isBusinessWorkspace),a=l.useRef(!1),o=It(e),i=en(e),{isUnauthenticated:r}=Je(),c=l.useMemo(()=>{if(!o)return-1;const w=pi(o);return w()>bg?-1:vo[Math.floor(w()*vo.length)]},[o]),u=Tu(e,t),m=u[u.length-1],d=l.useMemo(()=>Os.getRequestIdFromConversationTurn(m),[m]),f=rt(d),[g,p]=l.useState(null),[y,h]=l.useState(!1),[S,x]=l.useState(!1),[j,b]=l.useState(!1),v=w=>{const k=Yt(u)?.messages[0]?.message.id;p(w),T(k,w)},M=u.filter(w=>w.role===ve.Assistant).length,D=m?.role===ve.Assistant,T=l.useMemo(()=>ci((w,k)=>{o&&w&&qe.submitConversationRating({conversation_id:o,message_id:w,rating:k,shown_at_assistant_turn:c}),V.logEvent(H.conversationRatingSubmitted,{rating:k,showAtAssistantTurn:c,conversationId:o}),h(!0),setTimeout(()=>{x(!0)},1500)},2e3),[o,c]),C=M!==c||f||!D||!!n||i?.kind!==Ze.PrimaryAssistant||j||r;return l.useEffect(()=>{!C&&!a.current&&(V.logEvent(H.conversationRatingShown,{showAtAssistantTurn:c,conversationId:o}),a.current=!0)},[C]),j||C?null:s.jsxs("div",{className:"mx-auto",children:[s.jsx(cs,{children:y&&!S&&s.jsx(te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:s.jsx(So,{$padded:!0,children:s.jsx("span",{className:"text-sm text-token-text-tertiary",children:s.jsx(R,{id:"rating.thanks",defaultMessage:"Thanks for your feedback!"})})})},"submitted")}),!y&&s.jsx(te.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},children:s.jsxs(So,{$padded:!1,children:[s.jsxs("div",{className:"flex items-center justify-center gap-4 px-4 py-3 text-sm text-token-text-secondary",children:[s.jsx(R,{id:"rating.instructions",defaultMessage:"Is this conversation helpful so far?"}),s.jsxs("div",{className:"flex items-center gap-5",children:[s.jsx(yn,{$selected:g==="thumbsUp",onClick:()=>v("thumbsUp"),children:s.jsx(_i,{className:"icon-md"})}),s.jsx(yn,{$selected:g==="thumbsDown",onClick:()=>v("thumbsDown"),children:s.jsx(Ti,{className:"icon-md"})})]})]}),s.jsx("div",{className:"w-px flex-1 self-stretch bg-token-main-surface-tertiary"}),s.jsx(yn,{className:"p-3",$selected:!1,onClick:()=>b(!0),children:s.jsx(nh,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})})]})},"rating")]})}const yn=_e.button`
  ${e=>e.$selected?"text-token-text-primary":"text-token-text-secondary"}
  hover:text-token-text-primary
`,So=_e.div`inline-flex rounded-xl border border-gray-100 dark:border-gray-700
${e=>e.$padded&&"py-3 px-4"}
`;function Sg({clientThreadId:e,conversationLeafId:t,canShowInlineMessageFeedback:n,messageForRating:a,allGroupedMessages:o,currentModelId:i}){let r=null;return Au(e,t)?null:(a.rating&&n?r=s.jsx(xg,{clientThreadId:e,conversationMessage:a,allGroupedMessages:o,currentModelId:i}):r=s.jsx("div",{className:"text-center",children:s.jsx(vg,{clientThreadId:e,conversationLeafId:t})}),s.jsx("div",{className:"mt-3 w-full empty:hidden",children:r}))}function yg(e){const{turnIndex:t,conversationLeafId:n,isFinalTurn:a,clientThreadId:o,onChangeItemInView:i,onChangeRating:r,currentModelId:c,initiallyHighlightedMessageId:u,avatarClassName:m,scrollToBottom:d,showAvatar:f=!0}=e,g=ae(),p=Zn(),y=!!p&&Vr(p),h=ea(),S=xi(bi.isBusinessWorkspace),x=Pt(),j=ee.getServerThreadId(o),b=yt(En(o,t,n)),{messages:v,variantIds:M,variantsInStreamInfo:D}=b,T=Ls(v),C=Eu();let w=v[v.length-1];for(const W of T){const Le=Fd(W);if(Le.some(We=>C.has(We.message.id))){w=Le[Le.length-1];break}}const k=v.slice(0,v.indexOf(w)+1),Y=Xs(),[z,N]=l.useState(!1),[L,B]=l.useState(!1),E=M.findIndex(W=>k.some(Le=>Le.nodeId===W)),F=b.role===ve.User,K=Vs(),X=$e(o),Q=$s(b.gizmoId??X)?.data,U=Ru(),Z=Q&&U.includes(Q.gizmo.id),Se=vi(c),de=Nu(c),oe=ct(),ne=en(o,Q?.gizmo.id),J=oi(o)===Eo.STREAMING,ye=Gs(),{value:xe}=Tt("1410082514"),{value:Me}=Tt("2291672486"),P=k.some(W=>W.message.content.content_type===At.MultimodalText),{layer:ie}=Ue("1547743984"),De=j&&Y&&ie.get("show_share_button_inline",!1),{isUnauthenticated:we}=Je(),[I,O]=l.useState(!1),[re,le]=l.useState(!1);qr(()=>{b.role==="user"&&d&&d()});const se=l.useRef(null);l.useEffect(()=>{if(u==null)return;b.messages.map(Le=>Le.message.id).includes(u)&&se.current?.scrollIntoView({behavior:"auto"})},[u]);const q=v[v.length-1],ce=q.rating,Ae=()=>{k.length===1&&(V.logEvent(H.editPrompt,{id:k[0].message.id,threadId:ee.getServerThreadId(o)}),he.logEvent("chatgpt_edit_prompt"),N(!0))},be=l.useCallback(()=>{N(!1)},[]),Ce=l.useCallback(W=>{ee.copyMessageToClipboard(o,t,x,W)},[o,t,x]),$=W=>{r({nodeId:q.nodeId,messageId:q.message.id,rating:W}),V.logEvent(W==="thumbsDown"?H.messageFeedbackThumbsDownClicked:H.messageFeedbackThumbsUpClicked,{id:q.message.id,threadId:ee.getServerThreadId(o),model:c,rating:W}),B(!0)},[Pe]=l.useState(()=>Date.now()),me=l.useMemo(()=>Os.getRequestIdFromConversationTurn(b),[b]),ge=ii({clientThreadId:o,conversationLeafId:n}),ke=rt(me)&&!ge,ms=ta(),an=Ls(k),{showDebugConversationTurns:fs}=Jn(),Ke=li(o),Dt=ui(o),Ee=Pu({clientThreadId:o,conversationMode:ne}),Ft=lt(o),gs=l.useCallback(({requestedModelId:W,systemMessage:Le,juice:We,extraStreamParams:Ht})=>{const bt=new ts;Ee({id:q.nodeId,eventMetadata:{eventSource:"mouse"},turnTracker:bt,requestedModelId:W,systemMessage:Le,juice:We,extraStreamParams:Ht})},[q,Ee]),ut=xe&&k.some(W=>W.message.metadata?.snorkle_status!=null),Lt=!h&&!Ke&&!K&&!F,Ot=Iu(),Bt=w.message.author.role===ve.Assistant?w.message:null;Du({isCompletionRequestInProgress:ke,isUserTurn:F,message:Bt});const dt=Fu(o,M),et=Lu(ne),zt=!Ot&&!et&&Lt&&a&&D?.num_variants_in_stream===2&&!q.inlineComparisonRating&&!dt,Ye=Ou(b),tt=zt,on=zt&&!Ye,ht=!F&&!h&&!Ke&&!et&&!J&&!ke,mt=ht&&(!S||ut||de||y)&&!et&&!we&&!K,ft=!h&&!((ke||J)&&a)&&M.length>1&&!z&&!tt;let gt=!1;if(F&&k.length===1){const{shouldHideContent:W}=oa(k[0]);W&&(gt=!0)}const Ut=F&&!et&&!h&&!P&&k.length===1&&!gt&&!z&&!we,rn=W=>{i(M[W]),V.logEvent(H.changeNode,{intent:"toggle_between"})};if(!(b.role===ve.Root?!1:b.role===ve.System||b.role===ve.Developer||k.every(W=>W.message.metadata?.is_visually_hidden_from_conversation)?fs:!0)&&!tt)return null;const st=k.some(({message:W})=>mi.getAssetPointers(W).length>0),ps=!st&&a&&Dt&&!Me?s.jsx(Kt,{onClick:()=>{he.logEvent("chatgpt_regenerate_try_again_button_clicked",c,{requestedModelId:c,...Qe({clientThreadId:o,turnIndex:t})});const W=new ts;Ee({id:Ft,eventMetadata:{eventSource:"mouse"},turnTracker:W}),es()},icon:tn,label:g.formatMessage({id:"ConversationTurn.regenerateTooltip",defaultMessage:"Regenerate"}),testId:"regenerate-turn-action-button"}):null,pt="h-[30px] rounded-md px-1 text-token-text-secondary hover:bg-token-main-surface-secondary",cn=!st&&Me?s.jsx(eg,{className:pt,clientThreadId:o,message:q,onModelSelect:gs,onDropdownChange:O,canRegenerateResponse:Dt}):null,un=!F&&!gt&&(!a||!ke)?s.jsx(qu,{onClick:Ce}):null,xs=!F&&(!a||!ke)&&(q.disclaimers??[]).length===0&&q.nodeId?s.jsx(Kf,{conversationId:o,message:q,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-xs text-token-text-tertiary hover:text-token-text-primary"}):null,bs=!F&&q&&(!a||!ke)?s.jsx($u,{message:q,isFinalTurn:a,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-token-text-tertiary hover:text-token-text-primary"}):null,xt=mt&&!ke?s.jsxs("div",{className:"flex",children:[!ye?.includes(kt.ThumbsDownOnly)&&ce!=="thumbsDown"&&s.jsx(Kt,{onClick:()=>$("thumbsUp"),disabled:ce==="thumbsUp",icon:ce==="thumbsUp"?ah:_i,label:g.formatMessage({id:"ConversationTurn.goodResponseTooltip",defaultMessage:"Good response"}),testId:"good-response-turn-action-button"},`thumbsUp:${q.nodeId}`),ce!=="thumbsUp"&&s.jsx(Kt,{onClick:()=>$("thumbsDown"),disabled:ce==="thumbsDown",icon:ce==="thumbsDown"?oh:Ti,label:g.formatMessage({id:"ConversationTurn.badResponseTooltip",defaultMessage:"Bad response"}),testId:"bad-response-turn-action-button"},`thumbsDown:${q.nodeId}`)]}):null,dn=De&&s.jsx(Kt,{onClick:()=>{ss.openSharingModal(j)},label:g.formatMessage({id:"ConversationTurn.shareButtonTooltip",defaultMessage:"Share conversation"}),className:"sm:hidden",icon:ih}),hn=!Me&&s.jsx(zf,{className:pt,clientThreadId:o,message:q,onModelSelect:gs,onDropdownChange:O});function vs(W){return oe?W:s.jsx(na,{clientThreadId:o,isStaticSharedThread:h,withVerticalPadding:!0,withHorizontalPadding:!tt,children:W})}function Ss(W){return oe?W:s.jsx(ns,{children:W})}return s.jsxs("article",{className:"w-full text-token-text-primary focus-visible:outline-2 focus-visible:outline-offset-[-4px]",ref:se,dir:"auto","data-testid":`conversation-turn-${t}`,"data-scroll-anchor":a,onMouseEnter:()=>le(!0),onMouseLeave:()=>le(!1),children:[s.jsx(Bu,{role:b.role}),vs(s.jsx(s.Fragment,{children:tt?s.jsx(cg,{isFeedbackEnabled:mt,variantIds:M,variantsInStreamInfo:D,conversationTurnMountTime:Pe,stubSideBySideFeedback:on,...e}):Ss(s.jsxs(s.Fragment,{children:[!F&&f&&s.jsx(Cg,{children:s.jsx(Rn,{messages:k,isUserTurn:F,avatarClassName:m,gizmo:Q})}),s.jsx("div",{className:A("group/conversation-turn relative flex w-full min-w-0 flex-col",!F&&zu),children:s.jsx("div",{className:"flex-col gap-1 md:gap-3",children:s.jsxs(s.Fragment,{children:[!F&&!h&&s.jsx(Un,{messages:k,clientThreadId:o,gizmoId:Q?.gizmo.id}),s.jsx(In,{groupedMessagesToRender:an,allGroupedMessages:T,...e,isEditing:z,isUserTurn:F,isCompletionRequestInProgress:ke,isFeedbackEnabled:mt,isFinalTurn:a,hasActiveRequest:ms,showEditButton:Ut,handleEnterEdit:Ae,handleExitEdit:be}),Z&&s.jsx("div",{className:"mb-4",children:s.jsx(Uu,{messages:k})}),Se&&s.jsx("div",{className:"mb-4",children:s.jsx(Hu,{messages:k})}),(ht||ft)&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:A("mb-2 flex gap-3 empty:hidden",F?"mr-1 flex-row-reverse":"-ml-2"),children:s.jsx(Wu,{alwaysShow:a,showInline:a||ft,isHovered:re||I,pagination:ft&&s.jsx(Gu,{showInline:a||ft,currentPage:E,onChangeIndex:rn,length:M.length,className:A("self-center",M.length>1?"visible":"!invisible")}),actions:ht&&s.jsxs(s.Fragment,{children:[xs,un,ps,xt,bs,hn,dn,cn]})})}),ht&&!ke?s.jsx("div",{className:"pr-2 lg:pr-0",children:s.jsx(Vu,{message:q,isFinalTurn:a})}):null,a&&!ke&&s.jsx(Sg,{canShowInlineMessageFeedback:L,clientThreadId:o,conversationLeafId:n,messageForRating:q,allGroupedMessages:T,currentModelId:c})]})]})})})]}))}))]})}const wg=Gr.memo(yg),Cg=_e.div`flex-shrink-0 flex flex-col relative items-end`,jg=3;function Mg({onChangeItemInView:e,onRequestMoreCompletions:t,onChangeRating:n,onRequestCompletion:a,clientThreadId:o,conversationLeafId:i,hideHeader:r}){const c=Ne(),u=Si(),m=Ku(),[d]=Yu(),f=Xu(),[g]=Qu(),p=en(o),y=ls(),h=Zu(o),S=Ju(o),x=c.store.useContentAreaDimensions(Et.Header,U=>U?.height?U.height:void 0),j=c.store.useIsHeaderContentAreaPopulated(),b=yi(o),{isArchived:v}=b,M=ed(h.id),D=p?.kind===Ze.GizmoMagicCreate?"bg-token-main-surface-primary text-token-text-primary":M,T=wi(o,i),C=Wo(),[w,k]=l.useState(0),[Y,z]=l.useState(!1);l.useEffect(()=>{u&&(w===0?k(T):!Y&&T>w&&(z(!0),he.logEvent("chatgpt_continue_conversation_first_message_sent"),V.logEvent(H.continueConversationFirstMessageSent)))},[T,w,Y,u]),u&&(he.logEvent("chatgpt_continue_conversation_page_loaded"),V.logEvent(H.continueConversationPageLoaded));const N=l.useCallback(()=>{m({behavior:"smooth"})},[m]),L=td(o),B=C&&!v,E=(U,Z,Se,de)=>(de&&(U=U+jg),[...new Array(Z-U).keys()].map(oe=>{const ne=oe+U;return s.jsx(wg,{isFinalTurn:Se(ne),turnIndex:ne,clientThreadId:o,conversationLeafId:i,onChangeItemInView:e,onChangeRating:n,onRequestMoreCompletions:t,onRequestCompletion:a,currentModelId:h.id,avatarClassName:D,scrollToBottom:N},ne)})),{layer:F}=Ue("4031588851"),K=F.get("enable_hardcoded_onboarding_prompt",!1),[X,Q]=l.useState(!1);return l.useEffect(()=>{if(!K)return;const U=ee.getTree(o),Z=U.getChildrenFromNode("root")[0],de=U.getChildrenFromNode(Z.id)[0].message.author.metadata?.is_system_initiated_conversation===!0;Q(de)},[i,T,a,o,K]),s.jsxs("div",{onCopy:L,className:A("flex flex-col text-sm",B&&"pb-[120px]",x||B?null:"md:pb-9"),style:{paddingBottom:B?void 0:x},children:[!r&&y?.data&&s.jsx($i,{clientThreadId:o}),u&&s.jsxs(s.Fragment,{children:[s.jsx(ns,{children:s.jsx("p",{className:"text-xs text-gray-500",children:s.jsx(R,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),T-w===0&&s.jsx("div",{className:"text-center text-xs font-semibold text-token-text-primary",children:s.jsx("button",{onClick:()=>{ss.openModal(gi.ReportConversation),he.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),V.logEvent(H.sharedConversationReportContentClicked,{location:"Dynamic Shared Thread Page"})},children:s.jsx(R,{id:"thread.reportSharedConversation",defaultMessage:"Report content"})})}),E(0,w,U=>U===w-1),s.jsx(ns,{children:s.jsxs("p",{className:"flex items-center text-xs text-gray-500",children:[s.jsx(rh,{className:"icon-xs mr-2"}),s.jsx(R,{id:"threadLayout.sharedConversationPrivateDisclaimer",defaultMessage:"Messages beyond this point are only visible to you"})]})}),E(w,T,U=>U===T-1)]}),!u&&E(0,T,U=>U===T-1,X),S&&d&&!g&&s.jsx(yo,{className:A("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{he.logEvent("chatgpt_thread_scroll_to_top"),f({behavior:"smooth"})},children:s.jsx(lh,{className:"icon-md text-token-text-primary"})}),!d&&s.jsx(yo,{className:A(x?null:"bottom-5",B?j?"translate-y-[-50px]":"translate-y-[-10px]":""),style:{bottom:C?"calc(var(--composer-bar_footer-current-height) + var(--composer-bar_current-height))":x},onClick:()=>{he.logEvent("chatgpt_thread_scroll_to_bottom"),m({behavior:"smooth"})},children:s.jsx(ch,{className:"icon-md text-token-text-primary"})})]})}const yo=_e.button`cursor-pointer absolute z-10 rounded-full bg-clip-padding border text-token-text-secondary border-token-border-light right-1/2 translate-x-1/2 bg-token-main-surface-primary w-8 h-8 flex items-center justify-center`,kg=60,_g=({children:e,scrollViewClassName:t,scrollAnchorTopOffset:n=0})=>{const a=l.useRef(null);return s.jsx("div",{className:"h-full",ref:a,children:s.jsx($r,{children:s.jsx(wh,{className:"h-full",followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:t,scroller:()=>Tg(a,n)?0:1/0,children:e})})})},Tg=(e,t)=>{const n=Ag(e.current);if(n==null)return!1;const a=n>t,o=n<t-kg;return!a&&!o};function Ag(e){if(!e)return null;const t=e.querySelector('[data-scroll-anchor="true"]');if(!t)return null;const n=t.getBoundingClientRect().top,a=e.getBoundingClientRect().top;return n-a}const Eg=Us(()=>Hs(()=>import("./gr5239b2ze2nlypy.js"),__vite__mapDeps([45,1,2,3,4,5,31,32,33,34,46])).then(e=>e.OpenDebugSidebarButton)),Rg=Us(()=>Hs(()=>import("./ef6g0xg7qwmvr7fm.js"),__vite__mapDeps([47,1,2,3,4,5,11]))),Ng=Us(()=>Hs(()=>import("./sso-k1m7wpjxj23so5oa.js").then(e=>e.e),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44])).catch(()=>()=>null)),wo=je({doNotShareSensitive:{id:"thread.modal.onboarding.title",defaultMessage:"Do not share sensitive materials with this application"},somethingWentWrong:{id:"thread.modal.unrecoverableError.title",defaultMessage:"Something went wrong"},tryAgainLater:{id:"thread.modal.unrecoverableError.description",defaultMessage:"We're sorry, but something went wrong. Please try again later."},resetThread:{id:"thread.modal.unrecoverableError.resetThread",defaultMessage:"Reset thread"},sharedConversationReportConversation:{id:"thread.sharedConversation.report",defaultMessage:"Report conversation"},latencyButton:{id:"thread.latencyButton",defaultMessage:"Latency"},archivedConversationDescription:{id:"thread.archivedConversationDescription",defaultMessage:"This conversation is archived. To continue, please unarchive it first."},unarchiveButton:{id:"thread.unarchiveButton",defaultMessage:"Unarchive"}});function Pg({clientThreadId:e}){const t=Ro(),n=It(e),a=async()=>{n&&(await qe.patchConversation(n,{is_archived:!1}),t.invalidateQueries({queryKey:["conversation",e]}),sa.setState(o=>{const i=o.threads[n];i!=null&&(i.initialThreadData.isArchived=!1)}),wd(t))};return s.jsxs("div",{className:"my-6 flex flex-col items-center justify-center gap-4",children:[s.jsx("div",{className:"px-3 text-center text-sm text-token-text-secondary",children:s.jsx(R,{...wo.archivedConversationDescription})}),s.jsx("div",{children:s.jsx(Ve,{disabled:!n,onClick:a,icon:uh,children:s.jsx(R,{...wo.unarchiveButton})})})]})}const Jg=function({clientThreadId:e,onCompletionFinished:t,onCreate:n,preRequestCompletion:a,hideHeader:o,hideMessages:i,hideFooter:r,hideToolsOverlay:c,messagesVerticalAlign:u="top",prependThreadChildren:m,renderEmptyState:d,prefetchSearch:f}){const g=ls(),p=Gs(),y=Zo(e),h=aa(e),S=lt(e),j=yi(e).isArchived;l.useEffect(()=>{h||(As(e)?jn.addTiming("chatgpt.web.chatPage.renderNewConversation"):jn.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[e,h]);const b=sd(e,S),v=wi(e,S),{setTargetedContent:M}=ti(),D=p?.includes(Kr),T=nd(),C=v>=2;Jo(C);const w=As(e)&&!C&&xn(y),k=As(e)&&!b&&(xn(y)||y?.kind===Ze.GizmoTest),z=ei().id,N=ad(e),L=N??z,B=!!N,E=vi(L),K=Qo()[L],X=od(e,y),Q=Xn();id(v,e,S,w),l.useEffect(()=>{si()},[]),l.useEffect(()=>{Q||M(void 0)},[e,M,Q,S]);const{caModal:U,onRequestCompletion:Z,onChangeItemInView:Se,onChangeRating:de,onRequestMoreCompletions:oe}=hh({clientThreadId:e,currentModelId:L,defaultModelId:z,onCompletionFinished:t,onThreadCreated:n,preRequestCompletion:a}),{isUnauthenticated:ne,isLoading:Te}=Je(),J=!!g?.features.includes(kt.SharedWebsocket);l.useEffect(()=>{J&&Es.registerIfNotConnected()},[J]),l.useEffect(()=>{const ge=()=>{if(document.visibilityState==="visible"){if(!J)return;Es.registerIfNotConnected()}};return document.addEventListener("visibilitychange",ge),()=>{document.removeEventListener("visibilitychange",ge)}},[J]);const ye=It(e);l.useEffect(()=>{const ge=()=>{Es.stopConversation(ye)};return window.addEventListener("beforeunload",ge),()=>{window.removeEventListener("beforeunload",ge)}},[ye]);const xe=rd({clientThreadId:e,currentLeafId:S,handleRequestCompletion:Z,prefetchSearchPromise:f});ld({clientThreadId:e,currentModelId:L});const Me=ge=>s.jsx(_g,{scrollAnchorTopOffset:o?0:yd,children:u==="bottom"?s.jsxs("div",{className:"flex h-full flex-col",children:[s.jsx("div",{className:"flex-1"}),ge]}):ge});l.useEffect(()=>{document.title=X??"ChatGPT"},[X]);const P=$e(e),ie=Vs(),De=Yr(),we=k&&!De&&!d&&!P&&!E&&!ie,I=we&&!Te&&ne,O=we&&!Te&&!ne,re=xf(I),le=vf(O),se=I&&re||O&&le,q=Si(),ce=cd(),{reset:Ae,streamingContext:be,StreamingProvider:Ce}=ud();l.useEffect(()=>{ce&&(be.setOnResetContext=()=>{Ae()})},[ce,Ae,be]);const $=l.useRef(null),Pe=l.useRef(null),me=l.useMemo(()=>({threadContentScrollContainerElementRef:$,footerRootContainerElementRef:Pe}),[]);return s.jsx(dd,{clientThreadId:e,currentLeafId:S,children:s.jsxs(Ce,{value:be,children:[D&&s.jsx(Rg,{}),s.jsx(hd,{children:X!=null&&s.jsx("title",{children:X})}),y?.kind===Ze.GizmoInteraction&&y.gizmo&&s.jsx(md,{gizmo:y.gizmo}),s.jsx(fd.Provider,{value:Z,children:s.jsxs(gd,{children:[s.jsxs(pd,{clientThreadId:e,currentModelConfig:K,className:"composer-parent flex h-full flex-col focus-visible:outline-0",children:[!i&&s.jsx(xd,{value:me,children:s.jsx(Ig,{ref:$,children:!h&&!xe?k?d??s.jsx(Df,{clientThreadId:e,currentModelId:L,isModelLoaded:B,onRequestCompletion:Z,enableV2Homepage:se,v2HomepageDisclaimer:se&&s.jsx(La,{clientThreadId:e})}):C?Me(s.jsxs(s.Fragment,{children:[m,s.jsx(Mg,{onChangeItemInView:Se,onRequestMoreCompletions:oe,onChangeRating:de,onRequestCompletion:Z,clientThreadId:e,conversationLeafId:S,hideHeader:o},e)]})):null:null})}),s.jsx(Dg,{ref:Pe,children:j?s.jsx(Pg,{clientThreadId:e}):s.jsxs("div",{children:[!se&&s.jsx(ff,{clientThreadId:e,isNewThread:w,showPromptStarters:w||!b,currentModelId:L,onRequestCompletion:Z}),!r&&s.jsx("div",{className:"relative w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",children:xn(y)&&!se&&s.jsx("div",{className:"min-h-4",children:s.jsx(La,{clientThreadId:e})})})]})})]}),!c&&s.jsxs("div",{className:"group absolute bottom-2 end-2 z-20 hidden gap-1 md:flex lg:bottom-3 lg:end-3",children:[T?s.jsxs(s.Fragment,{children:[s.jsx(Eg,{}),s.jsx(Ng,{})]}):null,s.jsx(Sh,{})]}),U,s.jsx(bd,{clientThreadId:e,isStaticSharedThread:!1,isDynamicSharedThread:q}),s.jsx(vd,{}),s.jsx(Sd,{conversationId:e,currentModelId:L,isActiveWindow:!De})]})})]})})},Ig=_e.div`grow flex-1 overflow-hidden`,Dg=_e.div`md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent w-full`;export{wg as C,Sf as S,Jg as T,_g as W,ff as a,Xg as b};
//# sourceMappingURL=m48yy4zuq608v31y.js.map
