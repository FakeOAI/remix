const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/i113xcdmhaayatkm.js","assets/jkt8kpmqx1ob1zea.js","assets/root-ij0a8l2a.css","assets/j41xn51jmw95fwqz.js","assets/conversation-small-ile61fj8.css","assets/izpgkl6t0zj5iap0.js","assets/odmcipi3ftfc0735.js","assets/blbd8ru4m21k2ais.js","assets/mkdtgufqp7mii6o2.js","assets/khkqzplnchvr77nq.js","assets/jdnkfbsled5rm97a.js","assets/f9gkpje2n21zqqg5.js","assets/b4jdws1yl5qko28c.js"])))=>i.map(i=>d[i]);
import{r as m,m as e,aE as j,eG as Q,L as O,a5 as W,ba as _,K as ee,ed as se,ec as Se,b6 as E,cK as te,N as R,V as ve,aw as je,d3 as ye,co as ke,b3 as ne,b4 as ae,dj as Ce,bq as ie,hw as v,hx as Ie,cf as Ne,cg as Me,gp as ze,e2 as A,a9 as Fe,bF as we}from"./jkt8kpmqx1ob1zea.js";import{k6 as Te,c1 as Ee,gS as re,iJ as oe,fS as Oe,dt as H,dr as Ge,b3 as ce,ci as Z,cO as Le,k7 as w,eH as _e,k8 as Ae,k9 as Pe,eN as Re,du as le,b0 as Be,ka as He,gW as De,dv as Ue,fJ as de,kb as We,fa as Ke,U as ue,fK as Ve,eI as qe,kc as Ye,cz as Ze,cA as Je,cv as K,cX as Xe,b9 as $e,kd as Qe,ke as F,cu as V,A as p,cG as me,dw as es,z as q,dx as ss,cC as fe,kf as ts,I as ns,kg as as,kh as is,ki as rs,kj as J,ek as os,kk as Y,aR as P,kl as xe,km as cs,kn as D,ko as T,kp as ls,el as ds,bF as us,kq as ms,aS as fs,c4 as xs,kr as hs,w as gs,ks as ps,y as bs,b$ as Ss,kt as vs,ku as he,E as js,kv as ys,X as ks}from"./j41xn51jmw95fwqz.js";import{u as G,c as Cs}from"./izpgkl6t0zj5iap0.js";import{m as U}from"./odmcipi3ftfc0735.js";import{useLottie as Is}from"./blbd8ru4m21k2ais.js";import{U as Ns,P as Ms}from"./mkdtgufqp7mii6o2.js";const zs=({isOpen:s,isHovered:t,color:a})=>{const d={animationData:Te,loop:!1,autoplay:!1},{View:i,playSegments:c,setSpeed:r,goToAndStop:o,animationItem:h,animationLoaded:x}=Is(d),u=m.useRef(null),g=m.useRef(null),n=m.useRef(null);return m.useEffect(()=>{!h||!x||(r(2),u.current==null?s?(o(31,!0),n.current=31):(o(0,!0),n.current=0):u.current!==s?s?(c([n.current??0,31],!0),n.current=31):(c([n.current??31,0],!0),n.current=0):s||g.current!==t&&(t?(c([n.current??0,15],!0),n.current=15):(c([n.current??15,0],!0),n.current=0)),u.current=s,g.current=t)},[s,t,h,x,o,c,r]),e.jsx("div",{className:j("[&_path]:stroke-current",{"text-token-text-primary":a==null}),style:{width:"18px",height:"18px",...a!=null&&{color:a}},children:i})},Fs={open:{opacity:1,y:0,transition:{duration:.15,ease:"easeOut"}},closed:{opacity:0,y:-5,transition:{duration:.15,ease:"easeIn"}}};function ws({gizmoId:s}){const t=oe(s);return e.jsx("div",{className:"flex h-6 w-6 shrink-0 items-center justify-center",children:e.jsx(De,{className:"h-3/4 w-3/4",style:{color:t}})})}function Ts({gizmo:s,historyDisabled:t,section:a,onClick:d,isActive:i,hideOverflowMenu:c=!1,elementRef:r,subConversations:o}){const{clientThreadId:h}=G(),x=Q(h),u=O(),[g,n]=m.useState(!1),[l,f]=m.useState(!1),[b,y]=m.useState(!1),[k,N]=m.useState(null),M=W(),L=!!s?.gizmo.tags?.includes(Ee.FirstParty),I=re(s?.gizmo.id),B=oe(s.gizmo.id);let z=!1;i&&I&&!(k&&x)&&(z=!0),m.useEffect(()=>{k==null&&i&&x&&N(!0)},[i,x,k]);let S;if(s!=null)S=s.gizmo.display.name||Oe;else{if(M==null)return null;t?S=u.formatMessage(H.clearChat):M.canInteractWithGizmos()?S=Ue:S=u.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(U.div,{whileTap:{scale:.98},onMouseEnter:()=>{f(!0)},onMouseLeave:()=>{f(!1)},children:e.jsx(Ge,{loggingGizmoId:s?.gizmo.id??"primary",href:ce(s),onClick:d,showActiveIndicator:z,icon:I&&o&&o.items.length>0?e.jsx(_,{side:"top",sideOffset:4,delayDuration:600,label:k?u.formatMessage(Z.hideChatsForProjectTooltip):u.formatMessage(Z.showChatsForProjectTooltip),children:e.jsx("button",{onClick:C=>{C.preventDefault(),N(!k)},className:"-m-0.5 flex rounded-xl p-0.5 text-token-text-secondary hover:bg-token-sidebar-surface-tertiary",onMouseEnter:()=>{y(!0)},onMouseLeave:()=>{y(!1)},children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx(zs,{isOpen:k??!1,isHovered:b,color:B||null})})})})}):I?e.jsx(ws,{gizmoId:s.gizmo.id}):e.jsx(Le,{isFirstParty:L,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6 shrink-0"}),isMenuOpen:g,label:S,rightIcon:a===w.Workspace&&e.jsx(_,{side:"right",label:u.formatMessage(X.workspaceRecommended,{workspace_name:M?.name??"Your Workspace"}),children:e.jsx(_e,{className:"icon-md text-token-text-secondary",alt:u.formatMessage(X.workspaceRecommended,{workspace_name:M?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(l||g)&&!c&&(I?e.jsx("div",{className:"text-token-text-tertiary",onClick:C=>{C.preventDefault()},children:e.jsx(Ae,{gizmo:s,isOpen:g,setIsOpen:n})}):e.jsx("div",{className:"text-token-text-tertiary",onClick:C=>{C.preventDefault()},children:e.jsx(Pe,{gizmo:s,isOpen:g,setIsOpen:n,section:a})})),!I&&!c&&e.jsx(_,{side:"right",label:u.formatMessage(t?H.clearChat:H.newChat),className:"flex items-center",children:e.jsx("button",{className:g?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:t?e.jsx(Re,{className:"icon-md"}):e.jsx(le,{className:"icon-md"})})})]}),elementRef:r})}),e.jsx(Be,{children:I&&k&&o&&o.items.length>0&&e.jsx(U.div,{initial:"closed",animate:"open",exit:"closed",variants:Fs,className:"overflow-hidden",layout:!0,children:e.jsx(He,{gizmoResource:s,serverThreadId:x,rootIsFocused:z,conversations:o.items})},"nested-conversations")})]})}const X=ee({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}});function Es(s){const{clientThreadId:t}=G(),a=m.useRef(s);a.current=s;const d=m.useRef(null);m.useEffect(()=>{const i=d.current;return d.current=t,()=>{t!==i&&a.current?.(t,i)}},[t])}function ge(){const s=O(),t=de(),a=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(We,{children:e.jsx(U.div,{whileTap:{scale:.98},children:e.jsx(se,{to:Ke(),onClick:()=>{t.activeSidebar==="popover-nav"&&ue.setActiveSidebar(!1)},children:e.jsx(Ve,{icon:qe,"data-testid":"explore-gpts-button",children:a})},"explore")})})}const Os=2;function pe({gizmos:s,isGizmoFlyout:t,isLoaded:a,maxToShowOnLoad:d=4,isScreenArch:i,showAllSidebarItems:c}){const r=Qe(s,l=>l.flair.kind),o=[...(r[F.Workspace]?.map(({resource:l})=>({gizmo:l,section:w.Workspace}))??[]).slice(0,3),...r[F.FirstParty]?.map(({resource:l})=>({gizmo:l,section:w.Keep}))??[],...r[F.SidebarKeep]?.map(({resource:l})=>({gizmo:l,section:w.Keep}))??[]],h=r[F.Recent]?.slice(0,i||a?r[F.Recent]?.length:Os).map(({resource:l})=>({gizmo:l,section:w.Recents}))??[],x=h.length,u=o.length,g=i?x>0:s.length>d;let n=[];return t&&i?n=[...o,...h]:!t&&i?n=o:(n=[...o,...h],c||(n.length>d&&u>d?n=n.slice(0,u):n.length>d&&(n=n.slice(0,d)))),{listItems:n,itemsLeft:s.length-n.length,needsToCollapseItems:g,total:s.length}}function be({gizmo:s,currentGizmoId:t,maxToShowOnLoad:a,hideOverflowMenu:d=!1}){const i=m.useRef(!1),c=!a,r=Se(),[o,h]=m.useState(!1),x=de(f=>!Ye.isGptListCollapsed(f)),{listItems:u,needsToCollapseItems:g,itemsLeft:n}=pe({gizmos:s,isGizmoFlyout:c,isLoaded:o,maxToShowOnLoad:a,isScreenArch:r,showAllSidebarItems:x});m.useEffect(()=>{o||h(!0)},[o]),m.useEffect(()=>{u.length>0&&!i.current&&(Ze({namespace:Je.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),i.current=!0)},[u]);function l(f,b){const y=e.jsx(Ts,{gizmo:f,isActive:f.gizmo.id===t,section:b,hideOverflowMenu:d},f.gizmo.id);return r?e.jsx("li",{children:y}):y}return e.jsxs("div",{children:[u.map(({gizmo:f,section:b},y)=>e.jsxs(m.Fragment,{children:[y>1&&b!==u[y-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),l(f,b)]},y)),!r&&g?e.jsxs("button",{onClick:ue.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(K,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:x?e.jsxs(e.Fragment,{children:[e.jsx(E,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(Xe,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:n}}),e.jsx($e,{className:"icon-xs"})]})})]}):null,!r&&e.jsx(ge,{})]})}function Gs({currentGizmoId:s,gizmos:t,onClick:a}){const{isSidebarFlyoutOpen:d,onSidebarFlyoutOpenChange:i}=V(),c=d(p.Gizmo),r=me();return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(te,{onOpenChange:o=>i(p.Gizmo,o),side:r?"bottom":"right",sideOffset:4,open:c,contentAlign:"end",triggerButton:e.jsxs("button",{className:j("flex flex-1 select-none items-center gap-2.5 rounded-lg px-2 py-[7px] text-body tracking-condensed text-token-text-secondary ease-[var(--spring-bounce)] hover:bg-token-main-surface-secondary focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",c&&"bg-token-main-surface-secondary"),onClick:a,children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx(K,{className:j("icon-md font-semibold text-token-sidebar-icon")})})}),e.jsx("span",{className:"text-left",children:e.jsx(E,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(R,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(be,{gizmo:t,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function Ls({currentGizmoId:s}){const{data:{gizmos:t}={}}=es();let a=t;q()&&(a=t?.filter(c=>!ss(c.resource)));const{needsToCollapseItems:i}=pe({gizmos:a??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return e.jsx(e.Fragment,{children:e.jsxs(fe,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(E,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(ge,{}),e.jsx(be,{gizmo:a??[],currentGizmoId:s,maxToShowOnLoad:ts}),i&&e.jsx(R,{children:e.jsx(Gs,{currentGizmoId:s,gizmos:a??[]})})]})})}function _s({onClick:s}){const{clientThreadId:t}=G(),{isSidebarFlyoutOpen:a,onSidebarFlyoutOpenChange:d}=V(),i=me(),c=a(p.Conversation);return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(te,{onOpenChange:r=>{r&&ve.logEvent("chatgpt_web_more_conversation_history_opened"),d(p.Conversation,r)},side:i?"bottom":"right",sideOffset:4,open:c,contentAlign:"start",triggerButton:e.jsxs("button",{className:j("flex flex-1 select-none items-center gap-2 rounded-lg px-2 py-2 text-body tracking-condensed text-token-text-secondary ease-[var(--spring-bounce)] hover:bg-token-main-surface-secondary focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",c&&"bg-token-main-surface-secondary"),onClick:s,children:[e.jsx(K,{className:j("icon-md mr-1 font-semibold text-token-sidebar-icon")}),e.jsx("span",{className:"text-left",children:e.jsx(E,{id:"25xE8F",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(R,{children:e.jsx(ns,{activeId:t,hideOverflowMenu:!0})})})})})}function As({clientThreadId:s}){const t=Q(s),a=je(),{isCollapsible:d,recentConversationLimit:i}=as(),c={recentConversationLimit:i};q()&&(c.hideSnorlaxConversations=!0);const o=m.useRef(!1),h=!0,{conversations:x,data:u,isLoading:g,isError:n,recents:l,refetch:f}=is(c),[b,y]=m.useState(!0),k=m.useCallback(function(C){C===void 0&&y(!1),f({cancelRefetch:!0})},[f,y]),N=a?void 0:t,M=x.length===0,L=n||u===void 0&&!g&&o.current,I=!L&&(u===void 0||g);u===void 0&&!g&&!o.current&&(o.current=!0,k(!0));const z=x.find(S=>S.id===N)??null;return m.useMemo(()=>{ye.publish({kind:"refreshHistory",conversations:x})},[x]),e.jsxs(e.Fragment,{children:[L&&e.jsx(rs,{showRetry:b,refetch:k}),!M&&e.jsxs(fe,{header:l.label,isLastInGroup:!0,children:[l.items.map((S,C)=>e.jsx(J,{item:S,isActive:S.id===N,testId:`history-item-${C}`},S.id)),z&&!l.items.some(S=>S.id===N)&&e.jsx(J,{item:z,isActive:!0})]}),I&&e.jsx(ke,{className:"sticky top-4 z-30 mt-4 justify-self-center"}),d&&e.jsx(R,{children:e.jsx("div",{className:"-ml-2 mb-5",children:e.jsx("div",{hidden:!h,className:j(!h),children:e.jsx(_s,{})})})})]})}const $=ne(()=>ae(()=>import("./i113xcdmhaayatkm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8])).then(s=>s.SnorlaxSidebarList));function Ps({clientThreadId:s}){const t=W(),a=Ce(s),{isUnauthenticated:d}=ie(),i=q();return d?null:e.jsxs("div",{className:j(v.screenContent),children:[i&&t?.canInteractWithGizmos()&&$?e.jsx($,{currentGizmoId:a}):null,null,e.jsx(As,{clientThreadId:s}),t?.canInteractWithGizmos()?e.jsx(Ls,{currentGizmoId:a}):null,!1]})}function Rs(){const s=W(),t=s?.data==null,{isUnauthenticated:a}=ie(),{openSettings:d}=os(),i=Ie(),[c]=m.useState(()=>{const l=Ne.getCookie(Me.Workspace);return typeof l=="string"&&l!==ze}),r=O(),{store:o,actions:h}=Y(),x=o(l=>l.mode),[u,g]=m.useState(!0);if(m.useEffect(()=>{g(!1)},[]),!s&&u||c&&t)return null;const n=a?e.jsx(Ns,{}):e.jsx(Cs,{onClickSettings:()=>d()});return e.jsxs(P,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[n,i.get("include_floating_state",!1)&&e.jsx("div",{className:v.togglePinWrapper,children:e.jsx(xe,{tooltipSideOffset:14,className:v.pinSidebarAction,icon:e.jsx(cs,{}),onActivate:l=>{l.preventDefault(),l.persist(),D.togglePinSidebar(l,h,x===T.Floating?T.Pinned:T.Floating)},label:x===T.Floating?r.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):r.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:A.FloatingOrPinned})})]})}function Bs(){return e.jsx(P,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(Ms,{})})}function Hs(){return e.jsxs(ls,{className:j(v.screenTrailingBarContainer),children:[e.jsx(ds,{}),e.jsx(Bs,{}),e.jsx(Rs,{})]})}function Ds({onNewThread:s}){const t=O(),a=Fe(),{clientThreadId:d}=G(),i=us(d),c=i?ms(i):void 0,r=c?ce(c):void 0,o=re(c?.gizmo.id),h=t.formatMessage({id:"NUNaGU",defaultMessage:"New chat"});return e.jsx(_,{label:h,children:e.jsx(se,{to:r??"/",onClick:async x=>{x.preventDefault(),!o&&r!=null?fs(a,r):s()},tabIndex:-1,children:e.jsx(xs,{icon:e.jsx(le,{className:v.sidebarIcon}),className:v.searchAction,label:h,style:{viewTransitionName:"var(--vt_new_chat_sidebar)"}})})})}const Us=ne(()=>ae(()=>import("./khkqzplnchvr77nq.js"),__vite__mapDeps([9,1,2,3,4,10,11,12])).then(s=>s.FannyPackIconButton));function Ws({onNewThread:s}){const t=O(),a=m.useRef(null),{store:d,actions:i}=Y(),c=d(f=>f.isSidebarOpen),r=d(f=>f.mode),{isSidebarFlyoutOpen:o}=V(),h=o(p.Conversation),x=o(p.Gizmo),u=o(p.Snorlax),g=c&&!h&&!x&&!u;function n(){he(a.current)&&document.getElementById(A.OpenOrClosed)?.click()}hs({checkElement:f=>f?.tagName==="NAV",enabled:g,onLightDismiss:n});const{isFannyPackEnabled:l}=gs();return we(),e.jsxs(e.Fragment,{children:[e.jsx(P,{type:"primary",className:j(v.screenHeader),name:"sidebar-header",children:e.jsxs("div",{className:"flex min-h-[var(--screen-thread-header-min-height,60px)] w-full flex-1 items-center justify-between",ref:a,children:[e.jsx("div",{className:"grid items-center gap-1",children:e.jsx(xe,{className:j(v.closeSidebarAction),style:{viewTransitionName:"var(--vt_toggle_sidebar_opened)"},onClick:f=>{D.closeSidebar(f,i,r)},onActivate:f=>{D.closeSidebar(f,i,r)},icon:e.jsxs(e.Fragment,{children:[e.jsx(ps,{className:j(v.sidebarIcon,"hidden @lg/screen-composer:inline-flex")}),e.jsx(bs,{className:j(v.sidebarIcon,"@xs/screen-composer:inline-flex @lg/screen-composer:hidden")})]}),label:t.formatMessage(Ks.closeSidebar),htmlFor:A.OpenOrClosed,tooltipSideOffset:4})}),e.jsxs("div",{className:"flex items-center",children:[!1,l&&e.jsx(Ss,{children:e.jsx(Us,{className:v.searchAction,icon:e.jsx(vs,{className:v.sidebarIcon}),style:{viewTransitionName:"var(--vt_search_sidebar)"}})}),e.jsx(Ds,{onNewThread:s})]})]})}),e.jsx(P,{type:"primary",className:v.bucketBar,disableSizeTracking:!0,children:" "})]})}const Ks=ee({closeSidebar:{id:"fM0vj3",defaultMessage:"Close Sidebar"}});function $s(){const{clientThreadId:s,onNewThread:t}=G(),[a,d]=m.useState(!1),[i,c]=m.useState(!1),[r,o]=m.useState(!1),{store:h}=Y(),x=m.useCallback(n=>n===p.Conversation?a:n===p.Gizmo?i:n===p.Snorlax?r:!1,[a,i,r]),u=m.useCallback((n,l)=>{const f=b=>{n===p.Conversation?d(b):n===p.Gizmo?c(b):n===p.Snorlax&&o(b)};l?f(!0):setTimeout(()=>{f(!1)},100)},[]),g=m.useRef(null);return Es((n,l)=>{u(p.Conversation,!1),u(p.Gizmo,!1),u(p.Snorlax,!1);const f=window.matchMedia("(max-width: 700px)").matches,b=he(g.current);l!=null&&f&&h.getState().isSidebarOpen&&(h.getState().mode===T.Floating||b)&&setTimeout(()=>{document.getElementById(A.OpenOrClosed)?.click()},100)}),e.jsxs(js,{value:{isSidebarFlyoutOpen:x,onSidebarFlyoutOpenChange:u},children:[e.jsx(ys,{}),e.jsx(ks,{anchor:"vertical",className:j(v.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Ws,{onNewThread:t}),ref:g,trackLeading:!0,trailing:e.jsx(Hs,{}),children:e.jsx(Ps,{clientThreadId:s})})]})}export{$s as C,Ts as G,be as a};
//# sourceMappingURL=o9r2o80kulrb4gi5.js.map
