const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fvto8n68iuwh7hjr.js","assets/jkt8kpmqx1ob1zea.js","assets/root-ij0a8l2a.css","assets/j41xn51jmw95fwqz.js","assets/conversation-small-ile61fj8.css","assets/pcozscitvzhzxgrd.js","assets/67vo2vt3itcabkcg.js","assets/jf9ynkz99gydqdid.js","assets/odmcipi3ftfc0735.js","assets/ire8jlg5ci46112o.js","assets/m755pqu8akvq3cio.js","assets/izpgkl6t0zj5iap0.js","assets/gzuuwahacs3yploq.js","assets/ccp36hc00f4p68ex.js","assets/gefdkujkb9a5v91x.js","assets/4wmeimfd34hzuqi0.js","assets/ihv4f88fxb1c3wak.js","assets/bln7epkucv9y1wuf.js","assets/nsxw9dh6s2z9vzhy.js","assets/c4bxzbp1808foto4.js","assets/hfa1zklhthn8spsz.js","assets/ny5k9apfgmwn58qc.js","assets/igihqbjch5unxufh.js","assets/nbny4ol4qfnmo8ue.js","assets/o9r2o80kulrb4gi5.js","assets/blbd8ru4m21k2ais.js","assets/mkdtgufqp7mii6o2.js","assets/fpa07gapmotitepa.js","assets/fei7yw6r1nwdsbah.js","assets/l1icfmho2t7o0uae.js","assets/mzl14z8xmkwbit87.js","assets/nh1pk23dtwhv8swj.js","assets/fku9xtqs919trrkg.js","assets/j6zgnclmb2g3pe6k.js","assets/k3xn15d92y3wc574.js","assets/c6vv4keipixmtujc.js","assets/ltalebyeyj0cn2a4.js","assets/k7y4ylng04thty74.js","assets/hc1mo3fv9jy6yet7.js","assets/ko0sac5kvxzednxa.js","assets/izpqh1qyla6p395f.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/nlzjqb5fys1yuhid.js","assets/ip26muzciu3xe62q.js","assets/nuq1v2qi7rtf7pzi.js","assets/fk5ph3mdpjoxyxra.js","assets/feowrwav66vj0xhk.js"])))=>i.map(i=>d[i]);
import{aJ as he,hR as $r,m as e,r as i,P as Q,d as Z,b6 as H,bH as fo,aC as As,aD as it,hS as na,c_ as xo,c as Yr,j as Kr,dj as _e,bK as nn,L as fe,K as Pe,e7 as on,bq as De,aA as Ze,dq as _t,s as ee,o as ze,bv as Xr,aE as D,ec as Ge,cb as Qr,aL as Xt,bn as Rt,b3 as Le,b4 as Be,ai as jn,ba as Qt,eG as Zt,ae as an,bm as vo,gy as Zr,gw as Jr,f5 as ei,cH as ti,a5 as Rs,O as oa,aa,a9 as Cn,bF as ra,aw as ct,ev as si,gu as Mn,hT as ni,at as Qe,eQ as oi,bs as ws,cT as ai,cU as ri,cV as ii,bu as li,br as ci,ca as We,u as js,hU as di,ah as kt,hV as ui,V as de,cm as mi,D as rn,gF as ia,au as la,e6 as ca,ft as hi,a2 as gi,af as So,w as da,hW as pi,hX as fi,dY as Jt,gj as xi,hY as ua,b8 as Is,fZ as vi,gi as Ps,bi as Ve,ax as Tn,g$ as _n,y as kn,ad as Xe,bk as bo,az as rt,W as Nt,v as Si,n as Mt,gg as Nn,ee as bi,cX as yi,ed as Cs,b7 as wi,cK as ma,bS as ae,gq as ji,hZ as Ci,a4 as En,a7 as Zs,aI as ha,ek as Mi,h_ as yo,dh as Ti,ag as _i,fk as ga,Z as ki,h$ as Ni,fo as Ei,bL as Ai,i0 as wo,e4 as ln,eg as Ri,l as Ke,d3 as Ii,e5 as Ms,bA as ms,M as pa,aB as Pi,bc as Di,i1 as Li,f2 as Bi,cQ as Fi,i2 as Hi,bb as Ui,i3 as Oi,i4 as fa,h8 as Ds,N as An,i5 as zi,i6 as Gi,db as Wi,b5 as Vi,i7 as qi,fw as Ae}from"./jkt8kpmqx1ob1zea.js";import{aX as It,gN as $i,l$ as Yi,m0 as Ki,b0 as es,m1 as Xi,jD as xa,jG as va,ek as Qi,B as Zi,fk as Ji,jC as el,m2 as ye,m3 as Et,m4 as tl,m5 as sl,m6 as nl,m7 as ol,m8 as al,m9 as rl,ma as il,mb as ll,mc as cl,md as ne,me as Sa,mf as ba,c$ as dl,eW as ul,mg as ml,mh as hl,mi as gl,mj as pl,lG as fl,mk as ya,ml as xl,$ as vl,lE as Sl,kG as wa,it as bl,cL as At,mm as ja,mn as Ca,cH as Ls,bQ as qt,mo as Ts,mp as Oe,ie as Ma,mq as Ta,mr as yl,ms as wl,mt as _s,mu as jl,mv as Cl,mw as Ml,mx as Tl,em as _l,my as kl,mz as Nl,mA as El,mB as Al,mC as Rn,fr as In,mD as Rl,mE as Pn,i6 as Dn,i7 as lt,i8 as Ln,b_ as Il,mF as _a,lH as cn,mG as ka,mH as Pl,mI as ks,mJ as Dl,bC as Bn,bD as Na,dn as Ll,d7 as Bl,dp as Ea,J as Aa,bF as Bs,gS as ts,mK as jo,mL as Fl,mM as Hl,bK as Co,bH as Ul,ix as Ol,jM as Mo,mN as zl,mO as Gl,mP as Wl,mQ as Fn,mR as Vl,mS as ql,bO as Ra,g4 as Hn,fE as Un,mT as To,jf as $l,bG as Yl,mU as Kl,iA as Xl,jS as Ql,iB as Zl,iy as Jl,mV as ec,bI as dn,mW as tc,mX as sc,mY as nc,mZ as oc,cs as ac,ci as un,m_ as rc,fJ as On,U as Ns,c1 as zn,cO as ic,cG as Gn,m$ as lc,n0 as cc,n1 as dc,i9 as uc,n2 as mc,n3 as hc,n4 as gc,n5 as pc,n6 as fc,n7 as xc,dk as vc,is as Sc,l0 as bc,n8 as yc,n9 as wc,na as jc,cA as Ia,nb as Cc,ft as Wn,nc as Mc,fs as Tc,nd as _c,ne as kc,nf as mn,ng as Nc,nh as Ec,cJ as hn,ni as Ac,nj as Rc,nk as Ic,nl as Pa,iM as Vn,cM as $t,nm as Pc,nn as Dc,no as Lc,r as Bc,np as gn,i as Da,nq as _o,nr as Fc,b4 as Hc,ns as Uc,nt as Oc,cF as zc,nu as Gc,nv as Wc,cI as Fs,nw as Wt,ch as Vc,iP as qc,nx as $c,b3 as ko,du as La,dh as Yc,eJ as Kc,ny as Xc,b9 as qn,nz as $n,bE as Yn,ih as Qc,cz as Zc,dv as Jc,nA as ed,nB as td,aP as sd,nC as Ye,ej as nd,nD as od,nE as pn,nF as ad,nG as hs,nH as Ba,nI as rd,gA as id,nJ as ld,jg as gs,nK as cd,b6 as dd,cY as ud,nL as md,ff as hd,o as gd,nM as pd,nN as fd,fb as xd,nO as vd,nP as Sd,W as bd,nQ as yd,nR as Fa,nS as Ha,nT as Ua,nU as Oa,nV as Tt,eN as Kn,nW as wd,jU as jd,nX as za,nY as Cd,g7 as Es,nZ as fn,n_ as Md,n$ as Td,o0 as _d,o1 as kd,o2 as No,o3 as ps,c5 as Eo,ce as Ga,cf as Wa,gm as Va,go as qa,gK as Nd,o4 as Ed,gF as Ad,o5 as Rd,o6 as Id,o7 as Pd,o8 as Dd,o9 as Ld,bB as Bd,dj as Fd,g6 as Hd,c6 as Ud,oa as Od,gL as fs,gl as zd,gn as Gd,gw as Wd,ob as Vd,oc as qd,od as $d,oe as Yd,of as Kd,og as Xd,oh as Qd,oi as Zd,oj as Jd,ok as eu,bM as tu,kz as su,ky as nu,ol as ou,gY as au,om as ru,on as iu,oo as $a,_ as lu,fV as cu,hW as du,hX as uu,op as mu,oq as hu,or as Ya,bP as gu,os as Ka,ot as pu,ou as fu,ov as xu,O as vu,Q as Su,P as bu,R as yu,ow as wu,ox as Yt,fi as ju,c2 as Cu,c3 as Mu,ja as Tu,kE as _u,oy as ku,gU as Nu,oz as Eu,oA as Au,oB as Ru,oC as Iu,oD as Pu,oE as Du,V as Lu,kp as Bu,aR as xn,oF as Fu,fc as Hu,c4 as Uu}from"./j41xn51jmw95fwqz.js";import{B as Ou}from"./jf9ynkz99gydqdid.js";import{m as oe}from"./odmcipi3ftfc0735.js";import{C as vn,g as zu}from"./ire8jlg5ci46112o.js";import{S as Xa,a as Gu,b as Wu,G as Vu,L as qu,c as $u}from"./m755pqu8akvq3cio.js";import{g as Yu,h as Xn,s as Ku,i as Xu,j as xs,k as Qu,l as Zu,t as Ju,m as Hs,C as Qa,u as Za,n as em,o as tm,p as Qn}from"./izpgkl6t0zj5iap0.js";const Ao=he.div`m-8 flex flex-col items-center`;function Ro(t){return e.jsx(oe.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...t})}function sm({clientThreadId:t}){const o=$r(t)?.gizmoId,{data:n}=It(o);return o==null||n==null||!$i(n)?null:e.jsx(nm,{gizmoId:o})}function nm({gizmoId:t}){const[s,o]=i.useState(!1),[n,a]=i.useState(!1),r=Yi(t),c=async d=>{o(!0),setTimeout(()=>{a(!0)},5e3),Q.logEvent(Z.submitInlineRating,{gizmo_id:t,rating:d}),await r.mutateAsync({rating:d})},l=async()=>{a(!0),Q.logEvent(Z.dismissInlineRating,{gizmo_id:t}),await r.mutateAsync({})};return i.useEffect(()=>{n||Q.logEvent(Z.showInlineRating,{gizmo_id:t})},[n,t]),n?null:s?e.jsx(Ao,{children:e.jsxs(Ro,{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"rounded-lg border border-token-border-heavy p-4",children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(H,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),e.jsx(fo,{onClick:()=>{a(!0)}})]})}),e.jsx("div",{className:"text-xs text-token-text-tertiary",children:e.jsx(H,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):e.jsx(Ao,{children:e.jsxs(Ro,{className:"flex flex-col items-center gap-4 rounded-lg border border-token-border-heavy p-4",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(H,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),e.jsx(fo,{onClick:l})]}),e.jsx(Ki,{rating:void 0,onRating:c})]})})}const om=({clientThreadId:t})=>{const s=na(),o=As(t),n=it(o);i.useEffect(()=>{n&&xo.dismissBanner()},[n]);const a=s?.is_dismissible?()=>xo.dismissBanner():void 0;return e.jsx(es,{children:s&&e.jsx(oe.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:e.jsx(Xi,{clientThreadId:t,rateLimitInfo:s,onDismiss:a})})})};function am(t){const s=As(t),o=it(s),n=na();return!o&&n!=null}const Sn=window.sessionStorage,bn=Yr(Kr(()=>({memoryFullBannerDismissed:!!Sn?.getItem(nn.MemoryFullBannerDismissed)}))),Ja={dismissBanner(){bn.setState(t=>{t.memoryFullBannerDismissed=!0}),Sn?.setItem(nn.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){bn.setState(t=>{t.memoryFullBannerDismissed=!1}),Sn?.removeItem(nn.MemoryFullBannerDismissed)}};function rm(t){const s=_e(t),o=xa(),{data:n}=va(s,!1,o),a=n!=null,r=a&&n.memoryFullPct>=100,[c,l]=i.useState(!1);i.useEffect(()=>{!r&&a&&(l(!0),Ja.clearDismissedBanner())},[r,a]);const d=bn(m=>m.memoryFullBannerDismissed);return r&&c&&!d}function im(){const t=fe(),{openSettings:s}=Qi();return e.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(Zi,{title:t.formatMessage(vs.memoryFullTitle),content:t.formatMessage(vs.memoryFullTooltip,vs.memoryFullTooltip.values),primaryCtaText:t.formatMessage(vs.memoryManageButton),onPrimaryCtaClick:()=>s(Ji.Personalization),onDismiss:()=>Ja.dismissBanner()})})}const vs=Pe({memoryFullTitle:{id:"yRGU2/",defaultMessage:"Memory is full."},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"neUc+N",defaultMessage:"New memories won’t be created until you make space. <a>Learn more</a>",values:{a:t=>e.jsx("a",{href:el,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}}),lm=i.memo(function(s){return cm(s),dm(s),um(),null});function cm(t){const{store:s}=ye(),o=s.useSetSharedProps();on(()=>{o(t)},[t,o])}function dm(t){const{clientThreadId:s,canContinue:o}=t,{store:n}=ye(),a=i.useRef({top:n.useContentAreaApi(Et.HeaderTop),bottom:n.useContentAreaApi(Et.HeaderBottom)}).current,r=gm(t),c=tl(s),{shouldShowBannerSignup:l,shouldShowBannerTermsDisclaimer:d}=pm(s),m=am(s),u=sl(t),h=nl(t),g=ol(t),x=rm(s),v=al(),S=rl(t);on(()=>{S.eligible?a.top.set(ne.AdvancedVoiceOnMobileAnnouncement):v?a.top.set(ne.ParagenControls):d?a.top.set(ne.BannerTermsDisclaimer):m?a.top.set(ne.BannersRateLimit):u.eligible?a.top.set(ne.BannerSidekickAnnouncement):h?a.top.set(ne.SearchBrowserExtensionAnnouncement):g?a.top.set(ne.SearchBrowserExtensionReactiveAnnouncement):r?a.top.set(ne.ItemActions):o?a.top.set(ne.PromptTextareaAction):l?a.top.set(ne.BannerSignup):x?a.top.set(ne.BannerMemoryFull):a.top.set(null)},[a,r,o,d,l,m,u,x,v,S]),on(()=>{c&&a.bottom.set(Sa.DallePromptControls)},[a,c])}function um(){const{store:t}=ye();i.useEffect(()=>()=>{t.reset()},[t])}function mm(t){const s=ba(),o=Ze(t),n=ee.getTree(t).getLastValidNode(o)?.message?.id;return s?.messageId===n?s.suggestions:[]}function hm(t){return mm(t).length>0}function gm(t){const s=il(t.clientThreadId),o=hm(t.clientThreadId);return t.isDisabled?!1:t.isNewThread||s||o}function pm(t){const{isUnauthenticated:s}=De(),o=Ze(t),{layer:n}=_t("3637408529"),a=n.get("should_show_no_auth_signup_banner",!0),r=ll(g=>g.bannerDisclaimerClientThreadId),c=cl(),l={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1};if(!t)return l;const d=ee.getTree(t),m=d.countMessagesByAuthor(ze.User),u=d.getNodeByIdOrMessageId(o),h=u?.message?.author.role===ze.Assistant&&Xr(u.message);return l.shouldShowBannerTermsDisclaimer=h&&s&&m===1&&!c&&(r==null||r===t),l.shouldShowBannerSignup=a&&h&&s&&m>0&&m%5===0,l}function fm({children:t,className:s,showBackground:o}){return e.jsxs("div",{className:"relative",children:[t,o&&e.jsx(oe.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:D("pointer-events-none absolute bottom-0 top-0 h-8 w-8 rounded-full",s)})]})}function xm({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:o,modelSupportedImageMimeTypes:n,attachmentsProductFeature:a,getInputProps:r,openFileDialog:c,onOauthRedirect:l,historyDisabled:d,isDisabled:m,highlightTooltip:u}){const h=dl(),{gdriveStatus:g,o365Status:x}=ul(),v=e.jsx(gl,{className:d?"text-white":u?"text-brand-blue-800":void 0}),S=g!=="false"||x!=="false"||h;return e.jsx("div",{className:"relative",children:e.jsx(fm,{showBackground:u,className:"bg-brand-blue-800/20",children:S?e.jsx(ml,{clientThreadId:t,icon:v,modelAcceptedMimeTypes:o,modelSupportedImageMimeTypes:n,attachmentsProductFeature:a,onOauthRedirect:l,uploadType:s,openFileDialog:c,getInputProps:r,isDisabled:m,highlightTooltip:u}):e.jsx(hl,{clientThreadId:t,uploadType:s,openFileDialog:c,getInputProps:r,icon:v,isDisabled:m,highlightTooltip:u})})})}const vm=i.forwardRef(function({type:s,placeholder:o,replyRegions:n,state:a,renderFiles:r,leftSideActions:c,topRightAction:l,onSubmit:d,inputState:m,currentLeafId:u,composerController:h,clientThreadId:g,gizmoId:x,disableReason:v},S){const M=Ge(),b=pl();i.useEffect(()=>{fl()||h.focus()},[b?.modelId,h]);const N=w=>{Cm({target:w.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||h.focus()};return e.jsxs("div",{id:"composer-background",ref:S,className:D("flex w-full cursor-text flex-col rounded-3xl px-2.5 py-1 transition-colors contain-inline-size",M&&"backdrop-blur-2xl no-transparency:backdrop-blur-none",M&&s!=="temporary"&&"bg-token-composer-surface",!M&&s!=="temporary"&&"bg-[#f4f4f4] dark:bg-token-main-surface-secondary",s==="temporary"&&"dark bg-black"),onClick:N,children:[e.jsx(es,{initial:!1,children:n.length>0&&e.jsx(oe.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:e.jsx(bm,{replyRegions:n})})}),e.jsxs(e.Fragment,{children:[r,e.jsxs("div",{className:"flex min-h-[44px] items-start pl-2",children:[e.jsx("div",{className:"min-w-0 max-w-full flex-1",children:h instanceof ya?e.jsx(Sm,{composerController:h,currentLeafId:u,placeholder:o,inputState:m}):e.jsx(Yu,{composerController:h,placeholder:o})}),e.jsx("div",{className:"w-[32px] pt-1",children:l})]}),e.jsxs("div",{className:"flex h-[44px] items-center justify-between",children:[e.jsx("div",{className:"flex gap-x-1",children:c}),e.jsx(xl,{inputState:m,state:a,onSubmit:d,composerController:h,clientThreadId:g,gizmoId:x,disableReason:v})]})]})]})});function Sm({composerController:t,currentLeafId:s,placeholder:o,inputState:n}){const a=i.useContext(Qr);return e.jsxs(e.Fragment,{children:[e.jsx(vl,{id:Sl,autoFocus:!0,tabIndex:0,"data-id":s,dir:"auto",ref:r=>{if(!(t instanceof ya))throw new Error("Expected TextAreaComposerController");r!=null&&(t.textArea=r,t.logPageMount())},rows:1,placeholder:o,disabled:n!=="default",className:D("m-0 resize-none border-0 bg-transparent px-0 text-token-text-primary focus:ring-0 focus-visible:ring-0",n==="disabled"&&"text-center",["max-h-[25dvh]","max-h-52"])}),e.jsx("script",{nonce:a.cspScriptNonce,suppressHydrationWarning:!0,children:"requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI??Date.now()}))"})]})}function bm({replyRegions:t}){return e.jsx("div",{className:"flex cursor-auto flex-col divide-y divide-token-border-light overflow-hidden rounded-b-lg rounded-t-[20px] bg-token-main-surface-primary",children:t.map((s,o)=>{switch(s.type){case"text":return e.jsx(ym,{value:s.value,onRemoveRegion:s.onRemoveRegion},o);case"object":return e.jsx(wm,{value:s.value,onRemoveRegion:s.onRemoveRegion},o);case"mention":case"system_hint":return e.jsx(jm,{value:s.value,icon:s.icon,onRemoveRegion:s.onRemoveRegion},o)}})})}function ym({value:t,onRemoveRegion:s}){return e.jsxs(Jn,{className:"text-token-text-secondary",children:[e.jsx(eo,{children:e.jsx(wa,{className:"icon-lg-heavy"})}),e.jsx(to,{children:`“${t}”`}),e.jsx(Zn,{onClick:s})]})}function wm({value:t,onRemoveRegion:s}){return e.jsxs(Jn,{className:"text-blue-selection",children:[e.jsx(eo,{children:e.jsx(wa,{className:"icon-lg-heavy"})}),e.jsx(to,{className:"font-semibold",children:t}),e.jsx(Zn,{onClick:s})]})}function jm({value:t,icon:s,onRemoveRegion:o}){return e.jsxs(Jn,{children:[e.jsx(eo,{className:"mt-0",children:s}),e.jsx(to,{className:"font-semibold text-token-text-primary",children:t}),e.jsx(Zn,{onClick:o})]})}function Zn({onClick:t}){return e.jsx("button",{onClick:t,type:"button",className:"flex-shrink-0 text-token-text-secondary",children:e.jsx(bl,{className:"icon-lg"})})}const Jn=he.div`flex items-start py-2.5 gap-3 pl-3 pr-1.5 text-sm`,eo=he.span`flex-shrink-0 mt-0.5 w-7 h-6 flex justify-center items-center`,to=he.span`flex-1 line-clamp-3 py-0.5`;function Cm({target:t,rootId:s,additonalInteractiveIds:o}){let n=t;for(;n&&n!=null;){if(n.tagName==="BUTTON"||n.tagName==="INPUT"||n.tagName==="TEXTAREA"||n.isContentEditable||o.includes(n.id))return!0;if(n.id===s)return!1;n=n.parentElement}return!1}const Ss={initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:.1},exit:{opacity:0,scale:.5,transition:{duration:.2}}},Mm=({suggestions:t,onSelectingSuggestedReply:s})=>e.jsx("div",{className:"absolute bottom-full flex w-full max-w-[100vw] grow gap-2 overflow-auto px-1 pb-1 contain-inline-size sm:mb-0 sm:justify-start sm:px-2 sm:pb-0 md:static md:mb-2 md:max-w-none md:justify-center md:overflow-visible",children:t.slice(0,2).map((o,n)=>e.jsx(oe.div,{initial:Ss.initial,animate:Ss.animate,transition:{delay:(n-1)*Ss.transition.delay},exit:Ss.exit,children:e.jsx(Rt,{as:"button",color:"secondary",size:"small",onClick:()=>{s(o,t,n)},className:"group whitespace-nowrap md:whitespace-normal",children:e.jsx(_m,{suggestion:o})},n)},n))});function Tm({suggestions:t,onSelectingSuggestedReply:s,clientThreadId:o}){const n=t?.length>0;i.useEffect(()=>{n&&At(t,o)},[n,o]);const{isUnauthenticated:a}=De();return n?t.every(ja)?e.jsxs(oe.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col items-center",children:[a&&e.jsx(Xt,{className:"mb-6 h-12 w-12 sm:hidden"}),e.jsx(Xa,{starterPrompts:t,onSelectStarterPrompt:s})]}):t.every(Ca)?e.jsx(Mm,{suggestions:t,onSelectingSuggestedReply:s}):null:null}function _m({suggestion:t}){return Ca(t)?e.jsx(e.Fragment,{children:t.text}):ja(t)?e.jsxs("div",{className:"flex flex-col overflow-hidden",children:[t.title&&e.jsx("div",{className:"truncate font-semibold",children:t.title}),e.jsx("div",{className:D("truncate font-normal",t.title?"opacity-50":""),children:t.body})]}):null}function km(){const{store:t}=ye(),s=t.useSharedProps();return s?e.jsx(Nm,{...s}):null}function Nm({clientThreadId:t,suggestions:s}){const o=Ls();return s===void 0||s.length===0?null:e.jsx("div",{children:e.jsx(Em,{children:e.jsx("div",{className:"grow",children:s!==void 0&&e.jsx(Tm,{suggestions:s,onSelectingSuggestedReply:o,clientThreadId:t})})})})}const Em=he.div`h-full flex ml-1 md:w-full md:m-auto gap-0 md:gap-2 justify-center`,er=({className:t,children:s})=>e.jsx(oe.div,{className:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:s});function Am({currentLeafId:t,canContinue:s,onContinueGenerating:o}){const n=i.useCallback(()=>{const r=new qt;o(t,r),Ts()},[o,t]);let a=null;return s&&(a=e.jsx(Im,{onHandleContinueGenerating:n})),a&&e.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:a})}function Rm({className:t}){return e.jsx(Ma,{className:D("-rotate-180",t)})}const Im=({onHandleContinueGenerating:t})=>e.jsx(er,{children:e.jsx(Rt,{as:"button",color:"secondary",onClick:t,className:"whitespace-nowrap py-2",icon:Rm,size:"small",children:e.jsx(H,{...Oe.continueGenerating})})}),Pm=()=>{const{shouldShowSkipButton:t}=Ta();return t?e.jsx(er,{className:"flex justify-center",children:e.jsx(Rt,{as:"button",color:"secondary",onClick:()=>yl.skipParagen(),children:e.jsx(H,{...Dm.skip})})}):null},Dm=Pe({skip:{id:"dvcUbp",defaultMessage:"Skip"}}),tr=i.memo(function({className:s}){const{store:o}=ye(),n=o.useIsHeaderContentAreaPopulated();return e.jsx("div",{className:D(s??"absolute bottom-full left-0 right-0",_s.PromptTextareaHeader),children:e.jsx(wl,{shouldRender:n,contentArea:Et.Header,children:e.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[e.jsx(sr,{}),e.jsx(nr,{})]})})})});function sr(){const{store:t}=ye(),s=t.useSharedProps(a=>a?.clientThreadId),o=t.useContentAreaId(Et.HeaderTop);let n;switch(o){case ne.AdvancedVoiceOnMobileAnnouncement:n=e.jsx(Tl,{clientThreadId:s});break;case ne.ParagenControls:n=e.jsx(Pm,{});break;case ne.ItemActions:n=e.jsx(km,{});break;case ne.BannerSignup:n=e.jsx(Fm,{});break;case ne.BannerTermsDisclaimer:n=e.jsx(Hm,{});break;case ne.PromptTextareaAction:n=e.jsx(Um,{});break;case ne.BannersRateLimit:n=e.jsx(Om,{});break;case ne.BannerSidekickAnnouncement:n=e.jsx(Ml,{});break;case ne.SearchBrowserExtensionAnnouncement:n=e.jsx(Cl,{});break;case ne.SearchBrowserExtensionReactiveAnnouncement:n=e.jsx(jl,{});break;case ne.BannerMemoryFull:n=e.jsx(im,{});break;case ne.Box:n=e.jsxs("div",{className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",e.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;default:n=null;break}return n}function nr(){const{store:t}=ye(),s=t.useContentAreaId(Et.HeaderBottom);let o;switch(s){case Sa.DallePromptControls:o=e.jsx(Bm,{});break;default:o=null;break}return o}const Lm=Le(()=>Be(()=>import("./fvto8n68iuwh7hjr.js"),__vite__mapDeps([0,1,2,3,4,5])).then(t=>t.default));function Bm(){const{store:t}=ye(),s=t.useSharedProps(o=>o?.composerController);return s?e.jsx(Lm,{composerController:s}):null}function Fm(){const{store:t}=ye(),s=t.useSharedProps(a=>a?.clientThreadId),o=_l(),n=kl();return s?o?e.jsx(Nl,{threadId:s,showSignUp:n}):e.jsx(El,{threadId:s,showLogin:n}):null}function Hm(){const{store:t}=ye(),s=t.useSharedProps(o=>o?.clientThreadId);return s?e.jsx(Al,{threadId:s}):null}function Um(){const{store:t}=ye(),s=t.useSharedProps();return s?e.jsx(Am,{...s}):null}function Om(){const{store:t}=ye(),s=t.useSharedProps(o=>o?.clientThreadId);return s?e.jsx(om,{clientThreadId:s}):null}function zm({composerController:t,isDisabled:s,highlightTooltip:o,clientThreadId:n}){const{setThreadSearchMode:a}=Rn(),r=In(),c=Rl(),[l,d]=i.useState(!1),m=fe(),u={clientThreadId:n};return e.jsx(Wm,{highlightTooltip:o,analyticsMetadata:u,isThreadUsingSearchMode:r,isDisabled:s,children:e.jsxs("button",{className:D("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold",l&&"transition-all duration-150",r||o?"!rounded-2xl bg-blue-250 text-blue-1000 hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:hover:bg-[#1A416A]":s?"opacity-30":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-pressed":r,"aria-label":m.formatMessage({id:"Sl1VH/",defaultMessage:"Search the web"}),disabled:s,onTransitionEnd:()=>d(!1),onClick:h=>{h.stopPropagation(),h.preventDefault(),d(!0),Q.logEventWithStatsig(Z.composerSearchButtonClicked,"composer_search_button_clicked",u),a(!r,u,jn.CONVERSATION_COMPOSER_WEB_ICON),/^search\s?$/i.test(t.getCurrentText())&&t.setText(""),t.replaceSlashCommandTokensWithText(),t.focus()},children:[e.jsx(Pn,{}),e.jsx(es,{children:r&&e.jsx(oe.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:c?0:.15},children:e.jsx("div",{className:"whitespace-nowrap pl-1 pr-2",children:e.jsx(H,{id:"TbHx8d",defaultMessage:"Search"})})})})]})})}function Gm(){const t=Dn(lt.hasSeenComposerSearchButtonTooltip);return!t.isLoading&&t.eligible}function Wm({children:t,highlightTooltip:s,analyticsMetadata:o,isThreadUsingSearchMode:n,isDisabled:a}){const r=Gm()&&!n,c=Dn(lt.hasSeenComposerSearchButtonTooltip);return r?e.jsx(Ln,{announcementKey:lt.hasSeenComposerSearchButtonTooltip,side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(H,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:c.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(H,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:e.jsx(Il,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:e.jsx(H,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:e.jsx("div",{children:t})}):e.jsx("div",{children:e.jsx(Qt,{sideOffset:0,label:a?e.jsx(H,{id:"GpDAWD",defaultMessage:"Search is unavailable"}):e.jsx(H,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"right",open:s||(n?!1:void 0),onOpenChange:l=>{l&&Q.logEventWithStatsig(Z.composerSearchButtonHovered,"composer_search_button_hovered",o)},children:t})})}function Vm({composerController:t,clientThreadId:s}){const o=Zt(s),{setThreadSearchMode:n}=Rn(),r=_a().size>0,c=cn(s,an.Search),l=ka(s),[d,m]=i.useState([]),[u,h]=i.useState(void 0),[g,x]=i.useState(0);i.useEffect(()=>{m(u?l.filter(j=>j.name.toLocaleLowerCase().startsWith(u.text.toLocaleLowerCase())||j.systemHint.toLocaleLowerCase().startsWith(u.text.toLocaleLowerCase())):[])},[u]),i.useEffect(()=>{const j=E=>{h(A=>ti(A,E)?A:E)};t.view.dispatch(Ku(t.view.state.tr,{onHintMatch:j}))},[t]);const v=r||!l.length||!d.length||!u;i.useEffect(()=>{v&&x(0)},[v]);const S=d.length,M=i.useCallback(j=>{x(E=>(j(E)%S+S)%S)},[S]),b=d[g],N=({hintToSave:j=b,expectPerfectMatch:E,appendSpace:A=!0})=>{if(!u||!b||E&&j.name.toLowerCase()!==u.text.toLowerCase())return;Q.logEvent(Z.systemHintSelected,{system_hint:j.systemHint,conversation_id:o??vo});const F=u.text+j.name.slice(u.text.length),p={clientThreadId:s};Qu(t.view,{id:j.systemHint,hint:F},u.range,A,c,L=>n(L,p,jn.CONVERSATION_COMPOSER_SLASH_SEARCH)),xs(t.view)},w=i.useRef(N);w.current=N;const y=i.useRef(M);y.current=M;const _=i.useRef(u);_.current=u;const I=t.view;return i.useEffect(()=>(v||Xu(I,j=>{j==="up"?y.current(E=>E-1):j==="down"?y.current(E=>E+1):j==="cancel"?(xs(I),Zu(I)):j==="submit"?(w.current({expectPerfectMatch:!1}),xs(I)):j==="checkMatch"&&w.current({expectPerfectMatch:!0,appendSpace:!1})}),()=>xs(I)),[v,I]),i.useEffect(()=>{v||Q.logEvent(Z.systemHintListOpened,{conversation_id:o??vo})},[v]),v?null:e.jsx(Zr,{className:"max-w-60",onMouseDown:j=>{j.preventDefault()},children:d.map((j,E)=>e.jsx("div",{onMouseOver:()=>x(E),onClick:()=>{N({hintToSave:j,expectPerfectMatch:!1}),t.focus()},children:e.jsx(Jr,{autoFocus:!1,className:"group rounded-lg px-1 py-2 hover:bg-token-hint-text",$spoofHovered:E===g,children:e.jsx(qm,{title:j.name,description:j.description,icon:e.jsx(Pl,{svgString:j.logo,className:"icon-lg text-token-text-secondary group-hover:text-white"}),checked:!1})})},j.systemHint))})}function qm({title:t,description:s,icon:o,checked:n}){return e.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-1.5 pl-1.5 pr-3",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:o}),e.jsxs("div",{className:"shrink grow basis-0",children:[e.jsx("p",{className:"text-sm font-normal leading-tight text-token-text-primary group-hover:text-white",children:t}),!!s&&e.jsx("p",{className:"text-[13px] font-normal leading-[18px] text-token-text-secondary group-hover:text-white",children:s})]}),n&&e.jsx(ei,{className:D("icon-md text-token-text-primary",{"group-hover:hidden":!n})})]})}function $m({composerController:t,clientThreadId:s}){return t instanceof Xn?e.jsx(Vm,{composerController:t,clientThreadId:s}):null}function Ym({suggestions:t,composerController:s,onSelect:o,onChange:n}){const a=Ls(),r=i.useCallback((u,h,g)=>{o?.(u,h,g),a(u,h,g)},[o,a]),[c,l]=i.useState(-1),[d,m]=i.useState(!1);return i.useEffect(()=>{const u=h=>{if(h.key==="ArrowDown"){const g=c===t.length-1?0:c+1;l(g),n?.(g,!0,t[g])}else if(h.key==="ArrowUp"){h.preventDefault();const g=c<=0?t.length-1:c-1;l(g),n?.(g,!0,t[g])}else h.key==="Enter"&&!h.shiftKey&&t[c]&&r(t[c],t,c)};return s.subscribe("keydown",u)},[t,c,n,r,s]),i.useEffect(()=>s.subscribe("blur",()=>{l(-1),n?.(-1,!1)}),[s,n]),i.useEffect(()=>{if(!d){const u=()=>{m(!0),window.removeEventListener("mousemove",u)};return window.addEventListener("mousemove",u),()=>{window.removeEventListener("mousemove",u)}}},[d]),i.useEffect(()=>{l(-1),n?.(-1,!1),m(!1)},[t,n]),e.jsx(oe.ul,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hidden w-full flex-col p-2.5 group-focus-within:flex group-focus-within:max-lg:flex-col-reverse",children:t.map((u,h)=>e.jsxs(oe.li,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:h*.03},exit:{opacity:0,translateY:4},className:"w-full",children:[h>0&&e.jsx("div",{className:D("h-[1px] opacity-60 max-lg:hidden",c===h||c===h-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")}),e.jsxs("button",{className:D("flex w-full cursor-pointer items-center justify-start whitespace-pre-wrap rounded-lg px-2.5 py-3 text-start",c===h?"bg-token-main-surface-secondary":"bg-token-main-surface-primary"),onClick:g=>{g.preventDefault(),r(u,t,h)},onMouseDown:g=>{g.preventDefault()},onMouseEnter:()=>{d&&(l(h),n?.(h,!1,u))},onMouseLeave:()=>{l(-1),n?.(-1,!1,u)},children:[u.icon?e.jsx("span",{className:"mr-4 h-6 w-6 text-token-text-secondary",children:u.icon}):null,e.jsx("span",{className:"whitespace-pre-wrap",children:u.autocompletionChunks&&u.autocompletionChunks.length>0?e.jsx(e.Fragment,{children:u.autocompletionChunks.map((g,x)=>e.jsx("span",{className:D(g.isMatched?"text-token-text-tertiary":"text-token-text-primary"),children:g.text},x))}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:D(u.type===ks.Starter?"text-token-text-secondary":"text-token-text-tertiary"),children:u.title}),e.jsx("span",{className:"text-token-text-primary",children:u.body})]})})]}),h>0&&e.jsx("div",{className:D("h-[1px] opacity-60 lg:hidden",c===h||c===h-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")})]},u.id??h))})}function Km(t,s){t=t.toLocaleLowerCase();const o=s;s=s.toLocaleLowerCase();const n=[];let a=0;for(let l=0;l<s.length&&(a<t.length&&t[a]===s[l]&&(n.push(l),a++),a!==t.length);l++);const r=[];let c=0;if(n.forEach(l=>{if(l>c){const d=o.slice(c,l);d&&r.push({text:d,isMatched:!1})}r.push({text:o[l],isMatched:!0}),c=l+1}),c<s.length){const l=o.slice(c);l&&r.push({text:l,isMatched:!1})}return Xm(r)}function Xm(t){if(t.length===0)return t;let s=[t[0]];for(let n=1;n<t.length;n++){const a=s[s.length-1],r=t[n];a.isMatched===r.isMatched?a.text+=r.text:s.push(r)}const o=s.filter(n=>n.isMatched).reduce((n,a)=>n+a.text.trim().length,0);return s.length<=4&&o>=2?s:[{text:s.map(n=>n.text).join(""),isMatched:!1}]}function Qm({composerController:t,isDisabled:s,clientThreadId:o}){const n=fe(),a=Dn(lt.hasSeenComposerSystemHintButtonTooltip),c=ka(o).length>0,d=_a().size>0,m=s===!0||!c||d;if(!(t instanceof Xn))return null;const u=t,h={clientThreadId:o};function g(){Q.logEventWithStatsig(Z.composerSystemHintButtonClicked,"composer_system_hint_button_clicked",h),a.markAsViewed(),u.focus(),Ju(u.view)}const x=e.jsx("button",{className:D("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold",m?"opacity-30":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-label":n.formatMessage({id:"oDAnGy",defaultMessage:"Use a tool"}),disabled:m,onPointerDown:g,onMouseDown:v=>{v.preventDefault()},onClick:v=>{v.preventDefault(),v.detail===0&&g()},children:e.jsx(Dl,{})});return!a.isLoading&&a.eligible?e.jsx(Ln,{announcementKey:lt.hasSeenComposerSystemHintButtonTooltip,show:!0,side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(H,{id:"tTydhk",defaultMessage:"All your tools, in one handy place"}),onDismiss:a.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(H,{id:"S+BFNe",defaultMessage:"Create a canvas, generate a picture, and more."}),children:x}):e.jsx(Qt,{side:"right",sideOffset:0,label:s?e.jsx(H,{id:"uw9x80",defaultMessage:"Tools unavailable"}):e.jsx(H,{id:"mrYNGk",defaultMessage:"View tools"}),onOpenChange:v=>{v&&Q.logEventWithStatsig(Z.composerSystemHintButtonHovered,"composer_system_hint_button_hovered",h)},children:x})}const Zm=1,Jm=3e3;function eh({files:t,className:s}){const o=Gn(),n=Na(),a=fc();return e.jsxs("div",{className:s,children:[a.map(r=>{const{tempId:c}=r;return e.jsx(xc,{pastedTextdoc:r,textdocId:c},c)}),t.map(r=>e.jsx(vc,{borderRadius:"2xl",useV2Style:!0,width:o?"normal":"wide",onRemoveFileClick:()=>dn.remove(n,r.tempId,"none"),file:r.file,fileId:r.fileId??void 0,contextConnectorInfo:r.contextConnectorInfo,loadingPercentage:r.status===Sc.Uploading?r.progress:void 0},r.tempId))]})}function th({onAbortCompletion:t,onCreateNewCompletion:s,onContinueGenerating:o,currentModelId:n,clientThreadId:a,isNewThread:r,isCompletionInProgress:c,className:l,disabled:d=!1,disabledReason:m,canPause:u=!1,canContinue:h=!1,suggestions:g,isInteractableSharedThread:x,composerContainerRef:v,autocompletions:S,requiresFileUpload:M,onComposerInput:b,onComposerChange:N,onAutocompleteSelect:w,headerClassName:y,hideHeader:_,setComposerBarElement:I,onTaggingDropdownOpen:j,onTaggingDropdownClose:E}){const A=i.useRef(null),F=bc(A,I),p=Hs(),L=Bn(),C=Rs(),{isUnauthenticated:B}=De(),U=fe(),k=oa(),R=Na(),f=Ze(a),O=As(a),[$]=aa(),te=Cn(),{gizmoEditorData:W,mode:xe,getGizmoId:re}=Ll(),J=ra(),ue=Bl(),we=ct(),Fe=Ea(),ie=Zt(a),ge=!!si(),je=!!Mn(),[ve,Re]=i.useState({}),{setThreadSearchMode:Ie,clearSearchModeTrigger:He,getSearchModeTrigger:V}=Rn(),P=In(),[Y,q]=i.useState(!1),[z,X]=i.useState(!1),Se=Ge(),pe=i.useRef(!1),Ce=Aa(),le=n!==null?Ce[n]:void 0,Me=ni(a);let K=Bs(a),Te=K&&"gizmo"in K?K.gizmo:void 0;const Ue=ts(Te?.gizmo.id),[se,dt]=i.useState(null);se!==null&&(K={gizmo:se,gizmo_id:se.gizmo.id,kind:Qe.GizmoInteraction},Te=se);const ut=jo(le,K);let mt=!1;Fl(K)&&Te?.gizmo.id===Hl&&(mt=!0);const Us=oi(),Pt=!d&&!mt&&ut!==Co.None&&!B,qe=Ul(le,K),ht=Ol(le,K);let ke=Mo(T=>T.files);const[gt]=i.useState(()=>zl());xe==="magic"?ke=ke.filter(T=>T.gizmoId!=null):ke=ke.filter(T=>T.gizmoId==null);const ss=Gl(),pt=ke.length>0||ss,Dt=Mo(yc.hasUploadInProgress),Lt=p.useState(T=>{const ce=Wl(T);return typeof le?.maxTokens=="number"&&ce>le.maxTokens}),Bt=p.useState(T=>!T.isEmpty()),ft=!Lt&&!Dt&&(Bt||pt);Fn(ke.length>0||Dt||Bt);const Je=(ut===Co.Multimodal?Vl:ql)-ke.length,Ft=Je<=0,$e=ft&&!d&&!c&&!je,[et,Os]=i.useState(!1),xt=Ra(),vt=n||xt.id,St=cn(a,an.Search),bt=!d&&(!Te||Ue)&&J?.includes(ws.SearchTool)&&(J?.includes(ws.BrowsingAvailable)||!C?.isEnterprisey()),Ht=bt&&St,zs=Ce[vt]?.tags,{targetedContent:Gs,setTargetedContent:tt}=Hn(),Ne=Gs?.isFocusedViewContent&&!Fe?void 0:Gs,{rebaseSystemMessageContent:ns}=Un();i.useEffect(()=>{if(!L?.id)return;const T=To.getAndReset(L?.id,ie);T&&p.setText(T.inputText)},[L?.id,ie,p]),i.useEffect(()=>{et!==$e&&(Os($e),$e&&ai(!0).then(T=>{ri.startEnforcement(T),$l.startEnforcement(T),ii.startEnforcement(T)}))},[$e,et,K?.kind,J]);const yt=Yl(le,K),{handleFileAccepted:no}=Kl(U,jo(le,K),qe,"mouse",re,yt?.attachments),{getInputProps:Ws,open:Vs}=Xl({disabled:d||!Pt||Ft,noClick:!0,onDropAccepted:no,onDropRejected:T=>Ql(T,U,k,ut),multiple:!0,maxSize:Zl,maxFiles:Je,...Jl(ht)}),os=li(gt),as=i.useCallback(()=>{p.eraseContent(),os.clearMessages(),p.resize(Zm),ee.clearOverrideModelId(a),ec();for(const T of ke)dn.remove(R,T.tempId,"none");tc.markAllAsSent()},[p,os,ke,R,a]),wt=async(T,ce)=>{if(T?.preventDefault(),d||!ft&&!ce||!K||kt.isLoading(a)!==!1)return;const Ee=new qt;q(!0);const be=p.getContentToSend(),nt=wc(be.content),Ks=`${f}-nextPrompt`,zt=new jc(Ia.CompletionRequest,{expectedTimingLogs:[{name:"prompt_submitted",expectedInMs:3e3}]}),{content:Vr,attachments:uo}=Cc(R,nt,le,K),mo=[],Xs=[];ns&&Xs.push(ui(ns));const Qs={...K};"gizmo"in Qs&&delete Qs.gizmo;let us=p.getSystemHints();P&&(us=[Wn.Search]);const ho=V(),qr=P?ho??jn.CONVERSATION_COMPOSER_WEB_ICON:void 0,go=Mc(),po=Tc();let Gt={promptId:Ks,content:Vr,eventMetadata:{eventSource:T?"mouse":"keyboard"},completionMetadata:{suggestions:g,conversationMode:Qs,systemHints:us,searchSource:qr},messageMetadata:{...uo.length>0&&{attachments:uo},...se&&{gizmo_id:se?.gizmo.id},...ve,...us.length>0&&{system_hints:us},...!!be.metadata&&{serialization_metadata:be.metadata},...go.length>0&&{canvas:{pasted_textdocs:go}},...Object.keys(po).length>0&&{__internal:{search_settings:po}}},prependMessages:mo.length>0?mo:void 0,appendMessages:Xs.length>0?Xs:void 0,turnTracker:Ee,profiler:zt,requestedModelId:Me};Gt=_c(Gt),Ne?.createNewCompletionParams&&(Gt=await Ne.createNewCompletionParams(Gt)),zt.logTiming("request_params_ready"),await s(Gt),Ne?.onCreateCompletion?.({serverThreadId:ie,currentLeafId:f}),Ne?.shouldPersistAcrossMessages!==!0&&tt(void 0),Ns.hideThreadHeader(),as(),q(!1),zt.logTiming("prompt_submitted"),g!==void 0&&(de.logEvent("chatgpt_prompt_ignore_suggestions"),Q.logEvent(Z.promptIgnoreSuggestions)),P&&ho&&He()},qs=i.useRef(wt);i.useEffect(()=>{qs.current=wt});const $s=T=>{tt(T.targetedReply),T.targetedReply&&(p.focus(),Q.logEvent(Z.targetedReplyButtonClicked,{conversationId:ie,sourceMessageId:T.messageId}))},rs=i.useCallback(()=>{Ne?.onCleared?.({serverThreadId:ie,currentLeafId:f}),tt(void 0),p.focus()},[f,ie,Ne,tt,p]),is={Enter:{validator:T=>{const ce=T.isComposing||T.keyCode===229;return!(z&&pe.current)&&(T.metaKey||(ue||mi)&&!T.shiftKey&&!ce)},handler:T=>{if(!$e){Lt&&k.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}T.preventDefault(),wt()}},Escape:{validator:T=>!T.isComposing,handler:T=>{u&&c&&(t("",O),Q.logEvent(Z.pauseCompletion,{threadId:ee.getServerThreadId(a),currentLeafId:ee.getTree(a).getMessageId(f),eventSource:"keyboard"})),T.target.value===""&&rs()}}},G=i.useRef(is);G.current=is;const me=sc(zs,K?.kind),[st,jt]=i.useState(!1),[Ut,oo]=i.useState(!1),ls=me&&st&&!Ue,ao=p.isReady();i.useEffect(()=>p.subscribe("keydown",T=>{p.acceptLegacyKeydown()&&G.current[T.key]?.validator(T)&&G.current[T.key].handler(T);const Ee=p.getCurrentText();if(T.key==="@"){const be=p.getSelectionStart(),nt=Ee.substring(0,be);(!nt||/\s$/.test(nt)||be===0)&&setTimeout(()=>jt(!0),10)}else st&&jt(!1);if(T.key==="Escape"&&(dt(null),X(!1)),Ht&&!P){let be;T.key==="Backspace"?be=Ee.substring(0,Ee.length-1):be=Ee+T.key,/^search\s?$/i.test(be)?oo(!0):Ut&&oo(!1)}P&&T.key==="Escape"&&Ie(!1,{clientThreadId:a})}),[p,ao,st,Ut,Ht,P,Ie,a]),i.useEffect(()=>{const T=Object.fromEntries(Object.keys(G.current).map(ce=>[ce,be=>{const nt=G.current[ce];if(!nt||p.acceptLegacyKeydown())return!1;const{validator:Ks,handler:zt}=nt;return Ks(be)?(zt(be),!0):!1}]));p.registerKeyHandlers(T)},[p,ao]),i.useEffect(()=>p.subscribe("paste",T=>{nc({filePickerStore:R,event:T,intl:U,toaster:k,clientThreadId:a,conversationMode:K,currentModelConfig:le,getEditorGizmoId:re,modelSupportedImageMimeTypes:qe})}),[U,a,K,le,re,qe,p,k,R]);const yr=T=>{ge||dt(T),p.trimLeadingText("@"),Ts(),jt(!1)},wr=oc(a,gt,qe,yt?.attachments),jr=i.useCallback(T=>{T?.preventDefault(),t("",O),Q.logEvent(Z.pauseCompletion,{threadId:ee.getServerThreadId(a),currentLeafId:ee.getTree(a).getMessageId(f),eventSource:"mouse"}),Ts()},[t,a,O,f]),ro=i.useCallback(()=>{To.set(L?.id,ie,p.getCurrentText())},[ie,L?.id,p]);i.useEffect(()=>{W||!Y&&!ac()&&p.focus()},[Y,p]),i.useEffect(()=>{W||dn.reset(R)},[n,R,W]),i.useEffect(()=>{(!me&&se||ge)&&dt(null)},[me,se,ge]);const[Cr,Mr]=(()=>{switch(m){case"workspaceDisallowsGizmo":return[Oe.disallowedByWorkspacePlaceholder,!0];case"feedbackRequired":return[Oe.disabledFeedbackPlaceholder,!0];case"noModelsAvailable":return[Oe.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[Oe.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[Oe.loading,!0];case"noTestGizmoId":return[Oe.noTestGizmoId,!0];default:return x?[Oe.placeholderWithName,!1]:Ne?.placeholderTextOverride!=null?[Ne.placeholderTextOverride,!1]:[Oe.placeholderWithName,!1]}})(),Tr=Ue&&r?U.formatMessage(un.newChatInProject):U.formatMessage(Cr,{name:W!=null?xe==="magic"?rc:W.name||"GPT":Te?.gizmo.display.name??"ChatGPT"});i.useEffect(()=>p.subscribe("input",()=>{On.getState().isThreadHeaderVisible&&Ns.hideThreadHeader(),X(!0)}),[p]),i.useEffect(()=>{if(b)return p.subscribe("input",()=>{b?.()})},[p,b]),i.useEffect(()=>{if(N)return p.subscribe("change",()=>{N?.()})},[p,N]),i.useEffect(()=>p.subscribe("focus",()=>{X(!0)}),[p]);const io=K?.kind===Qe.PrimaryAssistant&&!P,_r=ci(ws.CanvasOptIn),{layer:kr}=We("4211831761"),{value:Nr}=js("3131522605"),Er=Nr||kr.get("enable",!1)||_r,Ar={clientThreadId:a,uploadType:ut,modelAcceptedMimeTypes:ht,modelSupportedImageMimeTypes:qe,attachmentsProductFeature:yt?.attachments,getInputProps:Ws,openFileDialog:Vs,historyDisabled:we,onOauthRedirect:ro,highlightTooltip:M&&!pt},cs=[],Rr=!d&&!Ft&&(Pt||Us!=null)&&!P;cs.push(e.jsx(xm,{...Ar,isDisabled:!Rr},"file-upload-button")),Er&&cs.push(e.jsx(Qm,{composerController:p,clientThreadId:a,isDisabled:!io},"system-hint-button")),bt&&cs.push(e.jsx(zm,{composerController:p,highlightTooltip:Ut,clientThreadId:a,isDisabled:!Ht||pt},"search-button"));const Ir=pt&&e.jsxs(e.Fragment,{children:[xe==="magic"&&e.jsx("div",{className:"m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",children:e.jsx(H,{...Oe.gizmoKnowledgeWarning})}),e.jsx(eh,{files:ke,className:"flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),Pr=Mr?"disabled":"default",Dr=c&&u,Lr=di(),Br=!$e||Y||Lr,Fr=kc(Dt,Bt,Lt),ds=Dr?"streaming":Br?"disabled":"idle",Ot=i.useRef(null),Ct=i.useRef(null),Hr=n&&n.startsWith("o1");i.useEffect(()=>{const T=()=>{Ot.current!=null&&rn.addAction("composer_state_disabled",{threadId:ee.getServerThreadId(a),disabledReason:Ot.current})};if(ft&&ds==="disabled"){let ce="unknown";d?ce=m??"component_disabled_unknown":c?ce="completion_in_progress":je?ce="thread_hard_blocked":Y&&(ce="starting_new_completion_request"),Ot.current!==ce&&(Ct.current&&clearTimeout(Ct.current),Ct.current=setTimeout(T,Jm)),Ot.current=ce}else Ot.current=null;return()=>{Ct.current&&(clearTimeout(Ct.current),Ct.current=null)}},[a,ft,ds,d,m,c,je,Y]);const Ys=[];if(Ne?.label&&Ys.push({type:Ne.type,value:Ne.label,onRemoveRegion:rs}),se!==null){const T=!!se.gizmo.tags?.includes(zn.FirstParty);Ys.push({type:"mention",value:se.gizmo.display.name,icon:e.jsx(ic,{isFirstParty:T,src:se.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{dt(null),p.focus()}})}i.useEffect(()=>{(!S||S.length===0||!z)&&(pe.current=!1)},[S,z]);const Ur=(T,ce,Ee)=>{pe.current=T>=0,ce&&p.setText(Ee?`${Ee.title}${Ee.body}`:"")},lo=z&&S&&S.length>0&&!ls&&!p.hasMultipleLines()&&p.canShowAutocompletion();i.useEffect(()=>{ls?j?.():E?.()},[ls,j,E]);const co=ds==="streaming"?jr:wt,Or=cn(a,an.Canvas),{value:zr}=js("61299031"),Gr=Gn(),Wr=Or&&zr&&!ss&&!Gr;return e.jsxs(lc.Provider,{value:gt,children:[e.jsx(cc,{onOauthRedirect:ro,children:e.jsx("form",{className:l,onSubmit:co,children:e.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col",children:[!_&&!Se&&e.jsx(tr,{className:y}),ls&&e.jsx("div",{className:D("absolute bottom-full my-3",r&&"lg:top-full",_s.TagGpt),children:e.jsx(dc,{onClick:T=>yr(T),onClose:()=>{jt(!1),p.focus()}})}),io&&e.jsx("div",{className:D("absolute bottom-full my-3",r&&"lg:top-full",_s.TagGpt),children:e.jsx($m,{composerController:p,clientThreadId:a})}),e.jsxs("div",{ref:v,className:"group relative flex w-full items-center",children:[r&&$.has("from_template_row")&&e.jsx("button",{type:"button",onClick:()=>{te("/")},className:"mr-2 flex h-8 w-8 items-center justify-center text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(uc,{className:"icon-lg"})}),e.jsx(vm,{type:we?"temporary":"default",ref:F,replyRegions:Ys,placeholder:Tr,inputState:Pr,composerController:p,leftSideActions:cs,topRightAction:Wr&&e.jsx(mc,{composerRef:A,composerController:p,clientThreadId:a}),state:ds,onSubmit:co,renderFiles:Ir,currentLeafId:f,clientThreadId:a,gizmoId:Te?.gizmo.id,disableReason:Fr,modelId:vt}),lo&&e.jsx("div",{className:"absolute left-0 z-10 box-border w-full bg-token-main-surface-primary pl-0 max-lg:bottom-full lg:top-full",children:e.jsx(Ym,{suggestions:S,composerController:p,onSelect:w,onChange:Ur})})]}),e.jsx(hc,{composerController:p,parsedDocumentHandler:wr})]})})}),e.jsx(lm,{canUseInlineTagging:me,isDisabled:d,clientThreadId:a,currentLeafId:f,currentRequestId:O,canContinue:h,composerController:p,setPromptInputMetadata:Re,suggestions:g,isNewThread:r,onCreateNewCompletion:s,onContinueGenerating:o,onResetState:as,conversationMode:K,isShowingAutocomplete:!!lo}),K!=null&&!Hr&&gc.includes(K.kind)&&e.jsx(pc,{clientThreadId:a,onTargetedReply:$s})]})}function sh(t){const s=t.message?.author.role===ze.User,o=t.metadata?.err!=null&&t.metadata?.errCode!==bo.ContentPolicy,n=t.metadata?.errCode===bo.ModelIncompatibility;return t.metadata?.canRetry===!1||n?!1:s||o}function or(t){return e.jsx(Qa,{clientThreadId:t.clientThreadId,children:e.jsx(nh,{...t})})}function nh({clientThreadId:t,isNewThread:s,currentModelId:o,showPromptStarters:n,noWrap:a,onRequestCompletion:r,composerContainerRef:c}){const l=Hs(),d=Tn(),m=_n(),u=kn(g=>{const x=kt.getCurrentNode(t,g);return sh(x)});if(Pa(l),!m&&u)return e.jsx(oh,{clientThreadId:t});const h=e.jsx(e.Fragment,{children:e.jsx(ar,{composerContainerRef:c,clientThreadId:t,currentModelId:o,isNewThread:s,showPromptStarters:n,onRequestCompletion:r})});return a?h:e.jsxs(e.Fragment,{children:[e.jsx(sm,{clientThreadId:t}),e.jsx(Vn,{clientThreadId:t,isStaticSharedThread:d,withVerticalPadding:!1,withHorizontalPadding:!0,children:e.jsx($t,{children:h})})]})}function oh({clientThreadId:t}){const s=Pc(t),o=kn(r=>kt.getCurrentNode(t,r).metadata?.errCode===Dc),n=Lc(r=>r.isoDate),a=Ze(t);return o&&n!=null&&n!==""?null:e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 text-center text-xs",children:e.jsx(H,{...Io.errorGeneratingResponse})}),e.jsx("div",{className:"flex items-center md:mb-4",children:e.jsx(Rt,{as:"button",color:"primary",onClick:()=>{const r=new qt;de.logEvent("chatgpt_regenerate_due_to_error_button_clicked",void 0,Xe({clientThreadId:t})),s({id:a,eventMetadata:{eventSource:"mouse"},conversationMode:kt.getConversationMode(t),turnTracker:r})},className:"m-auto",icon:Ma,"data-testid":"regenerate-thread-error-button",children:e.jsx(H,{...Io.regenerateResponse})})})]})}function ar({clientThreadId:t,currentModelId:s,isNewThread:o,onRequestCompletion:n,showPromptStarters:a,composerContainerRef:r,autocompletions:c,requiresFileUpload:l,onComposerInput:d,onComposerChange:m,onAutocompleteSelect:u,headerClassName:h,hideHeader:g,onTaggingDropdownClose:x,onTaggingDropdownOpen:v}){const S=Ze(t),M=As(t),b=mn(),{isUnauthenticated:N}=De(),y=ia(t)===la.STREAMING,_=ca({clientThreadId:t,conversationLeafId:S}),I=it(M),j=hi({clientThreadId:t}),E=!N,A=gi(),{isOpen:F,onClose:p}=Nc({type:"just-hit-rate-limit"}),L=i.useCallback((Y,q)=>{Q.logEvent(Z.continueCompletion),n({type:So.Continue,promptId:Y,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!1,completionMetadata:{conversationMode:kt.getConversationMode(t)},turnTracker:q})},[n,t]),C=da(),B=i.useCallback(async(Y,q)=>Ec({clientThreadId:t,currentRequestId:q,isHistoryAndTrainingDisabled:A,queryClient:C}),[t,A,C]),U=i.useCallback(async({promptId:Y,content:q,eventMetadata:z,completionMetadata:X,messageMetadata:Se,prependMessages:pe,appendMessages:Ce,turnTracker:le,profiler:Me,requestedModelId:K})=>{const Te=ee.getThreadCurrentLeafId(t);ee.updateTree(t,Ue=>{Ue.addNode(Y,q,Te,ze.User,void 0,Se)}),await n({type:So.Next,promptId:Y,eventMetadata:z,cancelActiveRequests:!0,completionMetadata:X,prependMessages:pe,appendMessages:Ce,turnTracker:le,profiler:Me,...K?{requestedModelId:K}:{}})},[t,n]),k=pi(t,S),R=fi(t,S),f=!_&&(I||y),O=i.useMemo(()=>f?!1:!k&&R,[k,R,f]),$=f&&s!=="gpt-4-pbrowse",te=Jt(t),W=_e(t),xe=It(W).data,{promptStarters:re,isSuccess:J}=hn(o&&!te,t,4),ue=ba(),we=(()=>{if(ue?.messageId===ee.getTree(t).getLastValidNode(S)?.message?.id)return ue?.suggestions;if(a&&!te&&J&&!E)return re})(),Fe=Ac(),ie=xi(),ge=(()=>{if(xe?.gizmo.tags?.includes(zn.WorkspaceDisabled)&&!ie)return"workspaceDisallowsGizmo";if(Fe.size){if(b.displayingSideBySideFeedback&&b.unskippable)return"feedbackRequired"}else return"noModelsAvailable";const q=kt.getConversationMode(t);return q?.kind===Qe.GizmoTest&&q.gizmo_id==null?"noTestGizmoId":null})(),je=ua(t),ve=Is(t),Re=js("15117983")?.value,Ie=vi(),He=Ps(),V=Ie.action==="moderate",{value:P}=Ve("1860647109");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center",children:He&&V&&P?e.jsx(Rc,{}):null}),F?e.jsx(Ic,{onClose:p}):null,Re&&ve&&ve.kind===Qe.PrimaryAssistant&&ve.plugin_ids&&ve.plugin_ids.length>0?e.jsx(ah,{}):e.jsx(th,{composerContainerRef:r,clientThreadId:t,onCreateNewCompletion:U,onAbortCompletion:B,onContinueGenerating:L,currentModelId:s,isNewThread:o,isCompletionInProgress:j,className:"w-full",canContinue:O,suggestions:we??[],disabled:!!ge,disabledReason:ge??void 0,canPause:$,isInteractableSharedThread:je,autocompletions:c,requiresFileUpload:l,onComposerInput:d,onComposerChange:m,onAutocompleteSelect:u,headerClassName:h,hideHeader:g,onTaggingDropdownClose:x,onTaggingDropdownOpen:v},t)]})}function ah(){return e.jsxs("div",{className:"mx-auto flex max-w-md flex-col items-center justify-center gap-2 rounded-xl border border-token-border-light bg-token-main-surface-primary p-6 shadow-lg",children:[e.jsx("span",{className:"text-token-text-primary",children:e.jsx(H,{id:"PluginsDecrepatedNotice.pluginsDeprecationTitle",defaultMessage:"Conversations with plugins are archived"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(H,{id:"PluginsDecrepatedNotice.pluginsDeprecationSubtitle",defaultMessage:"Explore GPT Store to find a replacement"})}),e.jsxs("a",{href:"https://chat.openai.com/gpts",className:"text-green-500 hover:cursor-pointer dark:text-green-400",children:[e.jsx(H,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLink",defaultMessage:"Explore GPTs"}),e.jsx("span",{className:"ml-2",children:e.jsx(H,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLinkArrow",defaultMessage:"→"})})]})]})}const Io=Pe({errorGeneratingResponse:{id:"PromptTextarea.errorGeneratingResponse",defaultMessage:"There was an error generating a response"},regenerateResponse:{id:"PromptTextarea.regenerateResponse",defaultMessage:"Regenerate"}}),rr=i.memo(function(){return e.jsxs("div",{className:`flex flex-col gap-2 ${_s.PromptTextareaHeader}`,children:[e.jsx(sr,{}),e.jsx(nr,{})]})}),rh=Object.freeze(Object.defineProperty({__proto__:null,ChatScreenComposerAlerts:rr},Symbol.toStringTag,{value:"Module"})),Po=Le(()=>Be(()=>import("./67vo2vt3itcabkcg.js"),__vite__mapDeps([6,1,2,3,4,7,8,9,10,11])).then(t=>t.SnorlaxSplashScreen)),Js=4;function ih(t){const{layer:s}=We("3533083032"),{layer:o}=_t("3533083032"),{value:n,isLoading:a}=Ve("3006519778");return a||!n?!1:t?s.get("enable_new_homepage_anon",!1):o.get("enable_new_homepage_anon",!1)}function lh(){const{layer:t}=_t("4031588851"),s=t.get("autocomplete_qualified_start_date","2099-09-13T00:00:00Z"),o=Bn();return!!o&&o.created*1e3>=new Date(s).getTime()}function ch(t){const{layer:s}=We("4031588851"),{layer:o}=_t("4031588851"),{value:n,isLoading:a}=Ve("633009675");return a||!n?!1:t?s.get("enable_new_autocomplete_homepage",!1):o.get("enable_new_autocomplete_homepage",!1)}const en=t=>`${t.title}${t.body}`.toLocaleLowerCase();function ir(t){const s=_e(t.clientThreadId),o=ts(s);return e.jsx(Qa,{clientThreadId:t.clientThreadId,children:o&&s&&Po?e.jsx(Po,{clientThreadId:t.clientThreadId,gizmoId:s,currentModelId:t.currentModelId,onRequestCompletion:t.onRequestCompletion}):e.jsx(gh,{...t})})}function dh({children:t}){const{store:s}=ye(),[o,n]=i.useState(!1),a=Hs();i.useEffect(()=>a.subscribe("focus",()=>{n(!0)}),[a]),i.useEffect(()=>a.subscribe("blur",()=>{n(!1)}),[a]);const c=!!s.useSharedProps()?.isShowingAutocomplete;return t(c&&o)}function uh({isUnauthenticated:t,shouldShowLegacyStarterPrompts:s,legacyPromptStarters:o,isSendBlocked:n,clientThreadId:a}){return e.jsxs("div",{className:D(t?"justify-end lg:justify-center":"justify-center","flex h-full flex-shrink flex-col items-center overflow-y-hidden text-token-text-primary lg:hidden"),children:[e.jsx("div",{className:D(t&&"flex sm:items-center md:flex-1","flex-shrink-0"),children:e.jsx(Xt,{className:"mb-6 h-12 w-12"})}),s&&(o&&o.length>0?e.jsx(vh,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},promptStarters:o,isSendBlocked:n,clientThreadId:a,isSquare:t}):e.jsx(Gu,{}))]})}function mh({isSendBlocked:t,clientThreadId:s,isModelLoaded:o,headlineOption:n,enableNewMobileDesign:a,shouldShowStarterPrompts:r,promptChips:c,onSelectStarterPrompt:l,starterPromptExpanded:d,setStarterPromptExpanded:m}){return e.jsx(dh,{children:u=>e.jsxs(oe.div,{initial:{opacity:0},animate:{opacity:u?0:1},exit:{opacity:0},transition:{duration:.1},className:D("justify-center",u?"pointer-events-none":"","mt-[var(--screen-optical-compact-offset-amount)] flex h-full flex-shrink flex-col items-center overflow-hidden text-token-text-primary lg:hidden"),children:[n==="CHATGPT_LOGO"?e.jsx(Xt,{className:"inline-block h-12 w-12"}):e.jsx(lr,{headlineOption:n,isModelLoaded:o}),e.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:D(!a&&"lg:hidden",!d&&"h-[116px]"),children:r&&e.jsx(dr,{starterPrompts:c,onSelectStarterPrompt:l,disabled:t,clientThreadId:s,onExpand:()=>m(!0),mobileLayout:!0})})]})})}function hh(t,s,o){const n=Ve("1468311859").value,a=Ve("3664702598").value,{layer:r}=We("4031588851"),c=lh(),l=t||s,d=l&&n,m=l&&a&&c;let u="HARDCODED";if(l)if(o){const h=r.get("search_autocomplete_mode","");d&&h&&(u=h)}else m&&(u=r.get("autocomplete_mode","HARDCODED"));return u}function gh({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,v2HomepageDisclaimer:a}){const r=Hs(),c=rt(t),l=Jt(t),d=Mn(),[m,u]=i.useState([]),{trendingSuggestions:h,fetchTrendingSuggestions:g}=Sh(Js),x=i.useRef(!1),{isUnauthenticated:v}=De(),S=Bc(),[M,b]=i.useState(!1),N=In(),w=Ge();Pa(r);const y=Ve("589604007").value,{layer:_}=_t("4031588851"),{layer:I}=We("4031588851"),{layer:j}=_t("3533083032"),{layer:E}=We("3533083032"),{promptStarters:A,isSuccess:F}=hn(c&&!l&&o,t,8,y,!0,s??void 0),{promptStarters:p,isSuccess:L,isError:C}=hn(c&&!l&&o,t,4,void 0,void 0,s??void 0),B=S&&!!m.find(V=>!!V.requires_file_upload),U=i.useCallback(V=>{const P=r.getCurrentText();return P&&en(V).startsWith(P.toLocaleLowerCase())},[r]),k=i.useCallback(V=>{const P=r.getCurrentText(),Y=V.title+V.body;return U(V)?{...V,title:P,body:Y.slice(P.length)}:{...V,title:Y,body:""}},[r,U]),R=i.useCallback((V=!1)=>{u(P=>!P.some(U)&&P.length>0?[]:V?P:P.map(k))},[U,k]),f=(V,P,Y)=>{const q=V.title;u([]),r.focus(),r.setText(q),requestAnimationFrame(()=>{const z=(A?.filter(X=>X.theme===V.theme)??[]).map(X=>{const Se=Mt(X.oneliner),pe=Se.startsWith(X.title);return{...X,title:pe?`${X.title} `:"",body:pe?X.body:Se,autocompletionChunks:Km(q,Se),type:ks.Autocomplete}});u(z),z.length>0&&At(z,t),Uc(V,Y,t)})};i.useEffect(()=>{const V=m.some(P=>P.theme===gn.Search);N&&r.getCurrentText()===""?h.length>0?u(h):g():V&&!N&&u(P=>P.filter(Y=>Y.theme!==gn.Search))},[m,N,h,g,r]);const O=A?.reduce((V,P)=>(P.theme&&!V[P.theme]&&(V[P.theme]=P),V),{}),$=[];if(O)for(const V in O)$.push(O[V]);const te=$&&$.length>0,W=!!(F&&te&&o),xe=!!((L||C)&&o),re=Js-m.filter(U).length,J=v?E.get("enable_new_mobile",!1):I.get("enable_new_mobile",!1),ue=hh(J,S,N),we=v?j.get("headline_option","HELP_WITH"):_.get("headline_option","HELP_WITH"),Fe=_.get("autocomplete_min_char",4),ie=_.get("autocomplete_fetch_interval",200),ge=i.useRef(null),je=i.useCallback(Da(async V=>{const P=r.getCurrentText();if(!P||P.length<Fe||P.length>80||r.hasMultipleLines()){u([]);return}if(!x.current&&!(ge.current&&ge.current.length>Fe&&P.startsWith(ge.current)))try{const Y=await Nt.generateAutocompletions(P,V,N);if(Y.completions.length===0){ge.current=P;return}const q=Y.completions.map(z=>({id:Si(),type:ks.Autocomplete,title:z.slice(0,P.length),body:z.slice(P.length),oneliner:z,prompt:z,source:ue})).filter(U).map(k);u(z=>{const X=z.filter(U),Se=q.filter(pe=>{const Ce=en(pe);return!X.some(le=>{const Me=en(le);if(Ce===Me)return!0;const K=/[\p{P}\p{S}]$/u,Te=Ce.replace(K,""),Ue=Me.replace(K,"");return Te===Me||Ce===Ue||Te===Ue})}).slice(0,Js-X.length);return[...X,...Se]}),q.length>0&&At(q,t)}catch{}},ue==="BING"?150:ie),[r,ue,k,ie]),ve=i.useCallback(()=>{R(),re>0&&je(re)},[je,R,re]);i.useEffect(()=>{x.current&&u([])},[x]);const Re=i.useMemo(()=>ue==="HARDCODED"?R:ve,[ue,ve,R]),Ie=i.useCallback(()=>{r instanceof Xn&&R(!0),r.getCurrentText().indexOf(`
`)>0&&u([])},[r,R]),He=i.useCallback((V,P,Y)=>{P.forEach(q=>{q.id===V.id&&(q.userInput=r.getCurrentText())}),u([P[Y]])},[r]);return e.jsx(e.Fragment,{children:e.jsx(es,{children:e.jsx("div",{className:"h-full w-full lg:py-[18px]",children:e.jsx(Vn,{isStaticSharedThread:!1,withVerticalPadding:!1,withHorizontalPadding:!0,clientThreadId:t,fullHeight:!0,children:e.jsxs(_o,{children:[e.jsx("div",{className:"mb-7 hidden text-center lg:block",children:we==="CHATGPT_LOGO"?e.jsx(Xt,{className:"inline-block h-12 w-12"}):e.jsx(lr,{headlineOption:we,isModelLoaded:o})}),!J&&e.jsx(uh,{isUnauthenticated:v,shouldShowLegacyStarterPrompts:xe,legacyPromptStarters:p,isSendBlocked:d,clientThreadId:t}),J&&e.jsx(mh,{isModelLoaded:o,headlineOption:we,enableNewMobileDesign:J,shouldShowStarterPrompts:W,promptChips:$,onSelectStarterPrompt:f,starterPromptExpanded:M,setStarterPromptExpanded:b,isSendBlocked:d,clientThreadId:t}),e.jsx("div",{className:D("lg:w-full","lg:absolute lg:bottom-8 lg:left-0"),children:e.jsx(_o,{children:w?e.jsx(rr,{}):e.jsx(tr,{className:"block"})})}),e.jsx("div",{className:"w-full",children:e.jsx(ar,{clientThreadId:t,isNewThread:c,currentModelId:s,onRequestCompletion:n,showPromptStarters:!1,autocompletions:m,requiresFileUpload:B,onComposerInput:Re,onComposerChange:Ie,onAutocompleteSelect:He,onTaggingDropdownClose:()=>{x.current=!1},onTaggingDropdownOpen:()=>{x.current=!0},hideHeader:!0})}),e.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:D("hidden lg:block",a&&v&&M?"":"h-[70px]"),children:W&&e.jsx(dr,{starterPrompts:$,onSelectStarterPrompt:f,disabled:d,clientThreadId:t,onExpand:()=>b(!0)})}),a&&e.jsx("div",{className:"w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px] lg:absolute lg:bottom-0 lg:left-0",children:e.jsx("div",{className:"min-h-4",children:a})})]})})})})})}function lr({headlineOption:t,isModelLoaded:s}){const o=fe(),[n,a]=i.useState(0),[r,c]=i.useState(!0),l=20,d=o.formatMessage(bh[t]||Vt.whatCanIHelpWith);return i.useEffect(()=>{if(!s)return;let m;return n<d.length?m=setTimeout(()=>{a(n+1)},l):r&&(m=setTimeout(()=>{c(!1)},500)),()=>clearTimeout(m)},[d,n,r,s]),e.jsxs("div",{className:"relative inline-flex justify-center text-center text-2xl font-semibold leading-9",children:[e.jsx("h1",{children:d.substring(0,n)||"​"}),e.jsx("h1",{className:"result-streaming absolute left-full transition-opacity",style:{opacity:r?1:0},children:e.jsx("span",{})})]})}function cr({label:t,onClick:s,disabled:o=!1,icon:n}){return e.jsxs("button",{className:"group relative flex h-[42px] items-center gap-1.5 rounded-full border border-token-border-light px-3 py-2 text-start text-[13px] shadow-xxs transition enabled:hover:bg-token-main-surface-secondary disabled:cursor-not-allowed xl:gap-2 xl:text-[14px]",disabled:o,onClick:s,children:[n,e.jsx("span",{className:"max-w-full select-none whitespace-nowrap text-gray-600 transition group-hover:text-token-text-primary dark:text-gray-500",children:t})]})}function ph({starterPrompt:t,starterPrompts:s,index:o,disabled:n,onSelectStarterPrompt:a}){const r=t.theme??t.title,c=Ls(),{mutate:l}=Oc(),d=t.category==="onboarding"?()=>{l({key:lt.hasUsedConversationalOnboardingStarterPrompt}),c(t,s,o)}:()=>a(t,s,o);return e.jsx(cr,{disabled:n,onClick:d,icon:e.jsx(zc,{starterPrompt:t,useV2Colors:!0}),label:r})}function Do({clientThreadId:t,onClick:s}){i.useEffect(()=>{Gc(t)},[t]);const o=fe();return e.jsx(oe.div,{initial:{opacity:0,translateY:5},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:5},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:e.jsx(cr,{onClick:()=>{Wc(t),s()},label:o.formatMessage(Vt.moreStarterPrompts)})})}const fh=5,xh=3;function dr({starterPrompts:t,onSelectStarterPrompt:s,disabled:o,clientThreadId:n,onExpand:a,mobileLayout:r=!1}){const c=r?xh:fh,[l,d]=i.useState(c),[m,u]=i.useState(c),[h,g]=i.useState(!1),x=i.useRef(null),v=t.length<=l;i.useEffect(()=>{At(t.slice(0,c),n)},[n]),i.useEffect(()=>{if(!h&&!v&&x.current){const M=x.current,b=M.getBoundingClientRect(),N=b.width,w=Array.from(M.children);let y=0;for(let _=0;_<w.length&&w[_].getBoundingClientRect().right-b.left<=N;_++)y++;d(y),u(y),g(!0)}},[t,v,h]);const S=()=>{const M=t.slice(l,t.length).map(b=>({...b,isAdditional:!0}));M.length>0&&At(M,n),d(t.length),a()};return e.jsxs("div",{className:D("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",h&&t.length>0?"opacity-100":"opacity-[0.01]",r?"flex-wrap":"flex-nowrap"),children:[e.jsxs("ul",{className:D("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",v||r?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:x,children:[t.slice(0,l).map((M,b)=>e.jsx(oe.li,{initial:{opacity:0,...b<m?{translateY:5}:{}},animate:{opacity:1,...b<m?{translateY:0}:{}},exit:{opacity:0,...b<m?{translateY:5}:{}},transition:{duration:.3,delay:b>=m?(b-m)*.06:0,ease:"easeOut"},children:e.jsx(ph,{starterPrompt:M,starterPrompts:t,index:b,disabled:o,onSelectStarterPrompt:s})},M.id??b)),r&&t.length>l&&e.jsx(Do,{clientThreadId:n,onClick:S})]}),!r&&t.length>l&&e.jsx(Do,{clientThreadId:n,onClick:S})]})}function vh({promptStarters:t,isSendBlocked:s,clientThreadId:o,isSquare:n,...a}){i.useEffect(()=>{At(t,o)},[o]);const r=Ls();return e.jsx(e.Fragment,{children:n?e.jsx(oe.div,{...a,className:"mb-2 w-full flex-shrink overflow-y-hidden",children:e.jsx($t,{children:e.jsx(Xa,{starterPrompts:t,onSelectStarterPrompt:r,disabled:s})})}):e.jsx(oe.div,{...a,className:"flex-shrink overflow-y-hidden",children:e.jsx(Wu,{starterPrompts:t,onSelectStarterPrompt:r,disabled:s,cssMobileDisplayLimit:2,marginOverride:"mt-6 lg:mt-12"})})})}const Sh=t=>{const[s,o]=i.useState([]),n=i.useCallback(async()=>{const r=(await Nt.generateTrendingSuggestions(t)).suggestions.map((c,l)=>({type:ks.Starter,title:Lo(c),body:"",icon:e.jsx(Fc,{}),prompt:Lo(c),id:`starter-${l}`,theme:gn.Search}));o(r)},[t]);return{trendingSuggestions:s,fetchTrendingSuggestions:n}};function Lo(t){return t.split(" ").map(Hc).join(" ")}const Vt=Pe({whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),bh={HELP_WITH:Vt.whatCanIHelpWith,WHERE_TO_START:Vt.whereShouldWeStart,ASK_CHATGPT:Vt.askChatgptAnything};function ur({clientThreadId:t,currentLeafId:s}){const{currentModelId:o}=Za(),n=Bs(t),a=Nn(t,s),r=_e(t),c=ct(),l=Fs(o),d=rt(t)&&!a&&(Wt(n)||n?.kind===Qe.GizmoTest),m=ts(r);return{showEmptyState:d,canUseNewHomepage:d&&m||d&&!r&&!l&&!c}}const Bo=he.button`group flex cursor-pointer items-center gap-1 rounded-lg py-1.5 ${({$shimmer:t})=>t?"loading-shimmer":""} ${({$isScreenArch:t})=>t?"text-md px-2":"px-3 text-lg"} hover:bg-token-main-surface-secondary radix-state-open:bg-token-main-surface-secondary font-semibold text-token-text-secondary overflow-hidden whitespace-nowrap`;function yh({conversation:t,gizmoResource:s}){const o=ji(t.id)??t.title;return e.jsx(Cs,{to:Yc(t.id,s),children:e.jsx(ae.Item,{icon:Kc,children:o},t.id)})}function wh({gizmoId:t,clientThreadId:s,inMobileHeader:o}){const n=fe(),{data:a}=It(t),r=Vc(t),{title:c,titleSource:l}=bi(s),d=Ge(),{conversationLeafId:m}=Za(),{showEmptyState:u}=ur({clientThreadId:s,currentLeafId:m}),h=Jt(s),g=qc(),x=n.formatMessage(un.newChatTitle),{resolvedTitle:v,isTypingEffect:S}=$c(s,c??null,!0);if(!a||u)return null;const M=v==null&&(rt(s)||l===yi.NewChat),b=h?e.jsx(e.Fragment,{}):e.jsxs(Bo,{$isScreenArch:d,$shimmer:M,children:[S?e.jsx(Xc,{text:v??""}):v??x,e.jsx(qn,{className:"icon-md text-token-text-tertiary"})]}),N=g&&a.gizmo.display.emoji?e.jsxs(e.Fragment,{children:[a.gizmo.display.emoji," ",a.gizmo.display.name]}):a.gizmo.display.name;return e.jsxs("div",{className:"flex items-center gap-1 overflow-hidden whitespace-nowrap px-2 py-1.5",children:[e.jsx(Bo,{$isScreenArch:d,children:e.jsx(Cs,{to:ko(a),children:N})}),e.jsxs(e.Fragment,{children:[e.jsx(wi,{className:"icon-md text-token-text-tertiary"}),e.jsxs(ma,{contentAlign:o?"center":"start",size:"small",triggerButton:b,children:[e.jsx(Cs,{to:ko(a),children:e.jsx(ae.Item,{icon:La,children:e.jsx(H,{...un.newChatProjectDropdownItem,values:{name:`"${a.gizmo.display.name}"`}})},"new-chat")}),r.data?.items.map(w=>w.id!==s?e.jsx(yh,{conversation:w,gizmoResource:a},w.id):null)]})]})]})}const jh=Le(()=>Be(()=>import("./gzuuwahacs3yploq.js"),__vite__mapDeps([12,1,2,3,4,13])).then(t=>t.ThreadHeaderGizmoDropdown)),Fo=he.button`group flex cursor-pointer items-center gap-1 rounded-lg py-1.5 ${({$isScreenArch:t})=>t?"h-[44px] @lg/screen-composer:pl-3 [line-height:26px] [font-size:17px] pl-1 pr-3":"px-3 text-lg"} hover:bg-token-main-surface-secondary radix-state-open:bg-token-main-surface-secondary font-semibold text-token-text-secondary overflow-hidden whitespace-nowrap`;function Ch({clientThreadId:t}){const s=fe(),o=ct(),n=Mi(t),a=Cn(),[,r]=aa(),c=()=>{!n&&!o?a({pathname:"/",search:new URLSearchParams({[gs]:"true"}).toString()}):r(l=>(l.get(gs)==="true"?l.delete(gs):l.set(gs,"true"),l),{replace:n,state:cd()})};return e.jsx(ae.Item,{size:"large",className:"!pr-3",onClick:c,icon:rd,children:e.jsxs("div",{className:"flex grow items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-1 items-center gap-3",children:e.jsx(H,{...pr.temporaryChat})}),e.jsx(id,{enabled:o,label:s.formatMessage({defaultMessage:"Temporary",id:"temporaryChatToggleLabel"}),testId:"temporary-chat-toggle"})]})})}function mr(t,s,o){let n=t;if(t===yo.AUTO){const c=s.filter(({defaultModel:l})=>l!==yo.AUTO);c.length===1&&(n=c[0].defaultModel)}const a=s.find(({defaultModel:c})=>c===n);if(a){const{categoryId:c,shortLabel:l}=a;return{selectedCategory:c,modelLabel:l}}const r=o.find(({modelIds:c})=>c.includes(n));if(r){const{group:c,shortLabel:l}=r;return{selectedCategory:c,modelLabel:l}}return{selectedCategory:null,modelLabel:null}}function Mh({modelLabel:t}){return e.jsx("span",{className:"overflow-x-clip text-ellipsis text-token-text-secondary",children:t})}function Th({clientThreadId:t,inMobileHeader:s}){const{isLoading:o,categories:n,groups:a}=$n(),r=Ci(),l=Yn(t).id,d=Qc(),{modelLabel:m}=mr(l,n,a),u=kh(t,d),h=fe(),{isUnauthenticated:g}=De(),x=hr(),v=(!g||!x)&&!r;i.useEffect(()=>{o||Zc({namespace:Ia.ChatPageLoad})?.logTiming("render_model_switcher")},[o]);const S=Ge(),M=e.jsxs("div",{className:D(S?"overflow-x-hidden text-ellipsis":"text-token-text-secondary"),children:[Jc," ",v?e.jsx("span",{className:"text-token-text-secondary",children:m}):g&&m?e.jsx(Mh,{modelLabel:m}):null]});return u.length?o?null:e.jsx(ma,{sideOffset:8,size:"large",triggerButton:e.jsxs(Fo,{$isScreenArch:S,"aria-label":m?h.formatMessage({id:"JrtGPQ",defaultMessage:"Model selector, current model is {modelLabel}"},{modelLabel:m}):"",children:[M,S?e.jsx(ed,{className:"icon-md text-token-text-tertiary"}):e.jsx(qn,{className:"icon-md text-token-text-tertiary"})]}),onOpenChange:b=>{Q.logEvent(Z.toggleModelSwitcher,{isOpen:b}),de.logEvent("toggle_model_switcher",null,{isOpen:String(b)})},contentAlign:s?"center":"start",testId:"model-switcher-dropdown",children:e.jsx(Eh,{sections:u})}):e.jsx(Fo,{className:"cursor-default",children:M})}function hr(){return Ve("462735957").value}function _h({category:t,modelSwitcherDenialsBySlug:s,currentGizmoId:o,currentModelId:n,omitIcon:a,testId:r}){const{defaultModel:c,label:l,categoryId:d,description:m,isBeta:u}=t;return e.jsx(pn,{value:c,modelSwitcherDenialsBySlug:s,renderName:h=>e.jsx(yn,{categoryId:d,name:l,description:m,isDisabled:h,omitIcon:a,isBeta:u}),isSelected:!o&&n===c,testId:r},c)}function kh(t,s){const o=Yn(t),n=o.id,a=_e(t),{categories:r,groups:c}=$n(),{doesUserHaveAnyAccountsWithPlusFeatures:l}=En(),d=ee.getServerThreadId(t),m=td({clientThreadId:t}),u=fe(),h=!d,{isUnauthenticated:g}=De(),x=sd(),{layer:v}=We("2723963139"),S=v.get("is_dynamic_model_enabled",!1),M=hr(),b=s.find(({categoryId:R})=>R===Ye.ALPHA),N=s.find(({categoryId:R})=>R===Ye.DATA_CAMPAIGNS),w=s.find(({categoryId:R})=>R===Ye.EXPERIMENTS),y=s.find(({categoryId:R})=>R===Ye.MAINLINE),_=!0,I=!!b?.options?.length,j=!!N?.options?.length,E=!!w?.options?.length,A=!!y?.options?.length,F=Cn(),p=i.useCallback(()=>{Q.logEvent(Z.openModalAccountPaymentfromModelPicker,{content:"gizmo-button"}),nd(F,"Thread header dropdown")},[F]),L=()=>{de.logEvent("chatgpt_model_switcher_plus_upgrade_button_clicked"),Q.logEvent(Z.modelSwitcherPlusUpgradeButtonClicked),g?x({shouldOpenPaymentModalOnAuth:!0,callback:R=>{Q.logSignUpButtonClicked({location:"Model switcher GPT-4 upsell",provider:R})}}):p()},C=[],B=e.jsxs("div",{className:"mb-1 flex items-center justify-between px-5 pt-2",children:[e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(H,{id:"ilkdMh",defaultMessage:"Model"})}),e.jsx("a",{href:S?"https://help.openai.com/en/articles/9155758-what-is-the-chatgpt-plus-model-selector":"https://help.openai.com/en/articles/7102672-how-can-i-access-gpt-4",target:"_blank",rel:"noreferrer",children:e.jsx(dd,{className:"icon-md h-5 w-5 pl-0.5 text-token-text-tertiary"})})]},"header");if(M&&g){const R={id:"modelSection",content:[]};R.content.push(e.jsx(od,{},"noAuthUpsell")),C.push(R)}else if(l){const R={id:"modelSection",content:[]};r.length&&R.content.push(B);const f=new Map;r.forEach(O=>{const $=e.jsx(_h,{category:O,currentGizmoId:a,currentModelId:n,modelSwitcherDenialsBySlug:m,omitIcon:_,testId:`model-switcher-${O.defaultModel}`},O.categoryId);O.subcategory?(f.has(O.subcategory)||f.set(O.subcategory,[]),f.get(O.subcategory)?.push($)):R.content.push($)}),f.forEach((O,$)=>{const te=r.find(W=>W.subcategory===$&&W.defaultModel===o.id);R.content.push(e.jsxs(ae.Sub,{children:[e.jsx(ae.SubMenuTrigger,{"data-testid":$==="More models"?"more-models-submenu":void 0,children:e.jsxs("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:[$,!!te&&e.jsx("div",{className:"truncate text-token-text-tertiary",children:te.label})]})}),e.jsx(ae.Portal,{children:e.jsx(ae.SubContent,{className:"min-w-72",children:O})})]},$))}),C.push(R)}else{const R={id:"modelSection",content:[]};R.content.push(e.jsx(pn,{value:"",onClick:L,modelSwitcherDenialsBySlug:m,isUpgradeUpsell:!0,renderName:f=>e.jsx(yn,{icon:ld,isDisabled:f,name:u.formatMessage({id:"mzDzkX",defaultMessage:"ChatGPT Plus"}),description:u.formatMessage({id:"bqTHri",defaultMessage:"Our smartest model & more"}),omitIcon:!1}),isSelected:!1,showNewChatHint:!1},"plusUpgrade")),R.content.push(e.jsx(pn,{value:Zs.AUTO,modelSwitcherDenialsBySlug:m,renderName:f=>e.jsx(yn,{icon:ad,name:u.formatMessage({id:"U9E7Rx",defaultMessage:"ChatGPT"}),description:u.formatMessage({id:"n96qML",defaultMessage:"Great for everyday tasks"}),isDisabled:f,omitIcon:!1}),isSelected:!a&&n===Zs.AUTO,showNewChatHint:!0},Zs.AUTO)),C.push(R)}const U={id:"otherOptionsSection",content:[]},{selectedCategory:k}=mr(n,r,c);return h&&(I&&U.content.push(e.jsx(hs,{isSelected:k===Ye.ALPHA,currentModel:o,option:b,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},b.value)),j&&U.content.push(e.jsx(hs,{isSelected:k===Ye.DATA_CAMPAIGNS,currentModel:o,option:N,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},N.value)),E&&U.content.push(e.jsx(hs,{currentModel:o,isSelected:k===Ye.EXPERIMENTS,option:w,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},w.value)),A&&U.content.push(e.jsx(hs,{isSelected:k===Ye.MAINLINE,currentModel:o,option:y,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},y.value))),U.content.length&&C.push(U),g||C.push({id:"temporaryChatSection",content:[e.jsx(Ch,{clientThreadId:t},"tempChat")]}),C}function Nh(){const t=fe();return e.jsx("div",{className:"border-token-text-quartenary items-center rounded-full border px-1 py-0.5 text-[8px] font-semibold uppercase leading-3 text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary",children:t.formatMessage(pr.beta)})}function yn({isDisabled:t,name:s,icon:o,categoryId:n,description:a,extra:r,omitIcon:c,isBeta:l=!1}){let d=s;return l&&(d=e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s}),e.jsx(Nh,{})]})),e.jsxs("div",{className:"flex items-center gap-3",children:[!c&&e.jsx("span",{className:"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-token-main-surface-secondary",children:o?e.jsx(o,{className:"h-4 w-4 text-token-text-primary"}):n&&e.jsx(Ba,{type:"filled",className:D("h-4 w-4",t&&"text-gray-300",!t&&"text-token-text-primary"),categoryId:n})}),e.jsxs("div",{children:[d,e.jsxs("div",{className:D(!t&&"text-token-text-secondary","text-xs"),children:[a,r]})]})]})}function Eh({sections:t}){return e.jsx(e.Fragment,{children:t.map((s,o)=>e.jsxs(ha.Fragment,{children:[o!==0?e.jsx(ae.Separator,{}):null,s.content]},s.id))})}function gr({clientThreadId:t,inMobileHeader:s=!1}){const o=_e(t),n=ts(o);return o==null?e.jsx(Th,{clientThreadId:t,inMobileHeader:s}):n?e.jsx(wh,{gizmoId:o,clientThreadId:t,inMobileHeader:s}):e.jsx(jh,{clientThreadId:t,gizmoId:o,inMobileHeader:s})}const pr=Pe({beta:{id:"XZwFET",defaultMessage:"Beta"},gpt35ShortExplainer:{defaultMessage:"Great for everyday tasks",id:"ModelSwitcher.gpt35ShortExplainer"},modelTunerSmartSelectionTitle:{id:"czjW8I",defaultMessage:"Dynamic"},modelTunerSmartSelectionExplainer:{id:"gp/YH1",defaultMessage:"Optimized for speed and intelligence"},gpt4ShortExplainer:{defaultMessage:"With DALL·E, browsing and analysis",id:"ModelSwitcher.gpt4ShortExplainer"},gpt4ShortExplainerWithoutBrowse:{defaultMessage:"With DALL·E and analysis",id:"ModelSwitcher.gpt4ShortExplainerWithoutBrowse"},gpt4UpsellExplainer:{id:"ModelSwitcher.gpt4Upsell",defaultMessage:"Our smartest and most capable model. Includes DALL·E, browsing and more."},userUpgrade:{id:"ModelSwithcer.upgradeButton",defaultMessage:"Upgrade to Plus"},userUpgradeSignup:{id:"ModelSwitcher.signupUpgradeButton",defaultMessage:"Sign up for ChatGPT Plus"},temporaryChat:{id:"ModelSwitcher.temporaryChat",defaultMessage:"Temporary chat"},shareChat:{id:"ModelSwitcher.shareChat",defaultMessage:"Share chat"}}),Ah=Le(()=>Be(()=>import("./gefdkujkb9a5v91x.js"),__vite__mapDeps([14,1,2,15,16,3,4,17,18,19,20,21,22,23,11,24,8,25,26,27,28,10,13,29,30,31,32])).then(t=>t.GizmoUsingAsOwnerNotice)),fr=({clientThreadId:t})=>{const s=On(m=>m.activeStageSidebar),o=ee.getServerThreadId(t),n=ud(ws.WorkspaceShareLinks),{isUnauthenticated:a}=De(),r=ct(),c=n&&o&&!a&&!r,l=Ge(),d=!s&&!(l&&!a);return e.jsx("div",{className:D(!l&&"gap-2",l&&"@lg/screen-composer:gap-2","flex items-center pr-1 leading-[0]"),children:e.jsx(em,{showShareButton:c,showProfileDropdown:d,clientThreadId:t})})};function Rh({clientThreadId:t,gizmoId:s}){const o=md(),{data:n}=It(s),a=Rs();return e.jsxs(e.Fragment,{children:[e.jsxs(hd,{className:"max-md:hidden",children:[e.jsxs("div",{className:"absolute start-1/2 ltr:-translate-x-1/2 rtl:translate-x-1/2",children:[n!=null&&a?.isWorkspaceAccount()&&n.gizmo.tags?.includes(zn.WorkspaceDisabled)&&e.jsx(Ah,{gizmo:n}),e.jsx(gd,{gizmoId:s,clientThreadId:t})]}),e.jsx(pd,{children:e.jsxs("div",{className:"flex items-center gap-0 overflow-hidden",children:[e.jsx(tm,{clientThreadId:t}),e.jsx(gr,{clientThreadId:t})]})}),e.jsx(fr,{clientThreadId:t})]}),o&&e.jsx(fd,{})]})}function xr({clientThreadId:t}){const s=_e(t),o=Tn(),n=Ge();return o||n?null:e.jsx(Rh,{gizmoId:s,clientThreadId:t})}function Ih({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,enableV2Homepage:a,v2HomepageDisclaimer:r}){const c=ct();let l=e.jsx(qu,{}),d;return c?(d=e.jsx(Ph,{}),l=e.jsx(Xt,{className:"mb-6 h-12 w-12"})):t!=null?(d=a?e.jsx(ir,{clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,v2HomepageDisclaimer:r}):e.jsx($u,{clientThreadId:t}),l=null):d=e.jsx(Dh,{}),e.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-token-text-primary",children:[l,d]})}function Ph({gizmo:t}){const s=vd(),o=t?Sd(t.tools):!1,n=Rs();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-5 text-2xl font-semibold","data-testid":"temporary-chat-label",children:[e.jsx(bd,{id:"temporary-chat-checkbox",name:"temporary-chat-checkbox",checked:!0}),e.jsx(H,{...at.temporaryChat})]}),e.jsxs("div",{className:"max-w-sm text-center text-sm font-normal text-token-text-tertiary",children:[e.jsx(H,{...n?.isWorkspaceAccount()?s?at.temporaryChatBizMemoryAvailable:at.temporaryChatBizMemoryUnavailable:s?at.temporaryChatDescriptionMemoryAvailable:at.temporaryChatDescriptionMemoryUnavailable}),o&&e.jsx("div",{className:"mt-3",children:e.jsx(H,{...at.temporaryChatDescriptionGptActions,values:{link:a=>e.jsx("a",{href:"https://help.openai.com/en/articles/8914046-temporary-chat-faq",target:"_blank",className:"underline",rel:"noreferrer",children:a})}})})]})]})}function Dh(){return e.jsx("div",{className:"mb-5 text-2xl font-semibold",children:e.jsx(H,{...at.howCanIHelpYouToday})})}function vr({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,enableV2Homepage:a,v2HomepageDisclaimer:r}){const c=_e(t),l=Ti(),d=Mn(),{data:m}=It(c),u=xd(),h=_i(()=>navigator.windowControlsOverlay);return(l!=null||c!=null)&&m==null?null:e.jsxs("div",{className:"relative h-full",children:[e.jsx("div",{className:h?.visible?D("absolute right-[calc(100dvw-env(titlebar-area-width,100dvw)-env(titlebar-area-x,0))]",u?"left-[env(titlebar-area-x,0)]":"left-0"):"absolute left-0 right-0",children:e.jsx(xr,{clientThreadId:t})}),m!=null?e.jsx(Vu,{gizmo:m,showStarterPrompts:!0,disableStarterPrompts:d}):e.jsx(Ih,{clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,enableV2Homepage:a,v2HomepageDisclaimer:r})]})}const at=Pe({temporaryChat:{id:"GizmoLanding.temporaryChat",defaultMessage:"Temporary Chat"},temporaryChatBizMemoryAvailable:{id:"g1opBW",defaultMessage:"This chat won't appear in your history and won't use or create memories."},temporaryChatBizMemoryUnavailable:{id:"fQmbtG",defaultMessage:"This chat won't appear your conversation history."},temporaryChatDescriptionMemoryAvailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryAvailable",defaultMessage:"This chat won't appear in history, use or create memories, or be used to train our models. For safety purposes, we may keep a copy for up to 30 days."},temporaryChatDescriptionMemoryUnavailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryUnavailable",defaultMessage:"This chat won't appear in history or be used to train our models. For safety purposes, we may keep a copy of this chat for up to 30 days."},temporaryChatDescriptionGptActions:{id:"GizmoLanding.temporaryChatDescriptionGptActions",defaultMessage:"Any data shared with a third party through GPT actions are subject to the third party's privacy policy. <link>Learn more</link>"},howCanIHelpYouToday:{id:"GizmoLanding.howCanIHelpYouToday",defaultMessage:"How can I help you today?"}});function Lh({className:t,clientThreadId:s,message:o,onModelSelect:n,onDropdownChange:a}){const r=fe(),[c,l]=i.useState(null),[d,m]=i.useState(!1),[u,h]=i.useState(!1),g=yd(),x=Fa(s),v=_e(s),S=Ha({clientThreadId:s,message:o}),M=o.message.metadata?.model_slug,{modelOptions:b,modelSlug:N,animateModelLabelOnRender:w,nuxProps:y,messageModelEnabledTools:_}=S,I=Ua(o.message),j=_.includes(Wn.Search),E=i.useMemo(()=>b.find(k=>k.value==M),[b,M]),{doesUserHaveAnyAccountsWithPlusFeatures:A}=En(),F=i.useRef(null),p=k=>{k||setTimeout(()=>{F.current&&F.current.blur()},10)};if(i.useEffect(()=>{p(d)},[d]),!g||v)return null;const L=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:r.formatMessage(Ho.search),icon:e.jsx(Pn,{className:"icon-sm"}),condition:j&&!I,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:r.formatMessage(Ho.nosearch),icon:e.jsx(Oa,{className:"icon-sm"}),condition:j&&I,eventName:"chatgpt_regenerate_without_search_button_clicked"}];let C,B;y.shouldRenderNux?(C=Fh,B={title:e.jsx(H,{id:"g/+2Hh",defaultMessage:"Optimized your response"}),description:e.jsx(H,{id:"H0Flqm",defaultMessage:"Used {usedModelName} for a faster response that saves your limited {largestModelName} messages",values:{usedModelName:y.usedModelName,largestModelName:y.largestModelName}}),markAsViewed:y.announcement.markAsViewed}):(C=Bh,B={label:x?e.jsx(H,{id:"LBYK9a",defaultMessage:"Change model"}):e.jsx(H,{id:"nygjPN",defaultMessage:"Used {modelName}",values:{modelName:y.usedModelName}})});const U=x&&b.some(k=>Kt(k,A));return e.jsxs(ae.Root,{onOpenChange:k=>{x&&(m(k),a(k),p(k)),k&&Q.logEvent(Z.conversationOpenMessageModelSelector,{has_get_plus_button:U})},children:[e.jsx(C,{...B,children:e.jsx(ga,{ref:F,className:D("cursor-pointer",t),onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:e.jsx(Sr,{modelSlug:N,animateModelLabelOnRender:w,isDropdownOpen:d,isRegenerateEnabled:x,isHovered:u})})}),x&&e.jsxs(ae.Content,{className:"z-30 origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[b.map(k=>{const R=Kt(k,A),{value:f,...O}=k;return e.jsx(Tt,{value:f,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",f,{requestedModelId:f,...Xe({clientThreadId:s})}),n({requestedModelId:f})},onMouseEnter:()=>l(f),onMouseLeave:()=>l(null),isHovered:c===f,messageModelSlug:o.message.metadata?.model_slug,shouldShowUpsell:R,...O},f)}),!!E&&e.jsxs(e.Fragment,{children:[e.jsx(ae.Separator,{}),L.filter(k=>k.condition).map(k=>e.jsx(Tt,{onSelect:()=>{de.logEvent(k.eventName,E.value,{requestedModelId:E.value,...Xe({clientThreadId:s})}),n({requestedModelId:E.value,extraStreamParams:k.extraStreamParams})},includeRegenerate:!0,onMouseEnter:()=>l(k.key),onMouseLeave:()=>l(null),isHovered:c===k.key,messageModelSlug:M,includeCheck:!1,...E,label:k.label,subtitle:"",icon:k.icon},k.key))]})]})]})}function Sr({modelSlug:t,animateModelLabelOnRender:s,isDropdownOpen:o,isRegenerateEnabled:n,isHovered:a,isRegenLabel:r=!1,animateShortLabel:c,omitIcon:l}){const[d,m]=i.useState("initial"),{categories:u}=$n({isRegen:!!r});i.useEffect(()=>{if(s){const b=setTimeout(()=>m("show"),500),N=setTimeout(()=>m("initial"),2e3);return()=>{clearTimeout(b),clearTimeout(N)}}m("initial")},[s]);const h=u.find(({defaultModel:b})=>b===t),g=t===wd?{categoryId:"gpt_3.5",shorterLabel:"3.5"}:{},{categoryId:x,shorterLabel:v}=h??g,S={initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"100%"},visible:{opacity:1,paddingLeft:2,width:"100%",transition:{delay:0,duration:0}}},M=o?"visible":a?"show":d;return e.jsxs(oe.div,{initial:"initial",animate:M,className:"flex items-center pb-0",children:[!l&&(r?e.jsx(Kn,{className:"icon-md"}):x&&e.jsx(Ba,{type:"outline",categoryId:x,className:"icon-md h-4 w-4"})),(n||c)&&e.jsx(oe.span,{className:"overflow-hidden text-clip whitespace-nowrap text-sm",variants:S,transition:{type:"tween",duration:.18},children:v}),n&&e.jsx(qn,{className:D("icon-sm",{"text-token-text-quaternary":!a&&!r},{"text-token-text-secondary":a&&!r})})]})}function Bh({children:t,label:s}){return e.jsx(Qt,{label:s,sideOffset:0,children:t})}function Fh({children:t,title:s,description:o,markAsViewed:n}){return e.jsx(Ln,{announcementKey:lt.ModelSwitcherAutoDowngrade,show:!0,side:"bottom",sideOffset:-4,title:s,description:o,badge:"beta",onDismiss:n,dismissOnOutsideClick:!0,children:t})}function Kt(t,s){const{modelSwitcherDeny:o,subscriptionLevel:n}=t;return!!o&&o.reason===ki.RATE_LIMIT&&n===Ni.PLUS&&!s}const Ho=Pe({search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),Hh=i.memo(Lh),bs="rounded-lg radix-disabled:pointer-events-auto radix-disabled:cursor-not-allowed";function Uh({className:t,clientThreadId:s,message:o,onModelSelect:n,onDropdownChange:a,canRegenerateResponse:r}){const[l,d]=i.useState(null),[m,u]=i.useState(!1),[h,g]=i.useState(!1),x=_e(s),v=Ha({clientThreadId:s,message:o}),S=o.message.metadata?.model_slug,M=o.message.id,{modelOptions:b,modelSlug:N,animateModelLabelOnRender:w,messageModelEnabledTools:y}=v,_=Ua(o.message),I=y.includes(Wn.Search),j=i.useMemo(()=>b.find(C=>C.value===S),[b,S]),E=i.useRef(null),{doesUserHaveAnyAccountsWithPlusFeatures:A}=En(),F=C=>{C||setTimeout(()=>{E.current&&E.current.blur()},10)};if(i.useEffect(()=>{F(m)},[m]),Ei(s))return null;const L=r&&b.some(C=>Kt(C,A));return x?null:e.jsxs(ae.Root,{onOpenChange:C=>{r&&(u(C),a(C),F(C)),C&&Q.logEvent(Z.conversationOpenMessageModelSelector,{has_get_plus_button:L,is_new_regen_dropdown:!0})},children:[r?e.jsx(zh,{label:e.jsx(H,{id:"wDs5sz",defaultMessage:"Switch model"}),children:e.jsx(ga,{ref:E,className:D("cursor-pointer",t),onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:e.jsx(Sr,{modelSlug:N,animateModelLabelOnRender:w,isDropdownOpen:m,isRegenerateEnabled:r,isHovered:h,isRegenLabel:!0,omitIcon:!1})})}):null,r&&e.jsx(ae.Portal,{children:e.jsxs(ae.Content,{className:"z-30 min-w-fit origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[e.jsx(ae.Item,{disabled:!0,className:"pb-0 pt-2",children:e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(H,{id:"bFLh5u",defaultMessage:"Switch model"})})}),e.jsx(Oh,{clientThreadId:s,messageId:M,onModelSelect:n,messageModelSlug:S,omitModelIcons:!0,modelOptions:b,setHoveredOption:d,hoveredOption:l,retryOption:j,lastResponseUsedSearch:_,modelSupportsSearch:I,doesUserHaveAnyAccountsWithPlusFeatures:A})]})})]})}function Oh({clientThreadId:t,messageId:s,modelOptions:o,messageModelSlug:n,onModelSelect:a,omitModelIcons:r,setHoveredOption:c,hoveredOption:l,retryOption:d,lastResponseUsedSearch:m,modelSupportsSearch:u,doesUserHaveAnyAccountsWithPlusFeatures:h}){const g=fe(),[x,v]=i.useMemo(()=>jd(o,w=>w.subcategory),[o]),S=i.useMemo(()=>{const w=new Map;return x.forEach(y=>{const _=y.subcategory;_&&(w.has(_)||w.set(_,[]),w.get(_)?.push(y))}),w},[x]),M=D("icon-sm",r&&"order-10 ml-auto text-token-text-tertiary icon-md"),b=r?"right":"left",N=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:g.formatMessage(tn.search),icon:e.jsx(Pn,{className:M}),condition:u&&!m,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:g.formatMessage(tn.nosearch),icon:e.jsx(Oa,{className:M}),condition:u&&m,eventName:"chatgpt_regenerate_without_search_button_clicked"}];return e.jsxs(e.Fragment,{children:[v.map(w=>{const{value:y,..._}=w;return e.jsx(Tt,{value:y,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",y,{requestedModelId:y,...Xe({clientThreadId:t,messageId:s})}),a({requestedModelId:y})},includeRegenerate:!1,onMouseEnter:()=>c(y),onMouseLeave:()=>c(null),isHovered:l===y,messageModelSlug:n,includeCheck:!1,shouldShowUpsell:Kt(w,h),className:bs,..._,icon:r?e.jsx("span",{className:M}):_.icon,justifyIcon:b,wrapIcon:!r},y)}),[...S.entries()].map(([w,y])=>e.jsxs(ae.Sub,{children:[e.jsx(ae.SubMenuTrigger,{children:e.jsx("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:w})}),e.jsx(ae.Portal,{children:e.jsx(ae.SubContent,{className:"min-w-fit",children:y.map(_=>{const{value:I,...j}=_;return e.jsx(Tt,{value:I,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",I,{requestedModelId:I,...Xe({clientThreadId:t,messageId:s})}),a({requestedModelId:I})},includeRegenerate:!1,onMouseEnter:()=>c(I),onMouseLeave:()=>c(null),isHovered:l===I,messageModelSlug:n,includeCheck:!1,className:bs,...j,icon:null,justifyIcon:b,wrapIcon:!r,shouldShowUpsell:Kt(_,h)},w+"-"+I)})})})]},w)),!!d&&e.jsxs(e.Fragment,{children:[e.jsx(ae.Separator,{}),e.jsx(Tt,{onSelect:()=>{de.logEvent("chatgpt_regenerate_try_again_button_clicked",d.value,{requestedModelId:d.value,...Xe({clientThreadId:t,messageId:s})}),a({requestedModelId:d.value})},includeRegenerate:!0,onMouseEnter:()=>c(d.value),onMouseLeave:()=>c(null),messageModelSlug:n,includeCheck:!1,className:bs,...d,label:g.formatMessage(tn.tryAgain),subtitle:d.label,icon:e.jsx(Kn,{className:M}),justifyIcon:b,wrapIcon:!r},d.value),N.filter(w=>w.condition).map(w=>e.jsx(Tt,{onSelect:()=>{de.logEvent(w.eventName,d.value,{requestedModelId:d.value,...Xe({clientThreadId:t,messageId:s})}),a({requestedModelId:d.value,extraStreamParams:w.extraStreamParams})},includeRegenerate:!1,onMouseEnter:()=>c(w.key),onMouseLeave:()=>c(null),isHovered:l===w.key,messageModelSlug:n,includeCheck:!1,className:bs,...d,label:w.label,subtitle:"",icon:w.icon,justifyIcon:b,wrapIcon:!r},w.key))]})]})}function zh({children:t,label:s}){return e.jsx(Qt,{label:s,sideOffset:0,children:t})}const tn=Pe({tryAgain:{id:"VbsBGW",defaultMessage:"Try again"},search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),Gh=i.memo(Uh),Uo=Le(()=>Be(()=>import("./j41xn51jmw95fwqz.js").then(t=>t.q_),__vite__mapDeps([3,1,2,4])).then(t=>t.MemoryActionResult));function Oo(t,s,o){ee.updateTree(t,n=>{n.updateNodeMetadata(s,{inlineComparisonRating:o})})}function zo(t){return{is_dark_mode:t==="dark",time_since_loaded:Math.floor(performance.now()/1e3),page_height:window?.innerHeight,page_width:window?.innerWidth,pixel_ratio:window?.devicePixelRatio,screen_height:window?.screen?.height,screen_width:window?.screen?.width}}const Go=({messages:t})=>{for(const{message:{metadata:s}}of t){const{augmented_paragen_prompt_label:o}=s??{};if(o)return o}};function Wh(t){const s=i.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null}),o=i.useRef({left:null,right:null});return t.stubSideBySideFeedback?e.jsx(br,{setPreferredFeedback:()=>{},leftVariantId:"left-placeholder",rightVariantId:"right-placeholder",leftTurn:null,rightTurn:null,originalTurn:null,hasActiveRequest:!0,visibilityStateRef:s,firstVisibleTokenTimestampsRef:o,...t}):e.jsx(Vh,{...t,visibilityStateRef:s,firstVisibleTokenTimestampsRef:o})}function Vh(t){const{clientThreadId:s,variantIds:o,variantsInStreamInfo:n,turnIndex:a,firstVisibleTokenTimestampsRef:r}=t;if(o.length!==2)throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");const c=so(),l=$h(),d=_n(),{resolvedTheme:m}=Ai(),[u,h]=i.useMemo(()=>za(o.join(""))()<.5?[0,1]:[1,0],[o[0],o[1]]),g=u<h?"left":"right",x=g==="left"?"right":"left",v=o[u],S=o[h],M=Mt(wo(s,v)).id,b=Mt(wo(s,S)).id,N=Mt(ln(s,a,M)),w=Mt(ln(s,a,b)),y=g==="left"?N:w,_=g==="left"?w:N,I=n.display_treatment==="unskippable",j=c?"skippable_parallel_2_in_stream:a:2.0":"skippable_parallel_2_in_stream:a:1.5";i.useEffect(()=>(mn.setState({displayingSideBySideFeedback:!0,unskippable:I}),()=>{mn.setState({displayingSideBySideFeedback:!1,unskippable:!1})}),[I]),Cd();const E=i.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null});i.useEffect(()=>Ri(Ii,{requestCompletion:()=>{const F=Ke(y.messages)?.completionSampleFinishTime,p=Ke(_.messages)?.completionSampleFinishTime,L=ee.getServerThreadId(s);if(l){const B=ee.getTree(s).getParentPromptNode(M),U=[N,w].map((f,O)=>({messageId:f.messages[f.messages.length-1].message.id,loadFirstTokenTime:O===0?r.current.left:r.current.right,loadEndTime:Ke(f.messages)?.completionSampleFinishTime})),k={},R=B.metadata?.variantsInStreamInfo==null&&B.message.metadata?.paragen_variants_info!=null;for(const f of U)k[f.messageId]=R?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:f.loadFirstTokenTime,load_end_time:f.loadEndTime};ys({shouldUseNewParagenEndpoint:l,params:{conversation_id:L,displayed_message_ids:U.map(f=>f.messageId),message_metadatas:k,rating:"skipped",selected_message_id:null,source_timestamp:Date.now(),ui_variant:c?2:1,user_prompt_message_id:B.message.id}})}else ys({shouldUseNewParagenEndpoint:l,params:{feedback_version:j,original_message_id:y.messages[y.messages.length-1]?.message.id,new_message_id:_.messages[_.messages.length-1]?.message.id,conversation_id:L,completion_comparison_rating:"skip",new_completion_placement:x,feedback_start_time:t.conversationTurnMountTime,compare_step_start_time:t.conversationTurnMountTime,original_completion_load_start_time:t.conversationTurnMountTime,original_completion_load_end_time:F??0,new_completion_load_start_time:t.conversationTurnMountTime,new_completion_load_end_time:p??0,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:zo(m),...E.current}})}}),[N,w,M,s,t.conversationTurnMountTime,j,x,y?.messages,_?.messages,m,l,c,r]);const A=F=>{const L=ee.getTree(s).getLeafFromNode(F);ee.setThreadCurrentLeafId(s,L.id);const C=F===v,B=C===(g==="left"),U=Ke(y.messages)?.completionSampleFinishTime,k=Ke(_.messages)?.completionSampleFinishTime;y.messages.length>0&&Oo(s,y.messages[y.messages.length-1].nodeId,B?"original":"new"),_.messages.length>0&&Oo(s,_.messages[_.messages.length-1].nodeId,B?"original":"new");let R;U==null||k==null?R=B?"partial_load_comparison_original":"partial_load_comparison_new":R=B?"original":"new";const f=ee.getServerThreadId(s);if(l){const O=[N,w].map((J,ue)=>({messageId:J.messages[J.messages.length-1].message.id,loadFirstTokenTime:ue===0?r.current.left:r.current.right,loadEndTime:Ke(J.messages)?.completionSampleFinishTime})),$=C?O[0].messageId:O[1].messageId,W=ee.getTree(s).getParentPromptNode(M),xe={},re=W.metadata?.variantsInStreamInfo==null&&W.message.metadata?.paragen_variants_info!=null;for(const J of O)xe[J.messageId]=re?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:J.loadFirstTokenTime,load_end_time:J.loadEndTime};ys({shouldUseNewParagenEndpoint:l,params:{conversation_id:f,displayed_message_ids:O.map(J=>J.messageId),message_metadatas:xe,rating:"selected",selected_message_id:$,source_timestamp:Date.now(),ui_variant:c?2:1,user_prompt_message_id:W.message.id}})}else ys({shouldUseNewParagenEndpoint:l,params:{feedback_version:j,original_message_id:y.messages[y.messages.length-1]?.message.id,new_message_id:_.messages[_.messages.length-1]?.message.id,conversation_id:f,completion_comparison_rating:R,new_completion_placement:x,feedback_start_time:t.conversationTurnMountTime,compare_step_start_time:t.conversationTurnMountTime,original_completion_load_start_time:t.conversationTurnMountTime,original_completion_load_end_time:U??null,new_completion_load_start_time:t.conversationTurnMountTime,new_completion_load_end_time:k??null,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:zo(m),...E.current}})};return e.jsx(br,{...t,setPreferredFeedback:A,leftVariantId:v,rightVariantId:S,leftTurn:N,rightTurn:w,hasActiveRequest:d,originalTurn:y,visibilityStateRef:E})}function qh(t){if(!t.length)return!1;const s=t.filter(o=>o.type===Eo.Text||o.type===Eo.MultiText).filter(o=>o.message.message.status!=="finished_successfully"&&o.message.message.metadata?.snorkle_status!==void 0);return s.length>0&&s.every(o=>{const n=o.message.message.content;return n?.content_type===pa.Text&&n.parts.join("")===""})}function br({setPreferredFeedback:t,leftVariantId:s,rightVariantId:o,leftTurn:n,rightTurn:a,hasActiveRequest:r,originalTurn:c,visibilityStateRef:l,...d}){const{defaultParagenLabel:m,shouldShowParagenLabels:u=!1}=Ta(),h=n&&Go(n)||m,g=a&&Go(a)||m,x=i.useMemo(()=>n?.messages??[],[n?.messages]),v=i.useMemo(()=>a?.messages??[],[a?.messages]),{avatarClassName:S,firstVisibleTokenTimestampsRef:M}=d,b=i.useMemo(()=>Es(x),[x]),N=i.useMemo(()=>Es(v),[v]),w=xa(),[y,_]=i.useMemo(()=>[b,N].map(O=>qh(O)),[b,N]),I=it(n?Ms.getRequestIdFromConversationTurn(n):"")||y,j=it(a?Ms.getRequestIdFromConversationTurn(a):"")||_,E=n?.role===ze.User,A=a?.role===ze.User,F=i.useRef(null),p=i.useRef(null),L=i.useRef(null),C=d.stubSideBySideFeedback||y,B=d.stubSideBySideFeedback||_;!C&&M.current.left==null&&(M.current.left=Date.now()),!B&&M.current.right==null&&(M.current.right=Date.now()),i.useEffect(()=>{if(F.current&&p.current&&L.current){const O=Array(11).fill(0).map((te,W)=>W/10),$=new IntersectionObserver(te=>te.forEach(W=>{W.target===p.current?(l.current.left_visibility_initial==null&&(l.current.left_visibility_initial=W.intersectionRatio),l.current.left_visibility_max=Math.max(l.current.left_visibility_max??0,W.intersectionRatio)):W.target===L.current&&(l.current.right_visibility_initial==null&&(l.current.right_visibility_initial=W.intersectionRatio),l.current.right_visibility_max=Math.max(l.current.right_visibility_max??0,W.intersectionRatio))}),{root:F.current,threshold:O});return $.observe(p.current),$.observe(L.current),()=>$.disconnect()}},[l]);const{data:U}=va(void 0,!1,w),k=so(),R=e.jsx("div",{className:"text-pretty px-6 pb-5 pt-1 text-center text-sm text-token-text-secondary",children:e.jsx(H,{id:"TK934w",defaultMessage:"Which response do you prefer? Responses may take a moment to load."})}),f=Ge();return e.jsxs("div",{className:"relative flex flex-col",children:[e.jsxs("div",{className:D("sticky z-[1] text-pretty bg-token-main-surface-primary px-6 text-center text-lg",f&&"top-[var(--thread-leading-height)] pt-3",!f&&"top-[-1px]",k&&!f?"md:top-header-height":f?"":"md:static"),"data-testid":"paragen-feedback-title",children:[e.jsx(H,{id:"JgCHDY",defaultMessage:"You’re giving feedback on a new version of ChatGPT."}),k?R:null]}),k?null:R,e.jsx("div",{className:"relative -mb-2 snap-x snap-mandatory overflow-x-auto px-3 pb-4 md:px-5 lg:px-10",ref:F,children:e.jsx("div",{className:D(!f&&"min-w-fit"),children:e.jsxs("div",{className:D("mx-auto flex max-w-6xl items-start",k&&!f&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",!k&&!f&&"gap-4 sm:gap-6",k&&f&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",f&&!k&&"gap-4 sm:gap-6"),children:[e.jsxs(Wo,{horizontalScrollContainerRef:F,rootElementRef:p,onClick:()=>{t(s)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:C,children:[e.jsxs($o,{children:[e.jsx(fn,{messages:x,isUserTurn:E,avatarClassName:S}),e.jsx(qo,{children:u?e.jsx("span",{className:"font-bold text-token-text-primary",children:h}):e.jsx(H,{...Ko.responseNumber,values:{responseIndex:1}})})]}),k&&C?e.jsx(Vo,{}):e.jsxs(e.Fragment,{children:[U!=null&&!E&&e.jsx(Uo,{clientThreadId:d.clientThreadId,messages:x,isParagen:!0}),e.jsx(vn,{...d,groupedMessagesToRender:b,allGroupedMessages:b,isEditing:!1,isUserTurn:E,isCompletionRequestInProgress:I,hasActiveRequest:r,handleEnterEdit:ms,handleExitEdit:ms,shouldGrowContainer:!1}),e.jsx(Yo,{clientThreadId:d.clientThreadId,conversationTurnMountTime:d.conversationTurnMountTime,turn:n,originalTurn:c})]})]}),e.jsxs(Wo,{horizontalScrollContainerRef:F,rootElementRef:L,onClick:()=>{t(o)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:B,children:[e.jsxs($o,{children:[e.jsx(fn,{messages:v,isUserTurn:A,avatarClassName:S}),e.jsx(qo,{children:u?e.jsx("span",{className:"font-bold text-token-text-primary",children:g}):e.jsx(H,{...Ko.responseNumber,values:{responseIndex:2}})})]}),k&&B?e.jsx(Vo,{}):e.jsxs(e.Fragment,{children:[U!=null&&!A&&e.jsx(Uo,{clientThreadId:d.clientThreadId,messages:v,isParagen:!0}),e.jsx(vn,{...d,groupedMessagesToRender:N,allGroupedMessages:N,isEditing:!1,isUserTurn:A,isCompletionRequestInProgress:j,hasActiveRequest:r,handleEnterEdit:ms,handleExitEdit:ms,shouldGrowContainer:!1}),e.jsx(Yo,{clientThreadId:d.clientThreadId,conversationTurnMountTime:d.conversationTurnMountTime,turn:a,originalTurn:c})]})]})]})})})]})}function Wo({horizontalScrollContainerRef:t,rootElementRef:s,onClick:o,children:n,hasActiveRequest:a,isWaitingOnFirstUserVisibleToken:r}){const c=so(),l=Ge(),{scrollX:d}=Md({layoutEffect:!1,container:t,target:s}),m=Td(),u=_d(),h=i.useRef(null),g=i.useRef(null),x=i.useRef(null),[v,S]=i.useState(!1),[M,b]=i.useState(!1),[N,w]=i.useState(!1),[y,_]=i.useState(0);i.useEffect(()=>{if(!c)return;const L=new IntersectionObserver(C=>{for(const B of C)B.target===h.current?S(B.isIntersecting):B.target===x.current?w(B.isIntersecting):B.target===g.current&&b(B.isIntersecting)},{root:m?.current,rootMargin:l?`0px 0px -${y}px 0px`:void 0});return h.current&&g.current&&x.current&&(L.observe(h.current),L.observe(g.current),L.observe(x.current)),()=>{L.disconnect()}},[y,c,l,m]);const I=!N&&(M||v),j=kd(d,L=>I?-1*L:0),E=No(0);i.useEffect(()=>{if(!c)return;const L=new ResizeObserver(C=>{ps(C.length===1,"entryList.length === 1");const B=C[0];ps(B.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),E.set(B.contentBoxSize[0].inlineSize)});return s.current&&L.observe(s.current),()=>{L.disconnect()}},[c,E,s]);const A=No(0);i.useEffect(()=>{if(!c)return;const L=new ResizeObserver(C=>{ps(C.length===1,"entryList.length === 1");const B=C[0];ps(B.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),A.set(B.contentBoxSize[0].blockSize+16),_(B.contentBoxSize[0].blockSize)});return u.current&&L.observe(u.current),()=>{L.disconnect()}},[c,A,u]);const F=e.jsx(Rt,{className:c?"px-5":"mt-4 self-start",onClick:o,"data-testid":"paragen-prefer-response-button",children:e.jsx(H,{id:"U2EAH6",defaultMessage:"I prefer this response"})}),p=r;return e.jsxs("div",{"data-paragen-root":!0,className:D("relative flex w-full min-w-[min(450px,80vw)] snap-center flex-col gap-1 text-left",l&&c&&"pl-3 pr-5 sm:w-[calc(100cqw-62px)] sm:pl-3 sm:pr-5 md:px-10",!l&&c&&"px-10",c?"min-h-60 py-4":"rounded-2xl border border-token-main-surface-tertiary bg-white p-5 dark:bg-gray-700"),ref:s,children:[e.jsx("div",{className:D("absolute left-0 right-0 top-48 h-px","invisible"),ref:h}),e.jsx("div",{className:D("absolute bottom-0 left-0 right-0 top-48","invisible"),ref:g}),e.jsx("div",{className:D("absolute bottom-0 left-0 right-0 h-px","invisible"),ref:x}),n,c?e.jsx("div",{className:"flex-1"}):null,c?e.jsx("div",{className:"mt-4 min-h-10",children:p?null:e.jsx(oe.div,{style:{translateX:j,width:E,bottom:A},animate:{opacity:100},initial:{opacity:0},transition:{ease:"easeOut",duration:.2,delay:.5},className:D({fixed:I,"z-20 flex w-full justify-center":!0}),children:F})}):a?null:F]})}function Vo(){return e.jsxs("div",{className:"flex w-full flex-col gap-4 pb-5 pt-3",children:[e.jsx(ot,{className:"h-4 w-[75%]"}),e.jsx(ot,{className:"h-4 w-[50%]"}),e.jsx(ot,{className:"h-4 w-[80%]"}),e.jsx(ot,{className:"h-4 w-[55%]"}),e.jsx(ot,{className:"h-4 w-[66%]"}),e.jsx(ot,{className:"h-4 w-[64%]"}),e.jsx(ot,{className:"h-4 w-[48%]"})]})}function so(){const{layer:t}=We("3119715334");return t.get("should-enable-hojicha",!1)}const qo=he.div`text-sm text-token-text-secondary font-semibold`,$o=he.div`flex gap-4 items-center mb-1`,ot=he.div`animate-pulse rounded-[4px] bg-token-main-surface-tertiary`;function Yo({clientThreadId:t,conversationTurnMountTime:s,turn:o,originalTurn:n}){const a=Un();if(!a.showParagenMetadata||!a.showDebugConversationTurns&&!a.forceParagen||o==null)return null;let r=o===n?"ORIGINAL":"NEW";const c=o.messages[o.messages.length-1],l=c?.message?.metadata?.__internal;if(l){const{model_id:h,model_definition_slug:g,model_definition_virtual_model_id:x,alternative_model_selection_rule:v,augmented_paragen_prompt_group_id:S,augmented_paragen_prompt_id:M,augmented_paragen_prompt:b}=l;h&&(r+=`
Model ID: ${h}`),g&&(r+=`
Model Slug: ${g}`),x&&(r+=`
Virtual Model ID: ${x}`),v&&(r+=`
Alternative Model Rule: ${v}`),S&&(r+=`
Prompt Group ID: ${S}`),M&&(r+=`
Prompt ID: ${M}`),b&&(r+=`
Prompt: ${b}`)}r+=`
Message ID: ${c.message.id}`;const m=ee.getTree(t).getParentPromptNode(o.variantIds[0]),u=m.metadata?.variantsInStreamInfo==null&&m.message.metadata?.paragen_variants_info!=null;return r+=`
User prompt message ID: ${m.message.id}`,r+=`
Is Persisted Paragen? ${u}`,r+=`
Completion Sample Finish Time: ${u?`${s} (persisted)`:Ke(o.messages)?.completionSampleFinishTime}`,e.jsx("div",{className:"whitespace-pre-wrap text-sm text-red-500",children:r})}async function ys({shouldUseNewParagenEndpoint:t,params:s}){t?await Nt.submitParagenSelectionV2(s):await Nt.submitMessageComparisonFeedback(s)}function $h(){const{value:t}=Ve("3894844102");return t}const Ko=Pe({responseNumber:{id:"ConversationTurnTwoUpFeedback.responseNumber",defaultMessage:"Response {responseIndex, number}"}}),Xo=[1,2,3,4,10,20,30],Yh=.5;function Kh({clientThreadId:t,conversationLeafId:s}){const o=Ga(Wa.isBusinessWorkspace),n=i.useRef(!1),a=Zt(t),r=Is(t),{isUnauthenticated:c}=De(),l=i.useMemo(()=>{if(!a)return-1;const A=za(a);return A()>Yh?-1:Xo[Math.floor(A()*Xo.length)]},[a]),d=Pi(t,s),m=d[d.length-1],u=i.useMemo(()=>Ms.getRequestIdFromConversationTurn(m),[m]),h=it(u),[g,x]=i.useState(null),[v,S]=i.useState(!1),[M,b]=i.useState(!1),[N,w]=i.useState(!1),y=A=>{const F=Ke(d)?.messages[0]?.message.id;x(A),j(F,A)},_=d.filter(A=>A.role===ze.Assistant).length,I=m?.role===ze.Assistant,j=i.useMemo(()=>Da((A,F)=>{a&&A&&Nt.submitConversationRating({conversation_id:a,message_id:A,rating:F,shown_at_assistant_turn:l}),Q.logEvent(Z.conversationRatingSubmitted,{rating:F,showAtAssistantTurn:l,conversationId:a}),S(!0),setTimeout(()=>{b(!0)},1500)},2e3),[a,l]),E=_!==l||h||!I||!!o||r?.kind!==Qe.PrimaryAssistant||N||c;return i.useEffect(()=>{!E&&!n.current&&(Q.logEvent(Z.conversationRatingShown,{showAtAssistantTurn:l,conversationId:a}),n.current=!0)},[E]),N||E?null:e.jsxs("div",{className:"mx-auto",children:[e.jsx(es,{children:v&&!M&&e.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Qo,{$padded:!0,children:e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(H,{id:"rating.thanks",defaultMessage:"Thanks for your feedback!"})})})},"submitted")}),!v&&e.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},children:e.jsxs(Qo,{$padded:!1,children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 px-4 py-3 text-sm text-token-text-secondary",children:[e.jsx(H,{id:"rating.instructions",defaultMessage:"Is this conversation helpful so far?"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx(sn,{$selected:g==="thumbsUp",onClick:()=>y("thumbsUp"),children:e.jsx(Va,{className:"icon-md"})}),e.jsx(sn,{$selected:g==="thumbsDown",onClick:()=>y("thumbsDown"),children:e.jsx(qa,{className:"icon-md"})})]})]}),e.jsx("div",{className:"w-px flex-1 self-stretch bg-token-main-surface-tertiary"}),e.jsx(sn,{className:"p-3",$selected:!1,onClick:()=>w(!0),children:e.jsx(Di,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})})]})},"rating")]})}const sn=he.button`
  ${t=>t.$selected?"text-token-text-primary":"text-token-text-secondary"}
  hover:text-token-text-primary
`,Qo=he.div`inline-flex rounded-xl border border-gray-100 dark:border-gray-700
${t=>t.$padded&&"py-3 px-4"}
`,Xh=Le(()=>Be(()=>import("./j6zgnclmb2g3pe6k.js"),__vite__mapDeps([33,1,2,3,4,34,8])));function Qh({clientThreadId:t,conversationLeafId:s,canShowInlineMessageFeedback:o,messageForRating:n,allGroupedMessages:a,currentModelId:r}){let c=null;const l=Li(t,s),d=Zt(t),m=On(g=>g.voiceFeedbackThread),u=d===m,{voiceName:h}=Nd();return l?null:(u&&d?(Bi.feedbackShown.success({voice:h}),c=e.jsx("div",{className:"text-center",children:e.jsx(Ed,{serverThreadId:d})})):n.rating&&o?c=e.jsx(Xh,{clientThreadId:t,conversationMessage:n,allGroupedMessages:a,currentModelId:r}):c=e.jsx("div",{className:"text-center",children:e.jsx(Kh,{clientThreadId:t,conversationLeafId:s})}),e.jsx("div",{className:"mt-3 w-full empty:hidden",children:c}))}const Zh=Le(()=>Be(()=>import("./c6vv4keipixmtujc.js"),__vite__mapDeps([35,1,2,36,3,4,37])).then(t=>t.VoicePlayButton)),Zo=128,Jo={minHeight:"calc(100cqh - var(--thread-leading-height) - var(--thread-trailing-height) - var(--previous-turn-min-height))"};function Jh(t){const{turnIndex:s,conversationLeafId:o,isFinalTurn:n,clientThreadId:a,onChangeItemInView:r,onChangeRating:c,currentModelId:l,avatarClassName:d,showAvatar:m=!0,scrollToMessageId:u,shouldShowDateHeader:h}=t,g=fe(),x=Bn(),v=!!x&&Fi(x),S=Tn(),M=Ga(Wa.isBusinessWorkspace),b=oa(),{value:N}=Ve("2848981774"),w=ee.getServerThreadId(a),y=Mt(ln(a,s,o)),{messages:_,variantIds:I,variantsInStreamInfo:j}=y,E=Es(_),A=Ad();let F=_[_.length-1];for(const G of E){const me=zu(G);if(me.some(st=>A.has(st.message.id))){F=me[me.length-1];break}}const p=_.slice(0,_.indexOf(F)+1),L=Gn(),[C,B]=i.useState(!1),[U,k]=i.useState(!1),R=I.findIndex(G=>p.some(me=>me.nodeId===G)),f=y.role===ze.User,O=ct(),$=_e(a),te=It(y.gizmoId??$)?.data,W=Fs(l),xe=Rd(l),re=Ge(),J=Is(a,te?.gizmo.id),we=ia(a)===la.STREAMING,Fe=!1,{value:ie}=js("2291672486"),ge=p.some(G=>G.message.content.content_type===pa.MultimodalText),{layer:je}=We("1547743984"),ve=w&&L&&je.get("show_share_button_inline",!1),{isUnauthenticated:Re}=De(),[Ie,He]=i.useState(!1),[V,P]=i.useState(!1),Y=y.messages.map(G=>G.message.id),q=i.useRef(null),z=_[_.length-1],X=z.rating,Se=(u?.length??0)>2&&u!=="finalAgentTurn"&&n&&N&&re,pe=()=>{p.length===1&&(Q.logEvent(Z.editPrompt,{id:p[0].message.id,threadId:ee.getServerThreadId(a)}),de.logEvent("chatgpt_edit_prompt"),B(!0))},Ce=i.useCallback(()=>{B(!1)},[]),le=i.useCallback(G=>{Id(a,s,b,G)},[a,s,b]),Me=G=>{c({nodeId:z.nodeId,messageId:z.message.id,rating:G}),Q.logEvent(G==="thumbsDown"?Z.messageFeedbackThumbsDownClicked:Z.messageFeedbackThumbsUpClicked,{id:z.message.id,threadId:ee.getServerThreadId(a),model:l,rating:G}),k(!0)},[K]=i.useState(()=>Date.now()),Te=i.useMemo(()=>Ms.getRequestIdFromConversationTurn(y),[y]),Ue=ca({clientThreadId:a,conversationLeafId:o}),se=it(Te)&&!Ue,dt=_n(),ut=Es(p),mt=i.useRef(!1);i.useEffect(()=>{if(mt.current||u===void 0||!N||!re||!q.current){u==="finalAgentTurn"&&n&&mt.current&&ee.updateScrollToMessageId(a,void 0);return}(Y.includes(u)||u==="finalAgentTurn"&&n)&&(mt.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(q.current)if(u==="finalAgentTurn"&&n)q.current.scrollIntoView({behavior:"instant",block:"end"}),ee.updateScrollToMessageId(a,void 0);else{const G=q.current.offsetHeight;let me;G>Zo?me=Zo-G:me=0,q.current.style.scrollMarginTop=`calc(${me}px + 2px + var(--thread-leading-height))`,q.current.scrollIntoView({behavior:"smooth"})}})}))},[u,q.current]);const{showDebugConversationTurns:Us}=Un(),Pt=ua(a),qe=Fa(a),ht=Pd({clientThreadId:a,conversationMode:J}),ke=Ze(a),gt=i.useCallback(({requestedModelId:G,systemMessage:me,juice:st,extraStreamParams:jt})=>{const Ut=new qt;ht({id:z.nodeId,eventMetadata:{eventSource:"mouse"},turnTracker:Ut,requestedModelId:G,systemMessage:me,juice:st,extraStreamParams:jt})},[z,ht]),ss=Fe,pt=!S&&!Pt&&!O&&!f,Dt=Dd(),Lt=F.message.author.role===ze.Assistant?F.message:null;Ld({isCompletionRequestInProgress:se,isUserTurn:f,message:Lt});const Bt=Hi(a,I),{isOpen:ft}=Bd(),Je=Fd(J),Ft=!Dt&&!Je&&pt&&n&&j?.num_variants_in_stream===2&&!z.inlineComparisonRating&&!Bt,$e=Hd(y),et=Ft,Os=Ft&&!$e,xt=!f&&!S&&!Pt&&!Je&&!we&&!se&&!ft,vt=xt&&(!M||ss||xe||v)&&!Je&&!Re&&!O,St=!S&&!((se||we)&&n)&&I.length>1&&!C&&!et;let bt=!1;if(f&&p.length===1){const{shouldHideContent:G}=Ud(p[0]);G&&(bt=!0)}const Ht=f&&!Je&&!S&&!ge&&p.length===1&&!bt&&!C&&!Re,zs=G=>{r(I[G]),Q.logEvent(Z.changeNode,{intent:"toggle_between"})};if(!Od(y,p,Us)&&!et)return Se?e.jsx("div",{style:Jo}):null;const tt=p.some(({message:G})=>Ui.getAssetPointers(G).length>0),ns=!tt&&n&&qe&&!ie?e.jsx(fs,{onClick:()=>{de.logEvent("chatgpt_regenerate_try_again_button_clicked",l,{requestedModelId:l,...Xe({clientThreadId:a,turnIndex:s})});const G=new qt;ht({id:ke,eventMetadata:{eventSource:"mouse"},turnTracker:G}),Ts()},icon:Kn,label:g.formatMessage({id:"ConversationTurn.regenerateTooltip",defaultMessage:"Regenerate"}),testId:"regenerate-turn-action-button"}):null,yt="h-[30px] rounded-md px-1 text-token-text-secondary hover:bg-token-main-surface-secondary",Ws=!tt&&ie?e.jsx(Gh,{className:yt,clientThreadId:a,message:z,onModelSelect:gt,onDropdownChange:He,canRegenerateResponse:qe}):null,Vs=!f&&!bt&&(!n||!se)?e.jsx(Jd,{onClick:le}):null,os=!f&&(!n||!se)&&(z.disclaimers??[]).length===0&&z.nodeId?e.jsx(Zh,{conversationId:a,message:z,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-xs text-token-text-tertiary hover:text-token-text-primary"}):null,as=!f&&z&&(!n||!se)?e.jsx(eu,{message:z,isFinalTurn:n,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-token-text-tertiary hover:text-token-text-primary"}):null,wt=vt&&!se?e.jsxs("div",{className:"flex",children:[X!=="thumbsDown"&&e.jsx(fs,{onClick:()=>Me("thumbsUp"),disabled:X==="thumbsUp",icon:X==="thumbsUp"?zd:Va,label:g.formatMessage({id:"ConversationTurn.goodResponseTooltip",defaultMessage:"Good response"}),testId:"good-response-turn-action-button"},`thumbsUp:${z.nodeId}`),X!=="thumbsUp"&&e.jsx(fs,{onClick:()=>Me("thumbsDown"),disabled:X==="thumbsDown",icon:X==="thumbsDown"?Gd:qa,label:g.formatMessage({id:"ConversationTurn.badResponseTooltip",defaultMessage:"Bad response"}),testId:"bad-response-turn-action-button"},`thumbsDown:${z.nodeId}`)]}):null,qs=ve&&e.jsx(fs,{onClick:()=>{Ns.openSharingModal(w)},label:g.formatMessage({id:"ConversationTurn.shareButtonTooltip",defaultMessage:"Share conversation"}),className:"sm:hidden",icon:Wd}),$s=!ie&&e.jsx(Hh,{className:yt,clientThreadId:a,message:z,onModelSelect:gt,onDropdownChange:He});function rs(G){return re?G:e.jsx(Vn,{clientThreadId:a,isStaticSharedThread:S,withVerticalPadding:!0,withHorizontalPadding:!et,children:G})}function is(G){return re?G:e.jsx($t,{children:G})}return e.jsxs(e.Fragment,{children:[h&&e.jsx(Vd,{turn:y}),e.jsxs("article",{className:D("w-full scroll-mb-[var(--thread-trailing-height,150px)] text-token-text-primary focus-visible:outline-2 focus-visible:outline-offset-[-4px]",u==="finalAgentTurn"&&N&&re?"opacity-0":""),style:Se?Jo:void 0,ref:q,dir:"auto","data-testid":`conversation-turn-${s}`,"data-scroll-anchor":n,onMouseEnter:()=>P(!0),onMouseLeave:()=>P(!1),children:[e.jsx(qd,{role:y.role}),rs(e.jsx(e.Fragment,{children:et?e.jsx(Wh,{isFeedbackEnabled:vt,variantIds:I,variantsInStreamInfo:j,conversationTurnMountTime:K,stubSideBySideFeedback:Os,...t}):is(e.jsxs(e.Fragment,{children:[!f&&m&&e.jsx(eg,{children:e.jsx(fn,{messages:p,isUserTurn:f,avatarClassName:d,gizmo:te})}),e.jsx("div",{className:D("group/conversation-turn relative flex w-full min-w-0 flex-col",!f&&$d),children:e.jsx("div",{className:"flex-col gap-1 md:gap-3",children:e.jsxs(e.Fragment,{children:[!f&&!S&&e.jsx(Yd,{messages:p,clientThreadId:a,gizmoId:te?.gizmo.id}),!1,e.jsx(vn,{groupedMessagesToRender:ut,allGroupedMessages:E,...t,isEditing:C,isUserTurn:f,isCompletionRequestInProgress:se,isFeedbackEnabled:vt,isFinalTurn:n,hasActiveRequest:dt,showEditButton:Ht,handleEnterEdit:pe,handleExitEdit:Ce}),W&&e.jsx("div",{className:"mb-4",children:e.jsx(Kd,{messages:p})}),(xt||St)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:D("mb-2 flex gap-3 empty:hidden",f?"mr-1 flex-row-reverse":"-ml-2"),children:e.jsx(Xd,{alwaysShow:n,showInline:n||St,isHovered:V||Ie,pagination:St&&e.jsx(Qd,{showInline:n||St,currentPage:R,onChangeIndex:zs,length:I.length,className:D("self-center",I.length>1?"visible":"!invisible")}),actions:xt&&e.jsxs(e.Fragment,{children:[os,Vs,ns,wt,as,$s,qs,Ws]})})}),xt&&!se?e.jsx("div",{className:"pr-2 lg:pr-0",children:e.jsx(Zd,{message:z,isFinalTurn:n})}):null,n&&!se&&e.jsx(Qh,{canShowInlineMessageFeedback:U,clientThreadId:a,conversationLeafId:o,messageForRating:z,allGroupedMessages:E,currentModelId:l})]})]})})})]}))}))]})]})}const wn=ha.memo(Jh),eg=he.div`flex-shrink-0 flex flex-col relative items-end`;function tg({onChangeItemInView:t,onRequestMoreCompletions:s,onChangeRating:o,onRequestCompletion:n,clientThreadId:a,conversationLeafId:r,hideHeader:c}){const l=ye(),d=Ps(),m=tu(),[u]=su(),h=nu(),[g]=ou(),x=Is(a),v=Rs(),S=Yn(a),M=Oi(a),b=l.store.useContentAreaDimensions(Et.Header,f=>f?.height?f.height:void 0),N=l.store.useIsHeaderContentAreaPopulated(),w=fa(a),{isArchived:y}=w,_=au(S.id),I=x?.kind===Qe.GizmoMagicCreate?"bg-token-main-surface-primary text-token-text-primary":_,j=Ds(a,r),E=ru(),[A,F]=i.useState(0),[p,L]=i.useState(!1);i.useEffect(()=>{d&&(A===0?F(j):!p&&j>A&&(L(!0),de.logEvent("chatgpt_continue_conversation_first_message_sent"),Q.logEvent(Z.continueConversationFirstMessageSent)))},[j,A,p,d]),i.useEffect(()=>{d&&(de.logEvent("chatgpt_continue_conversation_page_loaded"),Q.logEvent(Z.continueConversationPageLoaded))},[d]);const C=i.useCallback(()=>{m({behavior:"smooth"})},[m]),B=iu(a),U=E&&!y,k=$a(a,r),R=(f,O,$)=>[...new Array(O-f).keys()].map(te=>{const W=te+f;return e.jsx(wn,{isFinalTurn:$(W),turnIndex:W,clientThreadId:a,conversationLeafId:r,onChangeItemInView:t,onChangeRating:o,onRequestMoreCompletions:s,onRequestCompletion:n,currentModelId:S.id,avatarClassName:I,scrollToBottom:C,shouldShowDateHeader:k(W)},W)});return e.jsxs("div",{onCopy:B,className:D("flex flex-col text-sm",U&&"pb-[120px]",b||U?null:"md:pb-9"),style:{paddingBottom:U?void 0:b},children:[!c&&v?.data&&e.jsx(xr,{clientThreadId:a}),d&&e.jsxs(e.Fragment,{children:[e.jsx($t,{children:e.jsx("p",{className:"text-xs text-gray-500",children:e.jsx(H,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),j-A===0&&e.jsx("div",{className:"text-center text-xs font-semibold text-token-text-primary",children:e.jsx("button",{onClick:()=>{Ns.openModal(lu.ReportConversation),de.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),Q.logEvent(Z.sharedConversationReportContentClicked,{location:"Dynamic Shared Thread Page"})},children:e.jsx(H,{id:"thread.reportSharedConversation",defaultMessage:"Report content"})})}),R(0,A,f=>f===A-1),e.jsx($t,{children:e.jsxs("p",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(cu,{className:"icon-xs mr-2"}),e.jsx(H,{id:"threadLayout.sharedConversationPrivateDisclaimer",defaultMessage:"Messages beyond this point are only visible to you"})]})}),R(A,j,f=>f===j-1)]}),!d&&R(0,j,f=>f===j-1),M&&u&&!g&&e.jsx(ea,{className:D("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{de.logEvent("chatgpt_thread_scroll_to_top"),h({behavior:"smooth"})},children:e.jsx(du,{className:"icon-md text-token-text-primary"})}),!u&&e.jsx(ea,{className:D(b?null:"bottom-5",U?N?"translate-y-[-50px]":"translate-y-[-10px]":""),style:{bottom:E?"calc(var(--composer-bar_footer-current-height) + var(--composer-bar_current-height))":b},onClick:()=>{de.logEvent("chatgpt_thread_scroll_to_bottom"),m({behavior:"smooth"})},children:e.jsx(uu,{className:"icon-md text-token-text-primary"})})]})}const ea=he.button`cursor-pointer absolute z-10 rounded-full bg-clip-padding border text-token-text-secondary border-token-border-light right-1/2 translate-x-1/2 bg-token-main-surface-primary w-8 h-8 flex items-center justify-center`,sg=60,ng=({children:t,scrollViewClassName:s,scrollAnchorTopOffset:o=0})=>{const n=i.useRef(null);return e.jsx("div",{className:"h-full",ref:n,children:e.jsx(An,{children:e.jsx(Ou,{className:"h-full",followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:s,scroller:()=>og(n,o)?0:1/0,children:t})})})},og=(t,s)=>{const o=ag(t.current);if(o==null)return!1;const n=o>s,a=o<s-sg;return!n&&!a};function ag(t){if(!t)return null;const s=t.querySelector('[data-scroll-anchor="true"]');if(!s)return null;const o=s.getBoundingClientRect().top,n=t.getBoundingClientRect().top;return o-n}const rg=Le(()=>Be(()=>import("./hc1mo3fv9jy6yet7.js"),__vite__mapDeps([38,1,2,3,4,39,40,41,42,43,37,44])).then(t=>t.OpenDebugSidebarButton)),ig=Le(()=>Be(()=>import("./nuq1v2qi7rtf7pzi.js"),__vite__mapDeps([45,1,2,3,4,8]))),ta=Pe({doNotShareSensitive:{id:"thread.modal.onboarding.title",defaultMessage:"Do not share sensitive materials with this application"},somethingWentWrong:{id:"thread.modal.unrecoverableError.title",defaultMessage:"Something went wrong"},tryAgainLater:{id:"thread.modal.unrecoverableError.description",defaultMessage:"We're sorry, but something went wrong. Please try again later."},resetThread:{id:"thread.modal.unrecoverableError.resetThread",defaultMessage:"Reset thread"},sharedConversationReportConversation:{id:"thread.sharedConversation.report",defaultMessage:"Report conversation"},latencyButton:{id:"thread.latencyButton",defaultMessage:"Latency"},archivedConversationDescription:{id:"thread.archivedConversationDescription",defaultMessage:"This conversation is archived. To continue, please unarchive it first."},unarchiveButton:{id:"thread.unarchiveButton",defaultMessage:"Unarchive"}});function lg({clientThreadId:t}){const s=da(),o=Zt(t),n=async()=>{o&&(await Nt.patchConversation(o,{is_archived:!1}),s.invalidateQueries({queryKey:["conversation",t]}),kn.setState(a=>{const r=a.threads[o];r!=null&&(r.initialThreadData.isArchived=!1)}),Nu(s))};return e.jsxs("div",{className:"my-6 flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"px-3 text-center text-sm text-token-text-secondary",children:e.jsx(H,{...ta.archivedConversationDescription})}),e.jsx("div",{children:e.jsx(Rt,{disabled:!o,onClick:n,icon:_u,children:e.jsx(H,{...ta.unarchiveButton})})})]})}const wg=function({clientThreadId:t,onCompletionFinished:s,onCreate:o,preRequestCompletion:n,hideHeader:a,hideMessages:r,hideFooter:c,hideToolsOverlay:l,messagesVerticalAlign:d="top",prependThreadChildren:m,renderEmptyState:u,prefetchSearch:h}){const g=ra(),x=Bs(t),v=Jt(t),S=Ze(t),b=fa(t).isArchived;i.useEffect(()=>{v||(rt(t)?rn.addTiming("chatgpt.web.chatPage.renderNewConversation"):rn.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[t,v]);const N=Nn(t,S),w=Ds(t,S),{setTargetedContent:y}=Hn(),_=g?.includes(zi),I=mu(),j=w>=2;Fn(j);const E=rt(t)&&!j&&Wt(x),A=rt(t)&&!N&&(Wt(x)||x?.kind===Qe.GizmoTest),p=Ra().id,L=Gi(t),C=L??p,B=!!L,U=Fs(C),R=Aa()[C],f=hu(t,x),O=Ea();Ya(w,t,S),i.useEffect(()=>{O||y(void 0)},[t,y,O,S]);const{caModal:$,onRequestCompletion:te,onChangeItemInView:W,onChangeRating:xe,onRequestMoreCompletions:re}=gu({clientThreadId:t,currentModelId:C,defaultModelId:p,onCompletionFinished:s,onThreadCreated:o,preRequestCompletion:n}),{isUnauthenticated:J,isLoading:ue}=De(),we=Ka({clientThreadId:t,currentLeafId:S,handleRequestCompletion:te,prefetchSearchPromise:h});pu({clientThreadId:t,currentModelId:C});const Fe=Me=>e.jsx(ng,{scrollAnchorTopOffset:a?0:ku,children:d==="bottom"?e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1"}),Me]}):Me});i.useEffect(()=>{document.title=f??"ChatGPT"},[f]);const ie=_e(t),ge=ct(),je=Wi(),ve=A&&!je&&!u&&!ie&&!U&&!ge,Re=ve&&!ue&&J,Ie=ve&&!ue&&!J,He=ih(Re),V=ch(Ie),P=Re&&He||Ie&&V,Y=Ps(),q=fu(),{reset:z,streamingContext:X,StreamingProvider:Se}=xu();i.useEffect(()=>{q&&(X.setOnResetContext=()=>{z()})},[q,z,X]);const pe=i.useRef(null),Ce=i.useRef(null),le=i.useMemo(()=>({threadContentScrollContainerElementRef:pe,footerRootContainerElementRef:Ce}),[]);return e.jsx(vu,{clientThreadId:t,currentLeafId:S,children:e.jsxs(Se,{value:X,children:[_&&e.jsx(ig,{}),e.jsx(Su,{children:f!=null&&e.jsx("title",{children:f})}),e.jsx(Vi.Provider,{value:te,children:e.jsxs(bu,{children:[e.jsxs(yu,{clientThreadId:t,currentModelConfig:R,className:"composer-parent flex h-full flex-col focus-visible:outline-0",children:[!r&&e.jsx(wu,{value:le,children:e.jsx(cg,{ref:pe,children:!v&&!we?A?u??e.jsx(vr,{clientThreadId:t,currentModelId:C,isModelLoaded:B,onRequestCompletion:te,enableV2Homepage:P,v2HomepageDisclaimer:P&&e.jsx(Yt,{clientThreadId:t})}):j?Fe(e.jsxs(e.Fragment,{children:[m,e.jsx(tg,{onChangeItemInView:W,onRequestMoreCompletions:re,onChangeRating:xe,onRequestCompletion:te,clientThreadId:t,conversationLeafId:S,hideHeader:a},t)]})):null:null})}),e.jsx(dg,{ref:Ce,children:b?e.jsx(lg,{clientThreadId:t}):e.jsxs("div",{children:[!P&&e.jsx(or,{clientThreadId:t,isNewThread:E,showPromptStarters:E||!N,currentModelId:C,onRequestCompletion:te}),!c&&e.jsx("div",{className:"relative w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",children:Wt(x)&&!P&&e.jsx("div",{className:"min-h-4",children:e.jsx(Yt,{clientThreadId:t})})})]})})]}),!l&&e.jsxs("div",{className:"group absolute bottom-2 end-2 z-20 flex flex-col gap-1 md:flex lg:bottom-3 lg:end-3",children:[I?e.jsxs(e.Fragment,{children:[e.jsx(rg,{}),!1]}):null,e.jsx(ju,{})]}),$,e.jsx(Cu,{clientThreadId:t,isStaticSharedThread:!1,isDynamicSharedThread:Y}),e.jsx(Mu,{}),e.jsx(Tu,{conversationId:t,currentModelId:C,isActiveWindow:!je})]})})]})})},cg=he.div`grow flex-1 overflow-hidden`,dg=he.div`md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent w-full`;function ug({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,v2HomepageDisclaimer:a}){return e.jsx(ir,{clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,v2HomepageDisclaimer:a})}const mg=Le(()=>Be(()=>import("./fk5ph3mdpjoxyxra.js"),__vite__mapDeps([46,1,2,47,3,4,11])).then(t=>t.ChatScreenContentModals));function hg({disableEmptyState:t,fullWidth:s,renderEmptyState:o}){const{clientThreadId:n,currentModelId:a,conversationLeafId:r,isCompanionWindow:c,isEmbeddedInFocusedView:l,onChangeItemInView:d,onChangeRating:m,onRequestCompletion:u,onRequestMoreCompletions:h,isModelLoaded:g,prefetchSearch:x}=i.useContext(Qn),v=Ds(n,r),S=qi(n),M={clientThreadId:n,conversationLeafId:r,currentModelId:a,onChangeItemInView:d,onChangeRating:m,onRequestMoreCompletions:h,onRequestCompletion:u,showAvatar:!1},b=Jt(n),N=Ka({clientThreadId:n,currentLeafId:r,handleRequestCompletion:u,prefetchSearchPromise:x}),w=b||N||t,y=Ps(),{initialConversationTurns:_,continuedConversationTurns:I}=Eu(v,y),{canUseNewHomepage:j,showEmptyState:E}=ur({clientThreadId:n,currentLeafId:r}),A=v>=2;Fn(A);const{setTargetedContent:F}=Hn(),p=Fs(a);Ya(v,n,r),i.useEffect(()=>{l||F(void 0)},[n,F,l]);const L=$a(n,r);if(E){if(o!=null)return o();if(j&&!w){const C=c?null:e.jsx("div",{className:"text-center text-xs text-token-text-secondary",children:e.jsx(Yt,{clientThreadId:n})});return e.jsx(ug,{clientThreadId:n,currentModelId:a,isModelLoaded:g,onRequestCompletion:u,v2HomepageDisclaimer:C})}else if(!j&&!w)return e.jsx(vr,{clientThreadId:n,currentModelId:a,isModelLoaded:g,onRequestCompletion:u,enableV2Homepage:!p,v2HomepageDisclaimer:e.jsx(Yt,{clientThreadId:n})})}return e.jsxs(e.Fragment,{children:[y&&e.jsx(Au,{}),y&&I.length===0&&e.jsx(Ru,{}),e.jsx(An,{children:e.jsxs(i.Suspense,{fallback:null,children:[e.jsx(Iu,{}),_.length>0&&e.jsx("ol",{className:Ae.conversationTurnList,children:_.map(({turnIndex:C,isFinalTurn:B})=>e.jsx("li",{className:D(Ae.conversationTurnWrapper,s&&"w-full"),children:i.createElement(wn,{...M,key:`${n}-${C}`,turnIndex:C,isFinalTurn:B,scrollToMessageId:S,shouldShowDateHeader:L(C)})},C))}),y&&e.jsx(Pu,{}),e.jsx("ol",{className:Ae.conversationTurnList,children:I.map(({turnIndex:C,isFinalTurn:B})=>e.jsx("li",{className:D(Ae.conversationTurnWrapper,s&&"w-full"),children:i.createElement(wn,{...M,key:`${n}-${C}`,turnIndex:C,isFinalTurn:B,scrollToMessageId:S,shouldShowDateHeader:L(C)})},C))})]})}),e.jsx(mg,{}),v>0&&e.jsx(Du,{})]})}function jg({renderEmptyState:t}){return e.jsx(hg,{renderEmptyState:t})}const gg=Le(()=>Be(()=>Promise.resolve().then(()=>rh),void 0).then(t=>t.ChatScreenComposerAlerts));function Cg(){const{clientThreadId:t,currentModelId:s,isCompanionWindow:o,onRequestCompletion:n}=i.useContext(Qn),a=Bs(t),r=Ze(t),l=Ds(t,r)>=2,d=Nn(t,r),m=rt(t)&&!l&&Wt(a),{setComposerFooterElement:u}=i.useContext(Lu);return e.jsx("div",{className:Ae.footer,children:e.jsxs(Bu,{style:{"--bar-gap":"0.5rem","--bar-background-color":"transparent"},children:[e.jsxs(xn,{type:"secondary",className:"relative",children:[l&&e.jsx(Fu,{className:Ae.scrollButton}),e.jsx(gg,{})]}),e.jsxs(xn,{type:"primary",ref:u,name:"composer-bar",className:"bottom-[var(--screen-keyboard-bottom,env(keyboard-inset-bottom,0px))]",children:[e.jsx(or,{clientThreadId:t,currentModelId:s,isNewThread:m,noWrap:!0,onRequestCompletion:n,showPromptStarters:m||!d}),!o&&e.jsx("div",{className:"text-center text-xs text-token-text-secondary",children:e.jsx(Yt,{clientThreadId:t})})]})]})})}function Mg(){const t=fe(),{clientThreadId:s,isLoggedInUser:o,onNewThread:n}=i.useContext(Qn),a=_e(s),r=ts(a);return e.jsxs(xn,{leading:!0,type:"primary",className:Ae.header,children:[e.jsxs("div",{className:Ae.headerLeading,children:[o&&e.jsx(Hu,{}),!r&&e.jsx(Qt,{label:t.formatMessage(sa.newChat),className:"hidden @lg/thread:inline-flex",children:e.jsx(Cs,{to:"/",className:Ae.newThread,onClick:c=>{n?(c.preventDefault(),n()):de.logEvent("chatgpt_web_thread_tap_new_thread")},tabIndex:0,children:e.jsx(Uu,{className:D(Ae.sidebarIcon),icon:e.jsx(La,{}),tabIndex:-1,label:t.formatMessage(sa.newChat),style:{viewTransitionName:"var(--vt_new_chat_thread)"}})})}),e.jsx("div",{className:Ae.threadDropdown,children:e.jsx(gr,{clientThreadId:s})})]}),e.jsx("div",{className:Ae.headerTrailing,children:e.jsx(An,{children:e.jsx(fr,{clientThreadId:s})})})]})}const sa=Pe({newChat:{id:"rnCpM4",defaultMessage:"New Chat"}});export{Mg as C,Fo as G,ar as P,gr as T,ng as W,wg as a,Cg as b,jg as c,wn as d,ur as u};
//# sourceMappingURL=hgxnd6ut1jsesjcr.js.map
