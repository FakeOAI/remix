const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gitgv48ko1dfdsi1.js","assets/nkav6u5sgjh9k32o.js","assets/nk3ns16telurqv2s.js","assets/root-befw6dw0.css"])))=>i.map(i=>d[i]);
import{F as z,eL as fe,eM as Y,r as x,j as t,aY as xe,c5 as he,aZ as pe,a_ as Ie,b0 as be,c as S,b4 as ve,ba as F,J as re,ci as we,bZ as ye,cY as q,c4 as je,ax as Me,aB as Ce,bd as Se,ay as X,bL as Ee,K as oe,bb as Z,y as W,P as Q}from"./nkav6u5sgjh9k32o.js";import{B as ke,E as _e,v as Ne,aV as Ae,bm as Ve,aj as le,ak as de,P as ce,T as De}from"./nk3ns16telurqv2s.js";import{A as Le,ef as Te,dS as Fe,eg as Pe,cv as $e,bC as Re,bD as me,eh as Oe,bp as Ge,cA as Be,cB as ze,cw as We,ei as Ue,bU as ee,cl as He,J as Je}from"./fvuv8t2jnmmokuz9.js";import{m as B}from"./modnlcjxa99o7fdj.js";import{L as Ke,J as P,$,a0 as Ye,a1 as qe}from"./m5lg5n98cj0obuc4.js";import{d as Xe,l as Ze,r as Qe}from"./n1qrfihyqo1d937u.js";import"./dha2x2fzb3q3x33r.js";import"./nkdpb84sj0t5lqnq.js";import"./nn9qoplyb7jz0hlz.js";import"./njh27zrodvyq73sa.js";import"./cwuhomq0i0r45ouk.js";import"./h09g8hg5w2r23p7n.js";import"./fz1kd7qtrga6ohek.js";import"./tz0vzalk94czn40w.js";import"./van4l4xc9kuswyp4.js";import"./c1dp657f8l24ezf5.js";import"./jtk42zoopw7aysx6.js";import"./l89whj9rc1rrsavy.js";import"./evdzombk82q3qygv.js";import"./dknq3w19d1xohuce.js";import"./bjtnyg2vr856qrgu.js";import"./i4v7yy58lrb4jmds.js";import"./smd1nut9r0oa3cgd.js";import"./igs79b6j25fqrrxx.js";import"./ebzifnge6vgrd3cf.js";const et={enter:e=>({zIndex:0,x:e===-1?"10%":"-10%",opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:e=>({zIndex:0,x:e===1?"10%":"-10%",opacity:0})},tt={enter:{opacity:0,y:"10%"},visible:{opacity:1,y:0},exit:{opacity:0,y:"10%"}},te=1e3,ae=1e3,se=(e,s)=>Math.abs(e)*s;function at(e){var G,C;const s=z(),i=fe(),r=[Y.Small,Y.Mobile].includes(i),[g,p]=x.useState({width:0,height:0}),[o,l]=x.useState(!1),[n,m]=x.useState(e.image),[u,c]=x.useState(!1),I=g.width>0&&g.height>0,M=x.useRef(null),[b,v]=x.useState(0);x.useEffect(()=>{if(!n.url)throw new Error("ExpandableImage requires a src");const a=new Image;a.onload=()=>{p({width:a.naturalWidth,height:a.naturalHeight})},a.onerror=()=>{},a.src=n.url},[n.url]),x.useEffect(()=>{const a=M.current;if(u)return a==null||a.addEventListener("keydown",O),()=>{a==null||a.removeEventListener("keydown",O)};m(e.image)},[u]);function y(){m(a=>{const h=(e.images.findIndex(f=>f.url===a.url)+1)%e.images.length;return e.images[h]}),v(-1)}function w(){m(a=>{const d=e.images.findIndex(f=>f.url===a.url),h=d>0?(d-1)%e.images.length:e.images.length-1;return e.images[h]}),v(1)}function R(a){var d;c(a),a&&((d=e.onOpen)==null||d.call(e,n))}function O(a){a.key==="ArrowLeft"?w():a.key==="ArrowRight"&&y()}const _=e.images.findIndex(a=>a.url===n.url);return t.jsxs(xe,{onOpenChange:R,children:[t.jsx(he,{disabled:!I,className:e.className,"aria-label":s.formatMessage(k.showImage),children:e.children}),t.jsx(pe,{children:t.jsx(Ie,{className:"fixed inset-0 flex items-center justify-center bg-black/90 backdrop-blur-xl radix-state-open:animate-show",children:t.jsxs(be,{className:S("relative flex h-[100dvh] w-screen justify-stretch divide-x divide-white/10 focus:outline-none radix-state-open:animate-contentShow"),ref:M,children:[t.jsx("div",{className:S("flex flex-1 transition-[flex-basis]",!o&&"md:basis-[75vw]"),children:t.jsxs("div",{className:"flex flex-1 flex-col md:p-6",children:[t.jsxs("div",{className:"flex justify-between px-6 py-2 pt-6 text-white sm:mb-4 md:mt-2 md:px-0 md:py-2",children:[t.jsx(ve,{asChild:!0,children:t.jsx("button",{"aria-label":s.formatMessage(k.closeModal),children:t.jsx(ke,{})})}),t.jsx("div",{children:!r&&t.jsxs(t.Fragment,{children:[(C=(G=e.getActions)==null?void 0:G.call(e,n))==null?void 0:C.map((a,d)=>t.jsx(F,{color:"ghost",size:"small",onClick:a.onClick,"aria-label":a.ariaLabel,disabled:a.disabled,icon:a.icon},d)),t.jsx(F,{color:"ghost",size:"small",onClick:()=>l(a=>!a),"aria-label":s.formatMessage(k.toggleSidebar),className:"md:inline-flex",icon:_e})]})})]}),t.jsx("div",{className:"relative flex flex-1 flex-col items-center justify-center overflow-hidden",children:t.jsx(Le,{initial:!1,custom:b,children:t.jsxs(B.div,{className:"absolute grid h-full w-full grid-rows-2",custom:b,variants:et,drag:"x",dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(a,{offset:d,velocity:h})=>{const f=se(d.x,h.x);f<-te?y():f>te&&w()},children:[t.jsx(B.img,{src:n.url,alt:n.alt,className:"row-span-4 mx-auto h-full object-scale-down",onPanEnd:(a,{offset:d,velocity:h})=>{const f=se(d.y,h.y);f<-ae?l(!0):f>ae&&l(!1)}},n.url),r&&o&&t.jsx(B.div,{className:"flex text-white",variants:tt,initial:"enter",animate:"visible",exit:"exit",transition:{y:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2}},children:e.metadataRenderer(n)})]},n.url)})}),e.images.length>1?t.jsxs("div",{className:"flex items-center justify-center gap-4 p-8 text-white",children:[t.jsx(F,{color:"ghost",size:"small",onClick:w,"aria-label":s.formatMessage(k.previousImage),icon:Ne}),e.images.map((a,d)=>t.jsx("img",{src:a.url,alt:a.alt??"",className:S("h-12 w-12 cursor-pointer rounded object-cover transition duration-300 hover:opacity-100",a.url===n.url?"ring-2 ring-white ring-offset-4 ring-offset-black":"opacity-25"),onClick:()=>{m(a),v(d<_?1:-1)},"aria-label":s.formatMessage(k.showImage),role:"button"},a.url)),t.jsx(F,{color:"ghost",size:"small",onClick:y,"aria-label":s.formatMessage(k.nextImage),icon:Ae})]}):null]})}),t.jsx("div",{className:S("hidden items-center justify-start overflow-hidden bg-gray-900 text-white transition-[flex-basis] duration-500 md:flex",o?"md:basis-[25vw]":"md:basis-0"),children:t.jsx("div",{className:"w-[25vw] min-w-[25vw]",children:e.metadataRenderer(n)})})]})})})]})}const k=re({showImage:{id:"imageViewer.showImage",defaultMessage:"Show Image"},closeModal:{id:"imageViewer.closeModal",defaultMessage:"Close Modal"},toggleSidebar:{id:"imageViewer.toggleSidebar",defaultMessage:"Toggle Sidebar"},nextImage:{id:"imageViewer.nextImage",defaultMessage:"Next Image"},previousImage:{id:"imageViewer.previousImage",defaultMessage:"Previous Image"}}),st=25*1e3,U=new Map,it=(e,s=st)=>{const i=nt(e),[r,g]=x.useState(U.get(e)??0);return x.useEffect(()=>{let o=0;const l=setInterval(()=>{o+=100,g(n=>{let m=1.5;if(o<s){const c=Math.sin(i+n/100)*.1+1;m=(1-Math.log10(1+n/10))*c}const u=n+m;return u>=100?(clearInterval(l),100):(U.set(e,u),u)})},100);return()=>{clearInterval(l),U.delete(e)}},[i,e,s]),r};function nt(e){if(typeof e=="number")return e;let s=0;if(e.length===0)return s;for(let i=0;i<e.length;i++){const r=e.charCodeAt(i);s=(s<<5)-s+r,s|=0}return s}const rt=we(()=>ye(()=>import("./gitgv48ko1dfdsi1.js"),__vite__mapDeps([0,1,2,3])));function ot(e){const s=e.matchTextColor??!0,i=x.useRef(null),[r,g]=x.useState(null);x.useEffect(()=>{if(!i.current||!s)return;const o=()=>{i.current&&g(getComputedStyle(i.current).color)},l=new MutationObserver(()=>{o()});return l.observe(window.document.documentElement,{attributes:!0,attributeFilter:["class","style"]}),l.observe(i.current,{attributes:!0,attributeFilter:["class","style"]}),o(),()=>l.disconnect()},[s]);const p=x.useMemo(()=>{var n;if(!s)return e.animationData;const o=(n=r==null?void 0:r.match(/\d+/g))==null?void 0:n.map(Number).map(m=>m/255);if(!o)return null;o.push(1);const l=e.animationData;return"layers"in l&&Array.isArray(l.layers)&&l.layers.forEach(m=>{"ty"in m&&m.ty===4&&"shapes"in m&&Array.isArray(m.shapes)&&m.shapes.forEach(u=>{"it"in u&&Array.isArray(u.it)&&u.it.forEach(c=>{c.ty==="fl"&&(c.c.k=o)})})}),l},[e.animationData,r,s]);return t.jsx("div",{ref:i,className:e.className,children:t.jsx(rt,{animationData:p,loop:!0,autoplay:!0},r)})}function lt({id:e,withLottie:s}){return t.jsxs("div",{className:"absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full",children:[s?t.jsx(ot,{className:"h-6 w-6",animationData:Te}):t.jsx(Ve,{className:"h-6 w-6"}),t.jsx(dt,{id:e})]})}function dt({id:e}){const s=it(e);return t.jsx(Fe,{percentage:s,thickness:1.25/23,className:"absolute left-1/2 top-1/2 h-10 w-10 -translate-x-1/2 -translate-y-1/2",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-s)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"})}function Ot({messages:e,clientThreadId:s}){const[i,r]=e,g=Ke(i.message),p=Pe(),o=e.some(m=>p.has(m.message.id));let l=null;r!=null&&q.isMultimodalTextMessage(r.message)&&(l=q.getImageAssetPointers(r.message));let n=P.Running;return l!=null?n=P.Finished:r!=null?n=P.Error:g&&(n=P.Stopped),t.jsx(t.Fragment,{children:!o&&t.jsx(ct,{imageAssets:l??[],clientThreadId:s,toolStatus:n,toolMessage:r==null?void 0:r.message,messageId:i.message.id})})}const ct=({imageAssets:e,clientThreadId:s,toolMessage:i,toolStatus:r,messageId:g})=>{const p=z(),o=$e(e);if((i==null?void 0:i.content.content_type)===je.SystemError)return null;const l=ge(e[0]),n=o.map(c=>c.data).filter(c=>c!=null),m=n.map(c=>({...c,alt:$(c)})),u=(c=0)=>`${g}-image-${c}`;return t.jsx(t.Fragment,{children:t.jsxs(ft,{$numItems:o.length,className:"my-1 transition-opacity duration-300",children:[o.length===0&&r===P.Running&&t.jsx(ie,{layoutId:"loading:placeholder",shape:l,isToolRunning:!0},"loading"),o.map((c,I)=>{const{isLoading:M,data:b,error:v}=c;if(M)return t.jsx(ie,{shape:l,layoutId:u(I)},I);if(v!=null||(b==null?void 0:b.url)==null)return t.jsx(J,{layoutId:u(I),className:"text-sm text-token-text-tertiary",shape:l,children:t.jsx("div",{className:"flex min-h-full flex-col items-center justify-center gap-3 px-4 pb-5",children:p.formatMessage(j.imageLoadError)})},I);if(i&&b){const y={...b,alt:$(b)};return t.jsx(mt,{image:y,allImages:m,clientThreadId:s,toolMessage:i,index:I,onOpenImageEditor:()=>{Re.setFocusedObject({type:me.Image,image:y,allImages:n,messageId:i.id})}},I)}})]})})};function mt({toolMessage:e,clientThreadId:s,allImages:i,image:r,index:g,onOpenImageEditor:p}){const o=z(),l=Xe(s),n=Me(),{value:m}=Ce("2189772492"),u=Se(),c=Ye(s),I=ge(r),[M,b]=x.useState({}),v=c&&"gizmo"in c?c.gizmo:void 0,y=(v==null?void 0:v.gizmo.id)===Oe,w=u&&m&&!!(n!=null&&n.includes(X.D3Editor))&&(v==null||y||!!(n!=null&&n.includes(X.D3EditorAllGpts)));async function R(a){qe(a,l,e.id)}function O(a){var d,h,f,E,N,A,V,D,L,T;Z.logEvent("chatgpt_dalle_image_view_full",null,{sourceOperation:((h=(d=a.metadata)==null?void 0:d.dalle)==null?void 0:h.edit_op)??"none",hasParent:(E=(f=a.metadata)==null?void 0:f.dalle)!=null&&E.parent_gen_id?"true":"false"}),Q.logEvent(W.dalleImageViewFull,{conversationId:l,messageId:e.id,generationId:(A=(N=a.metadata)==null?void 0:N.dalle)==null?void 0:A.gen_id,parentGenerationId:(D=(V=a.metadata)==null?void 0:V.dalle)==null?void 0:D.parent_gen_id,fileId:ee(a.asset_pointer),sourceOperation:(T=(L=a.metadata)==null?void 0:L.dalle)==null?void 0:T.edit_op})}function _(a,d){var h,f,E,N,A,V,D,L,T,K;b(ue=>({...ue,[a.asset_pointer]:d})),Z.logEvent(W.dalleImageRating,d?"like":"dislike",{liked:d?"true":"false",sourceOperation:((f=(h=a.metadata)==null?void 0:h.dalle)==null?void 0:f.edit_op)??"none",hasParent:(N=(E=a.metadata)==null?void 0:E.dalle)!=null&&N.parent_gen_id?"true":"false"}),Q.logEvent(W.dalleImageRating,{liked:d,conversationId:l,messageId:e.id,generationId:(V=(A=a.metadata)==null?void 0:A.dalle)==null?void 0:V.gen_id,parentGenerationId:(L=(D=a.metadata)==null?void 0:D.dalle)==null?void 0:L.parent_gen_id,fileId:ee(a.asset_pointer),sourceOperation:(K=(T=a.metadata)==null?void 0:T.dalle)==null?void 0:K.edit_op})}function G(a){const d=M[a.asset_pointer],h={label:o.formatMessage(j.likeImage),onClick:()=>_(a,!0),disabled:d===!0,ariaLabel:o.formatMessage(j.likeImage),icon:le},f={label:o.formatMessage(j.dislikeImage),onClick:()=>_(a,!1),disabled:d===!1,ariaLabel:o.formatMessage(j.dislikeImage),icon:de},E={label:o.formatMessage(j.downloadImage),onClick:()=>R(a),ariaLabel:o.formatMessage(j.downloadImage),icon:ce};return[d!==!1&&h,d!==!0&&f,E].filter(Boolean)}let C=t.jsx(ut,{image:r,shape:I,rating:M[r.asset_pointer],onDownload:()=>R(r),onRate:(a,d)=>_(a,d),clientThreadId:s,layoutId:void 0});return w?C=t.jsx("div",{role:"button",onClick:p,children:C}):C=t.jsx(at,{image:r,images:i,metadataRenderer:a=>t.jsx(gt,{image:a}),onOpen:O,getActions:G,children:C}),t.jsx("div",{className:"flex",children:C},g)}function ie({shape:e,layoutId:s,isToolRunning:i=!1}){return t.jsx(J,{shape:e,layoutId:s,children:t.jsx("div",{className:"flex min-h-full items-center justify-center",children:t.jsx(lt,{id:s,withLottie:i})})},"loading")}function gt({image:e}){const s=z(),[i,r]=x.useState(!1);function g(){const p=$(e);r(!0),Je(p),setTimeout(()=>{r(!1)},2e3)}return t.jsxs("div",{className:"flex flex-col items-start gap-3 p-6",children:[t.jsx("div",{className:"text-sm text-gray-300 sm:text-base",children:s.formatMessage(j.imageViewerMetadataTitle)}),t.jsx("div",{className:"max-h-32 overflow-y-auto text-sm md:max-h-[80vh] md:text-lg",children:$(e)}),t.jsx(F,{color:"primary",onClick:g,disabled:i,className:"hidden sm:block",icon:De,children:i?s.formatMessage(j.imageViewerMetadataCopyButtonCopied):s.formatMessage(j.imageViewerMetadataCopyButton)})]})}function J({children:e,shape:s,className:i,layoutId:r}){return t.jsxs(B.div,{layoutId:r,className:S("relative",i,s==="1792x1024"&&"aspect-[7/4]",s==="1024x1024"&&"aspect-square max-w-[400px]",s==="1024x1792"&&"aspect-[4/7] max-w-xs","overflow-hidden rounded-2xl"),children:[t.jsx("div",{className:"pointer-events-none absolute inset-0 bg-token-main-surface-secondary"}),t.jsx("div",{className:"relative h-full",children:e})]})}function ut({image:e,shape:s,rating:i,onDownload:r,onRate:g,clientThreadId:p,layoutId:o}){const l=Ze(),n=Ge(He.isBusinessWorkspace),m=Qe(p),u=Be(),c=ze(),I=(c==null?void 0:c.type)===me.Image&&c.image.asset_pointer===e.asset_pointer,{url:M,width:b,height:v}=e,y=!l&&!n&&(m==null?void 0:m.kind)!==Ee.GizmoMagicCreate;return t.jsxs(J,{shape:s,className:"group/dalle-image",layoutId:I?void 0:o,children:[t.jsx(We,{alt:$(e),src:M,width:b,height:v}),t.jsx("div",{className:S("pointer-events-none absolute inset-0 rounded-2xl shadow-[inset_0_0_0_1px_rgba(0,0,0,0.1)] dark:shadow-[inset_0_0_0_1px_rgba(255,255,255,0.1)]",I?"bg-black/50 group-hover/dalle-image:bg-black/70":"group-hover/dalle-image:bg-transparent")}),u?!I&&t.jsx("div",{className:"pointer-events-none invisible absolute right-3 top-3 text-white group-hover/dalle-image:visible",children:t.jsx(Ue,{})}):t.jsxs(t.Fragment,{children:[y&&t.jsxs(ne,{children:[i!==!1&&t.jsx(H,{icon:le,selected:i===!0,onClick:w=>{w.stopPropagation(),g(e,!0)}}),i!==!0&&t.jsx(H,{icon:de,selected:i===!1,onClick:w=>{w.stopPropagation(),g(e,!1)}})]}),t.jsx(ne,{$rightAlign:!0,children:t.jsx(H,{icon:ce,onClick:w=>{w.stopPropagation(),r()}})})]})]})}const ne=oe.div`invisible absolute top-3 flex gap-1 group-hover/dalle-image:visible
${({$rightAlign:e})=>e?"right-3":"left-3"}`;function H({icon:e,selected:s,onClick:i}){return t.jsx("button",{className:S("flex h-8 w-8 items-center justify-center rounded",s?"bg-gray-100":"bg-black/50 hover:opacity-70"),onClick:i,disabled:s,children:t.jsx(e,{className:S("icon-md",s?"text-gray-700":"text-white")})})}const ft=oe.div`grid gap-2
${({$numItems:e})=>e<=1?"grid-cols-1":"grid-cols-2"}`;function ge(e){if(!e)return"1024x1024";const{width:s,height:i}=e;return s>i?"1792x1024":s<i?"1024x1792":"1024x1024"}const j=re({creatingImages:{id:"dalleMessage.creatingImagesV2",defaultMessage:"Creating image"},stopped:{id:"dalleMessage.stoppedV3",defaultMessage:"Stopped creating image"},errorCreating:{id:"dalleMessage.errorCreatingV2",defaultMessage:"Error creating image"},imageLoadError:{id:"dalleMessage.imageLoadError",defaultMessage:"Error loading image"},imageViewerMetadataTitle:{id:"dalleMessage.imageViewerMetadataTitle",defaultMessage:"Prompt"},imageViewerMetadataCopyButton:{id:"dalleMessage.imageViewerMetadataCopyButton",defaultMessage:"Copy"},imageViewerMetadataCopyButtonCopied:{id:"dalleMessage.imageViewerMetadataCopyButtonCopied",defaultMessage:"Copied!"},imageEditButton:{id:"dalleMessage.imageEditButton",defaultMessage:"Edit"},downloadImage:{id:"imageViewer.downloadImage",defaultMessage:"Download Image"},likeImage:{id:"imageViewer.likeImage",defaultMessage:"Like Image"},dislikeImage:{id:"imageViewer.dislikeImage",defaultMessage:"Dislike Image"}});export{Ot as default};
//# sourceMappingURL=i92zskkgy8i1j9e8.js.map
