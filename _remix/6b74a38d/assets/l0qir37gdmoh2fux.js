import{r as C,j as x,bk as M,cI as z,c4 as S,e1 as A,bL as k}from"./nkav6u5sgjh9k32o.js";import{bH as G}from"./fvuv8t2jnmmokuz9.js";import{u as I}from"./nkdpb84sj0t5lqnq.js";import{a as w}from"./c1dp657f8l24ezf5.js";import{l as E,T as h}from"./n1qrfihyqo1d937u.js";import"./nk3ns16telurqv2s.js";import"./dha2x2fzb3q3x33r.js";import"./cwuhomq0i0r45ouk.js";import"./modnlcjxa99o7fdj.js";function q({messages:a,clientThreadId:n,isLastTurnInConversation:l,onRequestCompletion:i}){var u,g,y;const[m,...t]=a,d=E(),e=(y=(g=(u=t.find(o=>{var s,r,c;return((c=(r=(s=o.message.metadata)==null?void 0:s.jit_plugin_data)==null?void 0:r.from_server)==null?void 0:c.type)==="confirm_action"}))==null?void 0:u.message.metadata)==null?void 0:g.jit_plugin_data)==null?void 0:y.from_server,j=(e==null?void 0:e.body.actions[0].type)==="contact_gizmo"?e==null?void 0:e.body.actions[0].contact_gizmo.gizmo_id:void 0,{data:_}=I(j),p=l&&t[t.length-1];return C.useEffect(()=>{var s,r,c,v,T;if(d||!p||((c=(r=(s=p.message.metadata)==null?void 0:s.jit_plugin_data)==null?void 0:r.from_server)==null?void 0:c.type)!=="confirm_action")return;const o=(T=(v=p.message.metadata)==null?void 0:v.jit_plugin_data)==null?void 0:T.from_server;if((o==null?void 0:o.type)==="confirm_action"){const f=o.body.actions.find(b=>b.type==="contact_gizmo");f&&f.type==="contact_gizmo"&&N({allMessages:a,assistantMessage:m,clientThreadId:n,onRequestCompletion:i,actionData:{type:"contact_gizmo",...f.contact_gizmo}})}},[d,p,i,a,m,n]),x.jsx("div",{className:"my-2 flex flex-col",children:_&&x.jsx(w,{gizmoResource:_})})}function N({actionData:a,allMessages:n,assistantMessage:l,clientThreadId:i,onRequestCompletion:m}){const t={id:M(),author:{role:z.Tool,name:l.message.recipient},content:{content_type:S.Text,parts:[""]},recipient:"all",metadata:{jit_plugin_data:{from_client:a}}};h.updateTree(i,e=>{e.addNode(t.id,t,n[n.length-1].message.id,z.Tool,{completionSampleFinishTime:Date.now()})}),h.setThreadCurrentLeafId(i,t.id);const d=new G;m({type:A.Next,promptId:t.id,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!1,completionMetadata:{conversationMode:{kind:k.PrimaryAssistant}},turnTracker:d})}export{q as GizmoContactsMessage};
//# sourceMappingURL=l0qir37gdmoh2fux.js.map
