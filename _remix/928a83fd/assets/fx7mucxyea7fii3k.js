import{aC as L,aA as j,aH as G,ao as f,r,P as h,d as b,l as a,$ as d,bg as T,a0 as I,aN as M,eT as R,bE as U,a8 as B,X as K,c as F,i as H,ef as q,bR as V,eU as Y,dg as Q,j as X}from"./isi6i55eeemdaxmu.js";import{d6 as v,a8 as w,dZ as W,av as Z}from"./g344clpmm9csab6e.js";import{L as x}from"./mmok6cc45zl1vh57.js";import{b as z}from"./r2u8flwozaontxkq.js";import{T as $}from"./egewzi8a5y7qju58.js";function J(){return j("437245079").value}function ee(){const e=J(),n=z(),s=L("1908072088").config.value,{eligible:o,isLoading:t}=v(w.AG8PqS2q);return{eligible:o&&e&&n&&s.blocking_modal===!0,singleButtonVariant:s.single_button_variant===!0,isLoading:t}}const C=w.UseSidekick,ne=w.SidekickLauncherOnboarding,_="https://persistent.oaistatic.com/sidekick/public/ChatGPT_Desktop_public_latest.dmg",N="download";function E(){const e=M(),n=R("1696863369").layer.get("has_sidekick_access",!1);return e!=null&&n}function oe(e){return e===N}function se(){const e=U(),{hash:n}=B(),s=oe(n.slice(1));return{openModal:()=>{e({hash:N})},closeModal:()=>{e({hash:""})},isOpen:s}}function ke(e){const{eligible:n,isLoading:s}=ee(),o=E(),{eligible:t,isLoading:c}=v(C),{eligible:u,isLoading:g}=v(ne),m=n||!t||!u||!o||e.conversationMode?.kind!==G.PrimaryAssistant,p=s||g||c;return{eligible:!m&&f.getLayerValue({layerName:"1696863369",key:"show_nux_banner",defaultValue:!1}),isLoading:p}}function fe({onClose:e}){r.useEffect(()=>{h.logEvent(b.sidekickAnnouncementShown),f.logEvent("chatgpt_sidekick_announcement_shown")},[]);const{markAsViewed:n}=v(C),s=r.useCallback(()=>{n(),h.logEvent(b.sidekickAnnouncementDismissed),f.logEvent("chatgpt_sidekick_announcement_closed"),e&&e()},[n,e]),o=r.useCallback(()=>{h.logEvent(b.sidekickAnnouncementLinkClicked),f.logEvent("chatgpt_sidekick_announcement_download_clicked"),n(),e&&e()},[n,e]),t={downloadUrl:_,markAsDownloaded:o,markAsViewed:s,isSidekickAvailable:E()};return a.jsx(le,{...t})}function ae(){window.open(_,"_blank")}function te(){return M()?.isPlus()?i.bannerTitleMentioningPlus:i.bannerTitleNotMentioningPlus}function he(){const{closeModal:e,isOpen:n}=se(),s=E(),o=r.useMemo(()=>({isDesktopAppAvailable:s}),[s]),t=()=>{h.logEvent(b.sidekickDownloadModalClosed,o),f.logEvent("chatgpt_sidekick_modal_closed"),e()},c=()=>{h.logEvent(b.sidekickDownloadModalDownloaded,o),f.logEvent("chatgpt_sidekick_modal_download_clicked"),e()};return r.useEffect(()=>{n&&(h.logEvent(b.sidekickDownloadModalShown,{...o}),f.logEvent("chatgpt_sidekick_modal_shown"))},[o,n]),n?a.jsx(ie,{downloadUrl:_,markAsDownloaded:c,markAsViewed:t,isSidekickAvailable:s}):null}function ie({downloadUrl:e,markAsDownloaded:n,markAsViewed:s,isSidekickAvailable:o}){const t=o?i.modalTitleEligible:i.modalTitleNotEligible,c=a.jsx(d,{...t}),u=a.jsx(d,{...i.modalContent}),g=o?i.disclaimer:i.comingSoonDisclaimer,m=a.jsx(d,{...g,values:{learnMoreLink:P=>a.jsx(x,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:P})}}),p=a.jsxs("div",{children:[a.jsx("div",{children:u}),a.jsx("div",{className:"mt-2",children:m})]}),S=a.jsx(T,{as:"link",to:e,color:"primary",onClick:n,openNewTab:!0,children:a.jsx(d,{...i.download})}),l=a.jsx(T,{color:"secondary",onClick:s,children:a.jsx(d,{...i.close})}),k=o?S:l,y=o?l:void 0;return a.jsx(W,{onClose:s,title:c,description:p,actionButton:k,cancelButton:y})}function le({markAsDownloaded:e,markAsViewed:n}){const s=K(),o=r.useCallback(()=>{ae(),e()},[e]),t=a.jsx(d,{...te()}),c=a.jsx(d,{...i.bannerContent}),u=a.jsx(d,{...i.disclaimer,values:{learnMoreLink:m=>a.jsx(x,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:m},"link")}}),g=a.jsxs("div",{className:"flex-grow",children:[a.jsx("div",{className:"mb-0.5 font-semibold",children:t}),a.jsxs("span",{className:"text-token-text-secondary",children:[c," ",u]})]});return a.jsx(Z,{onPrimaryCtaClick:o,primaryCtaText:s.formatMessage(i.download),onDismiss:n,content:g})}const i=I({bannerTitleNotMentioningPlus:{id:"SidekickOnboarding.bannerTitleEnterprisey_2",defaultMessage:"ChatGPT is available for macOS 14+ with Apple Silicon"},bannerTitleMentioningPlus:{id:"SidekickOnboarding.bannerTitleMentioningPlus",defaultMessage:"ChatGPT is now available for macOSâ€”Plus users get early access"},modalTitleEligible:{id:"SidekickOnboarding.modalTitleEligible",defaultMessage:"The ChatGPT app is now available for macOS"},modalTitleNotEligible:{id:"SidekickOnboarding.modalTitleNotEligible",defaultMessage:"The ChatGPT macOS desktop app is coming soon"},modalContent:{id:"SidekickOnboarding.modal_content_eligible",defaultMessage:"Quickly access ChatGPT from anywhere on your computer with a shortcut: Option + Space. Share screenshots, upload files and photos, have voice conversations, and search through past conversations."},bannerContent:{id:"SidekickOnboarding.banner_content_3",defaultMessage:"Get faster access to ChatGPT with the Option + Space shortcut and the floating companion window."},disclaimer:{id:"SidekickOnboarding.disclaimer_3",defaultMessage:"<learnMoreLink>Learn more</learnMoreLink>."},comingSoonDisclaimer:{id:"SidekickOnboarding.coming_soon_disclaimer",defaultMessage:"The app will be available over the next couple of weeks."},download:{id:"SidekickOnboarding.download",defaultMessage:"Download"},close:{id:"SidekickOnboarding.close",defaultMessage:"Close"}}),A=F(H(()=>({statusMap:{}}))),be=e=>A(n=>n.statusMap[e]),pe=(e,n)=>{A.setState(s=>{s.statusMap[e]=n;const o=$.getServerThreadId(e);o&&(s.statusMap[o]=n)})},D=e=>{A.setState(n=>{for(const{id:s,async_status:o}of e)o!=null&&(n.statusMap[s]={source:q.SERVER,value:o})})},ce=28,O="conversationHistory";function Se(){const n=V()?.includes(Y)??!1,s=M(),o=!n&&!!s?.data,{data:t,fetchNextPage:c,hasNextPage:u,isInitialLoading:g,isFetchingNextPage:m,isError:p}=Q({queryKey:[O],queryFn:async({pageParam:l})=>{const k=await X.getConversations({offset:l,limit:ce});return D(k.items),k},initialPageParam:0,getNextPageParam:l=>{const k=l.offset+l.limit;return k<l.total?k:void 0},enabled:o}),S=r.useMemo(()=>t?.pages.flatMap(l=>l.items)??[],[t]);return r.useEffect(()=>{D(S)},[S]),{conversations:S,data:t,fetchNextPage:c,hasNextPage:u,isLoading:g,isFetchingNextPage:m,isError:p}}function ve(e){e.invalidateQueries({queryKey:[O]})}export{O as C,he as D,ee as a,be as b,E as c,se as d,fe as e,ke as f,ve as r,pe as s,Se as u};
//# sourceMappingURL=fx7mucxyea7fii3k.js.map
