const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/gi2hoqfj9stsk2p6.js","assets/ornmk1um6pytkf56.js","assets/gyt8ikkud27lp54m.js","assets/root-o6g0n1da.css","assets/iolwngj4r86yp6qr.js","assets/fl6q9z66k3fbh83y.js","assets/conversation-small-cll5buey.css","assets/q87lshoqcipac183.js","assets/c8zxz05g6fozv2d6.js","assets/lb77108t2pd7cmgz.js","assets/gtkn2sln66iaqe9r.js"])))=>i.map(i=>d[i]);
import{a0 as N,al as ae,r as C,y as e,bs as E,ae as n,aA as L,a1 as z,l as P,a9 as U,dc as S,aw as te,a4 as se,j as $,N as ie,ab as ne,ac as oe,$ as re,bz as O,L as M,bA as k,dV as ce,ak as W,be as V,P as de,dX as le,w as me}from"./ornmk1um6pytkf56.js";import{an as ue,d as ge,a2 as G,D as he,E as pe,F as fe,dH as B,d8 as xe,dI as ve,dJ as we,bz as _,dB as q,br as J}from"./fl6q9z66k3fbh83y.js";import{C as ye,D as be,e as je}from"./q87lshoqcipac183.js";import{a as A,G as p,U as h}from"./h9d8gf8zabmyld3j.js";import{p as Se,V as Ge,a as Ie,J as Ce,aZ as Me,v as ke,Z as ze,P as Pe,b2 as Ae,az as Te,b3 as K,S as _e,b4 as Fe,r as De,b5 as Ne,O as Ee,an as Le}from"./gyt8ikkud27lp54m.js";import{d as Ue,T as $e,r as Oe}from"./c8zxz05g6fozv2d6.js";import{G as I}from"./nffs3uwjlshp2f6o.js";import{R as We}from"./n2waatanazyixasb.js";import{B as H,D as o}from"./iolwngj4r86yp6qr.js";import{c as Ve,d as Be}from"./dsurwjwve9ns2b4z.js";import{G as qe}from"./f838bxlw69dd8ijo.js";import"./gtkn2sln66iaqe9r.js";import"./lb77108t2pd7cmgz.js";import"./r910aebmjwqa8f6g.js";import"./jebpfhgxpd46kt5o.js";import"./iuruwr9n7vuvwwwc.js";import"./du6cl22gdnth06pl.js";import"./djx3w9g8bqctvu1a.js";import"./iytjv2rb4r5juap5.js";import"./fhj1x6x5mv8ztzvu.js";import"./d8sjg49twkp74c2n.js";import"./cvtp1jqp0nbvrq61.js";import"./ho15zo99vomcb2me.js";import"./n0g921oxcaazr42z.js";import"./ljm6t9y6mf4obpk1.js";function Je(a){return P({mutationFn:async({message:t,includeFrom:s})=>{await G.sendFeedbackEmail(a,t,s)}})}const Ke=({gizmo:a})=>{const t=ue(),s=A(p.GPTFeedbackEmail),i=()=>h.closeModal(p.GPTFeedbackEmail),r=N(),w=ae(),[c,f]=C.useState(""),[x,d]=C.useState(!0),u=Je(a.gizmo.id),g=c.length===0;return e.jsx(E,{type:"success",title:r.formatMessage(j.title,{name:a.gizmo.display.name}),isOpen:s,onClose:i,size:"custom",showCloseButton:!0,className:"max-w-xl overflow-y-auto",hideSeparator:!0,children:e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"-mt-4 flex flex-grow flex-col space-y-4",children:[e.jsx(ge,{className:"mb-1 w-full resize-none overflow-y-auto rounded-md bg-transparent focus:border-gray-200 focus:ring-gray-200 dark:focus:border-white dark:focus:ring-white",placeholder:`Write feedback about ${a.gizmo.display.name}...`,value:c,rows:4,onChange:l=>f(l.target.value)}),e.jsxs("div",{className:"flex flex-row items-center space-x-2 self-start",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:l=>d(l.target.checked)}),t&&e.jsx("span",{className:"text-sm",children:e.jsx(n,{...j.includeFrom,values:{email:e.jsx("strong",{children:t.email})}})})]}),e.jsx(L,{color:"primary",disabled:g,onClick:async()=>{await u.mutateAsync({message:c,includeFrom:x}),w.success(r.formatMessage(j.successToast),{duration:3}),i()},children:e.jsx(n,{...j.send,values:{name:a.gizmo.author.display_name}})})]})})})},j=z({title:{id:"GizmoFeedbackEmailModal.title",defaultMessage:"Feedback about {name}"},send:{id:"GizmoFeedbackEmailModal.sendTo",defaultMessage:"Send To {name}"},successToast:{id:"GizmoFeedbackEmailModal.successToast",defaultMessage:"Feedback sent"},includeFrom:{id:"GizmoFeedbackEmailModal.includeFrom",defaultMessage:"Include my email address {email}"}});function He(a){const t=$();return P({mutationFn:async({actionId:s,domain:i,settings:r})=>G.upsertUserActionSettings(s,i,r),onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}function Qe(a){const t=$();return P({mutationFn:async({pluginId:s})=>{await ie.deletePluginUserSettings({pluginId:s})},onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}const Xe=({gizmo:a})=>{const{data:t,isLoading:s}=ye(a.gizmo.id,!0),i=A(p.GPTPrivacySettings),r=()=>h.closeModal(p.GPTPrivacySettings),w=N(),[c,f]=C.useState("actions"),x=t!=null&&t.settings.some(d=>d.oauth_status!=null&&a.tools.some(u=>u.type===S.JIT_PLUGIN&&u.metadata?.action_id===d.action_id));return c==="connected_accounts"&&!x&&f("actions"),e.jsx(E,{title:w.formatMessage(v.title),isOpen:i,onClose:r,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:s?e.jsx(te,{}):e.jsxs(he,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:c,onValueChange:d=>{f(d)},children:[x&&e.jsxs(pe,{className:se("flex min-w-[180px] max-w-[200px] flex-shrink-0 flex-col gap-2"),children:[e.jsx(F,{value:"actions",message:v.actions}),x&&e.jsx(F,{value:"connected_accounts",message:v.connectedAccounts})]}),e.jsxs("div",{className:"flex-1 text-sm",children:[c==="actions"&&e.jsxs(D,{children:[e.jsx(n,{...v.allowedActionsDesc,values:{gizmoName:a.gizmo.display.name}}),t?.settings.map((d,u)=>{const g=a.tools?.find(l=>l.type===S.JIT_PLUGIN&&l.metadata?.action_id===d.action_id);return g&&e.jsx(Ze,{gizmoId:a.gizmo.id,actionSettings:d,actionTool:g},u)})]}),c==="connected_accounts"&&e.jsxs(D,{children:[e.jsx(n,{...v.connectedAccountsDesc,values:{gizmoName:a.gizmo.display.name}}),e.jsx("div",{children:t?.settings.map((d,u)=>{const g=a.tools?.find(l=>l.type===S.JIT_PLUGIN&&l.metadata?.action_id===d.action_id);return g&&d.oauth_status&&e.jsx(Ye,{gizmoId:a.gizmo.id,actionSettings:d,actionTool:g},u)})})]})]})]})})};function F({value:a,message:t}){return e.jsx(fe,{className:"flex rounded-md px-2 py-1.5 text-sm text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary",value:a,children:e.jsx("div",{className:"truncate",children:e.jsx(n,{...t})})})}function Ze({gizmoId:a,actionSettings:t,actionTool:s}){const i=He(a),r=t.action_settings?.all,w=c=>{s.metadata?.action_id&&s.metadata?.domain&&i.mutateAsync({actionId:s.metadata.action_id,domain:s.metadata.domain,settings:{all:c}})};return e.jsx("div",{children:e.jsxs(Q,{className:"border-b border-black/10 dark:border-white/10",children:[e.jsxs("div",{className:"flex flex-row space-x-4",children:[e.jsx("div",{className:"font-semibold",children:s.metadata?.domain}),e.jsxs("a",{href:s.metadata?.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"flex items-center gap-1 text-token-text-tertiary hover:cursor-pointer hover:text-token-text-secondary",children:[e.jsx(n,{...v.privacyPolicyLink}),e.jsx(Se,{className:"icon-md"})]})]}),e.jsxs("select",{value:r?"always_allow":"unset",onChange:c=>w(c.target.value),className:"rounded border-none bg-token-main-surface-primary text-sm",children:[e.jsx("option",{value:"always_allow",children:e.jsx(n,{...v.alwaysAllowDropdown})}),e.jsx("option",{value:"unset",children:e.jsx(n,{...v.askDropdown})})]})]})})}function Ye({gizmoId:a,actionSettings:t,actionTool:s}){const i=Qe(a),r=t.oauth_status==="valid";return e.jsxs(Q,{children:[e.jsx("div",{className:"font-semibold",children:s?.metadata?.domain}),e.jsx(L,{color:"secondary",size:"small",onClick:()=>{s.metadata?.action_id&&s.metadata?.domain&&(r?i.mutateAsync({pluginId:s.metadata?.action_id}):G.doOAuthRedirect(a,s.metadata?.action_id,s.metadata?.domain,window.location.href))},children:e.jsx(n,{...r?v.logout:v.login})})]})}const D=U.div`flex flex-col gap-6`,Q=U.div`flex flex-row justify-between py-3 items-center`,v=z({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}}),Re=ne(()=>oe(()=>import("./gi2hoqfj9stsk2p6.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10])).then(a=>a.GizmoKeepInSidebarMenuItem));function ka({children:a,clientThreadId:t,gizmoResource:s,showReportModal:i,inMobileHeader:r}){return e.jsxs(e.Fragment,{children:[e.jsx(H,{contentAlign:r?"center":"start",size:"small",triggerButton:a,children:e.jsx(aa,{clientThreadId:t,gizmoResource:s,showReportModal:i})}),e.jsx(ea,{gizmoResource:s})]})}function ea({gizmoResource:a}){const t=A(p.GPTRemoveThirdParty),s=re(),i=B(a);return e.jsxs(e.Fragment,{children:[e.jsx(Ve,{gizmoId:a.gizmo.id,creatorId:a.gizmo.author.user_id}),e.jsx(Xe,{gizmo:a}),i&&e.jsx(Ke,{gizmo:a}),i&&e.jsx(qe,{gizmo:a}),e.jsx(We,{gpt:a,isOpen:t,onClose:()=>h.closeModal(p.GPTRemoveThirdParty),account:s})]})}function aa({clientThreadId:a,gizmoResource:t,showReportModal:s}){const i=xe(t),r=ve(t),w=be(t.gizmo.id),c=O(),f=we(t),x=t.gizmo.share_recipient===_.Marketplace||t.gizmo.share_recipient===_.Link,d=!f&&x,u=M("1825130190").value,g=M("3645668434").value,l=u&&!f&&B(t),X=c?.includes(k.GizmoSupportEmails)&&!f&&t.gizmo.author.will_receive_support_emails&&l,Z=ce(),T=Ue(a),Y=q(k.WorkspaceShareLinks),{isUnauthenticated:R}=W(),ee=T&&Y&&!R,y=V();return e.jsxs(e.Fragment,{children:[e.jsx(o.Item,{onClick:()=>{de.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:t.gizmo.id}),J(y,`/g/${t.gizmo.short_url}`)},icon:Ge,children:e.jsx(n,{...m.newChat})}),e.jsx(o.Item,{onClick:()=>h.openModal(p.GPTDetails),icon:Ie,children:e.jsx(n,{...m.about})}),t.tools?.find(b=>b.type===S.JIT_PLUGIN)&&e.jsx(o.Item,{onClick:()=>h.openModal(p.GPTPrivacySettings),icon:Ce,children:e.jsx(n,{...m.privacySettings})}),i&&e.jsx(o.Item,{onClick:()=>{y(w)},icon:Me,children:e.jsx(n,{...m.customize})}),!i&&r&&g&&e.jsxs(e.Fragment,{children:[e.jsx(o.Item,{onClick:async()=>{y(`/g/${t.gizmo.id}/view`)},icon:ke,children:e.jsx(n,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),e.jsx(o.Item,{onClick:async()=>{const b=await G.copyGizmo({gizmoId:t.gizmo.id});b.gizmo.id&&y(`/gpts/editor/${b.gizmo.id}`)},icon:ze,children:e.jsx(n,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),e.jsx(Re,{gizmoResource:t}),e.jsx(Be,{gizmoResource:t}),X&&e.jsx(o.Item,{onClick:()=>h.openModal(p.GPTFeedbackEmail),icon:Pe,children:e.jsx(n,{...m.feedbackEmail})}),l&&e.jsx(o.Item,{onClick:()=>h.openModal(p.GPTReview),icon:Ae,children:e.jsx(n,{...m.reviewGPT})}),d&&e.jsx(o.Item,{onClick:s,icon:Te,children:e.jsx(n,{...m.report})}),ee&&e.jsx(o.Item,{onClick:()=>h.openSharingModal(T),icon:K,children:e.jsx(n,{...m.shareChat})}),Z&&e.jsxs(e.Fragment,{children:[e.jsx(o.Separator,{}),e.jsx(o.Item,{color:"danger",onClick:()=>h.openModal(p.GPTRemoveThirdParty),icon:_e,children:e.jsx(n,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),c?.includes("debug")&&e.jsxs(e.Fragment,{children:[e.jsx(o.Separator,{}),e.jsx(o.Item,{onClick:()=>{y(je(t))},children:"(Internal) See share page"})]})]})}const ta=({clientThreadId:a})=>{const s=O()?.includes("debug"),i=$e.getServerThreadId(a),r=q(k.WorkspaceShareLinks),{isUnauthenticated:w}=W(),c=r&&i&&!w,f=le.useStore(),{value:x}=M("3653083604"),{value:d}=me("2851018874"),u=x||d&&window.documentPictureInPicture,g=Oe(a),l=V();return e.jsxs(e.Fragment,{children:[c&&e.jsx(o.Item,{onClick:()=>h.openSharingModal(i,"History Item Menu"),icon:K,"data-testid":"share-chat-menu-item",children:e.jsx(n,{...m.shareChat})}),u&&e.jsx(o.Item,{onClick:()=>{f.setThreadId(a,!0),g&&J(l)},icon:Fe,children:e.jsx(n,{...m.openInCompanionWindow})}),e.jsx(o.Item,{disabled:!i,onClick:()=>{setTimeout(()=>{i&&I.publish({kind:"editTitle",serverThreadId:i})},100)},icon:De,children:e.jsx(n,{...m.renameChat})}),e.jsx(o.Item,{disabled:!i,onClick:()=>{i&&I.publish({kind:"archiveChat",serverThreadId:i})},icon:Ne,children:e.jsx(n,{...m.archiveChat})}),e.jsx(o.Item,{color:"danger",disabled:!i,onClick:()=>{i&&I.publish({kind:"deleteChat",serverThreadId:i})},icon:Ee,"data-testid":"delete-chat-menu-item",children:e.jsx(n,{...m.deleteChat})}),s&&e.jsxs(e.Fragment,{children:[e.jsx(o.Separator,{}),e.jsx(o.Item,{onClick:()=>h.toggleActiveSidebar("debug"),icon:Le,children:e.jsx(n,{...m.debugChat})})]})]})},za=({clientThreadId:a,children:t,onOpenChange:s})=>e.jsx(H,{onOpenChange:s,side:"bottom",contentAlign:"start",triggerButton:t,size:"auto",children:e.jsx(ta,{clientThreadId:a})}),m=z({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},openInCompanionWindow:{defaultMessage:"Open in Companion Window",id:"GizmoInformation.openInCompanionWindow"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}});export{za as GizmoConversationOptionsDropdown,ka as GizmoInformationDropdown,aa as GizmoInformationDropdownItems};
//# sourceMappingURL=ijwz0cpmkj00yyki.js.map
