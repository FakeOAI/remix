import{G as C,bf as I,ge as x,M as p,r as w,y as u,P as g,d as r,S as E,L as _,m as D,em as a,e as N,b1 as O,aT as h}from"./nz9x58rcwaqc60b4.js";import{by as o,bz as P}from"./or560n5qz3kpvvuq.js";import{I as R}from"./k1dbktiqldfwwn15.js";import"./ogd9t3e603yvziyi.js";import"./bgy2h3g6753v0xxk.js";const f=(...e)=>t=>e.some(s=>s(t)),m=({allGroupedMessages:e})=>e.some(t=>[o.Browsing,o.RetrievalBrowsing,o.ParallelBrowsing].includes(t.type)),b=({allGroupedMessages:e})=>e.some(t=>t.type===o.SearchGPTQuery),y=({allGroupedMessages:e})=>e.some(t=>t.type===o.CodeInterpreter);function z(e){return!e||!e.instructions?"":typeof e.instructions=="string"?e.instructions:e.instructions.filter(t=>typeof t=="string").join("")}const B=[{match:f(m,b),tag:"Shouldn't have searched the web",label:a({id:"kL047b",defaultMessage:"Shouldn't have searched the web"})},{match:f(m,b),tag:"Don't like the source it cited",label:a({id:"OWjzGX",defaultMessage:"Don't like the sources it cited"})},{match:y,tag:"Shouldn't have run code",label:a({id:"53w4ay",defaultMessage:"Shouldn't have run code"})},{match:y,tag:"Couldn't handle my file",label:a({id:"EkFTQ5",defaultMessage:"Couldn't handle my file"})},{match:({allGroupedMessages:e})=>e.some(t=>t.type===o.Dalle),tag:"Shouldn't have created an image",label:a({id:"S8FRsr",defaultMessage:"Shouldn't have created an image"})},{match:({allGroupedMessages:e})=>e.some(t=>{if(t.type!==o.Text)return!1;const{message:s}=t.message,{content:n}=s;return n.content_type===p.Text&&N(s).match(/^```[\S]+\n/gm)}),tag:"Code was incorrect",label:a({id:"4EBdQk",defaultMessage:"Code was incorrect"})},{match:({systemContent:e})=>z(e).includes("Personality")??!1,tag:"Too chatty or casual",label:a({id:"ATzJKW",defaultMessage:"Too chatty or casual"})},{match:({features:e})=>e.includes(O.Sunshine),tag:"Shouldn't have used Memory",label:a({id:"yfUEiz",defaultMessage:"Shouldn't have used Memory"})},{tag:"Don't like the style",label:a({id:"nGxjdj",defaultMessage:"Don't like the style"})},{tag:"Not factually correct",label:a({id:"Ke7JtQ",defaultMessage:"Not factually correct"})},{tag:"Didn't fully follow instructions",label:a({id:"Rdlt9V",defaultMessage:"Didn't fully follow instructions"})},{tag:"Refused when it shouldn't have",label:a({id:"2yRS/Q",defaultMessage:"Refused when it shouldn't have"})},{tag:"Being lazy",label:a({id:"14MPmT",defaultMessage:"Being lazy"})},{tag:"Unsafe or problematic",label:a({id:"02pXBl",defaultMessage:"Unsafe or problematic"})},{tag:"Other",label:a({id:"WiIGE+",defaultMessage:"Other"})}],G=[{tag:"I disagree with the policy",label:a({id:"oKyDLz",defaultMessage:"I disagree with the policy"})},{tag:"This didn't violate the policy",label:a({id:"7fUkVF",defaultMessage:"This didn't violate the policy"})},{tag:"I don't understand the policy",label:a({id:"4Cdp6N",defaultMessage:"I don't understand the policy"})},{tag:"This didn't take the full context",label:a({id:"vnZJDP",defaultMessage:"This didn't take the full context"})}];function j(e,t,s){return t.filter(n=>!n.match||n.match(s)).map(n=>({value:n.tag,label:e.formatMessage(n.label)}))}function A(e){const t=e[e.length-1];if(!t)return!1;const s="message"in t?t.message:null;if(s){const{errCode:n}=P(s);return[h.ContentPolicy,h.ContentOrTos].includes(n)}else return!1}function K({clientThreadId:e,conversationMessage:t,currentModelId:s,allGroupedMessages:n}){const S=C(),k=I()??[],i=t.rating,c=x(e,t.message.id),M=c?.message.content.content_type===p.SystemContent?c?.message.content:null,T=w.useCallback(l=>{const d=u.getServerThreadId(e);d&&(l.tags.length===0&&!l.textFeedback||(g.logEvent(l.source==="inline"?r.messageFeedbackInlineSubmitted:r.messageFeedbackDialogSubmitted,{id:t.message.id,threadId:d,tags:l.tags,content:l.textFeedback,model:s,rating:i}),E.logEvent(l.source==="inline"?"chatgpt_feedback_inline_submitted":"chatgpt_feedback_dialog_submitted",l.tags?.[0]??null,{id:t.message.id,threadId:d,tag:l.tags?.[0]??"",content:l.textFeedback??"",model:s,rating:i??""}),i&&_.submitMessageFeedback({message_id:t.message.id,conversation_id:d,rating:i,text:l.textFeedback,tags:l.tags,tag_choices:l.tagChoices})))},[e,t.message,s,i]),v=()=>{g.logEvent(r.messageFeedbackMoreOptionsClicked,{id:t.message.id,threadId:u.getServerThreadId(e),model:s,rating:i})},F=j(S,A(n)?G:B,{allGroupedMessages:n,features:k,currentModelId:s,systemContent:M});return i==="thumbsUp"?null:D.jsx(R,{tagOptions:F,onSubmit:T,onMoreClicked:v})}export{K as default};
//# sourceMappingURL=d31xhd8ozgxh94z7.js.map
