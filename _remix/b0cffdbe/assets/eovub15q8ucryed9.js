import{bQ as _,aL as w,d5 as H,d6 as q,b5 as U}from"./ibpo4l2zkh6u1ih1.js";import{b$ as A,aC as D,aS as B,ep as F,as as E,eq as K,d1 as T,er as V,r as k,R as Q,bR as Y,an as h,P as b,F as v,j as s,U as p,aQ as N,V as X,es as W,a2 as z,bB as Z,N as $}from"./iryvtox9frru8zal.js";import{a as C}from"./czgd79kfog1dyt49.js";import{L as O}from"./ob0adlimgokiq43t.js";import{c as L}from"./mf6g7tm9dubb0dmt.js";function j(){return D("437245079").value}function J(){const e=j(),o=L(),n=A("1908072088").config.value,{eligible:t,isLoading:i}=_(w.AG8PqS2q);return{eligible:t&&e&&o&&n.blocking_modal===!0,singleButtonVariant:n.single_button_variant===!0,isLoading:i}}function pe(){const e=j(),o=L(),n=A("1908072088").config.value,{eligible:t,isLoading:i}=_(w.AG8PqS2q);return{eligible:t&&e&&o&&n.dropdown_tooltip,isLoading:i}}const G=28,P="conversationHistory";function he(){const e=B(),o=(e==null?void 0:e.includes(F))??!1,n=E(),t=!o&&!!(n!=null&&n.data),i=K.useRelayEnvironment(),{value:c}=D("2893406386"),g=ee(i,t&&c),m=ne(t&&!c),{conversations:a,data:l,fetchNextPage:d,hasNextPage:r,isInitialLoading:f,isFetchingNextPage:S,isError:M}=c?g:m;return{data:l,conversations:a,fetchNextPage:d,hasNextPage:r,isLoading:f,isFetchingNextPage:S,isError:t&&M}}function ee(e,o){const{data:n,fetchNextPage:t,hasNextPage:i,isInitialLoading:c,isFetchingNextPage:g,isError:m}=T({queryKey:[P],queryFn:({pageParam:l})=>V.fetchQuery_DEPRECATED(e,oe,{after:l,first:G,order:"updated",expand:!1,isArchived:!1}),initialPageParam:"aWR4Oi0x",getNextPageParam:l=>{var d,r;if((d=l.conversationDisplayHistory)!=null&&d.pageInfo.hasNextPage)return(r=l.conversationDisplayHistory)==null?void 0:r.pageInfo.endCursor},enabled:o}),a=k.useMemo(()=>(n==null?void 0:n.pages.flatMap(l=>{var d;return(((d=l.conversationDisplayHistory)==null?void 0:d.edges)??[]).flatMap(r=>{var f;return r!=null&&r.node?[{id:r.node.id,title:r.node.title??"",create_time:r.node.createTime,update_time:r.node.updateTime,conversation_template_id:(f=r.node.primaryGizmo)==null?void 0:f.id,async_status:r.node.asyncStatus}]:[]})}))??[],[n]);return k.useEffect(()=>{C(a)},[a]),{conversations:a,data:n,fetchNextPage:t,hasNextPage:i,isInitialLoading:c,isFetchingNextPage:g,isError:m}}function ne(e){const{data:o,fetchNextPage:n,hasNextPage:t,isInitialLoading:i,isFetchingNextPage:c,isError:g}=T({queryKey:[P],queryFn:async({pageParam:a})=>{const l=await Q.getConversations({offset:a,limit:G});return C(l.items),l},initialPageParam:0,getNextPageParam:a=>{const l=a.offset+a.limit;return l<a.total?l:void 0},enabled:e});return{conversations:k.useMemo(()=>(o==null?void 0:o.pages.flatMap(a=>a.items))??[],[o]),data:o,fetchNextPage:n,hasNextPage:t,isInitialLoading:i,isFetchingNextPage:c,isError:g}}function fe(e){e.invalidateQueries({queryKey:[P]})}const oe=H,R=w.UseSidekick,te=w.SidekickLauncherOnboarding,y="https://persistent.oaistatic.com/sidekick/public/ChatGPT_Desktop_public_latest.dmg",I="download";function x(){const e=E(),o=W("1696863369").layer.get("has_sidekick_access",!1);return e!=null&&o}function se(e){return e===I}function ie(){const e=z(),n=(Z(()=>e.asPath)??"").split("#"),t=se(n[1]);return{openModal:()=>{const c=e.asPath.split("#");e.replace(c[0]+"#"+I)},closeModal:()=>{e.replace(n[0])},isOpen:t}}function be(e){var d;const{eligible:o,isLoading:n}=J(),t=x(),{eligible:i,isLoading:c}=_(R),{eligible:g,isLoading:m}=_(te),a=o||!i||!g||!t||((d=e.conversationMode)==null?void 0:d.kind)!==Y.PrimaryAssistant,l=n||m||c;return{eligible:!a&&h.getLayerValue({layerName:"1696863369",key:"show_nux_banner",defaultValue:!1}),isLoading:l}}function ve({onClose:e}){k.useEffect(()=>{b.logEvent(v.sidekickAnnouncementShown),h.logEvent("chatgpt_sidekick_announcement_shown")},[]);const{markAsViewed:o}=_(R),n=k.useCallback(()=>{o(),b.logEvent(v.sidekickAnnouncementDismissed),h.logEvent("chatgpt_sidekick_announcement_closed"),e&&e()},[o,e]),t=k.useCallback(()=>{b.logEvent(v.sidekickAnnouncementLinkClicked),h.logEvent("chatgpt_sidekick_announcement_download_clicked"),o(),e&&e()},[o,e]),i={downloadUrl:y,markAsDownloaded:t,markAsViewed:n,isSidekickAvailable:x()};return s.jsx(re,{...i})}function ae(){window.open(y,"_blank")}function le(){var e;return(e=E())!=null&&e.isPlus()?u.bannerTitleMentioningPlus:u.bannerTitleNotMentioningPlus}function _e(){const{closeModal:e,isOpen:o}=ie(),n=x(),t=k.useMemo(()=>({isDesktopAppAvailable:n}),[n]),i=()=>{b.logEvent(v.sidekickDownloadModalClosed,t),h.logEvent("chatgpt_sidekick_modal_closed"),e()},c=()=>{b.logEvent(v.sidekickDownloadModalDownloaded,t),h.logEvent("chatgpt_sidekick_modal_download_clicked"),e()};return k.useEffect(()=>{o&&(b.logEvent(v.sidekickDownloadModalShown,{...t}),h.logEvent("chatgpt_sidekick_modal_shown"))},[t,o]),o?s.jsx(ce,{downloadUrl:y,markAsDownloaded:c,markAsViewed:i,isSidekickAvailable:n}):null}function ce({downloadUrl:e,markAsDownloaded:o,markAsViewed:n,isSidekickAvailable:t}){const i=t?u.modalTitleEligible:u.modalTitleNotEligible,c=s.jsx(p,{...i}),g=s.jsx(p,{...u.modalContent}),m=t?u.disclaimer:u.comingSoonDisclaimer,a=s.jsx(p,{...m,values:{learnMoreLink:M=>s.jsx(O,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:M})}}),l=s.jsxs("div",{children:[s.jsx("div",{children:g}),s.jsx("div",{className:"mt-2",children:a})]}),d=s.jsx(N,{as:"link",to:e,color:"primary",onClick:o,openNewTab:!0,children:s.jsx(p,{...u.download})}),r=s.jsx(N,{color:"secondary",onClick:n,children:s.jsx(p,{...u.close})}),f=t?d:r,S=t?r:void 0;return s.jsx(q,{onClose:n,title:c,description:l,actionButton:f,cancelButton:S})}function re({markAsDownloaded:e,markAsViewed:o}){const n=$(),t=k.useCallback(()=>{ae(),e()},[e]),i=s.jsx(p,{...le()}),c=s.jsx(p,{...u.bannerContent}),g=s.jsx(p,{...u.disclaimer,values:{learnMoreLink:a=>s.jsx(O,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:a})}}),m=s.jsxs("div",{className:"flex-grow",children:[s.jsx("div",{className:"mb-0.5 font-semibold",children:i}),s.jsxs("span",{className:"text-token-text-secondary",children:[c," ",g]})]});return s.jsx(U,{onPrimaryCtaClick:t,primaryCtaText:n.formatMessage(u.download),onDismiss:o,content:m})}const u=X({bannerTitleNotMentioningPlus:{id:"SidekickOnboarding.bannerTitleEnterprisey_2",defaultMessage:"ChatGPT is available for macOS 14+ with Apple Silicon"},bannerTitleMentioningPlus:{id:"SidekickOnboarding.bannerTitleMentioningPlus",defaultMessage:"ChatGPT is now available for macOSâ€”Plus users get early access"},modalTitleEligible:{id:"SidekickOnboarding.modalTitleEligible",defaultMessage:"The ChatGPT app is now available for macOS"},modalTitleNotEligible:{id:"SidekickOnboarding.modalTitleNotEligible",defaultMessage:"The ChatGPT macOS desktop app is coming soon"},modalContent:{id:"SidekickOnboarding.modal_content_eligible",defaultMessage:"Quickly access ChatGPT from anywhere on your computer with a shortcut: Option + Space. Share screenshots, upload files and photos, have voice conversations, and search through past conversations."},bannerContent:{id:"SidekickOnboarding.banner_content_3",defaultMessage:"Get faster access to ChatGPT with the Option + Space shortcut and the floating companion window."},disclaimer:{id:"SidekickOnboarding.disclaimer_3",defaultMessage:"<learnMoreLink>Learn more</learnMoreLink>."},comingSoonDisclaimer:{id:"SidekickOnboarding.coming_soon_disclaimer",defaultMessage:"The app will be available over the next couple of weeks."},download:{id:"SidekickOnboarding.download",defaultMessage:"Download"},close:{id:"SidekickOnboarding.close",defaultMessage:"Close"}});export{P as C,_e as D,J as a,x as b,ie as c,pe as d,ve as e,be as f,fe as r,he as u};
//# sourceMappingURL=eovub15q8ucryed9.js.map
