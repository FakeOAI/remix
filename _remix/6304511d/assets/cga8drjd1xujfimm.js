import{bP as A,aD as D,bQ as H,ak as p,r as k,P as b,A as v,j as i,K as h,bt as N,N as U,as as S,eA as q,X as B,bw as F,H as K,aM as V,eB as Y,eC as Q,d3 as T,eD as X,R as W}from"./gdbo8e7dyfri4is1.js";import{bJ as _,aE as w,cT as z,aY as J,cU as Z}from"./lfqdgp7xsc2kl8bj.js";import{L as C}from"./jhr269i6izlz9q7b.js";import{e as O}from"./gjmdn4uakoveniqh.js";import{c as L}from"./nxkvdrqju2o1909p.js";function j(){return D("437245079").value}function $(){const e=j(),o=O(),n=A("1908072088").config.value,{eligible:t,isLoading:s}=_(w.AG8PqS2q);return{eligible:t&&e&&o&&n.blocking_modal===!0,singleButtonVariant:n.single_button_variant===!0,isLoading:s}}function he(){const e=j(),o=O(),n=A("1908072088").config.value,{eligible:t,isLoading:s}=_(w.AG8PqS2q);return{eligible:t&&e&&o&&n.dropdown_tooltip,isLoading:s}}const G=w.UseSidekick,ee=w.SidekickLauncherOnboarding,P="https://persistent.oaistatic.com/sidekick/public/ChatGPT_Desktop_public_latest.dmg",I="download";function y(){const e=S(),o=q("1696863369").layer.get("has_sidekick_access",!1);return e!=null&&o}function ne(e){return e===I}function oe(){const e=B(),n=(F(()=>e.asPath)??"").split("#"),t=ne(n[1]);return{openModal:()=>{const c=e.asPath.split("#");e.replace(c[0]+"#"+I)},closeModal:()=>{e.replace(n[0])},isOpen:t}}function pe(e){var d;const{eligible:o,isLoading:n}=$(),t=y(),{eligible:s,isLoading:c}=_(G),{eligible:g,isLoading:m}=_(ee),a=o||!s||!g||!t||((d=e.conversationMode)==null?void 0:d.kind)!==H.PrimaryAssistant,l=n||m||c;return{eligible:!a&&p.getLayerValue({layerName:"1696863369",key:"show_nux_banner",defaultValue:!1}),isLoading:l}}function fe({onClose:e}){k.useEffect(()=>{b.logEvent(v.sidekickAnnouncementShown),p.logEvent("chatgpt_sidekick_announcement_shown")},[]);const{markAsViewed:o}=_(G),n=k.useCallback(()=>{o(),b.logEvent(v.sidekickAnnouncementDismissed),p.logEvent("chatgpt_sidekick_announcement_closed"),e&&e()},[o,e]),t=k.useCallback(()=>{b.logEvent(v.sidekickAnnouncementLinkClicked),p.logEvent("chatgpt_sidekick_announcement_download_clicked"),o(),e&&e()},[o,e]),s={downloadUrl:P,markAsDownloaded:t,markAsViewed:n,isSidekickAvailable:y()};return i.jsx(ae,{...s})}function te(){window.open(P,"_blank")}function ie(){var e;return(e=S())!=null&&e.isPlus()?u.bannerTitleMentioningPlus:u.bannerTitleNotMentioningPlus}function be(){const{closeModal:e,isOpen:o}=oe(),n=y(),t=k.useMemo(()=>({isDesktopAppAvailable:n}),[n]),s=()=>{b.logEvent(v.sidekickDownloadModalClosed,t),p.logEvent("chatgpt_sidekick_modal_closed"),e()},c=()=>{b.logEvent(v.sidekickDownloadModalDownloaded,t),p.logEvent("chatgpt_sidekick_modal_download_clicked"),e()};return k.useEffect(()=>{o&&(b.logEvent(v.sidekickDownloadModalShown,{...t}),p.logEvent("chatgpt_sidekick_modal_shown"))},[t,o]),o?i.jsx(se,{downloadUrl:P,markAsDownloaded:c,markAsViewed:s,isSidekickAvailable:n}):null}function se({downloadUrl:e,markAsDownloaded:o,markAsViewed:n,isSidekickAvailable:t}){const s=t?u.modalTitleEligible:u.modalTitleNotEligible,c=i.jsx(h,{...s}),g=i.jsx(h,{...u.modalContent}),m=t?u.disclaimer:u.comingSoonDisclaimer,a=i.jsx(h,{...m,values:{learnMoreLink:E=>i.jsx(C,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:E})}}),l=i.jsxs("div",{children:[i.jsx("div",{children:g}),i.jsx("div",{className:"mt-2",children:a})]}),d=i.jsx(N,{as:"link",to:e,color:"primary",onClick:o,openNewTab:!0,children:i.jsx(h,{...u.download})}),r=i.jsx(N,{color:"secondary",onClick:n,children:i.jsx(h,{...u.close})}),f=t?d:r,M=t?r:void 0;return i.jsx(z,{onClose:n,title:c,description:l,actionButton:f,cancelButton:M})}function ae({markAsDownloaded:e,markAsViewed:o}){const n=K(),t=k.useCallback(()=>{te(),e()},[e]),s=i.jsx(h,{...ie()}),c=i.jsx(h,{...u.bannerContent}),g=i.jsx(h,{...u.disclaimer,values:{learnMoreLink:a=>i.jsx(C,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:a})}}),m=i.jsxs("div",{className:"flex-grow",children:[i.jsx("div",{className:"mb-0.5 font-semibold",children:s}),i.jsxs("span",{className:"text-token-text-secondary",children:[c," ",g]})]});return i.jsx(J,{onPrimaryCtaClick:t,primaryCtaText:n.formatMessage(u.download),onDismiss:o,content:m})}const u=U({bannerTitleNotMentioningPlus:{id:"SidekickOnboarding.bannerTitleEnterprisey_2",defaultMessage:"ChatGPT is available for macOS 14+ with Apple Silicon"},bannerTitleMentioningPlus:{id:"SidekickOnboarding.bannerTitleMentioningPlus",defaultMessage:"ChatGPT is now available for macOSâ€”Plus users get early access"},modalTitleEligible:{id:"SidekickOnboarding.modalTitleEligible",defaultMessage:"The ChatGPT app is now available for macOS"},modalTitleNotEligible:{id:"SidekickOnboarding.modalTitleNotEligible",defaultMessage:"The ChatGPT macOS desktop app is coming soon"},modalContent:{id:"SidekickOnboarding.modal_content_eligible",defaultMessage:"Quickly access ChatGPT from anywhere on your computer with a shortcut: Option + Space. Share screenshots, upload files and photos, have voice conversations, and search through past conversations."},bannerContent:{id:"SidekickOnboarding.banner_content_3",defaultMessage:"Get faster access to ChatGPT with the Option + Space shortcut and the floating companion window."},disclaimer:{id:"SidekickOnboarding.disclaimer_3",defaultMessage:"<learnMoreLink>Learn more</learnMoreLink>."},comingSoonDisclaimer:{id:"SidekickOnboarding.coming_soon_disclaimer",defaultMessage:"The app will be available over the next couple of weeks."},download:{id:"SidekickOnboarding.download",defaultMessage:"Download"},close:{id:"SidekickOnboarding.close",defaultMessage:"Close"}}),R=28,x="conversationHistory";function ve(){const e=V(),o=(e==null?void 0:e.includes(Y))??!1,n=S(),t=!o&&!!(n!=null&&n.data),s=Q.useRelayEnvironment(),{value:c}=D("2893406386"),g=le(s,t&&c),m=ce(t&&!c),{conversations:a,data:l,fetchNextPage:d,hasNextPage:r,isInitialLoading:f,isFetchingNextPage:M,isError:E}=c?g:m;return{data:l,conversations:a,fetchNextPage:d,hasNextPage:r,isLoading:f,isFetchingNextPage:M,isError:t&&E}}function le(e,o){const{data:n,fetchNextPage:t,hasNextPage:s,isInitialLoading:c,isFetchingNextPage:g,isError:m}=T({queryKey:[x],queryFn:({pageParam:l})=>X.fetchQuery_DEPRECATED(e,re,{after:l,first:R,order:"updated",expand:!1,isArchived:!1}),initialPageParam:"aWR4Oi0x",getNextPageParam:l=>{var d,r;if((d=l.conversationDisplayHistory)!=null&&d.pageInfo.hasNextPage)return(r=l.conversationDisplayHistory)==null?void 0:r.pageInfo.endCursor},enabled:o}),a=k.useMemo(()=>(n==null?void 0:n.pages.flatMap(l=>{var d;return(((d=l.conversationDisplayHistory)==null?void 0:d.edges)??[]).flatMap(r=>{var f;return r!=null&&r.node?[{id:r.node.id,title:r.node.title??"",create_time:r.node.createTime,update_time:r.node.updateTime,conversation_template_id:(f=r.node.primaryGizmo)==null?void 0:f.id,async_status:r.node.asyncStatus}]:[]})}))??[],[n]);return k.useEffect(()=>{L(a)},[a]),{conversations:a,data:n,fetchNextPage:t,hasNextPage:s,isInitialLoading:c,isFetchingNextPage:g,isError:m}}function ce(e){const{data:o,fetchNextPage:n,hasNextPage:t,isInitialLoading:s,isFetchingNextPage:c,isError:g}=T({queryKey:[x],queryFn:async({pageParam:a})=>{const l=await W.getConversations({offset:a,limit:R});return L(l.items),l},initialPageParam:0,getNextPageParam:a=>{const l=a.offset+a.limit;return l<a.total?l:void 0},enabled:e});return{conversations:k.useMemo(()=>(o==null?void 0:o.pages.flatMap(a=>a.items))??[],[o]),data:o,fetchNextPage:n,hasNextPage:t,isInitialLoading:s,isFetchingNextPage:c,isError:g}}function _e(e){e.invalidateQueries({queryKey:[x]})}const re=Z;export{x as C,be as D,y as a,oe as b,ve as c,he as d,fe as e,pe as f,_e as r,$ as u};
//# sourceMappingURL=cga8drjd1xujfimm.js.map
