import{da as y,f as R,bw as S,u as f,h as A,b2 as T}from"./bkk1etpxp73xgxkk.js";import{E as p}from"./go6iqv7kynl41ls2.js";import{d as _}from"./grdjxd4t00xxfgii.js";const q=()=>{let e,s;const n=new Promise((r,a)=>{e=r,s=a});return{resolve:e,reject:s,value:n}},D=(e,s)=>{const n=e.name??`batcher:${Math.random().toString(16).slice(2)})`,r=e.scheduler??w(10),a=globalThis.__BATSHIT_DEVTOOLS__?.for(n);let t={seq:0,batch:new Set,currentRequest:q(),timer:void 0,start:null,latest:null};a?.create({seq:t.seq});const c=()=>{t.batch=new Set,t.currentRequest=q(),t.timer=void 0,t.start=null,t.latest=null};return{fetch:u=>{t.start||(t.start=Date.now()),t.latest=Date.now(),t.batch.add(u),clearTimeout(t.timer);const i=r(t.start,t.latest,t.batch.size);a?.queue({seq:t.seq,query:u,batch:[...t.batch],scheduled:i,latest:t.latest,start:t.start});const m=()=>{const o=t.seq,h=e.fetcher([...t.batch]),d=t.currentRequest;return a?.fetch({seq:o,batch:[...t.batch]}),c(),h.then(l=>{a?.data({seq:o,data:l}),d.resolve(l)}).catch(l=>{a?.error({seq:o,error:l}),d.reject(l)}),t.seq++,h};if(i==="immediate"){const o=t.currentRequest;return m(),o.value.then(h=>e.resolver(h,u))}else return i==="never"?t.currentRequest.value.then(o=>e.resolver(o,u)):(t.timer=setTimeout(m,i),t.currentRequest.value.then(o=>e.resolver(o,u)))}}},M=e=>(s,n)=>s.find(r=>r[e]==n),w=e=>(s,n)=>{const r=n-s;return e-r},v=y(e=>D({fetcher:async s=>{const n=new Map;for await(const r of R.streamedJsonPost(`${S}/attributions`,{urls:s}))r.attribution&&n.set(r.url,r.attribution),e.setQueryData(["attribution",{url:r.url}],r.attribution);return _(s.map(r=>{const a=n.get(r);return a&&{url:r,attribution:a}}))},resolver:M("url"),scheduler:w(100)}));function E(e,{useBaseUrl:s=!0,enabled:n=!0}={}){const r=s?p(e):e,a=f(),t=v(a);return A({queryKey:["attribution",{url:r}],queryFn:async()=>(await t.fetch(r)).attribution,enabled:n&&!!e})}function P(e,{useBaseUrl:s=!0,enabled:n=!0}={}){const r=s?e.map(p):e,a=f(),t=v(a);return T({queries:r.map(c=>({queryKey:["attribution",{url:c}],queryFn:async()=>(await t.fetch(c)).attribution,enabled:r.length>0&&n})),combine:c=>{const b=new Map;for(let u=0;u<c.length;u++){const i=c[u].data;i&&b.set(e[u],i)}return b}})}export{E as a,D as c,M as k,P as u,w};
//# sourceMappingURL=cfzeniuwphg3p3m9.js.map
