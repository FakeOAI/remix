import{eQ as C,r as f,dq as ue,bo as ae,eR as ce,P as x,eS as le,ao as c,e6 as K,ar as Y,av as U,F as Z,W as ye,cQ as fe,e4 as me,bk as de,bq as ge,a6 as O,bF as X,B as z,D as M,bR as $}from"./ok0u5qvj4oat7txg.js";import{bX as J,B as I,bC as pe,d8 as he,d9 as ze,da as _e,db as W,bt as Ge,dc as Pe,dd as v,aL as i,de as Me,df as Se,dg as ve,dh as Ce,di as be}from"./li4a57d0tlr94tbl.js";import{r as qe,T as j,g as Ee}from"./lzxdpwmkrkh5vblj.js";const We="text-davinci-002-render-sha",je="gpt-4",Ve="gpt-4o",Ye="o1-preview",Ze="o1-mini",R=J({slug:I,max_tokens:4097,title:"Default",description:"",tags:[C.GPT_3_5],product_features:{}}),Fe=({default_model:e,tagline:r,color:t,human_category_name:n,category:s,human_category_short_name:o,human_category_shorter_name:u,subscription_level:a,short_explainer:y,subcategory:l,...d})=>({color:t,tagline:r,defaultModel:e,label:n,shortLabel:o,description:y,shorterLabel:u??o,subscriptionLevel:a,categoryId:s,subcategory:l,...d}),we=({icon:e,icon_filled_src:r,icon_outline_src:t})=>({iconName:e,iconFilledSrc:r,iconOutlineSrc:t}),Qe=({group:e,human_group_name:r,human_group_short_name:t,model_ids:n})=>({group:e,label:r,shortLabel:t,modelIds:n});function Le(){return U({retry:5,queryKey:["modelIcons"],queryFn:async()=>await Z.getModelIcons().then(e=>Object.fromEntries(Object.entries(e).map(([r,t])=>[r,we(t)])))})}function Te(e){return U({retry:5,queryKey:["models",{isHistoryDisabled:e}],queryFn:async()=>await Z.getModels(e).then(r=>{const{models:t,internal_groups:n,categories:s}=r,o=t.map(J);return{categories:s.concat().reverse().map(Fe),groups:(n==null?void 0:n.map(Qe))??[],modelsList:o,modelsMap:Object.fromEntries(o.map(u=>[u.id,u]))}})})}function S(){const e=le();return c(Te(e))}function Xe(){return c(Le())}function Re({isRegen:e=!1}={}){const{isLoading:r,data:{categories:t=[],groups:n=[]}={}}=S(),s=f.useMemo(()=>e?t.filter(o=>o.is_regenerate_category!==!1):t.filter(o=>!o.is_regenerate_category),[t,e]);return{isLoading:r,categories:s,groups:n??[]}}function Je(){const{categories:e}=Re();return!!e.find(({categoryId:r})=>r===pe.GPT4o)}function er(){const{data:e}=S();return f.useMemo(()=>e?new Set(Object.keys(e.modelsMap)):new Set([I]),[e])}const Ue={[I]:R};function De(){const{data:e}=S();return(e==null?void 0:e.modelsMap)??Ue}function ee(e,r,t){let n=C.GPT_3_5;return t?n=C.GPT_4:r&&(n=C.GPT_4o),(e==null?void 0:e.modelsList.find(s=>s.tags.includes(n)))??(e==null?void 0:e.modelsList[0])??R}function rr(e=!1){const r=ue(),t=ae(),[,n]=ce();return f.useCallback(({location:s,modelId:o})=>{const u=r.pathname.includes("/g/");e||u?(x.logNewChatButtonClicked({location:s}),t({pathname:"/",search:`?model=${encodeURIComponent(o)}`})):(n(a=>(a.set("model",encodeURIComponent(o)),a)),x.logNewChatButtonClicked({location:s}))},[e,r,t,n])}function tr(){const{data:{categories:e=[]}={}}=S(),{doesUserHaveAnyAccountsWithPlusFeatures:r}=K();if(r)return null;const t=e.find(he);return(t==null?void 0:t.defaultModel)??null}function Ae(e){return qe(e)}function nr(e){const r=Ae(e),t=De();return f.useMemo(()=>r==null?R:t[r]??R,[r,t])}function sr(e){return decodeURIComponent(e.model??"")||null}function or(){const{data:e}=S(),{doesUserHaveAnyAccountsWithPlusFeatures:r}=K(),t=Y();return ee(e,!!r,!!(t!=null&&t.isEnterprise()))}const re="q",Ke="m";function ir(e){const{clientThreadId:r,currentLeafId:t,handleRequestCompletion:n}=e,s=f.useRef(!1),{isLoading:o,data:u}=S(),{doesUserHaveAnyAccountsWithPlusFeatures:a,isLoading:y}=K(),l=Y(),d=ye(),q=f.useCallback((g,_,p,G)=>{j.updateTree(r,P=>{P.addNode(g,p,_,fe.User,void 0,G)})},[r]),E=f.useCallback(async(g,{content:_,attachments:p},G,P,Q,L)=>{const A=t,m=p.length>0?{attachments:p}:{};m.system_hints=P.systemHints,q(g,A,_,m),n({type:me.Next,promptId:g,requestedModelId:L,eventMetadata:G,cancelActiveRequests:!0,completionMetadata:P,turnTracker:Q})},[q,n,t]),F=de(()=>window.location.pathname)??null,N=ze();let B=!o&&!y&&F!=null;const[D,w]=f.useState(!0);return f.useEffect(()=>{if(!D||s.current)return;const g=Ee.getConversationMode(r);if(!B||g==null)return;if(!Ie(F)||Oe(F)&&N===void 0||j.getServerThreadId(r)!=null){w(!1);return}const{[re]:_,[Ke]:p,[Pe]:G,...P}=d.query,Q=(typeof _=="string"?_:null)??(typeof p=="string"?p:null);if(!Q){w(!1);return}const L=_e(G),A=ge();s.current=!0;let m=u==null?void 0:u.modelsList;L.has(W.Search)&&(m=m==null?void 0:m.filter(ie=>{var H;return(H=ie.enabledTools)==null?void 0:H.includes(W.Search)}));const T=u&&ee({...u,modelsList:m??[]},!!a,!!(l!=null&&l.isEnterprise()));if(d.replace({query:P},void 0,{shallow:!0}),T==null){O.warning("No model available for this request"),w(!1);return}const oe=new Ge;E(A,{content:Q,attachments:[]},{eventSource:"url"},{conversationMode:g,source:"instant-query",systemHints:G?Array.from(L):void 0},oe,T==null?void 0:T.id),w(!1)},[o,y,B,F,d,u,a,l,E,D,r,N]),D}function Oe(e){return te(e)}function te(e){return e==null?!1:/^\/g\/[\w-]+$/.test(e)}function Ie(e){return e==null?!1:e==="/"||te(e)}const ur="GPT Builder";function ar(e){if(e)return`ChatGPT - ${e}`}function k(e){return e.gizmo.short_url??e.gizmo.id??"-"}function ne(e){return`/g/${e}`}function cr(e){return`https://chatgpt.com${ne(e)}`}function ke(e){return ne(k(e))}function lr(e,r){const t=new URLSearchParams;return r!=null&&t.set(re,r),Me(new URL(`${ke(e)}?${t}`,"https://chatgpt.com"))}function yr(e){return`/g/${k(e)}`}function fr(e){return Se(e)&&e.gizmo.live_version===0||ve(e)&&e.liveVersion===0}function mr(e,r){return c({queryKey:["gizmos","discovery",{locale:e,isAnon:r}],queryFn:async()=>i.getGizmoDiscovery(e,r)})}function dr({cutId:e,locale:r,limit:t,cursor:n,enabled:s=!0}){return X({queryKey:["gizmos","discovery",{cutId:e,locale:r,limit:t}],queryFn:async({pageParam:o})=>i.getGizmoDiscoveryCut(e,{locale:r,cursor:o,limit:t}),initialPageParam:n,getNextPageParam:o=>o.list.cursor??void 0,enabled:s})}function gr(){return c({queryKey:["gizmos","pinned"],queryFn:async()=>i.getGizmoPinned()})}function b(){return U({queryKey:["gizmos","bootstrap"],queryFn:async()=>i.getGizmoBootstrap().then(e=>({gizmos:e.gizmos.map(r=>({resource:r.resource,flair:r.flair}))}))})}function pr(){return c(b())}function V(e,r){const t=e.filter(s=>s.resource.gizmo.id!==r.resource.gizmo.id);let n=t.findIndex(s=>s.flair.kind===v.Recent);return n===-1&&(n=t.length),t.splice(n,0,r),t}const hr={handleGizmoInteracted(e,r){const t=e.getQueryData(h(e,r).queryKey);t!=null&&e.setQueryData(b().queryKey,n=>{if(n==null)return n;const s=n.gizmos.find(o=>o.resource.gizmo.id===r);return(s==null?void 0:s.flair.kind)===v.FirstParty||(s==null?void 0:s.flair.kind)===v.SidebarKeep?n:{gizmos:V(n.gizmos,{resource:t,flair:{kind:v.Recent}})}})},handleGizmoSidebarKeep(e,r){const t=e.getQueryData(h(e,r).queryKey);t!=null&&e.setQueryData(b().queryKey,n=>n==null?n:{gizmos:V(n.gizmos,{resource:t,flair:{kind:v.SidebarKeep}})})},handleGizmoSidebarHide(e,r){e.setQueryData(b().queryKey,t=>t!=null&&t.gizmos.some(n=>n.resource.gizmo.id===r)?{gizmos:t.gizmos.filter(n=>n.resource.gizmo.id!==r)}:t)}};function zr(e,r=!1){const t=z();return c(h(t,e,r))}function _r({gizmoId:e,draft:r,version:t}){const n=z(),s=t?{queryKey:["gizmo","version",{gizmoId:e,version:t}],queryFn:async()=>i.getVersion({gizmoId:e,version:t}),enabled:e!=null}:h(n,e,r);return c(s)}function Gr(e,r){return c({queryKey:["gizmo","userActionSettings",{gizmoId:e}],queryFn:async()=>i.getUserActionSettings(e),enabled:e!=null&&r})}function h(e,r,t=!1){return U({queryKey:["gizmo",{gizmoId:r},{draft:t}],queryFn:async()=>i.getGizmo(r,t),enabled:r!=null,initialData:()=>{var o,u;if(t===!0)return;const n=e.getQueryData(b().queryKey);if(n!=null)return(o=n.gizmos.find(a=>a.resource.gizmo.id===r))==null?void 0:o.resource;const s=e.getQueryData(["gizmos","discovery"]);if(s!=null)for(const a of s.cuts){const y=(u=a.list.items.find(l=>l.resource.gizmo.id===r))==null?void 0:u.resource;if(y!=null)return y}}})}function Pr(e,r){return e.fetchQuery(h(e,r))}function Mr(e){return c({queryKey:["gizmo",{search:e}],queryFn:async()=>i.getGizmoSearch(e),enabled:e.length>0})}function Sr(e,r){return c({queryKey:["gizmo-search-workspace",{search:e}],queryFn:async()=>i.getGizmoSearchForWorkspace(e),enabled:e.length>0&&r})}function vr(e,r=!1,t=!1,n=null){return X({queryKey:[t?"gizmo-search-workspace":"gizmo",{query:e,cursor:n}],queryFn:async({pageParam:s})=>t?i.getGizmoSearchForWorkspace(e,n=s):i.getGizmoSearch(e,n=s),initialPageParam:n,getNextPageParam:s=>s.cursor??void 0,enabled:r})}function Cr(){const e=z();return M({mutationFn:async({gizmoId:r,editorData:t})=>{const{instructions:n,name:s,description:o,profilePictureId:u,profilePictureUrl:a,promptStarters:y,tools:l,files:d,trainingDisabled:q}=t;return i.upsertDraft({instructions:n,display:{name:s,description:o,profile_pic_id:u,profile_picture_url:a,prompt_starters:y},tools:l,files:d.map(E=>({...E,location:Ce.FILE_SERVICE})),training_disabled:q},r)},onSettled:r=>{r&&(e.setQueryData(h(e,r.gizmo.id,!0).queryKey,r),e.invalidateQueries({queryKey:["gizmos","mine"],refetchType:"none"}))}})}function br(){const e=z();return M({mutationFn:async({gizmoId:r,data:t})=>{const{sharingRecipient:n,categories:s}=t,o=await i.promoteDraft({sharing:t.sharingSubjects&&t.sharingSubjects.length>0?t.sharingSubjects:{recipient:n},categories:s},r);if(o.error)throw new be(o);return o.resource},onSettled:r=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"}),e.invalidateQueries({queryKey:["gizmos","pinned"],refetchType:"none"}),r&&e.setQueryData(h(e,r.gizmo.id,!1).queryKey,r)}})}function qr(){const e=z();return M({mutationFn:async({gizmoId:r})=>i.deleteGizmo(r),onSettled:()=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"})}})}function Er(){const e=z();return M({mutationFn:async({name:r,hideName:t,websiteUrl:n,willReceiveSupportEmails:s})=>i.updateBuilderProfile({name:r,hide_name:t,website_url:n,will_receive_support_emails:s}),onSuccess:r=>{e.setQueryData(["builderProfile"],r)},onError:r=>{O.warning(r.message)}})}function Fr(){return c({queryKey:["builderProfile"],queryFn:async()=>i.getBuilderProfile()})}function wr(){return M({mutationFn:async({gizmoId:e})=>i.copyGizmo({gizmoId:e})})}function Qr(){return c({queryKey:["gizmoCategories"],queryFn:async()=>i.getCategories()})}function Lr(e,r){return!!(r!=null&&[$.PrimaryAssistant,$.GizmoInteraction].includes(r)&&(e!=null&&e.includes(C.GPT_4)))}function Tr(e,r){const t=z();return M({mutationFn:async({rating:n,message:s,includeFrom:o})=>{await i.upsertUserReview(e,n,s,o)},onSuccess:async()=>{t.invalidateQueries({queryKey:["gizmo","review",{gizmoId:e}]})},onError:n=>{O.danger(n.message)}})}function Rr(e,r){return r?`/g/${k(r)}/c/${e}`:`/c/${e}`}function Ur(){return"/gpts"}function Dr(){return"/gpts/mine"}function se(e){return e?`/gpts/editor/${e}`:"/gpts/editor"}function Ar(e){const r=Ne();return e==null?r:se(e)}function Ne(e){return se(e)}function Kr(e){try{const r=new URL(e);return r.hostname=r.hostname.replace(/^(www\.|web\.|mbasic\.|mobile\.)(secure\.)?/,""),r.pathname="",[...r.searchParams.keys()].forEach(t=>r.searchParams.delete(t)),r.toString()}catch{return e}}function Be(e){if(!e)return null;try{return new URL(e).hostname}catch{return null}}function Or(e){const r=Be(e);return r?r.replace(/^www\./,""):e}export{tr as $,nr as A,Dr as B,Ur as C,Mr as D,Sr as E,vr as F,Ve as G,mr as H,Fr as I,Er as J,Qr as K,_r as L,S as M,je as N,Cr as O,br as P,h as Q,ne as R,er as S,sr as T,Pr as U,De as V,Lr as W,ur as X,Ye as Y,Ze as Z,Xe as _,Ae as a,We as a0,ir as a1,Re as b,or as c,zr as d,Je as e,Tr as f,Rr as g,qr as h,yr as i,fr as j,se as k,ke as l,Ne as m,Or as n,pr as o,ar as p,hr as q,dr as r,gr as s,cr as t,rr as u,lr as v,Kr as w,Gr as x,Ar as y,wr as z};
//# sourceMappingURL=fjbhk1eyfrkqwuir.js.map
