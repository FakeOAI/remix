import{r as u,ax as W,fq as se,d8 as H,G as j,S as _,P as w,d as S,m as e,c8 as ne,aW as v,s as oe,aQ as b,H as ae,fm as ie,a9 as re,n as le,ab as ce,F as de,L as Q,y as ue,o as pe}from"./m3881aktdta1pmc9.js";import{b1 as ge,b2 as z,b3 as B,b4 as me,ay as Y,b5 as fe,b6 as xe,b7 as he,b8 as be,b9 as ye,ba as _e,bb as we,bc as Se,n as ve,bd as Me,be as je,bf as ke,bg as Ee,bh as Ne,bi as Ce}from"./okmdvzkaebtartz7.js";import{aE as Te}from"./n08taxuyverhgw48.js";import{C as Pe}from"./ola2pyogn0c3h6ke.js";import{H as De}from"./g4tl5lt9yqf20m4s.js";import"./ch5rz3st0lodioc5.js";import{m as M}from"./wj4cxuxyhew23int.js";import"./h6hr4jrby5jgst8b.js";import"./gja0prmkvjag1b5s.js";import"./n0l48mzge8u4uw1w.js";import"./femzoisuflsl9inf.js";import"./o62t6mksr4mg10in.js";import"./fh6iogt5vw62g3gf.js";import"./n4b34i38nf6odoui.js";function Ie(t,n){const{data:o,isLoading:l,isSuccess:c,isError:i}=oe({queryKey:["onboardingSteps",t,n],queryFn:()=>Q.createOnboardingSteps(void 0,t,n)});return{steps:o?.steps??[],isLoading:l,isSuccess:c,isError:i}}function k({children:t,className:n}){return e.jsx(M.div,{className:n,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.25},exit:{opacity:0,y:-10},children:t})}function Le({isFirstStep:t,userName:n}){return e.jsx(k,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(b,{...t?a.preparingOnboardingExperience:a.allSetLetMeShowYouAroundWithoutName,values:{name:n,nextLine:o=>e.jsx("span",{className:"block",children:o})}})})})}function Fe({setIsInWelcomePage:t}){const n=z();return u.useEffect(()=>{n&&setTimeout(()=>{t(!1)},2500)},[n,t]),n?e.jsx(k,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(b,{...a.imChaggptNiceToMeetYou})})}):null}function Ue(t){const n=fe(),o=j(),l=ae(),c=xe(t);let i=he(t);const d=be(c,i),s=ye(c,i);return u.useCallback(async r=>{const m="text/plain",f=new Blob([r],{type:m}),h=new File([f],"My_File.txt",{type:m});return _e.uploadFile(n,we(h),h,Se.Retrieval,s,o,l,void 0,d?.attachments)},[n,o,l,s,d?.attachments])}function tt({clientThreadId:t,setClientThreadId:n}){const[o,l]=u.useState(!0),{isOpen:c,setIsOpen:i,markAsViewed:d}=ge(),[s,r]=u.useState(0),[m,f]=u.useState(new Set(["usage_question"])),[h,$]=u.useState([]),[T,K]=u.useState(),[P,D]=u.useState(!1),{steps:p,isLoading:E,isError:N}=Ie(P?h:[],P?T:void 0),G=z(),I=Re({clientThreadId:t,setClientThreadId:n}),L=Ue(t),{createNewThread:F}=B({clientThreadId:t,setClientThreadId:n}),V=W(t),U=se(t,V),{layer:J}=H("717266490"),X=J.get("keep_onboarding_after_dismiss",!1),q=j();u.useEffect(()=>{c&&(_.logEvent("chatgpt_onboarding_flow_shown"),w.logEvent(S.onboardingShown))},[c]),u.useEffect(()=>{N&&(d(),_.logEvent("chatgpt_onboarding_flow_error"),w.logEvent(S.onboardingError))},[N,d]),u.useEffect(()=>{if(!(E||!p[s])&&!m.has(p[s].step_type)){f(y=>new Set([...y,p[s].step_type]));const g=p[s].step_prompt;g&&(I({stepPrompt:g}),p[s].step_type==="file_upload"&&p[s].additional_info&&L(p[s].additional_info))}},[s,E,m,I,p,L]);const x=p[s];if(u.useEffect(()=>{const g=x?.step_type;(g==="usage_question"||g==="self_description")&&U&&(F(),f(y=>new Set(Array.from(y).filter(A=>A==="usage_question"||A==="self_description"))))},[x?.step_type,F,U]),N)return null;const C=g=>{i(!1),s===p.length-1?(_.logEvent("chatgpt_onboarding_flow_finished"),w.logEvent(S.onboardingFinished)):(_.logEvent("chatgpt_onboarding_flow_dismissed",null,{step_type:x?.step_type,step_index:s.toString()}),w.logEvent(S.onboardingDismissed,{step_type:x?.step_type,step_index:s.toString()})),g&&!X&&d()},Z=g=>{$(g),p.find(y=>y.step_type==="self_description")||D(!0),r(y=>y+1),_.logEvent("chatgpt_onboarding_usage_question_selected",null,{main_usages:g.join(", ")}),w.logEvent(S.onboardingUsageQuestionSelected,{main_usages:g.join(", ")})},ee=g=>{K(g),D(!0),r(y=>y+1),_.logEvent("chatgpt_onboarding_self_description_entered",null,{main_usages:h.join(", ")}),w.logEvent(S.onboardingSelfDescriptionEntered,{main_usages:h.join(", ")})},te=()=>{_.logEvent("chatgpt_onboarding_usage_question_skipped",null,{step_type:x?.step_type,step_index:s.toString()}),w.logEvent(S.onboardingUsageQuestionSkipped,{step_type:x?.step_type,step_index:s.toString()}),r(g=>g+1)};return e.jsx(ne,{isOpen:c,onClose:()=>C(!1),type:"success",size:"fullscreen",noPadding:!0,className:"w-full",children:e.jsx(me,{clientThreadId:t,children:e.jsxs("div",{className:"flex h-full max-h-full flex-col bg-gradient-to-b from-brand-blue-800/15 to-gray-50 dark:from-brand-blue-800/15 dark:to-token-main-surface-primary",children:[e.jsxs("div",{className:"absolute left-0 top-0 z-10 flex w-full items-center justify-between bg-none px-4",style:{minHeight:"var(--screen-thread-header-min-height,60px)"},children:[p&&p.length>0&&e.jsx("div",{className:"absolute left-0 top-0 h-2 w-full",children:e.jsx(M.div,{className:"h-1.5 bg-token-main-surface-primary-inverse",initial:{width:"0%",opacity:0},animate:{width:`${(s+1)/p.length*100}%`,opacity:1},transition:{duration:.3}})}),s>0?e.jsx(v,{onClick:()=>r(s-1),color:"ghost",className:"border-none",icon:Te}):e.jsx("div",{}),x?.step_type==="usage_question"||x?.step_type==="self_description"?e.jsx(v,{onClick:te,color:"ghost",className:"border-none",children:q.formatMessage(a.skip)}):e.jsx(v,{onClick:()=>C(!0),color:"ghost",className:"border-none",children:q.formatMessage(a.close)})]}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center overflow-hidden",children:e.jsx(Y,{mode:"wait",children:o?e.jsx(Fe,{setIsInWelcomePage:l},"welcome"):E?e.jsx(Le,{isFirstStep:s<1,userName:G?.name},"loading"):x?.step_type==="usage_question"?e.jsx(qe,{mainUsagesProp:h,onSelectMainUsages:Z},"usage-question"):x?.step_type==="self_description"?e.jsx(Ae,{mainUsages:h,selfDescriptionProp:T,onEnterSelfDescription:ee},"self-description"):["dalle","file_upload","canvas","voice"].includes(x?.step_type)?e.jsx(Oe,{step:x,gotoStep:r,stepIndex:s,totalSteps:p.length,endOnboarding:C,clientThreadId:t},"tools-onboarding"):null})})]})})})}function qe({mainUsagesProp:t,onSelectMainUsages:n}){const[o,l]=u.useState(new Set(t)),c=j();return e.jsxs(k,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(b,{...a.tellMeWhyHere})}),e.jsx("p",{className:"mb-6 text-base text-token-text-secondary",children:e.jsx(b,{...a.suggestUsefulIdeas})})]}),e.jsx("div",{className:"flex flex-col items-start justify-start gap-5",children:["school","work","personalTasks","funAndEntertainment"].map(i=>e.jsx(ve,{id:`main-usage-${i}`,checked:o.has(i),onChange:d=>l(s=>{const r=new Set(s);return d.target.checked?r.add(i):r.delete(i),r}),label:e.jsx("span",{className:"cursor-pointer",children:c.formatMessage(a[i])})},i))}),e.jsx(v,{size:"medium",color:"primary",onClick:()=>n(Array.from(o)),className:"mt-10",disabled:o.size===0,children:e.jsx(b,{...a.next})})]})}function Ae({mainUsages:t,selfDescriptionProp:n,onEnterSelfDescription:o}){const[l,c]=u.useState(n),i=j(),d=u.useMemo(()=>t.includes("school")?a.exampleSchoolSelfDescription:t.includes("work")?a.exampleWorkSelfDescription:t.includes("funAndEntertainment")?a.exampleFunAndEntertainmentSelfDescription:a.examplePersonalTasksSelfDescription,[t]),{layer:s}=H("717266490"),r=s.get("write_custom_instructions_in_onboarding",!1),m=async()=>{o(l),r&&l&&Q.createOrUpdateUserSystemMessage({aboutUserMessage:l,aboutModelMessage:"",disabledTools:[],enabled:!0}).catch(()=>{})};return e.jsxs(k,{className:"flex w-[640px] flex-col items-start",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"mb-4 text-3xl font-medium leading-9 text-token-text-primary",children:[e.jsx(b,{...a.oneLastQuestion}),e.jsx("br",{}),e.jsx(b,{...a.anythingElseYouWantMeToKnow})]}),e.jsx("p",{className:"text-base text-token-text-secondary",children:e.jsx(b,{...r?a.selfDescriptionReasonSaveToCustomInstructions:a.selfDescriptionReason,values:{customInstructions:f=>e.jsx("a",{href:De,className:"underline",target:"_blank",rel:"noreferrer",children:f})}})})]}),e.jsx(Me,{className:"mt-10 rounded border border-token-border-light bg-token-main-surface-primary p-5 !text-base",placeholder:i.formatMessage(d),rows:4,value:l,onChange:f=>c(f.target.value),autoFocus:!0}),e.jsx(v,{size:"medium",color:"primary",onClick:m,className:"mt-10",children:e.jsx(b,{...a.submit})})]})}function Oe({step:t,gotoStep:n,stepIndex:o,totalSteps:l,endOnboarding:c,clientThreadId:i}){const d=ie({clientThreadId:i}),s=je(),r=j(),m=o===l-1,f=()=>{o<l-1?(_.logEvent("chatgpt_onboarding_flow_next_clicked",null,{source_step_type:t?.step_type,source_step_index:o.toString()}),w.logEvent(S.onboardingNextClicked,{source_step_type:t?.step_type,source_step_index:o.toString()}),n(o+1)):(c(!0),s())};return e.jsxs(k,{className:"flex h-full w-full flex-row px-8 md:px-12 lg:px-16 xl:px-24",children:[e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center",children:e.jsxs(M.div,{className:"flex w-[90%] flex-1 flex-col items-start justify-center gap-2 md:w-[85%] lg:w-[80%]",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs(Y,{mode:"wait",children:[e.jsx(M.h1,{className:"mb-2 text-3xl font-medium text-token-text-primary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.title?t.title:O[t.step_type]?r.formatMessage(O[t.step_type]):null},`title-${o}`),e.jsx(M.p,{className:"mb-6 text-base text-token-text-secondary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.subtitle?t.subtitle:R[t.step_type]?r.formatMessage(R[t.step_type]):null},`subtitle-${o}`)]}),e.jsx(v,{size:"large",color:"primary",onClick:f,disabled:d&&!m,children:e.jsx(b,{...m?a.finish:a.next})})]})}),e.jsx("div",{className:"relative flex h-full min-w-[360px] flex-1 flex-col pb-16 pt-16",children:e.jsx("div",{className:"h-full w-full overflow-auto rounded-[30px] bg-token-main-surface-primary shadow-2xl shadow-token-border-xlight",children:e.jsx(Pe,{hideHeader:!0,hideTools:!0,embedded:!0})})})]})}const Re=({clientThreadId:t,setClientThreadId:n})=>{const o=ke(t),l=Ee(),{onThreadCreated:c}=B({clientThreadId:t,setClientThreadId:n}),{onRequestCompletion:i}=Ne({clientThreadId:t,currentModelId:o,defaultModelId:l.id,onThreadCreated:c}),d=W(t);return u.useCallback(({stepPrompt:s})=>{const r=new Ce,m=`${d}-nextPrompt`,f=()=>{ue.updateTree(t,h=>{h.addNode(m,s,d,pe.User,void 0,void 0)})};i({type:re.Next,promptId:m,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!0,completionMetadata:{conversationMode:le(ce.getConversationMode(t)),isOnboardingConversation:!0},updateTree:f,turnTracker:r})},[t,i,d])},a=de({skip:{defaultMessage:"Skip",id:"chatgpt.new-onboarding.skip"},close:{defaultMessage:"Close",id:"chatgpt.new-onboarding.close"},submit:{defaultMessage:"Submit",id:"chatgpt.new-onboarding.submit"},next:{defaultMessage:"Next",id:"chatgpt.new-onboarding.next"},finish:{defaultMessage:"Finish",id:"chatgpt.new-onboarding.finish"},tellMeWhyHere:{defaultMessage:"Tell me about why you’re here.",id:"chatgpt.new-onboarding.tell-me-why-here"},suggestUsefulIdeas:{defaultMessage:"I’ll use this information to suggest ideas you might find useful.",id:"chatgpt.new-onboarding.suggest-useful-ideas"},school:{defaultMessage:"School",id:"chatgpt.new-onboarding.school"},work:{defaultMessage:"Work",id:"chatgpt.new-onboarding.work"},personalTasks:{defaultMessage:"Personal tasks",id:"chatgpt.new-onboarding.personal-tasks"},funAndEntertainment:{defaultMessage:"Fun and entertainment",id:"chatgpt.new-onboarding.fun-and-entertainment"},imChaggptNiceToMeetYou:{defaultMessage:"Hi, I’m ChatGPT. It’s nice to meet you!",id:"chatgpt.new-onboarding.im-chatgpt-nice-to-meet-you"},preparingOnboardingExperience:{defaultMessage:"Preparing your onboarding experience...",id:"chatgpt.new-onboarding.preparing-onboarding-experience"},oneLastQuestion:{defaultMessage:"One last question:",id:"chatgpt.new-onboarding.one-last-question-2"},anythingElseYouWantMeToKnow:{defaultMessage:"Is there anything else you’d like me to know?",id:"chatgpt.new-onboarding.anything-else-you-want-me-to-know-2"},selfDescriptionReason:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant.",id:"chatgpt.new-onboarding.self-description-reason"},allSetLetMeShowYouAroundWithoutName:{defaultMessage:"All set!<nextLine></nextLine>Now, let me show you around...",id:"chatgpt.new-onboarding.all-set-let-me-show-you-around-without-name"},selfDescriptionReasonSaveToCustomInstructions:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant. I’ll save this information as <customInstructions>Custom Instructions</customInstructions>, which you can update any time.",id:"chatgpt.new-onboarding.self-description-reason-save-to-custom-instructions"},exampleSchoolSelfDescription:{defaultMessage:"I'm a college student studying computer science, and I love to play the guitar.",id:"chatgpt.new-onboarding.example-school-self-description"},exampleWorkSelfDescription:{defaultMessage:"I'm a graphic designer based in Berlin, and I enjoy painting and attending art exhibitions.",id:"chatgpt.new-onboarding.example-work-self-description"},examplePersonalTasksSelfDescription:{defaultMessage:"I live in Sydney and love cooking new recipes and planning travel itineraries.",id:"chatgpt.new-onboarding.example-personal-tasks-self-description"},exampleFunAndEntertainmentSelfDescription:{defaultMessage:"I'm a music enthusiast based in Nashville, and I can talk for hours about guitar techniques and songwriting.",id:"chatgpt.new-onboarding.example-fun-and-entertainment-self-description"}}),O={usage_question:a.tellMeWhyHere},R={usage_question:a.suggestUsefulIdeas};export{Le as LoadingState,tt as default};
//# sourceMappingURL=irg2fdge7rtlqixb.js.map
