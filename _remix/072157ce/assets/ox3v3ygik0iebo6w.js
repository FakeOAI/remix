import{L as T,m as e,dV as X,ev as J,r as d,a3 as L,aL as w,K as ee,aU as I,e$ as se,aD as z,bv as P,d2 as te,b1 as _,fx as k,b_ as ae,b$ as ne,gl as ie,dL as A}from"./ejnnsd2ul10wwon8.js";import{b$ as B,iP as oe,e8 as re,U,er as le,o as D,bD as ce,iQ as de,e_ as me,c$ as G,bV as ue,aG as ge,cb as xe,iR as C,iS as fe,aD as pe,d0 as he,ap as Se,iT as be,ix as je,iy as ve,iU as Ce,iV as v,iW as ye,iX as S,d1 as ze,iY as ke,iZ as Ie,i_ as Ne,dP as Me,i$ as R,aq as W,j0 as Ge,j1 as Te,j2 as Le,j3 as y,j4 as Fe,dQ as Oe,j5 as we,j6 as Ee,j7 as Pe,eX as _e,j8 as Ae,j9 as Be}from"./71wmxosf3hlynfn3.js";import{ba as Ue,au as De,by as Re,z as We,az as He,L as Ke,M as H,aM as $e,av as Qe}from"./iq818lbd3vi25zxi.js";import{m as K}from"./bhodeadh6qtod2rx.js";import{a as Ve}from"./k55tvdvc94a3v24b.js";import{U as Ye,P as Ze}from"./hfoq59uzfbv0qt7v.js";function $(){const s=T(),o=B(),n=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(oe,{children:e.jsx(K.div,{whileTap:{scale:.98},children:e.jsx(X,{to:re(),onClick:()=>{o.activeSidebar==="popover-nav"&&U.setActiveSidebar(!1)},children:e.jsx(le,{icon:Ue,"data-testid":"explore-gpts-button",children:n})},"explore")})})}function qe({gizmo:s,historyDisabled:o,section:n,onClick:r,isActive:l,hideOverflowMenu:u=!1,elementRef:c}){const{clientThreadId:g}=D(),x=J(g),f=T(),[t,b]=d.useState(!1),[a,i]=d.useState(!1),[m,p]=d.useState(null),h=L(),Y=!!s?.gizmo.tags?.includes(ce.FirstParty),F=!1;let Z=!1;const[q,O]=d.useState(0),{data:N}=de(s?.gizmo.id);d.useEffect(()=>{O(N?N.items.length:0)},[N]),d.useEffect(()=>{m==null&&l&&x&&p(!0)},[l,x,m]);let j;if(s!=null)j=s.gizmo.display.name||me;else{if(h==null)return null;o?j=f.formatMessage(G.clearChat):h.canInteractWithGizmos()?j=he:j=f.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(K.div,{whileTap:{scale:.98},onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)},children:e.jsx(ue,{loggingGizmoId:s?.gizmo.id??"primary",href:ge(s),onClick:r,showActiveIndicator:Z,icon:e.jsx(xe,{gizmoId:s?.gizmo.id,isFirstParty:Y,gizmoEmoji:s?.gizmo.display.emoji,gizmoTheme:s?.gizmo.display.theme,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6"}),isMenuOpen:t,label:j,hoverLeftIcon:a&&F&&q&&e.jsx("button",{onClick:M=>{M.preventDefault(),p(!m)},className:"flex text-token-text-secondary hover:text-token-text-primary",children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:m?e.jsx(De,{className:"icon-md"}):e.jsx(Re,{className:"icon-md"})})})}),rightIcon:n===C.Workspace&&e.jsx(w,{side:"right",label:f.formatMessage(E.workspaceRecommended,{workspace_name:h?.name??"Your Workspace"}),children:e.jsx(We,{className:"icon-md text-token-text-secondary",alt:f.formatMessage(E.workspaceRecommended,{workspace_name:h?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(a||t)&&!F&&!u&&e.jsx("div",{className:"text-token-text-tertiary",onClick:M=>{M.preventDefault()},children:e.jsx(fe,{gizmo:s,isOpen:t,setIsOpen:b,section:n})}),!u&&e.jsx(w,{side:"right",label:f.formatMessage(o?G.clearChat:G.newChat),className:"flex items-center",children:e.jsx("button",{className:t?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:o?e.jsx(He,{className:"icon-md"}):e.jsx(Ke,{className:"icon-md"})})})]}),elementRef:c})}),e.jsx(pe,{children:!1})]})}const E=ee({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}}),Xe=2;function Q({gizmos:s,isGizmoFlyout:o,isLoaded:n,maxToShowOnLoad:r=4,isScreenArch:l,showAllSidebarItems:u}){const c=Ce(s,i=>i.flair.kind),g=[...(c[v.Workspace]?.map(({resource:i})=>({gizmo:i,section:C.Workspace}))??[]).slice(0,3),...c[v.FirstParty]?.map(({resource:i})=>({gizmo:i,section:C.Keep}))??[],...c[v.SidebarKeep]?.map(({resource:i})=>({gizmo:i,section:C.Keep}))??[]],x=c[v.Recent]?.slice(0,l||n?c[v.Recent]?.length:Xe).map(({resource:i})=>({gizmo:i,section:C.Recents}))??[],f=x.length,t=g.length,b=l?f>0:s.length>r;let a=[];return o&&l?a=[...g,...x]:!o&&l?a=g:(a=[...g,...x],u||(a.length>r&&t>r?a=a.slice(0,t):a.length>r&&(a=a.slice(0,r)))),{listItems:a,itemsLeft:s.length-a.length,needsToCollapseItems:b,total:s.length}}function V({gizmo:s,currentGizmoId:o,maxToShowOnLoad:n,hideOverflowMenu:r=!1}){const l=d.useRef(!1),u=!n,c=Se(),[g,x]=d.useState(!1),f=B(m=>!be.isGptListCollapsed(m)),{listItems:t,needsToCollapseItems:b,itemsLeft:a}=Q({gizmos:s,isGizmoFlyout:u,isLoaded:g,maxToShowOnLoad:n,isScreenArch:c,showAllSidebarItems:f});d.useEffect(()=>{g||x(!0)},[g]),d.useEffect(()=>{t.length>0&&!l.current&&(je({namespace:ve.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),l.current=!0)},[t]);function i(m,p){const h=e.jsx(qe,{gizmo:m,isActive:m.gizmo.id===o,section:p,hideOverflowMenu:r},m.gizmo.id);return c?e.jsx("li",{children:h}):h}return e.jsxs("div",{children:[t.map(({gizmo:m,section:p},h)=>e.jsxs(d.Fragment,{children:[h>1&&p!==t[h-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),i(m,p)]},h)),!c&&b?e.jsxs("button",{onClick:U.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(H,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:f?e.jsxs(e.Fragment,{children:[e.jsx(I,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx($e,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:a}}),e.jsx(Qe,{className:"icon-xs"})]})})]}):null,!c&&e.jsx($,{})]})}function Je({currentGizmoId:s,gizmos:o,onClick:n}){const{isSidebarFlyoutOpen:r,onSidebarFlyoutOpenChange:l}=ye(),u=r(S.Gizmo);return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(se,{onOpenChange:c=>l(S.Gizmo,c),side:"right",sideOffset:4,open:u,contentAlign:"end",triggerButton:e.jsxs("button",{className:z("flex flex-1 select-none items-center gap-2.5 rounded-lg px-2 py-[7px] text-body tracking-condensed text-token-text-secondary ease-[var(--spring-bounce)] hover:bg-token-main-surface-secondary focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",u&&"bg-token-main-surface-secondary"),onClick:n,children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx(H,{className:z("icon-md font-semibold text-token-sidebar-icon")})})}),e.jsx("span",{className:"text-left",children:e.jsx(I,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(P,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(V,{gizmo:o,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function es({currentGizmoId:s}){const{data:{gizmos:o}={}}=ze();let n=o;const r=!n||n?.length===0,{needsToCollapseItems:l}=Q({gizmos:n??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return r?null:e.jsx(e.Fragment,{children:e.jsxs(ke,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(I,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx($,{}),e.jsx(V,{gizmo:n??[],currentGizmoId:s,maxToShowOnLoad:Ie}),l&&e.jsx(P,{children:e.jsx(Je,{currentGizmoId:s,gizmos:n??[]})})]})})}function ss({clientThreadId:s}){const o=L(),n=te(s),{isUnauthenticated:r}=_();return r?null:e.jsxs("div",{className:z(k.screenContent),children:[null,null,e.jsx(Ne,{clientThreadId:s}),o?.canInteractWithGizmos()?e.jsx(es,{currentGizmoId:n}):null,!1]})}function ts(){const s=L(),o=s?.data==null,{isUnauthenticated:n}=_(),{openSettings:r}=Me(),[l]=d.useState(()=>{const t=ae.getCookie(ne.Workspace);return typeof t=="string"&&t!==ie}),u=T(),{store:c,actions:g}=R(),x=c(t=>t.mode);if(!s||l&&o)return null;const f=n?e.jsx(Ye,{}):e.jsx(Ve,{onClickSettings:()=>r()});return e.jsxs(W,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[f,e.jsx("div",{className:k.togglePinWrapper,children:e.jsx(Ge,{tooltipSideOffset:14,className:k.pinSidebarAction,icon:e.jsx(Te,{}),onActivate:t=>{t.preventDefault(),t.persist(),Le.togglePinSidebar(t,g,x===y.Floating?y.Pinned:y.Floating)},label:x===y.Floating?u.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):u.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:A.FloatingOrPinned})})]})}function as(){return e.jsx(W,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(Ze,{})})}function ns(){return e.jsxs(Fe,{className:z(k.screenTrailingBarContainer),children:[e.jsx(Oe,{}),e.jsx(as,{}),e.jsx(ts,{})]})}function ms(){const{clientThreadId:s,onNewThread:o}=D(),[n,r]=d.useState(!1),[l,u]=d.useState(!1),[c,g]=d.useState(!1),{store:x}=R(),f=d.useCallback(a=>a===S.Conversation?n:a===S.Gizmo?l:a===S.Conversation2?c:!1,[n,l,c]),t=d.useCallback((a,i)=>{const m=p=>{a===S.Conversation?r(p):a===S.Gizmo?u(p):a===S.Conversation2&&g(p)};if(i){m(i);return}setTimeout(()=>{m(i)},100)},[]),b=d.useRef(null);return we((a,i)=>{t(S.Conversation,!1),t(S.Gizmo,!1),t(S.Conversation2,!1);const m=window.matchMedia("(max-width: 700px)").matches,p=Be(b.current);i!=null&&m&&x.getState().isSidebarOpen&&(x.getState().mode===y.Floating||p)&&setTimeout(()=>{document.getElementById(A.OpenOrClosed)?.click()},100)}),e.jsxs(Ee,{value:{isSidebarFlyoutOpen:f,onSidebarFlyoutOpenChange:t},children:[e.jsx(Pe,{}),e.jsx(_e,{anchor:"vertical",className:z(k.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Ae,{onNewThread:o}),ref:b,trackLeading:!0,trailing:e.jsx(ns,{}),children:e.jsx(ss,{clientThreadId:s})})]})}export{ms as C,V as G};
//# sourceMappingURL=ox3v3ygik0iebo6w.js.map
