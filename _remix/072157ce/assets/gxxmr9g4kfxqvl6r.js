import{r as c,az as B,ft as ie,d8 as U,L as E,U as b,P as y,d as _,m as e,cb as re,a_ as M,t as le,aU as S,N as ce,fr as de,ae as ue,n as pe,ag as ge,K as me,V as Q,dO as fe,q as W,f3 as he,o as xe}from"./ejnnsd2ul10wwon8.js";import{b9 as be,ba as G,bb as Y,bc as ye,aD as $,bd as K,be as _e,bf as we,bg as Se,bh as ve,bi as V,bj as Me,bk as ke,v as je,aE as Ee,bl as Ce,bm as Ne,bn as Te,bo as Pe,bp as Ue,b5 as Ie}from"./71wmxosf3hlynfn3.js";import{aG as De}from"./iq818lbd3vi25zxi.js";import{C as Le}from"./hpr9emzdoqezsi05.js";import{H as Fe}from"./g4tl5lt9yqf20m4s.js";import"./h0kpabp1jtuoi17n.js";import{m as j}from"./bhodeadh6qtod2rx.js";import"./nrpmzwpmkgs4zly1.js";import"./o4stuqgjq01q0m8v.js";import"./k55tvdvc94a3v24b.js";import"./jl6nxl2zxu4djhch.js";import"./moogu9j7gmp2sz13.js";import"./ez66yy6ef0rdgwfu.js";function qe(t,o){const{data:a,isLoading:r,isSuccess:p,isError:g}=le({queryKey:["onboardingSteps",t,o],queryFn:()=>Q.createOnboardingSteps(void 0,t,o)});return{steps:a?.steps??[],isLoading:r,isSuccess:p,isError:g}}function C({children:t,className:o}){return e.jsx(j.div,{className:o,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.25},exit:{opacity:0,y:-10},children:t})}function Ae({isFirstStep:t,userName:o}){return e.jsx(C,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...t?i.preparingOnboardingExperience:i.allSetLetMeShowYouAroundWithoutName,values:{name:o,nextLine:a=>e.jsx("span",{className:"block",children:a})}})})})}function Oe({setIsInWelcomePage:t}){const o=G();return c.useEffect(()=>{o&&setTimeout(()=>{t(!1)},2500)},[o,t]),o?e.jsx(C,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...i.imChaggptNiceToMeetYou})})}):null}function Re(t){const o=K(),a=E(),r=ce(),p=_e(t);let g=we(t);const m=Se(p,g),s=ve(p,g);return c.useCallback(async f=>{const h="text/plain",n=new Blob([f],{type:h}),d=new File([n],"My_File.txt",{type:h});return V.uploadFile(o,Me(d),d,ke.Retrieval,s,a,r,void 0,m?.attachments)},[o,a,r,s,m?.attachments])}function ot({clientThreadId:t,setClientThreadId:o}){const[a,r]=c.useState(!0),{isOpen:p,setIsOpen:g,markAsViewed:m}=be(),[s,f]=c.useState(0),[h,n]=c.useState(new Set(["usage_question"])),[d,k]=c.useState([]),[v,J]=c.useState(),[I,D]=c.useState(!1),{steps:x,isLoading:N,isError:T}=qe(I?d:[],I?v:void 0),X=G(),L=Be({clientThreadId:t,setClientThreadId:o}),F=Re(t),{createNewThread:q}=Y({clientThreadId:t,setClientThreadId:o}),Z=B(t),A=ie(t,Z),{layer:ee}=U("717266490"),te=ee.get("keep_onboarding_after_dismiss",!1),O=E();c.useEffect(()=>{p&&(b.logEvent("chatgpt_onboarding_flow_shown"),y.logEvent(_.onboardingShown))},[p]),c.useEffect(()=>{T&&(m(),b.logEvent("chatgpt_onboarding_flow_error"),y.logEvent(_.onboardingError))},[T,m]),c.useEffect(()=>{if(!(N||!x[s])&&!h.has(x[s].step_type)){n(w=>new Set([...w,x[s].step_type]));const u=x[s].step_prompt;u&&(L({stepPrompt:u}),x[s].step_type==="file_upload"&&x[s].additional_info&&F(x[s].additional_info))}},[s,N,h,L,x,F]);const l=x[s];if(c.useEffect(()=>{const u=l?.step_type;(u==="usage_question"||u==="self_description")&&A&&(q(),n(w=>new Set(Array.from(w).filter(R=>R==="usage_question"||R==="self_description"))))},[l?.step_type,q,A]),c.useEffect(()=>{l?.step_type&&(b.logEvent("chatgpt_onboarding_step_shown",null,{step_type:l?.step_type,step_index:s.toString()}),y.logEvent(_.onboardingStepShown,{step_type:l?.step_type,step_index:s.toString()}))},[s,l?.step_type]),T)return null;const P=u=>{g(!1),s===x.length-1?(b.logEvent("chatgpt_onboarding_flow_finished"),y.logEvent(_.onboardingFinished)):(b.logEvent("chatgpt_onboarding_flow_dismissed",null,{step_type:l?.step_type,step_index:s.toString()}),y.logEvent(_.onboardingDismissed,{step_type:l?.step_type,step_index:s.toString()})),u&&!te&&m()},se=u=>{k(u),x.find(w=>w.step_type==="self_description")||D(!0),f(w=>w+1),b.logEvent("chatgpt_onboarding_usage_question_selected",null,{main_usages:u.join(", ")}),y.logEvent(_.onboardingUsageQuestionSelected,{main_usages:u.join(", ")})},ne=u=>{J(u),D(!0),f(w=>w+1),b.logEvent("chatgpt_onboarding_self_description_entered",null,{main_usages:d.join(", ")}),y.logEvent(_.onboardingSelfDescriptionEntered,{main_usages:d.join(", ")})},oe=()=>{b.logEvent("chatgpt_onboarding_usage_question_skipped",null,{step_type:l?.step_type,step_index:s.toString()}),y.logEvent(_.onboardingUsageQuestionSkipped,{step_type:l?.step_type,step_index:s.toString()}),f(u=>u+1)},ae=()=>{b.logEvent("chatgpt_onboarding_go_back",null,{step_type:l?.step_type,step_index:s.toString()}),y.logEvent(_.onboardingGoBack,{step_type:l?.step_type,step_index:s.toString()}),f(u=>u-1)};return e.jsx(re,{isOpen:p,onClose:()=>P(!1),type:"success",size:"fullscreen",noPadding:!0,className:"w-full",children:e.jsx(ye,{clientThreadId:t,children:e.jsxs("div",{className:"flex h-full max-h-full flex-col bg-gradient-to-b from-brand-blue-800/15 to-gray-50 dark:from-brand-blue-800/15 dark:to-token-main-surface-primary",children:[e.jsxs("div",{className:"absolute left-0 top-0 z-10 flex w-full items-center justify-between bg-none px-4",style:{minHeight:"var(--screen-thread-header-min-height,60px)"},children:[x&&x.length>0&&e.jsx("div",{className:"absolute left-0 top-0 h-2 w-full",children:e.jsx(j.div,{className:"h-1.5 bg-token-main-surface-primary-inverse",initial:{width:"0%",opacity:0},animate:{width:`${(s+1)/x.length*100}%`,opacity:1},transition:{duration:.3}})}),s>0?e.jsx(M,{onClick:ae,color:"ghost",className:"border-none",icon:De}):e.jsx("div",{}),l?.step_type==="usage_question"||l?.step_type==="self_description"?e.jsx(M,{onClick:oe,color:"ghost",className:"border-none",children:O.formatMessage(i.skip)}):e.jsx(M,{onClick:()=>P(!0),color:"ghost",className:"border-none",children:O.formatMessage(i.close)})]}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center overflow-hidden",children:e.jsx($,{mode:"wait",children:a?e.jsx(Oe,{setIsInWelcomePage:r},"welcome"):N?e.jsx(Ae,{isFirstStep:s<1,userName:X?.name},"loading"):l?.step_type==="usage_question"?e.jsx(We,{mainUsagesProp:d,onSelectMainUsages:se},"usage-question"):l?.step_type==="self_description"?e.jsx(He,{mainUsages:d,selfDescriptionProp:v,onEnterSelfDescription:ne},"self-description"):["dalle","file_upload","canvas","voice"].includes(l?.step_type)?e.jsx(ze,{step:l,gotoStep:f,stepIndex:s,totalSteps:x.length,endOnboarding:P,clientThreadId:t},"tools-onboarding"):null})})]})})})}function We({mainUsagesProp:t,onSelectMainUsages:o}){const{layer:a}=U("717266490"),[r,p]=c.useState(new Set(t)),[g,m]=c.useState(void 0),s=E(),f=()=>{const n=new Set(r);n.has("other")&&g&&(n.add(g),n.delete("other")),o(Array.from(n))},h=["school","work","personalTasks","funAndEntertainment"];return a.get("onboarding_show_other_option",!1)&&h.push("other"),e.jsxs(C,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...i.tellMeWhyHere})}),e.jsx("p",{className:"mb-6 text-base text-token-text-secondary",children:e.jsx(S,{...i.suggestUsefulIdeas})})]}),e.jsxs("div",{className:"flex flex-col items-start justify-start gap-5",children:[h.map(n=>e.jsx(je,{id:`main-usage-${n}`,checked:r.has(n),onChange:d=>p(k=>{const v=new Set(k);return d.target.checked?v.add(n):v.delete(n),v}),label:e.jsx("span",{className:"cursor-pointer",children:s.formatMessage(i[n])})},n)),r.has("other")&&e.jsx(Ee,{name:"other",placeholder:s.formatMessage(i.tellMeWhyHere),onChange:n=>m(n.target.value),maxLength:100,className:"ml-6 min-w-64 bg-token-main-surface-primary"})]}),e.jsx(M,{size:"medium",color:"primary",onClick:f,className:"mt-10",disabled:r.size===0,children:e.jsx(S,{...i.next})})]})}function He({mainUsages:t,selfDescriptionProp:o,onEnterSelfDescription:a}){const[r,p]=c.useState(o),g=E(),m=c.useMemo(()=>t.includes("school")?i.exampleSchoolSelfDescription:t.includes("work")?i.exampleWorkSelfDescription:t.includes("funAndEntertainment")?i.exampleFunAndEntertainmentSelfDescription:i.examplePersonalTasksSelfDescription,[t]),{layer:s}=U("717266490"),f=s.get("write_custom_instructions_in_onboarding",!1),h=async()=>{a(r),f&&r&&Q.createOrUpdateUserSystemMessage({aboutUserMessage:r,aboutModelMessage:"",disabledTools:[],enabled:!0}).catch(()=>{})};return e.jsxs(C,{className:"flex w-[640px] flex-col items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-4 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...i.anythingElseYouWantMeToKnow})}),e.jsx("p",{className:"text-base text-token-text-secondary",children:e.jsx(S,{...f?i.selfDescriptionReasonSaveToCustomInstructions:i.selfDescriptionReason,values:{customInstructions:n=>e.jsx("a",{href:Fe,className:"underline",target:"_blank",rel:"noreferrer",children:n})}})})]}),e.jsx(Ce,{className:"!dark:bg-white/5 mt-10 rounded border border-token-border-light !bg-black/5 p-5 !text-base placeholder-token-text-tertiary",placeholder:g.formatMessage(m),rows:4,value:r,onChange:n=>p(n.target.value),autoFocus:!0}),e.jsx(M,{size:"medium",color:"primary",onClick:h,className:"mt-10",children:e.jsx(S,{...i.next})})]})}function ze({step:t,gotoStep:o,stepIndex:a,totalSteps:r,endOnboarding:p,clientThreadId:g}){const m=de({clientThreadId:g}),s=Ne(),f=K(),h=E(),n=a===r-1,d=()=>{a<r-1?(b.logEvent("chatgpt_onboarding_flow_next_clicked",null,{source_step_type:t?.step_type,source_step_index:a.toString()}),y.logEvent(_.onboardingNextClicked,{source_step_type:t?.step_type,source_step_index:a.toString()}),t?.step_type==="file_upload"&&V.reset(f),o(a+1)):(p(!0),s())};return e.jsxs(C,{className:"flex h-full w-full flex-row px-8 md:px-12 lg:px-16 xl:px-24",children:[e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center",children:e.jsxs(j.div,{className:"flex w-[90%] flex-1 flex-col items-start justify-center gap-2 md:w-[85%] lg:w-[80%]",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs($,{mode:"wait",children:[e.jsx(j.h1,{className:"mb-2 text-3xl font-medium text-token-text-primary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.title?t.title:H[t.step_type]?h.formatMessage(H[t.step_type]):null},`title-${a}`),e.jsx(j.p,{className:"mb-6 text-base text-token-text-secondary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.subtitle?t.subtitle:z[t.step_type]?h.formatMessage(z[t.step_type]):null},`subtitle-${a}`)]}),e.jsx(M,{size:"large",color:"primary",onClick:d,disabled:m&&!n,children:e.jsx(S,{...n?i.tryChatGPT:i.next})})]})}),e.jsx("div",{className:"relative flex h-full min-w-[360px] flex-1 flex-col pb-16 pt-16",children:e.jsx("div",{className:"h-full w-full overflow-auto rounded-[30px] bg-token-main-surface-primary shadow-2xl shadow-token-border-xlight",children:e.jsx(Le,{hideHeader:!0,hideTools:!0,embedded:!0})})})]})}const Be=({clientThreadId:t,setClientThreadId:o})=>{const a=Te(t),r=Pe(),{onThreadCreated:p}=Y({clientThreadId:t,setClientThreadId:o}),{onRequestCompletion:g}=Ue({clientThreadId:t,currentModelId:a,defaultModelId:r.id,onThreadCreated:p}),m=B(t);return c.useCallback(({stepPrompt:s})=>{const f=new Ie,h=`${m}-nextPrompt`,n=()=>{const d=fe.getTextAsMessage(s,W.User);d.author.metadata=d.author.metadata||{},d.author.metadata.real_author=he.Onboarding,xe.updateTree(t,k=>{k.addNode(h,d,m,W.User,void 0,void 0)})};g({type:ue.Next,promptId:h,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!0,completionMetadata:{conversationMode:pe(ge.getConversationMode(t)),isOnboardingConversation:!0},updateTree:n,turnTracker:f})},[t,g,m])},i=me({skip:{defaultMessage:"Skip",id:"chatgpt.new-onboarding.skip"},close:{defaultMessage:"Close",id:"chatgpt.new-onboarding.close"},submit:{defaultMessage:"Submit",id:"chatgpt.new-onboarding.submit"},next:{defaultMessage:"Next",id:"chatgpt.new-onboarding.next"},finish:{defaultMessage:"Finish",id:"chatgpt.new-onboarding.finish"},tellMeWhyHere:{defaultMessage:"Tell me about why you’re here.",id:"chatgpt.new-onboarding.tell-me-why-here"},suggestUsefulIdeas:{defaultMessage:"I’ll use this information to suggest ideas you might find useful.",id:"chatgpt.new-onboarding.suggest-useful-ideas"},school:{defaultMessage:"School",id:"chatgpt.new-onboarding.school"},work:{defaultMessage:"Work",id:"chatgpt.new-onboarding.work"},personalTasks:{defaultMessage:"Personal tasks",id:"chatgpt.new-onboarding.personal-tasks"},funAndEntertainment:{defaultMessage:"Fun and entertainment",id:"chatgpt.new-onboarding.fun-and-entertainment"},other:{defaultMessage:"Other",id:"chatgpt.new-onboarding.other"},imChaggptNiceToMeetYou:{defaultMessage:"Hi, I’m ChatGPT. It’s nice to meet you!",id:"chatgpt.new-onboarding.im-chatgpt-nice-to-meet-you"},preparingOnboardingExperience:{defaultMessage:"Preparing your onboarding experience...",id:"chatgpt.new-onboarding.preparing-onboarding-experience"},oneLastQuestion:{defaultMessage:"One last question:",id:"chatgpt.new-onboarding.one-last-question-2"},anythingElseYouWantMeToKnow:{defaultMessage:"Is there anything else you’d like me to know?",id:"chatgpt.new-onboarding.anything-else-you-want-me-to-know-2"},oneQuestionAnythingElse:{defaultMessage:"One last question: Is there anything else you’d like me to know?",id:"chatgpt.new-onboarding.one-more-question"},selfDescriptionReason:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant.",id:"chatgpt.new-onboarding.self-description-reason"},allSetLetMeShowYouAroundWithoutName:{defaultMessage:"All set!<nextLine></nextLine>Now, let me show you around...",id:"chatgpt.new-onboarding.all-set-let-me-show-you-around-without-name"},selfDescriptionReasonSaveToCustomInstructions:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant. I’ll save this information as <customInstructions>Custom Instructions</customInstructions>, which you can update any time.",id:"chatgpt.new-onboarding.self-description-reason-save-to-custom-instructions"},exampleSchoolSelfDescription:{defaultMessage:"I'm a college student studying computer science, and I love to play the guitar.",id:"chatgpt.new-onboarding.example-school-self-description"},exampleWorkSelfDescription:{defaultMessage:"I'm a graphic designer based in Berlin, and I enjoy painting and attending art exhibitions.",id:"chatgpt.new-onboarding.example-work-self-description"},examplePersonalTasksSelfDescription:{defaultMessage:"I live in Sydney and love cooking new recipes and planning travel itineraries.",id:"chatgpt.new-onboarding.example-personal-tasks-self-description"},exampleFunAndEntertainmentSelfDescription:{defaultMessage:"I'm a music enthusiast based in Nashville, and I can talk for hours about guitar techniques and songwriting.",id:"chatgpt.new-onboarding.example-fun-and-entertainment-self-description"},tryChatGPT:{defaultMessage:"Try ChatGPT",id:"chatgpt.new-onboarding.try-chatgpt"}}),H={usage_question:i.tellMeWhyHere},z={usage_question:i.suggestUsefulIdeas};export{Ae as LoadingState,ot as default};
//# sourceMappingURL=gxxmr9g4kfxqvl6r.js.map
