import{m as e,r as m,gy as D,an as $,y as C,e as A,aR as R,P as N,d as b,aD as v}from"./mjjokra5fbs3tqyz.js";import{aX as O,cH as F}from"./exorepid259sp82k.js";import{u as _}from"./dp773ga0iriv51dy.js";import{T as k}from"./nu29kniplrm1chtr.js";import{T as z}from"./gm5lcvvwx8cts85t.js";import{P as I}from"./dp64x851ko7z0jer.js";import{aP as H}from"./b4l6rrkq8epp8cm7.js";import"./gidzxho6rdaxa7gb.js";import"./gp54b9cvu35g78o2.js";function w({title:n,content:a,buttons:s,time:t,icon:l,size:i="default",progressBar:u,disabled:c=!1}){return e.jsxs("div",{className:`inline-flex flex-col items-start justify-start rounded-2xl border ${c?"border-token-dot-color border-opacity-10":"border-token-main-surface-secondary"} bg-token-main-surface-primary ${c?"":"shadow"} dark:bg-token-main-surface-secondary ${i==="small"?c?"w-2/3 px-[20px] py-[16px]":"w-2/3 gap-4 px-[20px] py-[16px]":"w-full gap-4 px-[22px] pb-[22px] pt-[18px]"}`,children:[e.jsxs("div",{className:`flex flex-col items-start justify-start self-stretch ${i==="small"?"":"gap-1.5"}`,children:[e.jsxs("div",{className:`inline-flex items-start justify-start self-stretch ${i==="small"?"":"gap-2"}`,children:[e.jsx("div",{className:`shrink grow basis-0 text-base font-semibold leading-normal ${c?"text-token-text-secondary":"text-token-text-primary"}`,children:n}),e.jsx("div",{className:"relative h-6 w-6"}),!c&&(l||e.jsx(H,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:"flex w-full flex-col items-start justify-start",children:e.jsx("div",{className:`inline-flex w-full items-start justify-start self-stretch rounded ${i==="small"?"gap-1":"gap-2.5 py-1"}`,children:e.jsx("div",{className:`w-full text-base font-normal leading-relaxed ${c?"text-token-text-tertiary":"text-token-text-secondary"}`,children:a})})})]}),u?e.jsxs("div",{className:"mb-2 inline-flex items-center justify-between self-stretch",children:[u,s]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[t&&e.jsx("div",{className:"shrink grow basis-0 text-[15px] font-normal leading-normal text-token-text-tertiary",children:t}),e.jsx("div",{className:"flex gap-2",children:s})]})]})}const K={strong:n=>{const{node:a,children:s,...t}=n;return e.jsx("strong",{...t,className:v(t.className,"font-semibold text-token-text-primary"),children:s})},p:n=>{const{node:a,children:s,...t}=n;return e.jsx("p",{...t,className:v(t.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:s})}};function L({message:n}){const s=n.create_time?new Date(n.create_time*1e3):Date.now(),t=_(+s,48e4);return e.jsx(I,{percentage:t,className:"mr-4 !w-full",backgroundClassName:"bg-token-text-tertiary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-t)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"})}function B({headline:n,message:a}){const t=a.create_time?new Date(a.create_time*1e3):Date.now(),l=_(+t,48e4);return e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(F,{percentage:l,thickness:1/8,className:"h-5 w-5 text-token-text-primary",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-l)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"}),n]})}function Z({messages:n,isStreaming:a,clientThreadId:s}){const[t,l]=m.useState(""),[i,u]=m.useState(!1),p=D(s)===$.STREAMING,g=p||a,r=n[0].message,h=r.id,y=C.getServerThreadId(s),d=A(r),o=r.metadata?.summarization_headline,E=a&&o!=null,S=o!=null,T=R("3435450078");m.useEffect(()=>{const P=/\*\*(.*?)(?:\*\*|\n|$)/g;let j,f="";for(;(j=P.exec(d))!=null;)f=j[1].trim();f?l(f):r.metadata?.initial_text!=null&&l(r.metadata.initial_text)},[d,r.metadata?.initial_text]),m.useEffect(()=>{d.length>0&&!o&&u(!0)},[d,o]);const x=m.useMemo(()=>({client_thread_id:s,message_id:h,conversationId:y}),[s,h,y]);m.useEffect(()=>{i&&N.logEvent(b.receivedA8KM123Message,x)},[i]);const M=m.useCallback(()=>{N.logEvent(b.openedA8KM123Message,{...x,isStreaming:a})},[x,a]);return T&&S?p||a?e.jsx("div",{className:"py-2",children:e.jsx(w,{buttons:[],title:o,time:null,icon:e.jsx("div",{className:""}),content:`${t}...`,size:"small",progressBar:e.jsx(L,{message:r})})}):e.jsx("div",{className:"py-2",children:e.jsx(w,{buttons:[],title:o,time:null,content:r.metadata?.finished_text??"",size:"small",disabled:!0})}):e.jsx(z,{status:g?k.Running:k.Finished,highlightedCommand:g?o==null?t:e.jsx(B,{headline:o,message:r}):r.metadata?.finished_text??"",onOpenAnalytics:M,children:i&&!E?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(O,{componentOverrides:K,className:"not-prose leading-6",children:d})}):null})}export{K as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,Z as default};
//# sourceMappingURL=pb0xh313keyrz82l.js.map
