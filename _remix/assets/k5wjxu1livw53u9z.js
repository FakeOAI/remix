import{r as i,j as e,bp as Ze,bq as qe,g as Oe,_ as ze,bK as We,a8 as Ye,C as P,eE as ve,D as De,M as ke,G as s,eB as Ke,E as ye,c as ne,cC as Ge,F as ie,aC as be,a7 as Xe,P as z,x as B,b6 as W,I as T,H as Je,a2 as A}from"./bahzwkph2ne3eyls.js";import{y as Qe,Y as Ne,Z as et}from"./ogp6qk5n3wgjai4w.js";import{a5 as tt,U as V,cw as Ie,a0 as st,a7 as at,dV as Se,cx as Ee,F as Ce}from"./osssmfbfx387nkfp.js";import{D as E}from"./miukfjs4ixxxz4np.js";import{aw as it,b4 as Ae,W as nt,ay as ot,m as je,o as rt,F as lt,E as _e,bh as dt,ax as ct,aZ as ut,T as ht}from"./l2euh9jr36irqfhd.js";import{u as Me,T as Le,a as Te,s as Fe,t as Re,v as gt,w as we}from"./codbzyvijm6ysxs9.js";import{a as mt}from"./cu7i7jyqvstu6net.js";import"./vob0lj31hjn1wm62.js";import"./dmvkul07jrsv5oew.js";import"./c2ngwqta6y10c65f.js";import"./neqrmh68z94ca0s3.js";import"./mkvc221zzllmqy82.js";import"./lsf5205xb8uhelvm.js";import"./e5xpxu685bcmo11v.js";import"./jqfk91km4z8oth8d.js";import"./l21uydfkq6k6cloh.js";import"./d1i0ajln9othjm15.js";import"./dibm0rpouds2ml23.js";import"./livi8sco50k3cxwe.js";import"./jc3615ar2prwhftj.js";import"./o875bmaiwrcidr38.js";import"./lia678yjpfeqs8px.js";import"./ic641g3112rzm1ta.js";import"./i6v4xmbkfg06mje0.js";import"./c7wey25wryf5int1.js";import"./m1399zjt2w9a5toy.js";const ft=({initialFillColor:t,initialBackgroundColor:a})=>{const[r,o]=i.useState({fillColor:t,backgroundColor:a}),g=()=>{o({fillColor:"#FFFFFF",backgroundColor:"#0077B5"})},x=()=>{o({fillColor:t,backgroundColor:a})};return e.jsx("div",{onMouseEnter:g,onMouseLeave:x,children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"40",height:"40",rx:"20",fill:r.backgroundColor}),e.jsx("path",{d:"M27.65 11H12.35C11.992 11 11.6486 11.1422 11.3954 11.3954C11.1422 11.6486 11 11.992 11 12.35V27.65C11 28.008 11.1422 28.3514 11.3954 28.6046C11.6486 28.8578 11.992 29 12.35 29H27.65C28.008 29 28.3514 28.8578 28.6046 28.6046C28.8578 28.3514 29 28.008 29 27.65V12.35C29 11.992 28.8578 11.6486 28.6046 11.3954C28.3514 11.1422 28.008 11 27.65 11ZM16.4 26.3H13.7V18.2H16.4V26.3ZM15.05 16.625C14.7406 16.6162 14.4406 16.5163 14.1876 16.338C13.9346 16.1596 13.7397 15.9107 13.6274 15.6222C13.515 15.3337 13.4902 15.0186 13.5559 14.7161C13.6217 14.4136 13.7751 14.1372 13.9971 13.9214C14.2191 13.7056 14.4997 13.56 14.8039 13.5028C15.1081 13.4456 15.4225 13.4793 15.7077 13.5997C15.9928 13.7201 16.2362 13.9219 16.4074 14.1798C16.5785 14.4378 16.6699 14.7404 16.67 15.05C16.6629 15.4733 16.4885 15.8766 16.1849 16.1717C15.8814 16.4669 15.4733 16.6298 15.05 16.625ZM26.3 26.3H23.6V22.034C23.6 20.756 23.06 20.297 22.358 20.297C22.1522 20.3107 21.9511 20.3649 21.7663 20.4566C21.5815 20.5482 21.4166 20.6755 21.2811 20.831C21.1457 20.9866 21.0422 21.1674 20.9768 21.363C20.9114 21.5586 20.8853 21.7652 20.9 21.971C20.8955 22.0129 20.8955 22.0551 20.9 22.097V26.3H18.2V18.2H20.81V19.37C21.0733 18.9695 21.435 18.6433 21.8605 18.4227C22.286 18.2021 22.761 18.0944 23.24 18.11C24.635 18.11 26.264 18.884 26.264 21.404L26.3 26.3Z",fill:r.fillColor})]})})},xt=({initialFillColor:t,initialBackgroundColor:a})=>{const[r,o]=i.useState({fillColor:t,backgroundColor:a}),g=()=>{o({fillColor:"#FFFFFF",backgroundColor:"#0866FF"})},x=()=>{o({fillColor:t,backgroundColor:a})};return e.jsx("div",{onMouseEnter:g,onMouseLeave:x,children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"40",height:"40",rx:"20",fill:r.backgroundColor}),e.jsx("path",{d:"M29.375 20.0349C29.375 14.8374 25.1782 10.625 20 10.625C14.8218 10.625 10.625 14.8374 10.625 20.0349C10.625 24.4458 13.6536 28.151 17.7368 29.1692V22.9094H15.8032V20.0349H17.7368V18.7962C17.7368 15.5946 19.1797 14.1096 22.3145 14.1096C22.9077 14.1096 23.9331 14.2272 24.3542 14.3449V16.9473C24.1345 16.9252 23.75 16.9105 23.2703 16.9105C21.7322 16.9105 21.1389 17.495 21.1389 19.0131V20.0349H24.2004L23.6731 22.9094H21.1353V29.375C25.7788 28.8126 29.375 24.8465 29.375 20.0349Z",fill:r.fillColor})]})})},pt=({initialFillColor:t,initialBackgroundColor:a})=>{const[r,o]=i.useState({fillColor:t,backgroundColor:a}),g=()=>{o({fillColor:"#FFFFFF",backgroundColor:"#FF4500"})},x=()=>{o({fillColor:t,backgroundColor:a})};return e.jsx("div",{onMouseEnter:g,onMouseLeave:x,children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"40",height:"40",rx:"20",fill:r.backgroundColor}),e.jsx("path",{d:"M24.5703 15.1641C23.5859 15.1641 22.7617 14.4805 22.543 13.5625C21.3477 13.7305 20.4258 14.7617 20.4258 16V16.0078C22.2773 16.0781 23.9648 16.5977 25.3047 17.4258C25.7969 17.0469 26.4141 16.8203 27.082 16.8203C28.6953 16.8203 30 18.125 30 19.7383C30 20.9023 29.3203 21.9062 28.332 22.375C28.2383 25.7656 24.543 28.4922 20.0039 28.4922C15.4648 28.4922 11.7773 25.7695 11.6797 22.3828C10.6875 21.918 10 20.9102 10 19.7383C10 18.125 11.3047 16.8203 12.918 16.8203C13.5898 16.8203 14.207 17.0469 14.7031 17.4297C16.0312 16.6055 17.7031 16.0859 19.5352 16.0078V15.9961C19.5352 14.2656 20.8516 12.8359 22.5352 12.6562C22.7266 11.7109 23.5625 11 24.5703 11C25.7188 11 26.6523 11.9336 26.6523 13.082C26.6523 14.2305 25.7188 15.1641 24.5703 15.1641ZM16.1523 19.7227C15.3359 19.7227 14.6328 20.5352 14.582 21.5938C14.5312 22.6523 15.25 23.082 16.0664 23.082C16.8828 23.082 17.4961 22.6992 17.543 21.6406C17.5898 20.582 16.9688 19.7227 16.1484 19.7227H16.1523ZM25.4297 21.5898C25.3828 20.5312 24.6797 19.7188 23.8594 19.7188C23.0391 19.7188 22.418 20.5781 22.4648 21.6367C22.5117 22.6953 23.125 23.0781 23.9414 23.0781C24.7578 23.0781 25.4766 22.6484 25.4258 21.5898H25.4297ZM23.082 24.3555C23.1406 24.2148 23.043 24.0547 22.8906 24.0391C21.9922 23.9492 21.0195 23.8984 20.0078 23.8984C18.9961 23.8984 18.0234 23.9492 17.125 24.0391C16.9727 24.0547 16.875 24.2148 16.9336 24.3555C17.4375 25.5586 18.625 26.4023 20.0078 26.4023C21.3906 26.4023 22.5781 25.5586 23.082 24.3555Z",fill:r.fillColor})]})})},kt=({initialFillColor:t,initialBackgroundColor:a})=>{const[r,o]=i.useState({fillColor:t,backgroundColor:a}),g=()=>{o({fillColor:"#FFFFFF",backgroundColor:"#000000"})},x=()=>{o({fillColor:t,backgroundColor:a})};return e.jsx("div",{onMouseEnter:g,onMouseLeave:x,children:e.jsxs("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"40",height:"40",rx:"20",fill:r.backgroundColor}),e.jsx("path",{d:"M23.989 13.377H26.2902L21.2641 19.1201L27.1768 26.9363H22.5483L18.9206 22.197L14.7745 26.9363H12.4701L17.8449 20.7922L12.1768 13.377H16.9225L20.1983 17.7088L23.989 13.377ZM23.1807 25.5608H24.4551L16.2283 14.6807H14.8593L23.1807 25.5608Z",fill:r.fillColor})]})})},yt=()=>Ze((t,a)=>({title:void 0,highlightedMessageId:void 0,initiallyHighlightedMessageId:void 0,currentNodeId:void 0,shareLinkId:void 0,shareLinkUrl:void 0,isPublic:!1,isDeleted:!1,isAnonymous:!0,isDiscoverable:!1,canDisableDiscoverability:!1,linkAlreadyExisted:!1,linkAlreadyPublic:!1,linkError:void 0,moderationState:void 0})),oe=i.createContext(),C=t=>qe(i.useContext(oe),t),Ue=()=>C(t=>t.shareLinkId),He=()=>C(t=>t.shareLinkUrl),bt=()=>C(t=>t.title),Ct=()=>C(t=>t.initiallyHighlightedMessageId),Be=()=>C(t=>t.currentNodeId),vt=()=>C(t=>t.isAnonymous),Mt=()=>C(t=>t.linkAlreadyExisted),St=()=>C(t=>t.linkAlreadyPublic),jt=()=>C(t=>t.isPublic),_t=()=>C(t=>t.isDiscoverable),Lt=()=>C(t=>t.canDisableDiscoverability),wt=i.forwardRef((t,a)=>{const{ratio:r=1,style:o,...g}=t;return i.createElement("div",{style:{position:"relative",width:"100%",paddingBottom:`${100/r}%`},"data-radix-aspect-ratio-wrapper":""},i.createElement(Oe.div,ze({},g,{ref:a,style:{...o,position:"absolute",top:0,right:0,bottom:0,left:0}})))}),Dt=wt,n=Je({sharingModalTitle:{id:"thread.sharingModal.title",defaultMessage:"Share link to Chat"},sharingModalDescription:{id:"sharingModal.description",defaultMessage:"Messages you send after creating your link won't be shared. Anyone with the URL will be able to view the shared chat."},sharingModalBizDescription:{id:"sharingModal.bizDescription.1",defaultMessage:"Only members of your workspace with the URL will see the latest messages sent in this conversation. Files you attach to the conversation will not be shared, but any file contents referenced in messages will continue to be visible."},existingShareDescription:{id:"sharingModal.exisitingDescription",defaultMessage:"You have shared this chat <existingLink>before</existingLink>. If you want to update the shared chat content, <deleteLink>delete this link</deleteLink> and create a new shared link."},sharingModalMoreInfo:{id:"thread.sharingModal.moreInfo",defaultMessage:"More Info"},moderationBlocked:{id:"sharingModal.moderationBlocked",defaultMessage:"This shared link has been disabled by moderation."},confirmCloseWithChanges:{id:"thread.sharingModal.confirmCloseWithChanges",defaultMessage:"You have unsaved changes. Do you want to continue?"},confirmDeleteLink:{id:"sharingModal.confirmDeleteLink",defaultMessage:"Are you sure you want to delete the share link?"},advancedDataAnalysisSupportDisclaimer:{id:"sharingModal.advancedDataAnalysisSupportDisclaimer",defaultMessage:"Recipients won’t be able to view Advanced Data Analysis images or download files."},personalizedDataDisclaimer:{id:"sharingModal.personalizedDataDisclaimer",defaultMessage:"Any personalized data not present in the conversation won’t be shared with viewers (ex: custom instructions)."},copied:{id:"thread.sharingModal.copied",defaultMessage:"Copied!"},copying:{id:"thread.sharingModal.copying",defaultMessage:"Copying..."},updateAndCopyLink:{id:"thread.sharingModal.updateAndCopyLink",defaultMessage:"Update and Copy Link"},shareYourName:{id:"sharingModal.shareYourName",defaultMessage:"Share your name"},shareAnonymously:{id:"sharingModal.shareAnonymously",defaultMessage:"Share anonymously"},deleteLink:{id:"sharingModal.deleteLink",defaultMessage:"Delete Link"},failedToCopyLink:{id:"thread.sharingModal.failedToCopyLink",defaultMessage:"Failed to copy link to clipboard"},copyLink:{id:"thread.sharingModal.copyLink",defaultMessage:"Copy Link"},copiedSharedConversationURL:{id:"thread.sharingModal.copiedSharedConversationURL",defaultMessage:"Copied shared conversation URL to clipboard!"},failedToDeleteSharedLink:{id:"thread.sharingModal.failedToDeleteSharedLink",defaultMessage:"Failed to delete shared link"}}),Nt=1.9;function fs({serverThreadId:t}){Qe(t,{kind:We.PrimaryAssistant});const r=Me(t)!=="root",[o]=i.useState(()=>yt()),x=!tt()&&r,[S,w]=i.useState(!0),F=i.useRef(!1),h=Ye("3941367332").value;return i.useEffect(()=>{if(!x||F.current)return;F.current=!0;const m=Le.getThreadCurrentLeafId(t),v=Le.getTree(t).getMessageId(m);P.createShareLink({current_node_id:v,conversation_id:t,is_anonymous:!0}).then(l=>{o.setState({shareLinkId:l.share_id,shareLinkUrl:l.share_url,isPublic:l.is_public,isDeleted:!l.is_visible,title:l.title,highlightedMessageId:l.highlighted_message_id,initiallyHighlightedMessageId:l.highlighted_message_id,currentNodeId:l.current_node_id,linkAlreadyExisted:l.already_exists,linkAlreadyPublic:l.is_public,isAnonymous:l.is_anonymous,isDiscoverable:l.is_discoverable,canDisableDiscoverability:l.can_disable_discoverability,moderationState:l.moderation_state})}).catch(l=>{const y=ve(l);y?o.setState({linkError:y}):V.closeSharingModal()}).finally(()=>{w(!1)})},[x]),e.jsx(oe.Provider,{value:o,children:h?e.jsx(At,{serverThreadId:t,isLoading:S}):e.jsx(It,{serverThreadId:t})})}function Y(t){return t.has_been_auto_blocked===!0||t.has_been_auto_moderated===!0||t.has_been_blocked===!0}const Pe="https://help.openai.com/en/articles/7925741-chatgpt-shared-links-faq",Ve="https://help.openai.com/en/articles/8474715-chatgpt-enterprise-shared-links-faq";function It({serverThreadId:t}){const a=De(),r=i.useRef(null),[o,g]=i.useState(!1),[x,S]=i.useState(!1),[w,F]=i.useState(!1),h=i.useContext(oe),m=bt(),v=Ue(),l=He(),y=vt(),R=Ct(),$=Be(),K=jt(),f=Mt()&&K,G=C(c=>c.linkError),p=C(c=>c.moderationState),X=p!=null&&Y(p),D=Ie(Ee.isBusinessWorkspace),re=Me(t),Z=i.useRef(),J=i.useRef();i.useEffect(()=>{f&&(Z.current=m,J.current=y)},[f]);const N=st(),Q=Te(t,$??re),le=i.useMemo(()=>Ne(Q),[Q]),ee=Fe(t),de=Re(t),ce=ee||de,te=async(c,k)=>{S(!0);const{highlightedMessageId:j,title:q,isDeleted:_,isAnonymous:d}=h.getState();try{Ce(k)}catch{A.warning(a.formatMessage(n.failedToCopyLink)),S(!1);return}try{const{moderation_state:u}=await P.updateShareLink({share_id:c,highlighted_message_id:j,title:q??void 0,is_public:!_,is_visible:!_,is_anonymous:d,current_node_id:void 0});if(Y(u)){h.setState({moderationState:u});return}h.setState({isPublic:!0,moderationState:u}),F(!0),setTimeout(()=>{V.closeSharingModal(),A.success(a.formatMessage(n.copiedSharedConversationURL))},500)}catch(u){const M=ve(u);M&&h.setState({linkError:M})}finally{S(!1)}},se=f&&(m!==Z.current||y!==J.current);function ue(){se&&!window.confirm(a.formatMessage(n.confirmCloseWithChanges))||V.closeSharingModal()}const he=e.jsx(ke.Button,{onClick:()=>te(v,l),color:"primary",disabled:x||w||v==null||l==null||G!=null||X,loading:x,icon:w?it:Ae,children:w?e.jsx(s,{...n.copied}):x?e.jsx(s,{...n.copying}):se?e.jsx(s,{...n.updateAndCopyLink}):e.jsx(s,{...n.copyLink})}),b=i.useCallback(c=>{var k;c==null||c.preventDefault(),h.setState({title:(k=r.current)==null?void 0:k.value}),g(!1)},[h]),ge=i.useCallback(c=>{c.key==="Enter"&&b()},[b]),ae=async()=>{await P.deleteShareLink({share_id:h.getState().shareLinkId}).catch(c=>{A.danger(a.formatMessage(n.failedToDeleteSharedLink))}).then(()=>{V.closeSharingModal()})},me=async()=>{h.setState({isAnonymous:!0}),we.setState(c=>{var j;const k=(j=c.threads[t])==null?void 0:j.sharedConversationMetadata;k&&(k.authorName=void 0)})},fe=async()=>{h.setState({isAnonymous:!1}),we.setState(c=>{var j;const k=(j=c.threads[t])==null?void 0:j.sharedConversationMetadata;k&&(k.authorName=N==null?void 0:N.name)})},xe=e.jsxs(Bt,{$active:o,children:[e.jsxs("div",{className:"flex-1 pr-1",children:[m!==void 0?o?e.jsx(Vt,{ref:r,type:"text",defaultValue:m??"",autoFocus:!0,onKeyDown:ge,onBlur:b}):e.jsxs(Pt,{onDoubleClick:()=>g(!0),children:[m,!o&&m!=null&&!f?e.jsx("button",{onClick:()=>g(!0),className:"text-token-text-tertiary",children:e.jsx(nt,{className:"icon-sm"})}):null]}):e.jsx("div",{className:"h-6"}),e.jsxs("div",{className:"mt-1 text-token-text-tertiary",children:[!y&&e.jsx("span",{children:`${N==null?void 0:N.name} · `}),e.jsx(Ke,{value:new Date,month:"long",day:"numeric",year:"numeric"})]})]}),e.jsx($t,{children:e.jsxs(E.Root,{children:[e.jsx(E.Trigger,{className:"border border-token-main-surface-tertiary",children:e.jsx(ot,{className:"icon-sm"})}),e.jsx(E.Portal,{children:e.jsxs(E.Content,{side:"top",align:"end",children:[y&&e.jsx(E.Item,{onClick:fe,icon:je,children:e.jsx(s,{...n.shareYourName})}),!y&&e.jsx(E.Item,{className:"mb-2 flex w-full border-0",onClick:me,icon:je,children:e.jsx(s,{...n.shareAnonymously})}),f&&e.jsx(E.Item,{className:"mb-2 flex w-full border-0",onClick:ae,icon:rt,color:"danger",children:e.jsx(s,{...n.deleteLink})})]})})]})})]});let U=G;return U==null&&(p!=null&&p.has_been_auto_blocked||p!=null&&p.has_been_auto_moderated||p!=null&&p.has_been_blocked)&&(U=e.jsx(s,{...n.moderationBlocked})),e.jsxs(ye,{isOpen:!0,onClose:()=>{ue()},size:"custom",className:"max-w-[550px]",type:"success",title:a.formatMessage(n.sharingModalTitle),showCloseButton:!0,children:[U!=null&&e.jsx("div",{className:"mb-4 rounded-md bg-red-500 p-4 text-white",children:U}),e.jsx("div",{className:ne("w-full"),children:e.jsx("p",{className:ne("mb-6 text-token-text-tertiary"),children:f?e.jsx(s,{...n.existingShareDescription,values:{existingLink:c=>e.jsx("a",{href:l,target:"_blank",rel:"noreferrer",className:"underline",children:c}),deleteLink:c=>e.jsx("a",{href:"#",onClick:k=>{k.preventDefault(),window.confirm(a.formatMessage(n.confirmDeleteLink))&&ae()},className:"underline",children:c})}}):e.jsx(s,{...D?n.sharingModalBizDescription:n.sharingModalDescription})})}),e.jsx(Et,{shouldShowCodeInterpreterDisclaimer:le,shouldShowPersonalizedDataDisclaimer:ce}),e.jsx(Ht,{children:e.jsx("div",{className:"flex h-full max-w-full flex-1 flex-col",children:e.jsx(Rt,{children:e.jsxs(Ut,{children:[e.jsx(Dt,{ratio:Nt,className:"overflow-auto bg-token-main-surface-primary",children:$!=null?e.jsx(Ge.Provider,{value:{serverSharedThreadId:null,isIndexable:!1},children:e.jsx(at,{children:e.jsx(et,{onChangeItemInView:ie,onRequestMoreCompletions:ie,onChangeRating:ie,onRequestCompletion:mt,clientThreadId:t,conversationLeafId:$,inlineEmbeddedDisplay:!0,initiallyHighlightedMessageId:R})})}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx(be,{className:"text-token-text-tertiary"})})}),xe]})})})}),e.jsx(ke.Actions,{isSpacedBetween:!0,primaryButton:he,secondaryButton:e.jsx("div",{children:e.jsxs("a",{href:D?Ve:Pe,className:"flex items-center gap-2 text-token-text-secondary hover:text-token-text-tertiary",target:"_blank",rel:"noreferrer",children:[a.formatMessage(n.sharingModalMoreInfo),e.jsx(lt,{className:"icon-sm"})]})})})]})}const Et=({shouldShowCodeInterpreterDisclaimer:t,shouldShowPersonalizedDataDisclaimer:a})=>e.jsxs(e.Fragment,{children:[t&&e.jsx(Se,{icon:_e,children:e.jsx(s,{...n.advancedDataAnalysisSupportDisclaimer})}),a&&e.jsx(Se,{icon:_e,children:e.jsx(s,{...n.personalizedDataDisclaimer})})]});function At({serverThreadId:t,isLoading:a}){const r=De(),[o,g]=i.useState(!1),[x,S]=i.useState(!1),[w,F]=i.useState(!1),h=i.useContext(oe),m=Ue(),v=He(),l=Be(),y=St(),R=_t(),$=Lt(),K=C(d=>d.linkError),f=C(d=>d.moderationState),G=f!=null&&Y(f),p=Ie(Ee.isBusinessWorkspace),X=Me(t),D=gt(t,X),re=D==null?void 0:D.message.id,Z=Te(t,l??X),J=i.useMemo(()=>Ne(Z),[Z]),N=Fe(t),Q=Re(t),[le,ee]=i.useState(!1),{layer:de}=Xe("1547743984"),ce=de.get("show_copylink_state_if_no_updates",!1),te=N||Q;if(a)return e.jsx(ye,{isOpen:!0,onClose:ie,size:"custom",className:"max-w-[550px]",type:"success",showCloseButton:!0,children:e.jsx("div",{className:"flex h-full items-center justify-center py-4",children:e.jsx(be,{className:"icon-md text-token-text-secondary"})})});const se=async(d,u)=>{const{highlightedMessageId:M,title:pe,isDeleted:I,isAnonymous:O}=h.getState();try{Ce(u)}catch{A.danger(r.formatMessage(n.failedToCopyLink)),g(!1);return}if(w){try{Ce(u)}catch{A.danger(r.formatMessage(n.failedToCopyLink));return}S(!0),setTimeout(()=>{S(!1)},1500);return}g(!0);try{const{moderation_state:L,is_discoverable:H,can_disable_discoverability:$e}=await P.updateShareLink({share_id:d,highlighted_message_id:M,title:pe??void 0,is_public:!I,is_visible:!I,is_anonymous:O,current_node_id:D.message.id});if(Y(L)){h.setState({moderationState:L});return}h.setState({isPublic:!0,moderationState:L,isDiscoverable:H,canDisableDiscoverability:$e}),S(!0),setTimeout(()=>{S(!1)},1500)}catch(L){const H=ve(L);H&&h.setState({linkError:H})}finally{g(!1)}F(!0)},ue=async()=>{ee(!0);const{highlightedMessageId:d,title:u,isDeleted:M,isAnonymous:pe}=h.getState();if(m)try{const{moderation_state:I,is_discoverable:O,can_disable_discoverability:L}=await P.updateShareLink({share_id:m,highlighted_message_id:d,title:u??void 0,is_public:!M,is_visible:!M,is_anonymous:pe,is_discoverable:!R,current_node_id:D.message.id});if(Y(I)){h.setState({moderationState:I});return}h.setState({isDiscoverable:O,canDisableDiscoverability:L,moderationState:I});const H=O?B.sharedConversationDiscoverabilityEnabled:B.sharedConversationDiscoverabilityDisabled;z.logEvent(H,{shareLinkId:m}),W.logEvent("chatgpt_conversation_share_link_discoverability_toggled",O?"enabled":"disabled")}catch{A.danger("Failed to update this chat's discoverability")}finally{ee(!1)}},he=async()=>{await P.deleteShareLink({share_id:h.getState().shareLinkId}).catch(d=>{A.danger(r.formatMessage(n.failedToDeleteSharedLink))}).then(()=>{V.closeSharingModal()})},b=w||p&&y||y&&l===re&&ce;function ge(){V.closeSharingModal()}const ae=()=>{let d,u;return p?(d=e.jsx(s,{id:"IR+p6G",defaultMessage:"Share link to chat"}),u=e.jsx(s,{id:"ZKoPTp",defaultMessage:"Any messages you add after sharing will be visible to members of your workspace."}),b&&(d=e.jsx(s,{id:"AX5quN",defaultMessage:"Link created"}),u=e.jsx(s,{id:"OmpNr/",defaultMessage:"A link to your chat has been created. Manage previously shared chats at any time via <settingsLink>Settings</settingsLink>.",values:{settingsLink:M=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:M})}})),{modalTitle:d,modalDescription:u}):(b?y?(d=e.jsx(s,{id:"DD6oDE",defaultMessage:"Public link updated"}),u=e.jsx(s,{id:"sJl/nl",defaultMessage:"The public link to your chat has been updated. Manage previously shared chats via <settingsLink>Settings</settingsLink>.",values:{settingsLink:M=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:M})}})):(d=e.jsx(s,{id:"7xzg3Y",defaultMessage:"Public link created"}),u=e.jsx(s,{id:"LZ5EAo",defaultMessage:"A public link to your chat has been created. Manage previously shared chats at any time via <settingsLink>Settings</settingsLink>.",values:{settingsLink:M=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline",children:M})}})):y?(d=e.jsx(s,{id:"FyIlHR",defaultMessage:"Update public link to chat"}),u=te?e.jsx(s,{id:"091Z/H",defaultMessage:"Your name, custom instructions, and any messages you add after sharing stay private."}):e.jsx(s,{id:"U7wOdx",defaultMessage:"Your name and any messages you add after sharing stay private."})):(d=e.jsx(s,{id:"xgkjrq",defaultMessage:"Share public link to chat"}),u=te?e.jsx(s,{id:"091Z/H",defaultMessage:"Your name, custom instructions, and any messages you add after sharing stay private."}):e.jsx(s,{id:"U7wOdx",defaultMessage:"Your name and any messages you add after sharing stay private."})),{modalTitle:d,modalDescription:u})},me=()=>o?e.jsx(s,{...n.copying}):x?e.jsx(s,{id:"zMndTF",defaultMessage:"Copied"}):b?e.jsx(s,{id:"F+gzqW",defaultMessage:"Copy link"}):y?e.jsx(s,{id:"SviHx3",defaultMessage:"Update link"}):e.jsx(s,{id:"Ns/mpl",defaultMessage:"Create link"}),{modalTitle:fe,modalDescription:xe}=ae(),U=me(),c=e.jsx(ke.Button,{onClick:()=>se(m,v),color:"primary",disabled:o||x||m==null||v==null||K!=null||G,className:"ml-4 mr-0 mt-0 rounded-full px-4 py-3 text-base font-bold",loading:o,icon:b?ht:Ae,children:U});let k=K;k==null&&(f!=null&&f.has_been_auto_blocked||f!=null&&f.has_been_auto_moderated||f!=null&&f.has_been_blocked)&&(k=e.jsx(s,{...n.moderationBlocked}));const j=b?v:"/share/...",q=h.getState().title??"My ChatGPT conversation",_=!R||$;return e.jsxs(ye,{isOpen:!0,onClose:()=>{ge()},size:"custom",className:"max-w-[550px]",type:"success",title:fe,showCloseButton:!0,children:[k!=null&&e.jsx("div",{className:"mb-4 rounded-md bg-red-500 p-4 text-white",children:k}),e.jsx("div",{className:"w-full",children:e.jsx("p",{className:"mb-6 text-token-text-secondary",children:e.jsxs("span",{children:[xe," ",!b&&e.jsx("a",{href:p?Ve:Pe,className:"inline-flex items-center gap-2 text-token-text-secondary underline hover:text-token-text-tertiary",target:"_blank",rel:"noreferrer",children:e.jsx(s,{id:"TKNIin",defaultMessage:"Learn more"})})]})})}),!b&&e.jsx(Tt,{shouldShowCodeInterpreterDisclaimer:J}),b&&!p&&e.jsx("div",{className:"mb-7",onClick:_?ue:void 0,role:"checkbox","aria-checked":R,"aria-disabled":!_,tabIndex:0,children:e.jsxs("label",{className:ne("flex items-start",{"cursor-pointer":_}),children:[e.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:le?e.jsx(be,{className:"icon-md text-token-text-secondary"}):R?e.jsx(dt,{className:_?"text-token-text-primary":"text-token-text-secondary"}):e.jsx(ct,{})}),e.jsxs("div",{className:"ms-2 leading-tight",children:[e.jsx("div",{className:_?"text-token-text-primary":"text-token-text-secondary",children:e.jsx(s,{id:"Ll7cH+",defaultMessage:"Make this chat discoverable"})}),e.jsx("div",{className:"text-xs text-token-text-secondary",children:_?e.jsx(s,{id:"0Qtyx3",defaultMessage:"Allows it to be shown in web searches"}):e.jsx(s,{id:"NZCrSB",defaultMessage:"<deleteLink>Delete the link</deleteLink> to turn off chat discoverability",values:{deleteLink:d=>e.jsx("a",{href:"#",onClick:u=>{u.preventDefault(),window.confirm(r.formatMessage(n.confirmDeleteLink))&&he()},className:"underline",children:d})}})})]})]})}),e.jsxs("div",{className:"mb-2 flex items-center justify-between rounded-full border border-token-border-medium bg-token-main-surface-primary p-2 text-token-text-secondary last:mb-2",children:[e.jsxs("div",{className:"relative ml-1 flex-grow",children:[e.jsx("input",{type:"text",readOnly:!0,value:j,className:ne("w-full rounded-xl border-0 bg-token-main-surface-primary px-2 py-2.5 text-lg",b?"text-token-text-primary":"text-token-text-tertiary")}),e.jsx("div",{className:"pointer-events-none absolute bottom-0 right-0 top-0 w-12 bg-gradient-to-l from-token-main-surface-primary"})]}),c]}),y&&!b&&e.jsx("div",{className:"w-full",children:e.jsx("p",{className:"mb-3 text-sm text-token-text-tertiary",children:e.jsx(s,{id:"A9Jgr5",defaultMessage:"A past version of this chat has already been shared. Manage previously shared chats via <settingsLink>Settings</settingsLink>.",values:{settingsLink:d=>e.jsx("a",{href:"#settings/DataControls",target:"_blank",rel:"noreferrer",className:"underline hover:text-token-text-quaternary",children:d})}})})}),!p&&b&&v&&e.jsxs("div",{className:"mt-6 flex justify-center space-x-14",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://www.linkedin.com/shareArticle?url=${encodeURIComponent(v)}&text=${encodeURIComponent(q)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{z.logEvent(B.sharedConversationLinkedinSocialClicked,{shareLinkId:m}),W.logEvent("chatgpt_conversation_share_link_social_clicked","linkedin")},children:e.jsx(ft,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"mt-1 text-xs font-semibold text-token-text-secondary",children:e.jsx(s,{id:"YtW6Uh",defaultMessage:"LinkedIn"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(v)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{z.logEvent(B.sharedConversationFacebookSocialClicked,{shareLinkId:m}),W.logEvent("chatgpt_conversation_share_link_social_clicked","facebook")},children:e.jsx(xt,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"mt-1 text-xs font-semibold text-token-text-secondary",children:e.jsx(s,{id:"5VI4EO",defaultMessage:"Facebook"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://www.reddit.com/submit?url=${encodeURIComponent(v)}&title=${encodeURIComponent(q)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{z.logEvent(B.sharedConversationRedditSocialClicked,{shareLinkId:m}),W.logEvent("chatgpt_conversation_share_link_social_clicked","reddit")},children:e.jsx(pt,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"mt-1 text-xs font-semibold text-token-text-secondary",children:e.jsx(s,{id:"VLrIK1",defaultMessage:"Reddit"})})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("a",{href:`https://twitter.com/intent/tweet?url=${encodeURIComponent(v)}&text=${encodeURIComponent(q)}`,target:"_blank",rel:"noopener noreferrer",onClick:()=>{z.logEvent(B.sharedConversationXSocialClicked,{shareLinkId:m}),W.logEvent("chatgpt_conversation_share_link_social_clicked","x")},children:e.jsx(kt,{initialBackgroundColor:"var(--main-surface-secondary)",initialFillColor:"var(--text-secondary)"})}),e.jsx("span",{className:"mt-1 text-xs font-semibold text-token-text-secondary",children:e.jsx(s,{id:"CgECe/",defaultMessage:"X"})})]})]})]})}const Tt=({shouldShowCodeInterpreterDisclaimer:t})=>e.jsx(e.Fragment,{children:t&&e.jsx(Ft,{icon:ut,children:e.jsx(s,{id:"iEl3pV",defaultMessage:"Images and files in this chat won't be shown in the public link."})})}),Ft=({children:t,icon:a})=>e.jsxs("div",{className:"mb-4 flex items-center justify-between rounded-2xl bg-token-main-surface-secondary p-4 text-token-text-secondary last:mb-0",children:[t,a!=null&&e.jsx(a,{className:"icon-sm mt-1 flex-shrink-0"})]}),Rt=T.main`relative h-full w-full transition-width flex flex-col overflow-hidden items-stretch`,Ut=T.div`grow flex-1 overflow-hidden`,Ht=T.div`w-full mb-4 shadow-[0_2px_12px_0px_rgba(0,0,0,0.08)] bg-token-main-surface-secondary rounded-lg border border-token-main-surface-tertiary overflow-hidden`,Bt=T.div`flex p-4 bg-token-main-surface-secondary border-token-main-surface-tertiary border-t rounded-b-lg w-full h-full
${({$active:t})=>""}
`,Pt=T.div`flex w-full items-center justify-left gap-2 min-h-[1.5rem]`,Vt=T.input`border-none focus:ring-gray-200 dark:focus:ring-gray-600 bg-transparent py-0.5 -my-0.5 pl-1 -ml-1 w-full`,$t=T.div`flex-none h-full mt-auto mb-auto`;export{Pe as SHARED_LINKS_HELP_URL,fs as default};
