import{j as e,cG as w,G as m,D as v,a3 as N,ca as C,bs as I,T as M,I as x,r as f,x as h,P as _,E as R,c as T,bh as A,H as D}from"./nfjrln83fxu65oyx.js";import{B as E,q as L,C as F,g as P,n as B}from"./sdxzewl9qotrm9f1.js";import{g as y}from"./kqwdyvkaaavvn8k3.js";import{u as S}from"./mmc5tia87u8jr9jj.js";import{bs as G,br as U,fA as q,fB as z,bC as H,aw as O,ax as Q,fC as V,fD as d,fE as p,A as $}from"./c96sbxi6wxvsoc0g.js";import{aQ as Y}from"./o3o9tmae3y8d2645.js";import{F as Z}from"./jl4f103tilw5prsd.js";import{S as J,a as K}from"./d82gjbqjihszsa8z.js";import{m as b}from"./fo9427i0kcp4inqe.js";import"./fy8xrkb7rl3yrxfr.js";import"./fotsdvg0k4ftt511.js";function k({children:t}){return e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsxs("div",{className:"flex flex-col items-center gap-1 text-sm font-semibold text-token-text-tertiary",children:[e.jsx(Y,{className:"icon-2xl"}),t]})})}const W=({images:t,turnIndex:s})=>{const a=t.map(n=>n.thumbnail_url),r=w({queries:a.map(n=>E(n)),combine:n=>{const o=new Set;return n.forEach((l,i)=>{l.isError&&o.add(a[i])}),o}});return e.jsx(e.Fragment,{children:(t==null?void 0:t.length)>0?e.jsx("div",{className:"columns-1 gap-2 px-6 py-4 xs:columns-2 md:columns-3",children:t.map((n,o)=>!r.has(n.thumbnail_url)&&e.jsx("div",{className:"relative mb-0.5 break-inside-avoid",children:e.jsx(X,{image:n,turnIndex:s})},o))}):e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(k,{children:e.jsx(m,{id:"AbVGAw",defaultMessage:"No Results"})})})})},X=({image:t,turnIndex:s})=>{const a=S(t.url).data??y(t.url,"short"),{isSuccess:r}=L(t==null?void 0:t.thumbnail_url);return e.jsx("button",{onClick:()=>{G.setCurrentImage(t?{image:t,source:U.ImagesTab,turnIndex:s}:void 0)},children:r?e.jsxs("div",{className:"group relative h-full w-full",children:[e.jsx("img",{src:t.thumbnail_url,alt:t.content_url,className:"w-full rounded-lg hover:opacity-100 group-hover:opacity-90"}),e.jsx("div",{className:"absolute bottom-1 left-1 max-w-[75%] truncate rounded-xl bg-black/40 px-2 py-1 text-xs font-medium text-white backdrop-blur-sm",children:a})]}):e.jsx("div",{className:"aspect-square h-full w-full animate-pulse bg-token-main-surface-tertiary"})})};function ee({date:t}){const s=v(),a=t instanceof Date?t:new Date(t*1e3),r=q(a,new Date);if(r<4&&r>-4){const n=s.formatRelativeTime(r,"day",{numeric:"auto"});return n.charAt(0).toUpperCase()+n.slice(1)}else return s.formatDate(a,{year:"numeric",month:"long",day:"numeric"})}var te=C,se=N,re=z,ae=I;function ne(t,s){var a=ae(t)?te:re;return a(t,se(s))}var oe=ne,le=H,ie=oe;function ce(t,s){return le(ie(t,s),1)}var ue=ce;const de=M(ue);function me({citations:t,searchResults:s,turnIndex:a}){if(t.length===0&&s.length===0)return e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(k,{children:e.jsx(m,{id:"AbVGAw",defaultMessage:"No Results"})})});const r=de(s,o=>o.entries).toSorted((o,l)=>((l==null?void 0:l.pub_date)??0)-((o==null?void 0:o.pub_date)??0)),n=t.toSorted((o,l)=>((l==null?void 0:l.pub_date)??0)-((o==null?void 0:o.pub_date)??0));return e.jsxs("div",{className:"mt-[-1px] flex w-full flex-col",children:[e.jsx(g,{title:e.jsx(m,{id:"dlVlo6",defaultMessage:"Citations"}),items:n,turnIndex:a}),e.jsx(g,{title:e.jsx(m,{id:"9M0Yh6",defaultMessage:"More Links"}),items:r,turnIndex:a})]})}const xe=x.div`sticky top-[-1px] text-xs font-semibold border-token-border-light text-token-text-secondary border-y py-3 px-6 bg-token-main-surface-primary`;function g({title:t,items:s,turnIndex:a}){return!s||s.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx(xe,{children:t}),e.jsx("div",{className:"flex flex-col gap-6 px-6 py-4",children:s.map((r,n)=>e.jsx(fe,{item:r,turnIndex:a,index:n},n))})]})}function fe({item:t,turnIndex:s,index:a}){const r=S(t.url).data??y(t.url,"short"),n=o=>"ref_id"in o&&"content_type"in o;return e.jsx(he,{turnIndex:s,href:t.url,position:a,target:"_blank",rel:"noopener",className:"group flex gap-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"line-clamp-1 flex items-center gap-2 text-sm",children:[e.jsx(Z,{url:t.url,className:"icon-sm rounded bg-token-main-surface-primary object-cover",size:32,minSize:20,fallback:e.jsx(J,{className:"icon-sm text-token-text-quaternary"})}),r,n(t)&&e.jsx(K,{searchResult:t,className:"inline h-4 w-4 text-token-text-tertiary"})]}),e.jsx("div",{className:"line-clamp-2 text-sm font-semibold hover:underline",children:t.title}),t.pub_date&&e.jsx("div",{className:"text-sm text-token-text-secondary",children:e.jsx(ee,{date:t.pub_date})})]})})}const he=f.forwardRef(function(s,a){const r=O(Q.threadId),{turnIndex:n,position:o,...l}=s;function i(c){!s.href||!r||_.logEvent(c,{url:s.href,thread_id:r,turn_index:n,raw_position:o})}return f.useEffect(()=>{i(h.searchLinkShown)},[]),e.jsx("a",{ref:a,...l,onClick:c=>{var u;(u=s.onClick)==null||u.call(s,c),c.stopPropagation(),i(h.searchLinkClicked)}})});function Te({clientThreadId:t}){const s=v(),{tab:a,turnIndex:r}=V(),n=[],o=r?F(t,r):[],l=r?P.getTurnSearchResults(t,r):[],i=r?B(t,r):[];(o.length>0||l.length>0)&&n.push(d.Sources),i.length>0&&n.push(d.Images);const c=f.useCallback(()=>{p.close(a)},[a]);return!a||!r||n.length===0||!n.includes(a)?null:e.jsx(R,{size:"custom",noPadding:!0,isOpen:!0,onClose:c,type:"success",className:"focus-none max-w-2xl !shadow-none outline-none",children:e.jsxs("div",{className:"focus-none flex h-full flex-col items-center justify-start overflow-hidden rounded-lg outline-none",children:[e.jsxs(pe,{children:[e.jsx(be,{children:n.map(u=>e.jsx("button",{onClick:()=>{p.open(u,r)},className:T("mb-[-1px] border-b-2 border-solid border-transparent py-6 text-lg font-medium text-token-text-tertiary hover:text-token-text-secondary",{"!border-token-text-primary font-semibold !text-token-text-primary":a===u}),children:s.formatMessage(je[u])},u))}),e.jsx(A,{onClick:c})]}),e.jsx(ge,{children:e.jsx($,{children:a===d.Sources?e.jsx(b.div,{...j,children:e.jsx(me,{citations:o,searchResults:l,turnIndex:r})},"sources"):a===d.Images?e.jsx(b.div,{...j,children:e.jsx(W,{images:i,turnIndex:r})},"images"):null})})]})})}const j={initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},className:"h-full overflow-y-auto relative"},pe=x.div`flex w-full flex-row items-center justify-between border-b px-6 dark:border-gray-700`,be=x.span`text-base font-semibold sm:text-base flex gap-4`,ge=x.div`h-[60vh] max-h-[700px] w-full`,je=D({[d.Images]:{id:"Z0ljgR",defaultMessage:"Images"},[d.Sources]:{id:"f0O2dC",defaultMessage:"Sources"}});export{Te as SearchResultsModal};
//# sourceMappingURL=ja1o0zuos29nsvty.js.map
