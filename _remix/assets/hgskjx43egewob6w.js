const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/sso-ipuhfmti911l5wbt.js","assets/ofly9yrztlesgrye.js","assets/pbk6784aea0pnvmy.js","assets/root-cmvuzs81.css","assets/nqzijea2w2642vxo.js","assets/index-small-c8xg50op.css","assets/ffzjrrth2s7rj53y.js","assets/d4ayzlfdvw3mppxq.js","assets/nhwwej1nq0zrd7sc.js","assets/bioahmdl0dhuzf2s.js","assets/dnclpnvevlt4w60m.js","assets/c4wbs9sfbozms9h9.js","assets/o70b5rlocd70y24d.js","assets/kdfb7z4c9wk9qcaq.js","assets/eni5d61fsksdl3xv.js","assets/lj5rtlp3i0cfoffa.js","assets/k8blgkgtyu77dvqj.js","assets/j8udrimwvg5wgb50.js","assets/pdyd96jvf5nj4arp.js","assets/ndz7khihe98mo9mr.js","assets/m35een31x7hl7one.js","assets/h7f61j8yt7zvajch.js","assets/cxynijnwgmoep20m.js","assets/kyhim0cxnn9lnc9c.js","assets/du2biz3bflj3ny15.js","assets/dqjxcbzr89kaex61.js","assets/ngly12g8pku877oj.js","assets/nr3n8xw311uli2v7.js","assets/o72bhizxu5dr6xab.js","assets/d0g8ptgc5gcqjwyj.js","assets/iketqivbiq1uua6y.js","assets/f50xww4ndvvgi9wd.js","assets/isjdmfmhzv09v01t.js","assets/hiowkoznbcbuyj5y.js","assets/m56qawl3nz8ab6w3.js","assets/cpruitoywmh2hmz7.js","assets/ip1g1wxksvlp6l12.js","assets/giz03xvnujeqild8.js","assets/mspfsragw34dubp8.js","assets/nja8bkvzwivp0d1e.js","assets/26qzd5j5c4gu7vgg.js","assets/ebjnzfyjozehhu1d.js","assets/hxk29e4mntnfdwo1.js","assets/g6g5o5sxy8te57v6.js","assets/cjrwfkkoj3f7v9aq.js","assets/fsddy3bxlesj6ecw.js","assets/j2pqa1cuq7toz2li.js","assets/lgunmrbg0zk74byl.js","assets/fjwokyxx7t8vavyv.js","assets/otl3kmh55r9mpho8.js","assets/mgd2lih2oegztyuc.js","assets/o7xzgyksykwpw458.js","assets/jhuun61paojcem1l.js","assets/kk3g11g1tx1qyiou.js","assets/nfegrk5dyqdjzy1l.js","assets/kqwdyvkaaavvn8k3.js","assets/knrqgejkx7kf6de9.js","assets/muiq032a7v6lqwp1.js","assets/j793iupxz6cbek3f.js","assets/jgtw8bw0po3nqr9k.js","assets/crv9067h7en0x84a.js","assets/cfu4tlrhgvcp30sx.js","assets/c9ruca640f27asij.js","assets/fs11lsv0j2bplke3.js","assets/f57vlzxujq1abxlh.js","assets/iej0cupg2dqkmejt.js","assets/gt5btci5dtrnoaqo.js","assets/gijjijf6bgeseo0o.js","assets/jddbarybj7ituzga.js","assets/nlwvsjzhecxypowl.js","assets/shared-mk6ngktc.css","assets/i7lxzk5wl4daufg5.js","assets/mrlqxqghd8fc4s3q.js","assets/sso-ibshx6th.css"])))=>i.map(i=>d[i]);
import{af as A,r as m,am as O,j as G,w as B,e0 as w,c1 as k,a0 as q,bF as v,e1 as I,e2 as H,a1 as N,cB as f,cn as x,C as F,cz as j,e3 as $,Z as K,b6 as W,bS as X,e4 as Q,S as V,db as Y}from"./ofly9yrztlesgrye.js";import{bv as Z,bw as J,bx as ee,by as re,ar as C,as as _,x as R,bz as te,bA as se,aI as ne,K as ae,bB as oe,E as de,bC as ue}from"./nqzijea2w2642vxo.js";import{m as ie}from"./lj5rtlp3i0cfoffa.js";function be(){const{imageResults:e}=ce();ee([...e.map(r=>D(r))])}const le=Z((...e)=>J(...e),5e3);function ce(e=!1){var c,l;const r=re(["image_results","image_try_hard_status","execution_status"]),t=C(_.threadId),s=R(r.toReversed().flatMap(T=>{var p;return(p=T.image_results)==null?void 0:p.entries})).map(T=>({...T,thumbnail_url:T.thumbnail_url.replace(/^http:\/\//,"https://"),content_url:T.content_url.replace(/^http:\/\//,"https://")})),n=C(_.hasModelResponseText),o=r.some(T=>te(T));let i=s.length===0&&!n;return t!=null&&e&&!i&&s.length===0&&((c=r[0])==null?void 0:c.image_try_hard_status)==="not_attempted"&&(le(t,0),i=!0),e&&((l=r[0])==null?void 0:l.image_try_hard_status)==="in_progress"&&(i=!0),{imageResults:s,isLoading:i,isErrored:s.length===0&&o}}function we(){const e=se(),r=C(_.hasTurnError),t=C(_.hasModelResponseText),s=E(e);return{imageResults:s,isLoading:s.length===0&&!t,isErrored:s.length===0&&r}}function E(e){return R(e.flatMap(r=>r.type==="image_v2"?r.images:[]))}function he(e){return O({queryKey:["downloadImage",{imageUrl:e}],queryFn:()=>new Promise((r,t)=>{const s=new Image;s.onload=()=>{r({width:s.width,height:s.height})},s.onerror=()=>{t()},s.src=e}),enabled:e!=null})}function Ne(e){return A(he(e))}const U={width:474,square:!0};function D(e,r=U){if(e==null)return;const t=new URL(e.thumbnail_url);if(t.hostname.indexOf(".bing.")===-1)return e.thumbnail_url;const s=Math.min(r.width,e.content_size.width),n=r.height??Math.floor(s*e.content_size.height/e.content_size.width);if(t.searchParams.delete("pid"),r.square){const o=Math.min(s,n);t.searchParams.set("w",o.toString()),t.searchParams.set("h",o.toString())}else t.searchParams.set("w",s.toString()),t.searchParams.set("h",n.toString());return t.searchParams.set("c","7"),t.toString()}function xe(e,r=U){return m.useMemo(()=>D(e,r),[e,r])}const Te={type:"spring",stiffness:700,damping:82};function Fe({children:e,className:r}){return G.jsx(ie.div,{animate:{opacity:1},initial:{width:"100%",height:"100%",translateX:0,translateY:0,opacity:0},whileHover:{width:"103%",height:"103%",translateX:"-1.5%",translateY:"-1.5%"},transition:Te,className:r,children:e})}function P(e,r,t){var n,o;if(t)return t;const s=e[r];return(o=(n=s==null?void 0:s.message)==null?void 0:n.metadata)!=null&&o.model_slug?s.message.metadata.model_slug:s!=null&&s.parentId?P(e,s.parentId):null}function Ee(){return`${w}${k()}`}let ge=0;function Ue(){return ge++}function M(e){return e.startsWith(w)}const me=()=>new I,ve=()=>Object.freeze({lastModelUsed:null,createTime:new Date});var Ie=(e=>(e.NewChat="NewChat",e.Server="Server",e.User="User",e.Generated="Generated",e.Unknown="Unknown",e))(Ie||{});const L={},u=B(q(()=>({threads:{},clientNewThreadIdToServerIdMapping:{},threadRetainCounts:{}}))),d=u.getState,g=u.setState,h={resolveThreadId:(e,r=d())=>r.clientNewThreadIdToServerIdMapping[e]??e,getThread:(e,r=d())=>{const t=h.resolveThreadId(e,r);return r.threads[t]??null},hasThread:(e,r=d())=>{const t=h.resolveThreadId(e,r);return r.threads[t]!=null},isLoading:(e,r=d())=>{var s;const t=h.resolveThreadId(e,r);return(s=r.threads[t])==null?void 0:s.isLoading},getConversationMode:(e,r=d())=>{var s;const t=h.resolveThreadId(e,r);return(s=r.threads[t])==null?void 0:s.mode},getThreadModelId:(e,r=d())=>{var t;return((t=h.getThread(e,r))==null?void 0:t.modelId)??null},getGizmoId(e,r=d()){const t=r.threads[h.resolveThreadId(e,r)];if((t==null?void 0:t.mode.kind)===v.GizmoInteraction||(t==null?void 0:t.mode.kind)===v.GizmoTest)return t.mode.gizmo_id},getThreadTitleSource(e,r=d()){const t=h.resolveThreadId(e,r),s=r.threads[t];return s!=null?s.titleSource:"Unknown"},getThreadCreateTime(e,r=d()){var s,n;const t=h.resolveThreadId(e,r);return(n=(s=r.threads[t])==null?void 0:s.initialThreadData)==null?void 0:n.createTime},getCurrentNode(e,r=d()){var n;const t=h.resolveThreadId(e,r),s=((n=r.threads[t])==null?void 0:n.currentLeafId)??"root";return a.getTree(e).getNodeByIdOrMessageId(s)},isThreadUrlSafe(e,r,t=d()){var n;const s=h.resolveThreadId(e,t);return((n=t.threads[s])==null?void 0:n.safeUrls.includes(r))??!1},getRatingPrompt(e,r=d()){var s;const t=h.resolveThreadId(e,r);return(s=r.threads[t])==null?void 0:s.promptGptRating},getTurnContentReferences(e,r=d(),t){var n,o;const s=(o=(n=h.getThread(e,r))==null?void 0:n.conversationTurns[t])==null?void 0:o.messages;return s?R(s.flatMap(i=>{var c,l;return(l=(c=i.message)==null?void 0:c.metadata)==null?void 0:l.content_references})):[]}},a={initThread:(e,r,t=null)=>{const s=a.resolveThreadId(e);if(d().threads[s]==null){const n=$();g(o=>{o.threads[s]={initialThreadData:n,mode:r,modelId:t,tree:new I(I.createTree()),title:null,titleSource:"NewChat",currentLeafId:"root",conversationTurns:[],safeUrls:[],isLoading:!M(s),docsReferencedByURL:{},conversationOrigin:null}})}},setThreadModelId:(e,r)=>{const t=a.resolveThreadId(e);g(s=>{const n=s.threads[t];n!=null&&(n.modelId=r)})},updateConversationMode:(e,r)=>{const t=a.resolveThreadId(e);g(s=>{const n=s.threads[t];n!=null&&(n.mode=r)})},getServerThreadId:e=>M(e)?d().clientNewThreadIdToServerIdMapping[e]:e,setServerIdForNewThread:(e,r)=>{d().clientNewThreadIdToServerIdMapping[e]===void 0&&g(t=>{t.threads[r]=t.threads[e],delete t.threads[e],t.clientNewThreadIdToServerIdMapping[e]=r})},initThreadFromServerData:(e,r,t=!1,s=void 0,n=!1)=>{var y;const o=a.resolveThreadId(e);if(!n&&(d().threads[o]==null&&!t||((y=d().threads[o])==null?void 0:y.isLoading)===!1))return;const i=H(r),c=i.mapping??I.createTree(),l={lastModelUsed:P(i.mapping,i.initialCurrentLeafId,r.default_model_slug),createTime:"create_time"in r?new Date(r.create_time*1e3):void 0,isArchived:r.is_archived??!1},T=new I(c),p=i.initialCurrentLeafId??i.rootId??"root",z="has_user_editable_context"in r?{hasUserEditableContextFlag:r.has_user_editable_context,authorName:r.author_name,model:"model"in r&&r.model!=null?ne(r.model):void 0}:void 0;g(b=>{const S=b.threads[o];b.threads[o]={modelId:(S==null?void 0:S.modelId)??null,initialThreadData:l,mode:r.gizmo_id!=null?{kind:v.GizmoInteraction,gizmo_id:r.gizmo_id}:{kind:v.PrimaryAssistant,plugin_ids:r.plugin_ids},sharedConversationMetadata:z,title:r.title??null,titleSource:"Server",tree:T,currentLeafId:p,isLoading:!1,continuingFromSharedConversationId:s,safeUrls:r.safe_urls??[],conversationTurns:[],docsReferencedByURL:{},conversationOrigin:r.conversation_origin??null,async_status:r.async_status??null,update_time:r.update_time??null}}),a.recomputeConversationTurnsForCurrentLeafId(o,[])},updateInitialThreadDataForNewThread:(e,r)=>{const t=a.resolveThreadId(e);g(s=>{const n=s.threads[t];n!=null&&(n.initialThreadData.lastModelUsed=r)})},getThreadCurrentLeafId:e=>{var t;const r=a.resolveThreadId(e);return((t=d().threads[r])==null?void 0:t.currentLeafId)??"root"},getThreadSafeUrls:e=>{var t;const r=a.resolveThreadId(e);return(t=d().threads[r])==null?void 0:t.safeUrls},addThreadSafeUrl:(e,r)=>{const t=a.resolveThreadId(e);t&&g(s=>{const n=s.threads[t];n!=null&&n.safeUrls.push(r)})},setThreadCurrentLeafId:(e,r)=>{const t=a.resolveThreadId(e);d().threads[t]!=null&&g(n=>{const o=n.threads[t];if(o==null)return;o.currentLeafId=r;const i=a.computeThreadConversationTurns(t,o.currentLeafId,o.conversationTurns);o.conversationTurns=i})},setTitle:(e,r,t)=>{const s=a.resolveThreadId(e);g(n=>{const o=n.threads[s];o&&(o.title=r,o.titleSource=t)})},getTitle:e=>{var t;const r=h.resolveThreadId(e);return((t=d().threads[r])==null?void 0:t.title)??void 0},getTitleAndSource:e=>({title:a.getTitle(e),titleSource:h.getThreadTitleSource(e)}),getConversationOrigin:e=>{var t;const r=h.resolveThreadId(e);return((t=d().threads[r])==null?void 0:t.conversationOrigin)??null},setConversationOrigin:(e,r)=>{const t=a.resolveThreadId(e);g(s=>{const n=s.threads[t];n&&(n.conversationOrigin=r)})},deleteNodesByFilter:(e,r)=>{const t=a.getThreadCurrentLeafId(e);a.updateTree(e,s=>{s.deleteNodesByFilter(r).includes(t)&&a.setThreadCurrentLeafId(e,"root")})},updateTree:(e,r)=>{var c;const t=a.resolveThreadId(e);if(!(d().threads[t]!=null)){console.warn("Thread does not exist, cannot update tree: ",t);return}const n=a.getTree(e);r(n);const i=((c=d().threads[t])==null?void 0:c.conversationTurns)??[];a.recomputeConversationTurnsForCurrentLeafId(t,i)},getTree:e=>{var t;const r=a.resolveThreadId(e);return((t=d().threads[r])==null?void 0:t.tree)??me()},resolveThreadId:e=>h.resolveThreadId(e),recomputeConversationTurnsForCurrentLeafId:(e,r)=>{const t=a.resolveThreadId(e);g(s=>{const n=s.threads[t];if(n==null)return;const o=a.computeThreadConversationTurns(t,n.currentLeafId,r);n.conversationTurns=o})},computeThreadConversationTurns:(e,r,t)=>{const s=a.resolveThreadId(e);return a.getTree(s).getConversationTurns(r).map((c,l)=>{const T=t==null?void 0:t[l];return N(T,c)?T:c})},getThreadConversationTurns:(e,r,t)=>{var T;const s=a.resolveThreadId(e),o=d().threads[s];if(o==null)return[];const i=o.tree,c=i.messageIdToNodeId((o==null?void 0:o.currentLeafId)??"root"),l=r!=null?i.messageIdToNodeId(r):null;return l!=null&&l!==c?a.computeThreadConversationTurns(s,l,t??[]):((T=d().threads[s])==null?void 0:T.conversationTurns)??[]},removeContinuingFromSharedConversationId:e=>{const r=a.resolveThreadId(e);g(t=>{const s=t.threads[r];(s==null?void 0:s.continuingFromSharedConversationId)!=null&&delete s.continuingFromSharedConversationId})},updateReferencedDocState:(e,r,t)=>{const s=a.resolveThreadId(e);g(n=>{const o=n.threads[s];o&&(o.docsReferencedByURL[r]=t)})},copyLastMessageToClipboard:(e,r="mouse")=>{const t=a.getThreadCurrentLeafId(e),s=a.getThreadConversationTurns(e,t);return a.copyMessageToClipboard(e,s.length-1,r)},copyMessageToClipboard:(e,r,t="mouse")=>{const s=a.getThreadCurrentLeafId(e),o=a.getThreadConversationTurns(e,s)[r];if(!o)return Promise.reject();const{messages:i}=o,c=i.reduce((l,T)=>!T.err&&T.message.author.role===f.Assistant&&T.message.recipient==="all"?l+(l?`

`:"")+x(T.message):l,"");return ae(c).then(()=>{const l=a.getServerThreadId(e);l&&F.submitImplicitMessageFeedback({messageId:i[0].message.id,type:"copy",serverThreadId:l,selectedText:c,source:t})})},deleteThread:e=>{g(r=>{delete r.threads[e],delete r.clientNewThreadIdToServerIdMapping[e]})},retainThread:e=>{g(r=>{r.threadRetainCounts[e]=(r.threadRetainCounts[e]??0)+1}),clearTimeout(L[e])},releaseThread:e=>{d().threads[e]!=null&&(g(t=>{t.threadRetainCounts[e]=Math.max((t.threadRetainCounts[e]??0)-1,0)}),!(d().threadRetainCounts[e]>0)&&(clearTimeout(L[e]),L[e]=setTimeout(()=>{d().threads[e]!=null&&(d().threadRetainCounts[e]>0||a.deleteThread(e))},3e4)))},setPromptGptRating:(e,r)=>{const t=a.resolveThreadId(e);g(s=>{const n=s.threads[t];n!=null&&(r==null?n.promptGptRating=void 0:n.promptGptRating={gizmoId:r})})}};async function De(e,r){const t=await F.getConversation(e);if(K.addTiming("chatgpt.web.chatPage.loadExistingConversation"),a.initThreadFromServerData(e,t,r,void 0,r),W.checkGate("187267097")===!0){const s=await X(()=>import("./sso-ipuhfmti911l5wbt.js").then(l=>l.F),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73])).then(l=>l).catch(()=>null),n=a.getServerThreadId(e),o=a.getTitle(e),i=a.getTree(e),c=a.getThreadCurrentLeafId(e);n&&(s==null||s.addConversation(n,o??"",i,c))}return t}const Pe=e=>u(t=>h.getThreadModelId(e,t))??de,fe=e=>u(r=>{if(e!=null)return M(e)?r.clientNewThreadIdToServerIdMapping[e]:e}),ze=e=>u(r=>{var s;const t=a.resolveThreadId(e);return((s=r.threads[t])==null?void 0:s.initialThreadData)??ve()}),Ae=(e,r)=>u(t=>{const s=h.getConversationMode(e,t);return r&&((s==null?void 0:s.kind)===v.GizmoInteraction||(s==null?void 0:s.kind)===v.PrimaryAssistant)?{gizmo_id:r,kind:v.GizmoInteraction}:s}),pe=e=>{const r=oe();return u(t=>t.threads[h.resolveThreadId(e,t)]==null?r:h.getGizmoId(e,t))},Oe=e=>!!pe(e),Ge=e=>u(r=>{var s;const t=a.resolveThreadId(e);return((s=r.threads[t])==null?void 0:s.isLoading)??!1}),Ce=e=>u(()=>a.getThreadCurrentLeafId(e)),Be=(e,r)=>{const t=m.useRef([]);return u(()=>{const s=a.getThreadConversationTurns(e,r,t.current);return t.current=s,(s==null?void 0:s.length)??0})},ke=(e,r)=>{const t=m.useRef([]);return u(()=>{const s=a.getThreadConversationTurns(e,r,t.current);return t.current=s,s})},qe=(e,r,t)=>{const s=m.useRef([]);return u(()=>{const n=a.getThreadConversationTurns(e,t,s.current);return s.current=n,r>=0&&r<n.length?n[r]:null})},He=(e,r)=>{const t=m.useRef([]);return u(()=>{const s=a.getThreadConversationTurns(e,r,t.current);return t.current=s,s.length>0?s[s.length-1]:null})},je=(e,r)=>{const t=m.useRef([]);return u(()=>{const s=a.getThreadConversationTurns(e,r,t.current);t.current=s;let n=0;for(let o=s.length-1;o>=0;o--){const i=s[o];if(i.messages.some(c=>{var l;return(l=c.message.metadata)==null?void 0:l.is_indepth_feedback}))return!0;if(i.messages.some(c=>c.message.author.role===f.Assistant)&&n++,n>=3)break}return!1})},$e=(e,r)=>u(()=>{const t=a.resolveThreadId(e);return a.getTree(t).getBranchFromLeaf(r).some(o=>o.message.author.role===f.User)}),Ke=e=>{const r=Ce(e);return m.useMemo(()=>{const t=a.getThreadConversationTurns(e,r,[]),s=(t==null?void 0:t.length)??0,n=(t==null?void 0:t[s-1])??null;return s===0?r:I.getRequestIdFromConversationTurn(n)},[r,e])},We=e=>u(()=>a.getTitle(e)),Xe=e=>Q(u,()=>a.getTitleAndSource(e),N),Qe=e=>u(()=>{var t;const r=a.resolveThreadId(e);return(t=d().threads[r])==null?void 0:t.continuingFromSharedConversationId}),Ve=e=>u(()=>{var t,s;const r=a.resolveThreadId(e);return(s=(t=d().threads[r])==null?void 0:t.sharedConversationMetadata)==null?void 0:s.authorName}),Ye=(e,r)=>u(()=>{const t=a.getTree(e).getNodeByIdOrMessageId(r);if(t==null)throw new Error(`useThreadTreeNode: cannot get tree node for ${r} in thread ${e}`);return t}),Ze=(e,r)=>u(()=>{var t;return((t=a.getTree(e))==null?void 0:t.getHasErrorFromNode(r))??!1}),Je=(e,r)=>u(()=>{var t;return((t=a.getTree(e))==null?void 0:t.isMessageIncomplete(r))??!1}),_e=(e,r)=>u(()=>{const t=a.getTree(e);return t==null?[]:t.getBranchFromLeaf(r).filter(s=>s.message.author.role!==f.Root)}),er=(e,r)=>_e(e,r).map(t=>t.message),rr=(e,r)=>u(()=>{const t=a.getTree(e);return t==null?null:t.getLeafFromNode(r)}),tr=(e,r)=>u(()=>{const t=a.getTree(e);return t==null?!1:r.map(n=>t.getLeafFromNode(n)).some(n=>t.getHasErrorFromNode(n.id))}),Se=e=>{var o,i;const t=a.getTree(e).getUserContext();if(t==null)return null;const{message:s}=t,n=((o=s.metadata)==null?void 0:o.shared_conversation_id)??null;if(((i=s.metadata)==null?void 0:i.user_context_message_data)!=null){const{about_user_message:c,about_model_message:l}=s.metadata.user_context_message_data;return{aboutUserMessage:(c==null?void 0:c.trim())??"",aboutModelMessage:(l==null?void 0:l.trim())??"",fallback:null,shareId:n}}return{aboutUserMessage:null,aboutModelMessage:null,fallback:x(s),shareId:n}},Le=e=>u(r=>{var s,n;const t=a.resolveThreadId(e);return(n=(s=r.threads[t])==null?void 0:s.sharedConversationMetadata)==null?void 0:n.hasUserEditableContextFlag}),sr=e=>!!a.getTree(e).findNode(t=>t.message.content.content_type==="model_editable_context"),nr=e=>{const r=Le(e);return Se(e)!=null||!!r},ar=e=>u(()=>{var t;const r=a.resolveThreadId(e);return((t=d().threads[r])==null?void 0:t.continuingFromSharedConversationId)!=null}),or=e=>u(()=>a.getThreadCurrentLeafId(e)==="root"),dr=e=>{const r=V(),t=fe(e);return t?r.query.convId&&r.query.convId===t?!0:Y(r.query.default)?r.query.default[0]==="c"&&r.query.default[1]===t:!1:!1},ur=e=>u(()=>{var t;const r=a.resolveThreadId(e);return(t=d().threads[r])==null?void 0:t.promptGptRating}),ir=(e,r)=>u(()=>{const t=a.resolveThreadId(e),n=a.getTree(t).getBranchFromLeaf(r);return ue(n,o=>o.message.author.role===f.System&&o.message.content.content_type==="system_content")}),lr=()=>m.useContext(j)!=null;function cr(e){var n;const r=a.getTree(e),t=a.getThreadCurrentLeafId(e);let s=r.getNodeByIdOrMessageId(t);for(;s;){const o=(n=s.message.metadata)==null?void 0:n.default_model_slug;if(o)return o;if(s.parentId)s=r.getNodeByIdOrMessageId(s.parentId);else return}}function hr({clientThreadId:e,role:r}){return a.getTree(e).countMessagesByAuthor(r)}function Tr({clientThreadId:e,conversationLeafId:r}){const t=a.getTree(e);return m.useMemo(()=>t.getNodeByIdOrMessageId(r).message.end_turn,[r,t])}function gr(e,r){const t=u(s=>h.getTurnContentReferences(e,s,r));return E(t)}const mr=e=>u(()=>{var t;const r=a.resolveThreadId(e);return(t=d().threads[r])==null?void 0:t.async_status}),vr=e=>u(()=>{var t;const r=a.resolveThreadId(e);return(t=d().threads[r])==null?void 0:t.update_time});export{xe as $,Xe as A,Ie as B,dr as C,Be as D,he as E,be as F,cr as G,ur as H,mr as I,Tr as J,Ze as K,Je as L,ar as M,rr as N,ir as O,je as P,qe as Q,tr as R,We as S,a as T,Ve as U,ze as V,Ue as W,$e as X,vr as Y,Qe as Z,hr as _,Ce as a,Fe as a0,Te as a1,ke as b,or as c,fe as d,pe as e,De as f,h as g,Pe as h,M as i,lr as j,u as k,Ee as l,ce as m,we as n,gr as o,Ne as p,Ae as q,nr as r,sr as s,Ye as t,Ke as u,er as v,_e as w,Oe as x,Ge as y,He as z};
