import{r as m,D as M,j as e,E as A,a2 as w,G as i,eC as F,aD as N,an as E,H as _,I as B,aH as Y,ba as q,az as X,c as T,ak as ae,C as G,S as te}from"./bi9nzlakut336dzw.js";import{a as ne,b as ie,A as le}from"./2xddkjn4hz36blze.js";import{u as V,c as D,d as oe,a as re}from"./n0dladuj475q76po.js";import{gv as g,aq as K,gw as k,gx as Q,gy as J,gz as ce,a0 as de,cx as ue,ap as ge,gA as me,cy as xe,gB as fe,gC as H,f as Z,cB as pe,c4 as he}from"./nbtnwh422004o6rf.js";import{c as je}from"./iej0cupg2dqkmejt.js";import{L as Me}from"./d3goopgee3uamlq3.js";import{B as be,D as P}from"./lp7c78wpenuxxb63.js";import{a2 as ve,be as ye,bz as Se,bA as Ne,x as we,u as Ce,F as Be}from"./o3o45rugqi7ysa5o.js";import{a as Ie,d as O,e as U,g as W,f as Pe,c as Le,A as Te}from"./kvwanq4el7mi0tqc.js";import{b as Ee}from"./kz8e4pvfrjvxpoyh.js";import"./mipkjwfuq2nvj5uu.js";import"./fjbnx45512mj7nhj.js";import"./mpyfda88bw5gnssr.js";import"./gh4isxlgg9ance0u.js";import"./ggx03yp89y9443op.js";import"./b4wxntsz852norkm.js";import"./is6wy6v1tf98yunn.js";import"./96zvt5ovgo7sipxv.js";import"./zxh2mubn0kkzr4sj.js";import"./n2ouojicq6zztbgb.js";import"./eayrk6lto17igacg.js";import"./l1wzfvxpzzx4auil.js";var C=(s=>(s.FLEXIBLE="month",s.ANNUAL="year",s))(C||{});const _e=je(C);function De({isOpen:s,onClose:n,initialTeamBillingType:t,renewalDate:a,accountId:c}){const[r,o]=m.useState(t),[l,u]=m.useState(!1),p=function(){u(!l)},[x,h]=m.useState(!1),b=Oe[r],f=M(),v=V(c),y=async()=>{h(!0);try{await v.mutateAsync({accountId:c,updatedPriceInterval:r==="month"?"month":"year",updatedSeats:void 0}),h(!1),w.success(f.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),u(!1),n()}catch{w.warning(f.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{h(!1)}};return e.jsx(A,{type:"success",isOpen:s,onClose:()=>{u(!1),o(t),n()},size:"custom",className:"max-w-xl",noPadding:!0,title:l?f.formatMessage({id:"teamBilling.changeBillingScheduleConfirmTitle",defaultMessage:"Confirm changes"}):f.formatMessage({id:"teamBilling.changeBillingScheduleTitle",defaultMessage:"Change billing schedule"}),showCloseButton:!0,children:l?e.jsx(ke,{selectedPlan:r,initialTeamBillingType:t,renewalDate:a,selectedPlanData:b,handleUpdate:y,isUpdating:x}):e.jsx(ze,{setSelectedPlan:o,selectedPlan:r,initialTeamBillingType:t,toggleConfirmPage:p,renewalDate:a})})}function ze({selectedPlan:s,setSelectedPlan:n,initialTeamBillingType:t,toggleConfirmPage:a,renewalDate:c}){const r=M();return e.jsxs("div",{children:[e.jsx("div",{className:"grid grid-flow-row grid-cols-2",children:e.jsxs(K,{className:"col-span-2 grid md:col-span-2 md:grid-cols-2",defaultValue:s,onValueChange:o=>{_e(o)&&n(o)},children:[e.jsx(k,{billingType:"month",...Q}),e.jsx(k,{billingType:"year",...J})]})}),e.jsx("hr",{}),e.jsxs("div",{className:"m-4 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-token-text-secondary",children:e.jsx(i,{...g.changeEffectDate,values:{date:e.jsx(F,{value:c,year:"numeric",month:"long",day:"numeric"})}})}),e.jsx(N,{title:r.formatMessage(g.continueToPricePreview),disabled:s===t,color:"primary",onClick:()=>{a()}})]})]})}function ke({initialTeamBillingType:s,selectedPlan:n,renewalDate:t,selectedPlanData:a,handleUpdate:c,isUpdating:r}){const o=M();return e.jsxs("div",{className:"p-4",children:[e.jsx("span",{className:"text-sm",children:e.jsx(i,{...g.confirmPageChangeEffectDate,values:{current_plan:s==="month"?"Flexible (monthly)":"Annual",new_plan:n==="month"?"Flexible (monthly)":"Annual",date:e.jsx(F,{value:t,year:"numeric",month:"long",day:"numeric"})}})}),e.jsxs("div",{className:"mt-4 flex flex-col bg-token-main-surface-secondary p-4",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{...a.name})}),e.jsx("span",{className:"text-sm",children:e.jsx(i,{...a.cost,values:{s:(...l)=>e.jsx(ce,{children:l})}})}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:e.jsx(i,{...a.structure})})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(N,{title:o.formatMessage(g.confirmChange),color:"primary",onClick:c,loading:r})})]})}const Oe={month:{name:g.flexiblePlanName,cost:g.flexiblePlanCost,structure:g.teamsCostStructure},year:{name:g.annualPlanName,cost:g.annualPlanCost,structure:g.teamsCostStructure}};function Ue({isOpen:s,onClose:n}){const t=M(),{data:a,isLoading:c}=D(),r=E(),o=oe(r==null?void 0:r.id),l=de(),[u,p]=m.useState(""),[x,h]=m.useState(!1),b=(l==null?void 0:l.email)&&u.toLowerCase()==l.email.toLowerCase(),[f,v]=m.useState(a&&!a.will_renew);if(c||!r||!a)return null;const y=async()=>{h(!0);try{await o.mutateAsync(r.id),v(!0)}catch{w.warning(t.formatMessage(j.errorCancellingSubscription),{hasCloseButton:!0})}finally{h(!1)}};return e.jsx(A,{type:"success",onClose:n,showCloseButton:!0,isOpen:s,className:"",title:e.jsx("span",{className:"text-lg",children:e.jsx(i,{...j.cancelPlan})}),children:f?e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:e.jsx(i,{...j.successfullyCanceled})}),a.active_until!=null&&e.jsx("p",{className:"text-sm text-token-text-primary",children:e.jsx(i,{...j.retainUntil,values:{expiryDate:new Date(a.active_until)}})}),e.jsx("div",{className:"mt-6 flex w-full flex-row justify-end",children:e.jsx(N,{title:t.formatMessage(j.doneButton),color:"primary",onClick:n,disabled:x})})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[e.jsxs("div",{className:"flex w-full items-center gap-4",children:[e.jsx(ue,{src:r.data.profilePictureUrl,size:"large"}),e.jsxs("div",{className:"flex-col",children:[e.jsx("p",{className:"font-semibold",children:r.data.name}),e.jsx("p",{className:"text-sm text-token-text-secondary",children:e.jsx(i,{...j.membersCount,values:{count:a.seats_entitled}})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:e.jsx(i,{...j.areYouSure})}),e.jsxs("ul",{className:"list-disc pl-5 text-sm text-token-text-secondary",children:[e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.dataUnavailable})}),a.active_until!=null&&e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.retainUntil,values:{expiryDate:new Date(a.active_until)}})}),e.jsx("li",{className:"my-2",children:e.jsx(i,{...j.retainEmailAccess})})]})]}),e.jsxs("div",{className:"w-full",children:[e.jsx("h3",{className:"mb-2 text-base font-semibold text-token-text-primary",children:e.jsx(i,{...j.enterEmailToConfirm})}),e.jsx(ge,{type:"text",name:"user-email",placeholder:"abcd@acme.com",onChange:S=>{p(S.target.value)}})]})]}),e.jsxs("div",{className:"mt-6 flex w-full flex-row justify-end",children:[e.jsx(N,{title:t.formatMessage(j.keepSubscriptionButton),onClick:n,disabled:x}),e.jsx(N,{title:t.formatMessage(j.cancelSubscriptionButton),onClick:y,disabled:!b,loading:x,color:"danger",className:"ml-2"})]})]})})}const j=_({dataUnavailable:{id:"cancelTeamPlanModal.dataUnavailable",defaultMessage:"All workspace data including chat history and settings will not be available."},cancelPlan:{id:"cancelTeamPlanModal.cancelPlan",defaultMessage:"Cancel subscription"},retainUntil:{id:"cancelTeamPlanModal.retainUntil",defaultMessage:"You will retain access to the workspace until the end of your billing cycle on {expiryDate, date, long}."},retainEmailAccess:{id:"cancelTeamPlanModal.retainEmailAccess",defaultMessage:"You will still be able to use ChatGPT with the other workspaces associated with this email address."},errorCancellingSubscription:{id:"cancelTeamPlanModal.errorCancellingSubscription",defaultMessage:"There was a problem cancelling your subscription."},areYouSure:{id:"cancelTeamPlanModal.areYouSure",defaultMessage:"Are you sure?"},enterEmailToConfirm:{id:"cancelTeamPlanModal.enterEmailToConfirm",defaultMessage:"Enter your Email address to confirm"},emailPlaceholder:{id:"cancelTeamPlanModal.emailPlaceholder",defaultMessage:"abcd@acme.com"},doneButton:{id:"cancelTeamPlanModal.doneButton",defaultMessage:"Done"},keepSubscriptionButton:{id:"cancelTeamPlanModal.keepSubscriptionButton",defaultMessage:"Keep subscription"},cancelSubscriptionButton:{id:"cancelTeamPlanModal.cancelSubscriptionButton",defaultMessage:"Cancel subscription"},successfullyCanceled:{id:"cancelTeamPlanModal.successfullyCanceled",defaultMessage:"You have successfully canceled your subscription."},membersCount:{id:"yourComponent.membersCount",defaultMessage:"{count, plural, one {# member} other {# members}}"}}),Ae=25*12,Fe=30,Re=B.p`text-base font-semibold mb-3 mt-3`;function $e({isOpen:s,onClose:n,initialTeamBillingType:t,initialSeats:a,accountId:c,renewalDate:r}){const o=M(),[l,u]=m.useState(a),[p,x]=m.useState(!1),h=function(){x(!p)},[b,f]=m.useState(!1),v=Ye[t],y=t==="month"?Q:J,S=V(c),I=async()=>{f(!0);try{await S.mutateAsync({accountId:c,updatedPriceInterval:void 0,updatedSeats:l}),f(!1),w.success(o.formatMessage({id:"teamBilling.successfullyUpdatedSubscription",defaultMessage:"Your subscription was updated successfully"}),{hasCloseButton:!0}),x(!1),n()}catch{w.warning(o.formatMessage({id:"teamBilling.errorUpdatingSubscription",defaultMessage:"There was a problem updating your subscription"}),{hasCloseButton:!0})}finally{f(!1)}};return e.jsx(A,{type:"success",isOpen:s,onClose:()=>{x(!1),u(a),n()},size:"custom",noPadding:!0,className:"max-w-xl",showCloseButton:!0,title:p?o.formatMessage({id:"teamsManageSeatsModal.title",defaultMessage:"Manage seats"}):o.formatMessage({id:"teamsManageSeatsModalConfirmPage.title",defaultMessage:"Review"}),children:p?e.jsx(We,{numSeats:l,initialSeats:a,handleUpdate:I,isUpdating:b,renewalDate:r,accountId:c}):e.jsx(He,{initialTeamBillingType:t,selectedPlanBillingInfo:y,numSeats:l,initialSeats:a,setNumSeats:u,selectedPlanData:v,toggleConfirmPage:h})})}function He({initialTeamBillingType:s,selectedPlanBillingInfo:n,numSeats:t,initialSeats:a,setNumSeats:c,selectedPlanData:r,toggleConfirmPage:o}){const l=M();return e.jsxs("div",{className:"grid grid-flow-row grid-cols-2",children:[e.jsx(K,{className:"col-span-2 grid md:col-span-1 md:grid-cols-1",defaultValue:s,children:e.jsx(k,{billingType:s,...n})}),e.jsxs("div",{className:"col-span-3 overflow-hidden border-l border-token-main-surface-tertiary bg-token-main-surface-secondary p-6 md:col-span-1",children:[e.jsx("label",{className:"mb-3 block text-base font-semibold",htmlFor:"seats",children:e.jsx(i,{...g.seatsTitle})}),e.jsx(me,{numSeats:t,minSeats:a,setNumSeats:c}),e.jsx(xe,{}),e.jsx(Re,{children:e.jsx(i,{...g.summaryTitle})}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"mb-2",children:e.jsx(i,{...r.name})}),e.jsxs(fe,{children:[e.jsx(H,{children:e.jsx(i,{...r.billed})}),e.jsx(H,{children:e.jsx("b",{children:e.jsx(i,{...r.total,values:{totalCost:(t||0)*(s==="year"?Ae:Fe)}})})})]})]})]}),e.jsx("hr",{}),e.jsx("div",{className:"m-4 flex justify-end",children:e.jsx(N,{title:l.formatMessage({id:"teamsManageSeatsModal.continue",defaultMessage:"Continue"}),disabled:t===a,onClick:()=>{o()},color:"primary"})})]})}function We({numSeats:s,initialSeats:n,renewalDate:t,handleUpdate:a,isUpdating:c,accountId:r}){const o=M(),{data:l,isError:u,isLoading:p}=re(r,s);if(p)return e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(Y,{})});if(!(u||!l))return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.additionalSeats",defaultMessage:"{additionalSeats} additional seats",values:{additionalSeats:s-n}})}),e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.additionalSeatsTotal",defaultMessage:"${totalCost}",values:{totalCost:(l.total_amount/100).toFixed(2)}})})]}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:e.jsx(i,{id:"teamsManageSeatsModal.proratedAmountMessage",defaultMessage:"Prorated amount until next billing cycle"})}),e.jsx("span",{className:"mt-4 flex flex-col bg-token-main-surface-secondary p-4 text-sm text-token-text-secondary",children:e.jsx(i,{id:"teamsManageSeatsModal.chargeMessage",defaultMessage:"You will be charged for {numSeats} total seats at your next renewal on {date}",values:{numSeats:s,date:e.jsx(F,{value:t,year:"numeric",month:"long",day:"numeric"})}})}),e.jsx("hr",{className:"mt-4"}),e.jsxs("div",{className:"mt-4 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.subTotal",defaultMessage:"Subtotal"})}),e.jsx("span",{children:e.jsx(i,{id:"teamsManageSeatsModal.subtotalPrice",defaultMessage:"${totalCost}",values:{totalCost:(l.amount_excluding_tax/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.tax",defaultMessage:"Tax"})}),e.jsx("span",{children:e.jsx(i,{id:"teamsManageSeatsModal.taxAmount",defaultMessage:"${tax}",values:{tax:(l.tax_amount/100).toFixed(2)}})})]}),e.jsxs("div",{className:"mt-2 flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.totalDueToday",defaultMessage:"Total due today"})}),e.jsx("span",{className:"font-semibold",children:e.jsx(i,{id:"teamsManageSeatsModal.totalDueTodayAmount",defaultMessage:"${totalCost}",values:{totalCost:(l.total_amount/100).toFixed(2)}})})]}),e.jsx("hr",{className:"mt-4"}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(N,{title:o.formatMessage({id:"teamsManageSeatsModal.payNow",defaultMessage:"Pay now"}),color:"primary",onClick:a,loading:c})})]})}const Ye={month:{name:g.flexiblePlanSelected,billed:{id:"teamManageSeatsModal.flexiblePlanBilled",defaultMessage:"Price billed monthly",description:"Summary billing of selected plan"},total:g.flexiblePlanTotal},year:{name:g.annualPlanSelected,billed:{id:"teamManageSeatsModal.flexiblePlanBilled",defaultMessage:"Price billed annually",description:"Summary billing of selected plan"},total:g.annualPlanTotal}};function qe({numInUse:s,numAllocated:n,isTeam:t,subscriptionWillRenew:a,subscriptionBillingPeriod:c,accountId:r,subscriptionRenewalDate:o}){var v;const u=Math.max(n,s)>10?Xe:Qe,p=(v=X("3954884439"))==null?void 0:v.value,[x,h]=m.useState(!1),b=function(){h(!x)},f=c==="monthly"?C.FLEXIBLE:C.ANNUAL;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"mt-1 text-left text-sm",children:e.jsx(i,{...$.description,values:{num:`${s}/${n}`}})}),t&&a&&p&&e.jsx(q,{color:"secondary",className:"text-right",onClick:b,children:e.jsx(i,{id:"components.business.NumSeats.manageSeats",defaultMessage:"Manage seats"})}),e.jsx($e,{isOpen:x,onClose:b,initialTeamBillingType:f,initialSeats:n,accountId:r,renewalDate:o})]}),e.jsx(u,{numInUse:s,numAllocated:n})]})}function Xe({numAllocated:s,numInUse:n}){const t=M(),a=n>s,c=a?100:n/s*100,r=a?s/n*100:100;return e.jsx("div",{className:T("relative w-full rounded-full",a?"bg-orange-500":"bg-token-main-surface-primary"),children:e.jsxs("div",{className:"relative h-4",style:{width:`${r}%`},children:[e.jsx("div",{className:T("h-4 overflow-hidden rounded-l-full bg-green-600",n===s&&"rounded-r-full"),style:{width:`${c}%`}}),n!==s&&a&&e.jsx("div",{className:"absolute right-0 top-[-3px] bg-token-main-surface-primary",children:e.jsx(Z,{label:t.formatMessage($.dividerTooltip,{count:s}),children:e.jsx(ee,{className:"px-1 py-0.5"})})})]})})}const ee=({className:s})=>e.jsxs("div",{className:T("flex flex-col gap-0.5",s),children:[e.jsx(L,{}),e.jsx(L,{}),e.jsx(L,{}),e.jsx(L,{})]}),R=B.div`h-4 w-4 rounded-full`,Ge=B(R)`bg-green-600`,Ve=B(R)`bg-token-main-surface-tertiary`,Ke=B(R)`bg-orange-500`,L=B.span`w-[3px] h-[3px] bg-gray-400 dark:bg-gray-500 rounded-full`;function Qe({numAllocated:s,numInUse:n}){const t=M(),a=n>s,c=m.useMemo(()=>Array.from(Array(a?n:s).keys()),[a,s,n]);return e.jsx("div",{className:"flex items-center gap-2",children:c.map(r=>{let o=Ke,l=null;return r<n&&!a?o=Ge:r<s&&!a&&(o=Ve),r===s-1&&(l=e.jsx(Z,{label:t.formatMessage($.dividerTooltip,{count:s}),children:e.jsx(ee,{})})),e.jsxs(e.Fragment,{children:[e.jsx(o,{},r),l]})})})}const $=_({dividerTooltip:{defaultMessage:"Your team has {count, plural, =0 {no seats} one {# seat} other {# seats}} purchased",id:"components.business.NumSeats.dividerTooltip"},description:{defaultMessage:"{num} seats in use",id:"components.business.NumSeats.description"}});function Je(s,n){const t=M();return ae({queryKey:["organization-invoices",{...s,options:n}],queryFn:async()=>await G.getInvoices(s,n).catch(a=>{throw w.danger(t.formatMessage(es.invoicesLoadError,{error:a.message})),a}),enabled:"account_id"in s||"organization_id"in s})}function Ze(s){const n=E(),t=n==null?void 0:n.id,a=(n==null?void 0:n.data.organizationId)??void 0,c=n==null?void 0:n.isEnterprisey();return Je(c?{organization_id:a}:{account_id:t},s)}const es=_({invoicesLoadError:{id:"organizationBillingInfo.invoicesLoadError.0",defaultMessage:"Failed to load invoices. Contact support@openai.com if error persists."}});function ss(){const{data:s,isLoading:n,isError:t}=D(),a=E(),[c,r]=m.useState(!1),o=function(){r(!c)};if(n)return e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx(Y,{})});if(t||!s||!a)return null;const l=s.active_until!=null,u=(s==null?void 0:s.seats_in_use)>(s==null?void 0:s.seats_entitled);return e.jsx(e.Fragment,{children:e.jsxs(O,{children:[e.jsx(U,{children:e.jsx(i,{...d.planTitle})}),e.jsx("hr",{}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(W,{children:a!=null&&a.isEnterprise()?l?e.jsx(i,{...d.activeEnterpriseLicense}):a!=null&&a.isResellerHosted()?e.jsx(i,{...d.resellerHostedEnterpriseLicense}):e.jsx(i,{...d.pendingEnterpriseLicense}):a!=null&&a.isEdu()?l?e.jsx(i,{...d.activeEduLicense}):a!=null&&a.isResellerHosted()?e.jsx(i,{...d.resellerHostedEduLicense}):e.jsx(i,{...d.pendingEduLicense}):l?s.non_profit_org_discount_applied?e.jsx(i,{...d.activeTeamLicenseNonProfitOrg}):e.jsx(i,{...d.activeTeamLicense}):e.jsx(i,{...d.pendingTeamLicense})}),s.active_until!=null&&e.jsx(Pe,{className:"mt-1",children:a!=null&&a.isEnterprisey()?e.jsx(i,{...d.licenseExpiry,values:{expiryDate:new Date(s.active_until)}}):s.will_renew?e.jsx(i,{...d.renewalDate,values:{expiryDate:new Date(s.active_until)}}):e.jsx(i,{...d.deactivateDate,values:{expiryDate:new Date(s.active_until)}})})]}),e.jsx(as,{isOpen:c,onDropdownOpen:o})]}),e.jsx("hr",{}),l&&e.jsxs("div",{children:[e.jsx(W,{children:e.jsx(i,{...d.seatsTitle})}),e.jsx(is,{isTeam:(a==null?void 0:a.isTeam())??!1,accountId:a.id}),(a==null?void 0:a.isTeam())&&u&&e.jsxs("span",{className:"text-sm text-token-text-secondary",children:[e.jsx(i,{...d.teamsAutochargeMessage}),e.jsx(Me,{className:"pl-1",openNewTab:!0,href:"https://help.openai.com/en/articles/8792536-manage-billing-on-the-chatgpt-team-subscription-plan",children:e.jsx(i,{...d.billingLearnMore})})]})]}),e.jsx("hr",{})]})})}function as({isOpen:s,onDropdownOpen:n}){var I;const[t,a]=m.useState(!1),c=te(),r=M(),o=E(),{data:l}=D(),[u,p]=m.useState(!1),x=function(){p(!u)},[h,b]=m.useState(!1),f=function(){b(!h)},v=(I=X("1318146997"))==null?void 0:I.value;if(!o||!o.isTeam()||!l)return;const y=async()=>{a(!0);try{const z=await G.fetchCustomerPortalUrl(o==null?void 0:o.getWorkspaceId());c.push(z.url)}catch{w.warning(r.formatMessage(d.stripeErrorWarning),{hasCloseButton:!0})}finally{a(!1)}},S=(l==null?void 0:l.billing_period)==="monthly"?C.FLEXIBLE:C.ANNUAL;return e.jsxs(be,{open:s,size:"default",triggerButton:e.jsx(q,{color:"secondary",onClick:n,icon:ve,children:e.jsx(i,{...d.manageLicenseBtn})}),children:[e.jsx(P.Item,{icon:ye,onClick:y,children:e.jsx(i,{...d.managePaymentMethod})}),l.will_renew&&v&&e.jsx(P.Item,{icon:Se,onClick:()=>{f()},children:e.jsx(i,{...d.manageBillingSchedule})}),l.active_until!=null&&e.jsx(De,{isOpen:h,onClose:f,initialTeamBillingType:S,renewalDate:new Date(l.active_until),accountId:o.id}),(l==null?void 0:l.will_renew)&&e.jsx(P.Separator,{}),(l==null?void 0:l.will_renew)&&e.jsx(P.Item,{icon:Ne,color:"danger",onClick:()=>{x()},children:e.jsx(i,{...d.cancelSubscriptionBtn})}),e.jsx(Ue,{isOpen:u,onClose:x})]})}function ts({invoice:s}){const n=(s==null?void 0:s.status_transitions.paid_at)!=null&&new Date(s.status_transitions.paid_at*1e3),t=s&&new Date(s.due_date*1e3),a=s&&new Date(s.created*1e3);return e.jsxs(Te,{className:"items-center",children:[e.jsxs("div",{className:"flex grow flex-col gap-1",children:[e.jsx("span",{children:a?e.jsx(i,{...d.invoiceName,values:{createdDate:a}}):e.jsx(i,{...d.defaultInvoiceName})}),s!=null&&s.paid&&n!=null?e.jsx("div",{className:"text-xs text-token-text-secondary",children:e.jsx(i,{...d.paidInvoice,values:{invoiceDate:n}})}):s&&e.jsx("div",{className:"text-xs text-green-600",children:e.jsx(i,{...d.upcomingInvoice,values:{invoiceDate:t}})})]}),e.jsx("a",{href:s==null?void 0:s.hosted_invoice_url,className:T("mx-auto",(s==null?void 0:s.hosted_invoice_url)==null&&"cursor-not-allowed opacity-20"),target:"_blank",rel:"noreferrer",children:e.jsx(Be,{className:"icon-sm text-green-600"})})]})}function ns(){const[s,n]=m.useState({limit:5}),{data:t,isError:a}=Ze(s),c=s.startingAfter!=null||s.endingBefore!=null&&(t==null?void 0:t.has_more),r=s.endingBefore!=null||(t==null?void 0:t.has_more)&&s.endingBefore==null;return a||t==null?e.jsxs(O,{children:[e.jsx(U,{children:e.jsx(i,{...d.invoicesTitle})}),e.jsx(he,{children:e.jsx(i,{...d.noInvoices})})]}):e.jsxs(O,{children:[e.jsx(U,{children:e.jsx(i,{...d.invoicesTitle})}),e.jsx(Le,{children:t.data.map(o=>e.jsx(ts,{invoice:o},o.id))}),e.jsxs("div",{className:"flex",children:[c&&e.jsx("button",{onClick:()=>{t&&n(o=>({...o,endingBefore:t.data[0].id,startingAfter:void 0}))},children:e.jsx(we,{className:"icon-sm"})}),e.jsx("div",{className:"flex-grow"}),r&&e.jsx("button",{onClick:()=>{t&&n(o=>({...o,startingAfter:t.data[t.data.length-1].id,endingBefore:void 0}))},children:e.jsx(Ce,{className:"icon-sm"})})]})]})}function is({isTeam:s,accountId:n}){const{data:t,isLoading:a,isError:c}=D();return c||!t||a||!t.billing_period||!t.active_until?null:e.jsx(qe,{numInUse:t.seats_in_use,numAllocated:t.seats_entitled,isTeam:s,subscriptionWillRenew:t.will_renew,subscriptionBillingPeriod:t.billing_period,subscriptionRenewalDate:new Date(t.active_until),accountId:n})}function ls(){const s=pe(a=>a.currentWorkspace),n=s==null?void 0:s.organizationId,t=M();return n===void 0?null:e.jsxs(e.Fragment,{children:[e.jsx(ne,{title:t.formatMessage(d.title),subtitle:t.formatMessage(d.subtitle)}),e.jsx(ie,{children:e.jsxs(Ie,{children:[e.jsx(ss,{}),e.jsx(ns,{})]})})]})}const d=_({title:{id:"organizationBillingInfo.title.1",defaultMessage:"Billing"},subtitle:{id:"organizationBillingInfo.subtitle",defaultMessage:"Only workspace owners can view and change these settings"},planTitle:{id:"organizationBillingInfo.planTitle",defaultMessage:"Plan"},activeEnterpriseLicense:{id:"organizationBillingInfo.activeEnterpriseLicense",defaultMessage:"Enterprise License"},pendingEnterpriseLicense:{id:"organizationBillingInfo.pendingEnterpriseLicense",defaultMessage:"Enterprise License (pending activation)"},resellerHostedEnterpriseLicense:{id:"organizationBillingInfo.resellerHostedEnterpriseLicense",defaultMessage:"Enterprise License"},activeEduLicense:{id:"organizationBillingInfo.activeEduLicense",defaultMessage:"Edu License"},pendingEduLicense:{id:"organizationBillingInfo.pendingEduLicense",defaultMessage:"Edu License (pending activation)"},resellerHostedEduLicense:{id:"organizationBillingInfo.resellerHostedEduLicense",defaultMessage:"Edu License"},activeTeamLicense:{id:"organizationBillingInfo.activeTeamLicense",defaultMessage:"Team License"},activeTeamLicenseNonProfitOrg:{id:"organizationBillingInfo.activeTeamLicenseNonProfitOrg",defaultMessage:"Team License (Non Profit Discount)"},pendingTeamLicense:{id:"organizationBillingInfo.pendingTeamLicense",defaultMessage:"Team License (pending activation)"},licenseExpiry:{id:"organizationBillingInfo.licenseExpiry",defaultMessage:"Active until {expiryDate, date, long}"},renewalDate:{id:"organizationBillingInfo.renewalDate",defaultMessage:"Renews on {expiryDate, date, long}"},deactivateDate:{id:"organizationBillingInfo.deactivateDate",defaultMessage:"Deactivates on {expiryDate, date, long}"},seatsTitle:{id:"organizationBillingInfo.seatsTitle",defaultMessage:"Seats"},seatsInUse:{id:"organizationBillingInfo.seatsInUse",defaultMessage:"{numSeats} in use ({numSeatsPct})"},invoicesTitle:{id:"organizationBillingInfo.invoicesTitle",defaultMessage:"Invoices"},invoiceName:{id:"organizationBillingInfo.invoiceName",defaultMessage:"Invoice: {createdDate, date, long}"},defaultInvoiceName:{id:"organizationBillingInfo.defaultInvoiceName",defaultMessage:"Invoice"},paidInvoice:{id:"organizationBillingInfo.paidInvoice",defaultMessage:"Paid: {invoiceDate, date, long}"},upcomingInvoice:{id:"organizationBillingInfo.upcomingInvoice",defaultMessage:"Due: {invoiceDate, date, long}"},noInvoices:{id:"organizationBillingInfo.noInvoices",defaultMessage:"No invoices found"},manageSubscription:{id:"organizationBillingInfo.manageSubscription",defaultMessage:"Manage subscription"},cancelSubscriptionBtn:{id:"organizationBillingInfo.cancelSubscriptionBtn",defaultMessage:"Cancel subscription"},manageLicenseBtn:{id:"organizationBillingInfo.manageLicenseBtn",defaultMessage:"Manage license"},managePaymentMethod:{id:"organizationBillingInfo.managePaymentMethod",defaultMessage:"Payment method"},manageBillingSchedule:{id:"organizationBillingInfo.manageSchedule",defaultMessage:"Billing schedule"},stripeErrorWarning:{id:"organizationBillingInfo.stripeErrorWarning",defaultMessage:"Error loading account information"},teamsAutochargeMessage:{id:"organizationBillingInfo.teamsAutochargeMessage",defaultMessage:"Your additional seats will be included on your next invoice."},billingLearnMore:{id:"organizationBillingInfo.billingLearnMore",defaultMessage:"Learn more"}});function se(){return e.jsx(ls,{})}se.getLayout=function(n){return e.jsx(le,{mobilePageTitle:"Billing",requireOwnerPrivileges:!0,children:n})};function Ps(){return Ee(),e.jsx(se,{})}export{Ps as default};
//# sourceMappingURL=itsqcqpikwk3ok9r.js.map
