const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/npfyr73w0aiuwelb.js","assets/l0y3ohwtclivvm2c.js","assets/hlxnsx6oewki3363.js","assets/root-i54zhw2b.css","assets/mnrm0vxrr7wj2ofp.js","assets/byhneqjvgrp2wksn.js","assets/conversation-small-ict01xsi.css","assets/jgxjcjzjvn8n6j7w.js","assets/idcmjesz3h4wdd3f.js","assets/kckd67fs1yuyfnit.js","assets/irwcu3i0f2zc5m7n.js","assets/h6ogf8x2srso8mjj.js","assets/n7za6i719heatv1n.js","assets/eyld76o7m1iv3ab4.js","assets/fy218sx4amjbrc2b.js","assets/heg73vykyp3fhxma.js","assets/is-scrollable-element-i34sjb0l.css","assets/hjlvsjte8635173i.js","assets/g85fadqrovtkvnqw.js","assets/l5io3dwebnnx86tm.js","assets/code-composer-ne11stli.css","assets/fz1c7t3ptt8ofn4x.js","assets/kfce1md8jiye43bw.js","assets/guko2qhmopteakej.js","assets/dpsz77l4v268i3zj.js","assets/b5hkc0ubysf1c2r8.js","assets/gwloio0auxq2bd5t.js","assets/jahjpkl93bjg2g0i.js","assets/omky5cv8xouhuslc.js","assets/ikuzupogs9hp4dgk.js","assets/document-composer-ofhzvcxp.css","assets/iuhrx6mg037mehxb.js","assets/j8udthtlcxgxcay0.js","assets/d3y72ugnrmac5z1v.js","assets/eou1h4ug7p48v3wu.js","assets/e9lafxuzyeh4418f.js","assets/10qi9mxnujoichzd.js","assets/j5w4166bn3c02o6l.js","assets/sso-cxr17vc8x3qd9ws9.js","assets/l37g0orptmf17xpe.js","assets/nnx914gxwnerwxe9.js","assets/nxb9mdpcdhw5iiq3.js","assets/nmf6ngnnyd0g985i.js","assets/kgh2hrqfkt0eonys.js","assets/itghwucfyv5ciib7.js","assets/fwbvo36n2uwfj6ne.js","assets/gdehac325n3c741w.js","assets/igtv85qdz0mfz8ab.js","assets/983a0dy92b3ronpv.js","assets/bovmn8ulfhug2lez.js","assets/kqwdyvkaaavvn8k3.js","assets/k3cywdtxvm23n1jb.js","assets/na8j00wtokkh88c0.js","assets/g2dj6ks0n1e373lt.js","assets/jv1x03vs6wnk1xhh.js","assets/j34hknlm93kae15x.js","assets/ceb9ps3s2nzxuztq.js","assets/c34tm6iyc8x7gj4j.js","assets/hz7h3eu59mm4vsbd.js","assets/iej0cupg2dqkmejt.js","assets/l5kf3k1jriyhqmdx.js","assets/ek0hjadgpcswazix.js","assets/jk8w36bsokizpx57.js","assets/gxfvcoryd2kvna4w.js"])))=>i.map(i=>d[i]);
import{a6 as t,ar as A,aw as re,r as u,aj as q,aY as ee,ak as _e,aE as ve,aF as be,fJ as ks,aO as Cs,d as G,g0 as Ms,g1 as ws,aG as T,c4 as Es,D as Is,fX as Ts,fY as _s,bU as Ns,g2 as As,at as ne,g3 as Be,bD as ae,bE as Rs,g4 as Ps,cR as Fs,j as Tt,bG as Ne,a3 as le,a7 as _t,cw as Ds,cu as Os,b8 as D,b0 as Ce,dJ as Nt,P as V,S as Me,ck as At,Z as Ze,aZ as Rt,R as dt,K as Pt,aB as et,an as Ft,bJ as Bs,I as Ls,a8 as Ws,dA as $s,bs as we,a2 as Us,dE as Hs,w as Vs,a9 as Gs,a5 as qs,aK as Qe,fD as zs}from"./l0y3ohwtclivvm2c.js";import{jF as Qs,bp as Ks,jW as Ys,jX as Xs,jx as Js,jY as Zs,bH as Ae,jG as Dt,jE as en,jZ as tn,j_ as mt,fZ as sn,fY as nn,j$ as an,fF as on,k0 as rn,k1 as Ot,k2 as ln,jH as ft,Z as cn,jk as Bt,k3 as un,jU as dn,fO as mn,k4 as fn,k5 as gn,k6 as xn,k7 as pn,k8 as hn,fQ as vn,jV as bn,fI as yn,k9 as jn,hy as Sn,hz as kn,gm as Cn,hH as Mn,iC as Lt,ka as Wt,kb as wn,kc as gt,fJ as Ke,kd as En,ke as In,kf as Tn,kg as _n,kh as Nn,ki as An,kj as Rn,kk as Pn,kl as Fn,km as Dn,U as X,ju as On,jr as Le,kn as We,ko as Bn,kp as Ln,kq as Wn,jq as $n,kr as Un,hX as Hn,jw as Vn,ks as Gn,kt as qn,jt as zn,hL as $e,bl as Qn,ku as Kn,kv as Yn,kw as Se,kx as Xn,ky as $t,kz as Ue,kA as Jn,kB as Zn,aH as oe,kC as ea,kD as ta,kE as sa,aj as L,kF as Ut,ac as xt,ad as ie,ae as Re,ao as na,aP as aa,aQ as oa,ar as ra,as as Ht,at as Ee,au as ce,aG as la,aR as B,kG as $,aS as ia,av as ca,aw as ua,ax as da,az as Vt,ay as ma,ag as fa,aD as ga,aE as xa,aI as pa,aJ as ha,kH as va,kI as ba,kJ as ya,kK as ja,aL as pt,kL as Gt,aM as Sa,aF as ka,aO as Ca,kM as Ma,kN as wa,kO as Ea,kP as qt,kQ as Ia,kR as Ta,kS as He,kT as _a,e$ as Na,aY as ye,m as tt,c3 as st,c as Aa,iU as nt,cG as zt,c4 as Ra,c5 as ht,p as Qt,kU as Kt,kV as Yt,kW as Xt,kX as Jt,kY as Pa,aa as Zt,cS as Fa,kZ as Da,q as es,k_ as ts,k$ as Oa,l0 as Ba,ix as La,a as ss,e as Wa,C as Ye,l1 as vt,T as $a,l2 as Ua,l3 as Ha,l4 as Va,A as Ga,l5 as qa,de as za,l6 as Qa,l7 as Ka,v as Y,l8 as Ya,bX as Xa,l9 as Ja,la as Za,lb as eo,lc as to,ld as so,le as no,a8 as ao,iB as oo,lf as ro,cl as lo,dJ as io,cV as co,fs as uo,i8 as mo,lg as fo,jm as go,lh as xo,bQ as ns,eK as as,n as po,o as ho,b1 as vo,dd as bo,li as yo,lj as bt,c1 as yt,lk as jo}from"./byhneqjvgrp2wksn.js";import{T as So,b as ko,g as Co,bW as Mo,d as wo,ag as Eo,s as Io,L as To,Z as _o,r as No,b7 as os,bw as rs,bC as ls,bX as is,G as Ao,aF as cs,bs as Ro,aE as us,bt as Po,a3 as Fo,bx as Do,bG as Oo,ax as Bo,Y as ds,bd as Ve}from"./hlxnsx6oewki3363.js";import{B as Lo,T as Wo,I as $o}from"./g85fadqrovtkvnqw.js";import{P as Ie}from"./l5io3dwebnnx86tm.js";import{m as Te}from"./idcmjesz3h4wdd3f.js";function Uo({className:e,zIndexKey:s,onClick:n}){return t.jsx(Te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:A("absolute inset-0",e,Qs[s]),onClick:n})}function Ho({zIndexKey:e,onClick:s}){return t.jsx(Uo,{zIndexKey:e,onClick:s,className:"bg-gray-50/50 dark:bg-black/50"})}const Vo=({onScroll:e})=>(Ys(({scrollTop:s})=>{e?.(s)}),null),Go=({shouldScrollToTop:e})=>{const s=Xs();return u.useEffect(()=>{e===!0&&s({behavior:"smooth"})},[e,s]),null},qo=()=>{const e=Js();u.useEffect(()=>{e({behavior:"smooth"})},[e]);const[s]=Zs();return s?null:t.jsx("button",{onClick:()=>e({behavior:"smooth"}),className:"absolute bottom-5 right-1/2 z-10 flex h-8 w-8 translate-x-1/2 cursor-pointer items-center justify-center rounded-full border border-token-border-light bg-token-main-surface-primary bg-clip-padding text-token-text-secondary",children:t.jsx(So,{className:"icon-md text-token-text-primary"})})},zo=re.section`w-full h-full flex flex-col popover bg-token-main-surface-primary`,Qo=({children:e,onScroll:s,shouldScrollToTop:n,scrollToBottomMode:a="top",isLoading:o=!1},r)=>t.jsxs("main",{className:"relative flex min-h-0 flex-auto flex-grow flex-col",ref:r,children:[t.jsx(Ks,{children:o&&t.jsx(Ho,{zIndexKey:"textdocDiffLoadingOverlay"})}),t.jsxs(Lo,{followButtonClassName:"hidden",initialScrollBehavior:"auto",className:"h-full",mode:a,children:[e,a==="bottom"&&t.jsx(qo,{}),t.jsx(Vo,{onScroll:s}),t.jsx(Go,{shouldScrollToTop:n})]})]}),Ko=u.forwardRef(Qo),Yo=re.header`flex items-center justify-between p-3 h-14`,Xo=re.h2`ml-2.5 text-base text-lg text-gray-700 dark:text-token-text-secondary truncate`,Jo=({onClick:e})=>{const s=q();return t.jsx(ee,{label:s.formatMessage(Zo.close),children:t.jsx(Ae,{icon:ko,onClick:e})})},de=({children:e})=>t.jsx(zo,{children:e});de.Title=Xo;de.CloseButton=Jo;de.Header=Yo;de.Content=Ko;const Zo=_e({close:{id:"Bix/Kd",defaultMessage:"Close"}}),er=ve(()=>be(()=>import("./npfyr73w0aiuwelb.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])).then(e=>e.CodeComposer),{loading:()=>t.jsx("div",{className:Dt.code,children:t.jsx("div",{className:"h-full w-full px-4",children:t.jsx(Ie,{lines:20})})})}),tr=e=>t.jsx(er,{...e}),ms=()=>{const[{width:e},s]=en(),n=e>=mt+sn?mt:nn;return t.jsx("div",{className:A(Dt.document,"mt-4"),ref:s,style:{margin:`0 ${tn}px`},children:t.jsx("div",{style:{width:n},children:t.jsx(Ie,{lines:20})})})},sr=ve(()=>be(()=>import("./fz1c7t3ptt8ofn4x.js"),__vite__mapDeps([21,1,2,3,11,5,6,10,4,7,8,12,13,14,15,16,22,23,24,25,26,27,28,29,18,19,30])).then(e=>e.DocumentComposer),{loading:ms}),nr=e=>t.jsx(sr,{...e}),ar=({onScroll:e,textdocId:s})=>{const n=an(s),{windowWidth:a}=ks(d=>d,{windowWidth:0,windowHeight:0});if(!n)return null;const{versions:o}=n,r=on(o),l=rn(r);let i=null;switch(r?.type){case Bt.DOCUMENT:i=t.jsx(nr,{value:r.content,comments:[],isRequestActive:l,isPreview:!0,isDisabled:!0,hideAccelerators:!0,commentsMode:ft.ALL_HIDDEN,hideToolbar:!0,hideEditOverlay:!0,width:a,modelCursor:r.modelCursor});break;default:r&&Ot(r.type)&&(i=t.jsx(tr,{id:"codemirror",currentlyStreamingLineIndex:null,language:ln(r.type),value:r.content,commentsMode:ft.ALL_HIDDEN,hideToolbar:!0,hideAccelerators:!0,comments:[],readonlyReason:cn.Streaming,isRequestActive:l}))}return t.jsx(de,{children:t.jsx(de.Content,{onScroll:e,children:i})})},or=u.memo(ar);function rr(e,s){switch(e){case"presentation":return t.jsx(hn,{});case"table":return t.jsx(pn,{});case"chart":return t.jsx(xn,{});case Bt.DOCUMENT:return t.jsx(Co,{className:A("icon-md",{"text-token-text-primary":s,"text-token-text-tertiary":!s})});default:return Ot(e)?t.jsx(fn,{className:A("icon-md",{"text-token-text-primary":s,"text-token-text-tertiary":!s})}):t.jsx(gn,{})}}const lr=({isHovered:e=!1})=>{const s=q();return t.jsx(ee,{label:s.formatMessage({id:"KMbgyZ",defaultMessage:"Open in canvas"}),children:t.jsx(Te.div,{role:"button",animate:{opacity:e?1:.64},whileHover:{opacity:1},transition:{type:"tween",duration:.18},className:"text-token-text-secondary transition-colors",children:t.jsx(Mo,{className:"icon-md"})})})},ir=({isCanvasOpen:e,isFocused:s,isHovered:n,isInlinePreview:a,size:o})=>e?s?"0px 2px 6px 0px rgba(0, 0, 0, 0.06)":"0px 2px 6px 0px rgba(0, 0, 0, 0)":a?n||s?`0px ${o==="large"?12:4}px ${o==="large"?32:10}px 0px rgba(0, 0, 0, 0.064)`:`0px ${o==="large"?6:4}px ${o==="large"?14:4}px 0px rgba(0, 0, 0, 0.04)`:"0px 2px 6px 0px rgba(0, 0, 0, 0)",cr=({textdocId:e,isInlinePreview:s=!1,isStreaming:n=!1,isDisabled:a=!1,isFocused:o=!1,isCanvasOpen:r=!1,marginBottom:l,size:i="large",onClick:d,children:g,name:f,type:b})=>{const c=u.useRef(null),[m,p]=u.useState(!1),[h]=u.useState(()=>un(100,180,!1)),{resolvedTheme:v}=Cs(),j=v==="dark",M=b?t.jsx("span",{className:A("flex-shrink-0 transition-[filter]",{grayscale:!o&&!m}),children:rr(b,o&&r)}):t.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center overflow-hidden",children:t.jsx(Ie,{lines:1,size:"base",width:100,widthVariance:0})}),x=f?t.jsx("span",{className:"min-w-0 truncate",children:f}):t.jsx("div",{className:"flex h-5 flex-grow items-center overflow-hidden",style:{width:h},children:t.jsx(Ie,{lines:1,size:"base",width:100,widthVariance:0})}),y=n&&t.jsx(dn,{size:20,className:A("flex-shrink-0",o?"text-blue-selection":"text-token-text-secondary")}),C=()=>{!c.current||a||(vn.logButtonClick(bn.MESSAGE_ATTACHMENT,{type:b}),yn(c.current),d?.())},k=i==="large"?100:50,E=`${j?"rgba(0,0,0,0)":"rgba(255,255,255,0)"}, ${j?"#2f2f2f":"#ffffff"}`;return t.jsxs(Te.div,{role:"button",id:mn(e),initial:{opacity:n?0:1,scale:n?.9:1},animate:{opacity:1,scale:1},transition:{type:"spring",bounce:0,duration:.72},className:A("popover relative flex select-none flex-col overflow-hidden border bg-token-main-surface-primary transition-shadow duration-500",a?"cursor-default":"cursor-pointer",{"border-token-text-tertiary font-medium dark:border-gray-600":o&&r,"font-regular":!o,"border-token-border-light":!m&&!o,"border-token-border-medium":m&&!o,"flex min-w-0 max-w-full flex-shrink flex-grow-0 items-center justify-between self-start rounded-xl":r||!s,"w-full rounded-2xl":!r&&s}),onMouseEnter:()=>!a&&p(!0),onMouseLeave:()=>p(!1),onClick:C,ref:c,style:{marginBottom:l,height:r||!s?void 0:i==="large"?"24rem":"10rem",width:i==="small"?"300px":void 0,boxShadow:ir({isCanvasOpen:r,isFocused:o,isHovered:m,isInlinePreview:s,size:i})},children:[t.jsxs("div",{className:A("flex w-full min-w-0 items-center justify-between gap-2 self-start border-token-border-light px-4 transition-colors duration-700",{"border-token-border-light":!m&&!o,"border-token-border-medium":m&&!o,"text-sm font-medium text-token-text-primary":!r&&m&&s,"py-2":r||!s,"py-3":!r&&s,"text-sm font-medium text-token-text-secondary":!r&&!m&&s}),children:[t.jsxs("div",{className:A("flex min-w-0 items-center",{"gap-2":r||!s,"gap-3.5":!r&&s}),children:[M,x]}),r?t.jsx(Te.span,{animate:y?"show":"initial",variants:{initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"24px"}},transition:{type:"tween",duration:.18},children:y}):s&&!a?t.jsx(lr,{isHovered:m}):null]}),t.jsxs("div",{className:"relative flex min-h-0 w-full flex-1 flex-col self-end",children:[!r&&g,s&&!r&&t.jsx("div",{className:"absolute bottom-0 z-20 h-24 w-full transition-colors",style:{height:k,background:`linear-gradient(${E})`}}),s&&i==="small"&&!r&&t.jsx("div",{className:"absolute bottom-0 right-0 top-0 z-20 transition-colors",style:{width:k,background:`linear-gradient(to right, ${E})`}})]})]})},ur=({type:e,name:s,isStreaming:n=!1,isFocused:a=!1,onClick:o,textdocId:r,isFetching:l=!1,isCanvasOpen:i=!1,isInlinePreview:d=!1})=>{const[g,f]=u.useState(!1),b=m=>{f(m>0)},c=i||!d?12:!i&&d?16:void 0;return t.jsx(cr,{name:s,isFocused:a,isCanvasOpen:i,textdocId:r,type:e,isInlinePreview:d,isStreaming:n,onClick:o,marginBottom:c,children:d&&t.jsx("div",{className:A("relative flex min-h-0 flex-auto flex-col overflow-hidden border-t transition-colors",{"border-token-border-light":g,"border-transparent":!g}),children:l?t.jsx(ms,{}):!!r&&t.jsx(or,{onScroll:b,textdocId:r})})})},dr=({textdocId:e})=>{const s=jn(d=>d?.resolveTempTextdocId[e]??e),n=Sn(s),a=kn(s),o=Cn();if(!n)return null;const r=()=>{Mn(s)},{title:l,type:i}=n;return t.jsx("div",{className:"flex w-full justify-end",children:t.jsx(ur,{textdocId:s,type:i,name:l,isFocused:a,isCanvasOpen:o,onClick:r,isInlinePreview:!0})})},mr=({messages:e})=>{const[s]=e,n=s?.message.metadata?.canvas;return!n||n.user_message_type!=null?null:t.jsx(t.Fragment,{children:n.pasted_textdocs?.map(({tempId:a})=>t.jsx(dr,{textdocId:a},a))})};function fs({attachments:e,citations:s,contentReferences:n,className:a,clientThreadId:o,displayParts:r,isCompletionInProgress:l,id:i,isActivelyStreaming:d,isUserTurn:g,turnIndex:f,isFeedbackEnabled:b,messages:c,onRequestMoreCompletions:m,parts:p,prevGroupedMessageType:h,prevGroupedMessages:v,showEditButton:j,onEnterEdit:M,size:x="medium"}){const y=Lt(),C=c.length>1,{flagSeverity:k,shouldHideContent:E}=Wt(C?void 0:c[0]),w=p.some(N=>N!==""),I=!w&&c[0].message.metadata?.content_references?.length===0,R=c[0].message.metadata?.targeted_reply_label??c[0].message.metadata?.targeted_reply;return u.useEffect(()=>{const N=c[0].message;if(N.author.metadata?.real_author===`tool:${wn.SEARCHGPT}`&&w){const U=N.metadata?.search_source;gt.logEvent(G.searchToolRequestTimeToFirstTextToken,o,N.id,{search_source:U},()=>{U===Ms.InstantQuery&&ws.logEvent(G.searchToolPageLoadTimeToFirstTextToken,{message_id:N.id})})}},[o,w,c]),u.useEffect(()=>{if(!I)switch(h){case Ke.Browsing:gt.logEvent(G.browsingTimeToFirstTextToken,o,c[0].message.id);break}},[I,c,o,h]),t.jsxs("div",{"data-message-author-role":c[0].message.author.role,"data-message-id":c[0].message.id,dir:"auto",className:A(a,"text-message flex w-full flex-col items-end gap-2 whitespace-normal break-words [.text-message+&]:mt-5"),"data-message-model-slug":c[0].message.metadata?.model_slug,children:[R&&t.jsxs("div",{className:"mb-1 ml-6 mt-1 flex items-start gap-1.5 text-sm font-normal text-token-text-tertiary sm:ml-7 lg:ml-8",children:[t.jsx(wo,{className:"icon-md mt-1 shrink-0"}),t.jsx("p",{className:"mr-2 line-clamp-3",children:R})]}),g&&y&&t.jsx(mr,{messages:c}),t.jsx(En,{messages:c}),t.jsx(fr,{parts:p,attachments:e,isUserTurn:g,isCompletionInProgress:l,turnIndex:f,displayParts:r,isActivelyStreaming:d,shouldHideContent:E,showEditButton:j,onEnterEdit:M,clientThreadId:o,id:i,isEmpty:I,prevGroupedMessageType:h,prevGroupedMessages:v,flagSeverity:k,messages:c,citations:s,contentReferences:n,size:x}),t.jsx(In,{message:C?void 0:c[0],id:i,isFeedbackEnabled:b,onRequestMoreCompletions:m,clientThreadId:o,isUserTurn:g}),t.jsx(Tn,{isUserTurn:g,message:C?void 0:c[0]}),!g&&!d&&v&&h===Ke.SearchResult&&t.jsx(_n,{messages:v})]})}function fr({clientThreadId:e,id:s,displayParts:n,isCompletionInProgress:a,turnIndex:o,isActivelyStreaming:r,shouldHideContent:l,showEditButton:i=!1,onEnterEdit:d,isEmpty:g,prevGroupedMessageType:f,prevGroupedMessages:b,messages:c,citations:m,contentReferences:p,size:h,isUserTurn:v,parts:j,attachments:M}){const x=q(),y=u.useRef(!1),C=Nn(n),[k,E]=u.useState({}),[w,I]=u.useState(!1),R=An(),{streamingContext:N}=Rn();u.useEffect(()=>{R&&(N.setOnStylesUpdatedCallback(E),N.onStreamingChanged(a),N.setOnResetCallback(()=>I(!1)),a&&(I(!0),E(N.createTopLevelStyles())))},[R,a,N]);const U=Pn(),_=c[0].message.metadata?.gizmo_id,O=c[0].message.metadata?.serialization_metadata,P=Fn(c[0].message).length,F=u.useMemo(()=>({clientThreadId:e,messageId:s,turnIndex:o}),[e,s,o]),S=Dn(c[0].message),K=!!_&&U.includes(_),W=u.useCallback(()=>{X.toggleChatThreadFlyout(e,o,s)},[e,o,s]),H=t.jsx(Ln,{parts:j,attachments:M,isUserTurn:v,clientThreadId:e},"files-and-tables"),te=!!(M?.length||n.some(z=>z.type==="images")),fe=On();function ge(z,J){const Q=f===Ke.CodeInterpreter?b?.map(ue=>ue.message):void 0,{text:pe,contentReferences:De}=Wn(J,m,p,K);let lt=De;fe&&(lt=De.filter(ue=>ue.type!=="attribution"));const{processedText:je,displayedContentReferences:it}=$n(pe,lt,r?void 0:Q,!1,r);je.includes(Un)&&!y.current&&(y.current=!0,Is.addError(new Error("Failed replaceTextWithDirectives"),{text:je,displayedContentReferences:it}));const ct=c[0].message,ut=ct.metadata?.message_locale;let Oe=t.jsx(Hn,{clientThreadId:e,messageId:s,isStreamingOrProcessing:w,size:h,className:A(r&&!R&&"result-streaming",S&&"headers-v2"),children:je===""?"&#8203;":je});if(ut!=null){const ue=Ts(ut,!1);ue!=null&&(Oe=t.jsx(_s,{locale:ue,children:Oe}))}return t.jsx(Vn.Provider,{value:{analyticsMetadata:F,message:ct,contentReferences:it,onShowSearchResults:W,numImageResults:P,isActivelyStreaming:r,useSafeUrls:!0},children:Oe},z)}const xe=n.map((z,J)=>{if(z.type==="transcription"){const Q=l?null:z.text;let pe=null;if(v&&l)pe=t.jsx("span",{className:"italic opacity-30",children:t.jsx(T,{...ke.contentRemoved})});else if(v&&Q!=null)pe=Q.trim().length===0?t.jsx("span",{className:"italic opacity-30",children:t.jsx(Le,{text:x.formatMessage(ke.transcriptUnavailable),customSymbolOffsets:void 0})}):t.jsx("span",{className:"italic opacity-65",children:t.jsx(Le,{text:`“${Q.trim()}”`,customSymbolOffsets:void 0})});else if(!v&&Q!=null)return ge(J,Q);return t.jsx(We,{containsImagesOrAttachments:te,isUserTurn:v,showEditButton:i,onEnterEdit:d,children:pe},J)}else if(z.type==="text"){const Q=l?null:z.text;return!g&&!l&&!v?ge(J,C):g&&r&&!v?R?t.jsx("div",{className:"pulsing-dot"},J):t.jsx("div",{className:"result-streaming",children:t.jsx("span",{children:t.jsx("pre",{})})},J):t.jsx(We,{containsImagesOrAttachments:te,isUserTurn:v,showEditButton:i,onEnterEdit:d,children:v&&l?t.jsx("span",{className:"italic opacity-30",children:t.jsx(T,{...ke.contentRemoved})}):Q?t.jsx(Le,{text:Q,customSymbolOffsets:O?.custom_symbol_offsets}):null},J)}else if(z.type==="images"){const Q=c[0].message.metadata?.attachments??[];return t.jsx(Bn,{assets:z.imageAssets,attachments:Q},J)}else return null}),rt=n.findIndex(z=>z.type==="text");if(rt!==-1?xe.splice(rt,0,H):xe.push(H),l&&v)xe.length=0,xe.push(t.jsx(We,{containsImagesOrAttachments:te,isUserTurn:v,onEnterEdit:Es,children:t.jsx("span",{className:"italic opacity-30",children:t.jsx(T,{...ke.contentRemoved})})}));else if(l&&!v)return null;return t.jsx("div",{className:A("flex w-full flex-col gap-1 empty:hidden",v&&"items-end rtl:items-start",!v&&"first:pt-[3px]",w&&"streaming-response"),style:k,children:xe})}const ke=_e({contentRemoved:{id:"textMessage.contentRemoved",defaultMessage:"Content removed"},transcriptUnavailable:{id:"textMessage.transcriptUnavailable",defaultMessage:"Transcript Unavailable"}});function gr(e){const{isActivelyStreaming:s,...n}=e,a=Ns(),o=a?.includes("debug")??!1,r=e.messages[e.messages.length-1].message.id,[l,i]=u.useState(Gn(e.parts)),d=u.useRef(void 0);return d.current===void 0&&(d.current=a?.includes(As)??!1?new qn(e.parts,i,s,void 0,{debug:o}):new zn(e.parts,i,s)),u.useEffect(()=>{d.current!=null&&(d.current.onMessagePartsUpdated(e.parts,s),d.current.isBuffering()&&$e.addDelayedRenderingMessage(r))},[e.parts,r,s]),u.useEffect(()=>{d.current!=null&&!d.current.isBuffering()&&$e.removeDelayedRenderingMessage(r)},[l,r]),u.useEffect(()=>()=>$e.removeDelayedRenderingMessage(r),[r]),u.useEffect(()=>()=>{d.current!=null&&(d.current.destroy(),d.current=void 0)},[]),t.jsx(fs,{...n,displayParts:l,isActivelyStreaming:s||d.current?.isBuffering()})}function xr({message:e,isCompletionInProgress:s,clientThreadId:n,className:a,isUserTurn:o,turnIndex:r,isFeedbackEnabled:l,prevGroupedMessageType:i,prevGroupedMessages:d,showEditButton:g,onEnterEdit:f,onRequestMoreCompletions:b}){const c=u.useMemo(()=>"parts"in e.message.content?e.message.content.parts:[Qn(e.message)],[e]);return t.jsx(pr,{parts:c,messages:[e],isCompletionInProgress:s,className:a,citations:e.message.metadata?.citations,contentReferences:e.message.metadata?.content_references,attachments:e.message.metadata?.attachments,isUserTurn:o,turnIndex:r,id:e.nodeId,isFeedbackEnabled:l,onRequestMoreCompletions:b,clientThreadId:n,showEditButton:g,onEnterEdit:f,prevGroupedMessageType:i,prevGroupedMessages:d})}const jt=ne.memo(xr);function pr(e){const s=e.messages.length>1,{flagSeverity:n}=Wt(s?void 0:e.messages[0]),a=n!=="danger"&&e.isCompletionInProgress,o=!e.parts.some(l=>l!==""),[r]=u.useState(()=>!e.isUserTurn&&(e.isCompletionInProgress||o));return r?t.jsx(gr,{...e,isActivelyStreaming:a}):t.jsx(fs,{...e,displayParts:Kn({isUserTurn:e.isUserTurn,parts:e.parts}),isActivelyStreaming:a})}const gs={...Rs},hr=gs.useInsertionEffect,vr=hr||(e=>e());function xs(e){const s=u.useRef(()=>{});return vr(()=>{s.current=e}),u.useCallback(function(){for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return s.current==null?void 0:s.current(...a)},[])}var Xe=typeof document<"u"?u.useLayoutEffect:u.useEffect;let St=!1,br=0;const kt=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+br++;function yr(){const[e,s]=u.useState(()=>St?kt():void 0);return Xe(()=>{e==null&&s(kt())},[]),u.useEffect(()=>{St=!0},[]),e}const jr=gs.useId,Sr=jr||yr;function kr(){const e=new Map;return{emit(s,n){var a;(a=e.get(s))==null||a.forEach(o=>o(n))},on(s,n){e.set(s,[...e.get(s)||[],n])},off(s,n){var a;e.set(s,((a=e.get(s))==null?void 0:a.filter(o=>o!==n))||[])}}}const Cr=u.createContext(null),Mr=u.createContext(null),wr=()=>{var e;return((e=u.useContext(Cr))==null?void 0:e.id)||null},Er=()=>u.useContext(Mr),Ir="data-floating-ui-focusable";function Tr(e){const{open:s=!1,onOpenChange:n,elements:a}=e,o=Sr(),r=u.useRef({}),[l]=u.useState(()=>kr()),i=wr()!=null,[d,g]=u.useState(a.reference),f=xs((m,p,h)=>{r.current.openEvent=m?p:void 0,l.emit("openchange",{open:m,event:p,reason:h,nested:i}),n?.(m,p,h)}),b=u.useMemo(()=>({setPositionReference:g}),[]),c=u.useMemo(()=>({reference:d||a.reference||null,floating:a.floating||null,domReference:a.reference}),[d,a.reference,a.floating]);return u.useMemo(()=>({dataRef:r,open:s,onOpenChange:f,elements:c,events:l,floatingId:o,refs:b}),[s,f,c,l,o,b])}function _r(e){e===void 0&&(e={});const{nodeId:s}=e,n=Tr({...e,elements:{reference:null,floating:null,...e.elements}}),a=e.rootContext||n,o=a.elements,[r,l]=u.useState(null),[i,d]=u.useState(null),f=o?.reference||r,b=u.useRef(null),c=Er();Xe(()=>{f&&(b.current=f)},[f]);const m=Yn({...e,elements:{...o,...i&&{reference:i}}}),p=u.useCallback(x=>{const y=Se(x)?{getBoundingClientRect:()=>x.getBoundingClientRect(),contextElement:x}:x;d(y),m.refs.setReference(y)},[m.refs]),h=u.useCallback(x=>{(Se(x)||x===null)&&(b.current=x,l(x)),(Se(m.refs.reference.current)||m.refs.reference.current===null||x!==null&&!Se(x))&&m.refs.setReference(x)},[m.refs]),v=u.useMemo(()=>({...m.refs,setReference:h,setPositionReference:p,domReference:b}),[m.refs,h,p]),j=u.useMemo(()=>({...m.elements,domReference:f}),[m.elements,f]),M=u.useMemo(()=>({...m,...a,refs:v,elements:j,nodeId:s}),[m,v,j,s,a]);return Xe(()=>{a.dataRef.current.floatingContext=M;const x=c?.nodesRef.current.find(y=>y.id===s);x&&(x.context=M)}),u.useMemo(()=>({...m,context:M,refs:v,elements:j}),[m,v,j,M])}const Ct="active",Mt="selected";function Ge(e,s,n){const a=new Map,o=n==="item";let r=e;if(o&&e){const{[Ct]:l,[Mt]:i,...d}=e;r=d}return{...n==="floating"&&{tabIndex:-1,[Ir]:""},...r,...s.map(l=>{const i=l?l[n]:null;return typeof i=="function"?e?i(e):null:i}).concat(e).reduce((l,i)=>(i&&Object.entries(i).forEach(d=>{let[g,f]=d;if(!(o&&[Ct,Mt].includes(g)))if(g.indexOf("on")===0){if(a.has(g)||a.set(g,[]),typeof f=="function"){var b;(b=a.get(g))==null||b.push(f),l[g]=function(){for(var c,m=arguments.length,p=new Array(m),h=0;h<m;h++)p[h]=arguments[h];return(c=a.get(g))==null?void 0:c.map(v=>v(...p)).find(v=>v!==void 0)}}}else l[g]=f}),l),{})}}function Nr(e){e===void 0&&(e=[]);const s=e.map(i=>i?.reference),n=e.map(i=>i?.floating),a=e.map(i=>i?.item),o=u.useCallback(i=>Ge(i,e,"reference"),s),r=u.useCallback(i=>Ge(i,e,"floating"),n),l=u.useCallback(i=>Ge(i,e,"item"),a);return u.useMemo(()=>({getReferenceProps:o,getFloatingProps:r,getItemProps:l}),[o,r,l])}function wt(e,s){return{...e,rects:{...e.rects,floating:{...e.rects.floating,height:s}}}}const Ar=e=>({name:"inner",options:e,async fn(s){const{listRef:n,overflowRef:a,onFallbackChange:o,offset:r=0,index:l=0,minItemsVisible:i=4,referenceOverflowThreshold:d=0,scrollRef:g,...f}=Xn(e,s),{rects:b,elements:{floating:c}}=s,m=n.current[l],p=g?.current||c,h=c.clientTop||p.clientTop,v=c.clientTop!==0,j=p.clientTop!==0,M=c===p;if(!m)return{};const x={...s,...await $t(-m.offsetTop-c.clientTop-b.reference.height/2-m.offsetHeight/2-r).fn(s)},y=await Be(wt(x,p.scrollHeight+h+c.clientTop),f),C=await Be(x,{...f,elementContext:"reference"}),k=Ue(0,y.top),E=x.y+k,w=Jn(Ue(0,p.scrollHeight+(v&&M||j?h*2:0)-k-Ue(0,y.bottom)));if(p.style.maxHeight=w+"px",p.scrollTop=k,o){const I=p.scrollHeight>p.offsetHeight&&p.offsetHeight<m.offsetHeight*i-1||C.top>=-d||C.bottom>=-d;ae.flushSync(()=>o(I))}return a&&(a.current=await Be(wt({...x,y:E},p.offsetHeight+h+c.clientTop),f)),{y:E}}});function Rr(e,s){const{open:n,elements:a}=e,{enabled:o=!0,overflowRef:r,scrollRef:l,onChange:i}=s,d=xs(i),g=u.useRef(!1),f=u.useRef(null),b=u.useRef(null);u.useEffect(()=>{if(!o)return;function m(h){if(h.ctrlKey||!p||r.current==null)return;const v=h.deltaY,j=r.current.top>=-.5,M=r.current.bottom>=-.5,x=p.scrollHeight-p.clientHeight,y=v<0?-1:1,C=v<0?"max":"min";p.scrollHeight<=p.clientHeight||(!j&&v>0||!M&&v<0?(h.preventDefault(),ae.flushSync(()=>{d(k=>k+Math[C](v,x*y))})):/firefox/i.test(Zn())&&(p.scrollTop+=v))}const p=l?.current||a.floating;if(n&&p)return p.addEventListener("wheel",m),requestAnimationFrame(()=>{f.current=p.scrollTop,r.current!=null&&(b.current={...r.current})}),()=>{f.current=null,b.current=null,p.removeEventListener("wheel",m)}},[o,n,a.floating,r,l,d]);const c=u.useMemo(()=>({onKeyDown(){g.current=!0},onWheel(){g.current=!1},onPointerMove(){g.current=!1},onScroll(){const m=l?.current||a.floating;if(!(!r.current||!m||!g.current)){if(f.current!==null){const p=m.scrollTop-f.current;(r.current.bottom<-.5&&p<-1||r.current.top<-.5&&p>1)&&ae.flushSync(()=>d(h=>h+p))}requestAnimationFrame(()=>{f.current=m.scrollTop})}}}),[a.floating,d,r,l]);return u.useMemo(()=>o?{floating:c}:{},[o,c])}let me=u.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});me.displayName="FloatingContext";let at=u.createContext(null);at.displayName="PlacementContext";function Pr(e){return u.useMemo(()=>e?typeof e=="string"?{to:e}:e:null,[e])}function Fr(){return u.useContext(me).setReference}function Dr(){return u.useContext(me).getReferenceProps}function Or(){let{getFloatingProps:e,slot:s}=u.useContext(me);return u.useCallback((...n)=>Object.assign({},e(...n),{"data-anchor":s.anchor}),[e,s])}function Br(e=null){e===!1&&(e=null),typeof e=="string"&&(e={to:e});let s=u.useContext(at),n=u.useMemo(()=>e,[JSON.stringify(e,(o,r)=>{var l;return(l=r?.outerHTML)!=null?l:r})]);oe(()=>{s?.(n??null)},[s,n]);let a=u.useContext(me);return u.useMemo(()=>[a.setFloating,e?a.styles:{}],[a.setFloating,e,a.styles])}let Et=4;function Lr({children:e,enabled:s=!0}){let[n,a]=u.useState(null),[o,r]=u.useState(0),l=u.useRef(null),[i,d]=u.useState(null);Wr(i);let g=s&&n!==null&&i!==null,{to:f="bottom",gap:b=0,offset:c=0,padding:m=0,inner:p}=$r(n,i),[h,v="center"]=f.split(" ");oe(()=>{g&&r(0)},[g]);let{refs:j,floatingStyles:M,context:x}=_r({open:g,placement:h==="selection"?v==="center"?"bottom":`bottom-${v}`:v==="center"?`${h}`:`${h}-${v}`,strategy:"absolute",transform:!1,middleware:[$t({mainAxis:h==="selection"?0:b,crossAxis:c}),ea({padding:m}),h!=="selection"&&ta({padding:m}),h==="selection"&&p?Ar({...p,padding:m,overflowRef:l,offset:o,minItemsVisible:Et,referenceOverflowThreshold:m,onFallbackChange(N){var U,_;if(!N)return;let O=x.elements.floating;if(!O)return;let P=parseFloat(getComputedStyle(O).scrollPaddingBottom)||0,F=Math.min(Et,O.childElementCount),S=0,K=0;for(let W of(_=(U=x.elements.floating)==null?void 0:U.childNodes)!=null?_:[])if(W instanceof HTMLElement){let H=W.offsetTop,te=H+W.clientHeight+P,fe=O.scrollTop,ge=fe+O.clientHeight;if(H>=fe&&te<=ge)F--;else{K=Math.max(0,Math.min(te,ge)-Math.max(H,fe)),S=W.clientHeight;break}}F>=1&&r(W=>{let H=S*F-K+P;return W>=H?W:H})}}):null,sa({padding:m,apply({availableWidth:N,availableHeight:U,elements:_}){Object.assign(_.floating.style,{overflow:"auto",maxWidth:`${N}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${U}px)`})}})].filter(Boolean),whileElementsMounted:Ps}),[y=h,C=v]=x.placement.split("-");h==="selection"&&(y="selection");let k=u.useMemo(()=>({anchor:[y,C].filter(Boolean).join(" ")}),[y,C]),E=Rr(x,{overflowRef:l,onChange:r}),{getReferenceProps:w,getFloatingProps:I}=Nr([E]),R=L(N=>{d(N),j.setFloating(N)});return u.createElement(at.Provider,{value:a},u.createElement(me.Provider,{value:{setFloating:R,setReference:j.setReference,styles:M,getReferenceProps:w,getFloatingProps:I,slot:k}},e))}function Wr(e){oe(()=>{if(!e)return;let s=new MutationObserver(()=>{let n=window.getComputedStyle(e).maxHeight,a=parseFloat(n);if(isNaN(a))return;let o=parseInt(n);isNaN(o)||a!==o&&(e.style.maxHeight=`${Math.ceil(a)}px`)});return s.observe(e,{attributes:!0,attributeFilter:["style"]}),()=>{s.disconnect()}},[e])}function $r(e,s){var n,a,o;let r=qe((n=e?.gap)!=null?n:"var(--anchor-gap, 0)",s),l=qe((a=e?.offset)!=null?a:"var(--anchor-offset, 0)",s),i=qe((o=e?.padding)!=null?o:"var(--anchor-padding, 0)",s);return{...e,gap:r,offset:l,padding:i}}function qe(e,s,n=void 0){let a=Ut(),o=L((d,g)=>{if(d==null)return[n,null];if(typeof d=="number")return[d,null];if(typeof d=="string"){if(!g)return[n,null];let f=It(d,g);return[f,b=>{let c=ps(d);{let m=c.map(p=>window.getComputedStyle(g).getPropertyValue(p));a.requestAnimationFrame(function p(){a.nextFrame(p);let h=!1;for(let[j,M]of c.entries()){let x=window.getComputedStyle(g).getPropertyValue(M);if(m[j]!==x){m[j]=x,h=!0;break}}if(!h)return;let v=It(d,g);f!==v&&(b(v),f=v)})}return a.dispose}]}return[n,null]}),r=u.useMemo(()=>o(e,s)[0],[e,s]),[l=r,i]=u.useState();return oe(()=>{let[d,g]=o(e,s);if(i(d),!!g)return g(i)},[e,s]),l}function ps(e){let s=/var\((.*)\)/.exec(e);if(s){let n=s[1].indexOf(",");if(n===-1)return[s[1]];let a=s[1].slice(0,n).trim(),o=s[1].slice(n+1).trim();return o?[a,...ps(o)]:[a]}return[]}function It(e,s){let n=document.createElement("div");s.appendChild(n),n.style.setProperty("margin-top","0px","important"),n.style.setProperty("margin-top",e,"important");let a=parseFloat(window.getComputedStyle(n).marginTop)||0;return s.removeChild(n),a}var Ur=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ur||{}),Hr=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Hr||{}),Vr=(e=>(e[e.OpenMenu=0]="OpenMenu",e[e.CloseMenu=1]="CloseMenu",e[e.GoToItem=2]="GoToItem",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterItem=5]="RegisterItem",e[e.UnregisterItem=6]="UnregisterItem",e[e.SetButtonElement=7]="SetButtonElement",e[e.SetItemsElement=8]="SetItemsElement",e))(Vr||{});function ze(e,s=n=>n){let n=e.activeItemIndex!==null?e.items[e.activeItemIndex]:null,a=_a(s(e.items.slice()),r=>r.dataRef.current.domRef.current),o=n?a.indexOf(n):null;return o===-1&&(o=null),{items:a,activeItemIndex:o}}let Gr={1(e){return e.menuState===1?e:{...e,activeItemIndex:null,menuState:1}},0(e){return e.menuState===0?e:{...e,__demoMode:!1,menuState:0}},2:(e,s)=>{var n,a,o,r,l;if(e.menuState===1)return e;let i={...e,searchQuery:"",activationTrigger:(n=s.trigger)!=null?n:1,__demoMode:!1};if(s.focus===$.Nothing)return{...i,activeItemIndex:null};if(s.focus===$.Specific)return{...i,activeItemIndex:e.items.findIndex(f=>f.id===s.id)};if(s.focus===$.Previous){let f=e.activeItemIndex;if(f!==null){let b=e.items[f].dataRef.current.domRef,c=He(s,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:m=>m.id,resolveDisabled:m=>m.dataRef.current.disabled});if(c!==null){let m=e.items[c].dataRef.current.domRef;if(((a=b.current)==null?void 0:a.previousElementSibling)===m.current||((o=m.current)==null?void 0:o.previousElementSibling)===null)return{...i,activeItemIndex:c}}}}else if(s.focus===$.Next){let f=e.activeItemIndex;if(f!==null){let b=e.items[f].dataRef.current.domRef,c=He(s,{resolveItems:()=>e.items,resolveActiveIndex:()=>e.activeItemIndex,resolveId:m=>m.id,resolveDisabled:m=>m.dataRef.current.disabled});if(c!==null){let m=e.items[c].dataRef.current.domRef;if(((r=b.current)==null?void 0:r.nextElementSibling)===m.current||((l=m.current)==null?void 0:l.nextElementSibling)===null)return{...i,activeItemIndex:c}}}}let d=ze(e),g=He(s,{resolveItems:()=>d.items,resolveActiveIndex:()=>d.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});return{...i,...d,activeItemIndex:g}},3:(e,s)=>{let n=e.searchQuery!==""?0:1,a=e.searchQuery+s.value.toLowerCase(),o=(e.activeItemIndex!==null?e.items.slice(e.activeItemIndex+n).concat(e.items.slice(0,e.activeItemIndex+n)):e.items).find(l=>{var i;return((i=l.dataRef.current.textValue)==null?void 0:i.startsWith(a))&&!l.dataRef.current.disabled}),r=o?e.items.indexOf(o):-1;return r===-1||r===e.activeItemIndex?{...e,searchQuery:a}:{...e,searchQuery:a,activeItemIndex:r,activationTrigger:1}},4(e){return e.searchQuery===""?e:{...e,searchQuery:"",searchActiveItemIndex:null}},5:(e,s)=>{let n=ze(e,a=>[...a,{id:s.id,dataRef:s.dataRef}]);return{...e,...n}},6:(e,s)=>{let n=ze(e,a=>{let o=a.findIndex(r=>r.id===s.id);return o!==-1&&a.splice(o,1),a});return{...e,...n,activationTrigger:1}},7:(e,s)=>e.buttonElement===s.element?e:{...e,buttonElement:s.element},8:(e,s)=>e.itemsElement===s.element?e:{...e,itemsElement:s.element}},ot=u.createContext(null);ot.displayName="MenuContext";function Pe(e){let s=u.useContext(ot);if(s===null){let n=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(n,Pe),n}return s}function qr(e,s){return Ht(s.type,Gr,e,s)}let zr=u.Fragment;function Qr(e,s){let{__demoMode:n=!1,...a}=e,o=u.useReducer(qr,{__demoMode:n,menuState:n?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:r,itemsElement:l,buttonElement:i},d]=o,g=Re(s);na(r===0,[i,l],(m,p)=>{d({type:1}),aa(p,oa.Loose)||(m.preventDefault(),i?.focus())});let f=L(()=>{d({type:1})}),b=u.useMemo(()=>({open:r===0,close:f}),[r,f]),c={ref:g};return ne.createElement(Lr,null,ne.createElement(ot.Provider,{value:o},ne.createElement(ra,{value:Ht(r,{0:Ee.Open,1:Ee.Closed})},ce({ourProps:c,theirProps:a,slot:b,defaultTag:zr,name:"Menu"}))))}let Kr="button";function Yr(e,s){var n;let a=u.useId(),{id:o=`headlessui-menu-button-${a}`,disabled:r=!1,autoFocus:l=!1,...i}=e,[d,g]=Pe("Menu.Button"),f=Dr(),b=la(),c=Re(s,Fr(),L(w=>g({type:7,element:w}))),m=L(w=>{switch(w.key){case B.Space:case B.Enter:case B.ArrowDown:w.preventDefault(),w.stopPropagation(),ae.flushSync(()=>g({type:0})),g({type:2,focus:$.First});break;case B.ArrowUp:w.preventDefault(),w.stopPropagation(),ae.flushSync(()=>g({type:0})),g({type:2,focus:$.Last});break}}),p=L(w=>{switch(w.key){case B.Space:w.preventDefault();break}}),h=L(w=>{var I;if(ia(w.currentTarget))return w.preventDefault();r||(d.menuState===0?(ae.flushSync(()=>g({type:1})),(I=d.buttonElement)==null||I.focus({preventScroll:!0})):(w.preventDefault(),g({type:0})))}),{isFocusVisible:v,focusProps:j}=ca({autoFocus:l}),{isHovered:M,hoverProps:x}=ua({isDisabled:r}),{pressed:y,pressProps:C}=da({disabled:r}),k=u.useMemo(()=>({open:d.menuState===0,active:y||d.menuState===0,disabled:r,hover:M,focus:v,autofocus:l}),[d,M,v,y,r,l]),E=Vt(f(),{ref:c,id:o,type:ma(e,d.buttonElement),"aria-haspopup":"menu","aria-controls":(n=d.itemsElement)==null?void 0:n.id,"aria-expanded":d.menuState===0,disabled:r||void 0,autoFocus:l,onKeyDown:m,onKeyUp:p,onClick:h},j,x,C);return ce({mergeRefs:b,ourProps:E,theirProps:i,slot:k,defaultTag:Kr,name:"Menu.Button"})}let Xr="div",Jr=xt.RenderStrategy|xt.Static;function Zr(e,s){var n,a;let o=u.useId(),{id:r=`headlessui-menu-items-${o}`,anchor:l,portal:i=!1,modal:d=!0,transition:g=!1,...f}=e,b=Pr(l),[c,m]=Pe("Menu.Items"),[p,h]=Br(b),v=Or(),[j,M]=u.useState(null),x=Re(s,b?p:null,L(S=>m({type:8,element:S})),M),y=fa(c.itemsElement);b&&(i=!0);let C=ga(),[k,E]=xa(g,j,C!==null?(C&Ee.Open)===Ee.Open:c.menuState===0);pa(k,c.buttonElement,()=>{m({type:1})});let w=c.__demoMode?!1:d&&c.menuState===0;ha(w,y);let I=c.__demoMode?!1:d&&c.menuState===0;va(I,{allowed:u.useCallback(()=>[c.buttonElement,c.itemsElement],[c.buttonElement,c.itemsElement])});let R=c.menuState!==0,N=ba(R,c.buttonElement)?!1:k;u.useEffect(()=>{let S=c.itemsElement;S&&c.menuState===0&&S!==y?.activeElement&&S.focus({preventScroll:!0})},[c.menuState,c.itemsElement,y]),ya(c.menuState===0,{container:c.itemsElement,accept(S){return S.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:S.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(S){S.setAttribute("role","none")}});let U=Ut(),_=L(S=>{var K,W,H;switch(U.dispose(),S.key){case B.Space:if(c.searchQuery!=="")return S.preventDefault(),S.stopPropagation(),m({type:3,value:S.key});case B.Enter:if(S.preventDefault(),S.stopPropagation(),m({type:1}),c.activeItemIndex!==null){let{dataRef:te}=c.items[c.activeItemIndex];(W=(K=te.current)==null?void 0:K.domRef.current)==null||W.click()}Gt(c.buttonElement);break;case B.ArrowDown:return S.preventDefault(),S.stopPropagation(),m({type:2,focus:$.Next});case B.ArrowUp:return S.preventDefault(),S.stopPropagation(),m({type:2,focus:$.Previous});case B.Home:case B.PageUp:return S.preventDefault(),S.stopPropagation(),m({type:2,focus:$.First});case B.End:case B.PageDown:return S.preventDefault(),S.stopPropagation(),m({type:2,focus:$.Last});case B.Escape:S.preventDefault(),S.stopPropagation(),ae.flushSync(()=>m({type:1})),(H=c.buttonElement)==null||H.focus({preventScroll:!0});break;case B.Tab:S.preventDefault(),S.stopPropagation(),ae.flushSync(()=>m({type:1})),ja(c.buttonElement,S.shiftKey?pt.Previous:pt.Next);break;default:S.key.length===1&&(m({type:3,value:S.key}),U.setTimeout(()=>m({type:4}),350));break}}),O=L(S=>{switch(S.key){case B.Space:S.preventDefault();break}}),P=u.useMemo(()=>({open:c.menuState===0}),[c.menuState]),F=Vt(b?v():{},{"aria-activedescendant":c.activeItemIndex===null||(n=c.items[c.activeItemIndex])==null?void 0:n.id,"aria-labelledby":(a=c.buttonElement)==null?void 0:a.id,id:r,onKeyDown:_,onKeyUp:O,role:"menu",tabIndex:c.menuState===0?0:void 0,ref:x,style:{...f.style,...h,"--button-width":Sa(c.buttonElement,!0).width},...ka(E)});return ne.createElement(Ca,{enabled:i?e.static||k:!1},ce({ourProps:F,theirProps:f,slot:P,defaultTag:Xr,features:Jr,visible:N,name:"Menu.Items"}))}let el=u.Fragment;function tl(e,s){let n=u.useId(),{id:a=`headlessui-menu-item-${n}`,disabled:o=!1,...r}=e,[l,i]=Pe("Menu.Item"),d=l.activeItemIndex!==null?l.items[l.activeItemIndex].id===a:!1,g=u.useRef(null),f=Re(s,g);oe(()=>{if(!l.__demoMode&&l.menuState===0&&d&&l.activationTrigger!==0)return Ma().requestAnimationFrame(()=>{var I,R;(R=(I=g.current)==null?void 0:I.scrollIntoView)==null||R.call(I,{block:"nearest"})})},[l.__demoMode,g,d,l.menuState,l.activationTrigger,l.activeItemIndex]);let b=wa(g),c=u.useRef({disabled:o,domRef:g,get textValue(){return b()}});oe(()=>{c.current.disabled=o},[c,o]),oe(()=>(i({type:5,id:a,dataRef:c}),()=>i({type:6,id:a})),[c,a]);let m=L(()=>{i({type:1})}),p=L(I=>{if(o)return I.preventDefault();i({type:1}),Gt(l.buttonElement)}),h=L(()=>{if(o)return i({type:2,focus:$.Nothing});i({type:2,focus:$.Specific,id:a})}),v=Ea(),j=L(I=>{v.update(I),!o&&(d||i({type:2,focus:$.Specific,id:a,trigger:0}))}),M=L(I=>{v.wasMoved(I)&&(o||d||i({type:2,focus:$.Specific,id:a,trigger:0}))}),x=L(I=>{v.wasMoved(I)&&(o||d&&i({type:2,focus:$.Nothing}))}),[y,C]=qt(),[k,E]=Ia(),w=u.useMemo(()=>({active:d,focus:d,disabled:o,close:m}),[d,o,m]);return ne.createElement(C,null,ne.createElement(E,null,ce({ourProps:{id:a,ref:f,role:"menuitem",tabIndex:o===!0?void 0:-1,"aria-disabled":o===!0?!0:void 0,"aria-labelledby":y,"aria-describedby":k,disabled:void 0,onClick:p,onFocus:h,onPointerEnter:j,onMouseEnter:j,onPointerMove:M,onMouseMove:M,onPointerLeave:x,onMouseLeave:x},theirProps:r,slot:w,defaultTag:el,name:"Menu.Item"})))}let sl="div";function nl(e,s){let[n,a]=qt();return ne.createElement(a,null,ce({ourProps:{ref:s,"aria-labelledby":n,role:"group"},theirProps:e,slot:{},defaultTag:sl,name:"Menu.Section"}))}let al="header";function ol(e,s){let n=u.useId(),{id:a=`headlessui-menu-heading-${n}`,...o}=e,r=Ta();oe(()=>r.register(a),[a,r.register]);let l={id:a,ref:s,role:"presentation",...r.props};return ce({ourProps:l,theirProps:o,slot:{},defaultTag:al,name:"Menu.Heading"})}let rl="div";function ll(e,s){return ce({ourProps:{ref:s,role:"separator"},theirProps:e,slot:{},defaultTag:rl,name:"Menu.Separator"})}let il=ie(Qr),cl=ie(Yr),ul=ie(Zr),dl=ie(tl),ml=ie(nl),fl=ie(ol),gl=ie(ll),he=Object.assign(il,{Button:cl,Items:ul,Item:dl,Section:ml,Heading:fl,Separator:gl});function xl({show:e,appear:s,children:n}){return t.jsx(Na,{as:u.Fragment,enter:"transition ease-out duration-200",enterFrom:"opacity-0 translate-y-1",enterTo:"opacity-100 translate-y-0",leave:"transition ease-in duration-150",leaveFrom:"opacity-100 translate-y-0",leaveTo:"opacity-0 translate-y-1",show:e,appear:s,children:n})}function se({onClick:e,href:s,target:n,children:a,disabled:o,icon:r,testId:l}){const i=ye();return t.jsx(he.Item,{disabled:o,children:({active:d})=>t.jsxs(Fe,{onClick:e,href:s,target:n,className:A({"bg-token-sidebar-surface-secondary":d,"hover:bg-token-sidebar-surface-secondary":!d&&!o||i}),"data-testid":l,children:[r&&t.jsx(r,{className:"icon-md"}),a]})})}function pl({to:e,children:s,icon:n}){return t.jsx(he.Item,{children:({active:a})=>t.jsx(Fs,{to:e,children:t.jsxs(Fe,{$as:"span",className:A(a?"bg-token-sidebar-surface-secondary":"cursor-pointer"),children:[n&&t.jsx(n,{className:"icon-md"}),s]})})})}re.a`p-2 rounded-md hover:bg-black/10 hover:dark:bg-white/10 cursor-pointer`;const Fe=re.a`flex gap-2 rounded p-2.5 text-sm cursor-pointer focus:ring-0 hover:bg-token-main-surface-secondary radix-disabled:pointer-events-none radix-disabled:opacity-50 group items-center`,Kl=re(Fe)`border dark:border-white/20 min-h-0 hover:bg-gray-500/10 h-10 rounded-lg border-[rgba(0,0,0,0.1)]`,Je=re.div`h-px bg-token-border-light my-1.5`,Yl=re(Fe)`${e=>e.$active?"bg-token-sidebar-surface-secondary":"hover:bg-token-sidebar-surface-secondary"}`,hl=ve(()=>be(()=>import("./iuhrx6mg037mehxb.js"),__vite__mapDeps([31,1,2,3,5,6,32,33,34,35,15,36,37])));function Xl({onClickSettings:e}){const s=ye();return t.jsxs(he,{as:"div",className:A(!s&&"group relative"),children:[t.jsx(jl,{}),t.jsx(xl,{children:t.jsx(he.Items,{className:A("popover absolute bottom-full z-50 mb-1 overflow-hidden rounded-lg border border-token-border-light bg-token-main-surface-primary p-1.5 shadow-lg outline-none",s&&"left-3 w-[var(--screen-sidebar-popover-min-width)]",!s&&"left-0 w-full"),children:t.jsx(yl,{onClickSettings:e})})})]})}function hs(){const e=!le()?.isEnterprisey(),s=q(),n=st(),a=Ze();return n?t.jsxs("div",{className:"flex items-center justify-between gap-2 py-2 pl-5 pr-4",children:[t.jsx("div",{className:"text-sm text-token-text-secondary",children:n?.email}),e&&t.jsx(ee,{label:s.formatMessage(Z.addWorkspaceTooltip),side:"right",children:t.jsx("button",{onClick:()=>es(a,"profile menu"),children:t.jsx(Ao,{className:"icon-sm text-token-text-primary"})})})]}):null}function vl(){const e=le();return e==null?t.jsx(t.Fragment,{children:t.jsx("div",{className:"w-full px-3 py-2",children:t.jsx(Ce,{})})}):t.jsxs(t.Fragment,{children:[t.jsx(hs,{}),t.jsx("div",{className:"flex h-11 w-full items-center justify-start gap-3 px-3 py-1 text-sm",children:t.jsx(bs,{workspace:e,isLoading:!1,currentWorkspaceId:e.id,showCheck:!1})})]})}function vs({menuItemComponent:e}){const s=tt(),n=Tt(),{data:a}=Ne(),o=le(),[r,l]=u.useState(!1),i=st(),d=q(),g=_t();if(!o||!a)return null;const f=o.isWorkspaceAccount(),b=a.accountItems.length>1,c=a.accountItems,m=Aa([c.find(h=>h.isPersonalAccount()),...c.filter(h=>!h.isPersonalAccount())]);if(m.sort((h,v)=>h.isPersonalAccount()?1:v.isPersonalAccount()?-1:0),!b)return f?t.jsx(vl,{}):t.jsx(t.Fragment,{children:t.jsx("div",{className:"ml-3 mr-2 py-2 text-sm text-token-text-secondary",children:i?.email})});const p=m.map(h=>t.jsx(e,{disabled:h.isDeactivated(),onClick:()=>{if(h.isDeactivated()||h.id===o?.id)return;l(!0);const{willRedirect:v}=Ds(n,h.id,s,d,g);v||Os()},className:"radix-disabled:pointer-events-auto radix-disabled:hover:bg-transparent",children:h.isDeactivated()?t.jsx(bl,{workspace:h,isLoading:r}):t.jsx(bs,{workspace:h,isLoading:r,currentWorkspaceId:o?.id})},h.id));return t.jsxs(t.Fragment,{children:[t.jsx(hs,{}),t.jsx(D.Separator,{}),p]})}function bs({workspace:e,isLoading:s,currentWorkspaceId:n,showCheck:a=!0}){const o=e.canAccessWithCurrentSession,r=!s&&a&&e.id===n;return t.jsxs("div",{children:[t.jsxs("div",{className:"flex w-full items-center gap-2.5",children:[t.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:t.jsx(nt,{iconSize:"small",workspace:e,className:A({"flex-shrink-0":!0})})}),t.jsx("div",{className:"line-clamp-1 text-token-text-primary",children:zt(q(),e)}),s&&t.jsx(Ce,{}),r&&t.jsx("span",{className:"text-token-text-primary",children:t.jsx(Eo,{className:"icon-sm"})}),!o&&t.jsx("span",{className:"text-token-text-primary",children:t.jsx(Io,{className:"icon-sm"})})]}),!o&&t.jsx("div",{className:"rowDivClassName",children:t.jsx("small",{className:"text-token-text-secondary",children:t.jsx(T,{...e.ssoConnectionName?Z.authenticateWithSSOToAccessWorkspace:Z.authenticateWithoutSSOToAccessWorkspace})})})]})}function bl({workspace:e,isLoading:s}){const n=q(),a=e.isOwnerOfAccount(),[o,r]=u.useState(!1),l=Ra(e.id);return u.useEffect(()=>{l!=null&&o&&(X.setPurchaseWorkspaceData({minimumSeats:Math.max(l,ht),existingAccount:e}),r(!1))},[l,o,e]),t.jsxs(t.Fragment,{children:[t.jsxs(ee,{className:"flex w-full flex-1 items-center gap-2.5",label:n.formatMessage(Z.disabledWorkspaceTooltip),sideOffset:20,side:"right",children:[t.jsx("span",{className:"flex h-5 w-5 items-center justify-center",children:t.jsx(To,{className:"icon-sm flex-shrink-0 opacity-30"})}),t.jsx("div",{className:"truncate opacity-30",children:zt(n,e)})]}),s&&t.jsx(Ce,{}),!s&&t.jsxs(D.Root,{children:[t.jsx(D.Trigger,{className:"rounded text-center hover:bg-token-main-surface-secondary",children:t.jsx(_o,{className:"icon-sm m-1"})}),t.jsx(D.Portal,{children:t.jsxs(D.Content,{children:[a&&t.jsx(t.Fragment,{children:t.jsx(D.Item,{onClick:()=>{l==null?r(!0):X.setPurchaseWorkspaceData({minimumSeats:Math.max(l,ht),existingAccount:e})},children:o?t.jsx(Ce,{}):t.jsx(T,{id:"navigation.reactivateWorkspace",defaultMessage:"Reactivate workspace"})})}),t.jsx(D.Item,{onClick:()=>{X.setLeaveWorkspaceData(e)},children:t.jsx(T,{id:"navigation.leaveWorkspace",defaultMessage:"Leave workspace"})})]})})]})]})}function yl({onClickSettings:e}){const{data:s}=Ne(),n=le(),a=Qt(),o=Kt(),{openModal:r}=Yt(),l=Nt("3905879930");var i=n?.isTeam()??!1,d=!1;if(i&&(d=l.config.get("enabled",!1)),!n||!s)return null;const g=n.isWorkspaceAccount(),f=!a;return t.jsxs("nav",{children:[t.jsx(vs,{menuItemComponent:se}),t.jsx(Je,{}),g?t.jsx(Jt,{menuItemComponent:se,routedMenuItemComponent:pl}):t.jsx(Xt,{menuItemComponent:se}),f&&t.jsx(se,{href:Pa(),target:"_blank",onClick:()=>{V.logEvent(G.clickFaqLink)},icon:No,children:t.jsx(T,{...Z.helpAndFaq})}),t.jsx(se,{onClick:e,icon:os,testId:"accounts-settings-button",children:t.jsx(T,{...Z.settings})}),i&&d&&t.jsxs(t.Fragment,{children:[t.jsx(se,{onClick:()=>{X.openModal(Zt.InviteUsersToWorkspace),V.logEvent(G.accountMemberInviteButton,{location:"dropdown-menu-click"}),Me.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"dropdown-menu-click",text:"AddTeammates",step:"OpenModal"})},icon:rs,children:t.jsx(T,{...Z.addTeammatesButton})}),t.jsx(hl,{workspace:n})]}),o&&t.jsx(Sl,{openDownloadModal:r}),t.jsx(Je,{}),t.jsx(se,{onClick:()=>{V.logEvent(G.clickLogOut,{eventSource:"mouse"}),At()},icon:ls,children:t.jsx(T,{...Z.logOut})})]})}function jl(){return st()?t.jsx(kl,{}):null}function Sl({openDownloadModal:e}){return t.jsxs("span",{children:[t.jsx(Je,{}),t.jsx(se,{icon:is,onClick:()=>{V.logEvent(G.accountMenuClickDownloadApp),e()},children:t.jsx(T,{...Z.downloadApp})})]})}function kl(){const{data:e}=Ne(),s=le(),n=Fa(),a=Da(),o=ye();if(!s||!e)return null;const r=s.isWorkspaceAccount(),l=e.accountItems.length>1;return t.jsxs(he.Button,{className:A("flex w-full max-w-[100%] items-center gap-2 rounded-lg text-sm group-ui-open:bg-token-sidebar-surface-secondary",o&&"px-2 py-1.5 hover:bg-token-main-surface-secondary",!o&&"p-2 hover:bg-token-sidebar-surface-secondary"),"data-testid":"accounts-profile-button",children:[t.jsx("div",{className:"flex-shrink-0",style:{viewTransitionName:"var(--vt-profile-avatar-sidebar)"},children:t.jsx(nt,{iconSize:"gizmo"})}),t.jsxs("div",{className:"relative -top-px grow -space-y-px truncate text-start text-token-text-primary",children:[t.jsx("div",{dir:"auto",children:a}),r||l?t.jsx("div",{className:"truncate text-xs text-token-text-secondary",dir:"auto",children:n}):null]})]})}const Z=_e({helpAndFaq:{id:"navigation.helpAndFaq",defaultMessage:"Help & FAQ"},settings:{id:"navigation.settings",defaultMessage:"Settings"},logOut:{id:"navigation.logOut",defaultMessage:"Log out"},accountSwitcherTitle:{id:"navigation.accountSwitcherTitle",defaultMessage:"Workspaces"},defaultWorkspaceTitle:{id:"useWorkspaces.defaultWorkspaceTitle",defaultMessage:"Untitled Workspace"},addWorkspaceTooltip:{id:"navigation.addWorkspaceTooltip",defaultMessage:"Create a Team workspace"},disabledWorkspaceTooltip:{id:"navigation.disabledWorkspaceTooltip",defaultMessage:"This workspace has been deactivated"},downloadApp:{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"},authenticateWithSSOToAccessWorkspace:{id:"CV7pdM",defaultMessage:"Authenticate with SSO to access this workspace"},authenticateWithoutSSOToAccessWorkspace:{id:"zfCWFh",defaultMessage:"Authenticate without SSO to access this workspace"},addTeammatesButton:{id:"inviteMemberButton.inviteMemberButton",defaultMessage:"Add Teammates"}});function Cl({citationMetadata:e,noBottomBorder:s=!1,sourceFeedback:n,setSourceFeedback:a}){const o=q(),[r,l]=u.useMemo(()=>{if(e.type!=="file")return["",""];const f=e.name.split(".");return f.length>1?[f.slice(0,-1).join("."),f[f.length-1]]:[e.name,""]},[e]),i=u.useMemo(()=>ts(Rt.GDRIVE,l),[l]),d=u.useMemo(()=>{if(e.type==="file"&&e.extra?.cloud_doc_url)try{return new URL(e.extra.cloud_doc_url).hostname}catch{return}},[e]),g=u.useCallback(f=>{a({rating:f,tags:[]})},[a]);return e.type!=="file"?null:t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-row items-center justify-between py-2",children:[t.jsxs("div",{className:"max-width-full mr-2 flex grow flex-row items-center overflow-hidden",children:[t.jsx(i,{className:"mr-2 flex-shrink-0 flex-grow-0"}),t.jsx("a",{href:e.extra?.cloud_doc_url,className:"text-token-primary flex-grow-1 flex-shrink-1 overflow-hidden text-ellipsis whitespace-nowrap text-sm",target:"_blank",rel:"noreferrer",children:r}),d&&t.jsx("div",{className:"ml-2 text-sm text-token-text-secondary",children:d})]}),t.jsxs("div",{className:"flex shrink-0 flex-row items-center",children:[t.jsx("button",{className:"rounded-md p-1 hover:bg-token-main-surface-secondary",children:n?.rating==="thumbsUp"?t.jsx(cs,{className:"icon-md-heavy text-token-text-primary",onClick:()=>g(void 0)}):t.jsx(Ro,{className:"icon-md-heavy text-token-text-secondary",onClick:()=>g("thumbsUp")})}),t.jsx("button",{className:"rounded-md p-1 hover:bg-token-main-surface-secondary",children:n?.rating==="thumbsDown"?t.jsx(us,{className:"icon-md-heavy text-token-text-primary",onClick:()=>g(void 0)}):t.jsx(Po,{className:"icon-md-heavy text-token-text-secondary",onClick:()=>g("thumbsDown")})})]})]}),n?.rating&&t.jsx("div",{className:"mb-4 flex flex-row",children:(n.rating==="thumbsDown"?Oa:Ba).map(f=>t.jsx(Wo,{className:"mr-2",$selected:n.tags.includes(f),onClick:()=>a({...n,tags:n.tags.includes(f)?n.tags.filter(b=>b!==f):[...n.tags,f]}),children:La(f,o)},f))}),!s&&t.jsx("div",{className:"w-full border-[0.5px] border-token-border-light"})]})}function Ml({documentId:e,title:s,externalUrl:n,noBottomBorder:a=!1,shouldHaveBeenIncluded:o,setShouldHaveBeenIncluded:r}){const[l,i]=u.useMemo(()=>{const f=s.split(".");return f.length>1?[f.slice(0,-1).join("."),f[f.length-1]]:[s,""]},[s]),d=u.useMemo(()=>ts(Rt.GDRIVE,i),[i]),g=u.useMemo(()=>{if(n)try{return new URL(n).hostname}catch{return}},[n]);return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex flex-row items-center justify-between py-2",children:[t.jsxs("div",{className:"max-width-full mr-2 flex grow flex-row items-center overflow-hidden",children:[t.jsx(d,{className:"mr-2 flex-shrink-0 flex-grow-0"}),t.jsx("a",{href:n,className:"text-token-primary flex-grow-1 flex-shrink-1 overflow-hidden text-ellipsis whitespace-nowrap text-sm",target:"_blank",rel:"noreferrer",children:l}),g&&t.jsx("div",{className:"ml-2 text-sm text-token-text-secondary",children:g})]}),t.jsx("div",{className:"flex shrink-0 flex-row items-center px-2",children:t.jsx(ss,{checked:o,onChange:f=>r?.(f.currentTarget.checked),id:`should-have-been-included-${e}`})})]}),!a&&t.jsx("div",{className:"w-full border-[0.5px] border-token-border-light"})]})}const wl="considered-source-should-have-been-used";function El({citations:e,rating:s,onSubmit:n,onCancel:a,messageId:o,conversationId:r,nodeId:l,conversationTree:i}){const d=q(),g=_t(),[f,b]=u.useState(""),[c,m]=u.useState(()=>{const x={};for(const y of e)y.metadata?.type==="file"&&(x[y.metadata.id]={rating:void 0,tags:[],url:y.metadata.extra?.cloud_doc_url});return x}),p=u.useMemo(()=>{const x=new Set,y=[];for(const C of e)!C.metadata||C.metadata.type!=="file"||x.has(C.metadata.id)||(y.push(C.metadata),x.add(C.metadata.id));return y},[e]),[h,v]=u.useState(!0),j=u.useMemo(()=>{const x={hasQuery:!1,lastAssistantMessage:null,lastUserMessage:null,referencedSyncedFiles:[]};if(!i||!l||!i.containsNodeOrMessageId(l))return x;const y=Wa(i,{messageId:l,entireConversation:!0});for(const C of y.messages)switch(C.type){case"fetch":case"generic_file_search_tool":case"system":continue;case"result":{C.result.chunks.forEach(k=>{k.documentId&&k.documentId.startsWith("S")&&!x.referencedSyncedFiles.some(E=>E.fileId===k.documentId)&&!p.some(E=>E.type==="file"&&E.id===k.documentId)&&x.referencedSyncedFiles.push({fileId:k.documentId,title:k.title})});continue}case"query":{x.hasQuery=!0;continue}case"visible_text":{if(C.author===dt.User){if(!x.lastUserMessage){const k=i.getConversationTurns(C.id),E=k[k.length-1].messages,w=E[E.length-1];x.lastUserMessage=w}}else if(C.author===dt.Assistant&&!x.lastAssistantMessage){const k=i.getConversationTurns(C.id),E=k[k.length-1].messages,w=E[E.length-1];x.lastAssistantMessage=w,x.lastUserMessage=null}continue}}return x},[i,p,l]),M=u.useCallback(async x=>{const y={...x,additionalSources:f,sourcesFeedback:c,consentedToShareConvoLink:h};Pt.submitCaMessageFeedback({feedback_format:Ye.ALPHA,message_id:o,conversation_id:r,text:y.textFeedback,rating:s,tags:y.tags,tag_choices:y.tagChoices,additional_sources:y.additionalSources,sources_feedback:y.sourcesFeedback,consented_to_share_convo_link:y.consentedToShareConvoLink}),g.success("Thanks for providing feedback!"),n?.(y)},[f,c,h,o,r,s,g,n]);return t.jsxs($o,{multiple:!0,allowEmptySubmit:!0,onSubmit:M,onCancel:a,tagOptions:s==="thumbsDown"?vt(Ua,d):vt(Ha,d),modalOnly:!0,modalTitle:t.jsxs("div",{className:"flex items-center gap-2",children:[s==="thumbsDown"?t.jsx(us,{className:"mb-[-6px]"}):t.jsx(cs,{className:"mb-[-6px]"}),t.jsx(T,{id:"h5nasL",defaultMessage:"Provide feedback"})]}),children:[p.length>0&&t.jsxs(t.Fragment,{children:[t.jsx("h3",{className:"mt-6 text-base font-semibold",children:t.jsx(T,{id:"G6+7UX",defaultMessage:"Sources"})}),t.jsx("div",{children:p.map((x,y)=>x?.type!=="file"?null:t.jsx(Cl,{citationMetadata:x,noBottomBorder:y===p.length-1,sourceFeedback:c[x.id],setSourceFeedback:C=>m(k=>({...k,[x.id]:{...C,url:x.extra?.cloud_doc_url}}))},x.id))})]}),j.referencedSyncedFiles.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mt-6 flex items-baseline justify-between",children:[t.jsxs("div",{className:"flex-start flex",children:[t.jsx("h3",{className:"text-base font-semibold",children:t.jsx(T,{id:"xvBe/T",defaultMessage:"Considered Sources"})}),t.jsx("p",{className:"ml-2 text-token-text-secondary",children:t.jsx(T,{id:"nX81fN",defaultMessage:"({numSources} sources)",values:{numSources:j.referencedSyncedFiles.length}})})]}),t.jsx("p",{className:"text-sm text-token-text-tertiary",children:t.jsx(T,{id:"0+Uivl",defaultMessage:"Good Source?"})})]}),t.jsx("div",{className:"mt-2 max-h-[200px] overflow-auto",children:j.referencedSyncedFiles.map((x,y)=>{const C=x.fileId.split("--")[1];if(!C)return null;const k=`https://drive.google.com/file/d/${C}`;return t.jsx(Ml,{title:x.title,documentId:x.fileId,externalUrl:k,noBottomBorder:y===j.referencedSyncedFiles.length-1,shouldHaveBeenIncluded:!!c[x.fileId],setShouldHaveBeenIncluded:E=>m(w=>{const I={...Object.fromEntries(Object.entries(w).filter(([R])=>R!==x.fileId))};return E&&(I[x.fileId]={tags:[wl],rating:"thumbsUp",url:k}),I})},x.fileId)})})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("p",{className:"text-sm text-token-text-primary",children:t.jsx(T,{id:"1ApJVo",defaultMessage:"Add any additional sources"})}),t.jsx($a,{name:"feedback",className:"mt-2",placeholder:d.formatMessage({id:"CAFeedbackModal.additionalSourcePlaceholder",defaultMessage:"(Optional) Additional sources"}),value:f,onChange:x=>b(x.target.value)})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h3",{className:"mb-2 text-base font-semibold",children:t.jsx(T,{id:"9NcQBu",defaultMessage:"Latest Exchange"})}),t.jsx("div",{className:"p-2",children:t.jsxs("div",{className:"mb-4",children:[j.lastUserMessage&&t.jsxs("div",{className:"mb-4",children:[t.jsx("p",{className:"mb-1 pl-4 text-xs text-token-text-secondary",children:t.jsx(T,{id:"QTWrtR",defaultMessage:"Your message"})}),t.jsx("div",{className:"flex justify-start",children:t.jsx("p",{className:"relative max-w-[70%] rounded-3xl bg-[#f4f4f4] px-5 py-2.5 dark:bg-token-main-surface-secondary",children:j.lastUserMessage?t.jsx(jt,{message:j.lastUserMessage,isCompletionInProgress:!1,clientThreadId:r,isUserTurn:!1,turnIndex:0,isFeedbackEnabled:!1,showEditButton:!1,onEnterEdit:()=>null,onRequestMoreCompletions:()=>null}):null})})]}),t.jsxs("div",{className:"mb-2",children:[t.jsx("p",{className:"mb-1 pl-4 text-xs text-token-text-secondary",children:t.jsx(T,{id:"ZCTm4h",defaultMessage:"ChatGPT's response"})}),t.jsx("div",{className:"relative rounded-lg bg-token-main-surface-secondary p-4 text-sm",children:j.lastAssistantMessage?t.jsx(jt,{message:j.lastAssistantMessage,isCompletionInProgress:!1,clientThreadId:r,isUserTurn:!1,turnIndex:1,isFeedbackEnabled:!1,showEditButton:!1,onEnterEdit:()=>null,onRequestMoreCompletions:()=>null}):null})]})]})}),t.jsxs("div",{className:"mt-4",children:[t.jsx("h3",{className:"mt-6 text-base font-semibold",children:t.jsx(T,{id:"c95uEW",defaultMessage:"Full conversation"})}),t.jsx("p",{className:"mb-2 mt-1 text-sm text-token-text-secondary",children:t.jsx(T,{id:"3E3ZSm",defaultMessage:"If previous portions of this conversation are important to understand your feedback, we encourage you to include it."})}),t.jsx(ss,{id:"consented-to-share-entire-convo",label:d.formatMessage({id:"5CC8r8",defaultMessage:"Share Entire Conversation"}),checked:h,onChange:x=>{v(x.currentTarget.checked)}})]})]})]})}const Il=ve(()=>be(()=>import("./sso-cxr17vc8x3qd9ws9.js").then(e=>e.C),__vite__mapDeps([38,1,2,3,5,6,18,8,39,36,37,25,40,41,42,43,44,45,46,47,26,24,19,48,49,50,51,52,53,34,35,15,54,55,56,57,58,59,60,61,62,63])).then(e=>e.CADogfoodingFeedbackModal).catch(()=>()=>null));function Tl(e){const s=Va();if(!s)return null;switch(s){case Ye.ALPHA:return t.jsx(El,{...e});case Ye.DOGFOODING:return t.jsx(Il,{...e})}}function _l({clientThreadId:e,currentModelId:s,defaultModelId:n,onCompletionFinished:a,onThreadCreated:o,preRequestCompletion:r}){const l=Ga(),i=tt(),{isUnauthenticated:d}=et(),g=qa(e),f=Tt(),b=za(e),c=le(),m=Qa(e),p=Ka(),h=Ft(),{config:v}=Bs("1013114931"),j=v.get("show_follow_ups",!1)&&c?.isPersonalAccount(),M=!p.displayingSideBySideFeedback&&j,x=u.useCallback(_=>{const P=Y.getTree(e).getLeafFromNode(_);Y.setThreadCurrentLeafId(e,P.id)},[e]),y=Ya(s),[C,k]=u.useState(),E=u.useCallback(({nodeId:_,messageId:O,rating:P})=>{const F=Y.getServerThreadId(e);V.logEvent(G.thumbRating,{id:O,threadId:F,rating:P,model:s});const S=Y.getTree(e),K=S.getNodeByIdOrMessageId(_);if(F!==void 0&&!y&&Pt.submitMessageFeedback({message_id:O,conversation_id:F,rating:P}),Y.updateTree(e,W=>{W.updateNodeMetadata(_,{rating:P})}),y){k(t.jsx(Tl,{citations:K.message.metadata?.citations??[],rating:P,conversationId:F??"",messageId:O,onSubmit:()=>{k(void 0)},onCancel:()=>k(void 0),conversationTree:S,nodeId:_},`${_}-${P}`));return}},[e,s,y]),w=u.useCallback(_=>{if(_==null||(a?.(_),h)||(b?.kind===Ls.GizmoInteraction&&Xa.handleGizmoInteracted(f,b.gizmo_id),!(m||M)))return;const P=Y.getThreadCurrentLeafId(_),F=Y.getTree(_).getMessage(P);Ja(F)||Za(F)||eo(_,F.id,s)},[b,s,a,f,m,M,h]),I=to({clientThreadId:e,continuingFromSharedConversationId:g,onCompletionFinished:w,onCreate:o}),R=u.useCallback(()=>{const _=Y.getThreadCurrentLeafId(e);if(_==null)return;const P=Y.getTree(e).getBranchFromLeaf(_);so.abortRequests(P.map(F=>F.id))},[e]),N=u.useCallback(_=>no({cancelRequests:R,clientThreadId:e,currentModelId:s,debugSettings:l,defaultModelId:n,isUnauthenticated:d,navigateToAuth:i,preRequestCompletion:r,requestCompletion:I,..._}),[R,e,s,l,n,d,i,r,I]),U=u.useCallback((_,O,P,F=!0,S="none",K)=>{const H=Y.getTree(e).getParentPromptNode(_).id;N({type:Ws.Variant,promptId:H,eventMetadata:O,cancelActiveRequests:!1,focusOnNewCompletion:F,useDefaultModel:K,completionMetadata:{variantPurpose:S,conversationMode:ao.getConversationMode(e)},turnTracker:P})},[e,N]);return{caModal:C,onRequestCompletion:N,onRequestMoreCompletions:U,onChangeItemInView:x,onChangeRating:E,cancelRequests:R}}function ys(){return{caModal:null,clientThreadId:"",focusedObject:null,currentModelId:"",isModelLoaded:!1,isInstalledApp:!1,isCompanionWindow:!1,conversationLeafId:"",onNewThread:()=>{throw new Error("onNewThread not implemented")},onRequestCompletion:()=>{throw new Error("onRequestCompletion not implemented")},onChangeItemInView:()=>{throw new Error("onChangeItemInView not implemented")},onChangeRating:()=>{throw new Error("onChangeRating not implemented")},onRequestMoreCompletions:()=>{throw new Error("onRequestMoreCompletions not implemented")},resetThread:()=>{throw new Error("resetThread not implemented")}}}const js=u.createContext(ys());function Nl(){try{return u.useContext(js)}catch{return ys()}}function Jl({children:e,clientThreadId:s,setClientThreadId:n,prefetchSearch:a}){const{createNewThread:o,onThreadCreated:r,resetThread:l}=oo({clientThreadId:s,setClientThreadId:n}),i=ro(),d=lo(s),g=io(s),f=i.id,b=d??f,c=$s(),m=co(),p=uo(),{caModal:h,onRequestCompletion:v,onChangeItemInView:j,onChangeRating:M,onRequestMoreCompletions:x}=_l({clientThreadId:s,currentModelId:b,defaultModelId:i.id,onThreadCreated:r});return t.jsx(js.Provider,{value:{caModal:h,clientThreadId:s,currentModelId:b,isModelLoaded:!!d,isInstalledApp:m,isCompanionWindow:c,focusedObject:p,conversationLeafId:g,onNewThread:o,onRequestCompletion:v,onChangeItemInView:j,onChangeRating:M,onRequestMoreCompletions:x,resetThread:l,prefetchSearch:a},children:e})}const Al=ve(()=>be(()=>import("./iuhrx6mg037mehxb.js"),__vite__mapDeps([31,1,2,3,5,6,32,33,34,35,15,36,37])));function Zl({showShareButton:e,showProfileDropdown:s,clientThreadId:n}){const a=vo(n),o=q(),r=Lt(),{layer:l}=we("1547743984");bo(n);const{onNewThread:i}=Nl(),d=l.get("show_share_button_text",!1),g=o.formatMessage({id:"GizmoInformation.shareChat",defaultMessage:"Share"}),f=ye(),b=()=>X.openSharingModal(a),c=!1,m=o.formatMessage({id:"TO+loE",defaultMessage:"New Chat"});return t.jsxs(t.Fragment,{children:[!1,r&&t.jsx(yo,{}),!1,e&&a&&t.jsx(bt,{clientThreadId:n,children:d?t.jsx(Qe,{onClick:b,icon:Ve,label:g,"data-testid":"share-chat-button",color:"secondary",className:"text-token-text-primary",style:{display:"var(--screen-size-hidden-on-compact-mode)",viewTransitionName:"var(--vt_share_chat_wide_button)"},children:g}):t.jsx(ee,{label:o.formatMessage({id:"CPEfES",defaultMessage:"Share chat"}),children:t.jsx(Ae,{"data-testid":"share-chat-button",onClick:()=>X.openSharingModal(a),icon:Ve,style:{viewTransitionName:"var(--vt_share_chat_compact_button)"}})})}),f&&e&&a&&t.jsx(bt,{clientThreadId:n,children:t.jsx(ee,{label:g,children:t.jsx(yt,{style:{display:"var(--screen-size-hidden-on-wide-mode)",viewTransitionName:"var(--vt_share_chat_compact_button)"},onClick:b,icon:t.jsx(Ve,{}),label:g})})}),f&&!c&&t.jsx(ee,{label:m,children:t.jsx("div",{style:{display:"var(--sidebar_is_open_and_pinned, none)"},children:t.jsx(yt,{className:zs.sidebarIcon,icon:t.jsx(ds,{}),onClick:()=>i(),label:m,style:{display:"var(--screen-size-hidden-on-wide-mode)"}})})}),s&&t.jsx(Pl,{clientThreadId:n})]})}function Rl({to:e,children:s,icon:n}){const a=Ze();return t.jsx(D.Item,{icon:n,onSelect:()=>a(e),children:s})}function Pl({clientThreadId:e}){const{isUnauthenticated:s}=et();return s?t.jsx(Ul,{}):t.jsx(Fl,{clientThreadId:e})}function Fl({clientThreadId:e}){const{data:s}=Ne(),n=le(),a=n?.isPlus()??!1,o=n?.isWorkspaceAccount()??!1,{openSettings:r}=mo(),l=Kt(),i=Bl(e??"none"),{openModal:d}=Yt(),g=ye(),{layer:f}=we("2888142241"),b=Nt("3905879930"),c=q();var m=n?.isTeam()??!1,p=!1;m&&(p=b.config.get("enabled",!1));const{doesUserHaveAnyAccountsWithPlusFeatures:h}=Us(),{layer:v}=we("2670443078");if(!n||!s)return null;const j=s.accountItems.length>1;let M=a;!o&&!a&&h&&v.get("is_gating_fix_enabled",!1)&&(M=h);const x=!o&&!M&&f.get("is_upgrade_in_settings",!1);return t.jsxs(Hs,{contentClassName:A(g&&"max-w-[256px] min-w-[256px] w-[256px]"),triggerButton:t.jsx("button",{onClick:()=>{V.logEvent(G.accountOpenProfileMenu),Me.logEvent("chatgpt_account_open_profile_menu")},"aria-label":c.formatMessage({id:"wz2MQV",defaultMessage:"Open Profile Menu"}),"data-testid":"profile-button",className:"flex h-10 w-10 items-center justify-center rounded-full hover:bg-token-main-surface-secondary focus-visible:bg-token-main-surface-secondary focus-visible:outline-0",style:g?{display:"var(--screen-size-hidden-on-compact-mode, flex)"}:void 0,children:t.jsx(nt,{iconSize:"medium"})}),children:[j&&t.jsx(vs,{menuItemComponent:D.Item}),j?t.jsx(D.Separator,{}):null,o?t.jsx(Jt,{menuItemComponent:D.Item,routedMenuItemComponent:Rl}):t.jsx(Xt,{menuItemComponent:D.Item}),t.jsx(D.Item,{icon:os,onClick:()=>r(),"data-testid":"settings-menu-item",children:t.jsx(T,{defaultMessage:"Settings",id:"navigation.settings.0"})}),t.jsx(D.Separator,{}),m&&p&&t.jsxs(t.Fragment,{children:[t.jsx(D.Item,{"data-testid":"settings-menu-item-invite-teammates",onClick:()=>{X.openModal(Zt.InviteUsersToWorkspace),V.logEvent(G.accountMemberInviteButton,{eventSource:"mouse",location:"profile_drop_down"}),Me.logEvent("chatgpt_invite_users_to_workspace",0,{action:"OpenAdminInviteModal",location:"dropdown-menu-click",text:"AddTeammates",step:"OpenModal"})},icon:rs,children:t.jsx(T,{...Ss.addTeammatesButton})}),t.jsx(Al,{workspace:n})]}),l&&t.jsx(Ol,{openDownloadModal:d}),x&&t.jsx(Wl,{}),i&&t.jsx(Ll,{}),(x||l||i)&&t.jsx(D.Separator,{}),t.jsx(D.Item,{onClick:()=>{V.logEvent(G.clickLogOut,{eventSource:"mouse"}),V.logLogOutButtonClicked({location:"profile_drop_down"}),At()},"data-testid":"log-out-menu-item",icon:ls,children:t.jsx(T,{defaultMessage:"Log out",id:"navigation.logOut.0"})})]})}function Dl({onClick:e,className:s,testId:n}){const a=q(),o=Ft(),r=o?a.formatMessage({id:"yqd/J5",defaultMessage:"Clear chat"}):a.formatMessage({id:"OFyxqj",defaultMessage:"New chat"});return t.jsx(ee,{sideOffset:4,label:r,className:A("flex",s),children:t.jsx(Ae,{onClick:()=>{X.closePopoverNavSidebar(),e()},icon:o?Bo:ds,surfaceContext:"secondary","aria-label":r,"data-testid":n})})}function ei({clientThreadId:e}){const[s]=ns(o=>[o.activeStageSidebar]),n=as(),a=jo({clientThreadId:e,location:"Navigation actions"});return!n&&!s?null:t.jsxs("div",{className:"flex items-center",children:[t.jsx($l,{}),t.jsx(Dl,{onClick:a})]})}function Ol({openDownloadModal:e}){return t.jsx("span",{children:t.jsx(D.Item,{icon:is,onClick:()=>{e(),V.logEvent(G.accountMenuClickDownloadApp)},children:t.jsx(T,{id:"navigation.downloadMacApp",defaultMessage:"Download the macOS app"})})})}const Bl=e=>{const{value:s}=Vs("2634628831"),n=Gs(()=>document.documentElement.dataset.searchExtension==="1"),a=fo(e,qs.Search);return!n&&a&&go()&&s},Ll=()=>t.jsx("span",{children:t.jsx(D.Item,{icon:Fo,onClick:()=>{window.open(xo),V.logEventWithStatsig(G.chatgptBrowserExtensionUserMenuClicked,"chatgpt_browser_extension_user_menu_clicked")},children:t.jsx(T,{id:"E5VPz/",defaultMessage:"Get ChatGPT search extension"})})});function Wl(){const e=Ze(),n=le()?.wasPaidCustomer()??!1,a=()=>{Me.logEvent("chatgpt_plus_upgrade_in_settings_menu_clicked"),V.logEvent(G.plusUpgradeInSettingsMenuClicked),es(e,"Upper right settings menu")};return t.jsx(D.Item,{icon:Do,onClick:a,children:n?t.jsx(T,{id:"navigation.renewPlus",defaultMessage:"Renew Plus"}):t.jsx(T,{id:"navigation.upgradePlan",defaultMessage:"Upgrade Plan"})})}function $l(){const e=q(),[s]=ns(r=>[r.activeStageSidebar]),n=as(),a=Qt(),{isUnauthenticated:o}=et();return!s&&!n||!a||o?null:t.jsx(ee,{label:e.formatMessage({id:"cElEQV",defaultMessage:"Open sidebar"}),className:"flex",children:t.jsx(Ae,{"aria-label":e.formatMessage({id:"pV/Etp",defaultMessage:"Open sidebar"}),onClick:X.toggleNavSidebar,icon:Oo,surfaceContext:"primary"})})}function Ul(){const e=tt(),s=po(),n=ho(Ss.signUpCta),{layer:a}=we("3637408529"),o=a.get("is_desktop_primary_auth_button_on_right",!1),r=()=>{e({authType:"login",callback:f=>{V.logLogInButtonClicked({location:"Chat header",provider:f})}})},l=()=>{e({authType:"signup",callback:f=>{V.logSignUpButtonClicked({location:"Chat header",provider:f})}})},i=t.jsx(Qe,{onClick:r,color:s?"primary":"secondary",size:"small","data-testid":"login-button",children:t.jsx(T,{id:"B1SN7b",defaultMessage:"Log in"})},"login"),d=t.jsx(Qe,{color:s?"secondary":"primary",onClick:l,size:"small","data-testid":"signup-button",children:t.jsx(T,{...n})},"signup"),g=s?[i,d]:[d,i];return t.jsx("div",{className:"flex items-center justify-center gap-2",children:o?g.reverse():g})}const Ss=_e({signUpCta:{id:"P6cySK",defaultMessage:"Sign up"},addTeammatesButton:{id:"inviteMemberButton.inviteMemberButton",defaultMessage:"Add Teammates"}});export{tr as A,Cl as C,ms as D,$l as E,Ho as L,Lr as M,Dl as N,Uo as O,Fl as P,Br as R,pr as T,Yl as U,xl as a,Or as b,Jl as c,Fe as d,js as e,ur as f,jt as g,Kl as h,Xl as i,wl as j,de as k,Pl as l,nr as m,cr as n,Zl as o,ei as p,_l as q,Nl as u,Pr as x,Fr as y};
//# sourceMappingURL=mggr3w25m5uvrvej.js.map
