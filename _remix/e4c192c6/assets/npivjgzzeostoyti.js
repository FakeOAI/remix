import{r as l,g2 as O,as as F,o as R,e as B,b9 as K,P as y,d as _,m as e,aC as p,aZ as $,aT as L}from"./c2lgex2wl5f4pr2u.js";import{o as U,p as C,F as W,q as D,P as X,r as q}from"./ofnn5mxnc0bbo8rs.js";import{T as H,a as E}from"./lipvjjyl3fqiz70w.js";import"./icybx1g1lu32sdf6.js";import"./kte2cd4sp8td2woj.js";const Q={strong:t=>{const{node:s,children:a,...n}=t;return e.jsx("strong",{...n,className:p(n.className,"font-semibold text-token-text-primary"),children:a})},p:t=>{const{node:s,children:a,...n}=t;return e.jsx("p",{...n,className:p(n.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:a})}};function V({message:t,isExpandable:s}){const n=t.create_time?new Date(t.create_time*1e3):Date.now(),r=D(+n,48e4);return e.jsx(X,{percentage:r,className:p("mr-4",s?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-r)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"})}function Y({headline:t,message:s}){const n=s.create_time?new Date(s.create_time*1e3):Date.now(),r=D(+n,48e4);return e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(q,{percentage:r,thickness:1/8,className:"h-5 w-5 text-token-text-primary",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-r)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"}),t]})}function Z({isExpandable:t,handleOpenSidebarSummarizer:s,summarizationHeadline:a,latestTitle:n,message:r}){return e.jsx("div",{className:"py-2",children:e.jsx(C,{buttons:t?[e.jsx($,{onClick:s,color:"secondary",className:"text-base font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(L,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")]:[],title:a,time:null,icon:e.jsx("div",{className:""}),content:`${n}...`,size:"small",progressBar:e.jsx(V,{message:r,isExpandable:t})})})}function G({handleOpenSidebarSummarizer:t,summarizationHeadline:s,message:a}){return e.jsx("div",{className:"py-2",children:e.jsx(C,{buttons:[],title:s,time:null,content:a.metadata?.finished_text??"",size:"small",disabled:!0,onClick:t})})}function T({completionInProgress:t,summarizationHeadline:s,latestTitle:a,message:n,summaryText:r,isExpandable:u,disableExpansion:m,onOpenAnalytics:i,handleOpenSidebarSummarizer:x}){return e.jsx(H,{status:t?E.Running:E.Finished,highlightedCommand:t?s==null?a:e.jsx(Y,{headline:s,message:n}):n.metadata?.finished_text??"",onOpenAnalytics:i,onClick:x,children:r&&u&&!m?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(W,{componentOverrides:Q,className:"not-prose leading-6",children:r})}):null})}function ne({messages:t,isStreaming:s,clientThreadId:a,currentGroupedMessageIndex:n,turnIndex:r}){const[u,m]=l.useState(""),[i,x]=l.useState(!1),h=O(a)===F.STREAMING,S=h||s,o=t[0].message,j=o.id,N=R.getServerThreadId(a),d=B(o),c=o.metadata?.summarization_headline,P=s&&c!=null,{toggleThreadSidebar:M}=K(),z=c!=null,A=U(),g=l.useCallback(()=>{M({type:"summarizer",clientThreadId:a,currentGroupedMessageIndex:n,turnIndex:r})},[M,a,n,r]);l.useEffect(()=>{const w=/\*\*(.*?)(?:\*\*|\n|$)/g;let v,b="";for(;(v=w.exec(d))!=null;)b=v[1].trim();b?m(b):o.metadata?.initial_text!=null&&m(o.metadata.initial_text)},[d,o.metadata?.initial_text]),l.useEffect(()=>{d.length>0&&x(!0)},[d]);const f=l.useMemo(()=>({client_thread_id:a,message_id:j,conversationId:N}),[a,j,N]);l.useEffect(()=>{i&&y.logEvent(_.receivedA8KM123Message,f)},[i]);const k=l.useCallback(()=>{y.logEvent(_.openedA8KM123Message,{...f,isStreaming:s})},[f,s]);return A?z?h||s?e.jsx(Z,{isExpandable:i,handleOpenSidebarSummarizer:g,summarizationHeadline:c,latestTitle:u,message:o}):e.jsx(G,{handleOpenSidebarSummarizer:i?g:void 0,summarizationHeadline:c,message:o}):e.jsx(T,{completionInProgress:S,summarizationHeadline:c,latestTitle:u,message:o,onOpenAnalytics:k,handleOpenSidebarSummarizer:i?g:void 0}):e.jsx(T,{completionInProgress:S,summarizationHeadline:c,latestTitle:u,message:o,onOpenAnalytics:k,summaryText:d,isExpandable:i,disableExpansion:P})}export{Q as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,ne as default};
//# sourceMappingURL=npivjgzzeostoyti.js.map
