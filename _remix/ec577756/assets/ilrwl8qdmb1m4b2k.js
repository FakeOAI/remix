import{J as G,r as u,X as T,j as e,aq as F,I as q,cU as Y,aB as N,dP as J,ak as y,aU as w,aw as O,ee as I,au as Q,av as V,eZ as X}from"./f8ly35acw3qxzik9.js";import{m as A,au as $,bJ as ee,fh as se,jM as M,c2 as te,aH as ae,cn as ne,jN as C,jO as ie,jP as oe,c8 as P,jQ as re,ek as le,U as _,eK as ce,ap as de,jR as me,iS as ue,iT as ge,jS as xe,jT as v,jU as fe,jV as h,dc as pe,jW as he,jX as Se,cc as be,jY as je,d_ as ve,jZ as E,aq as U,j_ as Ce,j$ as ke,k0 as ye,k1 as k,k2 as Ie,fL as Ne,d$ as ze,k3 as Me,k4 as Ge,k5 as Te,fe as Fe,k6 as Le,k7 as we}from"./fyt1hge1ccf9ht9j.js";import{as as Oe,bu as Ae,x as Pe,aw as _e,K as Ee,b7 as Ue,L as B,aG as Be,ad as De}from"./j2xc9x57v64ox5i6.js";import{m as D}from"./f5en9dfhjvrgarrb.js";import{a as Re}from"./ezoo8qmrv1ob9zyi.js";import{U as We,P as He}from"./bqaoisxmye8fzxbc.js";function Ke({gizmo:s,historyDisabled:i,section:t,onClick:l,isActive:m,hideOverflowMenu:x=!1}){const{clientThreadId:o}=A();$(o);const c=G(),[g,S]=u.useState(!1),[n,p]=u.useState(!1),[r,a]=u.useState(!1),d=T(),b=!!s?.gizmo.tags?.includes(ee.FirstParty),f=!1;let K=!1;const[Z,$e]=u.useState(0);let j;if(s!=null)j=s.gizmo.display.name||se;else{if(d==null)return null;i?j=c.formatMessage(M.clearChat):d.canInteractWithGizmos()?j=oe:j=c.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(D.div,{whileTap:{scale:.98},onMouseEnter:()=>{p(!0)},onMouseLeave:()=>{p(!1)},children:e.jsx(te,{loggingGizmoId:s?.gizmo.id??"primary",href:s!=null?ae(s):"/",onClick:l,showActiveIndicator:K,icon:e.jsx(ne,{gizmoId:s?.gizmo.id,isFirstParty:s==null||b,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6"}),isMenuOpen:g,label:j,hoverLeftIcon:n&&s&&f&&Z&&e.jsx("button",{onClick:z=>{z.preventDefault(),a(!r)},className:"flex text-token-text-secondary hover:text-token-text-primary",children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:r?e.jsx(Oe,{className:"icon-md"}):e.jsx(Ae,{className:"icon-md"})})})}),rightIcon:t===C.Workspace&&e.jsx(F,{side:"right",label:c.formatMessage(L.workspaceRecommended,{workspace_name:d?.name??"Your Workspace"}),children:e.jsx(Pe,{className:"icon-md text-token-text-secondary",alt:c.formatMessage(L.workspaceRecommended,{workspace_name:d?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(n||g)&&s!=null&&!f&&!x&&e.jsx("div",{className:"text-token-text-tertiary",onClick:z=>{z.preventDefault()},children:e.jsx(ie,{gizmo:s,isOpen:g,setIsOpen:S,section:t})}),!x&&e.jsx(F,{side:"right",label:c.formatMessage(i?M.clearChat:M.newChat),className:"flex items-center",children:e.jsx("button",{className:g?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:i?e.jsx(_e,{className:"icon-md"}):e.jsx(Ee,{className:"icon-md"})})})]})})}),!1]})}const L=q({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}});function R(){const s=G(),i=P(),t=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(re,{children:e.jsx(D.div,{whileTap:{scale:.98},children:e.jsx(Y,{to:le(),onClick:()=>{i.activeSidebar==="popover-nav"&&_.setActiveSidebar(!1)},children:e.jsx(ce,{icon:Ue,"data-testid":"explore-gpts-button",children:t})},"explore")})})}const Ze=2;function W({gizmos:s,isGizmoFlyout:i,isLoaded:t,maxToShowOnLoad:l=4,isScreenArch:m,showAllSidebarItems:x}){const o=xe(s,a=>a.flair.kind),c=[...(o[v.Workspace]?.map(({resource:a})=>({gizmo:a,section:C.Workspace}))??[]).slice(0,3),...o[v.FirstParty]?.map(({resource:a})=>({gizmo:a,section:C.Keep}))??[],...o[v.SidebarKeep]?.map(({resource:a})=>({gizmo:a,section:C.Keep}))??[]],g=o[v.Recent]?.slice(0,m||t?o[v.Recent]?.length:Ze).map(({resource:a})=>({gizmo:a,section:C.Recents}))??[],S=g.length,n=c.length,p=S>0;let r=[];return i&&m?r=[...c,...g]:!i&&m?r=c:(r=[...c,...g],x||(r.length>l&&n>l?r=r.slice(0,n):r.length>l&&(r=r.slice(0,l)))),{listItems:r,itemsLeft:s.length-r.length,needsToCollapseItems:p,total:s.length}}function H({gizmo:s,currentGizmoId:i,maxToShowOnLoad:t,hideOverflowMenu:l=!1}){const m=u.useRef(!1),x=!t,o=de(),[c,g]=u.useState(!1),S=P(d=>!me.isGptListCollapsed(d)),{listItems:n,needsToCollapseItems:p,itemsLeft:r}=W({gizmos:s,isGizmoFlyout:x,isLoaded:c,maxToShowOnLoad:t,isScreenArch:o,showAllSidebarItems:S});u.useEffect(()=>{c||g(!0)},[c]),u.useEffect(()=>{n.length>0&&!m.current&&(ue({namespace:ge.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),m.current=!0)},[n]);function a(d,b){const f=e.jsx(Ke,{gizmo:d,isActive:d.gizmo.id===i,section:b,hideOverflowMenu:l},d.gizmo.id);return o?e.jsx("li",{children:f}):f}return e.jsxs("div",{children:[n.map(({gizmo:d,section:b},f)=>e.jsxs(u.Fragment,{children:[f>1&&b!==n[f-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),a(d,b)]},f)),!o&&p?e.jsxs("button",{onClick:_.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(B,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:S?e.jsxs(e.Fragment,{children:[e.jsx(N,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(Be,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:r}}),e.jsx(De,{className:"icon-xs"})]})})]}):null,!o&&e.jsx(R,{})]})}function qe({currentGizmoId:s,gizmos:i,onClick:t}){const{isSidebarFlyoutOpen:l,onSidebarFlyoutOpenChange:m}=fe(),x=l(h.Gizmo);return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(J,{onOpenChange:o=>m(h.Gizmo,o),side:"right",sideOffset:4,open:x,contentAlign:"end",triggerButton:e.jsxs("button",{className:y("flex flex-1 select-none items-center gap-2 rounded-lg px-2 py-2 text-sm tracking-condensed text-token-text-secondary hover:bg-token-main-surface-secondary focus:ring-0",x&&"bg-token-main-surface-secondary"),onClick:t,children:[e.jsx(B,{className:y("icon-md mr-1 font-semibold text-token-sidebar-icon")}),e.jsx("span",{className:"text-left",children:e.jsx(N,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(w,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(H,{gizmo:i,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function Ye({currentGizmoId:s}){const{data:{gizmos:i}={}}=pe();let t=i;const l=!t||t?.length===0,{needsToCollapseItems:m}=W({gizmos:t??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return l?null:e.jsx(e.Fragment,{children:e.jsxs(he,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(N,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(R,{}),e.jsx(H,{gizmo:t??[],currentGizmoId:s,maxToShowOnLoad:Se}),m&&e.jsx(w,{children:e.jsx(qe,{currentGizmoId:s,gizmos:t??[]})})]})})}function Je({clientThreadId:s}){const i=T(),t=be(s),{isUnauthenticated:l}=O();return l?null:e.jsxs("div",{className:y(I.screenContent),children:[null,e.jsx(je,{clientThreadId:s}),i?.canInteractWithGizmos()?e.jsx(Ye,{currentGizmoId:t}):null]})}function Qe(){const s=T(),i=s?.data==null,{isUnauthenticated:t}=O(),{openSettings:l}=ve(),[m]=u.useState(()=>{const n=Q.getCookie(V.Workspace);return typeof n=="string"&&n!==X}),x=G(),{store:o,actions:c}=E(),g=o(n=>n.mode);if(!s||m&&i)return null;const S=t?e.jsx(We,{}):e.jsx(Re,{onClickSettings:()=>l()});return e.jsxs(U,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[S,e.jsx("div",{className:I.togglePinWrapper,children:e.jsx(Ce,{tooltipSideOffset:14,className:I.pinSidebarAction,icon:e.jsx(ke,{}),onActivate:n=>{n.preventDefault(),n.persist(),ye.togglePinSidebar(n,c,g===k.Floating?k.Pinned:k.Floating)},label:g===k.Floating?x.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):x.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:Ie.FloatingOrPinned})})]})}function Ve(){return e.jsx(U,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(He,{})})}function Xe(){return e.jsxs(Ne,{className:y(I.screenTrailingBarContainer),children:[e.jsx(ze,{}),e.jsx(Ve,{}),e.jsx(Qe,{})]})}function os(){const{clientThreadId:s,onNewThread:i}=A(),[t,l]=u.useState(!1),[m,x]=u.useState(!1),[o,c]=u.useState(!1),{store:g,actions:S}=E(),n=u.useCallback(a=>a===h.Conversation?t:a===h.Gizmo?m:a===h.Conversation2?o:!1,[t,m,o]),p=u.useCallback((a,d)=>{const b=f=>{a===h.Conversation?l(f):a===h.Gizmo?x(f):a===h.Conversation2&&c(f)};if(d){b(d);return}setTimeout(()=>{b(d)},100)},[]),r=u.useRef(null);return Me(()=>{p(h.Conversation,!1),p(h.Gizmo,!1),p(h.Conversation2,!1);const a=window.matchMedia("(max-width: 700px)").matches,d=we(r.current);a&&(g.getState().mode===k.Floating||d)&&setTimeout(()=>{S.closeSidebar()},100)}),e.jsxs(Ge,{value:{isSidebarFlyoutOpen:n,onSidebarFlyoutOpenChange:p},children:[e.jsx(Te,{}),e.jsx(Fe,{anchor:"vertical",className:y(I.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Le,{onNewThread:i}),ref:r,trackLeading:!0,trailing:e.jsx(Xe,{}),children:e.jsx(Je,{clientThreadId:s})})]})}export{os as C,Ke as G,H as a};
//# sourceMappingURL=ilrwl8qdmb1m4b2k.js.map
