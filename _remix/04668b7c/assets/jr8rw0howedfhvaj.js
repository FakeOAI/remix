import{m as t,aW as g,aS as u,bf as p,q as v,y as d,d as x}from"./gnjg6cp4ioz25f31.js";import{b2 as f,b3 as h,b4 as C,b5 as M}from"./9gfvdo9p41crlm24.js";import{u as b}from"./m457twa106m3ccnl.js";import{J as T}from"./im20d4w70qcxq81l.js";import{m as _}from"./fygt0p0hztlvvjc4.js";const O=s=>{for(const e of s.concat().reverse()){if("messages"in e)return e.messages[e.messages.length-1].nodeId;if("message"in e)return e.message.nodeId}},k=({clientThreadId:s,lastMessageNodeId:e})=>{const o=g(s),r=f({clientThreadId:s,conversationMode:o}),i=async()=>{h();const a=[v.CANMORE],n=new C;r({id:e,eventMetadata:{eventSource:"mouse"},systemMessage:"The user has requested the canvas tool be disabled for this conversation. You should not call the tool again.",systemMessageMetadata:{disable_tool_ids:a},turnTracker:n});const c=d.getTree(s),m=c.getConversationTurns(e).length,l=c.getParentPromptNode(e).message.id;M.logEventWithStatsig(x.canvasOptOutClicked,"chatgpt_canvas_opt_out_clicked",{num_turns:String(m),user_message_id:l}),d.setDisabledToolsForThread(s,a)};return t.jsxs(_.div,{className:"flex flex-wrap gap-2 pt-[3px]",initial:{opacity:0},animate:{opacity:1},children:[t.jsx(u,{id:"9NFVc4",defaultMessage:"Don't want me to use canvas?"}),t.jsxs("button",{onClick:i,className:"inline-flex min-h-5 w-fit select-none items-center text-start text-token-text-secondary hover:text-token-text-primary",children:[t.jsx(u,{id:"cXTG4f",defaultMessage:"I can answer in chat instead"}),t.jsx(T,{className:"icon-md text-token-text-secondary"})]})]})},y=()=>p()?.includes("canvas_opt_out"),S=({clientThreadId:s,groupedMessages:e,isFinalTurn:o,hasActiveRequest:r})=>{const i=y(),a=b(s),n=O(e);return i&&o&&!r&&!a&&n&&t.jsx(k,{clientThreadId:s,lastMessageNodeId:n})};export{S as CanvasOptOutMessage};
//# sourceMappingURL=jr8rw0howedfhvaj.js.map
