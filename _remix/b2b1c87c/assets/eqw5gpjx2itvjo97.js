const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kjesdiczym71yn9t.js","assets/d4leej2qw3qpt1pk.js","assets/okxdn8hddblnp0ou.js","assets/root-eakuwlaq.css","assets/c03cyiw531bfxkuh.js","assets/fz81i3fl330y5ew1.js","assets/conversation-small-eplmind9.css","assets/dywhugbdhvsxyyf5.js","assets/hyhugnup8jw7vymu.js","assets/f2il2wfcdnz6iwbp.js"])))=>i.map(i=>d[i]);
import{a1 as L,aM as ae,r as C,l as e,a2 as U,a5 as n,b5 as O,a6 as P,d as T,a7 as $,dc as G,b0 as te,m as se,u as W,Z as ie,aF as ne,aG as oe,aP as re,ad as ce,bO as B,bS as M,bP as z,e0 as de,W as V,bq as le,P as me,ek as ue,el as ge}from"./d4leej2qw3qpt1pk.js";import{aF as he,aT as A,aJ as v,Y as pe,ag as I,X as f,Q as xe,R as fe,S as ve,cF as q,cm as we,cG as ye,cH as be,b7 as D,ce as K,a_ as je}from"./fz81i3fl330y5ew1.js";import{y as Se,z as Ge,h as Ie}from"./dywhugbdhvsxyyf5.js";import{z as ke,a8 as Ce,l as Me,S as ze,aR as Pe,K as Te,D as Ae,a2 as Fe,b as _e,aO as De,bd as H,k as Ne,be as Ee,B as Le,aA as Ue,a1 as Oe,aH as $e}from"./okxdn8hddblnp0ou.js";import{C as We}from"./htugu8grc2zkjf6t.js";import{a as Be,T as Ve}from"./hyhugnup8jw7vymu.js";import{G as k}from"./lb6o9fdebdcca1rq.js";import{R as qe}from"./fjudouet3a78cgv3.js";import{B as J,D as r}from"./c03cyiw531bfxkuh.js";import{b as Ke,c as He}from"./o6zznuciznt3qyz0.js";import{G as Je}from"./g3ajm57p2xx770mv.js";import"./f2il2wfcdnz6iwbp.js";import"./kd847zqymupw3yev.js";import"./c6czee0ptvr50b6w.js";import"./ohxwppau79l98jz8.js";import"./gcg3s799tx64lwzh.js";import"./9icnhfjc3wq4r4fn.js";import"./d4t0vtbfqthmj7np.js";import"./jj9lp929lmdlnrht.js";function Qe(t){return T({mutationFn:async({message:a,includeFrom:s})=>{await I.sendFeedbackEmail(t,a,s)}})}const Xe=({gizmo:t})=>{const a=he(),s=A(v.GPTFeedbackEmail),i=()=>f.closeModal(v.GPTFeedbackEmail),d=L(),p=ae(),[l,c]=C.useState(""),[m,o]=C.useState(!0),u=Qe(t.gizmo.id),g=l.length===0;return e.jsx(U,{type:"success",title:d.formatMessage(S.title,{name:t.gizmo.display.name}),isOpen:s,onClose:i,size:"custom",showCloseButton:!0,className:"max-w-xl overflow-y-auto",hideSeparator:!0,children:e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"-mt-4 flex flex-grow flex-col space-y-4",children:[e.jsx(pe,{className:"mb-1 w-full resize-none overflow-y-auto rounded-md bg-transparent focus:border-gray-200 focus:ring-gray-200 dark:focus:border-white dark:focus:ring-white",placeholder:`Write feedback about ${t.gizmo.display.name}...`,value:l,rows:4,onChange:x=>c(x.target.value)}),e.jsxs("div",{className:"flex flex-row items-center space-x-2 self-start",children:[e.jsx("input",{type:"checkbox",checked:m,onChange:x=>o(x.target.checked)}),a&&e.jsx("span",{className:"text-sm",children:e.jsx(n,{...S.includeFrom,values:{email:e.jsx("strong",{children:a.email})}})})]}),e.jsx(O,{color:"primary",disabled:g,onClick:async()=>{await u.mutateAsync({message:l,includeFrom:m}),p.success(d.formatMessage(S.successToast),{duration:3}),i()},children:e.jsx(n,{...S.send,values:{name:t.gizmo.author.display_name}})})]})})})},S=P({title:{id:"GizmoFeedbackEmailModal.title",defaultMessage:"Feedback about {name}"},send:{id:"GizmoFeedbackEmailModal.sendTo",defaultMessage:"Send To {name}"},successToast:{id:"GizmoFeedbackEmailModal.successToast",defaultMessage:"Feedback sent"},includeFrom:{id:"GizmoFeedbackEmailModal.includeFrom",defaultMessage:"Include my email address {email}"}});function Ye(t){const a=W();return T({mutationFn:async({actionId:s,domain:i,settings:d})=>I.upsertUserActionSettings(s,i,d),onSuccess:()=>{a.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:t}]})}})}function Ze(t){const a=W();return T({mutationFn:async({pluginId:s})=>{await ie.deletePluginUserSettings({pluginId:s})},onSuccess:()=>{a.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:t}]})}})}const Re=({gizmo:t})=>{const{data:a,isLoading:s}=Se(t.gizmo.id,!0),i=A(v.GPTPrivacySettings),d=()=>f.closeModal(v.GPTPrivacySettings),p=L(),[l,c]=C.useState("actions"),m=a!=null&&a.settings.some(o=>o.oauth_status!=null&&t.tools.some(u=>{var g;return u.type===G.JIT_PLUGIN&&((g=u.metadata)==null?void 0:g.action_id)===o.action_id}));return l==="connected_accounts"&&!m&&c("actions"),e.jsx(U,{title:p.formatMessage(w.title),isOpen:i,onClose:d,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:s?e.jsx(te,{}):e.jsxs(xe,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:l,onValueChange:o=>{c(o)},children:[m&&e.jsxs(fe,{className:se("flex min-w-[180px] max-w-[200px] flex-shrink-0 flex-col gap-2"),children:[e.jsx(N,{value:"actions",message:w.actions}),m&&e.jsx(N,{value:"connected_accounts",message:w.connectedAccounts})]}),e.jsxs("div",{className:"flex-1 text-sm",children:[l==="actions"&&e.jsxs(E,{children:[e.jsx(n,{...w.allowedActionsDesc,values:{gizmoName:t.gizmo.display.name}}),a==null?void 0:a.settings.map((o,u)=>{var x;const g=(x=t.tools)==null?void 0:x.find(y=>{var b;return y.type===G.JIT_PLUGIN&&((b=y.metadata)==null?void 0:b.action_id)===o.action_id});return g&&e.jsx(ea,{gizmoId:t.gizmo.id,actionSettings:o,actionTool:g},u)})]}),l==="connected_accounts"&&e.jsxs(E,{children:[e.jsx(n,{...w.connectedAccountsDesc,values:{gizmoName:t.gizmo.display.name}}),e.jsx("div",{children:a==null?void 0:a.settings.map((o,u)=>{var x;const g=(x=t.tools)==null?void 0:x.find(y=>{var b;return y.type===G.JIT_PLUGIN&&((b=y.metadata)==null?void 0:b.action_id)===o.action_id});return g&&o.oauth_status&&e.jsx(aa,{gizmoId:t.gizmo.id,actionSettings:o,actionTool:g},u)})})]})]})]})})};function N({value:t,message:a}){return e.jsx(ve,{className:"flex rounded-md px-2 py-1.5 text-sm text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary",value:t,children:e.jsx("div",{className:"truncate",children:e.jsx(n,{...a})})})}function ea({gizmoId:t,actionSettings:a,actionTool:s}){var l,c,m;const i=Ye(t),d=(l=a.action_settings)==null?void 0:l.all,p=o=>{var u,g;(u=s.metadata)!=null&&u.action_id&&((g=s.metadata)!=null&&g.domain)&&i.mutateAsync({actionId:s.metadata.action_id,domain:s.metadata.domain,settings:{all:o}})};return e.jsx("div",{children:e.jsxs(Q,{className:"border-b border-black/10 dark:border-white/10",children:[e.jsxs("div",{className:"flex flex-row space-x-4",children:[e.jsx("div",{className:"font-semibold",children:(c=s.metadata)==null?void 0:c.domain}),e.jsxs("a",{href:(m=s.metadata)==null?void 0:m.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"flex items-center gap-1 text-token-text-tertiary hover:cursor-pointer hover:text-token-text-secondary",children:[e.jsx(n,{...w.privacyPolicyLink}),e.jsx(ke,{className:"icon-md"})]})]}),e.jsxs("select",{value:d?"always_allow":"unset",onChange:o=>p(o.target.value),className:"rounded border-none bg-token-main-surface-primary text-sm",children:[e.jsx("option",{value:"always_allow",children:e.jsx(n,{...w.alwaysAllowDropdown})}),e.jsx("option",{value:"unset",children:e.jsx(n,{...w.askDropdown})})]})]})})}function aa({gizmoId:t,actionSettings:a,actionTool:s}){var p;const i=Ze(t),d=a.oauth_status==="valid";return e.jsxs(Q,{children:[e.jsx("div",{className:"font-semibold",children:(p=s==null?void 0:s.metadata)==null?void 0:p.domain}),e.jsx(O,{color:"secondary",size:"small",onClick:()=>{var l,c,m,o,u;(l=s.metadata)!=null&&l.action_id&&((c=s.metadata)!=null&&c.domain)&&(d?i.mutateAsync({pluginId:(m=s.metadata)==null?void 0:m.action_id}):I.doOAuthRedirect(t,(o=s.metadata)==null?void 0:o.action_id,(u=s.metadata)==null?void 0:u.domain,window.location.href))},children:e.jsx(n,{...d?w.logout:w.login})})]})}const E=$.div`flex flex-col gap-6`,Q=$.div`flex flex-row justify-between py-3 items-center`,w=P({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}}),ta=ne(()=>oe(()=>import("./kjesdiczym71yn9t.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(t=>t.GizmoKeepInSidebarMenuItem));function Ia({children:t,clientThreadId:a,gizmoResource:s,showReportModal:i,inMobileHeader:d}){return e.jsxs(e.Fragment,{children:[e.jsx(J,{contentAlign:d?"center":"start",size:"small",triggerButton:t,children:e.jsx(ia,{clientThreadId:a,gizmoResource:s,showReportModal:i})}),e.jsx(sa,{gizmoResource:s})]})}function sa({gizmoResource:t}){const a=A(v.GPTRemoveThirdParty),s=re(),i=q(t);return e.jsxs(e.Fragment,{children:[e.jsx(Ke,{gizmoId:t.gizmo.id,creatorId:t.gizmo.author.user_id}),e.jsx(Re,{gizmo:t}),i&&e.jsx(Xe,{gizmo:t}),i&&e.jsx(Je,{gizmo:t}),e.jsx(qe,{gpt:t,isOpen:a,onClose:()=>f.closeModal(v.GPTRemoveThirdParty),account:s})]})}function ia({clientThreadId:t,gizmoResource:a,showReportModal:s}){var _;const i=ce(),d=we(a),p=ye(a),l=Ge(a.gizmo.id),c=B(),m=be(a),o=a.gizmo.share_recipient===D.Marketplace||a.gizmo.share_recipient===D.Link,u=!m&&o,g=M("1825130190").value,x=M("3645668434").value,y=g&&!m&&q(a),b=(c==null?void 0:c.includes(z.GizmoSupportEmails))&&!m&&a.gizmo.author.will_receive_support_emails&&y,X=de(),F=Be(t),Y=K(z.WorkspaceShareLinks),{isUnauthenticated:Z}=V(),R=F&&Y&&!Z,ee=le();return e.jsxs(e.Fragment,{children:[e.jsx(r.Item,{onClick:()=>{me.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:a.gizmo.id}),je(ee,`/g/${a.gizmo.short_url}`)},icon:Ce,children:e.jsx(n,{...h.newChat})}),e.jsx(r.Item,{onClick:()=>f.openModal(v.GPTDetails),icon:Me,children:e.jsx(n,{...h.about})}),((_=a.tools)==null?void 0:_.find(j=>j.type===G.JIT_PLUGIN))&&e.jsx(r.Item,{onClick:()=>f.openModal(v.GPTPrivacySettings),icon:ze,children:e.jsx(n,{...h.privacySettings})}),d&&e.jsx(r.Item,{onClick:()=>{i.push(l,void 0,{shallow:!0})},icon:Pe,children:e.jsx(n,{...h.customize})}),!d&&p&&x&&e.jsxs(e.Fragment,{children:[e.jsx(r.Item,{onClick:async()=>{i.push(`/g/${a.gizmo.id}/view`)},icon:Te,children:e.jsx(n,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),e.jsx(r.Item,{onClick:async()=>{const j=await I.copyGizmo({gizmoId:a.gizmo.id});j.gizmo.id&&i.push(`/gpts/editor/${j.gizmo.id}`)},icon:Ae,children:e.jsx(n,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),e.jsx(ta,{gizmoResource:a}),e.jsx(He,{gizmoResource:a}),b&&e.jsx(r.Item,{onClick:()=>f.openModal(v.GPTFeedbackEmail),icon:Fe,children:e.jsx(n,{...h.feedbackEmail})}),y&&e.jsx(r.Item,{onClick:()=>f.openModal(v.GPTReview),icon:_e,children:e.jsx(n,{...h.reviewGPT})}),u&&e.jsx(r.Item,{onClick:s,icon:De,children:e.jsx(n,{...h.report})}),R&&e.jsx(r.Item,{onClick:()=>f.openSharingModal(F),icon:H,children:e.jsx(n,{...h.shareChat})}),X&&e.jsxs(e.Fragment,{children:[e.jsx(r.Separator,{}),e.jsx(r.Item,{color:"danger",onClick:()=>f.openModal(v.GPTRemoveThirdParty),icon:Ne,children:e.jsx(n,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),(c==null?void 0:c.includes("debug"))&&e.jsxs(e.Fragment,{children:[e.jsx(r.Separator,{}),e.jsx(r.Item,{onClick:()=>{i.push(Ie(a),void 0)},children:"(Internal) See share page"})]})]})}const na=({clientThreadId:t})=>{const a=B(),s=a==null?void 0:a.includes("debug"),i=Ve.getServerThreadId(t),d=K(z.WorkspaceShareLinks),{isUnauthenticated:p}=V(),l=d&&i&&!p,c=We.useStore(),{value:m}=M("3653083604");return e.jsxs(e.Fragment,{children:[l&&e.jsx(r.Item,{onClick:()=>f.openSharingModal(i,"History Item Menu"),icon:H,children:e.jsx(n,{...h.shareChat})}),ue&&m&&e.jsx(r.Item,{onClick:()=>{ge(!0),c.setThread(t)},icon:Ee,children:e.jsx(n,{...h.openInCompanionWindow})}),e.jsx(r.Item,{disabled:!i,onClick:()=>{setTimeout(()=>{i&&k.publish({kind:"editTitle",serverThreadId:i})},100)},icon:Le,children:e.jsx(n,{...h.renameChat})}),e.jsx(r.Item,{disabled:!i,onClick:()=>{i&&k.publish({kind:"archiveChat",serverThreadId:i})},icon:Ue,children:e.jsx(n,{...h.archiveChat})}),e.jsx(r.Item,{color:"danger",disabled:!i,onClick:()=>{i&&k.publish({kind:"deleteChat",serverThreadId:i})},icon:Oe,children:e.jsx(n,{...h.deleteChat})}),s&&e.jsxs(e.Fragment,{children:[e.jsx(r.Separator,{}),e.jsx(r.Item,{onClick:()=>f.toggleActiveSidebar("debug"),icon:$e,children:e.jsx(n,{...h.debugChat})})]})]})},ka=({clientThreadId:t,children:a,onOpenChange:s})=>e.jsx(J,{onOpenChange:s,side:"bottom",contentAlign:"start",triggerButton:a,size:"auto",children:e.jsx(na,{clientThreadId:t})}),h=P({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},openInCompanionWindow:{defaultMessage:"Open in Companion Window",id:"GizmoInformation.openInCompanionWindow"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}});export{ka as GizmoConversationOptionsDropdown,Ia as GizmoInformationDropdown,ia as GizmoInformationDropdownItems};
//# sourceMappingURL=eqw5gpjx2itvjo97.js.map
