var _r=Object.defineProperty;var Dr=(r,e,t)=>e in r?_r(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var M=(r,e,t)=>Dr(r,typeof e!="symbol"?e+"":e,t);import{a6 as qe,n as ke,m as F,r as x,a1 as Ze,aM as Vr,d5 as Zt,l as g,bJ as Hr,a5 as jr,D as $r,c as zr,fb as Ur,fa as Fr}from"./d4leej2qw3qpt1pk.js";import{Z as Qe,_ as D,$ as Qt,a0 as et,a1 as Kr,a2 as er,a3 as tt,a4 as Wr,a5 as Gr,a6 as tr,a7 as Xr,a8 as Yr,a9 as Fe,aa as Jr,ab as qr,ac as ft,C as Zr,B as Qr,H as en,z as tn,x as rn,ad as nn,y as on,K as sn,R as an,u as rt,v as ln,ae as rr,J as nr,af as Ke,ag as cn,ah as or,Q as nt,ai as un,S as dn,U as pn,aj as Se,V as mt,W as hn,X as fn,Y as gt}from"./fn9y0pxu5hqktfmw.js";import{mB as he,kT as V,mC as Ve,an as me,hC as We,mD as mn,gg as gn,mE as Mn,mF as wn,mG as kn,mH as Nn,mI as xn,aC as yn,eN as j,mJ as Mt,eJ as wt,ih as sr,mK as bn,mL as En,az as Cn,gQ as ir,mM as Sn,mN as Tn,mO as vn,io as ar,kW as ot,eH as kt,l2 as Pn,mP as Nt,mQ as An,eI as xt,l0 as lr,eO as ae,eM as In,eK as st,A as Be,hO as On,bE as Rn,mR as Bn,h9 as Ln,is as Te,it as _n,jF as yt,he as Dn,jG as bt,iu as Vn,jH as Hn}from"./fz81i3fl330y5ew1.js";import{x as q,P as K,e as $,w as pe,D as Q,a2 as jn,a3 as Ge,g as $n,F as O,R as Ne,c as xe,f as cr,S as it,l as zn,d as Un,W as Fn,a4 as Kn,a5 as Wn,a6 as Gn,M as Xn,N as Yn,A as Et,U as Jn,a7 as qn,X as ur,E as dr}from"./nfvveyk9d6ahnf1o.js";import{w as Zn,c as pr,e as Qn,t as Xe,d as eo,b as hr}from"./mfpofkv0qdfmmagx.js";import{f as Ct,a as to,p as ro,h as no,R as oo}from"./mfrovjzsc3yawiw6.js";import{k as at,g as so,h as io,i as ao,u as lo,r as St}from"./irnny8s0apugp4gr.js";import{C as Tt,d as vt,E as Pt,k as co,I as uo,c as po}from"./fi1eifnoy9tspxqm.js";import{m as de}from"./f2il2wfcdnz6iwbp.js";import{D as ve}from"./c03cyiw531bfxkuh.js";import{c8 as ho,c9 as fo,ca as mo,ax as go,a3 as Mo}from"./okxdn8hddblnp0ou.js";import"./ftyo1ydzzolwv3v6.js";import"./blb377wa0lv0gl05.js";import"./hyhugnup8jw7vymu.js";import"./dywhugbdhvsxyyf5.js";import"./c6czee0ptvr50b6w.js";import"./ohxwppau79l98jz8.js";import"./nek0ozgkk626juis.js";import"./g6n33634fp88d2bg.js";import"./goojceouqjho7tc9.js";import"./jj9lp929lmdlnrht.js";import"./kd847zqymupw3yev.js";import"./omv76i1fiqjc3j0r.js";class fr extends he{unistNodeName(){return"link"}static proseMirrorMarkName(){return"link"}proseMirrorMarkSpec(){return{attrs:{href:{},title:{default:null},disabled:{default:!0}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs(e){return{href:e.getAttribute("href"),title:e.getAttribute("title")}}}],toDOM(e){return["a",{...e.attrs,...e.attrs.disabled?{href:void 0}:{}}]}}}unistNodeToProseMirrorNodes({node:e,convertedChildren:t,schema:n}){const{url:o,title:s}=e;return t.map(i=>i.mark(i.marks.concat([n.marks[this.proseMirrorMarkName()].create({href:o,title:s})])))}processConvertedUnistNode(e,t){return{type:this.unistNodeName(),url:t.attrs.href,...t.attrs.title!=null&&{title:t.attrs.title},children:[e]}}}function wo(r,e){const t=[];return r.descendants((n,o)=>{n.marks.forEach(s=>{s.type===e&&t.push({from:o,to:o+n.nodeSize,mark:s})})}),t}function ko(r,e,t){const n=e.mark.type,o={...e.mark.attrs,disabled:t};return r.removeMark(e.from,e.to,n),r.addMark(e.from,e.to,n.create(o)),r}const lt=new q("disableUnsafeLinks");function No(r,e){return r.setMeta(lt,{safeUrls:e})}function xo(r){return r.getMeta(lt)??null}function yo(r=new Set){return new K({key:lt,state:{init(e){return{safeUrls:r}},apply(e,t){const n=xo(e);if(n==null)return t;const{safeUrls:o}=n;return{...t,safeUrls:o}}},appendTransaction(e,t,n){const o=this.getState(n),s=n.tr,i=n.schema.marks[fr.proseMirrorMarkName()],a=wo(n.doc,i);let l=!1;return a.forEach(u=>{const c=u.mark.attrs.href,d=o.safeUrls.has(c),p=u.mark.attrs.disabled===!0;d===p&&(ko(s,u,!d),l=!0)}),l?s:null}})}const Le=new q("placeholder");function bo(r,e){return r.setMeta(Le,{isDisabled:e})}function Eo(r){return r.getMeta(Le)??null}function Co(r,e=!1){return new K({key:Le,state:{init(){return{isDisabled:e}},apply(t,n){const o=Eo(t);return(o==null?void 0:o.isDisabled)!=null?{...n,isDisabled:o.isDisabled}:n}},props:{decorations(t){const{doc:n,selection:o}=t;if(Le.getState(t).isDisabled||!(o instanceof $&&o.empty))return null;const{$cursor:i}=o;if(!i||!r)return null;const a=i.start();if(!((i.parent.isTextblock||i.parent.type.name==="doc")&&i.pos===a&&i.node().content.size===0))return null;const u=pe.widget(a,()=>{const c=document.createTextNode(r.formatMessage(So.placeholder)),d=document.createElement("span");return d.className="text-token-text-tertiary dark:text-gray-500",d.appendChild(c),d});return Q.create(n,[u])}}})}const So=qe({placeholder:{id:"n2B51U",defaultMessage:"Write something..."}});class To extends V{unistNodeName(){return"blockquote"}static proseMirrorNodeName(){return"blockquote"}proseMirrorNodeSpec(){return{content:"block+",group:"block",parseDOM:[{tag:"blockquote"}],toDOM(){return["blockquote",0]}}}proseMirrorInputRules(e){return[Qe(/^\s{0,3}>\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Mod->":Zn(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return D(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}function vo(r,e,t,n){for(let o=0;o<e.length;o++){let{$from:s,$to:i}=e[o],a=s.depth===0?r.inlineContent&&r.type.allowsMarkType(t):!1;if(r.nodesBetween(s.pos,i.pos,(l,u)=>{if(a||!n)return!1;a=l.inlineContent&&l.type.allowsMarkType(t)}),a)return!0}return!1}function At(r){var t;const e=/^\s*/.exec(r);return((t=e==null?void 0:e[0])==null?void 0:t.length)??0}function It(r){var t;const e=/\s*$/.exec(r);return((t=e==null?void 0:e[0])==null?void 0:t.length)??0}function Po(r,e,t){for(;e>0;){const n=e-1;if(!r.rangeHasMark(n,e,t))break;e=n}return e}function Ao(r,e,t){for(;e<r.content.size&&r.rangeHasMark(e,e+1,t);)e+=1;return e}function mr(r,e,t,n=null){var l,u,c,d;const{selection:o}=r;if(!(o instanceof $))return!1;let{empty:s,$cursor:i,ranges:a}=o;if(s&&!i||!vo(r.doc,a,t,!0))return!1;if(i)t.isInSet(r.storedMarks||i.marks())?e(r.tr.removeStoredMark(t)):e(r.tr.addStoredMark(t.create(n)));else{let p=r.tr;const f=!a.some(h=>r.doc.rangeHasMark(h.$from.pos,h.$to.pos,t));for(let h=0;h<a.length;h++){let{$from:m,$to:w}=a[h],N=m.pos,k=w.pos;const b=r.doc.textBetween(N,k,`
`);if(/^\s*$/.test(b))continue;const E=((l=m.nodeBefore)==null?void 0:l.text)??"",C=((u=m.nodeAfter)==null?void 0:u.text)??"",A=((c=w.nodeBefore)==null?void 0:c.text)??"",L=((d=w.nodeAfter)==null?void 0:d.text)??"";if(f){let P=At(C),I=It(A);N+P<k&&(N+=P,k-=I),N=Po(r.doc,N,t),k=Ao(r.doc,k,t),p.removeMark(N,k,r.schema.marks[Ve.proseMirrorMarkName()]),p.addMark(N,k,t.create(n))}else{const P=It(E),I=At(L);N-=P,k+=I,p.removeMark(N,k,t)}}e(p.scrollIntoView())}return!0}function Ot(r,e=null){return(t,n)=>n?mr(t,n,r,e):!0}class J extends Qt{constructor(t,n){super(t,(o,s,i,a)=>this.markHandler(o,s,i,a));M(this,"markType");this.markType=n}static markApplies(t,n,o){for(const s of n){const{$from:i,$to:a}=s;let l=i.depth===0?t.type.allowsMarkType(o):!1;if(t.nodesBetween(i.pos,a.pos,u=>l?!1:(l=u.inlineContent&&u.type.allowsMarkType(o),!0)),l)return!0}return!1}markHandler(t,n,o,s){var d;if(!(t.selection instanceof $))return null;const i=t.doc.resolve(o),a=t.doc.resolve(s),l=[new jn(i,a)];if(!J.markApplies(t.doc,l,this.markType))return null;const u=((d=t.doc.nodeAt(o))==null?void 0:d.marks.map(p=>p.type))??[];u.push(this.markType);const c=t.tr.replaceWith(o,s,this.markType.schema.text(n[1]));for(const p of u)c.addMark(c.mapping.map(o),c.mapping.map(s),p.create(null));for(const p of u)c.removeStoredMark(p);return c.insertText(n[2])}}class gr extends he{unistNodeName(){return"strong"}static proseMirrorMarkName(){return"strong"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"b"},{tag:"strong"},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM(){return["strong"]}}}proseMirrorInputRules(e){return[new J(/\*\*([^\s](?:.*[^\s])?)\*\*([\s\S])$/,e.marks[this.proseMirrorMarkName()]),new J(/__([^\s](?:.*[^\s])?)__([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Mod-b":Ot(t),"Mod-B":Ot(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return t.map(o=>o.mark(o.marks.concat([e.marks[this.proseMirrorMarkName()].create(n)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}const Mr=92,Io=10,_e="backslashEscape";function Oo(r,e,t){function n(o){return o==null||o===Io?(r.exit(_e),e(o)):t(o)}return o=>o!==Mr?t(o):(r.enter(_e),r.consume(o),n)}function Ro(){return{text:{[Mr]:{name:_e,tokenize:Oo}}}}function Bo(){const r=this.data();r.micromarkExtensions??(r.micromarkExtensions=[]),r.micromarkExtensions.push(Ro()),r.fromMarkdownExtensions??(r.fromMarkdownExtensions=[]),r.fromMarkdownExtensions.push({enter:{[_e](e){this.enter({type:"break"},e),this.exit(e)}}})}class Lo extends V{unistNodeName(){return"break"}static proseMirrorNodeName(){return"hard_break"}proseMirrorNodeSpec(){return{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],marks:Ve.proseMirrorMarkName(),toDOM(){return["br"]}}}proseMirrorKeymap(e){const t=pr(Qn,(o,s)=>(s&&s(o.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)),n=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;return{"Mod-Enter":t,"Shift-Enter":t,...n&&{"Ctrl-Enter":t}}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return D(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}unifiedInitializationHook(e){return e.use(Bo)}}const He="code_block",Rt="```";function _o(r,e){const{start:t,end:n}=r;return t==null||n==null?null:{start:t+Rt.length+(e.lang??"").length,end:n-Rt.length}}class Do extends V{dependencies(){return[new et]}unistNodeName(){return"code"}static proseMirrorNodeName(){return He}proseMirrorNodeSpec(){return{content:"text*",group:"block",code:!0,defining:!0,marks:[Ve.proseMirrorMarkName()].join(" "),attrs:{lang:{default:null},isDarkMode:{default:null}},parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM(){return["pre",["code",0]]}}}proseMirrorInputRules(e){return[Kr(/^\s{0,3}```$/,e.nodes[this.proseMirrorNodeName()])]}unistNodeToProseMirrorNodes({node:e,attrs:t,schema:n}){const{lang:o}=e;return D(this.proseMirrorNodeName(),n,er(e,n,{...t,..._o(t,e)??{}}),{lang:o,...t})}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),value:t.map(n=>n.type==="startend"?n.children.map(o=>o.value).join(""):n.value).join(""),lang:e.attrs.lang}]}}class Vo extends V{unistNodeName(){return"thematicBreak"}static proseMirrorNodeName(){return"horizontal_rule"}proseMirrorNodeSpec(){return{group:"block",parseDOM:[{tag:"hr"}],toDOM(){return["div",["hr"]]}}}proseMirrorInputRules(e){return[new Qt(/^\s{0,3}(?:\*\*\*|---|___)\n$/,(t,n,o,s)=>t.tr.replaceWith(o,s,D(this.proseMirrorNodeName(),e,[])??[]))]}proseMirrorKeymap(e){return{"Mod-_":(t,n)=>(n&&n(t.tr.replaceSelectionWith(e.nodes[this.proseMirrorNodeName()].create()).scrollIntoView()),!0)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return D(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(){return[{type:this.unistNodeName()}]}}class Ho extends V{dependencies(){return[new tt]}unistNodeName(){return"image"}static proseMirrorNodeName(){return"image"}proseMirrorNodeSpec(){return{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{getAttrs(e){return{src:e.getAttribute("src"),alt:e.getAttribute("alt"),title:e.getAttribute("title")}},tag:"img[src]"}],toDOM(e){return["img",e.attrs]}}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:o}){const{url:s,alt:i,title:a}=e;return D(this.proseMirrorNodeName(),t,n,{...o,src:s,alt:i,title:a})}proseMirrorNodeToUnistNodes({attrs:e}){return[{type:this.unistNodeName(),url:me(e.src),alt:me(e.alt,void 0),title:me(e.title,void 0)}]}}class jo extends he{unistNodeName(){return"inlineCode"}static proseMirrorMarkName(){return"code"}proseMirrorMarkSpec(){return{inclusive:!1,parseDOM:[{tag:"code"}],toDOM(){return["code"]}}}proseMirrorInputRules(e){return[new J(/`([^\s](?:.*[^\s])?)`([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Ctrl-`":Xe(t)}}unistNodeToProseMirrorNodes({node:e,schema:t,attrs:n}){const o=er(e,t,n,[t.marks[this.proseMirrorMarkName()].create(n)]);return o?[o]:[]}processConvertedUnistNode(e){return{type:this.unistNodeName(),value:e.value}}}class wr extends he{unistNodeName(){return"emphasis"}static proseMirrorMarkName(){return"em"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style",getAttrs:e=>e==="italic"&&null}],toDOM(){return["em"]}}}proseMirrorInputRules(e){return[new J(new RegExp("(?<!\\*)\\*([^\\s*](?:.*[^\\s])?)\\*([^*])$"),e.marks[this.proseMirrorMarkName()]),new J(new RegExp("(?<!_)_([^\\s_](?:.*[^\\s])?)_([^_])$"),e.marks[this.proseMirrorMarkName()])]}proseMirrorKeymap(e){const t=e.marks[this.proseMirrorMarkName()];return{"Mod-i":Xe(t),"Mod-I":Xe(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return t.map(o=>o.mark(o.marks.concat([e.marks[this.proseMirrorMarkName()].create(n)])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}function kr(r){return"children"in r}const ce="lineEndingBlank";function Bt(r){return r.type===ce}const $o=({startIndex:r,endIndex:e,depth:t,isLastChild:n,parent:o=null})=>{const s=e-r;return t>0&&(o==null?void 0:o.type)!=="list"?s:n||r===0?s-Math.floor((s+1)/2):s-Math.floor((s-1)/2)};function zo(){const r=this.data();r.fromMarkdownExtensions??(r.fromMarkdownExtensions=[]),r.fromMarkdownExtensions.push({enter:{lineEndingBlank(t){this.enter({type:ce},t)}},exit:{lineEndingBlank(t){this.exit(t)}}});const e=(t,n=0)=>{if(!kr(t))return;const{children:o}=t;let s=0,i=null,a=null;const l=o.length;for(let u=0;u<l;u++){const c=o[u-s];e(c,n+1);const{type:d}=c,f=u===l-1&&d===ce;if(d===ce&&i==null?i=u:d!==ce&&i!=null?a=u:f&&i!=null&&(a=u+1),i!=null&&a!=null){const h=$o({startIndex:i,endIndex:a,depth:n,isLastChild:f,parent:t});o.splice(i-s,h),i=null,a=null,s+=h}}};return t=>{e(t)}}class Uo extends V{unistNodeName(){return ce}static proseMirrorNodeName(){return"paragraph"}proseMirrorNodeSpec(){return Wr}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return D(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:Gr,children:t}]}unifiedInitializationHook(e){return e.use(zo)}}function Nr(r,e=null){return function(t,n){let{$from:o,$to:s}=t.selection,i=o.blockRange(s),a=!1,l=i;if(!i)return!1;if(i.depth>=2&&o.node(i.depth-1).type.compatibleContent(r)&&i.startIndex==0){if(o.index(i.depth-1)==0)return!1;let c=t.doc.resolve(i.start-2);l=new Ge(c,c,i.depth),i.endIndex<i.parent.childCount&&(i=new Ge(o,t.doc.resolve(s.end(i.depth)),i.depth)),a=!0}let u=$n(l,r,e,i);return u?(n&&n(Fo(t.tr,i,u,a,r).scrollIntoView()),!0):!1}}function Fo(r,e,t,n,o){let s=O.empty;for(let c=t.length-1;c>=0;c--)s=O.from(t[c].type.create(t[c].attrs,s));r.step(new Ne(e.start-(n?2:0),e.end,e.start,e.end,new xe(s,0,0),t.length,!0));let i=0;for(let c=0;c<t.length;c++)t[c].type==o&&(i=c+1);let a=t.length-i,l=e.start+t.length-(n?2:0),u=e.parent;for(let c=e.startIndex,d=e.endIndex,p=!0;c<d;c++,p=!1)!p&&cr(r.doc,l,a)&&(r.split(l,a),l+=2*a),l+=u.child(c).nodeSize;return r}function Ko(r,e){return function(t,n){let{$from:o,$to:s,node:i}=t.selection;if(i&&i.isBlock||o.depth<2||!o.sameParent(s))return!1;let a=o.node(-1);if(a.type!=r)return!1;if(o.parent.content.size==0&&o.node(-1).childCount==o.indexAfter(-1)){if(o.depth==3||o.node(-3).type!=r||o.index(-2)!=o.node(-2).childCount-1)return!1;if(n){let d=O.empty,p=o.index(-1)?1:o.index(-2)?2:3;for(let N=o.depth-p;N>=o.depth-3;N--)d=O.from(o.node(N).copy(d));let f=o.indexAfter(-1)<o.node(-2).childCount?1:o.indexAfter(-2)<o.node(-3).childCount?2:3;d=d.append(O.from(r.createAndFill()));let h=o.before(o.depth-(p-1)),m=t.tr.replace(h,o.after(-f),new xe(d,4-p,0)),w=-1;m.doc.nodesBetween(h,m.doc.content.size,(N,k)=>{if(w>-1)return!1;N.isTextblock&&N.content.size==0&&(w=k+1)}),w>-1&&m.setSelection(it.near(m.doc.resolve(w))),n(m.scrollIntoView())}return!0}let l=s.pos==o.end()?a.contentMatchAt(0).defaultType:null,u=t.tr.delete(o.pos,s.pos),c=l?[null,{type:l}]:void 0;return cr(u.doc,o.pos,2,c)?(n&&n(u.split(o.pos,2,c).scrollIntoView()),!0):!1}}function Wo(r){return function(e,t){let{$from:n,$to:o}=e.selection,s=n.blockRange(o,i=>i.childCount>0&&i.firstChild.type==r);return s?t?n.node(s.depth-1).type==r?Go(e,t,r,s):Xo(e,t,s):!0:!1}}function Go(r,e,t,n){let o=r.tr,s=n.end,i=n.$to.end(n.depth);s<i&&(o.step(new Ne(s-1,i,s,i,new xe(O.from(t.create(null,n.parent.copy())),1,0),1,!0)),n=new Ge(o.doc.resolve(n.$from.pos),o.doc.resolve(i),n.depth));const a=zn(n);if(a==null)return!1;o.lift(n,a);let l=o.mapping.map(s,-1)-1;return Un(o.doc,l)&&o.join(l),e(o.scrollIntoView()),!0}function Xo(r,e,t){let n=r.tr,o=t.parent;for(let f=t.end,h=t.endIndex-1,m=t.startIndex;h>m;h--)f-=o.child(h).nodeSize,n.delete(f-1,f+1);let s=n.doc.resolve(t.start),i=s.nodeAfter;if(n.mapping.map(t.end)!=t.start+s.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==o.childCount,u=s.node(-1),c=s.index(-1);if(!u.canReplace(c+(a?0:1),c+1,i.content.append(l?O.empty:O.from(o))))return!1;let d=s.pos,p=d+i.nodeSize;return n.step(new Ne(d-(a?1:0),p+(l?1:0),d+1,p-1,new xe((a?O.empty:O.from(o.copy(O.empty))).append(l?O.empty:O.from(o.copy(O.empty))),a?0:1,l?0:1),a?0:1)),e(n.scrollIntoView()),!0}function Yo(r){return function(e,t){let{$from:n,$to:o}=e.selection,s=n.blockRange(o,u=>u.childCount>0&&u.firstChild.type==r);if(!s)return!1;let i=s.startIndex;if(i==0)return!1;let a=s.parent,l=a.child(i-1);if(l.type!=r)return!1;if(t){let u=l.lastChild&&l.lastChild.type==a.type,c=O.from(u?r.create():null),d=new xe(O.from(r.create(null,O.from(a.type.create(null,c)))),u?3:1,0),p=s.start,f=s.end;t(e.tr.step(new Ne(p-(u?3:1),f,p,f,d,1,!0)).scrollIntoView())}return!0}}class ct extends V{unistNodeName(){return"listItem"}static proseMirrorNodeName(){return"regular_list_item"}proseMirrorNodeSpec(){return{content:"paragraph block*",defining:!0,group:"list_item",parseDOM:[{tag:"li"}],toDOM(){return["li",0]}}}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&(!("checked"in e)||typeof e.checked!="boolean")}proseMirrorKeymap(e){const t=e.nodes[this.proseMirrorNodeName()];return{Enter:Ko(t),"Shift-Tab":Wo(t),Tab:Yo(t)}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return D(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}class Jo extends V{dependencies(){return[new ct]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered===!0}static proseMirrorNodeName(){return"ordered_list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1},startingNumber:{default:1}},parseDOM:[{getAttrs(e){const t=e.getAttribute("start");return{spread:e.getAttribute("data-spread")==="true",startingNumber:t!=null?parseInt(t):1}},tag:"ol"}],toDOM(e){return["ol",{"data-spread":e.attrs.spread,start:e.attrs.startingNumber},0]}}}proseMirrorInputRules(e){return[Qe(/^\s{0,3}(\d+)\.\s$/,e.nodes[this.proseMirrorNodeName()],t=>({startingNumber:+t[1]}),(t,n)=>n.childCount+n.attrs.startingNumber===+t[1])]}proseMirrorKeymap(e){return{"Shift-Mod-9":Nr(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:o}){const{spread:s,start:i}=e;return D(this.proseMirrorNodeName(),t,n,{...o,spread:s,startingNumber:i??1})}proseMirrorNodeToUnistNodes(e,t){const n=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!0,spread:n,start:e.attrs.startingNumber,children:t.map(o=>(o.spread=n,o))}]}}class qo extends he{unistNodeName(){return"delete"}static proseMirrorMarkName(){return"strikethrough"}proseMirrorMarkSpec(){return{parseDOM:[{tag:"s"},{tag:"del"},{style:"text-decoration",getAttrs:e=>/(^|[\s])line-through([\s]|$)/.test(e)&&null}],toDOM(){return["s"]}}}proseMirrorInputRules(e){return[new J(/~([^\s](?:.*[^\s~])?)~([^~])$/,e.marks[this.proseMirrorMarkName()]),new J(/~~([^\s](?:.*[^\s])?)~~([\s\S])$/,e.marks[this.proseMirrorMarkName()])]}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t}){return t.map(n=>n.mark(n.marks.concat([e.marks[this.proseMirrorMarkName()].create()])))}processConvertedUnistNode(e){return{type:this.unistNodeName(),children:[e]}}}function Zo(){return r=>{let e=-1;function t(o,s){if(o.type==="tableRow"&&e++,o.type==="tableCell"){const i=o;i.data={...i.data??{},rowIndex:e,columnIndex:s}}}function n(o){if(kr(o))for(let s=0;s<o.children.length;s++){const i=o.children[s];t(i,s),n(i)}}n(r)}}class xr extends V{unistNodeName(){return"tableCell"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()}static proseMirrorNodeName(){return"table_cell"}proseMirrorNodeSpec(){return{content:"inline*",attrs:{rowIndex:{default:null},columnIndex:{default:null},colspan:{default:1},rowspan:{default:1}},tableRole:"cell",isolating:!0,parseDOM:[{tag:"td",getAttrs(e){const t=e;return{colspan:We(t.getAttribute("colspan"),1),rowspan:We(t.getAttribute("rowspan"),1)}}}],toDOM(e){const{colspan:t,rowspan:n}=e.attrs,o={colspan:t!==1?me(t,void 0):void 0,rowspan:n!==1?me(n,void 0):void 0};return[e.attrs.rowIndex==null||e.attrs.rowIndex>0?"td":"th",o,0]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:o}){var s,i;return D(this.proseMirrorNodeName(),t,n,{...o,colspan:1,rowspan:1,rowIndex:(s=e.data)==null?void 0:s.rowIndex,columnIndex:(i=e.data)==null?void 0:i.columnIndex})}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t,data:{rowIndex:e.attrs.rowIndex,columnIndex:e.attrs.columnIndex}}]}}class yr extends V{dependencies(){return[new xr]}unistNodeName(){return"tableRow"}static proseMirrorNodeName(){return"table_row"}proseMirrorNodeSpec(){return{content:"(table_cell+)",tableRole:"row",parseDOM:[{tag:"tr"}],toDOM(){return["tr",0]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return D(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}class Qo extends V{dependencies(){return[new yr]}unistNodeName(){return"table"}static proseMirrorNodeName(){return"table"}proseMirrorNodeSpec(){return{content:"(table_row+)",tableRole:"table",isolating:!0,group:"block",parseDOM:[{tag:"table"}],toDOM(){return["table",["tbody",0]]}}}proseMirrorInputRules(e){return[]}proseMirrorKeymap(e){return{}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:n}){return D(this.proseMirrorNodeName(),e,t,n)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),align:[],children:t}]}unifiedInitializationHook(e){return e.use(Zo)}}class es extends V{dependencies(){return[new ct]}unistNodeName(){return"list"}unistToProseMirrorTest(e){return e.type===this.unistNodeName()&&e.ordered!==!0}static proseMirrorNodeName(){return"list"}proseMirrorNodeSpec(){return{content:"list_item+",group:"block",attrs:{spread:{default:!1}},parseDOM:[{getAttrs(e){return{spread:e.getAttribute("data-spread")==="true"}},tag:"ul"}],toDOM(e){return["ul",{"data-spread":e.attrs.spread},0]}}}proseMirrorInputRules(e){return[Qe(/^\s{0,3}([-+*])\s$/,e.nodes[this.proseMirrorNodeName()])]}proseMirrorKeymap(e){return{"Shift-Mod-8":Nr(e.nodes[this.proseMirrorNodeName()])}}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:n,attrs:o}){const{spread:s}=e;return D(this.proseMirrorNodeName(),t,n,{...o,spread:s})}proseMirrorNodeToUnistNodes(e,t){const n=e.attrs.spread;return[{type:this.unistNodeName(),ordered:!1,spread:n,children:t.map(o=>(o.spread=n,o))}]}}function Lt(r,e){if(!(r==null||e==null))return{start:{...r},end:{...e}}}const ts=()=>r=>{mn(r,"list",(e,t,n)=>{var a,l,u,c,d,p,f,h;if(n==null||t==null)return;const o=[];let s=[],i=0;for(;i<e.children.length;){const m=e.children[i];if(Bt(m)){const w=[];for(;i<e.children.length&&Bt(e.children[i]);)w.push(e.children[i]),i++;if(s.length===0)throw new Error("Unexpected state: currentListItems is empty after encountering blank lines.");const N=s[0],k=ke(gn(s)),b=Lt(((a=N.position)==null?void 0:a.start)??((l=e.position)==null?void 0:l.start),((u=k.position)==null?void 0:u.end)??((c=e.position)==null?void 0:c.end)),E={type:"list",ordered:e.ordered,start:e.start,spread:e.spread,children:s,position:b};o.push(E),s=[],o.push(...w.map(C=>({type:"lineEndingBlank",position:C.position})))}else s.push(m),i++}if(s.length>0){const m=s[0],w=s[s.length-1],N=Lt(((d=m.position)==null?void 0:d.start)??((p=e.position)==null?void 0:p.start),((f=w.position)==null?void 0:f.end)??((h=e.position)==null?void 0:h.end)),k={type:"list",ordered:e.ordered,start:e.start,spread:e.spread,children:s,position:N};o.push(k)}n.children.splice(t,1,...o)})};var _t={}.hasOwnProperty;function rs(r,e){var t=e||{};function n(o){var s=n.invalid,i=n.handlers;if(o&&_t.call(o,r)&&(s=_t.call(i,o[r])?i[o[r]]:n.unknown),s)return s.apply(this,arguments)}return n.handlers=t.handlers||{},n.invalid=t.invalid,n.unknown=t.unknown,n}const ns={}.hasOwnProperty;function br(r,e){let t=-1,n;if(e.extensions)for(;++t<e.extensions.length;)br(r,e.extensions[t]);for(n in e)if(ns.call(e,n))switch(n){case"extensions":break;case"unsafe":{Dt(r[n],e[n]);break}case"join":{Dt(r[n],e[n]);break}case"handlers":{os(r[n],e[n]);break}default:r.options[n]=e[n]}return r}function Dt(r,e){e&&r.push(...e)}function os(r,e){e&&Object.assign(r,e)}const ss=[is];function is(r,e,t,n){if(e.type==="code"&&Ct(e,n)&&(r.type==="list"||r.type===e.type&&Ct(r,n)))return!1;if("spread"in t&&typeof t.spread=="boolean")return r.type==="paragraph"&&(r.type===e.type||e.type==="definition"||e.type==="heading"&&to(e,n))?void 0:t.spread?1:0}const ee=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],as=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:ee},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:ee},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:ee},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:ee},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:ee},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:ee},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:ee},{atBreak:!0,character:"~"}];function ls(r){return r.label||!r.identifier?r.label||"":Mn(r.identifier)}function cs(r){if(!r._compiled){const e=(r.atBreak?"[\\r\\n][\\t ]*":"")+(r.before?"(?:"+r.before+")":"");r._compiled=new RegExp((e?"("+e+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(r.character)?"\\":"")+r.character+(r.after?"(?:"+r.after+")":""),"g")}return r._compiled}function us(r,e,t){const n=e.indexStack,o=r.children||[],s=[];let i=-1,a=t.before;n.push(-1);let l=e.createTracker(t);for(;++i<o.length;){const u=o[i];let c;if(n[n.length-1]=i,i+1<o.length){let d=e.handle.handlers[o[i+1].type];d&&d.peek&&(d=d.peek),c=d?d(o[i+1],r,e,{before:"",after:"",...l.current()}).charAt(0):""}else c=t.after;s.length>0&&(a==="\r"||a===`
`)&&u.type==="html"&&(s[s.length-1]=s[s.length-1].replace(/(\r?\n|\r)$/," "),a=" ",l=e.createTracker(t),l.move(s.join(""))),s.push(l.move(e.handle(u,r,e,{...l.current(),before:a,after:c}))),a=s[s.length-1].slice(-1)}return n.pop(),s.join("")}function ds(r,e,t){const n=e.indexStack,o=r.children||[],s=e.createTracker(t),i=[];let a=-1;for(n.push(-1);++a<o.length;){const l=o[a];n[n.length-1]=a,i.push(s.move(e.handle(l,r,e,{before:`
`,after:`
`,...s.current()}))),l.type!=="list"&&(e.bulletLastUsed=void 0),a<o.length-1&&i.push(s.move(ps(l,o[a+1],r,e)))}return n.pop(),i.join("")}function ps(r,e,t,n){let o=n.join.length;for(;o--;){const s=n.join[o](r,e,t,n);if(s===!0||s===1)break;if(typeof s=="number")return`
`.repeat(1+s);if(s===!1)return`

<!---->

`}return`

`}const hs=/\r?\n|\r/g;function fs(r,e){const t=[];let n=0,o=0,s;for(;s=hs.exec(r);)i(r.slice(n,s.index)),t.push(s[0]),n=s.index+s[0].length,o++;return i(r.slice(n)),t.join("");function i(a){t.push(e(a,o,!a))}}function ms(r,e,t){const n=(t.before||"")+(e||"")+(t.after||""),o=[],s=[],i={};let a=-1;for(;++a<r.unsafe.length;){const c=r.unsafe[a];if(!ro(r.stack,c))continue;const d=r.compilePattern(c);let p;for(;p=d.exec(n);){const f="before"in c||!!c.atBreak,h="after"in c,m=p.index+(f?p[1].length:0);o.includes(m)?(i[m].before&&!f&&(i[m].before=!1),i[m].after&&!h&&(i[m].after=!1)):(o.push(m),i[m]={before:f,after:h})}}o.sort(gs);let l=t.before?t.before.length:0;const u=n.length-(t.after?t.after.length:0);for(a=-1;++a<o.length;){const c=o[a];c<l||c>=u||c+1<u&&o[a+1]===c+1&&i[c].after&&!i[c+1].before&&!i[c+1].after||o[a-1]===c-1&&i[c].before&&!i[c-1].before&&!i[c-1].after||(l!==c&&s.push(Vt(n.slice(l,c),"\\")),l=c,/[!-/:-@[-`{-~]/.test(n.charAt(c))&&(!t.encode||!t.encode.includes(n.charAt(c)))?s.push("\\"):(s.push("&#x"+n.charCodeAt(c).toString(16).toUpperCase()+";"),l++))}return s.push(Vt(n.slice(l,u),t.after)),s.join("")}function gs(r,e){return r-e}function Vt(r,e){const t=/\\(?=[!-/:-@[-`{-~])/g,n=[],o=[],s=r+e;let i=-1,a=0,l;for(;l=t.exec(s);)n.push(l.index);for(;++i<n.length;)a!==n[i]&&o.push(r.slice(a,n[i])),o.push("\\"),a=n[i];return o.push(r.slice(a)),o.join("")}function Ms(r){const e=r||{},t=e.now||{};let n=e.lineShift||0,o=t.line||1,s=t.column||1;return{move:l,current:i,shift:a};function i(){return{now:{line:o,column:s},lineShift:n}}function a(u){n+=u}function l(u){const c=u||"",d=c.split(/\r?\n|\r/g),p=d[d.length-1];return o+=d.length-1,s=d.length===1?s+p.length:1+p.length+n,c}}function ws(r,e={}){const t={enter:o,indentLines:fs,associationId:ls,containerPhrasing:ys,containerFlow:bs,createTracker:Ms,compilePattern:cs,safe:Es,stack:[],unsafe:[...as],join:[...ss],handlers:{...no},options:{},indexStack:[],handle:void 0};br(t,e),t.options.tightDefinitions&&t.join.push(xs),t.handle=rs("type",{invalid:ks,unknown:Ns,handlers:t.handlers});let n=t.handle(r,void 0,t,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return n&&n.charCodeAt(n.length-1)!==10&&n.charCodeAt(n.length-1)!==13&&(n+=`
`),n;function o(s){return t.stack.push(s),i;function i(){t.stack.pop()}}}function ks(r){throw new Error("Cannot handle value `"+r+"`, expected node")}function Ns(r){const e=r;throw new Error("Cannot handle unknown node `"+e.type+"`")}function xs(r,e){if(r.type==="definition"&&r.type===e.type)return 0}function ys(r,e){return us(r,this,e)}function bs(r,e){return ds(r,this,e)}function Es(r,e){return ms(this,r,e)}const Cs=(r,e,t,n)=>r.children.map(o=>t.handle(o,void 0,t,n)).join(""),Ss=(r,e,t,n)=>t.safe(r.value,n).replaceAll("\\[","[").replaceAll("\\&","&");function Ts(){const r=this;r.compiler=e;function e(t){return ws(t,{...r.data("settings"),fences:!0,bullet:"-",bulletOther:"*",listItemIndent:"one",resourceLink:!0,tightDefinitions:!0,rule:"-",handlers:{text:Ss,startend:Cs},extensions:r.data("toMarkdownExtensions")||[]})}}class vs extends wn{dependencies(){return[new Uo,new tt,new To,new gr,new Lo,new Do,new tr,new Vo,new Ho,new jo,new wr,new fr,new ct,new Jo,new Xr,new et,new es,new qo,new Ve,new Qo,new yr,new xr]}unifiedInitializationHook(e){return e.use(kn).use(oo).use(ts).use(Ts)}}class Ps{constructor(e,t){M(this,"rules");this.rules=[].concat.apply([],e.syntaxExtensions().map(n=>n.proseMirrorInputRules(t)))}build(){return Yr({rules:this.rules})}}class As{constructor(e,t){M(this,"keymap");this.keymap=new Map;for(const n of e.syntaxExtensions())this.addKeymap(n.proseMirrorKeymap(t));this.addKeymap(eo)}build(){const e={};return this.keymap.forEach((t,n)=>{e[n]=pr(...t)}),at(e)}addKeymap(e){for(const t in e)this.keymap.get(t)||this.keymap.set(t,[]),ke(this.keymap.get(t)).push(e[t])}}class Is{constructor(e){M(this,"nodeViews");this.nodeViews={};for(const t of e.nodeExtensions()){const n=t.proseMirrorNodeName(),o=t.proseMirrorNodeView();n!=null&&o!=null&&(this.nodeViews[n]=o)}}build(){return this.nodeViews}}class Os{constructor(e){M(this,"nodes",{});M(this,"marks",{});for(const t of e.nodeExtensions()){const n=t.proseMirrorNodeName(),o=t.proseMirrorNodeSpec();n!=null&&o!=null&&(n!=="text"&&(o.attrs={...o.attrs,start:{default:void 0},end:{default:void 0}}),this.nodes[n]=o)}for(const t of e.markExtensions()){const n=t.proseMirrorMarkName(),o=t.proseMirrorMarkSpec();n!=null&&o!=null&&(this.marks[n]=o)}}build(){return new Fn({nodes:this.nodes,marks:this.marks})}}class Rs{constructor(e){M(this,"extensionManager");this.extensionManager=e}build(){let e=Nn();for(const t of this.extensionManager.extensions())e=t.unifiedInitializationHook(e);return e}}function Bs(r){return r instanceof V}function Ls(r){return r instanceof he}class _s{constructor(e){M(this,"markExtensionList");M(this,"nodeExtensionList");M(this,"otherExtensionList");this.markExtensionList=new Map,this.nodeExtensionList=new Map,this.otherExtensionList=new Map;for(const t of e)this.add(t)}extensions(){return this.syntaxExtensions().concat(Array.from(this.otherExtensionList.values()))}markExtensions(){return Array.from(this.markExtensionList.values())}getMarkExtension(e){return this.markExtensionList.get(e)??null}nodeExtensions(){return Array.from(this.nodeExtensionList.values())}getNodeExtension(e){return this.nodeExtensionList.get(e)??null}syntaxExtensions(){return this.nodeExtensions().concat(this.markExtensions())}add(e){for(const t of e.dependencies())this.add(t);if(Ls(e)){this.markExtensionList.set(e.constructor.name,e);return}if(Bs(e)){this.nodeExtensionList.set(e.constructor.name,e);return}this.otherExtensionList.set(e.constructor.name,e)}}class Ds{constructor(e){M(this,"extensionManager");this.extensionManager=e}convert(e){const t=this.convertNode(e);if(t.length!==1)throw new Error("Couldn't find any way to convert the root ProseMirror node.");return t[0]}convertNode(e){let t=null;const n=[];for(const o of this.extensionManager.nodeExtensions()){if(!o.proseMirrorToUnistTest(e))continue;n.push(o);let s=[];for(let i=0;i<e.childCount;++i)s=s.concat(this.convertNode(e.child(i)));t=o.proseMirrorNodeToUnistNodes(e,s)}return t==null?(console.warn(`Couldn't find any way to convert ProseMirror node of type "`+e.type.name+'" to a unist node.'),[]):t.map(o=>{for(const s of e.marks){const{type:{name:i}}=s;if(n.some(u=>{var d;const c=(d=u.proseMirrorNodeSpec())==null?void 0:d.marks;return c!=null&&!c.includes(i)}))continue;let l=!1;for(const u of this.extensionManager.markExtensions())s.type.name===u.proseMirrorMarkName()&&(o=u.processConvertedUnistNode(o,s),l=!0);l||console.warn(`Couldn't find any way to convert ProseMirror mark of type "`+i+'" to a unist node.')}return o})}}class ut{constructor(e,t){M(this,"extensionManager");M(this,"proseMirrorSchema");this.extensionManager=e,this.proseMirrorSchema=t}static unistNodeIsParent(e){return"children"in e}convert(e){const t={},n=this.convertNode(e,t);for(const o of this.extensionManager.syntaxExtensions())o.postUnistToProseMirrorHook(t);if(n.length!==1)throw new Error("Couldn't find any way to convert the root unist node.");return n[0]}convertNode(e,t){let n=0;const o=(s,i)=>{for(const a of this.extensionManager.syntaxExtensions()){if(!a.unistToProseMirrorTest(s))continue;let l=[];ut.unistNodeIsParent(s)&&(l=s.children.flatMap(h=>o(h,i)));const{position:u}=s;let c=(u==null?void 0:u.start.offset)??n,d=u==null?void 0:u.end.offset;if(d==null&&"value"in s&&typeof s.value=="string"){const{value:h}=s;d=c+h.length}d==null&&(d=c),n=d;const p={start:c,end:d};return xn(a.unistNodeToProseMirrorNodes({node:s,schema:this.proseMirrorSchema,convertedChildren:l,context:i,attrs:p})).filter(yn)}return console.warn(`Couldn't find any way to convert unist node of type "`+s.type+'" to a ProseMirror node.'),[]};return o(e,t)}}const Vs=5;class Hs{constructor(e=[]){M(this,"builtSchema");M(this,"inputRulesBuilder");M(this,"keymapBuilder");M(this,"nodeViewBuilder");M(this,"unistToProseMirrorConverter");M(this,"proseMirrorToUnistConverter");M(this,"unified");M(this,"memoizedProsemirrorDocs",new Map);const t=new _s(e);this.builtSchema=new Os(t).build(),this.inputRulesBuilder=new Ps(t,this.builtSchema),this.keymapBuilder=new As(t,this.builtSchema),this.nodeViewBuilder=new Is(t),this.unistToProseMirrorConverter=new ut(t,this.builtSchema),this.proseMirrorToUnistConverter=new Ds(t),this.unified=new Rs(t).build()}parse(e){try{if(this.memoizedProsemirrorDocs.has(e))return ke(this.memoizedProsemirrorDocs.get(e));const t=this.unistToProseMirrorConverter.convert(this.parseUnist(e));if(this.memoizedProsemirrorDocs.set(e,t),this.memoizedProsemirrorDocs.size>Vs){const n=this.memoizedProsemirrorDocs.keys().next().value;this.memoizedProsemirrorDocs.delete(n)}return t}catch(t){j.logError("Failed to parse document",t)}return this.schema().text(" ")}parseUnist(e){return this.unified.runSync(this.unified.parse(e))}schema(){return this.builtSchema}inputRulesPlugin(){return this.inputRulesBuilder.build()}keymapPlugin(){return this.keymapBuilder.build()}nodeViews(){return this.nodeViewBuilder.build()}serialize(e){const t=this.proseMirrorToUnistConverter.convert(e);return this.unified.stringify(t)}}let Ht=null;function ne(){return Ht??(Ht=new Hs([new vs])),Ht}const js={"override-strong-color":"_override-strong-color_y6grp_1"};function Er({isHovered:r,isRejected:e,isTextAcive:t}){return F("cursor-pointer",{"line-through":!t,"filter grayscale-[0.6]":e&&!t,"opacity-60":e&&!t,"bg-opacity-50 dark:bg-opacity-50":e&&r,"bg-opacity-10 dark:bg-opacity-10":e&&!r,"bg-opacity-60 dark:bg-opacity-60":!e&&!r})}function $s({isHovered:r,isRejected:e,isReplacement:t}){return F("bg-red-100 dark:bg-red-600",Er({isHovered:r,isRejected:e,isTextAcive:e}),{"dark:bg-red-800":e,"text-red-500 dark:text-red-200":!e,"border border-red-400 rounded-l border-r-0":e&&t,"border border-red-400 rounded":e&&!t})}function zs({isHovered:r,isRejected:e,isReplacement:t}){const n=!e;return F(js["override-strong-color"],"text-green-600 dark:text-green-200 bg-green-100 dark:bg-green-600",Er({isHovered:r,isRejected:e,isTextAcive:n}),{"dark:bg-green-800":e,"border border-green-500 rounded-r border-l-0":e&&t,"border border-green-500 rounded":e&&!t})}const Re=new q("edit");function jt(r,e,t){const n=r.map(t),o=n.map(a=>a.start),s=n.map(a=>a.end),i=Fe(e,[...o,...s]);return r.map((a,l)=>[a,{start:i[l],end:i[l+r.length]}])}function Us(r,e,t,n){const o=r.cut(n.start,n.end),i=Kn.fromSchema(r.type.schema).serializeFragment(o.content);if(i.firstChild&&i.firstChild.nodeName==="P"){const l=i.firstChild;for(;l.firstChild;)i.insertBefore(l.firstChild,l);i.removeChild(l)}return i.querySelectorAll("span").forEach(l=>{l.className=e,l.dataset.editId=t.id}),i}const $t=(r,e,t,n,o)=>{const s=[];if(r.length===0)return s;const i=jt(r,n,c=>c.beforeVersionDeletion),l=ne().parse(o),u=jt(r,l,c=>c.afterVersionAddition);for(let c=0;c<r.length;c++){const[{id:d,content:p},{start:f,end:h}]=i[c],m=e===d,w=t.has(d),N=f!==h,k=!!p;if(N&&s.push(pe.inline(f,h,{class:$s({isHovered:m,isRejected:w,isReplacement:k}),"data-edit-id":d})),k){const b=zs({isHovered:m,isRejected:w,isReplacement:k}),[E,C]=u[c],A=Us(l,b,E,C);s.push(pe.widget(h,A,{key:`${d}-${m}-${w}`}))}}return s},Fs=(r,e)=>new K({key:Re,state:{init(t,{doc:n}){const s=new Set;return{edits:r,decorations:$t(r,null,s,n,Mt(e,r)),hoveredEditId:null,rejectedEdits:s,textdocContent:e}},apply(t,n){const o=t.getMeta(Re)??null,{edits:s,hoveredEditId:i,rejectedEdits:a,textdocContent:l}=o??n;return{edits:s,decorations:$t(s,i,a,t.doc,Mt(l,s)),hoveredEditId:i,rejectedEdits:a,textdocContent:l}}},props:{decorations(t){const n=this.getState(t);return n?Q.create(t.doc,n.decorations.concat()):Q.empty},editable(t){const n=this.getState(t);return!(n&&n.edits.length>0)},attributes(t){const n=t.plugins.find(s=>s.spec.key===Re),o=n==null?void 0:n.getState(t);return o&&o.edits.length>0?{class:"select-none cursor-default text-gray-500 dark:text-gray-500"}:{class:""}}}}),re=class re{constructor(e,t){this.length=e,this.step=t}cut(e){return e===this.length?this:new re(e,this.step)}static slice(e,t,n){if(t===n)return re.none;if(t===0&&n===re.len(e))return e;const o=[];for(let s=0,i=0;i<n;s++){const a=e[s],l=i+a.length,u=Math.min(n,l)-Math.max(t,i);u>0&&o.push(a.cut(u)),i=l}return o}static join(e,t,n){if(e.length===0)return t;if(t.length===0)return e;const o=n(e[e.length-1].step,t[0].step);if(o==null)return e.concat(t);const s=e.slice(0,e.length-1);s.push(new re(e[e.length-1].length+t[0].length,o));for(const i of t)s.push(i);return s}static len(e){let t=0;for(const n of e)t+=n.length;return t}};M(re,"none",[]);let ue=re;class Ks{constructor(e,t,n,o,s,i){this.fromA=e,this.toA=t,this.fromB=n,this.toB=o,this.deleted=s,this.inserted=i}get lenA(){return this.toA-this.fromA}get lenB(){return this.toB-this.fromB}}const zt=(r,e,t,n,o)=>new Ks(r,e,t,n,r===e?ue.none:[new ue(e-r,o)],t===n?ue.none:[new ue(n-t,o)]);class De{constructor(e,t){this.doc=e,this.changes=t}static create(e){return new De(e,[])}addSteps(e,t){const n=[];for(const s of t){let i=0;if(s.getMap().forEach((a,l,u,c)=>{n.push(zt(a+i,l+i,u,c,s)),i=c-u-(l-a)}),s instanceof Wn||s instanceof Gn){const{from:a,to:l}=s;n.push(zt(a,l,a,l,s))}}if(n.length===0)return this;const o=this.changes.concat(n);return new De(e,o)}}const Me=new q("changeset"),Ye=new q("highlightChanges"),Cr=r=>Me.getState(r),Ws=r=>{const{state:e}=r,t=e.tr.setMeta(Me,!0);r.updateState(e.apply(t))},Gs=r=>{const{state:e}=r,t=Cr(e);if(!t)return;const{maps:n,steps:o}=t,s=new Xn(n),i=e.tr;for(let l=o.length-1;l>=0;l--){const u=o[l].map(s.slice(l+1));if(!u)continue;i.maybeStep(u).doc&&s.appendMap(u.getMap(),l)}const a=e.apply(i.setMeta(Me,!0));r.updateState(a)},Xs=()=>{const r=n=>({changeset:De.create(n),maps:[],steps:[]}),e=new K({key:Me,state:{init:(n,{doc:o})=>r(o),apply:(n,o,s,i)=>{const{doc:a}=i;if(n.getMeta(Me))return r(a);const{docChanged:u,mapping:c,steps:d,docs:p}=n;if(!u)return o;const{changeset:f,maps:h,steps:m}=o,{maps:w}=c,N=d.map((k,b)=>k.invert(p[b]));return{changeset:f.addSteps(a,d),maps:h.concat(w),steps:m.concat(N)}}}}),t=new K({key:Ye,state:{init(){return{deco:Q.empty,show:!1}},apply(n,o,s,i){const a=e.getState(i);if(!a)return o;const{changeset:l}=a,{doc:u}=i,{changes:c}=l,d=c.map(({fromB:f,toB:h})=>pe.inline(f,h,{class:"blame-marker"})),p=n.getMeta(Ye);return{deco:Q.create(u,d),show:p??o.show}}},props:{decorations(n){const o=this.getState(n);if(!(o!=null&&o.show))return Q.empty;const{deco:s}=o;return s}}});return[e,t]},te=(r,e,t)=>{x.useEffect(()=>{const n=e.current;if(!n)return;const{state:o}=n,s=r(o.tr);s&&n.dispatch(s)},t)};var we=(r=>(r.PROSEMIRROR_CONTEXT_CHILDREN="prosemirror-context-children",r.PROSEMIRROR_EDITOR_CONTAINER="prosemirror-editor-container",r))(we||{});function Ys(r,e){return{x:wt(e.x,r.left,r.right),y:wt(e.y,r.top,r.bottom)}}function Sr(r){let e=r.selection.$from.pos-1;if(e<0)return null;let t=r.doc.nodeAt(e);for(;(t==null||t.type.name===et.proseMirrorNodeName())&&e>0;)e-=1,t=r.doc.nodeAt(e);return t!=null?{node:t,pos:e}:t}function Js(r,e){const t=Sr(r);if(t==null)return!1;const{node:n,pos:o}=t,s=o+n.nodeSize,i=r.tr,l=r.schema.nodes.paragraph.create(null);i.insert(s,l);const u=s+l.nodeSize-1,c=i.doc.resolve(u),d=new $(c);return i.setSelection(d),e(i),!0}function qs(r,e){const t=Sr(r);if(t==null)return!1;const{node:n,pos:o}=t,s=r.tr;return s.deleteRange(o,o+n.nodeSize),e(s),!0}const Ut=(r,e)=>{if(r===e)return null;let t=0,n=r.length,o=e.length;for(;t<n&&r.charCodeAt(t)===e.charCodeAt(t);)t+=1;for(;n>t&&o>t&&r.charCodeAt(n-1)===e.charCodeAt(o-1);)n-=1,o-=1;return{from:t,to:n,text:e.slice(t,o)}},Ft=Jr({settings:{background:"var(--gray-100)"}});class je{constructor(e,t,n,o){M(this,"node");M(this,"updating",!1);M(this,"cm");M(this,"languageCompartment");M(this,"themeCompartment");M(this,"setLanguage",async e=>{const t=await an(e);t&&this.cm.dispatch({effects:this.languageCompartment.reconfigure(t)})});M(this,"setTheme",e=>{const t=e?ft:Ft;this.cm.dispatch({effects:this.themeCompartment.reconfigure(t)})});M(this,"handleBackspace",e=>{const{selection:t}=e.state;if(!(t.main.empty&&t.main.from===0)||this.cm.state.doc.length>0)return!1;const n=qs(this.pmView.state,this.pmView.dispatch);return this.pmView.focus(),n});M(this,"handleShiftEnter",()=>{const e=Js(this.pmView.state,this.pmView.dispatch);return this.pmView.focus(),e});M(this,"dispatch",e=>{if(this.cm.update([e]),this.updating)return;const t=(this.getPos()??0)+1,n=e.state.doc.toString(),o=Ut(this.node.textContent,n);if(o){const{text:s,from:i,to:a}=o,l=s?this.pmSchema.text(s):null,u=this.pmView.state.tr.replaceWith(i+t,a+t,l);this.pmView.dispatch(u)}this.forwardSelection()});M(this,"update",e=>{if(e.type!==this.node.type)return!1;e.attrs.lang!==this.node.attrs.lang&&this.setLanguage(e.attrs.lang),e.attrs.isDarkMode!=null&&e.attrs.isDarkMode!==this.node.attrs.isDarkMode&&this.setTheme(e.attrs.isDarkMode),this.node=e;const t=Ut(this.cm.state.doc.toString(),e.textContent);if(t){const{text:n,from:o,to:s}=t;this.updating=!0,this.cm.dispatch({changes:{from:o,to:s,insert:n}}),this.updating=!1}return!0});M(this,"asProseMirrorSelection",e=>{const t=(this.getPos()??0)+2,{anchor:n,head:o}=this.cm.state.selection.main;return $.create(e,n+t,o+t)});M(this,"forwardSelection",()=>{if(!this.cm.hasFocus)return;const{state:e}=this.pmView,t=this.asProseMirrorSelection(e.doc);t.eq(e.selection)||this.pmView.dispatch(e.tr.setSelection(t))});M(this,"maybeEscape",(e,t)=>n=>{const{state:o}=n,{selection:s}=o,a=(()=>{const f=s.main.from,{number:h,from:m}=o.doc.lineAt(f);return{line:h,ch:f-m}})(),l=o.selection.ranges.some(f=>!f.empty),u=1,c=o.doc.lineAt(o.doc.length).number;if(l||a.line!==(t<0?u:c)||e==="char"&&a.ch!==(t<0?0:o.doc.line(a.line).length))return!1;const d=(this.getPos()??0)+(t<0?0:this.node.nodeSize),p=it.near(this.pmView.state.doc.resolve(d),t);return this.pmView.dispatch(this.pmView.state.tr.setSelection(p).scrollIntoView()),this.pmView.focus(),!0});M(this,"setSelection",(e,t)=>{this.focus(),this.updating=!0,this.cm.dispatch({selection:{anchor:e,head:t}}),this.updating=!1});M(this,"focus",()=>{this.cm.focus(),this.forwardSelection()});M(this,"selectNode",()=>{this.focus()});M(this,"stopEvent",()=>!0);M(this,"destroy",()=>{this.cm.destroy()});M(this,"_setIsCodeBlockView",()=>{this.cm.dom.dataset.isCodeBlockView="true"});this.pmView=t,this.getPos=n,this.node=e;const s=[{key:"ArrowUp",run:this.maybeEscape("line",-1)},{key:"ArrowLeft",run:this.maybeEscape("char",-1)},{key:"ArrowDown",run:this.maybeEscape("line",1)},{key:"ArrowRight",run:this.maybeEscape("char",1)},{key:"Backspace",run:this.handleBackspace},{key:"Shift-Enter",run:this.handleShiftEnter}];this.languageCompartment=new Tt,this.themeCompartment=new Tt;const i=qr(e.attrs.lang),a=vt.create({doc:this.node.textContent,extensions:[this.themeCompartment.of(o?ft:Ft),Pt.theme({"&":{borderRadius:"4px",padding:"0.5rem"},"&.cm-focused":{outline:"none"}}),co.of([...s,...Zr,...Qr,en]),tn(),rn(),nn(),uo(),on(sn),this.languageCompartment.of(i!=null?[i]:[]),vt.changeFilter.of(l=>(!l.docChanged&&!this.updating&&this.forwardSelection(),!0))]});this.cm=new Pt({state:a,dispatch:this.dispatch}),i==null&&this.setLanguage(e.attrs.lang)}get pmSchema(){return this.pmView.state.schema}get dom(){return this._setIsCodeBlockView(),this.cm.dom}static isInCodeBlockView(e){return e instanceof HTMLElement?e.closest("[data-is-code-block-view]")!=null:!1}}M(je,"_getIsCodeBlockView",e=>e.dataset.isCodeBlockView==="true");function Zs(r,e,t){try{return e instanceof $?$.create(r,e.anchor,e.head):e instanceof Yn?$.create(r,e.from,e.to):e instanceof Et?new Et(r):void 0}catch{return $.create(r,0)}}const Pe=new q("focus"),Qs=(r,e)=>new K({key:Pe,state:{init:()=>!1,apply(t,n){const o=t.getMeta(Pe);return typeof o=="boolean"?o:n}},props:{handleDOMEvents:{blur:(t,n)=>{const{relatedTarget:o}=n;return o!=null&&je.isInCodeBlockView(o)||(e(n),t.dispatch(t.state.tr.setMeta(Pe,!1))),!1},focus:(t,n)=>(r(n),t.dispatch(t.state.tr.setMeta(Pe,!0)),!1)}}});function Tr(r,e){var n;const t=e&&((n=r.dom)==null?void 0:n.querySelectorAll(`[data-edit-id="${e}"]`));return t?Array.from(t):[]}function ei(r,e){return Tr(r,e).flatMap(n=>Array.from(n.getClientRects()))}function Je(r,e,t){return r>=t.left&&r<=t.right&&e>=t.top&&e<=t.bottom}function vr(r){const e=Math.min(...r.map(s=>s.left)),t=Math.max(...r.map(s=>s.right)),n=Math.min(...r.map(s=>s.top)),o=Math.max(...r.map(s=>s.bottom));return{left:e,right:t,top:n,bottom:o}}function ti(r,e,t){return t.some(o=>Je(r,e,o))?!0:t.length<2?!1:t.some(o=>r>=o.left&&r<=o.right&&e>o.bottom)&&t.some(o=>r>=o.left&&r<=o.right&&e<o.top)}const ri=new q("linkTooltip"),ni=36;class oi{constructor(e){M(this,"tooltipElement");M(this,"button");M(this,"onMouseLeave");this.tooltipElement=document.createElement("div"),this.tooltipElement.className=F("absolute  py-1.5 px-2.5 bg-token-main-surface-primary border border-token-border-light rounded-lg text-xs z-50 items-center cursor-pointer shadow-md flex justify-center cursor-pointer","transform -translate-x-1/2"),this.button=document.createElement("button"),this.button.textContent="Open link",this.button.className=F("bg-none","border-none","text-token-text-primary ","text-sm"),this.tooltipElement.appendChild(this.button),this.onMouseLeave=e,this.tooltipElement.addEventListener("mouseleave",e)}show(e,t,n){document.body.appendChild(this.tooltipElement),this.tooltipElement.style.left=`${e}px`,this.tooltipElement.style.top=`${t}px`;const o=()=>{window.open(n,"_blank"),this.hide()};this.button.addEventListener("click",o,{once:!0})}hide(){this.tooltipElement.parentNode&&this.tooltipElement.parentNode.removeChild(this.tooltipElement)}}function si(){let r=null,e=null;const t=s=>{if(r==null||e==null)return!1;const i=Array.from(e.getClientRects()),a=r.tooltipElement.getBoundingClientRect();if(i.length===1){const l=i[0];return!Je(s.clientX,s.clientY,vr([l,a]))}else return!ti(s.clientX,s.clientY,[a,...i])},n=(s,i)=>{r&&(r.hide(),r=null);const a=s.getAttribute("href");if(!a)return;const l=Array.from(s.getClientRects()),u=l.find(p=>Je(i.clientX,i.clientY,p))??l[0],c=u.left+u.width/2,d=u.top-ni;r=new oi(p=>{t(p)&&o()}),r.show(c,d,a),e=s},o=()=>{r&&(r.hide(),r=null),e=null};return new K({key:ri,props:{handleDOMEvents:{mousemove(s,i){const a=()=>{const{target:u}=i;if(!(u instanceof HTMLElement))return!1;const c=u.closest("a[href]");return c!=null&&c!==e?(n(c,i),!0):!1},l=()=>{r==null||!t(i)||o()};a()||l()}}},view:()=>({destroy:o})})}function Pr(r){return ne().serialize(r).length}const ii=new q("maxLength"),ai=(r,e,t)=>new K({key:ii,state:{init(){return t},apply:()=>{}},filterTransaction(n){if(r==null||!n.steps.some(i=>i instanceof Jn||i instanceof Ne?i.slice.size>i.to-i.from:!1))return!0;const s=Pr(n.doc);return s<=t?!0:(e&&rt(e,r,t),j.logEvent(sr.prosemirrorMaxLength,{maxLength:t,newLength:s}),!1)}});function li(r={}){return new K({view(e){return new ci(e,r)}})}class ci{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(n=t.width)!==null&&n!==void 0?n:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let s=i=>{this[o](i)};return e.dom.addEventListener(o,s),{name:o,handler:s}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,n;if(t){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let u=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(u){let c=u.getBoundingClientRect(),d=a?c.bottom:c.top;a&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),n={left:c.left,right:c.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!n){let a=this.editorView.coordsAtPos(this.cursorPos);n={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let o=this.editorView.dom.offsetParent;this.element||(this.element=o.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let s,i;if(!o||o==document.body&&getComputedStyle(o).position=="static")s=-pageXOffset,i=-pageYOffset;else{let a=o.getBoundingClientRect();s=a.left-o.scrollLeft,i=a.top-o.scrollTop}this.element.style.left=n.left-s+"px",this.element.style.top=n.top-i+"px",this.element.style.width=n.right-n.left+"px",this.element.style.height=n.bottom-n.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),o=n&&n.type.spec.disableDropCursor,s=typeof o=="function"?o(this.editorView,t,e):o;if(t&&!s){let i=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=qn(this.editorView.state.doc,i,this.editorView.dragging.slice);a!=null&&(i=a)}this.setCursor(i),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}function Ae(r){return(e,t,n)=>{var l;const{doc:o,selection:s}=e,{empty:i,$head:a}=s;if(i&&(n!=null&&n.endOfTextblock(r))){const u=r==="left"||r==="up"?-1:1,c=it.near(o.resolve(u>0?a.after():a.before()),u);if(((l=c.$head)==null?void 0:l.parent.type.name)===He)return t==null||t(e.tr.setSelection(c)),!0}return!1}}const ui=at({ArrowLeft:Ae("left"),ArrowRight:Ae("right"),ArrowUp:Ae("up"),ArrowDown:Ae("down")}),dt=new q("modelCursor");function di(r,e){return r.setMeta(dt,{modelCursor:e})}function pi(r){return r.getMeta(dt)??null}const Kt=(r,e)=>{const{doc:t}=r,n=[],{modelSelectionPositionRange:o,modelCursorPosition:s}=e??{};if(s!=null){const i=Fe(t,[s])[0];n.push(pe.widget(i,()=>{const a=document.createElement("span");return a.className=ln.modelCursor,a},{ignoreSelection:!0,side:1}))}else if(o!=null){const[i,a]=Fe(r.doc,[o.start,o.end]);n.push(pe.inline(i,a,{class:`${bn} !bg-[Highlight]`}))}return n.length?Q.create(t,n):Q.empty};function hi(r=void 0){return new K({key:dt,state:{init:(e,t)=>({modelCursor:r,deco:Kt(t,r)}),apply:(e,t,n,o)=>{const s=pi(e),i=(s==null?void 0:s.modelCursor)??t.modelCursor;return{modelCursor:i,deco:Kt(o,i)}}},props:{decorations(e){const t=this.getState(e);return t==null?void 0:t.deco}}})}function fi(r){var t;const e=r.content.size-(((t=r.lastChild)==null?void 0:t.content.size)??0)-1;if(Ke(r,e))return $.create(r,e)}const Ar=({intl:r,toaster:e,value:t,comments:n,edits:o,maxLength:s=nr,selection:i,onFocus:a,onBlur:l,onSave:u,safeUrls:c,modelCursor:d,isDisabled:p})=>{const f=ne(),h=f.schema();let m=t;s!=null&&m.length>s&&(m=m.slice(0,s),e!=null&&r!=null&&rt(e,r,s));const w=f.parse(m),N=i?Zs(w,i):fi(w);return ur.create({doc:w,schema:h,selection:N,plugins:[ai(r,e,s),f.inputRulesPlugin(),f.keymapPlugin(),at({"Mod-s":()=>(u(),!0),"Mod-z":lo,"Mod-shift-z":St,"Mod-y":St}),ui,li(),so(),io(),Qs(a,l),rr(n??[]),Fs(o??[],m),hi(d),yo(new Set(c??[])),Co(r,p),si(),...Xs()]})},Ir=(r,e)=>{const t=ne(),n=t.schema(),o=t.parse(r);return ur.create({doc:o,schema:n,plugins:[rr(e??[])]})},mi=({mount:r,value:e,comments:t,isDarkMode:n})=>new dr({mount:r},{editable:()=>!1,state:Ir(e,t),nodeViews:{[He]:(s,i,a)=>new je(s,i,a,n)}}),gi=(r,{intl:e,toaster:t,comments:n,value:o,maxLength:s=nr,onBlur:i,onFocus:a,onChange:l,onUpdate:u,onSave:c,safeUrls:d,modelCursor:p,selection:f,isDisabled:h},m=!1)=>{const w=Ar({intl:e,toaster:t,comments:n,value:o,maxLength:s,onBlur:i,onFocus:a,onSave:c,safeUrls:d,modelCursor:p,selection:f,isDisabled:h});u(w);const N=b=>{const E=k.state.apply(b);if(k.updateState(E),u(E),!b.docChanged)return;const C=Cr(E);if(!C)return;const{doc:A}=E,{changeset:L}=C;l==null||l({transaction:b,changeset:L,doc:A,getSerializedDocument:()=>ne().serialize(A),getAdjustedComments:()=>{const P=cn(or,E);if(P==null)return[];const I=ne(),z=I.parse(I.serialize(A)),_=En(z,P.positions);return Cn(P.comments,_)}})},k=new dr({mount:r},{state:w,dispatchTransaction:N,nodeViews:{[He]:(b,E,C)=>new je(b,E,C,m)},handlePaste(b,E){var I;const C=(I=E.clipboardData)==null?void 0:I.getData("text/plain");if(C==null)return!1;j.logEvent(sr.prosemirrorPaste,{textLength:C.length});const A=Pr(b.state.doc),L=A+C.length;let P=C;if(s!=null&&L>s){t!=null&&e!=null&&rt(t,e,s);const _=s-A-50;P=_>0?C.slice(0,_):""}return ao(b,P),!0}});return{view:k,pmu:ne()}},Mi="_main_gvo0h_1",Or={main:Mi};function wi(r,e){const t=e.target;if(t instanceof Element&&[we.PROSEMIRROR_EDITOR_CONTAINER,we.PROSEMIRROR_CONTEXT_CHILDREN].some(l=>t.closest(`#${l}`)!=null))return!1;r.focus();const n=Ys(r.dom.getBoundingClientRect(),{x:e.clientX,y:e.clientY}),o=r.state.tr,s=r.posAtCoords({left:n.x,top:n.y});if(s!=null){const i=Math.min(s.pos,un(r.state.doc)-1);o.setSelection(new $(o.doc.resolve(i))),r.dispatch(o)}return!0}const ge=({editorRef:r,wrapperClassName:e,transparentBackground:t=!1,comments:n,edits:o,commentingOn:s,paddingBottom:i,hoveredCommentId:a,focusedCommentId:l,hoveredEditId:u,rejectedEdits:c,showChanges:d,readonlyReason:p,isDisabled:f=!1,value:h,onBlur:m,onFocus:w,onChange:N,onMouseLeave:k,onSave:b,safeUrls:E,children:C,width:A,modelCursor:L,shouldResetSelection:P=!1})=>{const I=Ze(),z=Vr(),_=x.useRef(null),S=x.useRef(null),[W,Z]=x.useState(null),oe=Zt(),fe=oe.resolvedTheme==="dark",[{width:$e},ye]=ir(),G=x.useRef(m);G.current=m;const U=x.useRef(w);U.current=w;const se=x.useRef(N);se.current=N;const X=x.useRef(b);X.current=b;const pt=x.useCallback(y=>{var R,v;const B=Ar({intl:I,toaster:z,comments:n,edits:o,value:y,selection:P||(R=S.current)==null?void 0:R.state.selection,onBlur:H=>{var Y;return(Y=G.current)==null?void 0:Y.call(G,H)},onFocus:H=>{var Y;return(Y=U.current)==null?void 0:Y.call(U,H)},onSave:()=>{var H;return(H=X.current)==null?void 0:H.call(X)},modelCursor:L,isDisabled:f,safeUrls:E});(v=S.current)==null||v.updateState(B),Z(B)},[n,o,I,z,L,f,P,E]);x.useImperativeHandle(r,()=>({UNSAFE_setValue:pt,revertChanges:()=>{if(S.current==null)throw new Error("Tried to call revertChanges, but viewRef.current is null");Gs(S.current)},flushChanges:()=>{if(S.current==null)throw new Error("Tried to call flushChanges, but viewRef.current is null");Ws(S.current)},maybeFocusOnEditor:y=>{if(S.current==null)throw new Error("Tried to call maybeFocus, but viewRef.current is null");return wi(S.current,y)},viewRef:S})),x.useEffect(()=>{const{current:y}=_;if(!y)return;const{view:B}=gi(y,{intl:I,toaster:z,comments:n,value:h,onBlur:R=>{var v;return(v=G.current)==null?void 0:v.call(G,R)},onFocus:R=>{var v;return(v=U.current)==null?void 0:v.call(U,R)},onChange:R=>{var v;return(v=se.current)==null?void 0:v.call(se,R)},onUpdate:Z,onSave:()=>{var R;return(R=X.current)==null?void 0:R.call(X)},isDisabled:f,safeUrls:E},fe);return S.current=B,()=>{B==null||B.destroy()}},[p]),x.useEffect(()=>{var y;(y=S.current)==null||y.setProps({editable:()=>!f})},[f]),te(y=>bo(y,f),S,[f]),te(y=>{if(oe.resolvedTheme==null)return;const{schema:B}=y.doc.type,R=B.nodes.code_block;return R&&y.doc.descendants((v,H)=>{if(v.type===R){const Y=v.type.create({...v.attrs,isDarkMode:fe},v.content,v.marks);y.replaceWith(H,H+v.nodeSize,Y)}}),y},S,[oe.resolvedTheme,fe]),te(y=>y.setMeta(Ye,d),S,[d]),te(y=>di(y,L),S,[L]),te(y=>y.setMeta(or,{comments:n,commentingOn:s,hoveredCommentId:a,focusedCommentId:l}),S,[n,a,l,s]),te(y=>y.setMeta(Re,{edits:o??[],hoveredEditId:u,rejectedEdits:c??new Set,textdocContent:h}),S,[o,u,c,h]),te(y=>No(y,new Set(E??[])),S,[E]);const be=x.useCallback(()=>S.current,[S]),ie=[],Ee=[];return x.Children.forEach(C,y=>{if(!x.isValidElement(y))return;const{type:B}=y;if(B===Br)ie.push(y);else if(B===Rr)Ee.push(y);else throw new Error("Invalid Prosemirror child: "+JSON.stringify(B))}),g.jsx(Sn.Provider,{value:be,children:g.jsx(Tn.Provider,{value:W,children:g.jsxs(vn.Provider,{value:$e,children:[g.jsx("div",{id:we.PROSEMIRROR_CONTEXT_CHILDREN,children:ie}),g.jsxs("div",{className:e,onMouseLeave:k,id:we.PROSEMIRROR_EDITOR_CONTAINER,style:{paddingBottom:i},children:[g.jsx("div",{ref:nt(_,ye),className:F(Or.main,ar.composer,"markdown prose dark:prose-invert focus:outline-none",t?"bg-transparent":"bg-token-main-surface-primary"),style:{width:A}}),Ee]})]})})})},Rr=({children:r})=>r,Br=({children:r})=>r;ge.EditorChildren=Rr;ge.ContextChildren=Br;function ki(r,e){x.useEffect(()=>{const t=r==null?void 0:r.current;if(t!=null)return Hr(t,{mousedown:n=>{var o;((o=e.current)==null?void 0:o.maybeFocusOnEditor(n))===!0&&n.preventDefault()}})},[e,r])}const Ni=({wrapperClassName:r,value:e="",width:t,comments:n,paddingBottom:o})=>{const s=x.useRef(null),i=x.useRef(null),a=Zt().resolvedTheme==="dark";return x.useEffect(()=>{const{current:l}=s;if(l)return i.current=mi({mount:l,comments:n,value:e,isDarkMode:a}),()=>{var u;(u=i.current)==null||u.destroy()}},[]),x.useEffect(()=>{var u;const l=Ir(e,n);(u=i.current)==null||u.updateState(l)},[e,n]),g.jsx("div",{className:r,children:g.jsx("div",{ref:nt(s),className:F(Or.main,"markdown prose dark:prose-invert focus:outline-none"),style:{width:t,paddingBottom:o}})})},Ie=100,xi={type:"spring",duration:1.5,bounce:.1},yi={type:"spring",duration:.5,bounce:0},Wt={type:"spring",duration:.2},Gt={type:"spring",duration:1,delay:.1},bi={type:"spring",duration:1},Ei={type:"spring",duration:.5,bounce:0},Ci=({isRewriting:r=!1,value:e,previousValue:t,previousComments:n,documentWidth:o,paddingBottom:s,onStart:i})=>{const a=ot(),l=kt(0),u=kt(-Ie),c=x.useRef(!1),[d,p]=Pn();x.useLayoutEffect(()=>{const h=a();if(h)return h.dom.style.clipPath="inset(0 0 100% 0)",()=>{const m=a();m&&(m.dom.style.clipPath="")}},[]),x.useEffect(()=>{const h=a();if(h)try{const{top:m}=h.coordsAtPos(0),{top:w,bottom:N}=h.coordsAtPos(h.state.doc.content.size-1,-1),k=N-m,b=w-m;if(l.set(k-b),!d){Nt(u,k+2*l.get(),yi).then(()=>p==null?void 0:p());return}Nt(u,k,xi)}catch(m){j.logError("Failed to set rewrite animation position",m)}},[d,e]);const f=An(u,h=>We(h)-Ie+2);return xt(u,"change",h=>{const m=a();!m||!h||!c.current||(m.dom.style.clipPath=`inset(0 0 calc(100% - ${h}px) 0)`)}),xt(u,"animationStart",()=>{r&&(i==null||i())}),g.jsxs(g.Fragment,{children:[g.jsx(de.div,{className:"absolute top-0 z-10 w-full origin-bottom bg-gradient-to-t from-token-main-surface-primary from-10% to-transparent",style:{translateY:f,height:Ie},initial:{opacity:0},animate:{opacity:1,transition:Wt},exit:{opacity:0,transition:Gt},onAnimationComplete:()=>c.current=!0},"wash-top"),g.jsx(de.div,{className:"absolute top-0 z-10 w-full bg-gradient-to-b from-token-main-surface-primary to-transparent",style:{translateY:u,height:Ie},initial:{opacity:0},animate:{opacity:1,transition:Wt},exit:{opacity:0,transition:Gt}},"wash-bottom"),g.jsx(de.div,{className:"pointer-events-none absolute z-0 min-w-0 max-w-full",initial:{opacity:1},animate:{opacity:.3,transition:bi},exit:{opacity:0,transition:Ei},children:g.jsx(Ni,{value:t,width:o,comments:n,wrapperClassName:"h-fit flex",paddingBottom:s})},"previousValue")]})};function le(){const r=document.getSelection();r&&r.removeAllRanges()}function Xt(r,e){if(r==null)return!1;const t=r.state.schema.marks[e];return t==null?!1:mr(r.state,r.dispatch,t)}function ze(r,e){if(r==null)return!1;const{state:t,dispatch:n}=r,o=ke(t.schema.nodes[tr.proseMirrorNodeName()]);return hr(o,{level:e})(t,n)}function Si(r){if(r==null)return!1;const{state:e,dispatch:t}=r,n=ke(e.schema.nodes[tt.proseMirrorNodeName()]);return hr(n)(e,t)}const Ti=()=>{const r=Ze(),e=ot(),t=lr(),n=x.useCallback(a=>{const{width:l,height:u}=a,c=e();if(!t||!c||"docView"in c&&c.docView==null)return null;const{to:d,empty:p,head:f}=t.selection,h=f===d;if(p||!Ke(c.state.doc,f))return null;const{right:m,left:w,top:N}=c.coordsAtPos(0);let k=f,b=c.state.doc.nodeAt(k);const E=h?-1:1;for(;!(b!=null&&b.isText)&&Ke(c.state.doc,k+E);)k+=E,b=c.state.doc.nodeAt(k);const{left:C,bottom:A,top:L}=c.coordsAtPos(k,h?-1:1),P=m-w;function I(){if(h)return Math.max(C-w-l,0);let W=C-w;return W+l>P&&(W=-(l-P)),W}function z(){const W=window.innerHeight-A>u*2;return h&&W?{top:A-N+8,aboveOrBelow:mt.BELOW}:{top:L-N-u-8,aboveOrBelow:mt.ABOVE}}const _=z();return{left:I(),top:_.top,aboveOrBelow:_.aboveOrBelow,toolbarSize:a}},[t,e]),o=x.useCallback(()=>{var a;return((a=e())==null?void 0:a.dom)??null},[e]),i=[{label:r.formatMessage(Oe.heading1),className:"text-5xl font-semibold",onClick:()=>{j.logButtonClick(ae.TOOLBAR_FORMAT_HEADER1),ze(e(),1),le()}},{label:r.formatMessage(Oe.heading2),className:"text-3xl font-semibold",onClick:()=>{j.logButtonClick(ae.TOOLBAR_FORMAT_HEADER2),ze(e(),2),le()}},{label:r.formatMessage(Oe.heading3),className:"text-2xl font-semibold",onClick:()=>{j.logButtonClick(ae.TOOLBAR_FORMAT_HEADER3),ze(e(),3),le()}},{label:r.formatMessage(Oe.body),className:"text-base",onClick:()=>{j.logButtonClick(ae.TOOLBAR_FORMAT_PARAGRAPH),Si(e()),le()}}].map(a=>g.jsx(ve.Item,{onClick:a.onClick,children:g.jsx("div",{className:a.className,children:a.label})},"text-style-"+a.label));return g.jsxs(dn,{toolbarType:pn.WRITING,getToolbarPosition:n,getEditorDom:o,getSelectionRange:()=>{const a=e();if(!a)return null;const{state:l}=a,{from:u,to:c,sourceFrom:d,sourceTo:p}=In(l);return u==null||c==null||d==null||p==null?(j.logError("Prosemirror getSelectionRange has null values",null,{from:u,to:c,sourceFrom:d,sourceTo:p}),null):{from:u,to:c,sourceFrom:d,sourceTo:p}},children:[g.jsx(Se.Separator,{}),g.jsx(Se.Action,{icon:ho,onClick:()=>{j.logButtonClick(ae.TOOLBAR_FORMAT_BOLD),Xt(e(),gr.proseMirrorMarkName()),le()}}),g.jsx(Se.Action,{icon:fo,onClick:()=>{j.logButtonClick(ae.TOOLBAR_FORMAT_ITALIC),Xt(e(),wr.proseMirrorMarkName()),le()}}),g.jsxs(ve.Root,{children:[g.jsx(ve.Trigger,{className:"m-0 h-full border-none p-0",children:g.jsx(Se.Action,{icon:mo})}),g.jsx(ve.Content,{align:"end",alignOffset:-4,sideOffset:8,onCloseAutoFocus:a=>a.preventDefault(),children:i})]})]})},Oe=qe({heading1:{id:"AR5o30",defaultMessage:"Heading 1"},heading2:{id:"zb/wrc",defaultMessage:"Heading 2"},heading3:{id:"xZJvLM",defaultMessage:"Heading 3"},body:{id:"Hi6z3L",defaultMessage:"Body"},caption:{id:"VXpL7v",defaultMessage:"Caption"}});function Yt({position:r,numEdits:e,closestEditId:t,scrollTopBound:n}){const o=st(),s=Ze(),i=r==="top"?go:Mo,a=()=>{const c=o();if(!c||!t)return;const d=Tr(c,t);if(d.length===0){$r.addError("Edit could not be found while attempting to scroll",{closestEditId:t});return}d[r==="top"?0:d.length-1].scrollIntoView({behavior:"smooth",block:"center"})},l=r==="top"?-4:4,u=n+20;return g.jsx(Be,{children:e>0&&g.jsx(de.div,{className:F("fixed left-1/2 z-20 select-none",{"bottom-[20px]":r==="bottom",[`top-[${u}px]`]:r==="top"}),initial:{scale:.95,translateY:l,translateX:"-50%",opacity:0},animate:{scale:1,translateY:0,translateX:"-50%",opacity:1},exit:{scale:.95,translateY:l,translateX:"-50%",opacity:0},transition:{type:"spring",duration:.3},children:g.jsxs("div",{className:F("flex items-center justify-center rounded-full border px-4 py-2","border-token-main-surface-tertiary bg-token-main-surface-primary shadow-md hover:bg-token-main-surface-secondary"),"aria-label":s.formatMessage(Jt.ariaLabel),role:"button",onClick:a,children:[g.jsx(jr,{...Jt.label,values:{count:e}}),g.jsx(i,{className:"icon-sm ml-2"})]})})})}const Jt=qe({label:{id:"Pf30w4",defaultMessage:"{count, plural, one {1 more edit} other {{count} more edits}}"},ariaLabel:{id:"qTJjzl",defaultMessage:"Button to scroll the next edit into view."}});function vi(r){let e=r;for(;e;){const n=window.getComputedStyle(e).overflowY;if(n==="auto"||n==="scroll")return e;e=e.parentElement}return null}function Pi(r,e){const t=st(),n=On();x.useEffect(()=>{const o=t(),s=o==null?void 0:o.dom;if(!s||!n||r.length===0)return;const i=()=>{const{textdocId:c,history:d}=n;d?Bn(c,d):Ln(c)},a=vi(s),l=c=>{c.key==="Escape"&&i()},u=Rn(e,100);return window.document.addEventListener("keydown",l,{passive:!0}),a&&a.addEventListener("scroll",u,{passive:!0}),()=>{window.document.removeEventListener("keydown",l),a&&a.removeEventListener("scroll",u),u.cancel()}},[t,n,r,e])}function Ai({edits:r,canvasContentRect:e}){const t=st(),[n,o]=x.useState([]),[s,i]=x.useState([]),a=(e==null?void 0:e.top)??0,l=(e==null?void 0:e.bottom)??window.innerHeight,u=x.useCallback(()=>{const c=t();if(!c)return;const d=[],p=[];for(const f of r){const h=ei(c,f.id);if(h.length>0){const m=vr(h);m.bottom<a?d.push([f.id,m]):m.top>l&&p.push([f.id,m])}}d.sort(([,f],[,h])=>f.bottom-h.bottom),p.sort(([,f],[,h])=>f.top-h.top),o(d.map(([f])=>f)),i(p.map(([f])=>f))},[r,t,a,l]);return Pi(r,u),x.useEffect(()=>{const c=setTimeout(u,500);return()=>{clearTimeout(c)}},[u]),g.jsxs(g.Fragment,{children:[g.jsx(Yt,{position:"top",numEdits:n.length,closestEditId:n[n.length-1],scrollTopBound:a}),g.jsx(Yt,{position:"bottom",numEdits:s.length,closestEditId:s[0],scrollTopBound:a})]})}const qt=zr(()=>({rejectedEdits:new Set,hoveredEditId:null})),Ii=({pos:r})=>{const e=ot()(),t=lr();if(!e||!t||r==null)return null;const{doc:n}=t,{top:o,left:s}=e.coordsAtPos(0),{top:i,left:a}=e.coordsAtPos(r),l=n.nodeAt(r),u=r+((l==null?void 0:l.nodeSize)??0)-1,{top:c}=e.coordsAtPos(r+1),{top:d,bottom:p,right:f}=e.coordsAtPos(u),m=(c>=d?f:e.dom.getBoundingClientRect().right)-a,w=p-i+4;return g.jsx(de.div,{style:{top:i-o,left:a-s,height:w,width:m},className:F("absolute after:absolute after:inset-x-[-4px] after:inset-y-0 after:z-0 after:rounded-md after:bg-[Highlight] after:content-[''] dark:after:bg-[Highlight]",ar.blockCommentHover),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}})},Oi=({pos:r})=>g.jsx(Be,{children:r!=null&&g.jsx(Ii,{pos:r})}),Ri={type:"spring",bounce:.12,duration:.64},Ue=24,Bi=8,sa=({comments:r,edits:e,readonlyReason:t,isDisabled:n=!1,isRewriting:o=!1,previousComments:s,previousValue:i,isPreview:a=!1,isRequestActive:l=!1,isWaitingForCommentResponse:u=!1,targetedContent:c=null,canvasContentRect:d,getStableCommentId:p=Fr,onBlur:f,onCancelRequest:h,onChange:m,onSave:w,onAddComment:N,onSubmitAccelerator:k,onAcceptComment:b,onDismissComment:E,value:C,hideComments:A=!1,hideAccelerators:L=!1,hideToolbar:P=!1,hideEditOverlay:I=!1,safeUrls:z,width:_,modelCursor:S,shouldResetSelection:W})=>{const Z=x.useRef(null),oe=x.useRef(null);ki(oe,Z);const[{width:fe},$e]=ir(),ye=x.useRef(null),[G,U]=x.useState(!1),se=ye.current,X=hn(se)??!1,be=(()=>{if(_==null){const T=X?0:gt();return fe-T}return _-yt*2-gt()})(),ie=be>=bt+Vn?bt:Hn,Ee=be-ie,y=Te(({commentingOn:T})=>T),B=Te(({hoveredCommentId:T})=>T),R=Te(({focusedCommentId:T})=>T),v=Te(({hoveredBlockCommentLauncherPos:T})=>T),H=qt(T=>T.hoveredEditId),Y=qt(T=>T.rejectedEdits);x.useEffect(()=>{var T;c==null&&((T=Z.current)==null||T.revertChanges())},[c]),x.useEffect(()=>{var T,Ce;(T=Z.current)==null||T.flushChanges(),(Ce=Z.current)==null||Ce.UNSAFE_setValue(C)},[C]);const Lr=Ur.useState(({windowHeight:T})=>{if(a)return Ue;const Ce=Bi/100*T;return Math.max(Ue,Ce)}),ht="max(3rem,24vh)";return g.jsx("div",{className:"h-full w-full",ref:oe,children:g.jsx(de.div,{className:_n.document,style:{margin:`0 ${yt}px`},initial:{paddingTop:Ue},animate:{paddingTop:Lr},transition:Ri,children:g.jsx("div",{ref:nt($e,ye),className:"z-0 flex w-full flex-col items-center",children:g.jsxs(ge,{comments:r,edits:e,editorRef:Z,hoveredCommentId:B,focusedCommentId:R,hoveredEditId:H,rejectedEdits:Y,value:C,commentingOn:y,isDisabled:n,readonlyReason:t,onBlur:f,onChange:m,onSave:w,width:ie,safeUrls:z,wrapperClassName:"relative z-10 flex max-w-full h-fit",paddingBottom:ht,modelCursor:S,shouldResetSelection:W,transparentBackground:!G,children:[g.jsxs(ge.EditorChildren,{children:[g.jsx(Be,{onExitComplete:()=>U(!1),children:o&&g.jsx(Ci,{isRewriting:o,documentWidth:ie,previousValue:i,previousComments:s,value:C,paddingBottom:ht,onStart:()=>U(!0)})}),!P&&g.jsx(Ti,{}),!A&&g.jsx(Oi,{pos:v}),g.jsx(Be,{children:!A&&g.jsx(fn,{availableWidth:Ee,comments:r,isRequestActive:l,onAddComment:N,onAcceptComment:b,onDismissComment:E,isWaitingForCommentResponse:u,disableBlockComments:l,getStableCommentId:p})}),!I&&g.jsx(Ai,{edits:e,canvasContentRect:d})]}),g.jsx(ge.ContextChildren,{children:!L&&g.jsx(po,{isRequestActive:l,onSubmit:k,readonlyReason:t,actions:Dn,onCancel:h})})]})})})})};export{sa as DocumentComposer};
//# sourceMappingURL=fk256ulgod2d482d.js.map
