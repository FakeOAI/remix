import{V as G,m as e,e6 as J,ex as V,r as d,a9 as O,ba as T,U as X,e5 as $,bi as N,f1 as Q,aJ as I,N as L,dd as ee,br as w,fv as z,ca as se,cb as te,gj as ae,dX as A}from"./cbdhxbjz462fxz30.js";import{eq as P,iw as ne,e6 as ie,U as _,er as re,y as E,bK as oe,e_ as le,c_ as M,cY as ce,aN as de,c7 as me,ix as C,iy as ue,A as ge,c$ as fe,iz as xe,hz as pe,hA as he,iA as Se,iB as v,iC as be,S,b$ as je,d0 as ve,iD as Ce,iE as ye,iF as Ie,dM as ze,iG as B,aA as U,iH as ke,iI as Ne,iJ as Me,iK as y,iL as Ge,dN as Oe,iM as Te,w as Fe,iN as Le,eX as we,iO as Ae,iP as Pe}from"./f4wa8ql6adp83vsr.js";import{b6 as _e,y as Ee,ay as Be,K as Ue,L as R,aL as Re,au as De}from"./k56dd5cd1qc9k1m3.js";import{m as D}from"./k5pz0z71530nw1jz.js";import{a as We}from"./h6uob81jimgynodq.js";import{U as He,P as Ke}from"./g4uelqi4i7na0tkm.js";function W(){const s=G(),i=P(),n=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(ne,{children:e.jsx(D.div,{whileTap:{scale:.98},children:e.jsx(J,{to:ie(),onClick:()=>{i.activeSidebar==="popover-nav"&&_.setActiveSidebar(!1)},children:e.jsx(re,{icon:_e,"data-testid":"explore-gpts-button",children:n})},"explore")})})}function Ye({gizmo:s,historyDisabled:i,section:n,onClick:r,isActive:c,hideOverflowMenu:g=!1,elementRef:o,subConversations:m}){const{clientThreadId:f}=E(),p=V(f),t=G(),[h,a]=d.useState(!1),[l,u]=d.useState(!1);d.useState(!1);const[x,b]=d.useState(null),k=O(),Y=!!s?.gizmo.tags?.includes(oe.FirstParty);let q=!1;d.useEffect(()=>{x==null&&c&&p&&b(!0)},[c,p,x]);let j;if(s!=null)j=s.gizmo.display.name||le;else{if(k==null)return null;i?j=t.formatMessage(M.clearChat):k.canInteractWithGizmos()?j=fe:j=t.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(D.div,{whileTap:{scale:.98},onMouseEnter:()=>{u(!0)},onMouseLeave:()=>{u(!1)},children:e.jsx(ce,{loggingGizmoId:s?.gizmo.id??"primary",href:de(s),onClick:r,showActiveIndicator:q,icon:e.jsx(me,{isFirstParty:Y,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6 shrink-0"}),isMenuOpen:h,label:j,rightIcon:n===C.Workspace&&e.jsx(T,{side:"right",label:t.formatMessage(F.workspaceRecommended,{workspace_name:k?.name??"Your Workspace"}),children:e.jsx(Ee,{className:"icon-md text-token-text-secondary",alt:t.formatMessage(F.workspaceRecommended,{workspace_name:k?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(l||h)&&!g&&e.jsx("div",{className:"text-token-text-tertiary",onClick:Z=>{Z.preventDefault()},children:e.jsx(ue,{gizmo:s,isOpen:h,setIsOpen:a,section:n})}),!g&&e.jsx(T,{side:"right",label:t.formatMessage(i?M.clearChat:M.newChat),className:"flex items-center",children:e.jsx("button",{className:h?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:i?e.jsx(Be,{className:"icon-md"}):e.jsx(Ue,{className:"icon-md"})})})]}),elementRef:o})}),e.jsx(ge,{children:!1})]})}const F=X({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}}),qe=2;function H({gizmos:s,isGizmoFlyout:i,isLoaded:n,maxToShowOnLoad:r=4,isScreenArch:c,showAllSidebarItems:g}){const o=Se(s,l=>l.flair.kind),m=[...(o[v.Workspace]?.map(({resource:l})=>({gizmo:l,section:C.Workspace}))??[]).slice(0,3),...o[v.FirstParty]?.map(({resource:l})=>({gizmo:l,section:C.Keep}))??[],...o[v.SidebarKeep]?.map(({resource:l})=>({gizmo:l,section:C.Keep}))??[]],f=o[v.Recent]?.slice(0,c||n?o[v.Recent]?.length:qe).map(({resource:l})=>({gizmo:l,section:C.Recents}))??[],p=f.length,t=m.length,h=c?p>0:s.length>r;let a=[];return i&&c?a=[...m,...f]:!i&&c?a=m:(a=[...m,...f],g||(a.length>r&&t>r?a=a.slice(0,t):a.length>r&&(a=a.slice(0,r)))),{listItems:a,itemsLeft:s.length-a.length,needsToCollapseItems:h,total:s.length}}function K({gizmo:s,currentGizmoId:i,maxToShowOnLoad:n,hideOverflowMenu:r=!1}){const c=d.useRef(!1),g=!n,o=$(),[m,f]=d.useState(!1),p=P(u=>!xe.isGptListCollapsed(u)),{listItems:t,needsToCollapseItems:h,itemsLeft:a}=H({gizmos:s,isGizmoFlyout:g,isLoaded:m,maxToShowOnLoad:n,isScreenArch:o,showAllSidebarItems:p});d.useEffect(()=>{m||f(!0)},[m]),d.useEffect(()=>{t.length>0&&!c.current&&(pe({namespace:he.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),c.current=!0)},[t]);function l(u,x){const b=e.jsx(Ye,{gizmo:u,isActive:u.gizmo.id===i,section:x,hideOverflowMenu:r},u.gizmo.id);return o?e.jsx("li",{children:b}):b}return e.jsxs("div",{children:[t.map(({gizmo:u,section:x},b)=>e.jsxs(d.Fragment,{children:[b>1&&x!==t[b-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),l(u,x)]},b)),!o&&h?e.jsxs("button",{onClick:_.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(R,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:p?e.jsxs(e.Fragment,{children:[e.jsx(N,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(Re,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:a}}),e.jsx(De,{className:"icon-xs"})]})})]}):null,!o&&e.jsx(W,{})]})}function Ze({currentGizmoId:s,gizmos:i,onClick:n}){const{isSidebarFlyoutOpen:r,onSidebarFlyoutOpenChange:c}=be(),g=r(S.Gizmo),o=je();return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(Q,{onOpenChange:m=>c(S.Gizmo,m),side:o?"bottom":"right",sideOffset:4,open:g,contentAlign:"end",triggerButton:e.jsxs("button",{className:I("flex flex-1 select-none items-center gap-2.5 rounded-lg px-2 py-[7px] text-body tracking-condensed text-token-text-secondary ease-[var(--spring-bounce)] hover:bg-token-main-surface-secondary focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",g&&"bg-token-main-surface-secondary"),onClick:n,children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx(R,{className:I("icon-md font-semibold text-token-sidebar-icon")})})}),e.jsx("span",{className:"text-left",children:e.jsx(N,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(L,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(K,{gizmo:i,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function Je({currentGizmoId:s}){const{data:{gizmos:i}={}}=ve();let n=i;const{needsToCollapseItems:r}=H({gizmos:n??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return e.jsx(e.Fragment,{children:e.jsxs(Ce,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(N,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(W,{}),e.jsx(K,{gizmo:n??[],currentGizmoId:s,maxToShowOnLoad:ye}),r&&e.jsx(L,{children:e.jsx(Ze,{currentGizmoId:s,gizmos:n??[]})})]})})}function Ve({clientThreadId:s}){const i=O(),n=ee(s),{isUnauthenticated:r}=w();return r?null:e.jsxs("div",{className:I(z.screenContent),children:[null,null,e.jsx(Ie,{clientThreadId:s}),i?.canInteractWithGizmos()?e.jsx(Je,{currentGizmoId:n}):null,!1]})}function Xe(){const s=O(),i=s?.data==null,{isUnauthenticated:n}=w(),{openSettings:r}=ze(),[c]=d.useState(()=>{const t=se.getCookie(te.Workspace);return typeof t=="string"&&t!==ae}),g=G(),{store:o,actions:m}=B(),f=o(t=>t.mode);if(!s||c&&i)return null;const p=n?e.jsx(He,{}):e.jsx(We,{onClickSettings:()=>r()});return e.jsxs(U,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[p,e.jsx("div",{className:z.togglePinWrapper,children:e.jsx(ke,{tooltipSideOffset:14,className:z.pinSidebarAction,icon:e.jsx(Ne,{}),onActivate:t=>{t.preventDefault(),t.persist(),Me.togglePinSidebar(t,m,f===y.Floating?y.Pinned:y.Floating)},label:f===y.Floating?g.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):g.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:A.FloatingOrPinned})})]})}function $e(){return e.jsx(U,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(Ke,{})})}function Qe(){return e.jsxs(Ge,{className:I(z.screenTrailingBarContainer),children:[e.jsx(Oe,{}),e.jsx($e,{}),e.jsx(Xe,{})]})}function rs(){const{clientThreadId:s,onNewThread:i}=E(),[n,r]=d.useState(!1),[c,g]=d.useState(!1),[o,m]=d.useState(!1),{store:f}=B(),p=d.useCallback(a=>a===S.Conversation?n:a===S.Gizmo?c:a===S.Conversation2?o:!1,[n,c,o]),t=d.useCallback((a,l)=>{const u=x=>{a===S.Conversation?r(x):a===S.Gizmo?g(x):a===S.Conversation2&&m(x)};l?u(!0):setTimeout(()=>{u(!1)},100)},[]),h=d.useRef(null);return Te((a,l)=>{t(S.Conversation,!1),t(S.Gizmo,!1),t(S.Conversation2,!1);const u=window.matchMedia("(max-width: 700px)").matches,x=Pe(h.current);l!=null&&u&&f.getState().isSidebarOpen&&(f.getState().mode===y.Floating||x)&&setTimeout(()=>{document.getElementById(A.OpenOrClosed)?.click()},100)}),e.jsxs(Fe,{value:{isSidebarFlyoutOpen:p,onSidebarFlyoutOpenChange:t},children:[e.jsx(Le,{}),e.jsx(we,{anchor:"vertical",className:I(z.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Ae,{onNewThread:i}),ref:h,trackLeading:!0,trailing:e.jsx(Qe,{}),children:e.jsx(Ve,{clientThreadId:s})})]})}export{rs as C,K as G};
//# sourceMappingURL=gtgde1h0dal1tgot.js.map
