const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/fvseeqj45mlcmr4f.js","assets/n6pd72le962cb7i2.js","assets/b84o1u0lhllftt1g.js","assets/root-k8lflb3j.css","assets/jz3yie9s5yhl0osu.js","assets/conversation-small-ict01xsi.css","assets/j8qj2mi7846az0e7.js","assets/iimzyot6hhcmz5qa.js","assets/k609s5fg5ghp3dka.js","assets/c0x15a84d4rx87eg.js","assets/gig7dd13aioyin14.js","assets/ADAVisualizationComponent-mi6em660.css","assets/ot4ctwai6ysf0oo6.js","assets/oj2veiwipsmw7uuk.js","assets/4chk33l3szqq2hql.js","assets/k34nwqibnbti3wva.js","assets/ie547sv5ox2nkp3n.js","assets/faw9amkus14x8nq9.js","assets/fppcfzlv2nmn16e4.js","assets/hh0cnz6r8k8fz8v3.js","assets/pcece7s08xl1r2mv.js","assets/mgzsbnnxz3mr8vlv.js","assets/nchwdlj91449w2t4.js","assets/hsh822269qp8bzmy.js","assets/bc3rb19q45ni9l0g.js","assets/cw5qatzn1wj4phht.js"])))=>i.map(i=>d[i]);
import{aj as ie,r as E,a6 as t,aY as xe,ar as b,aw as B,aE as N,aF as w,M as H,c6 as he,c7 as pe,aG as W,O as Me,P as G,d as Y,I as z,dk as Ee,S as Te,K as ye,e as Ie}from"./n6pd72le962cb7i2.js";import{i3 as _e,i4 as Ce,g3 as Ae,g4 as ve,fY as je,i5 as be,gD as Ne,i6 as we,i7 as Se,i8 as Re,i9 as Fe,ia as Pe,ib as ke,ic as De,id as Oe,g6 as x,g5 as D,ie as J,ig as Q,ih as Le,ii as ze,ij as q,ik as oe,bA as V,fy as re,il as Ve,im as Ue,io as We,ip as Be,bx as de,iq as He,ir as Ke,is as Ge,al as Ye,it as Je,iu as Qe,iv as qe,iw as le,ix as $e,iy as ce,iz as Xe,c as Ze,iA as es,bB as ss,iB as ts,v as k,bw as as,fH as ns,iC as is,g2 as c,A as os,dt as rs,iD as ds,iE as ls,cU as cs,iF as ms,iG as gs,iH as us,iI as fs,iJ as xs,iK as hs,iL as U,iM as ps}from"./jz3yie9s5yhl0osu.js";import{h as $,i as Ms,w as Es}from"./oj2veiwipsmw7uuk.js";import{m as O}from"./j8qj2mi7846az0e7.js";import{aq as Ts,ar as ys}from"./b84o1u0lhllftt1g.js";const Is=(e,a)=>e?.textdocId?e.textdocId:e?.function===D.CreateTextdoc?Le(e):a??void 0,_s=({messages:e,isRequestActive:a})=>{const s=ie(),i=_e(e),o=Ce(e),n=E.useMemo(()=>{if(Ae(i?.message))return ve(a,i.message,o?.message??null)},[a,i,o]),g=je(),r=Is(n,g),l=be(r),h=Ne(),u=we(r),M=Se(),d=Re(),f=Fe(),p=Pe(),T=ke(),I=De(),v=Oe({textdocId:r,toolResponseMessage:o});if(!n)return null;const j=n.status===x.REDACTED||!p&&!l&&n.status!==x.STREAMING&&n.status!==x.WAITING&&T;let S,R;if(n.status!==x.REDACTED&&n.status!==x.FAILED&&!j&&r){const C=I&&n.function===D.UpdateTextdoc&&n.status===x.COMPLETE;S=()=>{C&&n.versionInt?ze(r,n.versionInt,M):J(r)},R=()=>{C&&n.versionInt&&f(r,n.versionInt)}}const m=Cs(n,l);if(n.function===D.CreateTextdoc){if(n.status===x.STREAMING||n.status===x.WAITING||n.status===x.COMPLETE){const L=p===!0&&(n.status===x.STREAMING||n.status===x.WAITING);return t.jsx($,{isInlinePreview:v,isFetching:L,type:n.type??null,name:m,isFocused:u,isStreaming:n.status===x.STREAMING,onClick:S,isCanvasOpen:h,textdocId:r})}let C;switch(n.status){case x.FAILED:C=s.formatMessage({id:"SNarKX",defaultMessage:"Failed to generate"});break;case x.CANCELED:C=s.formatMessage({id:"1A6W36",defaultMessage:"Stopped generating"});break;case x.REDACTED:C=t.jsx(xe,{align:"start",label:s.formatMessage({id:"F6q1k7",defaultMessage:"Removed from shared conversation"}),children:s.formatMessage({id:"BqyYDu",defaultMessage:"Created document"})});break}return t.jsx(X,{children:C})}const y=j||n.status===x.REDACTED,F=d&&!y?m:null,_=t.jsx(X,{onClick:S,onMouseOver:R,isStreaming:n.status===x.STREAMING,children:n.function===D.CommentTextdoc?vs(s,n,F):As(s,n,F)});return v&&!h&&!j?t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx($,{isInlinePreview:!0,isFetching:!1,type:l?.type??null,name:m,isFocused:u,isStreaming:n.status===x.STREAMING,onClick:r!=null?()=>J(r):void 0,isCanvasOpen:h,textdocId:r}),_]}):_};function Cs(e,a){return a?.title?Q(a.title):e.function===D.CreateTextdoc&&e.title?Q(e.title):null}const X=({isStreaming:e=!1,onClick:a,onMouseOver:s,children:i})=>t.jsx("button",{disabled:!a,className:b(e&&"loading-shimmer","flex min-h-5 w-fit select-none pt-[3px] text-start text-token-text-secondary",a&&"hover:text-token-text-primary"),onClick:a,onMouseOver:s,children:i}),me=9;function As(e,a,s){if(a.status===x.STREAMING)return s?e.formatMessage({id:"W2xN1Z",defaultMessage:"Editing {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"8taq8v",defaultMessage:"Editing"});if(a.status===x.FAILED)return s?e.formatMessage({id:"UjJKYZ",defaultMessage:"Failed to edit {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"kWUVkg",defaultMessage:"Failed to edit"});if(a.status===x.CANCELED)return s?e.formatMessage({id:"TmSrCd",defaultMessage:"Stopped editing {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"bYV7xA",defaultMessage:"Stopped editing"});const i=a.updates?.length;return a.status===x.REDACTED||!i||i>me?s?e.formatMessage({id:"n+G/ct",defaultMessage:"Edited {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"aegqpL",defaultMessage:"Edited"}):s?e.formatMessage({id:"osYMSb",defaultMessage:"{numEdits, plural, one {Edited {documentTitle}} other {Made {numEdits} edits to {documentTitle}}}"},{numEdits:i,documentTitle:s}):e.formatMessage({id:"xJD3WR",defaultMessage:"{numEdits, plural, one {Edited} other {Made {numEdits} edits}}"},{numEdits:i})}function vs(e,a,s){if(a.status===x.STREAMING)return s?e.formatMessage({id:"8xQH/P",defaultMessage:"Commenting on {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"5yqLeN",defaultMessage:"Commenting"});if(a.status===x.FAILED)return s?e.formatMessage({id:"Rl821S",defaultMessage:"Failed to comment on {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"W007jt",defaultMessage:"Failed to comment"});if(a.status===x.CANCELED)return s?e.formatMessage({id:"bozPdq",defaultMessage:"Stopped commenting on {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"hyBGa7",defaultMessage:"Stopped commenting"});const i=a.comments?.length;return a.status===x.REDACTED||!i||i>me?s?e.formatMessage({id:"LXEzK7",defaultMessage:"Commented on {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"KeMYhy",defaultMessage:"Commented"}):s?e.formatMessage({id:"Ql5lPq",defaultMessage:"{numComments, plural, one {Commented on {documentTitle}} other {Added {numComments} comments on {documentTitle}}}"},{numComments:i,documentTitle:s}):e.formatMessage({id:"FHtyJQ",defaultMessage:"{numComments, plural, one {Commented} other {Added {numComments} comments}}"},{numComments:i})}const js=2e3,ge=.4,bs=.45,Ns=.2,ws=.1,Ss=.25;var A=(e=>(e[e.Running=0]="Running",e[e.Finished=1]="Finished",e[e.Error=2]="Error",e[e.Stopped=3]="Stopped",e[e.Paused=4]="Paused",e))(A||{});function ot({conversationMessages:e,icon:a,status:s,text:i,estimatedToolDurationMs:o,animationLoopDurationMs:n=js,shouldPersistAfterFinished:g=!1}){const[r,l]=E.useState(s===0?0:s===1&&!g?7:1),[h,u]=E.useState(0);E.useEffect(()=>{s===2?l(8):s===3?l(9):s===4?l(10):s===1?l(r===2?3:7):s===0&&r===10&&(l(2),u(d=>d+1))},[s]);const M=Ps(r);return E.useEffect(()=>{const d=e[0].message.id;if(M)return q.addDelayedRenderingMessage(d),()=>{q.removeDelayedRenderingMessage(d)}},[M]),oe(()=>{P(r)&&u(d=>d+1)},n),r===7&&!g?null:t.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[t.jsx(Rs,{icon:a,status:s,uiState:r,estimatedToolDurationMs:o,animationLoopCounter:h,shouldPersistAfterFinished:g,onFillProgressBarAnimationComplete:()=>l(4),onFinishAnimationComplete:()=>{l(5),setTimeout(()=>{l(g?7:6)},ws*1e3)},onHideAnimationComplete:()=>l(7)}),t.jsx(Fs,{text:i,uiState:r,animationLoopCounter:h,onEnterAnimationComplete:()=>l(2)})]})}const Z=50;function Rs({icon:e,status:a,uiState:s,estimatedToolDurationMs:i,animationLoopCounter:o,shouldPersistAfterFinished:n,onFillProgressBarAnimationComplete:g,onFinishAnimationComplete:r,onHideAnimationComplete:l}){const[h,u]=E.useState(0);oe(()=>{P(s)?u(j=>j+Z):s===10&&u(0)},Z);let M,d,f;P(s)||s===10?(M="running",d=t.jsx(e,{animationLoopCounter:o}),f="bg-transparent"):s===4||s===5||s===7&&n?(M="finished",d=t.jsx(Ve,{}),f="bg-brand-purple"):a===2?(M="error",d=t.jsx(Ue,{}),f="bg-orange-500"):a===3&&(M="stopped",d=t.jsx(We,{}),f="bg-gray-300");let p={opacity:0,scale:0,rotate:-180,x:0},T={type:"spring",bounce:.3,duration:bs},I={opacity:0,scale:.6,rotate:0,x:0};s===0?(p={opacity:0,scale:.5,rotate:-180,x:-8},T={type:"spring",bounce:.3,duration:ge}):s===1?p=!1:s===5&&(I={opacity:0,scale:0,rotate:0,x:0},T={type:"spring",bounce:.3,duration:Ss});const v=Be(h,i);return t.jsx("div",{className:"relative h-5 w-5 shrink-0",children:t.jsx(V,{onExitComplete:()=>{s===6&&l()},children:M!=null&&t.jsxs(O.div,{className:b("absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",f),initial:p,animate:{opacity:1,scale:1,rotate:0,x:0},exit:I,transition:T,onAnimationComplete:()=>{s===4&&r()},children:[d,(P(s)||s===10)&&t.jsx(re,{percentage:s===3?100:v,thickness:1.5/23,className:"absolute left-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2 text-brand-purple",backgroundStrokeClassName:"stroke-brand-purple/25 dark:stroke-brand-purple/50",transitionDuration:s===3?`${(100-v)/100*Ns}s`:void 0,transitionTimingFunction:s===3?"cubic-bezier(0.55, 0, 1, 1)":void 0,onTransitionEnd:()=>{s===3&&g()}})]},M)})})}function Fs({text:e,uiState:a,animationLoopCounter:s,onEnterAnimationComplete:i}){const[o,n]=E.useState(e);E.useEffect(()=>{a===2&&n(e)},[s]),E.useEffect(()=>{P(a)||n(e)},[a,e]);let g={opacity:0,x:0,y:15},r={type:"spring",bounce:.3,opacity:{duration:.15},y:{duration:.3}};a===0?(g={opacity:0,x:-8,y:0},r={type:"spring",bounce:.3,duration:ge,delay:.15}):a===1&&(g=!1);const l=o??void 0;return t.jsx("div",{className:b("relative h-5 w-full leading-5",a===8||a===9?"text-token-text-tertiary":"text-token-text-secondary"),children:t.jsx(V,{children:l!=null&&t.jsx(O.div,{className:"absolute left-0 top-0 line-clamp-1 overflow-visible",initial:g,animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:0,y:-15},transition:r,onAnimationComplete:()=>{a===0&&i()},children:l},l.toString())})})}function P(e){return e===0||e===2||e===3}function Ps(e){return P(e)||e===4||e===5||e===6||e===10}const ee=B.div`group absolute left-0 top-0 mr-1.5 h-8 overflow-hidden mt-1`;function K({highlightedCommand:e,status:a,children:s,showWorkUserSetting:i=!1,hideOnlyIfNotInteractedWith:o=!1,onOpenAnalytics:n}){const g=s!=null,[r]=E.useState(i),[l,h]=E.useState(i),[u,M]=E.useState(!1),d=a===A.Finished||a===A.Error,f=o?r?!1:!u:!1,p=a===A.Running&&"loading-shimmer";return d&&f?null:g?t.jsxs(t.Fragment,{children:[t.jsx(se,{$canShowWork:!0,children:t.jsx(V,{children:t.jsx(ee,{children:t.jsx(O.button,{onClick:()=>{l||n?.(),h(T=>!T),M(!0)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:b(p),children:t.jsxs("div",{className:"flex items-center justify-start gap-1",children:[t.jsx("span",{children:e}),l?t.jsx(Ts,{className:"icon-md"}):t.jsx(ys,{className:"icon-md"})]})},e?.toString())})})}),t.jsx(V,{children:l&&s&&t.jsx(O.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s})})]}):t.jsx(se,{$canShowWork:!1,children:t.jsx(ee,{className:b(p),children:e})})}const se=B.p`first:mt-0 relative h-8
${({$canShowWork:e})=>e?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,te=N(()=>w(()=>import("./fvseeqj45mlcmr4f.js").then(e=>e.A),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])).then(e=>e.default));function ks({messages:e,isRequestActive:a,clientThreadId:s}){const[i,o]=e,n=de(i.message),g=o?.message.metadata?.aggregate_result,r=He(),l=Ke(),h=o?.message?Ge(o.message):[],u=o?.message.metadata?.aggregate_result?.messages.filter(Ye)??[],d=(h.filter(T=>T.type==="chart")??[]).length!==u.length,f=l&&!d;let p=A.Running;return g?.status==="success"?p=A.Finished:o!=null&&o.message.content.content_type!==H.ExecutionOutput||g!=null&&g.status!=="running"?p=A.Error:(n||!a)&&(p=A.Stopped),t.jsxs(t.Fragment,{children:[t.jsx(Ds,{messages:e,status:p,isRequestActive:a}),f&&h.map((T,I)=>{const{type:v}=T;return v==="chart"&&!r?(T.fallback_to_image=!0,t.jsx(ae,{children:t.jsx(te,{clientThreadId:s,visualization:T})},I)):t.jsx(ae,{children:t.jsx(te,{clientThreadId:s,visualization:T})},I)}),!f&&o!=null&&t.jsx(Je,{message:o.message})]})}const ae=B.div`mb-3 max-w-[80%]`;function Ds({messages:e,status:a,isRequestActive:s}){const[i,o]=e,n=ie(),g=o?.message.metadata?.aggregate_result,r=de(i.message),{data:l,error:h}=he(pe.ShowExpandedCodeView);let u=n.formatMessage({id:"message.tools.data-analysis.running",defaultMessage:"Analyzing"});if(g?.status==="success"?u=n.formatMessage({id:"message.tools.data-analysis.finished",defaultMessage:"Analyzed"}):o!=null&&o.message.content.content_type!==H.ExecutionOutput||g!=null&&g.status!=="running"?u=n.formatMessage({id:"message.tools.data-analysis.error",defaultMessage:"Analysis errored"}):(r||!s)&&(u=n.formatMessage({id:"message.tools.data-analysis.stopped",defaultMessage:"Analysis paused"})),l!==void 0||h){const M=Qe(i.message)!=null;return t.jsx(K,{status:a,highlightedCommand:u,showWorkUserSetting:l??!1,hideOnlyIfNotInteractedWith:!0,children:M?t.jsxs("div",{className:"mb-3 mt-0.5 overflow-hidden rounded-xl bg-black",children:[t.jsx(qe,{message:i.message,FormattedText:le}),o!=null&&t.jsx($e,{message:o.message})]}):null})}return null}const Os=3,Ls=.1,ne=[0,.26,.4];function zs({nextMessage:e,isLastMessage:a,isRequestActive:s}){let i=a||!e||e&&!ce(e.message);const o=Xe(e?.message),n=Ze(o.slice(0,Os).map(g=>g.entries[0].url));if(e?.message.id&&es(e?.message.id),i){const g=s?t.jsxs("div",{className:"flex items-center gap-1",children:[n.map((r,l)=>t.jsx(O.div,{className:b("-ml-1.5 first:ml-0 last:mr-1.5","relative"),initial:{width:l===0?0:6,opacity:0},animate:{width:20,opacity:1},transition:{duration:Ls,delay:ne[Math.min(l,ne.length-1)]},children:t.jsx("div",{className:b("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full","border-2 border-token-main-surface-primary bg-token-main-surface-primary"),children:t.jsx(ss,{url:r,size:32,minSize:16,className:"icon-md rounded-full"})})},r)),t.jsx(W,{id:"jjx8Qg",defaultMessage:"Searching the web"})]}):t.jsx(W,{id:"fssXGM",defaultMessage:"Error while searching"});return t.jsx(K,{highlightedCommand:g,status:s?A.Running:A.Error})}return null}const Vs={strong:e=>{const{node:a,children:s,...i}=e;return t.jsx("strong",{...i,className:b(i.className,"font-semibold text-token-text-primary"),children:s})},p:e=>{const{node:a,children:s,...i}=e;return t.jsx("p",{...i,className:b(i.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:s})}};function Us({headline:e,message:a}){const i=a.create_time?new Date(a.create_time*1e3):Date.now(),o=+new Date-+i,n=ns(a.id,48e4,is(48e4,o));return t.jsxs("div",{className:"flex items-center gap-2.5",children:[t.jsx(re,{percentage:n,thickness:1/8,className:"h-5 w-5 text-token-text-primary",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-n)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"}),e]})}function Ws({messages:e,isStreaming:a,clientThreadId:s}){const[i,o]=E.useState(""),[n,g]=E.useState(!1),h=ts(s)===Me.STREAMING||a,u=e[0].message,M=u.id,d=k.getServerThreadId(s),f=as(u),p=u.metadata?.summarization_headline,T=a&&p!=null;E.useEffect(()=>{const j=/\*\*(.*?)(?:\*\*|\n|$)/g;let S,R="";for(;(S=j.exec(f))!=null;)R=S[1].trim();R?o(R):u.metadata?.initial_text!=null&&o(u.metadata.initial_text)},[f,u.metadata?.initial_text]),E.useEffect(()=>{f.length>0&&!p&&g(!0)},[f,p]);const I=E.useMemo(()=>({client_thread_id:s,message_id:M,conversationId:d}),[s,M,d]);E.useEffect(()=>{n&&G.logEvent(Y.receivedA8KM123Message,I)},[n]);const v=E.useCallback(()=>{G.logEvent(Y.openedA8KM123Message,{...I,isStreaming:a})},[I,a]);return t.jsx(K,{status:h?A.Running:A.Finished,highlightedCommand:h?p==null?i:t.jsx(Us,{headline:p,message:u}):u.metadata?.finished_text??"",onOpenAnalytics:v,children:n&&!T?t.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:t.jsx(le,{componentOverrides:Vs,className:"not-prose leading-6",children:f})}):null})}const Bs=N(()=>w(()=>import("./ot4ctwai6ysf0oo6.js"),__vite__mapDeps([12,1,2,3,4,5,13,10,14,7,15,6,16]))),Hs=N(()=>w(()=>import("./faw9amkus14x8nq9.js"),__vite__mapDeps([17,1,2,3,4,5]))),Ks=N(()=>w(()=>import("./fppcfzlv2nmn16e4.js"),__vite__mapDeps([18,1,2,3,4,5,13,10,14,7,15,6,16]))),Gs=N(()=>w(()=>import("./hh0cnz6r8k8fz8v3.js"),__vite__mapDeps([19,1,2,3,4,5])).then(e=>e.TextMessageEditor)),Ys=N(()=>w(()=>import("./pcece7s08xl1r2mv.js"),__vite__mapDeps([20,1,2,3,4,5,6,13,10,14,7,15,16]))),Js=N(()=>w(()=>import("./mgzsbnnxz3mr8vlv.js"),__vite__mapDeps([21,1,2,3,4,5,13,10,14,7,15,6,16]))),Qs=N(()=>w(()=>import("./nchwdlj91449w2t4.js"),__vite__mapDeps([22,1,2,3,4,5,23,6,13,10,14,7,15,16])).then(e=>e.BrowsingMessage)),qs=N(()=>w(()=>import("./bc3rb19q45ni9l0g.js"),__vite__mapDeps([24,1,2,3,4,5])).then(e=>e.SearchResultMessage)),$s=N(()=>w(()=>import("./cw5qatzn1wj4phht.js"),__vite__mapDeps([25,1,2,3,4,5,13,10,14,7,15,6,16])).then(e=>e.JITPluginMessage));function rt(e){switch(e.type){case c.Text:case c.Debug:return[e.message];case c.MultiText:case c.Browsing:case c.CodeInterpreter:case c.JITPlugin:case c.RetrievalBrowsing:case c.ParallelBrowsing:case c.Dalle:case c.GizmoEditor:case c.SearchResult:case c.a8km123:case c.f959b8c:case c.b1de6e2:case c.b1de6e2_c:case c.Canmore:case c.de1d73e:case c.SearchGPTQuery:return e.messages;default:throw new Error("Bad")}}function dt({groupedMessagesToRender:e,allGroupedMessages:a,clientThreadId:s,isEditing:i,isUserTurn:o,isCompletionRequestInProgress:n,isFeedbackEnabled:g,isFinalTurn:r,turnIndex:l,hasActiveRequest:h,showEditButton:u=!1,handleEnterEdit:M,handleExitEdit:d,onChangeItemInView:f,onRequestMoreCompletions:p,onRequestCompletion:T,shouldGrowContainer:I=!0}){const{showDebugConversationTurns:v}=os(),j=rs(s),S=a.some(m=>ds.includes(m.type)),R=e.map((m,y)=>{const F=y===a.length-1;switch(m.type){case c.Text:case c.MultiText:{const _=e[y-1],C=_?.type,L=_&&"messages"in _?_.messages:void 0;if(m.type===c.Text){const ue=m?.message&&!ce(m.message.message),fe=i?t.jsx(Gs,{message:m.message,clientThreadId:s,onChangeItemInView:f,onRequestCompletion:T,onRequestMoreCompletions:p,onExitEdit:d,disabled:h}):S&&ue?null:t.jsx(Ms,{className:"min-h-8",message:m.message,isFeedbackEnabled:g,isCompletionInProgress:F&&n,turnIndex:l,clientThreadId:s,showEditButton:u,onEnterEdit:M,isUserTurn:o,onRequestMoreCompletions:p,prevGroupedMessageType:C,prevGroupedMessages:L});return t.jsxs(E.Fragment,{children:[fe,t.jsx(ls,{isUserTurn:o,message:m.message.message})]},"group-"+m.message.nodeId)}else return m.type===c.MultiText?t.jsx(Ks,{clientThreadId:s,messages:m.messages,isCompletionInProgress:F&&n,isFeedbackEnabled:g,onRequestMoreCompletions:p,prevGroupedMessageType:C,prevGroupedMessages:L},"multitext-"+(m.messages[0]?.nodeId??y)):m.type}case c.Browsing:case c.RetrievalBrowsing:{const _=j!=null&&[z.GizmoInteraction,z.GizmoMagicCreate,z.GizmoTest].includes(j.kind);return t.jsx(Qs,{messages:m.messages,isRequestActive:h,isLastMessageInTurn:F,isUsingGizmo:_,isRetrieval:m.type===c.RetrievalBrowsing},"browsing-"+(m.messages[0]?.nodeId??y))}case c.SearchGPTQuery:{const _=a.slice(y+1).find(C=>C.type===c.Text);return t.jsx(zs,{isRequestActive:h,isLastMessage:F,nextMessage:_&&_.type===c.Text?_.message:void 0},"searchquery-"+(m.messages[0]?.nodeId??y))}case c.a8km123:return t.jsx(Ws,{messages:m.messages,isStreaming:F&&n,clientThreadId:s},"sum-"+(m.messages[0]?.nodeId??y));case c.f959b8c:return null;case c.b1de6e2:return null;case c.b1de6e2_c:return null;case c.de1d73e:return null;case c.ParallelBrowsing:return t.jsx(Js,{messages:m.messages},"parallel-"+(m.messages[0]?.nodeId??y));case c.CodeInterpreter:return t.jsx(ks,{messages:m.messages,isRequestActive:h,clientThreadId:s},"ada-"+(m.messages[0]?.nodeId??y));case c.JITPlugin:return t.jsx($s,{messages:m.messages,clientThreadId:s,isLastTurnInConversation:r,onRequestCompletion:T},"jit-"+(m.messages[0]?.nodeId??y));case c.Dalle:return t.jsx(Ys,{messages:m.messages,clientThreadId:s},"dalle-"+(m.messages[0]?.nodeId??y));case c.GizmoEditor:return t.jsx(Bs,{messages:m.messages},"gizmo-editor-"+(m.messages[0]?.nodeId??y));case c.Canmore:return t.jsx(_s,{messages:m.messages,isRequestActive:h},"canmore-"+(m.messages[0]?.nodeId??y));case c.Debug:return v?t.jsx(Hs,{message:m.message},"debug-"+m.message.nodeId):null;case c.SearchResult:return t.jsx(qs,{messages:m.messages},"search-result-"+(m.messages[0]?.nodeId??y))}});return t.jsx(Zs,{shouldGrowContainer:I,children:R})}function Xs(){return t.jsx(cs,{type:"danger",children:t.jsx(W,{id:"daIg0P",defaultMessage:"Unable to display this message due to a error."})})}function Zs({children:e,shouldGrowContainer:a}){return t.jsx("div",{className:b({"flex max-w-full flex-col":!0,"flex-grow":a}),children:t.jsx(Ee,{name:"GroupedMessages",fallback:Xs,children:e})})}function lt(e,a,s,i){let o=fs.getReadyFiles(e.getState());i?.kind===z.GizmoMagicCreate?o=o.filter(d=>d.gizmoId!=null):o=o.filter(d=>d.gizmoId==null);let n=a??"";const g=[],r=[],l=xs(s,i),u=hs(s,i).length>0,M=l===U.Interpreter||l===U.Retrieval||l===U.ContextConnector;return o.forEach(({fileSpec:d})=>{if(M){const f=d.contextConnectorInfo;g.push({id:d.id,size:d.size,name:d.name,context_connector_info:f?{context_connector:f?.contextConnector,source_url:f?.sourceUrl,synthetic_extension:f?.syntheticExtension??null,type:f?.type}:void 0,mime_type:d.mimeType,width:"width"in d?d.width:void 0,height:"height"in d?d.height:void 0,file_token_size:d.fileTokenSize})}u&&"width"in d&&"height"in d&&r.push({content_type:Ie.ImageAssetPointer,asset_pointer:ps(d.id),size_bytes:d.size,width:d.width,height:d.height})}),r.length>0&&(r.push(a??""),n={content_type:H.MultimodalText,parts:r}),{content:n,attachments:g}}async function ct({clientThreadId:e,currentRequestId:a,queryClient:s,isHistoryAndTrainingDisabled:i}){const o=k.getServerThreadId(e);Es.stopConversation(o);const n=k.getTree(e);!n.hasReceivedServerCompletion&&!i&&n.getParent(a).metadata?.errCode!==ms.ContentPolicy&&setTimeout(()=>{gs.onCreateFinished(s,o,i)},500),o&&Te.checkGate("3922476776")&&await ye.stopConversationProcess(o),us.abortRequest(a)&&k.updateTree(e,r=>{const l=k.getThreadCurrentLeafId(e);r.updateNodeMessageMetadata(l,{finish_details:{type:"interrupted"}})})}export{dt as C,A as T,K as a,ot as b,ct as c,rt as d,lt as g};
//# sourceMappingURL=jhq6ksntpzj6xwb1.js.map
