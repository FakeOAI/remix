import{K as u,L as d,r as S,a8 as g,cn as l,aK as y,h as T,j as p,D as v,ek as R}from"./pcg3wlqr9bj2vzgy.js";import{cD as a,cE as f,cF as A}from"./h7654sawxikjkbks.js";import{P as m,r as C}from"./fbj9i5osn7vd3ih5.js";import{s as P}from"./mp1soi9fngfd7n73.js";import{e as E,i as H,T as b}from"./ix33iw8s97ved9s3.js";const M="prompt-textarea";function O(){document.getElementById(M)?.focus()}const k={getAndReset:(e,s)=>{const t=u.getItem(d.RestoreMessageAfterOauthRedirect);return u.removeItem(d.RestoreMessageAfterOauthRedirect),!t||t.userId!==e||s!==t.serverThreadId||Date.now()>t.expiresAt?null:t},set:(e,s,t)=>{const r={userId:e,serverThreadId:s,inputText:t,expiresAt:Date.now()+6e4};u.setItem(d.RestoreMessageAfterOauthRedirect,r)}},K=()=>m.useState(m.getPersistedSystemHints).has(a.Search),_=()=>{const e=m.useStore(),s=S.useCallback(()=>e.getPersistedSystemHintTrigger(a.Search),[e]),t=S.useCallback(()=>e.clearPersistedSystemHintTrigger(a.Search),[e]),r=S.useCallback((o,n,c)=>{(o?e.addPersistedSystemHint:e.removePersistedSystemHint)(a.Search,n,c)},[e]);return{getSearchModeTrigger:s,clearSearchModeTrigger:t,setThreadSearchMode:r}};async function x(e,s){const t=A(e),r=t??await p.getConversation(e);return s==null&&t&&(s=!0),t||v.addTiming("chatgpt.web.chatPage.loadExistingConversation"),b.initThreadFromServerData(e,r,s,void 0,s),P(r.conversation_id,r.async_status?{source:R.SERVER,value:r.async_status}:null),r}const q=e=>{const{asPath:s,replace:t}=g(),r=l(),o=E(),n=y();T({queryKey:["conversation",e],queryFn:()=>x(e).catch(c=>{const i=f(s),h=i!=null?C(i):"/";throw t(h,void 0,{shallow:!0}),n.danger(`Unable to load conversation ${e}`,{testId:"conversation-fetch-error-toaster"}),c}),enabled:!H(e)&&!r&&!o,refetchOnMount:!0})};export{k as P,M as T,q as a,K as b,x as f,O as t,_ as u};
//# sourceMappingURL=ecl20unthbwwwfpd.js.map
