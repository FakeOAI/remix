const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/hklioh4qu36vm4rt.js","assets/gh3s47paf1sfnqrc.js","assets/eb3stsg8iy7t43kd.js","assets/gie7t2ghpkmat91x.js","assets/mlhieyi9z3gwttrn.js","assets/root-ll1sm06l.css","assets/conversation-small-ogafjggy.css","assets/etj5evuzz6fgtlqe.js","assets/m73oatg382ylvuvx.js","assets/n86rj4z42qeu7i16.js","assets/ebqv5ph7c2sdk5gc.js","assets/cq1wr63lzayx7ig8.js","assets/j7vda0o4435fpq77.js","assets/gc1cav3hbynzlnwl.js","assets/g9iu7nm903guujld.js","assets/h2sd1xa6f1fu46y0.js","assets/dj1r9dxm91vgn5c2.js","assets/l9f3mccvx9rgexey.js","assets/feb9subta6lf5bz0.js","assets/dcuy50ysngytazok.js","assets/f1k15lrwzctkk8t5.js","assets/me49ih2kp8p0srre.js","assets/m878e283hszmxxxu.js","assets/e7e7sp2dnlssszco.js","assets/o0ai3iexyukmznyz.js","assets/garo7dux9f8tjkrm.js","assets/eicqupleklvzus8w.js","assets/dykyitkax7zu1p0e.js","assets/hy9ytkftq6eaca6u.js","assets/jvtc4y0qewtuvgpv.js","assets/guyb7pcses9idql6.js","assets/hamjx3nmi2es0uyk.js","assets/eywwucy45uxgi154.js","assets/b5xpo4my7q19ghh1.js","assets/dxw81r7nm1wt6hch.js","assets/hub8cjv16hlkyxl6.js","assets/eugnppqg149fg6g3.js","assets/n6caxidlhiv8d8nv.js","assets/cn1qwboa3mb2itab.js"])))=>i.map(i=>d[i]);
import{e as To,m0 as L,m1 as Vi,m2 as _t,jo as Ee,m3 as No,m4 as Po,jn as Jt,Q as We,fx as ie,c3 as Gi,ec as Hi,cp as zi,m5 as fe,ie as qe,je as Nn,m6 as Ui,m7 as $i,m8 as Wi,jX as Nr,fm as Pn,js as Pr,jq as Ir}from"./eb3stsg8iy7t43kd.js";import{a1 as Ki,aE as B,_ as Io,d as Yi,g as Xi,g0 as qi,l as g,m as H,an as jt,r as b,W as Yn,f3 as Ji,d6 as Mo,bd as Zi,cj as Oo,a3 as U,by as Qi,a2 as _o}from"./gie7t2ghpkmat91x.js";import{d as Ke,F as ne,E as G,D as W,H as Ft,f as ut,c as re,V as Xn,I as Do,g as el,h as Lo,J as Zt,W as qn,G as tl,R as Ro,i as Mr,P as Bo,K as Qt,T as Jn,L as Dt,n as nl,M as rl,A as Zn,a as M,N as Me,O as he,Q as In,U as ol,X as Mn,Y as jo,Z as sl,j as il,_ as ll,$ as dt,a0 as en,B as De,C as Z,a1 as tn,a2 as al,a3 as nn,a4 as cl,b as ul,u as fl,e as hl,a5 as dl,y as Ae,a6 as Fo,S as Vo}from"./etj5evuzz6fgtlqe.js";import{m as Q}from"./ebqv5ph7c2sdk5gc.js";import{b_ as pl,b$ as ml,bP as gl,a as yl,c0 as xl}from"./mlhieyi9z3gwttrn.js";import{b as bl}from"./e7e7sp2dnlssszco.js";import{d as vl,P as Go,f as Cl,c as kl,G as Sl,q as wl,D as Or,p as Ho}from"./m73oatg382ylvuvx.js";import{D as _r,$ as Al}from"./h2sd1xa6f1fu46y0.js";import{u as El}from"./o0ai3iexyukmznyz.js";import{i as Tl}from"./garo7dux9f8tjkrm.js";const gd=4e4,Nl="max-length-toast",Pl=To((n,e)=>n.info(e,{duration:1.5,id:Nl}),500,{leading:!0,trailing:!1});function yd(n,e,t){Pl(n,e.formatMessage(Il.exceededMaxLength,{maxLength:t}))}const Il=Ki({exceededMaxLength:{id:"cJ/Ddq",defaultMessage:"This document is longer than a canvas can currently handle. To edit, please reduce the length."}}),Ml=1024;let Ol=0;class le{constructor(e,t){this.from=e,this.to=t}}class O{constructor(e={}){this.id=Ol++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=ee.match(e)),t=>{let r=e(t);return r===void 0?null:[this,r]}}}O.closedBy=new O({deserialize:n=>n.split(" ")});O.openedBy=new O({deserialize:n=>n.split(" ")});O.group=new O({deserialize:n=>n.split(" ")});O.isolate=new O({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});O.contextHash=new O({perNode:!0});O.lookAhead=new O({perNode:!0});O.mounted=new O({perNode:!0});class pt{constructor(e,t,r){this.tree=e,this.overlay=t,this.parser=r}static get(e){return e&&e.props&&e.props[O.mounted.id]}}const _l=Object.create(null);class ee{constructor(e,t,r,o=0){this.name=e,this.props=t,this.id=r,this.flags=o}static define(e){let t=e.props&&e.props.length?Object.create(null):_l,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),o=new ee(e.name||"",t,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(o)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return o}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(O.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let o of r.split(" "))t[o]=e[r];return r=>{for(let o=r.prop(O.group),s=-1;s<(o?o.length:0);s++){let i=t[s<0?r.name:o[s]];if(i)return i}}}}ee.none=new ee("",Object.create(null),0,8);class Qn{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let o=null;for(let s of e){let i=s(r);i&&(o||(o=Object.assign({},r.props)),o[i[0].id]=i[1])}t.push(o?new ee(r.name,o,r.id,r.flags):r)}return new Qn(t)}}const Et=new WeakMap,Dr=new WeakMap;var V;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(V||(V={}));class j{constructor(e,t,r,o,s){if(this.type=e,this.children=t,this.positions=r,this.length=o,this.props=null,s&&s.length){this.props=Object.create(null);for(let[i,l]of s)this.props[typeof i=="number"?i:i.id]=l}}toString(){let e=pt.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let r of this.children){let o=r.toString();o&&(t&&(t+=","),t+=o)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new Vt(this.topNode,e)}cursorAt(e,t=0,r=0){let o=Et.get(this)||this.topNode,s=new Vt(o);return s.moveTo(e,t),Et.set(this,s._tree),s}get topNode(){return new X(this,0,0,null)}resolve(e,t=0){let r=mt(Et.get(this)||this.topNode,e,t,!1);return Et.set(this,r),r}resolveInner(e,t=0){let r=mt(Dr.get(this)||this.topNode,e,t,!0);return Dr.set(this,r),r}resolveStack(e,t=0){return Rl(this,e,t)}iterate(e){let{enter:t,leave:r,from:o=0,to:s=this.length}=e,i=e.mode||0,l=(i&V.IncludeAnonymous)>0;for(let a=this.cursor(i|V.IncludeAnonymous);;){let c=!1;if(a.from<=s&&a.to>=o&&(!l&&a.type.isAnonymous||t(a)!==!1)){if(a.firstChild())continue;c=!0}for(;c&&r&&(l||!a.type.isAnonymous)&&r(a),!a.nextSibling();){if(!a.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:nr(ee.none,this.children,this.positions,0,this.children.length,0,this.length,(t,r,o)=>new j(this.type,t,r,o,this.propValues),e.makeTree||((t,r,o)=>new j(ee.none,t,r,o)))}static build(e){return Bl(e)}}j.empty=new j(ee.none,[],[],0);class er{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new er(this.buffer,this.index)}}class Le{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return ee.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],o=this.set.types[t],s=o.name;if(/\W/.test(s)&&!o.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let i=[];for(;e<r;)i.push(this.childString(e)),e=this.buffer[e+3];return s+"("+i.join(",")+")"}findChild(e,t,r,o,s){let{buffer:i}=this,l=-1;for(let a=e;a!=t&&!(zo(s,o,i[a+1],i[a+2])&&(l=a,r>0));a=i[a+3]);return l}slice(e,t,r){let o=this.buffer,s=new Uint16Array(t-e),i=0;for(let l=e,a=0;l<t;){s[a++]=o[l++],s[a++]=o[l++]-r;let c=s[a++]=o[l++]-r;s[a++]=o[l++]-e,i=Math.max(i,c)}return new Le(s,i,this.set)}}function zo(n,e,t,r){switch(n){case-2:return t<e;case-1:return r>=e&&t<e;case 0:return t<e&&r>e;case 1:return t<=e&&r>e;case 2:return r>e;case 4:return!0}}function mt(n,e,t,r){for(var o;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let i=!r&&n instanceof X&&n.index<0?null:n.parent;if(!i)return n;n=i}let s=r?0:V.IgnoreOverlays;if(r)for(let i=n,l=i.parent;l;i=l,l=i.parent)i instanceof X&&i.index<0&&((o=l.enter(e,t,s))===null||o===void 0?void 0:o.from)!=i.from&&(n=l);for(;;){let i=n.enter(e,t,s);if(!i)return n;n=i}}class Uo{cursor(e=0){return new Vt(this,e)}getChild(e,t=null,r=null){let o=Lr(this,e,t,r);return o.length?o[0]:null}getChildren(e,t=null,r=null){return Lr(this,e,t,r)}resolve(e,t=0){return mt(this,e,t,!1)}resolveInner(e,t=0){return mt(this,e,t,!0)}matchContext(e){return On(this,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let o=t.lastChild;if(!o||o.to!=t.to)break;o.type.isError&&o.from==o.to?(r=t,t=o.prevSibling):t=o}return r}get node(){return this}get next(){return this.parent}}class X extends Uo{constructor(e,t,r,o){super(),this._tree=e,this.from=t,this.index=r,this._parent=o}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,o,s=0){for(let i=this;;){for(let{children:l,positions:a}=i._tree,c=t>0?l.length:-1;e!=c;e+=t){let u=l[e],f=a[e]+i.from;if(zo(o,r,f,f+u.length)){if(u instanceof Le){if(s&V.ExcludeBuffers)continue;let h=u.findChild(0,u.buffer.length,t,r-f,o);if(h>-1)return new ve(new Dl(i,u,e,f),null,h)}else if(s&V.IncludeAnonymous||!u.type.isAnonymous||tr(u)){let h;if(!(s&V.IgnoreMounts)&&(h=pt.get(u))&&!h.overlay)return new X(h.tree,f,e,i);let p=new X(u,f,e,i);return s&V.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(t<0?u.children.length-1:0,t,r,o)}}}if(s&V.IncludeAnonymous||!i.type.isAnonymous||(i.index>=0?e=i.index+t:e=t<0?-1:i._parent._tree.children.length,i=i._parent,!i))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let o;if(!(r&V.IgnoreOverlays)&&(o=pt.get(this._tree))&&o.overlay){let s=e-this.from;for(let{from:i,to:l}of o.overlay)if((t>0?i<=s:i<s)&&(t<0?l>=s:l>s))return new X(o.tree,o.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Lr(n,e,t,r){let o=n.cursor(),s=[];if(!o.firstChild())return s;if(t!=null){for(let i=!1;!i;)if(i=o.type.is(t),!o.nextSibling())return s}for(;;){if(r!=null&&o.type.is(r))return s;if(o.type.is(e)&&s.push(o.node),!o.nextSibling())return r==null?s:[]}}function On(n,e,t=e.length-1){for(let r=n.parent;t>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[t]&&e[t]!=r.name)return!1;t--}}return!0}class Dl{constructor(e,t,r,o){this.parent=e,this.buffer=t,this.index=r,this.start=o}}class ve extends Uo{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:o}=this.context,s=o.findChild(this.index+4,o.buffer[this.index+3],e,t-this.context.start,r);return s<0?null:new ve(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&V.ExcludeBuffers)return null;let{buffer:o}=this.context,s=o.findChild(this.index+4,o.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new ve(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ve(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new ve(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,o=this.index+4,s=r.buffer[this.index+3];if(s>o){let i=r.buffer[this.index+1];e.push(r.slice(o,s,i)),t.push(0)}return new j(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function $o(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let i=n[s];(i.from>t.from||i.to<t.to)&&(t=i,e=s)}let r=t instanceof X&&t.index<0?null:t.parent,o=n.slice();return r?o[e]=r:o.splice(e,1),new Ll(o,t)}class Ll{constructor(e,t){this.heads=e,this.node=t}get next(){return $o(this.heads)}}function Rl(n,e,t){let r=n.resolveInner(e,t),o=null;for(let s=r instanceof X?r:r.context.parent;s;s=s.parent)if(s.index<0){let i=s.parent;(o||(o=[r])).push(i.resolve(e,t)),s=i}else{let i=pt.get(s.tree);if(i&&i.overlay&&i.overlay[0].from<=e&&i.overlay[i.overlay.length-1].to>=e){let l=new X(i.tree,i.overlay[0].from+s.from,-1,s);(o||(o=[r])).push(mt(l,e,t,!1))}}return o?$o(o):r}class Vt{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof X)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:r,buffer:o}=this.buffer;return this.type=t||o.set.types[o.buffer[e]],this.from=r+o.buffer[e+1],this.to=r+o.buffer[e+2],!0}yield(e){return e?e instanceof X?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:o}=this.buffer,s=o.findChild(this.index+4,o.buffer[this.index+3],e,t-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?r&V.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&V.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&V.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let o=r<0?0:this.stack[r]+4;if(this.index!=o)return this.yieldBuf(t.findChild(o,this.index,-1,0,4))}else{let o=t.buffer[this.index+3];if(o<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(o)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:o}=this;if(o){if(e>0){if(this.index<o.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(o.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:r}=o)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let s=t+e,i=e<0?-1:r._tree.children.length;s!=i;s+=e){let l=r._tree.children[s];if(this.mode&V.IncludeAnonymous||l instanceof Le||!l.type.isAnonymous||tr(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let o=this.index,s=this.stack.length;s>=0;){for(let i=e;i;i=i._parent)if(i.index==o){if(o==this.index)return i;t=i,r=s+1;break e}o=this.stack[--s]}for(let o=r;o<this.stack.length;o++)t=new ve(this.buffer,t,this.stack[o]);return this.bufferNode=new ve(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let o=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(o=!0)}for(;o&&t&&t(this),o=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,o=!0}}}matchContext(e){if(!this.buffer)return On(this.node,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let o=e.length-1,s=this.stack.length-1;o>=0;s--){if(s<0)return On(this.node,e,o);let i=r[t.buffer[this.stack[s]]];if(!i.isAnonymous){if(e[o]&&e[o]!=i.name)return!1;o--}}return!0}}function tr(n){return n.children.some(e=>e instanceof Le||!e.type.isAnonymous||tr(e))}function Bl(n){var e;let{buffer:t,nodeSet:r,maxBufferLength:o=Ml,reused:s=[],minRepeatType:i=r.types.length}=n,l=Array.isArray(t)?new er(t,t.length):t,a=r.types,c=0,u=0;function f(k,E,S,P,R,_){let{id:I,start:N,end:D,size:F}=l,K=u;for(;F<0;)if(l.next(),F==-1){let we=s[I];S.push(we),P.push(N-k);return}else if(F==-3){c=I;return}else if(F==-4){u=I;return}else throw new RangeError(`Unrecognized record size: ${F}`);let J=a[I],Ye,Fe,Er=N-k;if(D-N<=o&&(Fe=x(l.pos-E,R))){let we=new Uint16Array(Fe.size-Fe.skip),oe=l.pos-Fe.size,pe=we.length;for(;l.pos>oe;)pe=C(Fe.start,we,pe);Ye=new Le(we,D-Fe.start,r),Er=Fe.start-k}else{let we=l.pos-F;l.next();let oe=[],pe=[],Ve=I>=i?I:-1,Xe=0,At=D;for(;l.pos>we;)Ve>=0&&l.id==Ve&&l.size>=0?(l.end<=At-o&&(m(oe,pe,N,Xe,l.end,At,Ve,K),Xe=oe.length,At=l.end),l.next()):_>2500?h(N,we,oe,pe):f(N,we,oe,pe,Ve,_+1);if(Ve>=0&&Xe>0&&Xe<oe.length&&m(oe,pe,N,Xe,N,At,Ve,K),oe.reverse(),pe.reverse(),Ve>-1&&Xe>0){let Tr=p(J);Ye=nr(J,oe,pe,0,oe.length,0,D-N,Tr,Tr)}else Ye=y(J,oe,pe,D-N,K-D)}S.push(Ye),P.push(Er)}function h(k,E,S,P){let R=[],_=0,I=-1;for(;l.pos>E;){let{id:N,start:D,end:F,size:K}=l;if(K>4)l.next();else{if(I>-1&&D<I)break;I<0&&(I=F-o),R.push(N,D,F),_++,l.next()}}if(_){let N=new Uint16Array(_*4),D=R[R.length-2];for(let F=R.length-3,K=0;F>=0;F-=3)N[K++]=R[F],N[K++]=R[F+1]-D,N[K++]=R[F+2]-D,N[K++]=K;S.push(new Le(N,R[2]-D,r)),P.push(D-k)}}function p(k){return(E,S,P)=>{let R=0,_=E.length-1,I,N;if(_>=0&&(I=E[_])instanceof j){if(!_&&I.type==k&&I.length==P)return I;(N=I.prop(O.lookAhead))&&(R=S[_]+I.length+N)}return y(k,E,S,P,R)}}function m(k,E,S,P,R,_,I,N){let D=[],F=[];for(;k.length>P;)D.push(k.pop()),F.push(E.pop()+S-R);k.push(y(r.types[I],D,F,_-R,N-_)),E.push(R-S)}function y(k,E,S,P,R=0,_){if(c){let I=[O.contextHash,c];_=_?[I].concat(_):[I]}if(R>25){let I=[O.lookAhead,R];_=_?[I].concat(_):[I]}return new j(k,E,S,P,_)}function x(k,E){let S=l.fork(),P=0,R=0,_=0,I=S.end-o,N={size:0,start:0,skip:0};e:for(let D=S.pos-k;S.pos>D;){let F=S.size;if(S.id==E&&F>=0){N.size=P,N.start=R,N.skip=_,_+=4,P+=4,S.next();continue}let K=S.pos-F;if(F<0||K<D||S.start<I)break;let J=S.id>=i?4:0,Ye=S.start;for(S.next();S.pos>K;){if(S.size<0)if(S.size==-3)J+=4;else break e;else S.id>=i&&(J+=4);S.next()}R=Ye,P+=F,_+=J}return(E<0||P==k)&&(N.size=P,N.start=R,N.skip=_),N.size>4?N:void 0}function C(k,E,S){let{id:P,start:R,end:_,size:I}=l;if(l.next(),I>=0&&P<i){let N=S;if(I>4){let D=l.pos-(I-4);for(;l.pos>D;)S=C(k,E,S)}E[--S]=N,E[--S]=_-k,E[--S]=R-k,E[--S]=P}else I==-3?c=P:I==-4&&(u=P);return S}let v=[],T=[];for(;l.pos>0;)f(n.start||0,n.bufferStart||0,v,T,-1,0);let A=(e=n.length)!==null&&e!==void 0?e:v.length?T[0]+v[0].length:0;return new j(a[n.topID],v.reverse(),T.reverse(),A)}const Rr=new WeakMap;function Lt(n,e){if(!n.isAnonymous||e instanceof Le||e.type!=n)return 1;let t=Rr.get(e);if(t==null){t=1;for(let r of e.children){if(r.type!=n||!(r instanceof j)){t=1;break}t+=Lt(n,r)}Rr.set(e,t)}return t}function nr(n,e,t,r,o,s,i,l,a){let c=0;for(let m=r;m<o;m++)c+=Lt(n,e[m]);let u=Math.ceil(c*1.5/8),f=[],h=[];function p(m,y,x,C,v){for(let T=x;T<C;){let A=T,k=y[T],E=Lt(n,m[T]);for(T++;T<C;T++){let S=Lt(n,m[T]);if(E+S>=u)break;E+=S}if(T==A+1){if(E>u){let S=m[A];p(S.children,S.positions,0,S.children.length,y[A]+v);continue}f.push(m[A])}else{let S=y[T-1]+m[T-1].length-k;f.push(nr(n,m,y,A,T,k,S,null,a))}h.push(k+v-s)}}return p(e,t,r,o,0),(l||a)(f,h,i)}class xd{constructor(){this.map=new WeakMap}setBuffer(e,t,r){let o=this.map.get(e);o||this.map.set(e,o=new Map),o.set(t,r)}getBuffer(e,t){let r=this.map.get(e);return r&&r.get(t)}set(e,t){e instanceof ve?this.setBuffer(e.context.buffer,e.index,t):e instanceof X&&this.map.set(e.tree,t)}get(e){return e instanceof ve?this.getBuffer(e.context.buffer,e.index):e instanceof X?this.map.get(e.tree):void 0}cursorSet(e,t){e.buffer?this.setBuffer(e.buffer.buffer,e.index,t):this.map.set(e.tree,t)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class Te{constructor(e,t,r,o,s=!1,i=!1){this.from=e,this.to=t,this.tree=r,this.offset=o,this.open=(s?1:0)|(i?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],r=!1){let o=[new Te(0,e.length,e,0,!1,r)];for(let s of t)s.to>e.length&&o.push(s);return o}static applyChanges(e,t,r=128){if(!t.length)return e;let o=[],s=1,i=e.length?e[0]:null;for(let l=0,a=0,c=0;;l++){let u=l<t.length?t[l]:null,f=u?u.fromA:1e9;if(f-a>=r)for(;i&&i.from<f;){let h=i;if(a>=h.from||f<=h.to||c){let p=Math.max(h.from,a)-c,m=Math.min(h.to,f)-c;h=p>=m?null:new Te(p,m,h.tree,h.offset+c,l>0,!!u)}if(h&&o.push(h),i.to>f)break;i=s<e.length?e[s++]:null}if(!u)break;a=u.toA,c=u.toA-u.toB}return o}}class Wo{startParse(e,t,r){return typeof e=="string"&&(e=new jl(e)),r=r?r.length?r.map(o=>new le(o.from,o.to)):[new le(0,0)]:[new le(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let o=this.startParse(e,t,r);for(;;){let s=o.advance();if(s)return s}}}class jl{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}function bd(n){return(e,t,r,o)=>new Vl(e,n,t,r,o)}class Br{constructor(e,t,r,o,s){this.parser=e,this.parse=t,this.overlay=r,this.target=o,this.from=s}}function jr(n){if(!n.length||n.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(n))}class Fl{constructor(e,t,r,o,s,i,l){this.parser=e,this.predicate=t,this.mounts=r,this.index=o,this.start=s,this.target=i,this.prev=l,this.depth=0,this.ranges=[]}}const _n=new O({perNode:!0});class Vl{constructor(e,t,r,o,s){this.nest=t,this.input=r,this.fragments=o,this.ranges=s,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let r=this.baseParse.advance();if(!r)return null;if(this.baseParse=null,this.baseTree=r,this.startInner(),this.stoppedAt!=null)for(let o of this.inner)o.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let r=this.baseTree;return this.stoppedAt!=null&&(r=new j(r.type,r.children,r.positions,r.length,r.propValues.concat([[_n,this.stoppedAt]]))),r}let e=this.inner[this.innerDone],t=e.parse.advance();if(t){this.innerDone++;let r=Object.assign(Object.create(null),e.target.props);r[O.mounted.id]=new pt(t,e.overlay,e.parser),e.target.props=r}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].from<e&&(e=Math.min(e,this.inner[t].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let t=this.innerDone;t<this.inner.length;t++)this.inner[t].parse.stopAt(e)}startInner(){let e=new zl(this.fragments),t=null,r=null,o=new Vt(new X(this.baseTree,this.ranges[0].from,0,null),V.IncludeAnonymous|V.IgnoreMounts);e:for(let s,i;;){let l=!0,a;if(this.stoppedAt!=null&&o.from>=this.stoppedAt)l=!1;else if(e.hasNode(o)){if(t){let c=t.mounts.find(u=>u.frag.from<=o.from&&u.frag.to>=o.to&&u.mount.overlay);if(c)for(let u of c.mount.overlay){let f=u.from+c.pos,h=u.to+c.pos;f>=o.from&&h<=o.to&&!t.ranges.some(p=>p.from<h&&p.to>f)&&t.ranges.push({from:f,to:h})}}l=!1}else if(r&&(i=Gl(r.ranges,o.from,o.to)))l=i!=2;else if(!o.type.isAnonymous&&(s=this.nest(o,this.input))&&(o.from<o.to||!s.overlay)){o.tree||Hl(o);let c=e.findMounts(o.from,s.parser);if(typeof s.overlay=="function")t=new Fl(s.parser,s.overlay,c,this.inner.length,o.from,o.tree,t);else{let u=Gr(this.ranges,s.overlay||(o.from<o.to?[new le(o.from,o.to)]:[]));u.length&&jr(u),(u.length||!s.overlay)&&this.inner.push(new Br(s.parser,u.length?s.parser.startParse(this.input,Hr(c,u),u):s.parser.startParse(""),s.overlay?s.overlay.map(f=>new le(f.from-o.from,f.to-o.from)):null,o.tree,u.length?u[0].from:o.from)),s.overlay?u.length&&(r={ranges:u,depth:0,prev:r}):l=!1}}else t&&(a=t.predicate(o))&&(a===!0&&(a=new le(o.from,o.to)),a.from<a.to&&t.ranges.push(a));if(l&&o.firstChild())t&&t.depth++,r&&r.depth++;else for(;!o.nextSibling();){if(!o.parent())break e;if(t&&!--t.depth){let c=Gr(this.ranges,t.ranges);c.length&&(jr(c),this.inner.splice(t.index,0,new Br(t.parser,t.parser.startParse(this.input,Hr(t.mounts,c),c),t.ranges.map(u=>new le(u.from-t.start,u.to-t.start)),t.target,c[0].from))),t=t.prev}r&&!--r.depth&&(r=r.prev)}}}}function Gl(n,e,t){for(let r of n){if(r.from>=t)break;if(r.to>e)return r.from<=e&&r.to>=t?2:1}return 0}function Fr(n,e,t,r,o,s){if(e<t){let i=n.buffer[e+1];r.push(n.slice(e,t,i)),o.push(i-s)}}function Hl(n){let{node:e}=n,t=[],r=e.context.buffer;do t.push(n.index),n.parent();while(!n.tree);let o=n.tree,s=o.children.indexOf(r),i=o.children[s],l=i.buffer,a=[s];function c(u,f,h,p,m,y){let x=t[y],C=[],v=[];Fr(i,u,x,C,v,p);let T=l[x+1],A=l[x+2];a.push(C.length);let k=y?c(x+4,l[x+3],i.set.types[l[x]],T,A-T,y-1):e.toTree();return C.push(k),v.push(T-p),Fr(i,l[x+3],f,C,v,p),new j(h,C,v,m)}o.children[s]=c(0,l.length,ee.none,0,i.length,t.length-1);for(let u of a){let f=n.tree.children[u],h=n.tree.positions[u];n.yield(new X(f,h+n.from,u,n._tree))}}class Vr{constructor(e,t){this.offset=t,this.done=!1,this.cursor=e.cursor(V.IncludeAnonymous|V.IgnoreMounts)}moveTo(e){let{cursor:t}=this,r=e-this.offset;for(;!this.done&&t.from<r;)t.to>=e&&t.enter(r,1,V.IgnoreOverlays|V.ExcludeBuffers)||t.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let t=this.cursor.tree;;){if(t==e.tree)return!0;if(t.children.length&&t.positions[0]==0&&t.children[0]instanceof j)t=t.children[0];else break}return!1}}class zl{constructor(e){var t;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let r=this.curFrag=e[0];this.curTo=(t=r.tree.prop(_n))!==null&&t!==void 0?t:r.to,this.inner=new Vr(r.tree,-r.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let t=this.curFrag=this.fragments[this.fragI];this.curTo=(e=t.tree.prop(_n))!==null&&e!==void 0?e:t.to,this.inner=new Vr(t.tree,-t.offset)}}findMounts(e,t){var r;let o=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let s=this.inner.cursor.node;s;s=s.parent){let i=(r=s.tree)===null||r===void 0?void 0:r.prop(O.mounted);if(i&&i.parser==t)for(let l=this.fragI;l<this.fragments.length;l++){let a=this.fragments[l];if(a.from>=s.to)break;a.tree==this.curFrag.tree&&o.push({frag:a,pos:s.from-a.offset,mount:i})}}}return o}}function Gr(n,e){let t=null,r=e;for(let o=1,s=0;o<n.length;o++){let i=n[o-1].to,l=n[o].from;for(;s<r.length;s++){let a=r[s];if(a.from>=l)break;a.to<=i||(t||(r=t=e.slice()),a.from<i?(t[s]=new le(a.from,i),a.to>l&&t.splice(s+1,0,new le(l,a.to))):a.to>l?t[s--]=new le(l,a.to):t.splice(s--,1))}}return r}function Ul(n,e,t,r){let o=0,s=0,i=!1,l=!1,a=-1e9,c=[];for(;;){let u=o==n.length?1e9:i?n[o].to:n[o].from,f=s==e.length?1e9:l?e[s].to:e[s].from;if(i!=l){let h=Math.max(a,t),p=Math.min(u,f,r);h<p&&c.push(new le(h,p))}if(a=Math.min(u,f),a==1e9)break;u==a&&(i?(i=!1,o++):i=!0),f==a&&(l?(l=!1,s++):l=!0)}return c}function Hr(n,e){let t=[];for(let{pos:r,mount:o,frag:s}of n){let i=r+(o.overlay?o.overlay[0].from:0),l=i+o.tree.length,a=Math.max(s.from,i),c=Math.min(s.to,l);if(o.overlay){let u=o.overlay.map(h=>new le(h.from+r,h.to+r)),f=Ul(e,u,a,c);for(let h=0,p=a;;h++){let m=h==f.length,y=m?c:f[h].from;if(y>p&&t.push(new Te(p,y,o.tree,-i,s.from>=p||s.openStart,s.to<=y||s.openEnd)),m)break;p=f[h].to}}else t.push(new Te(a,c,o.tree,-i,s.from>=i||s.openStart,s.to<=l||s.openEnd))}return t}let $l=0;class xe{constructor(e,t,r){this.set=e,this.base=t,this.modified=r,this.id=$l++}static define(e){if(e?.base)throw new Error("Can not derive from a modified tag");let t=new xe([],null,[]);if(t.set.push(t),e)for(let r of e.set)t.set.push(r);return t}static defineModifier(){let e=new Gt;return t=>t.modified.indexOf(e)>-1?t:Gt.get(t.base||t,t.modified.concat(e).sort((r,o)=>r.id-o.id))}}let Wl=0;class Gt{constructor(){this.instances=[],this.id=Wl++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(l=>l.base==e&&Kl(t,l.modified));if(r)return r;let o=[],s=new xe(o,e,t);for(let l of t)l.instances.push(s);let i=Yl(t);for(let l of e.set)if(!l.modified.length)for(let a of i)o.push(Gt.get(l,a));return s}}function Kl(n,e){return n.length==e.length&&n.every((t,r)=>t==e[r])}function Yl(n){let e=[[]];for(let t=0;t<n.length;t++)for(let r=0,o=e.length;r<o;r++)e.push(e[r].concat(n[t]));return e.sort((t,r)=>r.length-t.length)}function Xl(n){let e=Object.create(null);for(let t in n){let r=n[t];Array.isArray(r)||(r=[r]);for(let o of t.split(" "))if(o){let s=[],i=2,l=o;for(let f=0;;){if(l=="..."&&f>0&&f+3==o.length){i=1;break}let h=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!h)throw new RangeError("Invalid path: "+o);if(s.push(h[0]=="*"?"":h[0][0]=='"'?JSON.parse(h[0]):h[0]),f+=h[0].length,f==o.length)break;let p=o[f++];if(f==o.length&&p=="!"){i=0;break}if(p!="/")throw new RangeError("Invalid path: "+o);l=o.slice(f)}let a=s.length-1,c=s[a];if(!c)throw new RangeError("Invalid path: "+o);let u=new Ht(r,i,a>0?s.slice(0,a):null);e[c]=u.sort(e[c])}}return Ko.add(e)}const Ko=new O;class Ht{constructor(e,t,r,o){this.tags=e,this.mode=t,this.context=r,this.next=o}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Ht.empty=new Ht([],2,null);function Yo(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let i of s.tag)t[i.id]=s.class;let{scope:r,all:o=null}=e||{};return{style:s=>{let i=o;for(let l of s)for(let a of l.set){let c=t[a.id];if(c){i=i?i+" "+c:c;break}}return i},scope:r}}function ql(n,e){let t=null;for(let r of n){let o=r.style(e);o&&(t=t?t+" "+o:o)}return t}function Jl(n,e,t,r=0,o=n.length){let s=new Zl(r,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),r,o,"",s.highlighters),s.flush(o)}class Zl{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,o,s){let{type:i,from:l,to:a}=e;if(l>=r||a<=t)return;i.isTop&&(s=this.highlighters.filter(p=>!p.scope||p.scope(i)));let c=o,u=Ql(e)||Ht.empty,f=ql(s,u.tags);if(f&&(c&&(c+=" "),c+=f,u.mode==1&&(o+=(o?" ":"")+f)),this.startSpan(Math.max(t,l),c),u.opaque)return;let h=e.tree&&e.tree.prop(O.mounted);if(h&&h.overlay){let p=e.node.enter(h.overlay[0].from+l,1),m=this.highlighters.filter(x=>!x.scope||x.scope(h.tree.type)),y=e.firstChild();for(let x=0,C=l;;x++){let v=x<h.overlay.length?h.overlay[x]:null,T=v?v.from+l:a,A=Math.max(t,C),k=Math.min(r,T);if(A<k&&y)for(;e.from<k&&(this.highlightRange(e,A,k,o,s),this.startSpan(Math.min(k,e.to),c),!(e.to>=T||!e.nextSibling())););if(!v||T>r)break;C=v.to+l,C>t&&(this.highlightRange(p.cursor(),Math.max(t,v.from+l),Math.min(r,C),"",m),this.startSpan(Math.min(r,C),c))}y&&e.parent()}else if(e.firstChild()){h&&(o="");do if(!(e.to<=t)){if(e.from>=r)break;this.highlightRange(e,t,r,o,s),this.startSpan(Math.min(r,e.to),c)}while(e.nextSibling());e.parent()}}}function Ql(n){let e=n.type.prop(Ko);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const w=xe.define,Tt=w(),Pe=w(),zr=w(Pe),Ur=w(Pe),Ie=w(),Nt=w(Ie),yn=w(Ie),ye=w(),Ge=w(ye),me=w(),ge=w(),Dn=w(),lt=w(Dn),Pt=w(),d={comment:Tt,lineComment:w(Tt),blockComment:w(Tt),docComment:w(Tt),name:Pe,variableName:w(Pe),typeName:zr,tagName:w(zr),propertyName:Ur,attributeName:w(Ur),className:w(Pe),labelName:w(Pe),namespace:w(Pe),macroName:w(Pe),literal:Ie,string:Nt,docString:w(Nt),character:w(Nt),attributeValue:w(Nt),number:yn,integer:w(yn),float:w(yn),bool:w(Ie),regexp:w(Ie),escape:w(Ie),color:w(Ie),url:w(Ie),keyword:me,self:w(me),null:w(me),atom:w(me),unit:w(me),modifier:w(me),operatorKeyword:w(me),controlKeyword:w(me),definitionKeyword:w(me),moduleKeyword:w(me),operator:ge,derefOperator:w(ge),arithmeticOperator:w(ge),logicOperator:w(ge),bitwiseOperator:w(ge),compareOperator:w(ge),updateOperator:w(ge),definitionOperator:w(ge),typeOperator:w(ge),controlOperator:w(ge),punctuation:Dn,separator:w(Dn),bracket:lt,angleBracket:w(lt),squareBracket:w(lt),paren:w(lt),brace:w(lt),content:ye,heading:Ge,heading1:w(Ge),heading2:w(Ge),heading3:w(Ge),heading4:w(Ge),heading5:w(Ge),heading6:w(Ge),contentSeparator:w(ye),list:w(ye),quote:w(ye),emphasis:w(ye),strong:w(ye),link:w(ye),monospace:w(ye),strikethrough:w(ye),inserted:w(),deleted:w(),changed:w(),invalid:w(),meta:Pt,documentMeta:w(Pt),annotation:w(Pt),processingInstruction:w(Pt),definition:xe.defineModifier(),constant:xe.defineModifier(),function:xe.defineModifier(),standard:xe.defineModifier(),local:xe.defineModifier(),special:xe.defineModifier()};Yo([{tag:d.link,class:"tok-link"},{tag:d.heading,class:"tok-heading"},{tag:d.emphasis,class:"tok-emphasis"},{tag:d.strong,class:"tok-strong"},{tag:d.keyword,class:"tok-keyword"},{tag:d.atom,class:"tok-atom"},{tag:d.bool,class:"tok-bool"},{tag:d.url,class:"tok-url"},{tag:d.labelName,class:"tok-labelName"},{tag:d.inserted,class:"tok-inserted"},{tag:d.deleted,class:"tok-deleted"},{tag:d.literal,class:"tok-literal"},{tag:d.string,class:"tok-string"},{tag:d.number,class:"tok-number"},{tag:[d.regexp,d.escape,d.special(d.string)],class:"tok-string2"},{tag:d.variableName,class:"tok-variableName"},{tag:d.local(d.variableName),class:"tok-variableName tok-local"},{tag:d.definition(d.variableName),class:"tok-variableName tok-definition"},{tag:d.special(d.variableName),class:"tok-variableName2"},{tag:d.definition(d.propertyName),class:"tok-propertyName tok-definition"},{tag:d.typeName,class:"tok-typeName"},{tag:d.namespace,class:"tok-namespace"},{tag:d.className,class:"tok-className"},{tag:d.macroName,class:"tok-macroName"},{tag:d.propertyName,class:"tok-propertyName"},{tag:d.operator,class:"tok-operator"},{tag:d.comment,class:"tok-comment"},{tag:d.meta,class:"tok-meta"},{tag:d.invalid,class:"tok-invalid"},{tag:d.punctuation,class:"tok-punctuation"}]);var xn;const He=new O;function Xo(n){return ne.define({combine:n?e=>e.concat(n):void 0})}const ea=new O;class ae{constructor(e,t,r=[],o=""){this.data=e,this.name=o,ut.prototype.hasOwnProperty("tree")||Object.defineProperty(ut.prototype,"tree",{get(){return z(this)}}),this.parser=t,this.extension=[Re.of(this),ut.languageData.of((s,i,l)=>{let a=$r(s,i,l),c=a.type.prop(He);if(!c)return[];let u=s.facet(c),f=a.type.prop(ea);if(f){let h=a.resolve(i-a.from,l);for(let p of f)if(p.test(h,s)){let m=s.facet(p.facet);return p.type=="replace"?m:m.concat(u)}}return u})].concat(r)}isActiveAt(e,t,r=-1){return $r(e,t,r).type.prop(He)==this.data}findRegions(e){let t=e.facet(Re);if(t?.data==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],o=(s,i)=>{if(s.prop(He)==this.data){r.push({from:i,to:i+s.length});return}let l=s.prop(O.mounted);if(l){if(l.tree.prop(He)==this.data){if(l.overlay)for(let a of l.overlay)r.push({from:a.from+i,to:a.to+i});else r.push({from:i,to:i+s.length});return}else if(l.overlay){let a=r.length;if(o(l.tree,l.overlay[0].from+i),r.length>a)return}}for(let a=0;a<s.children.length;a++){let c=s.children[a];c instanceof j&&o(c,s.positions[a]+i)}};return o(z(e),0),r}get allowsNesting(){return!0}}ae.setState=re.define();function $r(n,e,t){let r=n.facet(Re),o=z(n).topNode;if(!r||r.allowsNesting)for(let s=o;s;s=s.enter(e,t,V.ExcludeBuffers))s.type.isTop&&(o=s);return o}class Ln extends ae{constructor(e,t,r){super(e,t,[],r),this.parser=t}static define(e){let t=Xo(e.languageData);return new Ln(t,e.parser.configure({props:[He.add(r=>r.isTop?t:void 0)]}),e.name)}configure(e,t){return new Ln(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function z(n){let e=n.field(ae.state,!1);return e?e.tree:j.empty}class ta{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let at=null;class et{constructor(e,t,r=[],o,s,i,l,a){this.parser=e,this.state=t,this.fragments=r,this.tree=o,this.treeLen=s,this.viewport=i,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new et(e,t,[],j.empty,0,r,[],null)}startParse(){return this.parser.startParse(new ta(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=j.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let o=Date.now()+e;e=()=>Date.now()>o}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let o=this.parse.advance();if(o)if(this.fragments=this.withoutTempSkipped(Te.addTree(o,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=o,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Te.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=at;at=this;try{return e()}finally{at=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=Wr(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:o,treeLen:s,viewport:i,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((c,u,f,h)=>a.push({fromA:c,toA:u,fromB:f,toB:h})),r=Te.applyChanges(r,a),o=j.empty,s=0,i={from:e.mapPos(i.from,-1),to:e.mapPos(i.to,1)},this.skipped.length){l=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),f=e.mapPos(c.to,-1);u<f&&l.push({from:u,to:f})}}}return new et(this.parser,t,r,o,s,i,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:o,to:s}=this.skipped[r];o<e.to&&s>e.from&&(this.fragments=Wr(this.fragments,o,s),this.skipped.splice(r--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends Wo{createParse(t,r,o){let s=o[0].from,i=o[o.length-1].to;return{parsedPos:s,advance(){let a=at;if(a){for(let c of o)a.tempSkipped.push(c);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=i,new j(ee.none,[],[],i-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return at}}function Wr(n,e,t){return Te.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class tt{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new tt(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=et.create(e.facet(Re).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new tt(r)}}ae.state=Ke.define({create:tt.init,update(n,e){for(let t of e.effects)if(t.is(ae.setState))return t.value;return e.startState.facet(Re)!=e.state.facet(Re)?tt.init(e.state):n.apply(e)}});let qo=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(qo=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const bn=typeof navigator<"u"&&(!((xn=navigator.scheduling)===null||xn===void 0)&&xn.isInputPending)?()=>navigator.scheduling.isInputPending():null,na=Xn.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(ae.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(ae.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=qo(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:o}}=this.view,s=r.field(ae.state);if(s.tree==s.context.tree&&s.context.isDone(o+1e5))return;let i=Date.now()+Math.min(this.chunkBudget,100,e&&!bn?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<o&&r.doc.length>o+1e3,a=s.context.work(()=>bn&&bn()||Date.now()>i,o+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:ae.setState.of(new tt(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>Do(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Re=ne.define({combine(n){return n.length?n[0]:null},enables:n=>[ae.state,na,G.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class ra{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const Jo=ne.define(),rn=ne.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function Ue(n){let e=n.facet(rn);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function gt(n,e){let t="",r=n.tabSize,o=n.facet(rn)[0];if(o=="	"){for(;e>=r;)t+="	",e-=r;o=" "}for(let s=0;s<e;s++)t+=o;return t}function rr(n,e){n instanceof ut&&(n=new on(n));for(let r of n.state.facet(Jo)){let o=r(n,e);if(o!==void 0)return o}let t=z(n.state);return t.length>=e?sa(n,t,e):null}class on{constructor(e,t={}){this.state=e,this.options=t,this.unit=Ue(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:o,simulateDoubleBreak:s}=this.options;return o!=null&&o>=r.from&&o<=r.to?s&&o==e?{text:"",from:e}:(t<0?o<e:o<=e)?{text:r.text.slice(o-r.from),from:o}:{text:r.text.slice(0,o-r.from),from:r.from}:r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:o}=this.lineAt(e,t);return r.slice(e-o,Math.min(r.length,e+100-o))}column(e,t=1){let{text:r,from:o}=this.lineAt(e,t),s=this.countColumn(r,e-o),i=this.options.overrideIndentation?this.options.overrideIndentation(o):-1;return i>-1&&(s+=i-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,t=e.length){return Qt(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:o}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let i=s(o);if(i>-1)return i}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const oa=new O;function sa(n,e,t){let r=e.resolveStack(t),o=r.node.enterUnfinishedNodesBefore(t);if(o!=r.node){let s=[];for(let i=o;i!=r.node;i=i.parent)s.push(i);for(let i=s.length-1;i>=0;i--)r={node:s[i],next:r}}return Zo(r,n,t)}function Zo(n,e,t){for(let r=n;r;r=r.next){let o=la(r.node);if(o)return o(or.create(e,t,r))}return 0}function ia(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function la(n){let e=n.type.prop(oa);if(e)return e;let t=n.firstChild,r;if(t&&(r=t.type.prop(O.closedBy))){let o=n.lastChild,s=o&&r.indexOf(o.name)>-1;return i=>Qo(i,!0,1,void 0,s&&!ia(i)?o.from:void 0)}return n.parent==null?aa:null}function aa(){return 0}class or extends on{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new or(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(ca(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return Zo(this.context.next,this.base,this.pos)}}function ca(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function ua(n){let e=n.node,t=e.childAfter(e.from),r=e.lastChild;if(!t)return null;let o=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),i=o==null||o<=s.from?s.to:Math.min(s.to,o);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==r)return null;if(!a.type.isSkipped)return a.from<i?t:null;l=a.to}}function Cd({closing:n,align:e=!0,units:t=1}){return r=>Qo(r,e,t,n)}function Qo(n,e,t,r,o){let s=n.textAfter,i=s.match(/^\s*/)[0].length,l=r&&s.slice(i,i+r.length)==r||o==n.pos+i,a=e?ua(n):null;return a?l?n.column(a.from):n.column(a.to):n.baseIndent+(l?0:n.unit*t)}const kd=n=>n.baseIndent;function Sd({except:n,units:e=1}={}){return t=>{let r=n&&n.test(t.textAfter);return t.baseIndent+(r?0:e*t.unit)}}const fa=200;function wd(){return ut.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:r}=n.newSelection.main,o=t.lineAt(r);if(r>o.from+fa)return n;let s=t.sliceString(o.from,r);if(!e.some(c=>c.test(s)))return n;let{state:i}=n,l=-1,a=[];for(let{head:c}of i.selection.ranges){let u=i.doc.lineAt(c);if(u.from==l)continue;l=u.from;let f=rr(i,u.from);if(f==null)continue;let h=/^\s*/.exec(u.text)[0],p=gt(i,f);h!=p&&a.push({from:u.from,to:u.from+h.length,insert:p})}return a.length?[n,{changes:a,sequential:!0}]:n})}const ha=ne.define(),da=new O;function Ad(n){let e=n.firstChild,t=n.lastChild;return e&&e.to<t.from?{from:e.to,to:t.type.isError?n.to:t.from}:null}function pa(n,e,t){let r=z(n);if(r.length<t)return null;let o=r.resolveStack(t,1),s=null;for(let i=o;i;i=i.next){let l=i.node;if(l.to<=t||l.from>t)continue;if(s&&l.from<e)break;let a=l.type.prop(da);if(a&&(l.to<r.length-50||r.length==n.doc.length||!ma(l))){let c=a(l,n);c&&c.from<=t&&c.from>=e&&c.to>t&&(s=c)}}return s}function ma(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function zt(n,e,t){for(let r of n.facet(ha)){let o=r(n,e,t);if(o)return o}return pa(n,e,t)}function es(n,e){let t=e.mapPos(n.from,1),r=e.mapPos(n.to,-1);return t>=r?void 0:{from:t,to:r}}const sn=re.define({map:es}),vt=re.define({map:es});function ts(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(r=>r.from<=t&&r.to>=t)||e.push(n.lineBlockAt(t));return e}const $e=Ke.define({create(){return W.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(sn)&&!ga(n,t.value.from,t.value.to)){let{preparePlaceholder:r}=e.state.facet(os),o=r?W.replace({widget:new ka(r(e.state,t.value))}):Kr;n=n.update({add:[o.range(t.value.from,t.value.to)]})}else t.is(vt)&&(n=n.update({filter:(r,o)=>t.value.from!=r||t.value.to!=o,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:r}=e.selection.main;n.between(r,r,(o,s)=>{o<r&&s>r&&(t=!0)}),t&&(n=n.update({filterFrom:r,filterTo:r,filter:(o,s)=>s<=r||o>=r}))}return n},provide:n=>G.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(r,o)=>{t.push(r,o)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let r=n[t++],o=n[t++];if(typeof r!="number"||typeof o!="number")throw new RangeError("Invalid JSON for fold state");e.push(Kr.range(r,o))}return W.set(e,!0)}});function Ut(n,e,t){var r;let o=null;return(r=n.field($e,!1))===null||r===void 0||r.between(e,t,(s,i)=>{(!o||o.from>s)&&(o={from:s,to:i})}),o}function ga(n,e,t){let r=!1;return n.between(e,e,(o,s)=>{o==e&&s==t&&(r=!0)}),r}function ns(n,e){return n.field($e,!1)?e:e.concat(re.appendConfig.of(ss()))}const ya=n=>{for(let e of ts(n)){let t=zt(n.state,e.from,e.to);if(t)return n.dispatch({effects:ns(n.state,[sn.of(t),rs(n,t)])}),!0}return!1},xa=n=>{if(!n.state.field($e,!1))return!1;let e=[];for(let t of ts(n)){let r=Ut(n.state,t.from,t.to);r&&e.push(vt.of(r),rs(n,r,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function rs(n,e,t=!0){let r=n.state.doc.lineAt(e.from).number,o=n.state.doc.lineAt(e.to).number;return G.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${r} ${n.state.phrase("to")} ${o}.`)}const ba=n=>{let{state:e}=n,t=[];for(let r=0;r<e.doc.length;){let o=n.lineBlockAt(r),s=zt(e,o.from,o.to);s&&t.push(sn.of(s)),r=(s?n.lineBlockAt(s.to):o).to+1}return t.length&&n.dispatch({effects:ns(n.state,t)}),!!t.length},va=n=>{let e=n.state.field($e,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(r,o)=>{t.push(vt.of({from:r,to:o}))}),n.dispatch({effects:t}),!0},Ed=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:ya},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:xa},{key:"Ctrl-Alt-[",run:ba},{key:"Ctrl-Alt-]",run:va}],Ca={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},os=ne.define({combine(n){return Zt(n,Ca)}});function ss(n){return[$e,wa]}function is(n,e){let{state:t}=n,r=t.facet(os),o=i=>{let l=n.lineBlockAt(n.posAtDOM(i.target)),a=Ut(n.state,l.from,l.to);a&&n.dispatch({effects:vt.of(a)}),i.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(n,o,e);let s=document.createElement("span");return s.textContent=r.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=o,s}const Kr=W.replace({widget:new class extends qn{toDOM(n){return is(n,null)}}});class ka extends qn{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return is(e,this.value)}}const Sa={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class vn extends tl{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function Td(n={}){let e=Object.assign(Object.assign({},Sa),n),t=new vn(e,!0),r=new vn(e,!1),o=Xn.fromClass(class{constructor(i){this.from=i.viewport.from,this.markers=this.buildMarkers(i)}update(i){(i.docChanged||i.viewportChanged||i.startState.facet(Re)!=i.state.facet(Re)||i.startState.field($e,!1)!=i.state.field($e,!1)||z(i.startState)!=z(i.state)||e.foldingChanged(i))&&(this.markers=this.buildMarkers(i.view))}buildMarkers(i){let l=new Ro;for(let a of i.viewportLineBlocks){let c=Ut(i.state,a.from,a.to)?r:zt(i.state,a.from,a.to)?t:null;c&&l.add(a.from,a.from,c)}return l.finish()}}),{domEventHandlers:s}=e;return[o,el({class:"cm-foldGutter",markers(i){var l;return((l=i.plugin(o))===null||l===void 0?void 0:l.markers)||Lo.empty},initialSpacer(){return new vn(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(i,l,a)=>{if(s.click&&s.click(i,l,a))return!0;let c=Ut(i.state,l.from,l.to);if(c)return i.dispatch({effects:vt.of(c)}),!0;let u=zt(i.state,l.from,l.to);return u?(i.dispatch({effects:sn.of(u)}),!0):!1}})}),ss()]}const wa=G.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Ct{constructor(e,t){this.specs=e;let r;function o(l){let a=Mr.newName();return(r||(r=Object.create(null)))["."+a]=l,a}const s=typeof t.all=="string"?t.all:t.all?o(t.all):void 0,i=t.scope;this.scope=i instanceof ae?l=>l.prop(He)==i.data:i?l=>l==i:void 0,this.style=Yo(e.map(l=>({tag:l.tag,class:l.class||o(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=r?new Mr(r):null,this.themeType=t.themeType}static define(e,t){return new Ct(e,t||{})}}const Rn=ne.define(),ls=ne.define({combine(n){return n.length?[n[0]]:null}});function Rt(n){let e=n.facet(Rn);return e.length?e:n.facet(ls)}function Aa(n,e){let t=[Ta],r;return n instanceof Ct&&(n.module&&t.push(G.styleModule.of(n.module)),r=n.themeType),e?.fallback?t.push(ls.of(n)):r?t.push(Rn.computeN([G.darkTheme],o=>o.facet(G.darkTheme)==(r=="dark")?[n]:[])):t.push(Rn.of(n)),t}function Nd(n,e,t){let r=Rt(n),o=null;if(r){for(let s of r)if(!s.scope||t){let i=s.style(e);i&&(o=o?o+" "+i:i)}}return o}class Ea{constructor(e){this.markCache=Object.create(null),this.tree=z(e.state),this.decorations=this.buildDeco(e,Rt(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=z(e.state),r=Rt(e.state),o=r!=Rt(e.startState),{viewport:s}=e.view,i=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!o&&t.type==this.tree.type&&i>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=i):(t!=this.tree||e.viewportChanged||o)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return W.none;let r=new Ro;for(let{from:o,to:s}of e.visibleRanges)Jl(this.tree,t,(i,l,a)=>{r.add(i,l,this.markCache[a]||(this.markCache[a]=W.mark({class:a})))},o,s);return r.finish()}}const Ta=Bo.high(Xn.fromClass(Ea,{decorations:n=>n.decorations})),Pd=Ct.define([{tag:d.meta,color:"#404740"},{tag:d.link,textDecoration:"underline"},{tag:d.heading,textDecoration:"underline",fontWeight:"bold"},{tag:d.emphasis,fontStyle:"italic"},{tag:d.strong,fontWeight:"bold"},{tag:d.strikethrough,textDecoration:"line-through"},{tag:d.keyword,color:"#708"},{tag:[d.atom,d.bool,d.url,d.contentSeparator,d.labelName],color:"#219"},{tag:[d.literal,d.inserted],color:"#164"},{tag:[d.string,d.deleted],color:"#a11"},{tag:[d.regexp,d.escape,d.special(d.string)],color:"#e40"},{tag:d.definition(d.variableName),color:"#00f"},{tag:d.local(d.variableName),color:"#30a"},{tag:[d.typeName,d.namespace],color:"#085"},{tag:d.className,color:"#167"},{tag:[d.special(d.variableName),d.macroName],color:"#256"},{tag:d.definition(d.propertyName),color:"#00c"},{tag:d.comment,color:"#940"},{tag:d.invalid,color:"#f00"}]),Na=G.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),as=1e4,cs="()[]{}",us=ne.define({combine(n){return Zt(n,{afterCursor:!0,brackets:cs,maxScanDistance:as,renderMatch:Ma})}}),Pa=W.mark({class:"cm-matchingBracket"}),Ia=W.mark({class:"cm-nonmatchingBracket"});function Ma(n){let e=[],t=n.matched?Pa:Ia;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const Oa=Ke.define({create(){return W.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],r=e.state.facet(us);for(let o of e.state.selection.ranges){if(!o.empty)continue;let s=Ce(e.state,o.head,-1,r)||o.head>0&&Ce(e.state,o.head-1,1,r)||r.afterCursor&&(Ce(e.state,o.head,1,r)||o.head<e.state.doc.length&&Ce(e.state,o.head+1,-1,r));s&&(t=t.concat(r.renderMatch(s,e.state)))}return W.set(t,!0)},provide:n=>G.decorations.from(n)}),_a=[Oa,Na];function Id(n={}){return[us.of(n),_a]}const Da=new O;function Bn(n,e,t){let r=n.prop(e<0?O.openedBy:O.closedBy);if(r)return r;if(n.name.length==1){let o=t.indexOf(n.name);if(o>-1&&o%2==(e<0?1:0))return[t[o+e]]}return null}function jn(n){let e=n.type.prop(Da);return e?e(n.node):n}function Ce(n,e,t,r={}){let o=r.maxScanDistance||as,s=r.brackets||cs,i=z(n),l=i.resolveInner(e,t);for(let a=l;a;a=a.parent){let c=Bn(a.type,t,s);if(c&&a.from<a.to){let u=jn(a);if(u&&(t>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return La(n,e,t,a,u,c,s)}}return Ra(n,e,t,i,l.type,o,s)}function La(n,e,t,r,o,s,i){let l=r.parent,a={from:o.from,to:o.to},c=0,u=l?.cursor();if(u&&(t<0?u.childBefore(r.from):u.childAfter(r.to)))do if(t<0?u.to<=r.from:u.from>=r.to){if(c==0&&s.indexOf(u.type.name)>-1&&u.from<u.to){let f=jn(u);return{start:a,end:f?{from:f.from,to:f.to}:void 0,matched:!0}}else if(Bn(u.type,t,i))c++;else if(Bn(u.type,-t,i)){if(c==0){let f=jn(u);return{start:a,end:f&&f.from<f.to?{from:f.from,to:f.to}:void 0,matched:!1}}c--}}while(t<0?u.prevSibling():u.nextSibling());return{start:a,matched:!1}}function Ra(n,e,t,r,o,s,i){let l=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),a=i.indexOf(l);if(a<0||a%2==0!=t>0)return null;let c={from:t<0?e-1:e,to:t>0?e+1:e},u=n.doc.iterRange(e,t>0?n.doc.length:0),f=0;for(let h=0;!u.next().done&&h<=s;){let p=u.value;t<0&&(h+=p.length);let m=e+h*t;for(let y=t>0?0:p.length-1,x=t>0?p.length:-1;y!=x;y+=t){let C=i.indexOf(p[y]);if(!(C<0||r.resolveInner(m+y,1).type!=o))if(C%2==0==t>0)f++;else{if(f==1)return{start:c,end:{from:m+y,to:m+y+1},matched:C>>1==a>>1};f--}}t>0&&(h+=p.length)}return u.done?{start:c,matched:!1}:null}function Yr(n,e,t,r=0,o=0){e==null&&(e=n.search(/[^\s\u00a0]/),e==-1&&(e=n.length));let s=o;for(let i=r;i<e;i++)n.charCodeAt(i)==9?s+=t-s%t:s++;return s}class fs{constructor(e,t,r,o){this.string=e,this.tabSize=t,this.indentUnit=r,this.overrideIndent=o,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let t=this.string.charAt(this.pos),r;if(typeof e=="string"?r=t==e:r=t&&(e instanceof RegExp?e.test(t):e(t)),r)return++this.pos,t}eatWhile(e){let t=this.pos;for(;this.eat(e););return this.pos>t}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Yr(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:Yr(this.string,null,this.tabSize)}match(e,t,r){if(typeof e=="string"){let o=i=>r?i.toLowerCase():i,s=this.string.substr(this.pos,e.length);return o(s)==o(e)?(t!==!1&&(this.pos+=e.length),!0):null}else{let o=this.string.slice(this.pos).match(e);return o&&o.index>0?null:(o&&t!==!1&&(this.pos+=o[0].length),o)}}current(){return this.string.slice(this.start,this.pos)}}function Ba(n){return{name:n.name||"",token:n.token,blankLine:n.blankLine||(()=>{}),startState:n.startState||(()=>!0),copyState:n.copyState||ja,indent:n.indent||(()=>null),languageData:n.languageData||{},tokenTable:n.tokenTable||lr}}function ja(n){if(typeof n!="object")return n;let e={};for(let t in n){let r=n[t];e[t]=r instanceof Array?r.slice():r}return e}const Xr=new WeakMap;class sr extends ae{constructor(e){let t=Xo(e.languageData),r=Ba(e),o,s=new class extends Wo{createParse(i,l,a){return new Va(o,i,l,a)}};super(t,s,[Jo.of((i,l)=>this.getIndent(i,l))],e.name),this.topNode=za(t),o=this,this.streamParser=r,this.stateAfter=new O({perNode:!0}),this.tokenTable=e.tokenTable?new ms(r.tokenTable):Ha}static define(e){return new sr(e)}getIndent(e,t){let r=z(e.state),o=r.resolve(t);for(;o&&o.type!=this.topNode;)o=o.parent;if(!o)return null;let s,{overrideIndentation:i}=e.options;i&&(s=Xr.get(e.state),s!=null&&s<t-1e4&&(s=void 0));let l=ir(this,r,0,o.from,s??t),a,c;if(l?(c=l.state,a=l.pos+1):(c=this.streamParser.startState(e.unit),a=0),t-a>1e4)return null;for(;a<t;){let f=e.state.doc.lineAt(a),h=Math.min(t,f.to);if(f.length){let p=i?i(f.from):-1,m=new fs(f.text,e.state.tabSize,e.unit,p<0?void 0:p);for(;m.pos<h-f.from;)ds(this.streamParser.token,m,c)}else this.streamParser.blankLine(c,e.unit);if(h==t)break;a=f.to+1}let u=e.lineAt(t);return i&&s==null&&Xr.set(e.state,u.from),this.streamParser.indent(c,/^\s*(.*)/.exec(u.text)[1],e)}get allowsNesting(){return!1}}function ir(n,e,t,r,o){let s=t>=r&&t+e.length<=o&&e.prop(n.stateAfter);if(s)return{state:n.streamParser.copyState(s),pos:t+e.length};for(let i=e.children.length-1;i>=0;i--){let l=e.children[i],a=t+e.positions[i],c=l instanceof j&&a<o&&ir(n,l,a,r,o);if(c)return c}return null}function hs(n,e,t,r,o){if(o&&t<=0&&r>=e.length)return e;!o&&e.type==n.topNode&&(o=!0);for(let s=e.children.length-1;s>=0;s--){let i=e.positions[s],l=e.children[s],a;if(i<r&&l instanceof j){if(!(a=hs(n,l,t-i,r-i,o)))break;return o?new j(e.type,e.children.slice(0,s).concat(a),e.positions.slice(0,s+1),i+a.length):a}}return null}function Fa(n,e,t,r){for(let o of e){let s=o.from+(o.openStart?25:0),i=o.to-(o.openEnd?25:0),l=s<=t&&i>t&&ir(n,o.tree,0-o.offset,t,i),a;if(l&&(a=hs(n,o.tree,t+o.offset,l.pos+o.offset,!1)))return{state:l.state,tree:a}}return{state:n.streamParser.startState(r?Ue(r):4),tree:j.empty}}class Va{constructor(e,t,r,o){this.lang=e,this.input=t,this.fragments=r,this.ranges=o,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=o[o.length-1].to;let s=et.get(),i=o[0].from,{state:l,tree:a}=Fa(e,r,i,s?.state);this.state=l,this.parsedPos=this.chunkStart=i+a.length;for(let c=0;c<a.children.length;c++)this.chunks.push(a.children[c]),this.chunkPos.push(a.positions[c]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(Ue(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=et.get(),t=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(t,this.chunkStart+2048);for(e&&(r=Math.min(r,e.viewport.to));this.parsedPos<r;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=t?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,t),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let t=this.input.chunk(e);if(this.input.lineChunks)t==`
`&&(t="");else{let r=t.indexOf(`
`);r>-1&&(t=t.slice(0,r))}return e+t.length<=this.to?t:t.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,t=this.lineAfter(e),r=e+t.length;for(let o=this.rangeIndex;;){let s=this.ranges[o].to;if(s>=r||(t=t.slice(0,s-(r-t.length)),o++,o==this.ranges.length))break;let i=this.ranges[o].from,l=this.lineAfter(i);t+=l,r=i+l.length}return{line:t,end:r}}skipGapsTo(e,t,r){for(;;){let o=this.ranges[this.rangeIndex].to,s=e+t;if(r>0?o>s:o>=s)break;let i=this.ranges[++this.rangeIndex].from;t+=i-o}return t}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,t,r,o,s){if(this.ranges.length>1){s=this.skipGapsTo(t,s,1),t+=s;let i=this.chunk.length;s=this.skipGapsTo(r,s,-1),r+=s,o+=this.chunk.length-i}return this.chunk.push(e,t,r,o),s}parseLine(e){let{line:t,end:r}=this.nextLine(),o=0,{streamParser:s}=this.lang,i=new fs(t,e?e.state.tabSize:4,e?Ue(e.state):2);if(i.eol())s.blankLine(this.state,i.indentUnit);else for(;!i.eol();){let l=ds(s.token,i,this.state);if(l&&(o=this.emitToken(this.lang.tokenTable.resolve(l),this.parsedPos+i.start,this.parsedPos+i.pos,4,o)),i.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=j.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Ga,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new j(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new j(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function ds(n,e,t){e.start=e.pos;for(let r=0;r<10;r++){let o=n(e,t);if(e.pos>e.start)return o}throw new Error("Stream parser failed to advance stream.")}const lr=Object.create(null),yt=[ee.none],Ga=new Qn(yt),qr=[],Jr=Object.create(null),ps=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])ps[n]=gs(lr,e);class ms{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),ps)}resolve(e){return e?this.table[e]||(this.table[e]=gs(this.extra,e)):0}}const Ha=new ms(lr);function Cn(n,e){qr.indexOf(n)>-1||(qr.push(n),console.warn(e))}function gs(n,e){let t=[];for(let l of e.split(" ")){let a=[];for(let c of l.split(".")){let u=n[c]||d[c];u?typeof u=="function"?a.length?a=a.map(u):Cn(c,`Modifier ${c} used at start of tag`):a.length?Cn(c,`Tag ${c} used as modifier`):a=Array.isArray(u)?u:[u]:Cn(c,`Unknown highlighting tag ${c}`)}for(let c of a)t.push(c)}if(!t.length)return 0;let r=e.replace(/ /g,"_"),o=r+" "+t.map(l=>l.id),s=Jr[o];if(s)return s.id;let i=Jr[o]=ee.define({id:yt.length,name:r,props:[Xl({[r]:t})]});return yt.push(i),i.id}function za(n){let e=ee.define({id:yt.length,name:"Document",props:[He.add(()=>n)],top:!0});return yt.push(e),e}Ft.RTL,Ft.LTR;const Ua="_modelCursor_1mtn0_1",Md={modelCursor:Ua};class $a{constructor(e,t,r,o){this.state=e,this.pos=t,this.explicit=r,this.view=o,this.abortListeners=[]}tokenBefore(e){let t=z(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),r=Math.max(t.from,this.pos-250),o=t.text.slice(r-t.from,this.pos-t.from),s=o.search(ys(e,!1));return s<0?null:{from:r+s,to:this.pos,text:o.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t){e=="abort"&&this.abortListeners&&this.abortListeners.push(t)}}function Zr(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function Wa(n){let e=Object.create(null),t=Object.create(null);for(let{label:o}of n){e[o[0]]=!0;for(let s=1;s<o.length;s++)t[o[s]]=!0}let r=Zr(e)+Zr(t)+"*$";return[new RegExp("^"+r),new RegExp(r)]}function Ka(n){let e=n.map(o=>typeof o=="string"?{label:o}:o),[t,r]=e.every(o=>/^\w+$/.test(o.label))?[/\w*$/,/\w+$/]:Wa(e);return o=>{let s=o.matchBefore(r);return s||o.explicit?{from:s?s.from:o.pos,options:e,validFor:t}:null}}function Od(n,e){return t=>{for(let r=z(t.state).resolveInner(t.pos,-1);r;r=r.parent){if(n.indexOf(r.name)>-1)return null;if(r.type.isTop)break}return e(t)}}class Qr{constructor(e,t,r,o){this.completion=e,this.source=t,this.match=r,this.score=o}}function Qe(n){return n.selection.main.from}function ys(n,e){var t;let{source:r}=n,o=e&&r[0]!="^",s=r[r.length-1]!="$";return!o&&!s?n:new RegExp(`${o?"^":""}(?:${r})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const ar=Zn.define();function Ya(n,e,t,r){let{main:o}=n.selection,s=t-o.from,i=r-o.from;return Object.assign(Object.assign({},n.changeByRange(l=>l!=o&&t!=r&&n.sliceDoc(l.from+s,l.from+i)!=n.sliceDoc(t,r)?{range:l}:{changes:{from:l.from+s,to:r==o.from?l.to:l.from+i,insert:e},range:M.cursor(l.from+s+e.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const eo=new WeakMap;function Xa(n){if(!Array.isArray(n))return n;let e=eo.get(n);return e||eo.set(n,e=Ka(n)),e}const xs=re.define(),cr=re.define();class qa{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let r=he(e,t),o=Me(r);this.chars.push(r);let s=e.slice(t,t+o),i=s.toUpperCase();this.folded.push(he(i==s?s.toLowerCase():i,0)),t+=o}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:r,any:o,precise:s,byWord:i}=this;if(t.length==1){let v=he(e,0),T=Me(v),A=T==e.length?0:-100;if(v!=t[0])if(v==r[0])A+=-200;else return null;return this.ret(A,[0,T])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,c=0;if(l<0){for(let v=0,T=Math.min(e.length,200);v<T&&c<a;){let A=he(e,v);(A==t[c]||A==r[c])&&(o[c++]=v),v+=Me(A)}if(c<a)return null}let u=0,f=0,h=!1,p=0,m=-1,y=-1,x=/[a-z]/.test(e),C=!0;for(let v=0,T=Math.min(e.length,200),A=0;v<T&&f<a;){let k=he(e,v);l<0&&(u<a&&k==t[u]&&(s[u++]=v),p<a&&(k==t[p]||k==r[p]?(p==0&&(m=v),y=v+1,p++):p=0));let E,S=k<255?k>=48&&k<=57||k>=97&&k<=122?2:k>=65&&k<=90?1:0:(E=jo(k))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!v||S==1&&x||A==0&&S!=0)&&(t[f]==k||r[f]==k&&(h=!0)?i[f++]=v:i.length&&(C=!1)),A=S,v+=Me(k)}return f==a&&i[0]==0&&C?this.result(-100+(h?-200:0),i,e):p==a&&m==0?this.ret(-200-e.length+(y==e.length?0:-100),[0,y]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):p==a?this.ret(-900-e.length,[m,y]):f==a?this.result(-100+(h?-200:0)+-700+(C?0:-1100),i,e):t.length==2?null:this.result((o[0]?-700:0)+-200+-1100,o,e)}result(e,t,r){let o=[],s=0;for(let i of t){let l=i+(this.astral?Me(he(r,i)):1);s&&o[s-1]==i?o[s-1]=l:(o[s++]=i,o[s++]=l)}return this.ret(e-r.length,o)}}class Ja{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),r=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return r==null?null:(this.matched=[0,t.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}const be=ne.define({combine(n){return Zt(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Za,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>r=>to(e(r),t(r)),optionClass:(e,t)=>r=>to(e(r),t(r)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function to(n,e){return n?e?n+" "+e:n:e}function Za(n,e,t,r,o,s){let i=n.textDirection==Ft.RTL,l=i,a=!1,c="top",u,f,h=e.left-o.left,p=o.right-e.right,m=r.right-r.left,y=r.bottom-r.top;if(l&&h<Math.min(m,p)?l=!1:!l&&p<Math.min(m,h)&&(l=!0),m<=(l?h:p))u=Math.max(o.top,Math.min(t.top,o.bottom-y))-e.top,f=Math.min(400,l?h:p);else{a=!0,f=Math.min(400,(i?e.right:o.right-e.left)-30);let v=o.bottom-e.bottom;v>=y||v>e.top?u=t.bottom-e.top:(c="bottom",u=e.bottom-t.top)}let x=(e.bottom-e.top)/s.offsetHeight,C=(e.right-e.left)/s.offsetWidth;return{style:`${c}: ${u/x}px; max-width: ${f/C}px`,class:"cm-completionInfo-"+(a?i?"left-narrow":"right-narrow":l?"left":"right")}}function Qa(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let r=document.createElement("div");return r.classList.add("cm-completionIcon"),t.type&&r.classList.add(...t.type.split(/\s+/g).map(o=>"cm-completionIcon-"+o)),r.setAttribute("aria-hidden","true"),r},position:20}),e.push({render(t,r,o,s){let i=document.createElement("span");i.className="cm-completionLabel";let l=t.displayLabel||t.label,a=0;for(let c=0;c<s.length;){let u=s[c++],f=s[c++];u>a&&i.appendChild(document.createTextNode(l.slice(a,u)));let h=i.appendChild(document.createElement("span"));h.appendChild(document.createTextNode(l.slice(u,f))),h.className="cm-completionMatchedText",a=f}return a<l.length&&i.appendChild(document.createTextNode(l.slice(a))),i},position:50},{render(t){if(!t.detail)return null;let r=document.createElement("span");return r.className="cm-completionDetail",r.textContent=t.detail,r},position:80}),e.sort((t,r)=>t.position-r.position).map(t=>t.render)}function kn(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let o=Math.floor(e/t);return{from:o*t,to:(o+1)*t}}let r=Math.floor((n-e)/t);return{from:n-(r+1)*t,to:n-r*t}}class ec{constructor(e,t,r){this.view=e,this.stateField=t,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let o=e.state.field(t),{options:s,selected:i}=o.open,l=e.state.facet(be);this.optionContent=Qa(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=kn(s.length,i,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:c}=e.state.field(t).open;for(let u=a.target,f;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(f=/-(\d+)$/.exec(u.id))&&+f[1]<c.length){this.applyCompletion(e,c[+f[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(be).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:cr.of(null)})}),this.showOptions(s,o.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let r=e.state.field(this.stateField),o=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),r!=o){let{options:s,selected:i,disabled:l}=r.open;(!o.open||o.open.options!=s)&&(this.range=kn(s.length,i,e.state.facet(be).maxRenderedOptions),this.showOptions(s,r.id)),this.updateSel(),l!=((t=o.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let r of this.currentClass.split(" "))r&&this.dom.classList.remove(r);for(let r of t.split(" "))r&&this.dom.classList.add(r);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=kn(t.options.length,t.selected,this.view.state.facet(be).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:r}=t.options[t.selected],{info:o}=r;if(!o)return;let s=typeof o=="string"?document.createTextNode(o):o(r);if(!s)return;"then"in s?s.then(i=>{i&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(i,r)}).catch(i=>Do(this.view.state,i,"completion info")):this.addInfoPane(s,r)}}addInfoPane(e,t){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",e.nodeType!=null)r.appendChild(e),this.infoDestroy=null;else{let{dom:o,destroy:s}=e;r.appendChild(o),this.infoDestroy=s||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let r=this.list.firstChild,o=this.range.from;r;r=r.nextSibling,o++)r.nodeName!="LI"||!r.id?o--:o==e?r.hasAttribute("aria-selected")||(r.setAttribute("aria-selected","true"),t=r):r.hasAttribute("aria-selected")&&r.removeAttribute("aria-selected");return t&&nc(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),o=e.getBoundingClientRect(),s=this.space;if(!s){let i=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:i.innerWidth,bottom:i.innerHeight}}return o.top>Math.min(s.bottom,t.bottom)-10||o.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(be).positionInfo(this.view,t,o,r,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,r){const o=document.createElement("ul");o.id=t,o.setAttribute("role","listbox"),o.setAttribute("aria-expanded","true"),o.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let i=r.from;i<r.to;i++){let{completion:l,match:a}=e[i],{section:c}=l;if(c){let h=typeof c=="string"?c:c.name;if(h!=s&&(i>r.from||r.from==0))if(s=h,typeof c!="string"&&c.header)o.appendChild(c.header(c));else{let p=o.appendChild(document.createElement("completion-section"));p.textContent=h}}const u=o.appendChild(document.createElement("li"));u.id=t+"-"+i,u.setAttribute("role","option");let f=this.optionClass(l);f&&(u.className=f);for(let h of this.optionContent){let p=h(l,this.view.state,this.view,a);p&&u.appendChild(p)}}return r.from&&o.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&o.classList.add("cm-completionListIncompleteBottom"),o}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function tc(n,e){return t=>new ec(t,n,e)}function nc(n,e){let t=n.getBoundingClientRect(),r=e.getBoundingClientRect(),o=t.height/n.offsetHeight;r.top<t.top?n.scrollTop-=(t.top-r.top)/o:r.bottom>t.bottom&&(n.scrollTop+=(r.bottom-t.bottom)/o)}function no(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function rc(n,e){let t=[],r=null,o=c=>{t.push(c);let{section:u}=c.completion;if(u){r||(r=[]);let f=typeof u=="string"?u:u.name;r.some(h=>h.name==f)||r.push(typeof u=="string"?{name:f}:u)}},s=e.facet(be);for(let c of n)if(c.hasResult()){let u=c.result.getMatch;if(c.result.filter===!1)for(let f of c.result.options)o(new Qr(f,c.source,u?u(f):[],1e9-t.length));else{let f=e.sliceDoc(c.from,c.to),h,p=s.filterStrict?new Ja(f):new qa(f);for(let m of c.result.options)if(h=p.match(m.label)){let y=m.displayLabel?u?u(m,h.matched):[]:h.matched;o(new Qr(m,c.source,y,h.score+(m.boost||0)))}}}if(r){let c=Object.create(null),u=0,f=(h,p)=>{var m,y;return((m=h.rank)!==null&&m!==void 0?m:1e9)-((y=p.rank)!==null&&y!==void 0?y:1e9)||(h.name<p.name?-1:1)};for(let h of r.sort(f))u-=1e5,c[h.name]=u;for(let h of t){let{section:p}=h.completion;p&&(h.score+=c[typeof p=="string"?p:p.name])}}let i=[],l=null,a=s.compareCompletions;for(let c of t.sort((u,f)=>f.score-u.score||a(u.completion,f.completion))){let u=c.completion;!l||l.label!=u.label||l.detail!=u.detail||l.type!=null&&u.type!=null&&l.type!=u.type||l.apply!=u.apply||l.boost!=u.boost?i.push(c):no(c.completion)>no(l)&&(i[i.length-1]=c),l=c.completion}return i}class Je{constructor(e,t,r,o,s,i){this.options=e,this.attrs=t,this.tooltip=r,this.timestamp=o,this.selected=s,this.disabled=i}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Je(this.options,ro(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,r,o,s){let i=rc(e,t);if(!i.length)return o&&e.some(a=>a.state==1)?new Je(o.options,o.attrs,o.tooltip,o.timestamp,o.selected,!0):null;let l=t.facet(be).selectOnOpen?0:-1;if(o&&o.selected!=l&&o.selected!=-1){let a=o.options[o.selected].completion;for(let c=0;c<i.length;c++)if(i[c].completion==a){l=c;break}}return new Je(i,ro(r,l),{pos:e.reduce((a,c)=>c.hasResult()?Math.min(a,c.from):a,1e8),create:fc,above:s.aboveCursor},o?o.timestamp:Date.now(),l,!1)}map(e){return new Je(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class $t{constructor(e,t,r){this.active=e,this.id=t,this.open=r}static start(){return new $t(lc,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,r=t.facet(be),s=(r.override||t.languageDataAt("autocomplete",Qe(t)).map(Xa)).map(l=>(this.active.find(c=>c.source==l)||new se(l,this.active.some(c=>c.state!=0)?1:0)).update(e,r));s.length==this.active.length&&s.every((l,a)=>l==this.active[a])&&(s=this.active);let i=this.open;i&&e.docChanged&&(i=i.map(e.changes)),e.selection||s.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!oc(s,this.active)?i=Je.build(s,t,this.id,i,r):i&&i.disabled&&!s.some(l=>l.state==1)&&(i=null),!i&&s.every(l=>l.state!=1)&&s.some(l=>l.hasResult())&&(s=s.map(l=>l.hasResult()?new se(l.source,0):l));for(let l of e.effects)l.is(bs)&&(i=i&&i.setSelected(l.value,this.id));return s==this.active&&i==this.open?this:new $t(s,this.id,i)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?sc:ic}}function oc(n,e){if(n==e)return!0;for(let t=0,r=0;;){for(;t<n.length&&!n[t].hasResult;)t++;for(;r<e.length&&!e[r].hasResult;)r++;let o=t==n.length,s=r==e.length;if(o||s)return o==s;if(n[t++].result!=e[r++].result)return!1}}const sc={"aria-autocomplete":"list"},ic={};function ro(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const lc=[];function ac(n,e){if(n.isUserEvent("input.complete")){let r=n.annotation(ar);if(r&&e.activateOnCompletion(r))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class se{constructor(e,t,r=-1){this.source=e,this.state=t,this.explicitPos=r}hasResult(){return!1}update(e,t){let r=ac(e,t),o=this;(r&8||r&16&&this.touches(e))&&(o=new se(o.source,0)),r&4&&o.state==0&&(o=new se(this.source,1)),o=o.updateFor(e,r);for(let s of e.effects)if(s.is(xs))o=new se(o.source,1,s.value?Qe(e.state):-1);else if(s.is(cr))o=new se(o.source,0);else if(s.is(uc))for(let i of s.value)i.source==o.source&&(o=i);return o}updateFor(e,t){return this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new se(this.source,this.state,e.mapPos(this.explicitPos))}touches(e){return e.changes.touchesRange(Qe(e.state))}}class ft extends se{constructor(e,t,r,o,s){super(e,2,t),this.result=r,this.from=o,this.to=s}hasResult(){return!0}updateFor(e,t){var r;if(!(t&3))return this.map(e.changes);let o=this.result;o.map&&!e.changes.empty&&(o=o.map(o,e.changes));let s=e.changes.mapPos(this.from),i=e.changes.mapPos(this.to,1),l=Qe(e.state);if((this.explicitPos<0?l<=s:l<this.from)||l>i||!o||t&2&&Qe(e.startState)==this.from)return new se(this.source,t&4?1:0);let a=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos);return cc(o.validFor,e.state,s,i)?new ft(this.source,a,o,s,i):o.update&&(o=o.update(o,s,i,new $a(e.state,l,a>=0)))?new ft(this.source,a,o,o.from,(r=o.to)!==null&&r!==void 0?r:Qe(e.state)):new se(this.source,1,a)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new ft(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new se(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function cc(n,e,t,r){if(!n)return!1;let o=e.sliceDoc(t,r);return typeof n=="function"?n(o,t,r,e):ys(n,!0).test(o)}const uc=re.define({map(n,e){return n.map(t=>t.map(e))}}),bs=re.define(),rt=Ke.define({create(){return $t.start()},update(n,e){return n.update(e)},provide:n=>[sl.from(n,e=>e.tooltip),G.contentAttributes.from(n,e=>e.attrs)]});function vs(n,e){const t=e.completion.apply||e.completion.label;let r=n.state.field(rt).active.find(o=>o.source==e.source);return r instanceof ft?(typeof t=="string"?n.dispatch(Object.assign(Object.assign({},Ya(n.state,t,r.from,r.to)),{annotations:ar.of(e.completion)})):t(n,e.completion,r.from,r.to),!0):!1}const fc=tc(rt,vs);function It(n,e="option"){return t=>{let r=t.state.field(rt,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<t.state.facet(be).interactionDelay)return!1;let o=1,s;e=="page"&&(s=ol(t,r.open.tooltip))&&(o=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:i}=r.open.options,l=r.open.selected>-1?r.open.selected+o*(n?1:-1):n?0:i-1;return l<0?l=e=="page"?0:i-1:l>=i&&(l=e=="page"?i-1:0),t.dispatch({effects:bs.of(l)}),!0}}const hc=n=>{let e=n.state.field(rt,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(be).interactionDelay?!1:vs(n,e.open.options[e.open.selected])},dc=n=>n.state.field(rt,!1)?(n.dispatch({effects:xs.of(!0)}),!0):!1,pc=n=>{let e=n.state.field(rt,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:cr.of(null)}),!0)},mc=G.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class gc{constructor(e,t,r,o){this.field=e,this.line=t,this.from=r,this.to=o}}class ur{constructor(e,t,r){this.field=e,this.from=t,this.to=r}map(e){let t=e.mapPos(this.from,-1,Mn.TrackDel),r=e.mapPos(this.to,1,Mn.TrackDel);return t==null||r==null?null:new ur(this.field,t,r)}}class fr{constructor(e,t){this.lines=e,this.fieldPositions=t}instantiate(e,t){let r=[],o=[t],s=e.doc.lineAt(t),i=/^\s*/.exec(s.text)[0];for(let a of this.lines){if(r.length){let c=i,u=/^\t*/.exec(a)[0].length;for(let f=0;f<u;f++)c+=e.facet(rn);o.push(t+c.length-u),a=c+a.slice(u)}r.push(a),t+=a.length+1}let l=this.fieldPositions.map(a=>new ur(a.field,o[a.line]+a.from,o[a.line]+a.to));return{text:r,ranges:l}}static parse(e){let t=[],r=[],o=[],s;for(let i of e.split(/\r\n?|\n/)){for(;s=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(i);){let l=s[1]?+s[1]:null,a=s[2]||s[3]||"",c=-1,u=a.replace(/\\[{}]/g,f=>f[1]);for(let f=0;f<t.length;f++)(l!=null?t[f].seq==l:u&&t[f].name==u)&&(c=f);if(c<0){let f=0;for(;f<t.length&&(l==null||t[f].seq!=null&&t[f].seq<l);)f++;t.splice(f,0,{seq:l,name:u}),c=f;for(let h of o)h.field>=c&&h.field++}o.push(new gc(c,r.length,s.index,s.index+u.length)),i=i.slice(0,s.index)+a+i.slice(s.index+s[0].length)}i=i.replace(/\\([{}])/g,(l,a,c)=>{for(let u of o)u.line==r.length&&u.from>c&&(u.from--,u.to--);return a}),r.push(i)}return new fr(r,o)}}let yc=W.widget({widget:new class extends qn{toDOM(){let n=document.createElement("span");return n.className="cm-snippetFieldPosition",n}ignoreEvent(){return!1}}}),xc=W.mark({class:"cm-snippetField"});class ot{constructor(e,t){this.ranges=e,this.active=t,this.deco=W.set(e.map(r=>(r.from==r.to?yc:xc).range(r.from,r.to)))}map(e){let t=[];for(let r of this.ranges){let o=r.map(e);if(!o)return null;t.push(o)}return new ot(t,this.active)}selectionInsideField(e){return e.ranges.every(t=>this.ranges.some(r=>r.field==this.active&&r.from<=t.from&&r.to>=t.to))}}const kt=re.define({map(n,e){return n&&n.map(e)}}),bc=re.define(),xt=Ke.define({create(){return null},update(n,e){for(let t of e.effects){if(t.is(kt))return t.value;if(t.is(bc)&&n)return new ot(n.ranges,t.value)}return n&&e.docChanged&&(n=n.map(e.changes)),n&&e.selection&&!n.selectionInsideField(e.selection)&&(n=null),n},provide:n=>G.decorations.from(n,e=>e?e.deco:W.none)});function hr(n,e){return M.create(n.filter(t=>t.field==e).map(t=>M.range(t.from,t.to)))}function vc(n){let e=fr.parse(n);return(t,r,o,s)=>{let{text:i,ranges:l}=e.instantiate(t.state,o),a={changes:{from:o,to:s,insert:Jn.of(i)},scrollIntoView:!0,annotations:r?[ar.of(r),Dt.userEvent.of("input.complete")]:void 0};if(l.length&&(a.selection=hr(l,0)),l.some(c=>c.field>0)){let c=new ot(l,0),u=a.effects=[kt.of(c)];t.state.field(xt,!1)===void 0&&u.push(re.appendConfig.of([xt,Ac,Ec,mc]))}t.dispatch(t.state.update(a))}}function Cs(n){return({state:e,dispatch:t})=>{let r=e.field(xt,!1);if(!r||n<0&&r.active==0)return!1;let o=r.active+n,s=n>0&&!r.ranges.some(i=>i.field==o+n);return t(e.update({selection:hr(r.ranges,o),effects:kt.of(s?null:new ot(r.ranges,o)),scrollIntoView:!0})),!0}}const Cc=({state:n,dispatch:e})=>n.field(xt,!1)?(e(n.update({effects:kt.of(null)})),!0):!1,kc=Cs(1),Sc=Cs(-1),wc=[{key:"Tab",run:kc,shift:Sc},{key:"Escape",run:Cc}],oo=ne.define({combine(n){return n.length?n[0]:wc}}),Ac=Bo.highest(nl.compute([oo],n=>n.facet(oo)));function _d(n,e){return Object.assign(Object.assign({},e),{apply:vc(n)})}const Ec=G.domEventHandlers({mousedown(n,e){let t=e.state.field(xt,!1),r;if(!t||(r=e.posAtCoords({x:n.clientX,y:n.clientY}))==null)return!1;let o=t.ranges.find(s=>s.from<=r&&s.to>=r);return!o||o.field==t.active?!1:(e.dispatch({selection:hr(t.ranges,o.field),effects:kt.of(t.ranges.some(s=>s.field>o.field)?new ot(t.ranges,o.field):null),scrollIntoView:!0}),!0)}}),bt={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},ze=re.define({map(n,e){let t=e.mapPos(n,-1,Mn.TrackAfter);return t??void 0}}),dr=new class extends rl{};dr.startSide=1;dr.endSide=-1;const ks=Ke.define({create(){return Lo.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:r=>r>=t.from&&r<=t.to})}for(let t of e.effects)t.is(ze)&&(n=n.update({add:[dr.range(t.value,t.value+1)]}));return n}});function Dd(){return[Nc,ks]}const Sn="()[]{}<>";function Ss(n){for(let e=0;e<Sn.length;e+=2)if(Sn.charCodeAt(e)==n)return Sn.charAt(e+1);return jo(n<128?n:n+1)}function ws(n,e){return n.languageDataAt("closeBrackets",e)[0]||bt}const Tc=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Nc=G.inputHandler.of((n,e,t,r)=>{if((Tc?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let o=n.state.selection.main;if(r.length>2||r.length==2&&Me(he(r,0))==1||e!=o.from||t!=o.to)return!1;let s=Ic(n.state,r);return s?(n.dispatch(s),!0):!1}),Pc=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=ws(n,n.selection.main.head).brackets||bt.brackets,o=null,s=n.changeByRange(i=>{if(i.empty){let l=Mc(n.doc,i.head);for(let a of r)if(a==l&&ln(n.doc,i.head)==Ss(he(a,0)))return{changes:{from:i.head-a.length,to:i.head+a.length},range:M.cursor(i.head-a.length)}}return{range:o=i}});return o||e(n.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!o},Ld=[{key:"Backspace",run:Pc}];function Ic(n,e){let t=ws(n,n.selection.main.head),r=t.brackets||bt.brackets;for(let o of r){let s=Ss(he(o,0));if(e==o)return s==o?Dc(n,o,r.indexOf(o+o+o)>-1,t):Oc(n,o,s,t.before||bt.before);if(e==s&&As(n,n.selection.main.from))return _c(n,o,s)}return null}function As(n,e){let t=!1;return n.field(ks).between(0,n.doc.length,r=>{r==e&&(t=!0)}),t}function ln(n,e){let t=n.sliceString(e,e+2);return t.slice(0,Me(he(t,0)))}function Mc(n,e){let t=n.sliceString(e-2,e);return Me(he(t,0))==t.length?t:t.slice(1)}function Oc(n,e,t,r){let o=null,s=n.changeByRange(i=>{if(!i.empty)return{changes:[{insert:e,from:i.from},{insert:t,from:i.to}],effects:ze.of(i.to+e.length),range:M.range(i.anchor+e.length,i.head+e.length)};let l=ln(n.doc,i.head);return!l||/\s/.test(l)||r.indexOf(l)>-1?{changes:{insert:e+t,from:i.head},effects:ze.of(i.head+e.length),range:M.cursor(i.head+e.length)}:{range:o=i}});return o?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function _c(n,e,t){let r=null,o=n.changeByRange(s=>s.empty&&ln(n.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:M.cursor(s.head+t.length)}:r={range:s});return r?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function Dc(n,e,t,r){let o=r.stringPrefixes||bt.stringPrefixes,s=null,i=n.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:ze.of(l.to+e.length),range:M.range(l.anchor+e.length,l.head+e.length)};let a=l.head,c=ln(n.doc,a),u;if(c==e){if(so(n,a))return{changes:{insert:e+e,from:a},effects:ze.of(a+e.length),range:M.cursor(a+e.length)};if(As(n,a)){let h=t&&n.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+h.length,insert:h},range:M.cursor(a+h.length)}}}else{if(t&&n.sliceDoc(a-2*e.length,a)==e+e&&(u=io(n,a-2*e.length,o))>-1&&so(n,u))return{changes:{insert:e+e+e+e,from:a},effects:ze.of(a+e.length),range:M.cursor(a+e.length)};if(n.charCategorizer(a)(c)!=In.Word&&io(n,a,o)>-1&&!Lc(n,a,e,o))return{changes:{insert:e+e,from:a},effects:ze.of(a+e.length),range:M.cursor(a+e.length)}}return{range:s=l}});return s?null:n.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function so(n,e){let t=z(n).resolveInner(e+1);return t.parent&&t.from==e}function Lc(n,e,t,r){let o=z(n).resolveInner(e,-1),s=r.reduce((i,l)=>Math.max(i,l.length),0);for(let i=0;i<5;i++){let l=n.sliceDoc(o.from,Math.min(o.to,o.from+t.length+s)),a=l.indexOf(t);if(!a||a>-1&&r.indexOf(l.slice(0,a))>-1){let u=o.firstChild;for(;u&&u.from==o.from&&u.to-u.from>t.length+a;){if(n.sliceDoc(u.to-t.length,u.to)==t)return!1;u=u.firstChild}return!0}let c=o.to==e&&o.parent;if(!c)break;o=c}return!1}function io(n,e,t){let r=n.charCategorizer(e);if(r(n.sliceDoc(e-1,e))!=In.Word)return e;for(let o of t){let s=e-o.length;if(n.sliceDoc(s,e)==o&&r(n.sliceDoc(s-1,s))!=In.Word)return s}return-1}const Rd=[{key:"Ctrl-Space",run:dc},{key:"Escape",run:pc},{key:"ArrowDown",run:It(!0)},{key:"ArrowUp",run:It(!1)},{key:"PageDown",run:It(!0,"page")},{key:"PageUp",run:It(!1,"page")},{key:"Enter",run:hc}],Rc=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),r=mr(n.state,t.from);return r.line?Bc(n):r.block?Fc(n):!1};function pr(n,e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let o=n(e,t);return o?(r(t.update(o)),!0):!1}}const Bc=pr(Hc,0),jc=pr(Es,0),Fc=pr((n,e)=>Es(n,e,Gc(e)),0);function mr(n,e){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const ct=50;function Vc(n,{open:e,close:t},r,o){let s=n.sliceDoc(r-ct,r),i=n.sliceDoc(o,o+ct),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(i)[0].length,c=s.length-l;if(s.slice(c-e.length,c)==e&&i.slice(a,a+t.length)==t)return{open:{pos:r-l,margin:l&&1},close:{pos:o+a,margin:a&&1}};let u,f;o-r<=2*ct?u=f=n.sliceDoc(r,o):(u=n.sliceDoc(r,r+ct),f=n.sliceDoc(o-ct,o));let h=/^\s*/.exec(u)[0].length,p=/\s*$/.exec(f)[0].length,m=f.length-p-t.length;return u.slice(h,h+e.length)==e&&f.slice(m,m+t.length)==t?{open:{pos:r+h+e.length,margin:/\s/.test(u.charAt(h+e.length))?1:0},close:{pos:o-p-t.length,margin:/\s/.test(f.charAt(m-1))?1:0}}:null}function Gc(n){let e=[];for(let t of n.selection.ranges){let r=n.doc.lineAt(t.from),o=t.to<=r.to?r:n.doc.lineAt(t.to),s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=o.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:o.to})}return e}function Es(n,e,t=e.selection.ranges){let r=t.map(s=>mr(e,s.from).block);if(!r.every(s=>s))return null;let o=t.map((s,i)=>Vc(e,r[i],s.from,s.to));if(n!=2&&!o.every(s=>s))return{changes:e.changes(t.map((s,i)=>o[i]?[]:[{from:s.from,insert:r[i].open+" "},{from:s.to,insert:" "+r[i].close}]))};if(n!=1&&o.some(s=>s)){let s=[];for(let i=0,l;i<o.length;i++)if(l=o[i]){let a=r[i],{open:c,close:u}=l;s.push({from:c.pos-a.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+a.close.length})}return{changes:s}}return null}function Hc(n,e,t=e.selection.ranges){let r=[],o=-1;for(let{from:s,to:i}of t){let l=r.length,a=1e9,c=mr(e,s).line;if(c){for(let u=s;u<=i;){let f=e.doc.lineAt(u);if(f.from>o&&(s==i||i>f.from)){o=f.from;let h=/^\s*/.exec(f.text)[0].length,p=h==f.length,m=f.text.slice(h,h+c.length)==c?h:-1;h<f.text.length&&h<a&&(a=h),r.push({line:f,comment:m,token:c,indent:h,empty:p,single:!1})}u=f.to+1}if(a<1e9)for(let u=l;u<r.length;u++)r[u].indent<r[u].line.text.length&&(r[u].indent=a);r.length==l+1&&(r[l].single=!0)}}if(n!=2&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:c,empty:u,single:f}of r)(f||!u)&&s.push({from:l.from+c,insert:a+" "});let i=e.changes(s);return{changes:i,selection:e.selection.map(i,1)}}else if(n!=1&&r.some(s=>s.comment>=0)){let s=[];for(let{line:i,comment:l,token:a}of r)if(l>=0){let c=i.from+l,u=c+a.length;i.text[u-i.from]==" "&&u++,s.push({from:c,to:u})}return{changes:s}}return null}const Fn=Zn.define(),zc=Zn.define(),Uc=ne.define(),Ts=ne.define({combine(n){return Zt(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,o)=>e(r,o)||t(r,o)})}}),Ns=Ke.define({create(){return ke.empty},update(n,e){let t=e.state.facet(Ts),r=e.annotation(Fn);if(r){let a=te.fromTransaction(e,r.selection),c=r.side,u=c==0?n.undone:n.done;return a?u=Wt(u,u.length,t.minDepth,a):u=Ms(u,e.startState.selection),new ke(c==0?r.rest:u,c==0?u:r.rest)}let o=e.annotation(zc);if((o=="full"||o=="before")&&(n=n.isolate()),e.annotation(Dt.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=te.fromTransaction(e),i=e.annotation(Dt.time),l=e.annotation(Dt.userEvent);return s?n=n.addChanges(s,i,l,t,e):e.selection&&(n=n.addSelection(e.startState.selection,i,l,t.newGroupDelay)),(o=="full"||o=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new ke(n.done.map(te.fromJSON),n.undone.map(te.fromJSON))}});function Bd(n={}){return[Ns,Ts.of(n),G.domEventHandlers({beforeinput(e,t){let r=e.inputType=="historyUndo"?Ps:e.inputType=="historyRedo"?Vn:null;return r?(e.preventDefault(),r(t)):!1}})]}function an(n,e){return function({state:t,dispatch:r}){if(!e&&t.readOnly)return!1;let o=t.field(Ns,!1);if(!o)return!1;let s=o.pop(n,t,e);return s?(r(s),!0):!1}}const Ps=an(0,!1),Vn=an(1,!1),$c=an(0,!0),Wc=an(1,!0);class te{constructor(e,t,r,o,s){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=o,this.selectionsAfter=s}setSelAfter(e){return new te(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(o=>o.toJSON())}}static fromJSON(e){return new te(e.changes&&il.fromJSON(e.changes),[],e.mapped&&ll.fromJSON(e.mapped),e.startSelection&&M.fromJSON(e.startSelection),e.selectionsAfter.map(M.fromJSON))}static fromTransaction(e,t){let r=ce;for(let o of e.startState.facet(Uc)){let s=o(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new te(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,ce)}static selection(e){return new te(void 0,ce,void 0,void 0,e)}}function Wt(n,e,t,r){let o=e+1>t+20?e-t-1:0,s=n.slice(o,e);return s.push(r),s}function Kc(n,e){let t=[],r=!1;return n.iterChangedRanges((o,s)=>t.push(o,s)),e.iterChangedRanges((o,s,i,l)=>{for(let a=0;a<t.length;){let c=t[a++],u=t[a++];l>=c&&i<=u&&(r=!0)}}),r}function Yc(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length===0}function Is(n,e){return n.length?e.length?n.concat(e):n:e}const ce=[],Xc=200;function Ms(n,e){if(n.length){let t=n[n.length-1],r=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-Xc));return r.length&&r[r.length-1].eq(e)?n:(r.push(e),Wt(n,n.length-1,1e9,t.setSelAfter(r)))}else return[te.selection([e])]}function qc(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function wn(n,e){if(!n.length)return n;let t=n.length,r=ce;for(;t;){let o=Jc(n[t-1],e,r);if(o.changes&&!o.changes.empty||o.effects.length){let s=n.slice(0,t);return s[t-1]=o,s}else e=o.mapped,t--,r=o.selectionsAfter}return r.length?[te.selection(r)]:ce}function Jc(n,e,t){let r=Is(n.selectionsAfter.length?n.selectionsAfter.map(l=>l.map(e)):ce,t);if(!n.changes)return te.selection(r);let o=n.changes.map(e),s=e.mapDesc(n.changes,!0),i=n.mapped?n.mapped.composeDesc(s):s;return new te(o,re.mapEffects(n.effects,e),i,n.startSelection.map(s),r)}const Zc=/^(input\.type|delete)($|\.)/;class ke{constructor(e,t,r=0,o=void 0){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=o}isolate(){return this.prevTime?new ke(this.done,this.undone):this}addChanges(e,t,r,o,s){let i=this.done,l=i[i.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!r||Zc.test(r))&&(!l.selectionsAfter.length&&t-this.prevTime<o.newGroupDelay&&o.joinToEvent(s,Kc(l.changes,e.changes))||r=="input.type.compose")?i=Wt(i,i.length-1,o.minDepth,new te(e.changes.compose(l.changes),Is(e.effects,l.effects),l.mapped,l.startSelection,ce)):i=Wt(i,i.length,o.minDepth,e),new ke(i,ce,t,r)}addSelection(e,t,r,o){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:ce;return s.length>0&&t-this.prevTime<o&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&Yc(s[s.length-1],e)?this:new ke(Ms(this.done,e),this.undone,t,r)}addMapping(e){return new ke(wn(this.done,e),wn(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let o=e==0?this.done:this.undone;if(o.length==0)return null;let s=o[o.length-1],i=s.selectionsAfter[0]||t.selection;if(r&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Fn.of({side:e,rest:qc(o),selection:i}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=o.length==1?ce:o.slice(0,o.length-1);return s.mapped&&(l=wn(l,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Fn.of({side:e,rest:l,selection:i}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}ke.empty=new ke(ce,ce);const jd=[{key:"Mod-z",run:Ps,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Vn,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Vn,preventDefault:!0},{key:"Mod-u",run:$c,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Wc,preventDefault:!0}];function st(n,e){return M.create(n.ranges.map(e),n.mainIndex)}function Se(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function de({state:n,dispatch:e},t){let r=st(n.selection,t);return r.eq(n.selection,!0)?!1:(e(Se(n,r)),!0)}function cn(n,e){return M.cursor(e?n.to:n.from)}function Os(n,e){return de(n,t=>t.empty?n.moveByChar(t,e):cn(t,e))}function q(n){return n.textDirectionAt(n.state.selection.main.head)==Ft.LTR}const _s=n=>Os(n,!q(n)),Ds=n=>Os(n,q(n));function Ls(n,e){return de(n,t=>t.empty?n.moveByGroup(t,e):cn(t,e))}const Qc=n=>Ls(n,!q(n)),eu=n=>Ls(n,q(n));function tu(n,e,t){if(e.type.prop(t))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function un(n,e,t){let r=z(n).resolveInner(e.head),o=t?O.closedBy:O.openedBy;for(let a=e.head;;){let c=t?r.childAfter(a):r.childBefore(a);if(!c)break;tu(n,c,o)?r=c:a=t?c.to:c.from}let s=r.type.prop(o),i,l;return s&&(i=t?Ce(n,r.from,1):Ce(n,r.to,-1))&&i.matched?l=t?i.end.to:i.end.from:l=t?r.to:r.from,M.cursor(l,t?-1:1)}const nu=n=>de(n,e=>un(n.state,e,!q(n))),ru=n=>de(n,e=>un(n.state,e,q(n)));function Rs(n,e){return de(n,t=>{if(!t.empty)return cn(t,e);let r=n.moveVertically(t,e);return r.head!=t.head?r:n.moveToLineBoundary(t,e)})}const Bs=n=>Rs(n,!1),js=n=>Rs(n,!0);function Fs(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,r=0,o;if(e){for(let s of n.state.facet(G.scrollMargins)){let i=s(n);i?.top&&(t=Math.max(i?.top,t)),i?.bottom&&(r=Math.max(i?.bottom,r))}o=n.scrollDOM.clientHeight-t-r}else o=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:r,selfScroll:e,height:Math.max(n.defaultLineHeight,o-5)}}function Vs(n,e){let t=Fs(n),{state:r}=n,o=st(r.selection,i=>i.empty?n.moveVertically(i,e,t.height):cn(i,e));if(o.eq(r.selection))return!1;let s;if(t.selfScroll){let i=n.coordsAtPos(r.selection.main.head),l=n.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,c=l.bottom-t.marginBottom;i&&i.top>a&&i.bottom<c&&(s=G.scrollIntoView(o.main.head,{y:"start",yMargin:i.top-a}))}return n.dispatch(Se(r,o),{effects:s}),!0}const lo=n=>Vs(n,!1),Gn=n=>Vs(n,!0);function Be(n,e,t){let r=n.lineBlockAt(e.head),o=n.moveToLineBoundary(e,t);if(o.head==e.head&&o.head!=(t?r.to:r.from)&&(o=n.moveToLineBoundary(e,t,!1)),!t&&o.head==r.from&&r.length){let s=/^\s*/.exec(n.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(o=M.cursor(r.from+s))}return o}const ou=n=>de(n,e=>Be(n,e,!0)),su=n=>de(n,e=>Be(n,e,!1)),iu=n=>de(n,e=>Be(n,e,!q(n))),lu=n=>de(n,e=>Be(n,e,q(n))),au=n=>de(n,e=>M.cursor(n.lineBlockAt(e.head).from,1)),cu=n=>de(n,e=>M.cursor(n.lineBlockAt(e.head).to,-1));function uu(n,e,t){let r=!1,o=st(n.selection,s=>{let i=Ce(n,s.head,-1)||Ce(n,s.head,1)||s.head>0&&Ce(n,s.head-1,1)||s.head<n.doc.length&&Ce(n,s.head+1,-1);if(!i||!i.end)return s;r=!0;let l=i.start.from==s.head?i.end.to:i.end.from;return M.cursor(l)});return r?(e(Se(n,o)),!0):!1}const fu=({state:n,dispatch:e})=>uu(n,e);function ue(n,e){let t=st(n.state.selection,r=>{let o=e(r);return M.range(r.anchor,o.head,o.goalColumn,o.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(Se(n.state,t)),!0)}function Gs(n,e){return ue(n,t=>n.moveByChar(t,e))}const Hs=n=>Gs(n,!q(n)),zs=n=>Gs(n,q(n));function Us(n,e){return ue(n,t=>n.moveByGroup(t,e))}const hu=n=>Us(n,!q(n)),du=n=>Us(n,q(n)),pu=n=>ue(n,e=>un(n.state,e,!q(n))),mu=n=>ue(n,e=>un(n.state,e,q(n)));function $s(n,e){return ue(n,t=>n.moveVertically(t,e))}const Ws=n=>$s(n,!1),Ks=n=>$s(n,!0);function Ys(n,e){return ue(n,t=>n.moveVertically(t,e,Fs(n).height))}const ao=n=>Ys(n,!1),co=n=>Ys(n,!0),gu=n=>ue(n,e=>Be(n,e,!0)),yu=n=>ue(n,e=>Be(n,e,!1)),xu=n=>ue(n,e=>Be(n,e,!q(n))),bu=n=>ue(n,e=>Be(n,e,q(n))),vu=n=>ue(n,e=>M.cursor(n.lineBlockAt(e.head).from)),Cu=n=>ue(n,e=>M.cursor(n.lineBlockAt(e.head).to)),uo=({state:n,dispatch:e})=>(e(Se(n,{anchor:0})),!0),fo=({state:n,dispatch:e})=>(e(Se(n,{anchor:n.doc.length})),!0),ho=({state:n,dispatch:e})=>(e(Se(n,{anchor:n.selection.main.anchor,head:0})),!0),po=({state:n,dispatch:e})=>(e(Se(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),ku=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),Su=({state:n,dispatch:e})=>{let t=fn(n).map(({from:r,to:o})=>M.range(r,Math.min(o+1,n.doc.length)));return e(n.update({selection:M.create(t),userEvent:"select"})),!0},wu=({state:n,dispatch:e})=>{let t=st(n.selection,r=>{var o;let s=z(n).resolveStack(r.from,1);for(let i=s;i;i=i.next){let{node:l}=i;if((l.from<r.from&&l.to>=r.to||l.to>r.to&&l.from<=r.from)&&(!((o=l.parent)===null||o===void 0)&&o.parent))return M.range(l.to,l.from)}return r});return e(Se(n,t)),!0},Au=({state:n,dispatch:e})=>{let t=n.selection,r=null;return t.ranges.length>1?r=M.create([t.main]):t.main.empty||(r=M.create([M.cursor(t.main.head)])),r?(e(Se(n,r)),!0):!1};function St(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:r}=n,o=r.changeByRange(s=>{let{from:i,to:l}=s;if(i==l){let a=e(s);a<i?(t="delete.backward",a=Mt(n,a,!1)):a>i&&(t="delete.forward",a=Mt(n,a,!0)),i=Math.min(i,a),l=Math.max(l,a)}else i=Mt(n,i,!1),l=Mt(n,l,!0);return i==l?{range:s}:{changes:{from:i,to:l},range:M.cursor(i,i<s.head?-1:1)}});return o.changes.empty?!1:(n.dispatch(r.update(o,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?G.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function Mt(n,e,t){if(n instanceof G)for(let r of n.state.facet(G.atomicRanges).map(o=>o(n)))r.between(e,e,(o,s)=>{o<e&&s>e&&(e=t?s:o)});return e}const Xs=(n,e,t)=>St(n,r=>{let o=r.from,{state:s}=n,i=s.doc.lineAt(o),l,a;if(t&&!e&&o>i.from&&o<i.from+200&&!/[^ \t]/.test(l=i.text.slice(0,o-i.from))){if(l[l.length-1]=="	")return o-1;let c=Qt(l,s.tabSize),u=c%Ue(s)||Ue(s);for(let f=0;f<u&&l[l.length-1-f]==" ";f++)o--;a=o}else a=dt(i.text,o-i.from,e,e)+i.from,a==o&&i.number!=(e?s.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(i.text.slice(a-i.from,o-i.from))&&(a=dt(i.text,a-i.from,!1,!1)+i.from);return a}),Hn=n=>Xs(n,!1,!0),qs=n=>Xs(n,!0,!1),Js=(n,e)=>St(n,t=>{let r=t.head,{state:o}=n,s=o.doc.lineAt(r),i=o.charCategorizer(r);for(let l=null;;){if(r==(e?s.to:s.from)){r==t.head&&s.number!=(e?o.doc.lines:1)&&(r+=e?1:-1);break}let a=dt(s.text,r-s.from,e)+s.from,c=s.text.slice(Math.min(r,a)-s.from,Math.max(r,a)-s.from),u=i(c);if(l!=null&&u!=l)break;(c!=" "||r!=t.head)&&(l=u),r=a}return r}),Zs=n=>Js(n,!1),Eu=n=>Js(n,!0),Tu=n=>St(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),Nu=n=>St(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),Pu=n=>St(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),Iu=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:Jn.of(["",""])},range:M.cursor(r.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},Mu=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>{if(!r.empty||r.from==0||r.from==n.doc.length)return{range:r};let o=r.from,s=n.doc.lineAt(o),i=o==s.from?o-1:dt(s.text,o-s.from,!1)+s.from,l=o==s.to?o+1:dt(s.text,o-s.from,!0)+s.from;return{changes:{from:i,to:l,insert:n.doc.slice(o,l).append(n.doc.slice(i,o))},range:M.cursor(l)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function fn(n){let e=[],t=-1;for(let r of n.selection.ranges){let o=n.doc.lineAt(r.from),s=n.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=n.doc.lineAt(r.to-1)),t>=o.number){let i=e[e.length-1];i.to=s.to,i.ranges.push(r)}else e.push({from:o.from,to:s.to,ranges:[r]});t=s.number+1}return e}function Qs(n,e,t){if(n.readOnly)return!1;let r=[],o=[];for(let s of fn(n)){if(t?s.to==n.doc.length:s.from==0)continue;let i=n.doc.lineAt(t?s.to+1:s.from-1),l=i.length+1;if(t){r.push({from:s.to,to:i.to},{from:s.from,insert:i.text+n.lineBreak});for(let a of s.ranges)o.push(M.range(Math.min(n.doc.length,a.anchor+l),Math.min(n.doc.length,a.head+l)))}else{r.push({from:i.from,to:s.from},{from:s.to,insert:n.lineBreak+i.text});for(let a of s.ranges)o.push(M.range(a.anchor-l,a.head-l))}}return r.length?(e(n.update({changes:r,scrollIntoView:!0,selection:M.create(o,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Ou=({state:n,dispatch:e})=>Qs(n,e,!1),_u=({state:n,dispatch:e})=>Qs(n,e,!0);function ei(n,e,t){if(n.readOnly)return!1;let r=[];for(let o of fn(n))t?r.push({from:o.from,insert:n.doc.slice(o.from,o.to)+n.lineBreak}):r.push({from:o.to,insert:n.lineBreak+n.doc.slice(o.from,o.to)});return e(n.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Du=({state:n,dispatch:e})=>ei(n,e,!1),Lu=({state:n,dispatch:e})=>ei(n,e,!0),Ru=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(fn(e).map(({from:o,to:s})=>(o>0?o--:s<e.doc.length&&s++,{from:o,to:s}))),r=st(e.selection,o=>{let s;if(n.lineWrapping){let i=n.lineBlockAt(o.head),l=n.coordsAtPos(o.head,o.assoc||1);l&&(s=i.bottom+n.documentTop-l.bottom+n.defaultLineHeight/2)}return n.moveVertically(o,!0,s)}).map(t);return n.dispatch({changes:t,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function Bu(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=z(n).resolveInner(e),r=t.childBefore(e),o=t.childAfter(e),s;return r&&o&&r.to<=e&&o.from>=e&&(s=r.type.prop(O.closedBy))&&s.indexOf(o.name)>-1&&n.doc.lineAt(r.to).from==n.doc.lineAt(o.from).from&&!/\S/.test(n.sliceDoc(r.to,o.from))?{from:r.to,to:o.from}:null}const ju=ti(!1),Fu=ti(!0);function ti(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(o=>{let{from:s,to:i}=o,l=e.doc.lineAt(s),a=!n&&s==i&&Bu(e,s);n&&(s=i=(i<=l.to?l:e.doc.lineAt(i)).to);let c=new on(e,{simulateBreak:s,simulateDoubleBreak:!!a}),u=rr(c,s);for(u==null&&(u=Qt(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));i<l.to&&/\s/.test(l.text[i-l.from]);)i++;a?{from:s,to:i}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let f=["",gt(e,u)];return a&&f.push(gt(e,c.lineIndent(l.from,-1))),{changes:{from:s,to:i,insert:Jn.of(f)},range:M.cursor(s+1+f[1].length)}});return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function gr(n,e){let t=-1;return n.changeByRange(r=>{let o=[];for(let i=r.from;i<=r.to;){let l=n.doc.lineAt(i);l.number>t&&(r.empty||r.to>l.from)&&(e(l,o,r),t=l.number),i=l.to+1}let s=n.changes(o);return{changes:o,range:M.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const Vu=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),r=new on(n,{overrideIndentation:s=>{let i=t[s];return i??-1}}),o=gr(n,(s,i,l)=>{let a=rr(r,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let c=/^\s*/.exec(s.text)[0],u=gt(n,a);(c!=u||l.from<s.from+c.length)&&(t[s.from]=a,i.push({from:s.from,to:s.from+c.length,insert:u}))});return o.changes.empty||e(n.update(o,{userEvent:"indent"})),!0},ni=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(gr(n,(t,r)=>{r.push({from:t.from,insert:n.facet(rn)})}),{userEvent:"input.indent"})),!0),ri=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(gr(n,(t,r)=>{let o=/^\s*/.exec(t.text)[0];if(!o)return;let s=Qt(o,n.tabSize),i=0,l=gt(n,Math.max(0,s-Ue(n)));for(;i<o.length&&i<l.length&&o.charCodeAt(i)==l.charCodeAt(i);)i++;r.push({from:t.from+i,to:t.from+o.length,insert:l.slice(i)})}),{userEvent:"delete.dedent"})),!0),Gu=n=>(n.setTabFocusMode(),!0),Hu=[{key:"Ctrl-b",run:_s,shift:Hs,preventDefault:!0},{key:"Ctrl-f",run:Ds,shift:zs},{key:"Ctrl-p",run:Bs,shift:Ws},{key:"Ctrl-n",run:js,shift:Ks},{key:"Ctrl-a",run:au,shift:vu},{key:"Ctrl-e",run:cu,shift:Cu},{key:"Ctrl-d",run:qs},{key:"Ctrl-h",run:Hn},{key:"Ctrl-k",run:Tu},{key:"Ctrl-Alt-h",run:Zs},{key:"Ctrl-o",run:Iu},{key:"Ctrl-t",run:Mu},{key:"Ctrl-v",run:Gn}],zu=[{key:"ArrowLeft",run:_s,shift:Hs,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:Qc,shift:hu,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:iu,shift:xu,preventDefault:!0},{key:"ArrowRight",run:Ds,shift:zs,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:eu,shift:du,preventDefault:!0},{mac:"Cmd-ArrowRight",run:lu,shift:bu,preventDefault:!0},{key:"ArrowUp",run:Bs,shift:Ws,preventDefault:!0},{mac:"Cmd-ArrowUp",run:uo,shift:ho},{mac:"Ctrl-ArrowUp",run:lo,shift:ao},{key:"ArrowDown",run:js,shift:Ks,preventDefault:!0},{mac:"Cmd-ArrowDown",run:fo,shift:po},{mac:"Ctrl-ArrowDown",run:Gn,shift:co},{key:"PageUp",run:lo,shift:ao},{key:"PageDown",run:Gn,shift:co},{key:"Home",run:su,shift:yu,preventDefault:!0},{key:"Mod-Home",run:uo,shift:ho},{key:"End",run:ou,shift:gu,preventDefault:!0},{key:"Mod-End",run:fo,shift:po},{key:"Enter",run:ju},{key:"Mod-a",run:ku},{key:"Backspace",run:Hn,shift:Hn},{key:"Delete",run:qs},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Zs},{key:"Mod-Delete",mac:"Alt-Delete",run:Eu},{mac:"Mod-Backspace",run:Nu},{mac:"Mod-Delete",run:Pu}].concat(Hu.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),Fd=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:nu,shift:pu},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:ru,shift:mu},{key:"Alt-ArrowUp",run:Ou},{key:"Shift-Alt-ArrowUp",run:Du},{key:"Alt-ArrowDown",run:_u},{key:"Shift-Alt-ArrowDown",run:Lu},{key:"Escape",run:Au},{key:"Mod-Enter",run:Fu},{key:"Alt-l",mac:"Ctrl-l",run:Su},{key:"Mod-i",run:wu,preventDefault:!0},{key:"Mod-[",run:ri},{key:"Mod-]",run:ni},{key:"Mod-Alt-\\",run:Vu},{key:"Shift-Mod-k",run:Ru},{key:"Shift-Mod-\\",run:fu},{key:"Mod-/",run:Rc},{key:"Alt-A",run:jc},{key:"Ctrl-m",mac:"Shift-Alt-m",run:Gu}].concat(zu),Vd={key:"Tab",run:ni,shift:ri},Uu=(...n)=>e=>{n.forEach(t=>{if(typeof t=="function")t(e);else if(t){const r=t;r.current=e}})};function Y(n){return new ra(sr.define(n))}const mo=()=>B(()=>import("./pbl95wx6493wq92j.js"),[]).then(n=>Y(n.shell)),oi={[L.bash]:mo,[L.zsh]:mo,[L.swift]:()=>B(()=>import("./pijqfo56g5y7ss6b.js"),[]).then(n=>Y(n.swift)),[L.css]:()=>B(()=>import("./hklioh4qu36vm4rt.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.css()),[L.html]:()=>B(()=>import("./dykyitkax7zu1p0e.js"),__vite__mapDeps([27,1,0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28])).then(n=>n.html()),[L.javascript]:()=>B(()=>import("./hy9ytkftq6eaca6u.js"),__vite__mapDeps([28,1,7,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.javascript({jsx:!0,typescript:!1})),[L.typescript]:()=>B(()=>import("./hy9ytkftq6eaca6u.js"),__vite__mapDeps([28,1,7,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.javascript({jsx:!0,typescript:!0})),[L.json]:()=>B(()=>import("./jvtc4y0qewtuvgpv.js"),__vite__mapDeps([29,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.json()),[L.python]:()=>B(()=>import("./guyb7pcses9idql6.js"),__vite__mapDeps([30,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.python()),[L.sql]:()=>B(()=>import("./hamjx3nmi2es0uyk.js"),__vite__mapDeps([31,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.sql()),[L.go]:()=>B(()=>import("./eywwucy45uxgi154.js"),__vite__mapDeps([32,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.go()),[L.yaml]:()=>B(()=>import("./b5xpo4my7q19ghh1.js"),__vite__mapDeps([33,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.yaml()),[L.java]:()=>B(()=>import("./dxw81r7nm1wt6hch.js"),__vite__mapDeps([34,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.java()),[L.rust]:()=>B(()=>import("./hub8cjv16hlkyxl6.js"),__vite__mapDeps([35,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.rust()),[L.cpp]:()=>B(()=>import("./eugnppqg149fg6g3.js"),__vite__mapDeps([36,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.cpp()),[L.php]:()=>B(()=>import("./n6caxidlhiv8d8nv.js"),__vite__mapDeps([37,1,27,0,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,28])).then(n=>n.php()),[L.xml]:()=>B(()=>import("./cn1qwboa3mb2itab.js"),__vite__mapDeps([38,1,7,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26])).then(n=>n.xml()),[L.ruby]:()=>B(()=>import("./e4lhyu305wu0fcut.js"),[]).then(n=>Y(n.ruby)),[L.haskell]:()=>B(()=>import("./bf6r3t2rw7f01so5.js"),[]).then(n=>Y(n.haskell)),[L.kotlin]:()=>B(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(n=>Y(n.kotlin)),[L.csharp]:()=>B(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(n=>Y(n.csharp)),[L.c]:()=>B(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(n=>Y(n.c)),[L.objectivec]:()=>B(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(n=>Y(n.objectiveC)),[L.r]:()=>B(()=>import("./n0t2rpizlasjzcxa.js"),[]).then(n=>Y(n.r)),[L.lua]:()=>B(()=>import("./harowmpdmpnd9wki.js"),[]).then(n=>Y(n.lua)),[L.dart]:()=>B(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(n=>Y(n.dart)),[L.scala]:()=>B(()=>import("./rlk4qi7ndmxxmstb.js"),[]).then(n=>Y(n.scala)),[L.perl]:()=>B(()=>import("./gq1ss5v2zpbborxl.js"),[]).then(n=>Y(n.perl)),[L.commonlisp]:()=>B(()=>import("./jr6cjysmysifr6mr.js"),[]).then(n=>Y(n.commonLisp)),[L.clojure]:()=>B(()=>import("./gf1tfl9d2himhfic.js"),[]).then(n=>Y(n.clojure)),[L.ocaml]:()=>B(()=>import("./khji33iw1sxityyt.js"),[]).then(n=>Y(n.oCaml)),[L.other]:()=>null},$u=n=>n in oi,Bt={},Gd=async n=>{if(Bt[n]!=null)return Bt[n];if($u(n)){const e=await oi[n]();return Bt[n]=e,e}return null},Hd=n=>Bt[n]??null;var si=n=>{var{theme:e,settings:t={},styles:r=[]}=n,o={".cm-gutters":{}},s={};t.background&&(s.backgroundColor=t.background),t.backgroundImage&&(s.backgroundImage=t.backgroundImage),t.foreground&&(s.color=t.foreground),t.fontSize&&(s.fontSize=t.fontSize),(t.background||t.foreground)&&(o["&"]=s),t.fontFamily&&(o["&.cm-editor .cm-scroller"]={fontFamily:t.fontFamily}),t.gutterBackground&&(o[".cm-gutters"].backgroundColor=t.gutterBackground),t.gutterForeground&&(o[".cm-gutters"].color=t.gutterForeground),t.gutterBorder&&(o[".cm-gutters"].borderRightColor=t.gutterBorder),t.caret&&(o[".cm-content"]={caretColor:t.caret},o[".cm-cursor, .cm-dropCursor"]={borderLeftColor:t.caret});var i={};t.gutterActiveForeground&&(i.color=t.gutterActiveForeground),t.lineHighlight&&(o[".cm-activeLine"]={backgroundColor:t.lineHighlight},i.backgroundColor=t.lineHighlight),o[".cm-activeLineGutter"]=i,t.selection&&(o["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:t.selection+" !important"}),t.selectionMatch&&(o["& .cm-selectionMatch"]={backgroundColor:t.selectionMatch});var l=G.theme(o,{dark:e==="dark"}),a=Ct.define(r),c=[l,Aa(a)];return c},Wu={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#f0f0f0",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},Ku=[{tag:[d.keyword,d.operatorKeyword,d.modifier,d.color,d.constant(d.name),d.standard(d.name),d.standard(d.tagName),d.special(d.brace),d.atom,d.bool,d.special(d.variableName)],color:"#0000ff"},{tag:[d.moduleKeyword,d.controlKeyword],color:"#af00db"},{tag:[d.name,d.deleted,d.character,d.macroName,d.propertyName,d.variableName,d.labelName,d.definition(d.name)],color:"#0070c1"},{tag:d.heading,fontWeight:"bold",color:"#0070c1"},{tag:[d.typeName,d.className,d.tagName,d.number,d.changed,d.annotation,d.self,d.namespace],color:"#267f99"},{tag:[d.function(d.variableName),d.function(d.propertyName)],color:"#795e26"},{tag:[d.number],color:"#098658"},{tag:[d.operator,d.punctuation,d.separator,d.url,d.escape,d.regexp],color:"#383a42"},{tag:[d.regexp],color:"#af00db"},{tag:[d.special(d.string),d.processingInstruction,d.string,d.inserted],color:"#a31515"},{tag:[d.angleBracket],color:"#383a42"},{tag:d.strong,fontWeight:"bold"},{tag:d.emphasis,fontStyle:"italic"},{tag:d.strikethrough,textDecoration:"line-through"},{tag:[d.meta,d.comment],color:"#008000"},{tag:d.link,color:"#4078f2",textDecoration:"underline"},{tag:d.invalid,color:"#e45649"}];function Yu(n){var{theme:e="dark",settings:t={},styles:r=[]}=n||{};return si({theme:e,settings:Io({},Wu,t),styles:[...Ku,...r]})}var zd=Yu(),Xu={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},qu=[{tag:[d.keyword,d.operatorKeyword,d.modifier,d.color,d.constant(d.name),d.standard(d.name),d.standard(d.tagName),d.special(d.brace),d.atom,d.bool,d.special(d.variableName)],color:"#569cd6"},{tag:[d.controlKeyword,d.moduleKeyword],color:"#c586c0"},{tag:[d.name,d.deleted,d.character,d.macroName,d.propertyName,d.variableName,d.labelName,d.definition(d.name)],color:"#9cdcfe"},{tag:d.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[d.typeName,d.className,d.tagName,d.number,d.changed,d.annotation,d.self,d.namespace],color:"#4ec9b0"},{tag:[d.function(d.variableName),d.function(d.propertyName)],color:"#dcdcaa"},{tag:[d.number],color:"#b5cea8"},{tag:[d.operator,d.punctuation,d.separator,d.url,d.escape,d.regexp],color:"#d4d4d4"},{tag:[d.regexp],color:"#d16969"},{tag:[d.special(d.string),d.processingInstruction,d.string,d.inserted],color:"#ce9178"},{tag:[d.angleBracket],color:"#808080"},{tag:d.strong,fontWeight:"bold"},{tag:d.emphasis,fontStyle:"italic"},{tag:d.strikethrough,textDecoration:"line-through"},{tag:[d.meta,d.comment],color:"#6a9955"},{tag:d.link,color:"#6a9955",textDecoration:"underline"},{tag:d.invalid,color:"#ff0000"}];function Ju(n){var{theme:e="dark",settings:t={},styles:r=[]}=n||{};return si({theme:e,settings:Io({},Xu,t),styles:[...qu,...r]})}var Ud=Ju(),Zu=Yi;function Qu(n){return typeof n=="function"?n:Zu}var ef=Qu,tf=qi,nf=ef,rf=Vi,of=9007199254740991,An=4294967295,sf=Math.min;function lf(n,e){if(n=rf(n),n<1||n>of)return[];var t=An,r=sf(n,An);e=nf(e),n-=An;for(var o=tf(r,e);++t<n;)e(t);return o}var af=lf;const cf=Xi(af),uf=n=>g.jsx(Q.div,{className:"dark:bg-white-400 aspect-square rounded-full bg-gray-400",animate:{translateY:["0%","-50%","0%","0%","0%"]},style:{translateX:.5,width:3,height:3},transition:{repeat:1/0,type:"keyframes",delay:n/10,duration:.7}},n),ff=()=>g.jsx(Q.div,{className:"grid h-full max-w-full flex-1 grid-cols-3 items-center gap-[0.4] p-1",children:cf(3,n=>uf(n))});function hf(n){switch(n){case"dark_gray":return{normal:"text-token-text-secondary dark:text-white-400",hover:"cursor-pointer hover:text-token-text-primary group-hover:text-token-text-primary"};case"light_gray":return{normal:"text-gray-400",hover:"cursor-pointer hover:text-token-text-secondary group-hover:text-token-text-secondary"}}}function yr({children:n,className:e,onClick:t,isClickable:r=!1,theme:o="dark_gray"}){const s=hf(o),i=(t!=null||r)&&s.hover;return g.jsxs("div",{className:H("relative inline-block h-[20px] w-[20px] shrink-0 transition-opacity",e,i,s.normal),onClick:t,children:[n?g.jsx(pl,{className:"h-[20px] w-[20px] shrink-0"}):g.jsx(ml,{className:"h-[20px] w-[20px] shrink-0"}),g.jsx("span",{className:H("absolute inset-0 flex items-center justify-center text-[8px] font-black",i,s.normal),children:n})]})}function hn(){return g.jsx(yr,{theme:"light_gray",children:g.jsx(ff,{})})}function df({count:n,isLoading:e,onClick:t}){return e?g.jsx(hn,{}):g.jsx(yr,{onClick:t,theme:"dark_gray",children:n})}function pf({isLoading:n=!1,onClick:e}){return n?g.jsx(hn,{}):g.jsx(yr,{isClickable:!0,onClick:e,theme:"light_gray"})}var Oe=(n=>(n[n.up=-1]="up",n[n.down=1]="down",n))(Oe||{}),Kt=(n=>(n.COMMENT="comment",n.COMPOSER="composer",n))(Kt||{}),$=(n=>(n.COLLAPSED="collapsed",n.EXPANDED="expanded",n))($||{});const ii=([n,e],[t,r])=>{const o=n+e,s=t+r;return n<s&&t<o},zn=([n,e])=>n+e,nt=n=>{if(n.type===$.COLLAPSED)return[n.offsetY??0,0];const{offsetY:e,shiftY:t=0,height:r=0}=n,o=e+t;return t<0?[o,r+Math.abs(t)]:[o,r]},mf=(n,e,t)=>{if(!ii(n,e))return null;const[r,o]=n,s=r+o,[i,l]=e,a=i+l,c=i-s,u=a-r;return t===Oe.up?c:u};var li=(n=>(n.ABOVE="above",n.BELOW="below",n))(li||{});function ht(n,e){return jt(n.coordsAtPos(e))}const go=360,gf=250,ai=44,yo=.5,xo=[.5,.9,1],yf=[1,.75,.2],xf=({onClose:n,onSubmit:e,opensOverDocument:t=!1,opensFromGutter:r=!1,gutterHasComments:o=!1},s)=>{const i=Yn(),l=b.useRef(null),a=b.useRef(!1),[c,u]=b.useState(""),[f,h]=b.useState(!0),p=()=>{u(""),n?.(a.current)},m=(k=c)=>{a.current=!0,e?.(k),u("")},y=Ji(({windowWidth:k})=>t?k<go+100?gf:go:_t,0),x={};r&&(x.top=-12),t&&r?x.right=0:x.left=0;let C="";r&&!t?C="8px 50%":r&&t?C="calc(100% + 8px) 50%":t&&(C="center left");let v=0;r&&!t&&o&&(v=Po);const T=k=>{const{metaKey:E,shiftKey:S,key:P}=k;P==="Enter"&&c&&!(S||E)?(m(),k.preventDefault()):P==="Escape"&&(u(""),n?.(!1))},A=i.formatMessage({id:"VvfbvY",defaultMessage:"Edit or explain..."});return g.jsx(Q.div,{ref:Uu(l,s),className:H("absolute flex items-center",Ee.commentComposer),style:{...x,minHeight:ai},transition:{type:"spring",bounce:.18,duration:.48},initial:{translateX:0},animate:{translateX:v},exit:{translateX:0},children:g.jsx(Q.div,{className:H("no-scrollbar relative z-10 flex items-center overflow-x-hidden border border-token-border-light",No,{"rounded-full":f,"rounded-2xl":!f}),initial:{width:t?_t:24,scaleX:t?yo:void 0,scale:t?void 0:yo},animate:{width:y,scaleX:t?xo:void 0,scale:t?void 0:xo},exit:{filter:"blur(16px)",scale:t?void 0:yf,width:t?_t:24,opacity:t?0:[1,1,0]},transition:{type:"spring",bounce:t?.14:0,duration:.28,scale:{type:"tween",duration:.2},opacity:{type:"tween",time:[0,.95,1]}},style:{transformOrigin:C},children:g.jsxs(Q.div,{className:"relative z-0 flex w-full items-center bg-token-main-surface-primary px-4 py-2.5",children:[g.jsx(Q.div,{className:"backdrop-saturate-25 absolute inset-0 z-[-1] bg-gray-50/75 backdrop-blur-3xl dark:bg-gray-700/75",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.2}}),g.jsx(Tl,{"aria-placeholder":A,value:c,className:"w-full resize-none border-0 bg-transparent px-1 py-0 pr-2 text-token-text-primary outline-0 placeholder:text-token-text-secondary focus:ring-0 focus-visible:ring-0",autoFocus:!0,maxRows:4,onBlur:p,onHeightChange:(k,{rowHeight:E})=>{h(Math.floor(k/E)<=1)},onChange:({target:{value:k}})=>u(k),onKeyDown:T}),!c&&g.jsx("span",{"aria-hidden":!0,className:"absolute inline-block text-nowrap pl-1 text-token-text-secondary",children:A}),g.jsx(Q.button,{className:H("-mr-1.5 h-6 w-6 rounded-full bg-black text-center dark:bg-white",{"self-end":!f}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},onMouseDown:()=>m(),children:g.jsx(gl,{className:"h-6 w-6 text-white dark:text-black"})})]})})})},ci=b.forwardRef(xf),bf=(n,e)=>{if(e?.type!==De.SELECTION)return null;try{const{from:t,to:r}=e,{top:o}=n.dom.getBoundingClientRect(),{bottom:s,top:i}=ht(n,t),{bottom:l}=ht(n,r),a=tn(n)?-30:-24;let c=s-o+a;const u=i-o;return c=l-o+8,{composerTop:c,loadingTop:u}}catch(t){return ie.logError("Invalid position in SelectionCommentComposer",t),null}},vf=({toolbarPosition:n,composerRect:e,view:t})=>{let{width:r,height:o}=e;if(o||=ai,t==null||n==null)return null;const{right:s,left:i}=t.dom.getBoundingClientRect(),{left:l,top:a,aboveOrBelow:c,toolbarSize:u}=n,f=a-(c===li.ABOVE&&o!==0?o-u.height:0),h=al(t)?12:0;return{left:Math.min(l,s-i-r-h),composerTop:f,aboveOrBelow:c}},Cf=({toolbarPosition:n,commentingOn:e,isWaitingForCommentResponse:t=!1,onAddComment:r})=>{const o=en()(),[s,i]=Jt(),l=vf({view:o,toolbarPosition:n,composerRect:s});if(o==null||l==null)return null;const{left:a,composerTop:c}=l,u=f=>{if(e?.type!==De.SELECTION)return;const{action:h,sourceRange:p}=e;r?.(f,h,p,e.type)};return g.jsx(We,{children:e?.type===De.SELECTION&&!t&&g.jsx("div",{className:H("absolute",Ee.commentComposer),style:{left:a,top:c},children:g.jsx(ci,{opensOverDocument:!0,onClose:f=>{f||(Z.cancelCommentingOn(),o&&tn(o)&&!o.state.selection.empty&&o.dispatch(o.state.tr.setSelection(new vl(o.state.selection.$from))),document.getSelection()?.removeAllRanges())},onSubmit:u,ref:i})},"composer")})};function ui(n,e){return e?n.getState(e)??null:null}function kf(n){return n.nodeSize-2}function Sf(n,e){return e>=0&&e<=kf(n)}class je{constructor(e,t,r={}){this.match=e,this.match=e,this.handler=typeof t=="string"?wf(t):t,this.undoable=r.undoable!==!1,this.inCode=r.inCode||!1}}function wf(n){return function(e,t,r,o){let s=n;if(t[1]){let i=t[0].lastIndexOf(t[1]);s+=t[0].slice(i+t[1].length),r+=i;let l=r-o;l>0&&(s=t[0].slice(i-l,i)+s,r=o)}return e.tr.insertText(s,r,o)}}const Af=500;function $d({rules:n}){let e=new Go({state:{init(){return null},apply(t,r){let o=t.getMeta(this);return o||(t.selectionSet||t.docChanged?null:r)}},props:{handleTextInput(t,r,o,s){return bo(t,r,o,s,n,e)},handleDOMEvents:{compositionend:t=>{setTimeout(()=>{let{$cursor:r}=t.state.selection;r&&bo(t,r.pos,r.pos,"",n,e)})}}},isInputRules:!0});return e}function bo(n,e,t,r,o,s){if(n.composing)return!1;let i=n.state,l=i.doc.resolve(e),a=l.parent.textBetween(Math.max(0,l.parentOffset-Af),l.parentOffset,null,"￼")+r;for(let c=0;c<o.length;c++){let u=o[c];if(l.parent.type.spec.code){if(!u.inCode)continue}else if(u.inCode==="only")continue;let f=u.match.exec(a),h=f&&u.handler(i,f,e-(f[0].length-r.length),t);if(h)return u.undoable&&h.setMeta(s,{transform:h,from:e,to:t,text:r}),n.dispatch(h),!0}return!1}new je(/--$/,"—");new je(/\.\.\.$/,"…");new je(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“");new je(/"$/,"”");new je(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘");new je(/'$/,"’");function Wd(n,e,t=null,r){return new je(n,(o,s,i,l)=>{let a=t instanceof Function?t(s):t,c=o.tr.delete(i,l),u=c.doc.resolve(i),f=u.blockRange(),h=f&&Cl(f,e,a);if(!h)return null;c.wrap(f,h);let p=c.doc.resolve(i-1).nodeBefore;return p&&p.type==e&&kl(c.doc,i-1)&&(!r||r(s,p))&&c.join(i-1),c})}function Ef(n,e,t=null){return new je(n,(r,o,s,i)=>{let l=r.doc.resolve(s),a=t instanceof Function?t(o):t;return l.node(-1).canReplaceWith(l.index(-1),l.indexAfter(-1),e)?r.tr.delete(s,i).setBlockType(s,s,e,a):null})}function xr(n,e,t,r={}){if(n==null)return null;const o=(Array.isArray(t)?t:[t]).filter(Gi),s=e.nodes[n].createAndFill(r,o);return s??null}const Tf={content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM(){return["p",0]}},Nf="paragraph";class fi extends nn{unistNodeName(){return Nf}static proseMirrorNodeName(){return"paragraph"}proseMirrorNodeSpec(){return Tf}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return xr(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}const Pf=(n,e,t,r)=>n.value?e.text(n.value,[e.marks.startend.create(t),...r??[]]):null;class If extends nn{unistNodeName(){return"text"}static proseMirrorNodeName(){return"text"}proseMirrorNodeSpec(){return{group:"inline"}}unistNodeToProseMirrorNodes({node:e,schema:t,attrs:r}){return Pf(e,t,r)}proseMirrorNodeToUnistNodes(e){return[{type:this.unistNodeName(),value:e.text??""}]}}class Ze extends nn{static isAtStart(e,t){return e.selection.empty?t!==void 0?t.endOfTextblock("backward",e):e.selection.$anchor.parentOffset>0:!1}static headingLevelCommandBuilder(e,t,r){return(o,s,i)=>{if(r&&!Ze.isAtStart(o,i))return!1;const{$anchor:l}=o.selection,a=l.parent;if(a.type.name!=="heading")return!1;const c=a.attrs.level+t;if(c<0||c>6)return!1;if(s===void 0)return!0;const u=l.before(l.depth);return c>0?s(o.tr.setNodeMarkup(u,void 0,{level:c})):s(o.tr.setNodeMarkup(u,e.nodes.paragraph)),!0}}dependencies(){return[new fi,new If]}unistNodeName(){return"heading"}static proseMirrorNodeName(){return"heading"}proseMirrorNodeSpec(){return{attrs:{level:{default:1}},content:"text*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM(e){return["h"+e.attrs.level.toString(),0]}}}proseMirrorInputRules(e){return[Ef(/^\s{0,3}(#{1,6})\s$/,e.nodes[this.proseMirrorNodeName()],t=>({level:t[1].length}))]}proseMirrorKeymap(e){const t={Tab:Ze.headingLevelCommandBuilder(e,1,!1),"#":Ze.headingLevelCommandBuilder(e,1,!0),"Shift-Tab":Ze.headingLevelCommandBuilder(e,-1,!1)};for(let r=1;r<=6;r++)t[`Shift-Mod-${r.toString()}`]=bl(e.nodes[this.proseMirrorNodeName()],{level:r});return t}unistNodeToProseMirrorNodes({node:e,schema:t,convertedChildren:r,attrs:o}){const{depth:s}=e;return xr(this.proseMirrorNodeName(),t,r,{...o,level:s})}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),depth:e.attrs.level,children:t}]}}class Mf extends nn{unistNodeName(){return"root"}static proseMirrorNodeName(){return"doc"}proseMirrorNodeSpec(){return{content:"block+"}}unistNodeToProseMirrorNodes({schema:e,convertedChildren:t,attrs:r}){return xr(this.proseMirrorNodeName(),e,t,r)}proseMirrorNodeToUnistNodes(e,t){return[{type:this.unistNodeName(),children:t}]}}function Un(n,e,t=0,r=null){let o=!1;return n.forEach((s,i)=>{Un(s,e,t+i+(n.type.name===Mf.proseMirrorNodeName()?0:1),n)===!1&&(o=!0)}),o?o?!1:void 0:e(n,t,r)}function Of(n,e){const t=new Array(e.length).fill(-1),r=()=>!t.includes(-1);let o=!1;const s=(i,l)=>{const a=cl(i);if(a==null)return;const{start:c,end:u}=a;for(let f=0;f<e.length;f++){const h=e[f];t[f]===-1&&(h>=c&&h<u&&(i.type.name!=="doc"||o)||h==u&&o||h<c&&h<u&&o&&h>=0)&&(h===u&&(t[f]=l+i.nodeSize),i.content.size===0&&(i.text?.length??0)===0?t[f]=l:t[f]=Math.min(l+Math.max(h-c,0),l+i.nodeSize))}if(r())return!1};Un(n,s),o=!0,r()||Un(n,s);for(let i=0;i<t.length;i++)t[i]===-1&&(e[i]<=0?t[i]=0:t[i]=n.nodeSize-2);return t}function _f(n,e){const t=Rf(n);if(t.length===0)return e;let r=e;return t.forEach(o=>{r=Df(o,r)}),r}function Df(n,e){return ul(e,{start:n.from,end:n.to},Lf(n))}function Lf(n){return n.slice.size-(n.to-n.from)}function Rf(n){return n.steps.filter(e=>e instanceof Sl)}const Yt=new wl("comments");function vo(n,e){const t=e.map(s=>s.at.start),r=e.map(s=>s.at.end),o=Of(n,[...t,...r]);return new Map(e.map((s,i)=>[s.id,{start:o[i],end:o[i+e.length]}]))}function Bf(n,e){const{type:t}=e;if(t===De.SELECTION){const{from:s,to:i}=e;return[s,i]}const{pos:r}=e,o=r+(n.nodeAt(r)?.nodeSize??0);return[r,o]}const Co=(n,e,t=null,r=null)=>{const o=[],s=Array.from(e.entries()).reverse(),i=new Map(n.map(l=>[l.id,l]));for(const[l,a]of s){const c=i.get(l),h=hl({isHovered:t===l,isFocused:r===l,isCode:!1,diffStatus:c?.diffStatus});o.push(Ho.inline(a.start,a.end,{class:h,"data-comment-id":l,nodeName:"span"}))}return o},Kd=n=>new Go({key:Yt,state:{init:(e,{doc:t})=>{const r=vo(t,n);return{comments:n,commentingOn:null,hoveredOnBlock:null,hoveredCommentId:null,focusedCommentId:null,decorations:Co(n,r),positions:r}},apply:(e,t)=>{const r=e.getMeta(Yt)??{},o=r.comments,s=o??t.comments,i=o!=null?vo(e.doc,s):t.positions;let l=r.commentingOn;l===void 0&&(l=t.commentingOn);let a=r.hoveredCommentId;a===void 0&&(a=t.hoveredCommentId);let c=r.focusedCommentId;c===void 0&&(c=t.focusedCommentId);const u=_f(e,i),f=fl(s,u);return{comments:f,commentingOn:l,hoveredCommentId:a,focusedCommentId:c,decorations:Co(f,u,a,c),positions:u}}},props:{handleClickOn:(e,t,r,o,s)=>{const{target:i}=s;if(i instanceof HTMLElement){const{commentId:l}=i.dataset;if(!l)return;Z.focusComment(l)}},handleDOMEvents:{mouseover(e,t){const{target:r}=t;if(r instanceof HTMLElement){const{commentId:o}=r.dataset;o?Z.mouseEnterComment(o):Z.mouseLeaveComment()}}},decorations(e){const t=this.getState(e);if(!t)return Or.empty;const{commentingOn:r,decorations:o}=t,{doc:s}=e;if(r){const[i,l]=Bf(s,r);i!=null&&l!=null&&o.push(Ho.inline(i,l,{class:Hi.document},{comment:{pattern:r}}))}return Or.create(s,o.concat())}}});function jf(n,e,t){const r=n+e;for(const o of t.values()){const s=o.start,i=o.end;if(n<i&&s<r)return!0}return!1}const Ff=50,Vf=200,Gf=[fi.proseMirrorNodeName(),Ze.proseMirrorNodeName()],Hf=n=>n?n.isBlock:!1,zf=n=>{if(!n)return!1;const{isBlock:e,type:{name:t}}=n;return e&&Gf.includes(t)},Uf=(n,e,t,r)=>{const o=n.posAtCoords({left:e,top:t});if(o==null)return;const{pos:s,inside:i}=o;if(i===-1)return;const{state:l}=n;let a=s,c=l.doc.nodeAt(a);for(;!Hf(c)&&a>=0;)a--,c=l.doc.nodeAt(a);if(!c||!zf(c))return;const u=r!=null&&jf(a,c.nodeSize,r);return{node:c,nodeHasComment:u,pos:a}};function $f(n,e,t){const r=Uf(n,e.x,e.y,t);if(r==null)return null;const{node:o,pos:s,nodeHasComment:i}=r,{top:l}=n.coordsAtPos(0);function a(){const p=s+1;return Sf(n.state.doc,p)&&n.state.doc.nodeAt(p)?.isText?n.coordsAtPos(p).top:n.coordsAtPos(s).top}const c=a(),u=c-l;return{height:n.coordsAtPos(s+o.nodeSize-1).bottom-c,nodeHasComment:i,mouseEnteredAt:Date.now(),yOffset:u,pos:s}}function Wf(n){const e=b.useRef(!1),t=b.useRef(!1),[r,o]=b.useState(null),s=dl(),i=s()?.dom,l=b.useRef(!1),a=Ae(({visibleBlockCommentLauncher_DEBUG_ONLY:f})=>f),c=b.useCallback(zi(f=>{e.current=!0;const{commentingOn:h}=Ae.getState();if(t.current||h!=null)return;const p=s();if(p==null||!e.current)return o(null);const{dom:m,state:y}=p,x=ui(Yt,y)?.positions;if(x==null)return o(null);const C=$f(p,f,x);if(C==null||C.nodeHasComment&&n===fe.COLLAPSED){o(null);return}if(l.current&&C.yOffset!==r?.yOffset){o(null);return}const v=p.coordsAtPos(0),T=m.getBoundingClientRect().width,k=(f.x-v.left)/T>=Ff/100;o(k?C:null)},Vf),[s,l,r]);b.useEffect(()=>{if(i!=null)return Mo(i,{mouseenter:()=>{e.current=!0,t.current=!1},mouseleave:({relatedTarget:f})=>{if(c.cancel(),f instanceof HTMLElement&&f.closest("[data-block-comment-launcher]")){t.current=!0;return}t.current=!1,e.current=!1,Ae.getState().commentingOn==null&&o(null)},mousemove:c})},[s,i,n,c]);const u=b.useCallback(({relatedTarget:f})=>{const{commentingOn:h}=Ae.getState();h==null&&f!==i&&(t.current=!1,o(null))},[i]);return{visibleBlockComment:a??r,handleMouseLeave:u,onComposerVisibleChange:f=>{l.current=f}}}const Kf=({isWaitingForCommentResponse:n=!1,opensOverDocument:e=!1,hasComments:t=!1,activeBlockComment:r,composerRef:o,onLaunchComposer:s,onMouseLeave:i,onSubmit:l})=>{const[a,c]=b.useState(!1),{yOffset:u,height:f,pos:h}=r,p=()=>{c(!0),s?.(),ie.logButtonClick(qe.BLOCK_COMMENT_LAUNCHER),Z.startCommentingOn({type:De.BLOCK,pos:h})},m=C=>{C||(c(!1),Z.cancelCommentingOn())},y=C=>{c(!1),l?.(C)};b.useEffect(()=>()=>{Z.mouseLeaveBlock()},[]);const x=t&&a?e?-88:88:0;return g.jsx(Q.div,{className:H("pointer-events-auto absolute flex h-6 w-5 origin-[14px_50%] items-start after:absolute after:-inset-4 after:content-['']",Ee.commentComposer),initial:!1,animate:{opacity:1},exit:{opacity:0},transition:{type:"spring",duration:.2,bounce:.1},style:{top:0,height:f,translateY:u},onMouseLeave:i,"data-block-comment-launcher":!0,children:g.jsxs(We,{children:[a?g.jsx(ci,{ref:o,opensFromGutter:!0,onClose:m,onSubmit:y,gutterHasComments:t,opensOverDocument:e},"composer"):null,g.jsx(Q.button,{initial:{opacity:0},animate:{opacity:a?0:1,translateX:x},transition:{duration:.15,translateX:{type:"spring",bounce:.18,duration:.48}},className:"group absolute z-10 flex h-6 gap-1 bg-transparent after:absolute after:-inset-y-4 after:-left-1 after:-right-4 after:content-['']",onClick:p,onMouseEnter:()=>Z.mouseEnterBlock(h),onMouseLeave:()=>Z.mouseLeaveBlock(),disabled:a||n,children:g.jsx(pf,{isLoading:n})},"launcer")]})})},Yf=({isWaitingForCommentResponse:n=!1,isRequestActive:e=!1,hasComments:t=!1,composerRef:r,gutterMode:o,onAddComment:s})=>{const i=Fo(),{visibleBlockComment:l,handleMouseLeave:a,onComposerVisibleChange:c}=Wf(o),u=f=>{if(!l||!i)return;const{doc:h}=i,{pos:p}=l,m=h.nodeAt(p);if(!m)return;const{attrs:{start:y,end:x}}=m;s?.(f,Vo.ASK,{start:y,end:x},De.BLOCK)};return g.jsx(We,{onExitComplete:()=>c(!1),children:l&&i&&(n||!e)&&g.jsx(Kf,{composerRef:r,isWaitingForCommentResponse:n,opensOverDocument:o===fe.COLLAPSED,activeBlockComment:l,hasComments:t,onSubmit:u,onMouseLeave:a,onLaunchComposer:()=>c(!0)},"launcher")})},hi={type:"spring",bounce:.12,duration:.5},di="opacity-50",Xf=({count:n,offsetY:e,isLoading:t=!1,onClick:r})=>g.jsx(Q.div,{className:H("absolute",Ee.collapsedComment),initial:{opacity:0},animate:{opacity:1},style:{translateY:e},transition:hi,exit:{opacity:0},children:g.jsx(df,{count:n,isLoading:t,onClick:r})}),qf=({isFocused:n,isHovered:e})=>{const t=n||e?"grow font-medium text-token-text-primary transition-colors":"grow font-medium text-token-text-secondary transition-colors",r=n||e?"opacity-100 transition":"opacity-75 transition";return g.jsxs(g.Fragment,{children:[g.jsx("div",{className:r,children:g.jsx("div",{className:"gizmo-bot-avatar rounded-full",children:g.jsx(Ui,{size:"gizmoConversation",iconName:"openai"})})}),g.jsx("span",{className:t,children:"ChatGPT"})]})},Jf=({comment:n,isFocused:e,isSomeCommentFocused:t,isHovered:r})=>{const o=n.diffStatus===Nn.REMOVED;return g.jsx("div",{className:H("mt-2 text-token-text-primary transition-all",{"opacity-80":!e&&!t&&!r&&!o,"opacity-40":!e&&t&&!r&&!o,[di]:o}),children:n.content})},Zf=({left:n,right:e,comment:t,disableAnimations:r=!1,onClick:o,onMouseEnter:s,onMouseLeave:i,onAccept:l,onDismiss:a,translateY:c,isFocused:u=!1,isSomeCommentFocused:f=!1,disableActions:h=!1,isHovered:p=!1},m)=>{const[y,x]=b.useState(!1),C=t.diffStatus===Nn.ADDED,v=t.diffStatus===Nn.REMOVED,T=t.diffStatus!=null,A=()=>{x(!0),s?.()},k=()=>{x(!1),i?.()},E=Yn(),S=u||y&&!f;return g.jsx(Q.div,{ref:m,className:H("absolute",Ee.expandedComment,{"cursor-default":u,"cursor-pointer":!u,[Ee.expandedCommentFocused]:u,[Ee.expandedCommentHovered]:p}),style:{left:n,right:e},initial:r?!1:{translateY:c,scale:.85,opacity:0},animate:r?void 0:{translateY:c,scale:u?1:.97,opacity:1},exit:r?void 0:{scale:.85,opacity:0,filter:"blur(16px)"},transition:hi,onClick:o,onMouseEnter:h?void 0:A,onMouseLeave:h?void 0:k,"data-comment-id":t.id,children:g.jsxs("div",{className:H("flex min-h-8 flex-col overflow-hidden rounded-2xl border p-4 pt-2 text-left text-sm transition-all",{"border-transparent bg-gray-50 dark:bg-gray-800":!u&&!p,"border-token-border-light bg-token-main-surface-primary":p&&!u,"border-token-border-light bg-token-main-surface-primary shadow-xl":u||y&&!f,"relative after:absolute after:bottom-0 after:left-0 after:top-0 after:w-1":T,"after:bg-green-500":C,"after:bg-red-500":v}),style:{width:_t},children:[g.jsxs("div",{className:H("flex h-8 flex-row items-center gap-2.5",{[di]:v}),children:[g.jsx(qf,{isFocused:u,isHovered:p}),g.jsx("button",{className:H("-mr-1 rounded-full bg-transparent p-1 text-token-text-secondary",{"cursor-pointer hover:bg-gray-100 hover:text-token-text-primary dark:hover:bg-gray-700":!h,"cursor-not-allowed":h}),onClick:a,disabled:h,"aria-label":E.formatMessage({id:"fYDa3C",defaultMessage:"Dismiss comment"}),children:g.jsx(yl,{className:"icon-sm"})})]}),g.jsx(Jf,{comment:t,isFocused:u,isHovered:p,isSomeCommentFocused:f}),g.jsx(We,{initial:!1,children:S&&g.jsx(Q.div,{initial:r?!1:{opacity:0,height:0},animate:{opacity:1,height:"auto",transition:{opacity:{delay:.14,duration:.2},height:{bounce:0,duration:.2}}},exit:r?void 0:{opacity:0,height:0,transition:{opacity:{duration:.08},height:{bounce:0,duration:.2}}},className:"flex items-center justify-start",children:g.jsx("div",{className:"mt-2.5",children:g.jsx(Zi,{color:"secondary",onClick:l,disabled:h,children:E.formatMessage({id:"WIW5OL",defaultMessage:"Apply"})})})})})]})})},pi=b.forwardRef(Zf),Qf=({offsetY:n,opensOverDocument:e=!1,disableActions:t=!1,isFocused:r=!1,isSomeCommentFocused:o=!1,onAccept:s,onClick:i,onDismiss:l,onMouseEnter:a,onMouseLeave:c,comment:u,isHovered:f=!1})=>{const h=b.useRef(null);return b.useEffect(()=>Mo(document,{mousedown:({target:p})=>{p instanceof HTMLElement&&!p.closest("[data-comment-id]")&&!h.current?.contains(p)&&Z.blurComment()}})),g.jsx(pi,{ref:h,comment:u,disableActions:t,onAccept:s,onDismiss:l,onMouseEnter:a,onMouseLeave:c,isSomeCommentFocused:o,isHovered:f,onClick:i,translateY:n,isFocused:r,left:e?void 0:Po,right:e?$i:void 0})},eh=({onAcceptComment:n,onDismissComment:e,disableActions:t=!1,entry:r,isGutterCollapsed:o=!1,isHovered:s=!1,isFocused:i=!1,isSomeCommentFocused:l=!1})=>{const{offsetY:a,type:c}=r,[u,f]=Wi();let h=null;if(c===$.COLLAPSED)h=!i&&g.jsx(Xf,{offsetY:a,count:r.count,onClick:()=>{ie.logButtonClick(qe.COLLAPSED_COMMENT),Z.focusComment(r.children[0])}},"collapsed");else{const{comment:p}=r;if(p==null||p.content===""||p.status===Nr.DISMISSED)h=null;else if(p.status===Nr.ACCEPT_INITIATED)h=g.jsx("div",{className:"absolute",style:{top:a},children:g.jsx(hn,{})},"loading");else{const{id:m}=p;h=g.jsx(Qf,{isSomeCommentFocused:l,isHovered:s,isFocused:i,offsetY:a,disableActions:t,onClick:()=>{ie.logButtonClick(qe.EXPANDED_COMMENT),Z.focusComment(m)},onMouseEnter:()=>Z.mouseEnterComment(m),onMouseLeave:()=>Z.mouseLeaveComment(),comment:p,onAccept:()=>{ie.logButtonClick(qe.COMMENT_ACCEPT,{commentId:m}),n?.(m)},onDismiss:()=>{ie.logButtonClick(qe.COMMENT_DISMISS,{commentId:m}),e?.(m)},opensOverDocument:o},"expanded")}}return g.jsx(We,{onExitComplete:()=>f?.(),children:u&&h})},ko=({onMeasureHeight:n,comment:e,isFocused:t=!1})=>{const[{height:r},o]=Jt();return Oo(()=>{n?.(r)},[r]),g.jsx(pi,{ref:o,comment:e,isFocused:t,disableAnimations:!0})},th=({comments:n,onMeasure:e,getStableCommentId:t})=>{const r=b.useRef(new Map),o=b.useRef(new Map),s=b.useRef(null),i=(l,a,c=!1)=>{a&&(c?o.current.set(t(l),a):r.current.set(t(l),a),s.current&&cancelAnimationFrame(s.current),s.current=requestAnimationFrame(()=>{e?.({focusedHeights:new Map(o.current),heights:new Map(r.current)}),s.current=null}))};return n?.length?g.jsxs("div",{className:"pointer-events-none invisible fixed left-0 top-0 overflow-clip","aria-hidden":"true",children:[n.map(l=>g.jsx(ko,{comment:l,onMeasureHeight:a=>i(l.id,a)},t(l.id))),n.map(l=>g.jsx(ko,{isFocused:!0,comment:l,onMeasureHeight:a=>i(l.id,a,!0)},`${t(l.id)}-focused`))]}):null},So=(n,e,t)=>{let r=t+e;for(;e===Oe.down?r<n.length:r>-1;){const o=n[r],s=n[r-e],i=mf(nt(o),nt(s),e);if(i!=null&&o.type!==$.COLLAPSED)o.shiftY+=i;else break;r+=e}},wo=(n,e)=>{for(const t of e){const{index:r,amount:o}=t,s=n[r];s.type===$.EXPANDED&&(s.shiftY+=o),So(n,Oe.down,r),So(n,Oe.up,r);for(const i of n)i.type!==$.COLLAPSED&&(i.offsetY+=i.shiftY,i.shiftY=0)}},nh=(n,e)=>{const t=[],[r,o]=e,s=r+o;for(let i=0;i<n.length;i++){const l=n[i],[a]=nt(l),c=[a,l.type===$.EXPANDED?l.height:0],[u,f]=c;if(ii(c,e)){const h=u+f,p=r-h,m=s-u,x=(Math.abs(p)<Math.abs(m)?Oe.up:Oe.down)===Oe.up?p:m;t.push({index:i,amount:x})}}return t},rh=({gutterMode:n,focusedCommentId:e,gutterPositions:t,getCommentKey:r,getComment:o})=>{if(!t?.size)return[];const s=new Map,i=[];let l=null,a=-1;for(const u of t.values()){if(u.type===Kt.COMPOSER){l=[u.offsetY,u.height];continue}const{commentId:f,height:h,collapsedOffsetY:p,offsetY:m}=u;if(n===fe.EXPANDED){const C=Pn(i),v=C?zn(nt(C)):0;let T=m;C&&T<=v&&(T=v),s.set(f,{originalOffsetY:m,offsetY:T}),e===f&&(a=i.length),i.push({key:r(f),comment:o(f),type:$.EXPANDED,height:h,offsetY:T,shiftY:0});continue}let y=i.findIndex(({offsetY:C,type:v})=>v===$.COLLAPSED&&C===p),x=i[y]??null;if(!x)x={key:i.length,type:$.COLLAPSED,offsetY:m,count:1,children:[f]},y=i.length,i.push(x);else{if(x.type!==$.COLLAPSED)throw new Error("Collapsed parent type expected to be collapsed");x.count+=1,x.children.push(f),x.offsetY=p}e===f&&(a=y)}const c=i[a];if(n===fe.COLLAPSED&&c?.type===$.COLLAPSED){const u=[];for(let f=0;f<c.children.length;f++){const h=c.children[f];h===e&&(a+=f+1);const p=Pn(u),m=p?zn(nt(p)):0,y=t.get(h)?.offsetY??0,x=Math.max(m,y);s.set(h,{originalOffsetY:y,offsetY:x}),u.push({type:$.EXPANDED,key:r(h),comment:o(h),offsetY:x,height:t.get(h)?.height??0,shiftY:0})}i.splice(a,0,...u)}if(e){const u=s.get(e);if(!u)return i;const{offsetY:f,originalOffsetY:h}=u,p=h-f,m=[{amount:p,index:a}];let y=a+1;for(;y<i.length;){const x=i[y],{type:C}=x;let v=p;if(C===$.EXPANDED&&x.comment?.id){const{offsetY:T,originalOffsetY:A}=jt(s.get(x.comment.id));if(T===A)break;v=Math.max(A-T,p)}else break;m.push({amount:v,index:y}),y++}m.length&&wo(i,m)}else if(n!==fe.COLLAPSED&&l){const u=nh(i,l);wo(i,u)}return i},oh=n=>{try{return rh(n)}catch(e){return ie.logError("Generating comment gutter entries",e),[]}},sh=n=>"length"in n?n.length===0:n.nodeSize===0,En=12,ih=({composerHeight:n,getCommentHeight:e,getCollapsedStartPos:t,commentingOn:r,commentPositions:o,view:s})=>{if(!o||!s||sh(s.state.doc))return null;const{top:i}=s.dom.getBoundingClientRect(),l=Array.from(o.entries()).sort(([c,u],[f,h])=>u.start-h.start),a=new Map;for(const[c,{start:u}]of l)try{const f=t?.(u)??u,{top:h}=ht(s,f),{top:p}=ht(s,u),m=p-i,y=h-i,x=(e(c)??0)+En;a.set(c,{commentId:c,height:x,collapsedOffsetY:y,offsetY:m,type:Kt.COMMENT})}catch{continue}if(r?.type===De.BLOCK){const{pos:c}=r;try{const{top:u}=ht(s,c),h=u-i-En;a.set("block-composer",{type:Kt.COMPOSER,height:(n??0)+En,offsetY:h})}catch{}}return a},mi=(n,e)=>e.nodeAt(n)?.isBlock?n+1:mi(n-1,e);function lh(n){const e=Fo(),r=en()?.();if(!r)return null;if(tn(r)){if(!e)return null;const o=ui(Yt,e);return o?o.positions:null}return new Map(n.map(o=>[o.id,o.at]))}const ah=({gutterMode:n,focusedCommentId:e,commentingOn:t,comments:r,getStableId:o})=>{const[{height:s},i]=Jt(),l=en(),[a,c]=b.useState(()=>new Map),[u,f]=b.useState(()=>new Map),h=b.useCallback(({focusedHeights:A,heights:k})=>{c(A),f(k)},[]),p=A=>{const k=o(A);return A===e?a.get(k)??0:u.get(k)??0},m=l(),y=m!=null&&tn(m)?A=>mi(A,m.state.doc):void 0,x=new Map(r?.map(A=>[o(A.id),A])),C=lh(r),v=ih({composerHeight:s,commentingOn:t,getCommentHeight:p,getCollapsedStartPos:y,commentPositions:C,view:m}),T=oh({gutterMode:n,gutterPositions:v,focusedCommentId:e,getComment:A=>x.get(o(A))??null,getCommentKey:o});return{blockComposerRef:i,onMeasureComments:h,gutterEntries:T}};function ch(){const e=en()(),t=Ae(({commentingOn:s})=>s),o=e==null?null:bf(e,t);return o==null?null:g.jsx(Q.div,{className:"absolute",style:{top:o.loadingTop},initial:!1,animate:{opacity:1,scale:1},exit:{opacity:0,scale:0},transition:{delay:.2},children:g.jsx(hn,{})},"selection-loading")}const uh=n=>g.jsx("div",{className:"absolute",style:{top:zn(nt(n))},children:g.jsx("div",{className:"h-[max(3rem,18vh)] w-1"})}),Yd=({availableWidth:n,comments:e,commentsMode:t,disableBlockComments:r=!1,isRequestActive:o=!1,isWaitingForCommentResponse:s=!1,onAddComment:i,onAcceptComment:l,onDismissComment:a,getStableCommentId:c})=>{const u=Ae(({focusedCommentId:S})=>S),f=Ae(({hoveredCommentId:S})=>S),h=Ae(({commentingOn:S})=>S),p=n<Pr?fe.COLLAPSED:fe.EXPANDED,{onMeasureComments:m,blockComposerRef:y,gutterEntries:x}=ah({comments:e,getStableId:c,gutterMode:p,focusedCommentId:u,commentingOn:h}),C=x.length>0,v=h!=null&&!s&&h.type!=="selection"||C,A=(()=>{if(!v)return 0;switch(p){case fe.COLLAPSED:return 0;case fe.EXPANDED:return Pr}})(),k=h?.type==="selection",E=Pn(x);return g.jsxs(Q.div,{className:H("pointer-events-none relative flex h-full flex-shrink-0",Ee.commentGutter,p===fe.COLLAPSED&&A?"basis-[32px]":"basis-0"),initial:{width:0,opacity:0},animate:{width:A,opacity:1},exit:{width:0,opacity:0},children:[g.jsx(th,{getStableCommentId:c,comments:e,onMeasure:m}),g.jsxs("div",{className:H("pointer-events-auto absolute bottom-0 left-0 top-0 w-0 overflow-visible",{"pl-2":v||!r}),children:[g.jsx(We,{children:x.map(S=>{const{key:P,type:R}=S,_=!!u&&R===$.EXPANDED&&S.comment?.id===u,I=!!u&&S.type===$.COLLAPSED&&S.children.includes(u);return g.jsx(eh,{isGutterCollapsed:p===fe.COLLAPSED,isSomeCommentFocused:!!h||!!u,isHovered:R===$.EXPANDED&&S.comment?.id===f,isFocused:_||I,entry:S,disableActions:o||s||t===Ir.COMMENTS_READONLY,onAcceptComment:N=>{try{l?.(jt(e?.find(D=>D.id===N)))}catch(D){ie.logError(`Comment ${N} not found`,D)}},onDismissComment:N=>{try{a?.(jt(e?.find(D=>D.id===N)))}catch(D){ie.logError(`Comment ${N} not found`,D)}}},P)})}),C&&E&&g.jsx(uh,{...E}),t===Ir.ENABLED&&!k&&!r&&g.jsx(Yf,{composerRef:y,gutterMode:p,onAddComment:i,isWaitingForCommentResponse:s,isRequestActive:o,hasComments:C}),s&&k&&g.jsx(ch,{})]})]})};function _e(n,e,{checkForDefaultPrevented:t=!0}={}){return function(o){if(n?.(o),t===!1||!o.defaultPrevented)return e?.(o)}}function dn(n,e=[]){let t=[];function r(s,i){const l=b.createContext(i),a=t.length;t=[...t,i];function c(f){const{scope:h,children:p,...m}=f,y=h?.[n][a]||l,x=b.useMemo(()=>m,Object.values(m));return g.jsx(y.Provider,{value:x,children:p})}function u(f,h){const p=h?.[n][a]||l,m=b.useContext(p);if(m)return m;if(i!==void 0)return i;throw new Error(`\`${f}\` must be used within \`${s}\``)}return c.displayName=s+"Provider",[c,u]}const o=()=>{const s=t.map(i=>b.createContext(i));return function(l){const a=l?.[n]||s;return b.useMemo(()=>({[`__scope${n}`]:{...l,[n]:a}}),[l,a])}};return o.scopeName=n,[r,fh(o,...e)]}function fh(...n){const e=n[0];if(n.length===1)return e;const t=()=>{const r=n.map(o=>({useScope:o(),scopeName:o.scopeName}));return function(s){const i=r.reduce((l,{useScope:a,scopeName:c})=>{const f=a(s)[`__scope${c}`];return{...l,...f}},{});return b.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return t.scopeName=e.scopeName,t}function hh(n,e){typeof n=="function"?n(e):n!=null&&(n.current=e)}function gi(...n){return e=>n.forEach(t=>hh(t,e))}function $n(...n){return b.useCallback(gi(...n),n)}var Xt=b.forwardRef((n,e)=>{const{children:t,...r}=n,o=b.Children.toArray(t),s=o.find(ph);if(s){const i=s.props.children,l=o.map(a=>a===s?b.Children.count(i)>1?b.Children.only(null):b.isValidElement(i)?i.props.children:null:a);return g.jsx(Wn,{...r,ref:e,children:b.isValidElement(i)?b.cloneElement(i,void 0,l):null})}return g.jsx(Wn,{...r,ref:e,children:t})});Xt.displayName="Slot";var Wn=b.forwardRef((n,e)=>{const{children:t,...r}=n;if(b.isValidElement(t)){const o=gh(t);return b.cloneElement(t,{...mh(r,t.props),ref:e?gi(e,o):o})}return b.Children.count(t)>1?b.Children.only(null):null});Wn.displayName="SlotClone";var dh=({children:n})=>g.jsx(g.Fragment,{children:n});function ph(n){return b.isValidElement(n)&&n.type===dh}function mh(n,e){const t={...e};for(const r in e){const o=n[r],s=e[r];/^on[A-Z]/.test(r)?o&&s?t[r]=(...l)=>{s(...l),o(...l)}:o&&(t[r]=o):r==="style"?t[r]={...o,...s}:r==="className"&&(t[r]=[o,s].filter(Boolean).join(" "))}return{...n,...t}}function gh(n){let e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?n.ref:(e=Object.getOwnPropertyDescriptor(n,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?n.props.ref:n.props.ref||n.ref)}function yh(n){const e=n+"CollectionProvider",[t,r]=dn(e),[o,s]=t(e,{collectionRef:{current:null},itemMap:new Map}),i=p=>{const{scope:m,children:y}=p,x=U.useRef(null),C=U.useRef(new Map).current;return g.jsx(o,{scope:m,itemMap:C,collectionRef:x,children:y})};i.displayName=e;const l=n+"CollectionSlot",a=U.forwardRef((p,m)=>{const{scope:y,children:x}=p,C=s(l,y),v=$n(m,C.collectionRef);return g.jsx(Xt,{ref:v,children:x})});a.displayName=l;const c=n+"CollectionItemSlot",u="data-radix-collection-item",f=U.forwardRef((p,m)=>{const{scope:y,children:x,...C}=p,v=U.useRef(null),T=$n(m,v),A=s(c,y);return U.useEffect(()=>(A.itemMap.set(v,{ref:v,...C}),()=>void A.itemMap.delete(v))),g.jsx(Xt,{[u]:"",ref:T,children:x})});f.displayName=c;function h(p){const m=s(n+"CollectionConsumer",p);return U.useCallback(()=>{const x=m.collectionRef.current;if(!x)return[];const C=Array.from(x.querySelectorAll(`[${u}]`));return Array.from(m.itemMap.values()).sort((A,k)=>C.indexOf(A.ref.current)-C.indexOf(k.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:i,Slot:a,ItemSlot:f},h,r]}var xh=globalThis?.document?b.useLayoutEffect:()=>{},bh=Qi.useId||(()=>{}),vh=0;function Ch(n){const[e,t]=b.useState(bh());return xh(()=>{t(r=>r??String(vh++))},[n]),e?`radix-${e}`:""}var kh=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ne=kh.reduce((n,e)=>{const t=b.forwardRef((r,o)=>{const{asChild:s,...i}=r,l=s?Xt:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g.jsx(l,{...i,ref:o})});return t.displayName=`Primitive.${e}`,{...n,[e]:t}},{});function br(n){const e=b.useRef(n);return b.useEffect(()=>{e.current=n}),b.useMemo(()=>(...t)=>e.current?.(...t),[])}function pn({prop:n,defaultProp:e,onChange:t=()=>{}}){const[r,o]=Sh({defaultProp:e,onChange:t}),s=n!==void 0,i=s?n:r,l=br(t),a=b.useCallback(c=>{if(s){const f=typeof c=="function"?c(n):c;f!==n&&l(f)}else o(c)},[s,n,o,l]);return[i,a]}function Sh({defaultProp:n,onChange:e}){const t=b.useState(n),[r]=t,o=b.useRef(r),s=br(e);return b.useEffect(()=>{o.current!==r&&(s(r),o.current=r)},[r,o,s]),t}var wh=b.createContext(void 0);function vr(n){const e=b.useContext(wh);return n||e||"ltr"}var Tn="rovingFocusGroup.onEntryFocus",Ah={bubbles:!1,cancelable:!0},mn="RovingFocusGroup",[Kn,yi,Eh]=yh(mn),[Th,gn]=dn(mn,[Eh]),[Nh,Ph]=Th(mn),xi=b.forwardRef((n,e)=>g.jsx(Kn.Provider,{scope:n.__scopeRovingFocusGroup,children:g.jsx(Kn.Slot,{scope:n.__scopeRovingFocusGroup,children:g.jsx(Ih,{...n,ref:e})})}));xi.displayName=mn;var Ih=b.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,orientation:r,loop:o=!1,dir:s,currentTabStopId:i,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:a,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...f}=n,h=b.useRef(null),p=$n(e,h),m=vr(s),[y=null,x]=pn({prop:i,defaultProp:l,onChange:a}),[C,v]=b.useState(!1),T=br(c),A=yi(t),k=b.useRef(!1),[E,S]=b.useState(0);return b.useEffect(()=>{const P=h.current;if(P)return P.addEventListener(Tn,T),()=>P.removeEventListener(Tn,T)},[T]),g.jsx(Nh,{scope:t,orientation:r,dir:m,loop:o,currentTabStopId:y,onItemFocus:b.useCallback(P=>x(P),[x]),onItemShiftTab:b.useCallback(()=>v(!0),[]),onFocusableItemAdd:b.useCallback(()=>S(P=>P+1),[]),onFocusableItemRemove:b.useCallback(()=>S(P=>P-1),[]),children:g.jsx(Ne.div,{tabIndex:C||E===0?-1:0,"data-orientation":r,...f,ref:p,style:{outline:"none",...n.style},onMouseDown:_e(n.onMouseDown,()=>{k.current=!0}),onFocus:_e(n.onFocus,P=>{const R=!k.current;if(P.target===P.currentTarget&&R&&!C){const _=new CustomEvent(Tn,Ah);if(P.currentTarget.dispatchEvent(_),!_.defaultPrevented){const I=A().filter(J=>J.focusable),N=I.find(J=>J.active),D=I.find(J=>J.id===y),K=[N,D,...I].filter(Boolean).map(J=>J.ref.current);Ci(K,u)}}k.current=!1}),onBlur:_e(n.onBlur,()=>v(!1))})})}),bi="RovingFocusGroupItem",vi=b.forwardRef((n,e)=>{const{__scopeRovingFocusGroup:t,focusable:r=!0,active:o=!1,tabStopId:s,...i}=n,l=Ch(),a=s||l,c=Ph(bi,t),u=c.currentTabStopId===a,f=yi(t),{onFocusableItemAdd:h,onFocusableItemRemove:p}=c;return b.useEffect(()=>{if(r)return h(),()=>p()},[r,h,p]),g.jsx(Kn.ItemSlot,{scope:t,id:a,focusable:r,active:o,children:g.jsx(Ne.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...i,ref:e,onMouseDown:_e(n.onMouseDown,m=>{r?c.onItemFocus(a):m.preventDefault()}),onFocus:_e(n.onFocus,()=>c.onItemFocus(a)),onKeyDown:_e(n.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){c.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const y=_h(m,c.orientation,c.dir);if(y!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let C=f().filter(v=>v.focusable).map(v=>v.ref.current);if(y==="last")C.reverse();else if(y==="prev"||y==="next"){y==="prev"&&C.reverse();const v=C.indexOf(m.currentTarget);C=c.loop?Dh(C,v+1):C.slice(v+1)}setTimeout(()=>Ci(C))}})})})});vi.displayName=bi;var Mh={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Oh(n,e){return e!=="rtl"?n:n==="ArrowLeft"?"ArrowRight":n==="ArrowRight"?"ArrowLeft":n}function _h(n,e,t){const r=Oh(n.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Mh[r]}function Ci(n,e=!1){const t=document.activeElement;for(const r of n)if(r===t||(r.focus({preventScroll:e}),document.activeElement!==t))return}function Dh(n,e){return n.map((t,r)=>n[(e+r)%n.length])}var ki=xi,Cr=vi,Lh="Separator",Ao="horizontal",Rh=["horizontal","vertical"],Si=b.forwardRef((n,e)=>{const{decorative:t,orientation:r=Ao,...o}=n,s=Bh(r)?r:Ao,l=t?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return g.jsx(Ne.div,{"data-orientation":s,...l,...o,ref:e})});Si.displayName=Lh;function Bh(n){return Rh.includes(n)}var jh=Si,Fh="Toggle",wi=b.forwardRef((n,e)=>{const{pressed:t,defaultPressed:r=!1,onPressedChange:o,...s}=n,[i=!1,l]=pn({prop:t,onChange:o,defaultProp:r});return g.jsx(Ne.button,{type:"button","aria-pressed":i,"data-state":i?"on":"off","data-disabled":n.disabled?"":void 0,...s,ref:e,onClick:_e(n.onClick,()=>{n.disabled||l(!i)})})});wi.displayName=Fh;var it="ToggleGroup",[Ai,Ei]=dn(it,[gn]),Ti=gn(),kr=U.forwardRef((n,e)=>{const{type:t,...r}=n;if(t==="single"){const o=r;return g.jsx(Vh,{...o,ref:e})}if(t==="multiple"){const o=r;return g.jsx(Gh,{...o,ref:e})}throw new Error(`Missing prop \`type\` expected on \`${it}\``)});kr.displayName=it;var[Ni,Pi]=Ai(it),Vh=U.forwardRef((n,e)=>{const{value:t,defaultValue:r,onValueChange:o=()=>{},...s}=n,[i,l]=pn({prop:t,defaultProp:r,onChange:o});return g.jsx(Ni,{scope:n.__scopeToggleGroup,type:"single",value:i?[i]:[],onItemActivate:l,onItemDeactivate:U.useCallback(()=>l(""),[l]),children:g.jsx(Ii,{...s,ref:e})})}),Gh=U.forwardRef((n,e)=>{const{value:t,defaultValue:r,onValueChange:o=()=>{},...s}=n,[i=[],l]=pn({prop:t,defaultProp:r,onChange:o}),a=U.useCallback(u=>l((f=[])=>[...f,u]),[l]),c=U.useCallback(u=>l((f=[])=>f.filter(h=>h!==u)),[l]);return g.jsx(Ni,{scope:n.__scopeToggleGroup,type:"multiple",value:i,onItemActivate:a,onItemDeactivate:c,children:g.jsx(Ii,{...s,ref:e})})});kr.displayName=it;var[Hh,zh]=Ai(it),Ii=U.forwardRef((n,e)=>{const{__scopeToggleGroup:t,disabled:r=!1,rovingFocus:o=!0,orientation:s,dir:i,loop:l=!0,...a}=n,c=Ti(t),u=vr(i),f={role:"group",dir:u,...a};return g.jsx(Hh,{scope:t,rovingFocus:o,disabled:r,children:o?g.jsx(ki,{asChild:!0,...c,orientation:s,dir:u,loop:l,children:g.jsx(Ne.div,{...f,ref:e})}):g.jsx(Ne.div,{...f,ref:e})})}),qt="ToggleGroupItem",Mi=U.forwardRef((n,e)=>{const t=Pi(qt,n.__scopeToggleGroup),r=zh(qt,n.__scopeToggleGroup),o=Ti(n.__scopeToggleGroup),s=t.value.includes(n.value),i=r.disabled||n.disabled,l={...n,pressed:s,disabled:i},a=U.useRef(null);return r.rovingFocus?g.jsx(Cr,{asChild:!0,...o,focusable:!i,active:s,ref:a,children:g.jsx(Eo,{...l,ref:e})}):g.jsx(Eo,{...l,ref:e})});Mi.displayName=qt;var Eo=U.forwardRef((n,e)=>{const{__scopeToggleGroup:t,value:r,...o}=n,s=Pi(qt,t),i={role:"radio","aria-checked":n.pressed,"aria-pressed":void 0},l=s.type==="single"?i:void 0;return g.jsx(wi,{...l,...o,ref:e,onPressedChange:a=>{a?s.onItemActivate(r):s.onItemDeactivate(r)}})}),Uh=kr,$h=Mi,Sr="Toolbar",[Wh,Xd]=dn(Sr,[gn,Ei]),wr=gn(),Oi=Ei(),[Kh,_i]=Wh(Sr),Di=b.forwardRef((n,e)=>{const{__scopeToolbar:t,orientation:r="horizontal",dir:o,loop:s=!0,...i}=n,l=wr(t),a=vr(o);return g.jsx(Kh,{scope:t,orientation:r,dir:a,children:g.jsx(ki,{asChild:!0,...l,orientation:r,dir:a,loop:s,children:g.jsx(Ne.div,{role:"toolbar","aria-orientation":r,dir:a,...i,ref:e})})})});Di.displayName=Sr;var Li="ToolbarSeparator",Ri=b.forwardRef((n,e)=>{const{__scopeToolbar:t,...r}=n,o=_i(Li,t);return g.jsx(jh,{orientation:o.orientation==="horizontal"?"vertical":"horizontal",...r,ref:e})});Ri.displayName=Li;var Yh="ToolbarButton",Ar=b.forwardRef((n,e)=>{const{__scopeToolbar:t,...r}=n,o=wr(t);return g.jsx(Cr,{asChild:!0,...o,focusable:!n.disabled,children:g.jsx(Ne.button,{type:"button",...r,ref:e})})});Ar.displayName=Yh;var Xh="ToolbarLink",qh=b.forwardRef((n,e)=>{const{__scopeToolbar:t,...r}=n,o=wr(t);return g.jsx(Cr,{asChild:!0,...o,focusable:!0,children:g.jsx(Ne.a,{...r,ref:e,onKeyDown:_e(n.onKeyDown,s=>{s.key===" "&&s.currentTarget.click()})})})});qh.displayName=Xh;var Bi="ToolbarToggleGroup",Jh=b.forwardRef((n,e)=>{const{__scopeToolbar:t,...r}=n,o=_i(Bi,t),s=Oi(t);return g.jsx(Uh,{"data-orientation":o.orientation,dir:o.dir,...s,...r,ref:e,rovingFocus:!1})});Jh.displayName=Bi;var Zh="ToolbarToggleItem",Qh=b.forwardRef((n,e)=>{const{__scopeToolbar:t,...r}=n,o=Oi(t),s={__scopeToolbar:n.__scopeToolbar};return g.jsx(Ar,{asChild:!0,...s,children:g.jsx($h,{...o,...r,ref:e})})});Qh.displayName=Zh;var ed=Di,td=Ri,nd=(n=>(n.CODE="code",n.WRITING="writing",n))(nd||{});const wt=({children:n,toolbarType:e})=>g.jsx(ed,{className:H("m-0 flex h-10 w-fit min-w-0 flex-shrink items-center overflow-hidden rounded-xl border border-token-border-light bg-token-main-surface-primary",No,e==="code"?"p-0":"p-1"),children:n}),ji=({icon:n,hideLabel:e,label:t})=>g.jsxs(g.Fragment,{children:[g.jsx(n,{className:H("icon-sm",{"mr-0.5 text-token-text-tertiary":!e,"text-token-text-primary":e})}),!e&&g.jsx("span",{className:"truncate text-sm text-token-text-primary",children:t})]}),Fi=_o(Ar)`flex h-full items-center gap-1 rounded-lg px-2.5 hover:bg-[#f5f5f5] dark:hover:bg-token-main-surface-secondary`,rd=({label:n,icon:e,hideLabel:t=!1,onClick:r})=>g.jsx(Fi,{onClick:r,"aria-label":t?n:void 0,children:g.jsx(ji,{icon:e,hideLabel:t,label:n})}),od=({icon:n,hideLabel:e,label:t,children:r})=>g.jsxs(_r.Root,{children:[g.jsx(Al,{asChild:!0,children:g.jsx(Fi,{"aria-label":e?t:void 0,children:g.jsx(ji,{icon:n,hideLabel:e,label:t})})}),g.jsx(_r.Content,{align:"end",alignOffset:-4,sideOffset:8,children:r})]});wt.Separator=_o(td)`mx-1 p-0 list-none h-full w-[1px] bg-token-border-light`;wt.Action=rd;wt.Dropdown=od;const sd=({getSelectionRange:n})=>{const e=Yn(),t=()=>{const r=n();if(r==null)return;const{from:o,to:s,sourceFrom:i,sourceTo:l}=r;if(o==null||s==null||i==null||l==null){ie.logError("Missing selection range on targeted edit",r);return}const a=Vo.ASK;ie.logButtonClick(qe.TOOLBAR_ASK_CHATGPT,{action:a,sourceFrom:i,sourceTo:l}),Z.startCommentingOn({type:De.SELECTION,from:o,to:s,sourceRange:{start:i,end:l},action:a})};return g.jsx(wt.Action,{label:e.formatMessage({id:"wOaJUU",defaultMessage:"Ask ChatGPT"}),onClick:t,icon:xl})},qd=({getEditorDom:n,getToolbarPosition:e,getSelectionRange:t,toolbarType:r,children:o,onAddComment:s,isWaitingForCommentResponse:i=!1})=>{const[{height:l,width:a},c]=Jt(),[u,f]=b.useState(!0),[h,p]=b.useState(!1),m=n(),y=Ae(({commentingOn:E})=>E),[x,C]=b.useState(null),v=b.useCallback(()=>{const E=n(),S=document.getSelection();return!S||S.type!=="Range"||S.isCollapsed||!E?.contains(S.anchorNode)},[n]);b.useEffect(()=>{const E=To(()=>{p(!0)},200,{leading:!0}),S=()=>{E.cancel(),p(!1)};return m?.addEventListener("pointerdown",E,{passive:!0}),document.addEventListener("pointerup",S,{passive:!0}),()=>{m?.removeEventListener("pointerdown",E),document.removeEventListener("pointerup",S)}},[m]),b.useEffect(()=>{const E=()=>{f(v())};return document.addEventListener("selectionchange",E,{passive:!0}),()=>{document.removeEventListener("selectionchange",E)}},[v]),Oo(()=>{if(u||v())return f(!0);try{const E=e({width:a,height:l});E!=null&&C(E)}catch(E){ie.logError("Invalid position in getToolbarPosition",E)}},[l,a,u,v,e]);const T=g.jsxs(wt,{toolbarType:r,children:[g.jsx(sd,{getSelectionRange:t}),o]}),A=!u&&!y&&x!=null,k=El(A);return b.useEffect(()=>{!A&&k&&!y&&m?.focus()},[m,k,A,y]),g.jsxs(g.Fragment,{children:[g.jsx("div",{"aria-hidden":"true",className:"pointer-events-none invisible fixed left-0 top-0 h-0 overflow-clip",children:g.jsx("div",{ref:c,children:T})}),g.jsx(We,{children:A&&g.jsx(Q.div,{initial:{opacity:0,scale:.95},animate:{opacity:h?0:1,scale:h?.95:1},style:{top:x.top,left:x.left},exit:{opacity:0,scale:.95},transition:{type:"spring",bounce:.1,duration:.1,delay:h?0:.1},className:H("absolute",Ee.toolbar,h?"pointer-events-none":"pointer-events-auto"),children:T})}),g.jsx(Cf,{toolbarPosition:x,commentingOn:y,isWaitingForCommentResponse:i,onAddComment:s})]})};let Ot=null;function Jd(){if(Ot!=null)return Ot;if(typeof window>"u")return 0;const n=document.createElement("div");n.style.width="100px",n.style.height="100px",n.style.overflow="scroll",n.style.position="absolute",n.style.top="-9999px",document.body.appendChild(n);try{Ot=n.offsetWidth-n.clientWidth}finally{document.body.removeChild(n)}return Ot}function Zd(n){return n==null?null:n.scrollHeight>n.clientHeight}export{Jd as $,Aa as A,Id as B,Td as C,Ml as D,Ld as E,Fd as F,Ed as G,Rd as H,V as I,jd as J,Vd as K,Ln as L,gd as M,Qn as N,Pd as O,Wo as P,Ju as Q,zd as R,Uu as S,j as T,Gd as U,Hd as V,qd as W,nd as X,li as Y,Zd as Z,Yd as _,ee as a,If as a0,Yu as a1,Ud as a2,wd as a3,Wd as a4,xr as a5,je as a6,Ef as a7,Pf as a8,Tf as a9,Nf as aa,fi as ab,Ze as ac,Mf as ad,$d as ae,Of as af,Sf as ag,Kd as ah,ui as ai,Yt as aj,kf as ak,sh as al,wt as am,O as b,ra as c,Ka as d,oa as e,Sd as f,da as g,z as h,Od as i,Ad as j,xd as k,Da as l,_d as m,kd as n,Cd as o,bd as p,ea as q,Xo as r,Xl as s,d as t,yd as u,Jl as v,Nd as w,Md as x,Bd as y,Dd as z};
//# sourceMappingURL=o6geibblzcfu772p.js.map
