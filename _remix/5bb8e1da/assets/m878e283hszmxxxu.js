import{K as u,L as g,r as d,ef as l,ap as h,bD as y,a9 as T,cm as p,aK as f,h as v,j as R,D as E,eg as b}from"./gie7t2ghpkmat91x.js";import{cD as r,cE as P,cF as A}from"./eb3stsg8iy7t43kd.js";import{P as m,r as C}from"./cq1wr63lzayx7ig8.js";import{s as H}from"./dj1r9dxm91vgn5c2.js";import{e as _,i as M,T as x}from"./j7vda0o4435fpq77.js";const D="prompt-textarea";function G(){document.getElementById(D)?.focus()}const q={getAndReset:(e,s)=>{const t=u.getItem(g.RestoreMessageAfterOauthRedirect);return u.removeItem(g.RestoreMessageAfterOauthRedirect),!t||t.userId!==e||s!==t.serverThreadId||Date.now()>t.expiresAt?null:t},set:(e,s,t)=>{const a={userId:e,serverThreadId:s,inputText:t,expiresAt:Date.now()+6e4};u.setItem(g.RestoreMessageAfterOauthRedirect,a)}},z=()=>m.useState(m.getPersistedSystemHints).has(r.Search),N=()=>{const e=m.useStore(),s=d.useCallback(()=>e.getPersistedSystemHintTrigger(r.Search),[e]),t=d.useCallback(()=>e.clearPersistedSystemHintTrigger(r.Search),[e]),a=d.useCallback((o,n,i)=>{(o?e.addPersistedSystemHint:e.removePersistedSystemHint)(r.Search,n,i)},[e]);return{getSearchModeTrigger:s,clearSearchModeTrigger:t,setThreadSearchMode:a}},j=(e,s,t)=>e?"file_upload_pending":s?t?"text_content_too_long":void 0:"empty_text_content",I=e=>e.replace(/[\u{E0000}-\u{E007F}]+/gu,""),Q=e=>{const s=I(e.getContentToSend().content);return Math.ceil(s.length/4)},L=1e3;function U(e){return e&&e.length>L&&!l().shift&&h.checkGate("1508312659")}async function F(e,s){const t=A(e),a=t??await R.getConversation(e);return s==null&&t&&(s=!0),t||E.addTiming("chatgpt.web.chatPage.loadExistingConversation"),x.initThreadFromServerData(e,a,s,void 0,s),H(a.conversation_id,a.async_status?{source:b.SERVER,value:a.async_status}:null),a}const V=e=>{const s=y(),{pathname:t}=T(),a=p(),o=_(),n=f();v({queryKey:["conversation",e],queryFn:()=>F(e).catch(i=>{const c=P(t),S=c!=null?C(c):"/";throw s(S),n.danger(`Unable to load conversation ${e}`,{testId:"conversation-fetch-error-toaster"}),i}),enabled:!M(e)&&!a&&!o,refetchOnMount:!0})};export{q as P,D as T,V as a,z as b,Q as e,F as f,j as g,U as i,I as s,G as t,N as u};
//# sourceMappingURL=m878e283hszmxxxu.js.map
