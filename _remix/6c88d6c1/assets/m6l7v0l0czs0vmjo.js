import{L as G,m as e,e7 as V,ey as $,r as c,a4 as F,b5 as O,K as X,bE as ee,bd as k,f2 as se,aE as y,N as E,df as te,bm as w,fA as I,cc as ae,cd as ne,go as ie,dZ as A}from"./gkip3s8xpilxjlzw.js";import{c0 as P,ir as oe,e9 as re,U as _,es as le,o as B,bE as ce,is as de,e$ as me,d2 as N,bW as ue,aF as ge,ce as fe,it as C,iu as pe,aC as xe,d3 as he,iv as Se,hu as be,hv as je,iw as ve,ix as v,iy as Ce,c4 as S,c1 as ze,d4 as ye,iz as Ie,iA as ke,iB as Me,dQ as Ne,iC as U,ap as D,iD as Ge,iE as Fe,iF as Te,iG as z,iH as Oe,dR as Le,iI as Ee,c5 as we,iJ as Ae,eY as Pe,iK as _e,iL as Be}from"./n766k8stggevg9f9.js";import{b7 as Ue,z as De,az as Re,L as We,M as R,aM as He,av as Ke}from"./dlpb2yv5mb3tebui.js";import{m as W}from"./h2wh3lo1pha4b8r2.js";import{a as Ye}from"./coatal4tjz6bpdr6.js";import{U as Ze,P as Qe}from"./m8a8usyxmyi439tj.js";function H(){const s=G(),i=P(),n=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(oe,{children:e.jsx(W.div,{whileTap:{scale:.98},children:e.jsx(V,{to:re(),onClick:()=>{i.activeSidebar==="popover-nav"&&_.setActiveSidebar(!1)},children:e.jsx(le,{icon:Ue,"data-testid":"explore-gpts-button",children:n})},"explore")})})}function qe({gizmo:s,historyDisabled:i,section:n,onClick:o,isActive:d,hideOverflowMenu:g=!1,elementRef:r}){const{clientThreadId:m}=B(),f=$(m),p=G(),[t,b]=c.useState(!1),[a,l]=c.useState(!1);c.useState(!1);const[u,x]=c.useState(null),h=F(),Z=!!s?.gizmo.tags?.includes(ce.FirstParty),Q=!1;let q=!1;const[as,T]=c.useState(0),{data:M}=de(s?.gizmo.id);c.useEffect(()=>{T(M?M.items.length:0)},[M]),c.useEffect(()=>{u==null&&d&&f&&x(!0)},[d,f,u]);let j;if(s!=null)j=s.gizmo.display.name||me;else{if(h==null)return null;i?j=p.formatMessage(N.clearChat):h.canInteractWithGizmos()?j=he:j=p.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(W.div,{whileTap:{scale:.98},onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},children:e.jsx(ue,{loggingGizmoId:s?.gizmo.id??"primary",href:ge(s),onClick:o,showActiveIndicator:q,icon:e.jsx(fe,{gizmoId:s?.gizmo.id,isFirstParty:Z,gizmoEmoji:s?.gizmo.display.emoji,gizmoTheme:s?.gizmo.display.theme,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6"}),isMenuOpen:t,label:j,rightIcon:n===C.Workspace&&e.jsx(O,{side:"right",label:p.formatMessage(L.workspaceRecommended,{workspace_name:h?.name??"Your Workspace"}),children:e.jsx(De,{className:"icon-md text-token-text-secondary",alt:p.formatMessage(L.workspaceRecommended,{workspace_name:h?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(a||t)&&!Q&&!g&&e.jsx("div",{className:"text-token-text-tertiary",onClick:J=>{J.preventDefault()},children:e.jsx(pe,{gizmo:s,isOpen:t,setIsOpen:b,section:n})}),!g&&e.jsx(O,{side:"right",label:p.formatMessage(i?N.clearChat:N.newChat),className:"flex items-center",children:e.jsx("button",{className:t?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:i?e.jsx(Re,{className:"icon-md"}):e.jsx(We,{className:"icon-md"})})})]}),elementRef:r})}),e.jsx(xe,{children:!1})]})}const L=X({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}}),Je=2;function K({gizmos:s,isGizmoFlyout:i,isLoaded:n,maxToShowOnLoad:o=4,isScreenArch:d,showAllSidebarItems:g}){const r=ve(s,l=>l.flair.kind),m=[...(r[v.Workspace]?.map(({resource:l})=>({gizmo:l,section:C.Workspace}))??[]).slice(0,3),...r[v.FirstParty]?.map(({resource:l})=>({gizmo:l,section:C.Keep}))??[],...r[v.SidebarKeep]?.map(({resource:l})=>({gizmo:l,section:C.Keep}))??[]],f=r[v.Recent]?.slice(0,d||n?r[v.Recent]?.length:Je).map(({resource:l})=>({gizmo:l,section:C.Recents}))??[],p=f.length,t=m.length,b=d?p>0:s.length>o;let a=[];return i&&d?a=[...m,...f]:!i&&d?a=m:(a=[...m,...f],g||(a.length>o&&t>o?a=a.slice(0,t):a.length>o&&(a=a.slice(0,o)))),{listItems:a,itemsLeft:s.length-a.length,needsToCollapseItems:b,total:s.length}}function Y({gizmo:s,currentGizmoId:i,maxToShowOnLoad:n,hideOverflowMenu:o=!1}){const d=c.useRef(!1),g=!n,r=ee(),[m,f]=c.useState(!1),p=P(u=>!Se.isGptListCollapsed(u)),{listItems:t,needsToCollapseItems:b,itemsLeft:a}=K({gizmos:s,isGizmoFlyout:g,isLoaded:m,maxToShowOnLoad:n,isScreenArch:r,showAllSidebarItems:p});c.useEffect(()=>{m||f(!0)},[m]),c.useEffect(()=>{t.length>0&&!d.current&&(be({namespace:je.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),d.current=!0)},[t]);function l(u,x){const h=e.jsx(qe,{gizmo:u,isActive:u.gizmo.id===i,section:x,hideOverflowMenu:o},u.gizmo.id);return r?e.jsx("li",{children:h}):h}return e.jsxs("div",{children:[t.map(({gizmo:u,section:x},h)=>e.jsxs(c.Fragment,{children:[h>1&&x!==t[h-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),l(u,x)]},h)),!r&&b?e.jsxs("button",{onClick:_.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(R,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:p?e.jsxs(e.Fragment,{children:[e.jsx(k,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(He,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(k,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:a}}),e.jsx(Ke,{className:"icon-xs"})]})})]}):null,!r&&e.jsx(H,{})]})}function Ve({currentGizmoId:s,gizmos:i,onClick:n}){const{isSidebarFlyoutOpen:o,onSidebarFlyoutOpenChange:d}=Ce(),g=o(S.Gizmo),r=ze();return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(se,{onOpenChange:m=>d(S.Gizmo,m),side:r?"bottom":"right",sideOffset:4,open:g,contentAlign:"end",triggerButton:e.jsxs("button",{className:y("flex flex-1 select-none items-center gap-2.5 rounded-lg px-2 py-[7px] text-body tracking-condensed text-token-text-secondary ease-[var(--spring-bounce)] hover:bg-token-main-surface-secondary focus:ring-0 motion-safe:active:scale-[98%] motion-safe:active:transition-transform",g&&"bg-token-main-surface-secondary"),onClick:n,children:[e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:e.jsx(R,{className:y("icon-md font-semibold text-token-sidebar-icon")})})}),e.jsx("span",{className:"text-left",children:e.jsx(k,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] w-80 overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(E,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(Y,{gizmo:i,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function $e({currentGizmoId:s}){const{data:{gizmos:i}={}}=ye();let n=i;const{needsToCollapseItems:o}=K({gizmos:n??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return e.jsx(e.Fragment,{children:e.jsxs(Ie,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(k,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(H,{}),e.jsx(Y,{gizmo:n??[],currentGizmoId:s,maxToShowOnLoad:ke}),o&&e.jsx(E,{children:e.jsx(Ve,{currentGizmoId:s,gizmos:n??[]})})]})})}function Xe({clientThreadId:s}){const i=F(),n=te(s),{isUnauthenticated:o}=w();return o?null:e.jsxs("div",{className:y(I.screenContent),children:[null,null,e.jsx(Me,{clientThreadId:s}),i?.canInteractWithGizmos()?e.jsx($e,{currentGizmoId:n}):null,!1]})}function es(){const s=F(),i=s?.data==null,{isUnauthenticated:n}=w(),{openSettings:o}=Ne(),[d]=c.useState(()=>{const t=ae.getCookie(ne.Workspace);return typeof t=="string"&&t!==ie}),g=G(),{store:r,actions:m}=U(),f=r(t=>t.mode);if(!s||d&&i)return null;const p=n?e.jsx(Ze,{}):e.jsx(Ye,{onClickSettings:()=>o()});return e.jsxs(D,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[p,e.jsx("div",{className:I.togglePinWrapper,children:e.jsx(Ge,{tooltipSideOffset:14,className:I.pinSidebarAction,icon:e.jsx(Fe,{}),onActivate:t=>{t.preventDefault(),t.persist(),Te.togglePinSidebar(t,m,f===z.Floating?z.Pinned:z.Floating)},label:f===z.Floating?g.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):g.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:A.FloatingOrPinned})})]})}function ss(){return e.jsx(D,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(Qe,{})})}function ts(){return e.jsxs(Oe,{className:y(I.screenTrailingBarContainer),children:[e.jsx(Le,{}),e.jsx(ss,{}),e.jsx(es,{})]})}function ds(){const{clientThreadId:s,onNewThread:i}=B(),[n,o]=c.useState(!1),[d,g]=c.useState(!1),[r,m]=c.useState(!1),{store:f}=U(),p=c.useCallback(a=>a===S.Conversation?n:a===S.Gizmo?d:a===S.Conversation2?r:!1,[n,d,r]),t=c.useCallback((a,l)=>{const u=x=>{a===S.Conversation?o(x):a===S.Gizmo?g(x):a===S.Conversation2&&m(x)};l?u(!0):setTimeout(()=>{u(!1)},100)},[]),b=c.useRef(null);return Ee((a,l)=>{t(S.Conversation,!1),t(S.Gizmo,!1),t(S.Conversation2,!1);const u=window.matchMedia("(max-width: 700px)").matches,x=Be(b.current);l!=null&&u&&f.getState().isSidebarOpen&&(f.getState().mode===z.Floating||x)&&setTimeout(()=>{document.getElementById(A.OpenOrClosed)?.click()},100)}),e.jsxs(we,{value:{isSidebarFlyoutOpen:p,onSidebarFlyoutOpenChange:t},children:[e.jsx(Ae,{}),e.jsx(Pe,{anchor:"vertical",className:y(I.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(_e,{onNewThread:i}),ref:b,trackLeading:!0,trailing:e.jsx(ts,{}),children:e.jsx(Xe,{clientThreadId:s})})]})}export{ds as C,Y as G};
//# sourceMappingURL=m6l7v0l0czs0vmjo.js.map
