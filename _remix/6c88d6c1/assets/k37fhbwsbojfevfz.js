import{m as e,aE as c,r as m,gC as z,au as F,o as $,e as K,bv as U,P as M,d as C,bj as B,bd as L}from"./gkip3s8xpilxjlzw.js";import{cT as W,b2 as X,cU as H}from"./n766k8stggevg9f9.js";import{u as T}from"./pdbjh8okbyq6ajdd.js";import{e as Q,d as E}from"./jdwwosck1eac76ro.js";import{P as V}from"./ngounxcelt4ksrl9.js";import{aR as Y}from"./dlpb2yv5mb3tebui.js";import"./h2wh3lo1pha4b8r2.js";function D({title:n,content:s,buttons:t,time:a,icon:r,size:i="default",progressBar:d,disabled:o=!1,onClick:u}){const y=o?"border-token-dot-color border-opacity-10":"border-token-text-tertiary",p=i==="small"?`w-[380px] px-[20px] py-[16px] ${o?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",g=u?"cursor-pointer":"",l=i==="small"?"text-[15px]":"";return e.jsxs("div",{className:c("inline-flex flex-col items-start justify-start rounded-2xl border",y,"bg-token-main-surface-primary dark:bg-token-main-surface-secondary",p,g,l),onClick:u,style:i==="small"&&!o?{boxShadow:"rgba(0, 0, 0, 0.06) 0px 2px 6px 0px"}:void 0,children:[e.jsxs("div",{className:c("flex flex-col items-start justify-start self-stretch",i!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:c("inline-flex items-start justify-start self-stretch",i!=="small"&&"gap-2"),children:[e.jsx("div",{className:c("shrink grow basis-0 font-medium leading-normal",o?"text-token-text-secondary":"text-token-text-primary"),children:n}),e.jsx("div",{className:"relative h-6 w-6"}),!o&&(r||e.jsx(Y,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:"flex w-full flex-col items-start justify-start",children:e.jsx("div",{className:c("inline-flex w-full items-start justify-start self-stretch rounded",i==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:c("w-full font-normal leading-relaxed",o?"text-token-text-tertiary":"text-token-text-secondary"),children:s})})})]}),d?e.jsxs("div",{className:c(t&&t.length>0&&"-mt-2","mb-2 inline-flex items-center justify-between self-stretch"),children:[d,t]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[a&&e.jsx("div",{className:"shrink grow basis-0 text-[15px] font-normal leading-normal text-token-text-tertiary",children:a}),e.jsx("div",{className:"flex gap-2",children:t})]})]})}const q={strong:n=>{const{node:s,children:t,...a}=n;return e.jsx("strong",{...a,className:c(a.className,"font-semibold text-token-text-primary"),children:t})},p:n=>{const{node:s,children:t,...a}=n;return e.jsx("p",{...a,className:c(a.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:t})}};function G({message:n,isExpandable:s}){const a=n.create_time?new Date(n.create_time*1e3):Date.now(),r=T(+a,48e4);return e.jsx(V,{percentage:r,className:c("mr-4",s?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-r)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function J({headline:n,message:s}){const a=s.create_time?new Date(s.create_time*1e3):Date.now(),r=T(+a,48e4);return e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(H,{percentage:r,thickness:1/8,className:"h-5 w-5 text-token-text-primary",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-r)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"}),n]})}function Z({isExpandable:n,handleOpenSidebarSummarizer:s,summarizationHeadline:t,latestTitle:a,message:r}){return e.jsx("div",{className:"py-2",children:e.jsx(D,{buttons:[e.jsx(B,{onClick:s,color:"secondary",className:"!h-[38px] font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(L,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")],title:t,time:null,icon:e.jsx("div",{className:""}),content:`${a}...`,size:"small",progressBar:e.jsx(G,{message:r,isExpandable:n})})})}function I({handleOpenSidebarSummarizer:n,summarizationHeadline:s,message:t}){return e.jsx("div",{className:"py-2",children:e.jsx(D,{buttons:[],title:s,time:null,content:t.metadata?.finished_text??"",size:"small",disabled:!0,onClick:n})})}function _({completionInProgress:n,summarizationHeadline:s,latestTitle:t,message:a,summaryText:r,isExpandable:i,disableExpansion:d,onOpenAnalytics:o,handleOpenSidebarSummarizer:u}){return e.jsx(Q,{status:n?E.Running:E.Finished,highlightedCommand:n?s==null?t:e.jsx(J,{headline:s,message:a}):a.metadata?.finished_text??"",onOpenAnalytics:o,onClick:u,children:r&&i&&!d?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(X,{componentOverrides:q,className:"not-prose leading-6",children:r})}):null})}function ie({messages:n,isStreaming:s,clientThreadId:t,currentGroupedMessageIndex:a,turnIndex:r}){const[i,d]=m.useState(""),[o,u]=m.useState(!1),p=z(t)===F.STREAMING,g=p||s,l=n[0].message,N=l.id,v=$.getServerThreadId(t),f=K(l),x=l.metadata?.summarization_headline,P=s&&x!=null,{toggleThreadSidebar:k}=U(),A=x!=null,O=W(),h=m.useCallback(()=>{k({type:"summarizer",clientThreadId:t,currentGroupedMessageIndex:a,turnIndex:r})},[k,t,a,r]);m.useEffect(()=>{const R=/\*\*(.*?)(?:\*\*|\n|$)/g;let w,b="";for(;(w=R.exec(f))!=null;)b=w[1].trim();b?d(b):l.metadata?.initial_text!=null&&d(l.metadata.initial_text)},[f,l.metadata?.initial_text]),m.useEffect(()=>{f.length>0&&u(!0)},[f]);const j=m.useMemo(()=>({client_thread_id:t,message_id:N,conversationId:v}),[t,N,v]);m.useEffect(()=>{o&&M.logEvent(C.receivedA8KM123Message,j)},[o]);const S=m.useCallback(()=>{M.logEvent(C.openedA8KM123Message,{...j,isStreaming:s})},[j,s]);return O?A?p||s?e.jsx(Z,{isExpandable:o,handleOpenSidebarSummarizer:h,summarizationHeadline:x,latestTitle:i,message:l}):e.jsx(I,{handleOpenSidebarSummarizer:h,summarizationHeadline:x,message:l}):e.jsx(_,{completionInProgress:g,summarizationHeadline:x,latestTitle:i,message:l,onOpenAnalytics:S,handleOpenSidebarSummarizer:o||!s?h:void 0}):e.jsx(_,{completionInProgress:g,summarizationHeadline:x,latestTitle:i,message:l,onOpenAnalytics:S,summaryText:f,isExpandable:o,disableExpansion:P})}export{q as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,ie as default};
//# sourceMappingURL=k37fhbwsbojfevfz.js.map
