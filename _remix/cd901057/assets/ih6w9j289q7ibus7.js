import{W as I,x as e,N as R,a5 as D,r as m,a8 as F,bB as K,bp as te,a0 as p,a as re,h as ne,j as Y,bk as oe,a1 as ie,bK as le,au as ce,V as P,bg as L,af as z,ao as O,ac as de,aq as pe,w as me,am as ue}from"./jzo1gvcwh9pppzs1.js";import{eB as xe,eC as fe,eD as ge,eE as N,U as ke,ck as q,ch as T,eF as ve,eG as be,bG as he,eH as je,aG as we,eI as ye,ap as Me,by as _,cl as Ne,eJ as Ae}from"./beucmu6zcawzhvqq.js";import{S as Pe,a as Se}from"./b7t5v2v7jh0v0338.js";import{bf as Ue,S as We,r as Ce,bg as Ie,bh as J,bi as De,aK as Be,b0 as Ee,bj as Re,bk as Te,J as Fe}from"./leocs7nz48lbrcv1.js";import{a as Le,G as A,U as C}from"./parllegwy3ioo052.js";import{d as ze,a as _e}from"./f8a564ba2mcf5j0a.js";import{f as Q}from"./mhzd66d800yve4rv.js";import{b as Ge,c as He}from"./kdu6bezoumlylqv4.js";function $e({onFileChange:a,className:n,message:s,mimeTypes:o}){const t=I(),r=s??t.formatMessage(X.helpText),i=S=>{if(S.length>0){const U=S[0];o&&o.includes(U.type)&&a(U)}},{open:d,getRootProps:u,getInputProps:y,isDragActive:v}=xe({disabled:!1,noClick:!0,onDropAccepted:i,onDropRejected:()=>null,multiple:!1,maxSize:fe,...ge(o)});return e.jsxs("div",{className:R("flex flex-col content-center justify-center gap-3 rounded-xl border border-dashed px-6 py-16 text-center",v?"border-green-600 bg-green-600 bg-opacity-10":"border-token-border-medium",n),...u(),children:[e.jsx("input",{...y()}),e.jsx("div",{className:"text-center dark:text-white",children:e.jsx("div",{className:"inline-block",children:e.jsx(Ue,{})})}),e.jsx("div",{className:"text-center text-sm",children:r}),e.jsx("div",{className:"cursor-pointer text-center text-sm font-bold text-green-600",onClick:()=>{d()},children:t.formatMessage(X.openFilePicker)})]})}const X=D({helpText:{id:"FileUploadBox.helpText",defaultMessage:"Drop file here to upload"},openFilePicker:{id:"FileUploadBox.openFilePicker",defaultMessage:"Browse files"}});function Ke(a){const n=re(),s=I(),o=F();return ne({mutationFn:({name:t,profilePictureId:r,profilePictureUrl:i})=>Y.patchWorkspace({workspaceId:a,name:t,profile_picture_id:r,profile_picture_url:i}).catch(d=>{o.danger(s.formatMessage(g.saveError,{error:d.message}))}),onSuccess:()=>{n.invalidateQueries({queryKey:["account-status"]})}})}function Oe({workspace:a}){const[n,s]=m.useState(a?.name??""),[o,t]=m.useState(!1);!o&&a&&(t(!0),n==""&&s(a?.name??""));const[r,i]=m.useState(a.profilePictureUrl),[d,u]=m.useState(a.profilePictureId),y=Le(A.WorkspaceAppearance),v=I(),S=F(),U=()=>C.closeModal(A.WorkspaceAppearance),[c,j]=m.useState(void 0);async function Z(x){const M=await je(x,q.workspaceAvatarPreview*2),H=we(M);j({tempId:H,file:M,status:N.Uploading,progress:1,fileId:null,cdnUrl:null}),ye(H,M,v,S,oe.ProfilePicture,{onFileCreated(w,b,f){j(l=>l!=="initial"&&l?.tempId===w&&l.status===N.Uploading?{...l,progress:10,fileId:b,cdnUrl:f}:l)},onFileUploadProgress(w,b){j(f=>f!=="initial"&&f?.tempId===w&&f.status===N.Uploading?{...f,progress:b}:f)},onFileUploaded(w,b,f){j(l=>l!=="initial"&&l&&l.cdnUrl&&l.tempId===w?(Y.getFileDownloadLink(l.fileId).then($=>{$.status===ie.Success&&(u(l.fileId),i($.download_url))}),{...l,status:N.Ready,progress:100,fileSpec:{name:l.file.name,id:l.fileId,size:l.file.size,...f??{}}}):l)},onError(w){j(b=>{if(b!=="initial"&&b?.tempId===w){u(void 0),i(void 0),E(null);return}return b})}})}const G=Ke(a.id),ee=e.jsx(K.Button,{color:"primary",disabled:c!=="initial"&&c!==void 0&&c.status!==N.Ready||c!=="initial"&&c!==void 0&&c.status===N.Ready&&!r||G.isPending||n.trim().length===0,onClick:async()=>{G.mutate({name:n,profilePictureId:d,profilePictureUrl:r}),C.closeModal(A.WorkspaceAppearance)},title:v.formatMessage(g.modalSubmit)}),ae=e.jsx(K.Button,{onClick:()=>{j(void 0),u(a.profilePictureId),i(a.profilePictureUrl),C.closeModal(A.WorkspaceAppearance)},title:v.formatMessage(g.modalCancel)}),[B,E]=m.useState(null);m.useEffect(()=>{if(c!=="initial"&&c!=null&&B==null){const x=new FileReader;x.addEventListener("load",()=>{const M=x.result;typeof M=="string"&&E(M)}),x.readAsDataURL(c.file)}},[c,B]);const se=()=>{u(null),i(null),j(void 0),E(null)};return e.jsxs(te,{isOpen:y,onClose:U,showCloseButton:!0,primaryButton:ee,secondaryButton:ae,type:"danger",title:v.formatMessage(g.modalTitle),children:[e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-name",className:"block pb-1 font-semibold text-token-text-primary",children:e.jsx(p,{...g.workspaceName})}),e.jsx("p",{className:"font-base text-sm text-token-text-secondary",children:e.jsx(p,{...g.workspaceNameDescription})})]}),e.jsx("div",{className:"mb-4",children:e.jsx(ke,{type:"text",name:"workspace-name",value:n,onChange:x=>s(x.target.value),maxLength:64})}),e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-avatar",className:"block pb-1 font-semibold text-token-text-primary",children:e.jsx(p,{...g.workspaceAvatar})}),e.jsx("p",{className:"font-base text-sm text-token-text-secondary",children:v.formatMessage(g.workspaceAvatarDescription,{size:q.workspaceAvatarPreview*2})})]}),e.jsxs("div",{className:"mb-4 flex-wrap text-center",children:[r?e.jsxs("div",{className:"relative mb-3 inline-flex",children:[e.jsx(T,{src:r,size:"workspaceAvatarPreview"}),e.jsx("div",{className:"absolute -right-1 -top-1",children:e.jsx(qe,{onClick:se})})]}):c!=null&&c!=="initial"&&B?e.jsx("div",{className:"flex flex-col justify-center text-center",children:e.jsxs("div",{className:"relative mb-3 text-center",children:[e.jsx(T,{src:URL.createObjectURL(c.file),size:"workspaceAvatarPreview"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:e.jsx(ve,{percentage:c.progress,className:"h-6 w-6"})})]})}):e.jsx($e,{onFileChange:x=>{Z(x)},mimeTypes:be}),e.jsx(he,{className:"mt-3",children:v.formatMessage(g.propagationWarning)})]})]})}function qe({onClick:a}){return e.jsx("div",{className:"flex h-6 w-6 cursor-pointer flex-row flex-wrap content-center justify-center rounded-full border-2 border-white bg-black text-white",onClick:a,children:e.jsx(We,{className:"h-3 w-3"})})}const g=D({modalTitle:{id:"workspaceAppearanceModal.title",defaultMessage:"Workspace appearance"},modalSubmit:{id:"workspaceAppearanceModal.submit",defaultMessage:"Save"},modalCancel:{id:"workspaceAppearanceModal.cancel",defaultMessage:"Cancel"},workspaceName:{id:"workspaceAppearanceModal.workspaceName",defaultMessage:"Workspace name"},workspaceNameDescription:{id:"workspaceAppearanceModal.workspaceNameDescription",defaultMessage:"Update the name of the workspace."},workspaceAvatar:{id:"workspaceAppearanceModal.workspaceAvatar",defaultMessage:"Workspace image"},workspaceAvatarDescription:{id:"workspaceAppearanceModal.workspaceAvatarDescription",defaultMessage:"Upload a JPEG or PNG workspace image for your team. (Minimum {size}Ã—{size}px recommended.)"},propagationWarning:{id:"workspaceAppearanceModal.propagationWarning",defaultMessage:"Changes to the workspace name and image may take some time to take effect."},saveError:{id:"workspaceAppearanceModal.saveError",defaultMessage:"Failed to save workspace appearance"}});function Je({accountId:a,subscription:n}){const s=I(),o=F(),t=Ge(a),[r,i]=m.useState(!1),d=Me(a),u=async()=>{i(!0);try{await t.mutateAsync(a)}catch{o.warning(s.formatMessage(W.errorRenewingSubscription),{hasCloseButton:!0})}finally{i(!1)}};return e.jsx("div",{className:"bg-token-main-surface-secondary",children:e.jsxs("div",{className:"mx-auto flex w-full max-w-5xl items-center justify-between px-2 py-4 md:px-6 lg:px-10 lg:py-6",children:[e.jsxs("div",{className:"mx-2 flex-grow md:mx-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"mr-4 hidden text-orange-500 md:block"}),e.jsx("p",{className:"text-lg font-semibold",children:e.jsx(p,{...W.workspaceWillBeDeactivated})})]}),n.active_until!=null&&e.jsx("p",{className:"md:ml-8",children:e.jsx(p,{...W.retainAccessUntil,values:{expiryDate:new Date(n.active_until)}})})]}),d&&e.jsx(ce,{color:"primary",onClick:u,loading:r,children:e.jsx(p,{...W.reactivateBtn})})]})})}const W=D({retainAccessUntil:{id:"adminPage.retainAccessUntil",defaultMessage:"You will retain access to the workspace until the end of your billing cycle on {expiryDate, date, long}."},workspaceWillBeDeactivated:{id:"adminPage.workspaceWillBeDeactivated",defaultMessage:"This workspace will be deactivated."},reactivateBtn:{id:"adminPage.reactivateBtn",defaultMessage:"Reactivate"},errorRenewingSubscription:{id:"adminPage.errorRenewingSubscription",defaultMessage:"There was an error reactivating your subscription."}});function h({route:a,icon:n,name:s,upsellEnterprise:o=!1}){const t=me().pathname.replace(/\/$/,"")||"/",r=L();return o?e.jsx(ue,{label:e.jsx(p,{...k.availableForEnterprise}),side:"right",children:e.jsxs(Q,{$as:"button",className:R("w-full rounded text-left","hover:bg-token-sidebar-surface-secondary"),children:[e.jsx(Fe,{className:"icon-sm shrink-0 text-token-text-secondary"}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(p,{...s})})]})}):e.jsxs(Q,{$as:"button",className:R("w-full rounded text-left hover:bg-token-sidebar-surface-secondary",t===a&&"bg-token-sidebar-surface-secondary"),onClick:i=>{r(a),i.stopPropagation()},children:[n,e.jsx(p,{...s})]})}function Qe({workspace:a,hasAdminPrivileges:n,hasOwnerPrivileges:s}){const o=L(),t=m.useCallback(()=>{o("/")},[o]),r=_(Ne.isEnterpriseyPlan);return e.jsxs("nav",{className:"p-2",children:[e.jsx("div",{className:"mb-1 flex flex-row gap-2",children:e.jsxs(Se,{onClick:t,children:[e.jsx(Ae,{className:"icon-sm"}),e.jsx(p,{...k.backToChat})]})}),e.jsxs("div",{className:"flex flex-col gap-2 py-2",children:[e.jsxs("div",{className:`flex flex-col gap-2 rounded px-2 py-2 ${s?"cursor-pointer hover:bg-token-main-surface-secondary":""}`,onClick:()=>{s&&C.openModal(A.WorkspaceAppearance)},children:[e.jsx(T,{size:"large",src:a?.profilePictureUrl}),e.jsxs("div",{className:"align-center flex flex-row",children:[e.jsx("h2",{className:"flex-1 text-lg text-token-text-primary dark:text-white",children:a?.name}),s?e.jsx("div",{className:"my-auto h-4 flex-initial align-middle dark:text-white",children:e.jsx(Ce,{className:"icon-sm opacity-70 hover:opacity-100"})}):null]})]}),e.jsx(h,{route:"/admin",icon:e.jsx(Ie,{className:"icon-sm"}),name:k.membersPageTitle}),r&&e.jsx(h,{route:"/admin/groups",icon:e.jsx(J,{className:"icon-sm"}),upsellEnterprise:!r,name:O({id:"aecR1i",defaultMessage:"Groups"})}),s&&e.jsx(h,{route:"/admin/billing",icon:e.jsx(De,{className:"icon-sm"}),name:k.billing}),s&&e.jsx(h,{route:"/admin/gpts",icon:e.jsx(Be,{className:"icon-sm"}),name:k.gpts}),s&&e.jsx(h,{route:"/admin/settings",icon:e.jsx(Ee,{className:"icon-sm"}),name:k.settings}),!r&&e.jsx("span",{className:"mx-3 border-t border-y-token-border-medium"}),!r&&e.jsx(h,{route:"/admin/groups",icon:e.jsx(J,{className:"icon-sm"}),upsellEnterprise:!r,name:O({id:"aecR1i",defaultMessage:"Groups"})}),n&&e.jsx(h,{route:"/admin/analytics",icon:e.jsx(Re,{className:"icon-sm"}),name:k.analytics,upsellEnterprise:!r}),s&&e.jsx(h,{route:"/admin/identity",upsellEnterprise:!r,icon:e.jsx(Te,{className:"icon-sm"}),name:k.identity})]})]})}function ia({mobilePageTitle:a,requireAdminPrivileges:n=!1,requireOwnerPrivileges:s=!1,children:o}){const t=_(y=>y.currentWorkspace),r=L(),i=t!=null?ze(t.role):void 0,d=t!=null?_e(t.role):void 0;return m.useEffect(()=>{n&&i===!1&&r("/admin"),s&&d===!1&&r("/admin")},[n,i,r,s,d]),z()==null?null:e.jsxs(e.Fragment,{children:[e.jsx(Pe,{mobileHeaderContent:a,forceOpenDesktopSidebar:!0,sidebar:e.jsx(Qe,{workspace:t??void 0,hasAdminPrivileges:i,hasOwnerPrivileges:d}),children:o}),t==null?null:e.jsx(Oe,{workspace:t})]})}const Xe=P.div`border-b border-token-main-surface-tertiary hidden md:block py-6 lg:py-10`,V=P.h2`mx-auto w-full max-w-4xl px-2 md:px-6 lg:px-10`,Ye=P(V)`font-normal text-base text-token-text-secondary`;P.p`text-sm text-token-text-tertiary`;function la({title:a,subtitle:n}){const{data:s}=He(),o=z(),t=o&&s&&s.plan_type===de.TEAM&&!s.will_renew;return e.jsxs(e.Fragment,{children:[t&&e.jsx(Je,{accountId:o.id,subscription:s}),e.jsxs(Xe,{children:[e.jsx(V,{children:a}),n&&e.jsx(Ye,{children:n})]})]})}const Ve=P.div`max-w-4xl mx-auto w-full px-2 md:px-6 lg:px-10`;function ca({children:a,showSpinner:n}){const s=z(),o=_(r=>r.currentWorkspace),t=!s||n;return e.jsxs(Ve,{children:[t&&e.jsx("div",{className:"flex min-h-[80vh] items-center justify-center",children:e.jsx(pe,{})}),!t&&!o&&e.jsx("div",{className:"flex min-h-[80vh] items-center justify-center",children:e.jsx(p,{...k.workspaceNotFound})}),!t&&o&&a]})}const k=D({workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},membersPageTitle:{id:"adminPage.membersPageTitle",defaultMessage:"Members"},analytics:{id:"adminPage.analytics",defaultMessage:"Analytics"},billing:{id:"adminPage.billing.1",defaultMessage:"Billing"},gpts:{id:"adminPage.gpts",defaultMessage:"GPTs"},settings:{id:"adminPage.Settings",defaultMessage:"Settings"},identity:{id:"adminPage.identity.0",defaultMessage:"Identity & provisioning"},availableForEnterprise:{id:"adminPage.availableForEnterprise",defaultMessage:"Available for Enterprise plan"}});export{ia as A,la as a,ca as b};
//# sourceMappingURL=ih6w9j289q7ibus7.js.map
