const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/n3pzy5yfc2kflva5.js","assets/dwbtt4oxebq3shuk.js","assets/dskg6kk1cd2zdyzo.js","assets/root-j9mwzlrj.css","assets/o7cy7ark1pzkeqyv.js","assets/lx77lh9ohr6roqdc.js","assets/conversation-small-o3h1ik6j.css","assets/mozqaizxwynipua1.js","assets/n7oj3qloikgwhrck.js","assets/c4bxzbp1808foto4.js","assets/kpsxnxa62pxsmacc.js","assets/l9ne3i9gzu9l74ka.js","assets/eudenekbnlgn7blt.js","assets/fgtoegpnoht02huk.js","assets/dktlydqngdib3a7v.js","assets/bkyhl9pm53ttxcc1.js"])))=>i.map(i=>d[i]);
import{j as e,r as d,ar as R,M as K,K as re,aq as oe,aF as W,R as A,ak as ie,ba as je,ao as le,ap as ce,J as de,aQ as ue,bz as U,aB as ye,I as Se,fK as j,m as me,fL as ge}from"./dwbtt4oxebq3shuk.js";import{jg as h,hV as Q,jh as X,ji as Ce,T as w,jj as we,l as _e,q as D,aR as xe,U as Ne,dg as ke,dh as De,di as Y,dj as Z,jk as Me,dk as Oe,cU as F,jl as Pe,jm as Le,jn as Te,aP as pe}from"./lx77lh9ohr6roqdc.js";import{S as J,c as fe,_ as Ae,a as ee,b as B,v as Re,d as te,g as Ie,e as Fe,u as Ve,f as $e}from"./dh881hlggc7x7r20.js";import{_ as Ee}from"./fzrn137102spawew.js";import{C as Ue}from"./o7cy7ark1pzkeqyv.js";import{bq as Be,b3 as he,b0 as qe,a4 as ze,p as Je}from"./dskg6kk1cd2zdyzo.js";import"./e9lafxuzyeh4418f.js";import"./j6uh9mvs1wxmv4tf.js";function We(){const t=h();return e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:["Force Use Search",!1]}),e.jsx(J,{id:"force-use-search",options:[{label:"Default",value:"default"},{label:"Force",value:"true"},{label:"Disable",value:"false"}],name:"force-use-search",className:"mt-1 shadow-none dark:text-gray-800",value:t.forceUseSearch==null?{value:"default",label:"Default"}:t.forceUseSearch?{value:"true",label:"Force"}:{value:"false",label:"Disable"},isMulti:!1,components:{Input:Ge},onChange:a=>{h.setState({forceUseSearch:(a?.value??"default")==="default"?null:a?.value==="true"})}})]})})}const Ge=t=>e.jsx(fe.Input,{...t,inputClassName:"focus:ring-0"});var He=["allowCreateWhileLoading","createOptionPosition","formatCreateLabel","isValidNewOption","getNewOptionData","onCreateOption","options","onChange"],ae=function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1?arguments[1]:void 0,s=arguments.length>2?arguments[2]:void 0,o=String(a).toLowerCase(),i=String(s.getOptionValue(r)).toLowerCase(),l=String(s.getOptionLabel(r)).toLowerCase();return i===o||l===o},q={formatCreateLabel:function(a){return'Create "'.concat(a,'"')},isValidNewOption:function(a,r,s,o){return!(!a||r.some(function(i){return ae(a,i,o)})||s.some(function(i){return ae(a,i,o)}))},getNewOptionData:function(a,r){return{label:r,value:a,__isNew__:!0}}};function Ke(t){var a=t.allowCreateWhileLoading,r=a===void 0?!1:a,s=t.createOptionPosition,o=s===void 0?"last":s,i=t.formatCreateLabel,l=i===void 0?q.formatCreateLabel:i,n=t.isValidNewOption,c=n===void 0?q.isValidNewOption:n,m=t.getNewOptionData,b=m===void 0?q.getNewOptionData:m,g=t.onCreateOption,f=t.options,u=f===void 0?[]:f,y=t.onChange,p=Ae(t,He),v=p.getOptionValue,x=v===void 0?Ie:v,M=p.getOptionLabel,O=M===void 0?Fe:M,S=p.inputValue,P=p.isLoading,L=p.isMulti,k=p.value,T=p.name,_=d.useMemo(function(){return c(S,ee(k),u,{getOptionValue:x,getOptionLabel:O})?b(S,l(S)):void 0},[l,b,O,x,S,c,u,k]),$=d.useMemo(function(){return(r||!P)&&_?o==="first"?[_].concat(B(u)):[].concat(B(u),[_]):u},[r,o,P,_,u]),I=d.useCallback(function(C,N){if(N.action!=="select-option")return y(C,N);var H=Array.isArray(C)?C:[C];if(H[H.length-1]===_){if(g)g(S);else{var E=b(S,S),ve={action:"create-option",name:T,option:E};y(Re(L,[].concat(B(ee(k)),[E]),E),ve)}return}y(C,N)},[b,S,L,T,_,g,y,k]);return te(te({},p),{},{options:$,onChange:I})}var Qe=d.forwardRef(function(t,a){var r=Ve(t),s=Ke(r);return d.createElement($e,Ee({ref:a},s))}),Xe=Qe;function Ye({children:t,sidebarOpen:a,onClose:r}){return e.jsx(Q.Root,{show:a,as:d.Fragment,children:e.jsxs(X,{as:"div",className:"relative z-10",onClose:r,children:[e.jsx("div",{className:"fixed inset-0"}),e.jsx("div",{className:"fixed inset-0 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 overflow-hidden",children:e.jsx("div",{className:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10",children:e.jsx(Q.Child,{as:d.Fragment,enter:"transform transition ease-in-out duration-100 sm:duration-300",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transform transition ease-in-out duration-300 sm:duration-500",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:e.jsx(X.Panel,{className:"pointer-events-auto w-screen max-w-md border-l border-gray-100 dark:border-gray-700",children:e.jsx("div",{className:"h-full overflow-y-auto bg-token-main-surface-primary shadow-xl",children:t})})})})})})]})})}function Ze({clientThreadId:t}){const{rebaseSystemMessageContent:a,showDebugConversationTurns:r}=h(),[s,o]=d.useState(()=>a?JSON.stringify(a,null,2):void 0),[i,l]=d.useState(!!a),n=Ce(t,w.getThreadCurrentLeafId(t)),m=we(n,u=>u.content.content_type===K.SystemContent)?.content??null,b=()=>{o(m?JSON.stringify(m,null,2):"")},g=re(),f=d.useMemo(()=>_e(u=>{try{u?h.setState({rebaseSystemMessageContent:{...JSON.parse(u),content_type:K.SystemContent}}):h.setState({rebaseSystemMessageContent:null}),g.closeAll()}catch{g.danger("The System Message is not valid JSON")}},500),[g]);return d.useEffect(()=>{i?f(s):(f.cancel(),h.setState({rebaseSystemMessageContent:null}))},[f,i,s]),e.jsxs("div",{className:"flex flex-col gap-3 px-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(oe,{label:"Enable to apply this system message to the current conversation.",children:e.jsx(D,{id:"enabled",label:"Enabled",checked:i,onChange:u=>l(u.currentTarget.checked)})}),e.jsx(D,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:r,onChange:()=>{h.setState({showDebugConversationTurns:!r})}})]}),e.jsx(W,{disabled:!m,className:"mt-2",onClick:b,size:"small",children:"Load active system message"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"System Message"}),e.jsx(et,{disabled:!i,placeholder:m?"Press `Load active system message` to pre-populate this":"Start a conversation and then press `Load active system message` to pre-populate this",className:"min-h-[75vh] rounded-md border border-gray-400 p-1 font-mono",value:s,onChange:u=>o(u.target.value)})]})]})}const et=R.textarea`w-full rounded-lg border border-token-border-light bg-token-main-surface-primary text-sm text-token-text-primary focus:border-token-text-primary focus:shadow-none focus:outline-none focus:ring-token-text-primary disabled:bg-token-main-surface-tertiary`;function tt({clientThreadId:t}){const[a,r]=d.useState([]),s=w.getThreadCurrentLeafId(t),o=w.getThreadConversationTurns(t,s),i=n=>{const m=w.getTree(t).getLeafFromNode(n);w.setThreadCurrentLeafId(t,m.id)},l=n=>{r(c=>[...c,s]),i(n)};return e.jsxs(e.Fragment,{children:[a.length>0&&e.jsxs(W,{className:"absolute left-2 top-2",color:"secondary",onClick:()=>{const n=a[a.length-1];i(n),r(c=>c.slice(0,-1))},children:[e.jsx(Be,{className:"icon-sm"}),"Go back to ",a[a.length-1]]}),e.jsx("div",{className:"flex flex-col items-center gap-4 overflow-auto p-4 text-xs",children:o.map((n,c)=>{const m=n.messages[0].nodeId,b=w.getTree(t),g=c!==0?b.getParent(m):null,f=g!=null?g.children.findIndex(x=>m===x):0,u=g!=null?g.children:[],y=u.slice(0,f),p=u.slice(f+1);let v;switch(n.role){case A.User:v="bg-blue-500";break;case A.Assistant:v="bg-gray-600";break;default:v="bg-gray-400";break}return e.jsxs("div",{className:ie("relative p-2",v),children:[e.jsx("div",{className:"absolute bottom-0 left-0 -ml-2 flex -translate-x-full gap-2 pl-2",children:y.map(x=>e.jsx(se,{variantId:x,onChangeItemInView:l},x))}),e.jsx("div",{className:"absolute left-full top-0 ml-2 flex gap-2 pr-2",children:p.map(x=>e.jsx(se,{variantId:x,onChangeItemInView:l},x))}),e.jsx("div",{className:"flex flex-col gap-2",children:n.messages.map(x=>e.jsxs("div",{className:"h-14 w-32 truncate bg-gray-200 p-1 text-black",children:[e.jsx("div",{className:"font-semibold",children:x.nodeId}),e.jsx("div",{className:"italic text-token-text-tertiary",children:x.message.author.role}),e.jsx("div",{children:xe(x.message)})]},x.nodeId))})]},c)})})]})}function se({variantId:t,onChangeItemInView:a}){return e.jsx("button",{className:"w-32 truncate bg-gray-400 p-2 text-black opacity-50 hover:opacity-100",onClick:()=>{a(t)},children:e.jsx("span",{className:"bg-gray-200 p-2",children:t})},t)}const at=le(()=>ce(()=>import("./n3pzy5yfc2kflva5.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])).then(t=>t.DebugModalContents)),st=le(()=>ce(()=>import("./bkyhl9pm53ttxcc1.js"),__vite__mapDeps([15,1,2,3,5,6])).then(t=>t.FramesViewer));function Ct(){return e.jsx("button",{"data-testid":"open-debug-sidebar-button",className:"flex h-6 w-6 items-center justify-center rounded-full border border-token-border-light text-xs text-token-text-secondary",onClick:()=>{Ne.setActiveSidebar("debug")},children:e.jsx(he,{className:"icon-xs"})})}function nt({children:t,title:a,icon:r,isOpen:s,slideOver:o,onClose:i}){const l=e.jsxs(mt,{children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 text-lg font-semibold text-gray-900 dark:text-white",children:[e.jsx(r,{className:"icon-sm"}),a]}),e.jsx("div",{className:"mr-2 mt-2 flex h-7 items-center",children:e.jsx(je,{onClick:i})})]}),t]});return o?e.jsx(Ye,{sidebarOpen:s,onClose:i,children:l}):s?l:null}function rt({nodes:t,setDebugNodeIndex:a,setFrameSrc:r,conversationId:s}){const o=t.map((i,l)=>{const n=i.message,{role:c,name:m}=n.author,b=m&&m!==c,g=j(n,"metadata.__internal.model_id"),f=j(n,"metadata.__internal.agent.settings.completion_api.engine"),u=j(n,"metadata.__internal.model_experiment_name"),y=j(n,"metadata.__internal.model_experiment_treatment"),p=j(n,"metadata.__internal.normalized_model_side"),v=j(n,"metadata.__internal.alternative_model_selection_rule"),x=j(n,"metadata.__internal.model_experiment_group_name"),M=j(n,"metadata.__internal.model_experiment_group_params"),O=j(n,"metadata.__internal.model_experiment_override"),S=j(n,"metadata.__internal.model_experiment_eval_seq"),P=j(n,"metadata.__internal.raw_tokens")?.length,L=j(n,"metadata.request_id"),k=j(n,"metadata.__internal.search_settings"),T=F.getAudio(n),_=F.getAudioAssetPointers(n),$=F.getFrameAssetPointers(n),I=F.getVideoContainerAssetPointers(n);return e.jsxs(xt,{role:"button",onClick:()=>a(l),children:[e.jsxs("div",{className:ie("flex items-center gap-1 break-words text-xs font-semibold uppercase",c===A.User?"text-token-text-primary":"text-token-text-tertiary"),children:[c===A.User&&e.jsx(Je,{className:"icon-sm"}),c,b&&` (${m})`,n.recipient&&" -> ",Pe(n)]}),(n.author.role!==A.System||L)&&e.jsxs("div",{className:"text-xs text-token-text-tertiary",children:[e.jsxs("div",{children:["ID: ",n.id]}),i.id!==n.id&&e.jsxs("div",{children:["UI Node ID: ",i.id]}),e.jsxs("div",{children:["Req ID: ",L||"Reload page to see ID"]})]}),e.jsx("div",{className:"line-clamp-6",children:xe(n)}),(P||g||f||u||y||p||v||x||M||O||S||k)&&e.jsxs("div",{className:"mt-4 w-full self-start rounded-xl bg-blue-200 px-3 py-0.5 text-xs text-black",children:[P!==void 0&&e.jsxs("div",{children:[e.jsx("b",{children:"Tokens Count:"})," ",P]}),g&&e.jsxs("div",{children:[e.jsx("b",{children:"Model ID:"})," ",g]}),f&&e.jsxs("div",{children:[e.jsx("b",{children:"Engine:"})," ",f]}),u&&e.jsxs("div",{children:[e.jsx("b",{children:"Experiment:"})," ",u]}),y&&e.jsxs("div",{children:[e.jsx("b",{children:"Treatment:"})," ",y]}),p&&e.jsxs("div",{children:[e.jsx("b",{children:"Normalized Side:"})," ",p]}),v&&e.jsxs("div",{children:[e.jsx("b",{children:"Alternative Model Rule:"})," ",v]}),x&&e.jsxs("div",{children:[e.jsx("b",{children:"Group Name:"})," ",x]}),M&&e.jsxs("div",{children:[e.jsx("b",{children:"Group Params:"}),e.jsx("div",{children:JSON.stringify(M,null,2)})]}),O&&e.jsxs("div",{children:[e.jsx("b",{children:"Above Params are Overridden By:"})," ",O]}),S&&e.jsxs("div",{children:[e.jsx("b",{children:"Experiment Eval Seq:"})," click to see"]}),k&&e.jsxs("div",{children:[e.jsx("b",{children:"Search Settings:"}),e.jsx("div",{children:JSON.stringify(k,null,2)})]})]}),T.length||_.length||I.length?e.jsxs("div",{className:"mt-4 flex flex-col flex-nowrap gap-2",children:[e.jsx(dt,{frameAssets:$,setFrameSrc:r},l),T.map((C,N)=>e.jsx(V,{audio:C,conversationId:s},`audio-asset-${N}`)),_.map((C,N)=>e.jsx(V,{assetPointer:C,conversationId:s},`audio-${N}`)),I.map((C,N)=>e.jsx(ut,{assetPointer:C},`video-asset-${N}`))]}):null]},n.id)});return e.jsx(gt,{children:o})}const z=t=>e.jsx(fe.Input,{...t,inputClassName:"focus:ring-0"});function ot(){const t=h(),r=Le().map(s=>({label:s.name,options:s.options.map(o=>({label:`${o.value} (${o.name})`,value:o.value}))}));return e.jsxs("div",{className:"mt-2 flex flex-col justify-around gap-3 px-4 py-1 text-xs font-semibold",children:[e.jsx(D,{id:"force-paragen",label:"Force Parallel Gen",checked:t.forceParagen,onChange:()=>{h.setState({forceParagen:!t.forceParagen})}}),e.jsx(Xe,{options:r,name:"force-paragen-model",className:"shadow-none dark:text-gray-800",isDisabled:!t.forceParagen,isLoading:r.length===0,value:t.forceParagenModel,isClearable:!0,isMulti:!1,components:{Input:z},onChange:s=>{h.setState({forceParagenModel:s??Te})}}),t.forceParagen?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Paragen Stream Type:"}),e.jsx(J,{options:[{label:"Do Not Override",value:"none"},{label:"Force Classic Stream Behavior",value:"default"},{label:"Wait for Assistant",value:"wait_for_assistant"},{label:"Interleave",value:"interleave"}],name:"paragen-stream-type",className:"shadow-none dark:text-gray-800",value:t.paragenStreamType==="none"?{value:"none",label:"Do Not Override"}:t.paragenStreamType==="default"?{value:"default",label:"Force Classic Stream Behavior"}:t.paragenStreamType==="wait_for_assistant"?{value:"wait_for_assistant",label:"Wait for Assistant"}:{value:"interleave",label:"Interleave"},isMulti:!1,components:{Input:z},onChange:s=>{h.setState({paragenStreamType:s?.value??"none"})}})]}):null,t.forceParagen?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Show CoT in Paragen:"}),e.jsx(J,{options:[{label:"Allow",value:"allow"},{label:"Hide CoT for Alter Model",value:"hide_alter"},{label:"Hide",value:"hide"}],name:"paragen-stream-type",className:"shadow-none dark:text-gray-800",value:t.paragenCotSummaryDisplay==="allow"?{value:"allow",label:"Allow"}:t.paragenCotSummaryDisplay==="hide_alter"?{value:"hide_alter",label:"Hide CoT for Alter Model"}:{value:"hide",label:"Hide"},isMulti:!1,components:{Input:z},onChange:s=>{h.setState({paragenCotSummaryDisplay:s?.value??"allow"})}})]}):null,e.jsx(D,{id:"show-paragen-metadata",label:"Show Paragen Metadata",checked:t.showParagenMetadata,onChange:()=>{h.setState({showParagenMetadata:!t.showParagenMetadata})}}),e.jsx(We,{}),e.jsx(D,{id:"force-rate-limit",label:"Force Rate Limit",checked:t.forceRateLimit,onChange:()=>{h.setState({forceRateLimit:!t.forceRateLimit})}}),e.jsx(D,{id:"reset-rate-limit",label:"Reset Rate Limits",checked:t.resetRateLimits,onChange:()=>{h.setState({resetRateLimits:!t.resetRateLimits})}}),e.jsx(oe,{label:"Enabling this will show debug conversation messages in the chat",children:e.jsx(D,{id:"show-internal-conversation-turns",label:"Conversation debug mode",checked:t.showDebugConversationTurns,onChange:()=>{h.setState({showDebugConversationTurns:!t.showDebugConversationTurns})}})})]})}const ne=R.div`px-3 pb-2 text-xs font-semibold uppercase border-b-2 ${({$isSelected:t})=>t?"border-black dark:border-white":"border-transparent"}`;function wt({clientThreadId:t,isOpen:a,slideOver:r,onClose:s}){const o=de(),i=ue(),[l,n]=d.useState("conversation");return i?.includes("debug")?e.jsx(nt,{icon:he,title:o.formatMessage(G.debugTitle),isOpen:a,slideOver:r,onClose:s,children:e.jsxs(ke,{orientation:"vertical",defaultValue:l,onValueChange:c=>n(c),children:[e.jsxs(De,{className:"mb-4 flex items-center justify-center gap-2 px-2 py-1 text-xs",children:[e.jsx(Y,{value:"conversation",children:e.jsx(ne,{$isSelected:l==="conversation",children:"Conversation"})}),e.jsx(Y,{value:"system-message-editor",children:e.jsx(ne,{$isSelected:l==="system-message-editor",children:"System Message"})}),!1]}),e.jsx(Z,{value:"conversation",children:e.jsx(it,{clientThreadId:t})}),e.jsx(Z,{value:"system-message-editor",children:e.jsx(Ze,{clientThreadId:t})}),!1]})}):null}function it({clientThreadId:t}){const a=de(),r=w.getThreadCurrentLeafId(t),s=Me(t,r),[o,i]=d.useState(),l=ue(),n=d.useCallback(()=>{i(void 0)},[]),c=re(),m=d.useCallback(p=>{const v=w.getTree(t);Oe(v.getTextFromThread(r),c,p)},[r,t,c]),[b,g]=d.useState(!1),[f,u]=d.useState(void 0);return l?.includes("debug")?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-2 flex items-center justify-around px-4 py-1 text-xs font-semibold uppercase",children:e.jsx(ct,{clientThreadId:t,messages:s.map(p=>p.message)})}),!1,e.jsxs("div",{className:"flex items-center justify-around gap-2 px-4 py-1 text-xs font-semibold uppercase",children:[e.jsx("div",{children:e.jsx(Ue,{onCopy:m,buttonText:a.formatMessage(G.copyText)})}),e.jsxs("button",{className:"flex items-center justify-center gap-2",onClick:()=>g(!0),children:[e.jsx(qe,{className:"icon-sm rotate-90"}),"View tree"]})]}),e.jsx(ot,{}),e.jsx(rt,{nodes:s,setDebugNodeIndex:i,setFrameSrc:u,conversationId:w.getServerThreadId(t)}),o!==void 0&&e.jsx(U,{type:"success",size:"fullscreen",noPadding:!0,isOpen:!0,onClose:n,children:e.jsx(at,{threadId:s[o].message.metadata?.__internal?.sonic_thread_id,threadUserId:s[o].message.metadata?.__internal?.sonic_user_id,onClose:n,message:s[o].message})},`DebugMessageModal-${o}`),b&&e.jsx(U,{isOpen:!0,onClose:()=>g(!1),type:"success",size:"custom",noPadding:!0,children:e.jsx(tt,{clientThreadId:t})},"DebugTreeViewer"),f&&e.jsx(U,{size:"normal",isOpen:!0,onClose:()=>u(void 0),type:"success",children:e.jsx("img",{src:f,alt:"debug image"})},"DebugFrameViewer")]}):null}function lt(t,a){const r=JSON.stringify({conversation_id:w.getServerThreadId(t),messages:a},null,2),s=new Blob([r],{type:"application/json"}),o=URL.createObjectURL(s),i=document.createElement("a");i.href=o,i.download=`messages-${w.getServerThreadId(t)}.json`,i.click(),URL.revokeObjectURL(o)}function ct({clientThreadId:t,messages:a}){const r=d.useCallback(()=>{lt(t,a)},[t,a]);return e.jsx(W,{onClick:r,color:"primary",size:"small",icon:ze,children:e.jsx(ye,{...G.downloadRawConversation})})}function dt(t){const[a,r]=d.useState([]),s=me(),{frameAssets:o}=t;return d.useEffect(()=>{async function i(){const l=o.map(async({image_asset_pointer:n,timestamp:c})=>{const m={asset:n};return{src:(await pe.fetch(s,m)).url,timestamp:c}});return Promise.all(l)}o.length>0&&i().then(r)},[o,s]),e.jsx(st,{frames:a,setFrameSrc:t.setFrameSrc})}function V(t){const a=be(t.assetPointer,t.conversationId),r=V.useAudioSource(t.audio),s=a??r,i=ge("3230069703").config.value.expirySeconds,[l,n]=d.useState(Date.now()),c=d.useRef(null);return d.useEffect(()=>{const m=setInterval(()=>{c.current&&c.current.currentTime>0&&!c.current.paused&&!c.current.ended&&c.current.readyState>2||n(Date.now())},i*1e3);return()=>clearInterval(m)},[i]),s?e.jsx("audio",{ref:c,controls:!0,src:s,className:"w-full"},l):null}function be(t,a){const[r,s]=d.useState(null),o=me();return d.useEffect(()=>{t&&pe.fetch(o,{asset:t,conversationId:a}).then(i=>{s(i.url)})},[o,t,a]),r}V.useAudioSource=t=>{const[a,r]=d.useState(null);return d.useEffect(()=>{if(t){const s=atob(t.payload),o=new Uint8Array(s.length);for(let n=0;n<s.length;n++)o[n]=s.charCodeAt(n);const i=new Blob([o],{type:`audio/${t.format}`}),l=URL.createObjectURL(i);return r(l),()=>{URL.revokeObjectURL(l)}}},[t]),a};function ut(t){const a=be(t.assetPointer,t.conversationId),s=ge("3230069703").config.value.expirySeconds,[o,i]=d.useState(Date.now()),l=d.useRef(null);return d.useEffect(()=>{const n=setInterval(()=>{l.current&&l.current.currentTime>0&&!l.current.paused&&!l.current.ended&&l.current.readyState>2||i(Date.now())},s*1e3);return()=>clearInterval(n)},[s]),a?e.jsx("video",{ref:l,controls:!0,src:a,className:"w-full"},o):null}const mt=R.div`overflow-y-auto h-full md:w-[250px] lg:w-[300px] xl:w-[350px] 2xl:w-[400px] md:border-l md:border-gray-100 md:dark:border-gray-700 popover bg-token-main-surface-primary`,gt=R.pre`whitespace-pre-wrap text-sm`,xt=R.div`px-6 py-4 flex flex-col gap-1 hover:bg-gray-50 dark:hover:bg-gray-500/10 cursor-pointer border-b dark:border-white/10 border-gray-200`,G=Se({debugTitle:{id:"DebugSidebar.debugTitle",defaultMessage:"Debug"},copyText:{id:"DebugSidebar.copyText",defaultMessage:"Copy text"},downloadRawConversation:{id:"DebugSidebar.downloadRawConversation",defaultMessage:"Download raw conversation"},uploadRawConversation:{id:"DebugSidebar.uploadRawConversation",defaultMessage:"Upload conversation dump"},closeSidebar:{id:"DebugSidebar.closeSidebar",defaultMessage:"Close sidebar"}});export{it as DebugConversation,wt as DebugConversationSidebar,Ct as OpenDebugSidebarButton,nt as default};
//# sourceMappingURL=euvd84l1vd9ku2zf.js.map
