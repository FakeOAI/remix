const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/n51a19bmr44d3t3e.js","assets/sj4egp330zr3hymf.js","assets/root-gxxjueqp.css","assets/ohfy421oyz5q6uux.js","assets/conversation-small-ile61fj8.css","assets/lwwm0pc79h5gzvci.js","assets/lo1c2e117npgmgjl.js","assets/d89062140w2dicqy.js","assets/edzdph5rs0n89q6j.js","assets/d422vlbtt271j9aw.js","assets/fyuyu14xgxrq03io.js","assets/higzg9p26dh4k0zy.js","assets/muvy4qzgls86chgu.js","assets/jgtdmbwjtz8r8ewv.js","assets/d6oroinh14lw2dr0.js","assets/hvcfpboy784ti5qg.js","assets/fg7m3qxdgr8acacb.js","assets/e9za2ikcgrlskzzf.js","assets/cjo5kvw2o92a0953.js","assets/dr4jl4ly38rp4ncz.js","assets/c4bxzbp1808foto4.js","assets/f9tzv51w8c0wtfyi.js","assets/k9b45iweccpyfogl.js","assets/hnztt3137zc4uwyt.js","assets/ofb8e1zr68997o6g.js","assets/ma0s76orva63ppzy.js","assets/fc93tduihgcgsfo0.js","assets/dp0oj6mjz2hv91sw.js","assets/cblsnf9ya9bt390k.js","assets/nngiw7gst4gpc7f7.js","assets/ocz8r2dv4tep4dhz.js","assets/lz5m5fte6cwvax3q.js","assets/hxz3vhc9ci9ie2uu.js","assets/maqvzo8ucjaq2m1m.js","assets/accgjc51sspjav90.js","assets/j573n0nvcc2pb880.js","assets/ex1x3ei3e1p4cu2q.js","assets/mk01ochx6b5y44dh.js","assets/nbnzbjtk43rlwmeo.js","assets/h0hmu393bwgisx9z.js","assets/ok5wx7tg75x5gj40.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/hi9iar4thyd62jy7.js","assets/ld39qu8s3886qs3q.js","assets/krglaqwify041lpx.js","assets/bdobjn3dzkcbjxyh.js","assets/dhbbe0yycs6nvg75.js"])))=>i.map(i=>d[i]);
import{aJ as ge,hS as $r,m as e,r as i,P as K,e as X,bp as H,bR as po,aC as Rs,aD as at,hT as sa,d3 as fo,c as Yr,d as Kr,dq as Te,bU as sn,L as fe,K as Ie,e9 as nn,bd as Pe,aA as it,ds as _t,s as ee,o as He,bG as Xr,aE as I,ee as Ue,co as Qr,aL as Yt,bD as Rt,b3 as Oe,b4 as ze,ai as yn,bs as Kt,eJ as Xt,ae as on,bC as xo,gA as Zr,gy as Jr,f8 as ei,cQ as ti,a5 as Is,O as na,aa as oa,a9 as wn,b6 as aa,aw as lt,ex as si,gw as jn,hU as ni,at as Qe,eT as oi,bF as ys,c$ as ai,d0 as ri,d1 as ii,bl as li,bE as ci,c3 as We,u as js,hV as di,ah as kt,hW as ui,V as de,cw as mi,D as an,gH as ra,au as ia,e8 as la,fw as hi,a2 as gi,af as vo,w as ca,hX as pi,hY as fi,d_ as Qt,gl as xi,hZ as da,b5 as Ps,g0 as vi,gk as Ds,bA as Ve,ax as Cn,g_ as Mn,y as Tn,ad as Xe,bm as So,az as Tt,W as Nt,v as Si,n as Ct,gh as ua,eg as bi,b8 as yi,ef as Cs,bq as wi,cT as ma,c4 as re,cy as ji,gr as Ci,h_ as Mi,a4 as _n,a7 as Qs,aI as ha,em as Ti,h$ as bo,dn as _i,ag as ki,fn as ga,Z as Ni,i0 as Ai,fr as Ei,bV as Ri,i1 as yo,e6 as rn,ei as Ii,l as Ke,d8 as Pi,e7 as Ms,bL as us,M as pa,aB as Di,bu as Li,i2 as Bi,f5 as Fi,cY as Hi,i3 as Ui,bt as Oi,i4 as zi,i5 as fa,gv as kn,N as Nn,i6 as Gi,i7 as Wi,df as Vi,bo as qi,i8 as $i,fz as Fe}from"./sj4egp330zr3hymf.js";import{aJ as It,gU as Yi,l_ as Ki,l$ as Xi,aO as Zt,m0 as Qi,jG as xa,jJ as va,eq as Zi,B as Ji,fq as el,jF as tl,m1 as ye,m2 as At,m3 as sl,m4 as nl,m5 as ol,m6 as al,m7 as rl,m8 as il,m9 as ll,ma as cl,mb as dl,mc as se,md as Sa,me as ba,d1 as ul,f0 as ml,mf as hl,mg as gl,mh as pl,mi as fl,lF as xl,mj as ya,mk as vl,x as Sl,lD as bl,kG as wa,iv as yl,cO as Et,ml as ja,mm as Ca,cK as Ls,bD as Vt,mn as Ts,mo as Be,ih as Ma,mp as Ta,mq as wl,mr as jl,ms as _s,mt as Cl,mu as Ml,mv as Tl,mw as _l,es as kl,mx as Nl,my as Al,mz as El,mA as Rl,mB as An,fx as En,mC as Il,mD as Rn,i8 as In,i9 as rt,ia as Pn,bN as Pl,mE as _a,lG as ln,mF as ka,mG as Dl,mH as ks,mI as Ll,bp as Dn,bq as Na,dv as Bl,d9 as Fl,dw as Aa,c3 as Ea,bs as Ln,gZ as Jt,mJ as wo,mK as Hl,mL as Ul,bx as jo,bu as Ol,iz as zl,jP as Co,mM as Gl,mN as Wl,mO as Vl,mP as Bn,mQ as ql,mR as $l,bB as Ra,gd as Fn,fM as Hn,mS as Mo,ji as Yl,bt as Kl,mT as Xl,iC as Ql,jV as Zl,iD as Jl,iA as ec,mU as tc,bv as cn,mV as sc,mW as nc,mX as oc,mY as ac,co as rc,b7 as dn,mZ as ic,ch as Un,U as Ns,bQ as On,cR as lc,cJ as zn,m_ as cc,m$ as dc,n0 as uc,ib as mc,n1 as hc,n2 as gc,n3 as pc,n4 as fc,n5 as xc,n6 as vc,dm as Sc,iu as bc,k$ as yc,n7 as wc,n8 as jc,n9 as Cc,cw as Ia,na as Mc,fz as Gn,nb as Tc,fy as _c,nc as kc,nd as Nc,ne as un,nf as Ac,ng as Ec,cM as mn,nh as Rc,ni as Ic,nj as Pc,nk as Pa,iP as Wn,cP as qt,nl as Dc,nm as Lc,nn as Bc,r as Fc,no as hn,i as Da,np as Vn,nq as To,nr as Hc,ns as Uc,nt as Oc,nu as zc,cI as Gc,nv as Wc,nw as Vc,cL as Bs,cB as ws,cd as qc,iS as $c,nx as Yc,aR as _o,dB as La,dj as Kc,eP as Xc,ny as Qc,aX as qn,nz as $n,br as Yn,ij as Zc,cv as Jc,dC as ed,nA as td,nB as sd,aB as nd,nC as Ye,aV as od,nD as ad,nE as gn,nF as rd,nG as ms,nH as Ba,nI as id,gH as ld,nJ as cd,jj as hs,nK as dd,aT as ud,c_ as md,nL as hd,fl as gd,o as pd,nM as fd,nN as xd,fh as vd,nO as Sd,nP as bd,c9 as yd,nQ as wd,nR as Fa,nS as Ha,nT as Ua,nU as Oa,nV as Mt,eT as Kn,nW as jd,jX as Cd,nX as za,nY as Md,gg as As,nZ as pn,n_ as Td,n$ as _d,o0 as kd,o1 as Nd,o2 as ko,o3 as gs,bR as No,c1 as Ga,c2 as Wa,gt as Va,gv as qa,gR as Ad,o4 as Ed,gM as Rd,o5 as Id,o6 as Pd,o7 as Dd,o8 as Ld,o9 as Bd,bo as Fd,dl as Hd,gf as Ud,bS as Od,oa as zd,gS as ps,gs as Gd,gu as Wd,gD as Vd,ob as qd,oc as $d,od as Yd,oe as Kd,of as Xd,og as Qd,oh as Zd,oi as Jd,oj as eu,ok as tu,bz as su,kA as nu,kz as ou,ol as au,h2 as ru,om as iu,on as lu,oo as $a,w as cu,g1 as du,i0 as uu,i1 as mu,op as hu,oq as gu,or as Ya,bC as pu,os as Ka,ot as fu,ou as xu,ov as vu,c7 as Su,c8 as bu,c6 as yu,cb as wu,ow as ju,cF as Es,fo as Cu,bT as Mu,bU as Tu,jd as _u,kE as ku,ox as Nu,i5 as Au,oy as Eu,oz as Ru,oA as Iu,oB as Pu,oC as Du,oD as Lu,aD as Bu,fi as Fu,bV as Hu}from"./ohfy421oyz5q6uux.js";import{B as Uu}from"./edzdph5rs0n89q6j.js";import{m as ne}from"./d422vlbtt271j9aw.js";import{C as fn,g as Ou}from"./fyuyu14xgxrq03io.js";import{S as Xa,a as zu,b as Gu,G as Wu,L as Vu,c as qu}from"./higzg9p26dh4k0zy.js";import{h as $u,i as Xn,s as Yu,j as Ku,k as fs,l as Xu,m as Qu,t as Zu,n as Fs,C as Qa,u as Za,o as Ju,p as em,c as Ja}from"./muvy4qzgls86chgu.js";const Ao=ge.div`m-8 flex flex-col items-center`;function Eo(t){return e.jsx(ne.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...t})}function tm({clientThreadId:t}){const o=$r(t)?.gizmoId,{data:n}=It(o);return o==null||n==null||!Yi(n)?null:e.jsx(sm,{gizmoId:o})}function sm({gizmoId:t}){const[s,o]=i.useState(!1),[n,a]=i.useState(!1),r=Ki(t),l=async u=>{o(!0),setTimeout(()=>{a(!0)},5e3),K.logEvent(X.submitInlineRating,{gizmo_id:t,rating:u}),await r.mutateAsync({rating:u})},c=async()=>{a(!0),K.logEvent(X.dismissInlineRating,{gizmo_id:t}),await r.mutateAsync({})};return i.useEffect(()=>{n||K.logEvent(X.showInlineRating,{gizmo_id:t})},[n,t]),n?null:s?e.jsx(Ao,{children:e.jsxs(Eo,{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"rounded-lg border border-token-border-heavy p-4",children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(H,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),e.jsx(po,{onClick:()=>{a(!0)}})]})}),e.jsx("div",{className:"text-xs text-token-text-tertiary",children:e.jsx(H,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):e.jsx(Ao,{children:e.jsxs(Eo,{className:"flex flex-col items-center gap-4 rounded-lg border border-token-border-heavy p-4",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(H,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),e.jsx(po,{onClick:c})]}),e.jsx(Xi,{rating:void 0,onRating:l})]})})}const nm=({clientThreadId:t})=>{const s=sa(),o=Rs(t),n=at(o);i.useEffect(()=>{n&&fo.dismissBanner()},[n]);const a=s?.is_dismissible?()=>fo.dismissBanner():void 0;return e.jsx(Zt,{children:s&&e.jsx(ne.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:e.jsx(Qi,{clientThreadId:t,rateLimitInfo:s,onDismiss:a})})})};function om(t){const s=Rs(t),o=at(s),n=sa();return!o&&n!=null}const xn=window.sessionStorage,vn=Yr(Kr(()=>({memoryFullBannerDismissed:!!xn?.getItem(sn.MemoryFullBannerDismissed)}))),er={dismissBanner(){vn.setState(t=>{t.memoryFullBannerDismissed=!0}),xn?.setItem(sn.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){vn.setState(t=>{t.memoryFullBannerDismissed=!1}),xn?.removeItem(sn.MemoryFullBannerDismissed)}};function am(t){const s=Te(t),o=xa(),{data:n}=va(s,!1,o),a=n!=null,r=a&&n.memoryFullPct>=100,[l,c]=i.useState(!1);i.useEffect(()=>{!r&&a&&(c(!0),er.clearDismissedBanner())},[r,a]);const u=vn(m=>m.memoryFullBannerDismissed);return r&&l&&!u}function rm(){const t=fe(),{openSettings:s}=Zi();return e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(Ji,{title:t.formatMessage(xs.memoryFullTitle),content:t.formatMessage(xs.memoryFullTooltip,xs.memoryFullTooltip.values),primaryCtaText:t.formatMessage(xs.memoryManageButton),onPrimaryCtaClick:()=>s(el.Personalization),onDismiss:()=>er.dismissBanner()})})}const xs=Ie({memoryFullTitle:{id:"yRGU2/",defaultMessage:"Memory is full."},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"neUc+N",defaultMessage:"New memories won’t be created until you make space. <a>Learn more</a>",values:{a:t=>e.jsx("a",{href:tl,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}}),im=i.memo(function(s){return lm(s),cm(s),dm(),null});function lm(t){const{store:s}=ye(),o=s.useSetSharedProps();nn(()=>{o(t)},[t,o])}function cm(t){const{clientThreadId:s,canContinue:o}=t,{store:n}=ye(),a=i.useRef({top:n.useContentAreaApi(At.HeaderTop),bottom:n.useContentAreaApi(At.HeaderBottom)}).current,r=hm(t),l=sl(s),{shouldShowBannerSignup:c,shouldShowBannerTermsDisclaimer:u}=gm(s),m=om(s),d=nl(t),h=ol(t),g=al(t),b=am(s),v=rl(),x=il(t);nn(()=>{x.eligible?a.top.set(se.AdvancedVoiceOnMobileAnnouncement):v?a.top.set(se.ParagenControls):u?a.top.set(se.BannerTermsDisclaimer):m?a.top.set(se.BannersRateLimit):d.eligible?a.top.set(se.BannerSidekickAnnouncement):h?a.top.set(se.SearchBrowserExtensionAnnouncement):g?a.top.set(se.SearchBrowserExtensionReactiveAnnouncement):r?a.top.set(se.ItemActions):o?a.top.set(se.PromptTextareaAction):c?a.top.set(se.BannerSignup):b?a.top.set(se.BannerMemoryFull):a.top.set(null)},[a,r,o,u,c,m,d,b,v,x]),nn(()=>{l&&a.bottom.set(Sa.DallePromptControls)},[a,l])}function dm(){const{store:t}=ye();i.useEffect(()=>()=>{t.reset()},[t])}function um(t){const s=ba(),o=it(t),n=ee.getTree(t).getLastValidNode(o)?.message?.id;return s?.messageId===n?s.suggestions:[]}function mm(t){return um(t).length>0}function hm(t){const s=ll(t.clientThreadId),o=mm(t.clientThreadId);return t.isDisabled?!1:t.isNewThread||s||o}function gm(t){const{isUnauthenticated:s}=Pe(),o=it(t),{layer:n}=_t("3637408529"),a=n.get("should_show_no_auth_signup_banner",!0),r=cl(g=>g.bannerDisclaimerClientThreadId),l=dl(),c={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1};if(!t)return c;const u=ee.getTree(t),m=u.countMessagesByAuthor(He.User),d=u.getNodeByIdOrMessageId(o),h=d?.message?.author.role===He.Assistant&&Xr(d.message);return c.shouldShowBannerTermsDisclaimer=h&&s&&m===1&&!l&&(r==null||r===t),c.shouldShowBannerSignup=a&&h&&s&&m>0&&m%5===0,c}function pm({children:t,className:s,showBackground:o}){return e.jsxs("div",{className:"relative",children:[t,o&&e.jsx(ne.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:I("pointer-events-none absolute bottom-0 top-0 h-8 w-8 rounded-full",s)})]})}function fm({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:o,modelSupportedImageMimeTypes:n,attachmentsProductFeature:a,getInputProps:r,openFileDialog:l,onOauthRedirect:c,historyDisabled:u,isDisabled:m,highlightTooltip:d}){const h=ul(),{gdriveStatus:g,o365Status:b}=ml(),v=e.jsx(pl,{className:u?"text-white":d?"text-brand-blue-800":void 0}),x=g!=="false"||b!=="false"||h;return e.jsx("div",{className:"relative",children:e.jsx(pm,{showBackground:d,className:"bg-brand-blue-800/20",children:x?e.jsx(hl,{clientThreadId:t,icon:v,modelAcceptedMimeTypes:o,modelSupportedImageMimeTypes:n,attachmentsProductFeature:a,onOauthRedirect:c,uploadType:s,openFileDialog:l,getInputProps:r,isDisabled:m,highlightTooltip:d}):e.jsx(gl,{clientThreadId:t,uploadType:s,openFileDialog:l,getInputProps:r,icon:v,isDisabled:m,highlightTooltip:d})})})}const xm=i.forwardRef(function({type:s,placeholder:o,replyRegions:n,state:a,renderFiles:r,leftSideActions:l,topRightAction:c,onSubmit:u,inputState:m,currentLeafId:d,composerController:h,clientThreadId:g,gizmoId:b,disableReason:v},x){const E=Ue(),w=fl();let k=null;const{isLoading:y}=w;y||(k=w.modelId),i.useEffect(()=>{y||xl()||h.focus()},[k,h,y]);const S=T=>{jm({target:T.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||h.focus()};return e.jsxs("div",{id:"composer-background",ref:x,className:I("flex w-full cursor-text flex-col rounded-3xl px-2.5 py-1 transition-colors contain-inline-size",E&&"backdrop-blur-2xl no-transparency:backdrop-blur-none",E&&s!=="temporary"&&"bg-token-composer-surface",!E&&s!=="temporary"&&"bg-[#f4f4f4] dark:bg-token-main-surface-secondary",s==="temporary"&&"dark bg-black"),onClick:S,children:[e.jsx(Zt,{initial:!1,children:n.length>0&&e.jsx(ne.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:e.jsx(Sm,{replyRegions:n})})}),e.jsxs(e.Fragment,{children:[r,e.jsxs("div",{className:"flex min-h-[44px] items-start pl-2",children:[e.jsx("div",{className:"min-w-0 max-w-full flex-1",children:h instanceof ya?e.jsx(vm,{composerController:h,currentLeafId:d,placeholder:o,inputState:m}):e.jsx($u,{composerController:h,placeholder:o})}),e.jsx("div",{className:"w-[32px] pt-1",children:c})]}),e.jsxs("div",{className:"flex h-[44px] items-center justify-between",children:[e.jsx("div",{className:"flex gap-x-1",children:l}),e.jsx(vl,{inputState:m,state:a,onSubmit:u,composerController:h,clientThreadId:g,gizmoId:b,disableReason:v})]})]})]})});function vm({composerController:t,currentLeafId:s,placeholder:o,inputState:n}){const a=i.useContext(Qr);return e.jsxs(e.Fragment,{children:[e.jsx(Sl,{id:bl,autoFocus:!0,tabIndex:0,"data-id":s,dir:"auto",ref:r=>{if(!(t instanceof ya))throw new Error("Expected TextAreaComposerController");r!=null&&(t.textArea=r,t.logPageMount())},rows:1,placeholder:o,disabled:n!=="default",className:I("m-0 resize-none border-0 bg-transparent px-0 text-token-text-primary focus:ring-0 focus-visible:ring-0",n==="disabled"&&"text-center",["max-h-[25dvh]","max-h-52"])}),e.jsx("script",{nonce:a.cspScriptNonce,suppressHydrationWarning:!0,children:"requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI??Date.now()}))"})]})}function Sm({replyRegions:t}){return e.jsx("div",{className:"flex cursor-auto flex-col divide-y divide-token-border-light overflow-hidden rounded-b-lg rounded-t-[20px] bg-token-main-surface-primary",children:t.map((s,o)=>{switch(s.type){case"text":return e.jsx(bm,{value:s.value,onRemoveRegion:s.onRemoveRegion},o);case"object":return e.jsx(ym,{value:s.value,onRemoveRegion:s.onRemoveRegion},o);case"mention":case"system_hint":return e.jsx(wm,{value:s.value,icon:s.icon,onRemoveRegion:s.onRemoveRegion},o)}})})}function bm({value:t,onRemoveRegion:s}){return e.jsxs(Zn,{className:"text-token-text-secondary",children:[e.jsx(Jn,{children:e.jsx(wa,{className:"icon-lg-heavy"})}),e.jsx(eo,{children:`“${t}”`}),e.jsx(Qn,{onClick:s})]})}function ym({value:t,onRemoveRegion:s}){return e.jsxs(Zn,{className:"text-blue-selection",children:[e.jsx(Jn,{children:e.jsx(wa,{className:"icon-lg-heavy"})}),e.jsx(eo,{className:"font-semibold",children:t}),e.jsx(Qn,{onClick:s})]})}function wm({value:t,icon:s,onRemoveRegion:o}){return e.jsxs(Zn,{children:[e.jsx(Jn,{className:"mt-0",children:s}),e.jsx(eo,{className:"font-semibold text-token-text-primary",children:t}),e.jsx(Qn,{onClick:o})]})}function Qn({onClick:t}){return e.jsx("button",{onClick:t,type:"button",className:"flex-shrink-0 text-token-text-secondary",children:e.jsx(yl,{className:"icon-lg"})})}const Zn=ge.div`flex items-start py-2.5 gap-3 pl-3 pr-1.5 text-sm`,Jn=ge.span`flex-shrink-0 mt-0.5 w-7 h-6 flex justify-center items-center`,eo=ge.span`flex-1 line-clamp-3 py-0.5`;function jm({target:t,rootId:s,additonalInteractiveIds:o}){let n=t;for(;n&&n!=null;){if(n.tagName==="BUTTON"||n.tagName==="INPUT"||n.tagName==="TEXTAREA"||n.isContentEditable||o.includes(n.id))return!0;if(n.id===s)return!1;n=n.parentElement}return!1}const vs={initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:.1},exit:{opacity:0,scale:.5,transition:{duration:.2}}},Cm=({suggestions:t,onSelectingSuggestedReply:s})=>e.jsx("div",{className:"absolute bottom-full flex w-full max-w-[100vw] grow gap-2 overflow-auto px-1 pb-1 contain-inline-size sm:mb-0 sm:justify-start sm:px-2 sm:pb-0 md:static md:mb-2 md:max-w-none md:justify-center md:overflow-visible",children:t.slice(0,2).map((o,n)=>e.jsx(ne.div,{initial:vs.initial,animate:vs.animate,transition:{delay:(n-1)*vs.transition.delay},exit:vs.exit,children:e.jsx(Rt,{as:"button",color:"secondary",size:"small",onClick:()=>{s(o,t,n)},className:"group whitespace-nowrap md:whitespace-normal",children:e.jsx(Tm,{suggestion:o})},n)},n))});function Mm({suggestions:t,onSelectingSuggestedReply:s,clientThreadId:o}){const n=t?.length>0;i.useEffect(()=>{n&&Et(t,o)},[n,o]);const{isUnauthenticated:a}=Pe();return n?t.every(ja)?e.jsxs(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col items-center",children:[a&&e.jsx(Yt,{className:"mb-6 h-12 w-12 sm:hidden"}),e.jsx(Xa,{starterPrompts:t,onSelectStarterPrompt:s})]}):t.every(Ca)?e.jsx(Cm,{suggestions:t,onSelectingSuggestedReply:s}):null:null}function Tm({suggestion:t}){return Ca(t)?e.jsx(e.Fragment,{children:t.text}):ja(t)?e.jsxs("div",{className:"flex flex-col overflow-hidden",children:[t.title&&e.jsx("div",{className:"truncate font-semibold",children:t.title}),e.jsx("div",{className:I("truncate font-normal",t.title?"opacity-50":""),children:t.body})]}):null}function _m(){const{store:t}=ye(),s=t.useSharedProps();return s?e.jsx(km,{...s}):null}function km({clientThreadId:t,suggestions:s}){const o=Ls();return s===void 0||s.length===0?null:e.jsx("div",{children:e.jsx(Nm,{children:e.jsx("div",{className:"grow",children:s!==void 0&&e.jsx(Mm,{suggestions:s,onSelectingSuggestedReply:o,clientThreadId:t})})})})}const Nm=ge.div`h-full flex ml-1 md:w-full md:m-auto gap-0 md:gap-2 justify-center`,tr=({className:t,children:s})=>e.jsx(ne.div,{className:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:s});function Am({currentLeafId:t,canContinue:s,onContinueGenerating:o}){const n=i.useCallback(()=>{const r=new Vt;o(t,r),Ts()},[o,t]);let a=null;return s&&(a=e.jsx(Rm,{onHandleContinueGenerating:n})),a&&e.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:a})}function Em({className:t}){return e.jsx(Ma,{className:I("-rotate-180",t)})}const Rm=({onHandleContinueGenerating:t})=>e.jsx(tr,{children:e.jsx(Rt,{as:"button",color:"secondary",onClick:t,className:"whitespace-nowrap py-2",icon:Em,size:"small",children:e.jsx(H,{...Be.continueGenerating})})}),Im=()=>{const{shouldShowSkipButton:t}=Ta();return t?e.jsx(tr,{className:"flex justify-center",children:e.jsx(Rt,{as:"button",color:"secondary",onClick:()=>wl.skipParagen(),children:e.jsx(H,{...Pm.skip})})}):null},Pm=Ie({skip:{id:"dvcUbp",defaultMessage:"Skip"}}),sr=i.memo(function({className:s}){const{store:o}=ye(),n=o.useIsHeaderContentAreaPopulated();return e.jsx("div",{className:I(s??"absolute bottom-full left-0 right-0",_s.PromptTextareaHeader),children:e.jsx(jl,{shouldRender:n,contentArea:At.Header,children:e.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[e.jsx(nr,{}),e.jsx(or,{})]})})})});function nr(){const{store:t}=ye(),s=t.useSharedProps(a=>a?.clientThreadId),o=t.useContentAreaId(At.HeaderTop);let n;switch(o){case se.AdvancedVoiceOnMobileAnnouncement:n=e.jsx(_l,{clientThreadId:s});break;case se.ParagenControls:n=e.jsx(Im,{});break;case se.ItemActions:n=e.jsx(_m,{});break;case se.BannerSignup:n=e.jsx(Bm,{});break;case se.BannerTermsDisclaimer:n=e.jsx(Fm,{});break;case se.PromptTextareaAction:n=e.jsx(Hm,{});break;case se.BannersRateLimit:n=e.jsx(Um,{});break;case se.BannerSidekickAnnouncement:n=e.jsx(Tl,{});break;case se.SearchBrowserExtensionAnnouncement:n=e.jsx(Ml,{});break;case se.SearchBrowserExtensionReactiveAnnouncement:n=e.jsx(Cl,{});break;case se.BannerMemoryFull:n=e.jsx(rm,{});break;case se.Box:n=e.jsxs("div",{className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",e.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;default:n=null;break}return n}function or(){const{store:t}=ye(),s=t.useContentAreaId(At.HeaderBottom);let o;switch(s){case Sa.DallePromptControls:o=e.jsx(Lm,{});break;default:o=null;break}return o}const Dm=Oe(()=>ze(()=>import("./n51a19bmr44d3t3e.js"),__vite__mapDeps([0,1,2,3,4,5])).then(t=>t.default));function Lm(){const{store:t}=ye(),s=t.useSharedProps(o=>o?.composerController);return s?e.jsx(Dm,{composerController:s}):null}function Bm(){const{store:t}=ye(),s=t.useSharedProps(a=>a?.clientThreadId),o=kl(),n=Nl();return s?o?e.jsx(Al,{threadId:s,showSignUp:n}):e.jsx(El,{threadId:s,showLogin:n}):null}function Fm(){const{store:t}=ye(),s=t.useSharedProps(o=>o?.clientThreadId);return s?e.jsx(Rl,{threadId:s}):null}function Hm(){const{store:t}=ye(),s=t.useSharedProps();return s?e.jsx(Am,{...s}):null}function Um(){const{store:t}=ye(),s=t.useSharedProps(o=>o?.clientThreadId);return s?e.jsx(nm,{clientThreadId:s}):null}function Om({composerController:t,isDisabled:s,highlightTooltip:o,clientThreadId:n}){const{setThreadSearchMode:a}=An(),r=En(),l=Il(),[c,u]=i.useState(!1),m=fe(),d={clientThreadId:n};return e.jsx(Gm,{highlightTooltip:o,analyticsMetadata:d,isThreadUsingSearchMode:r,isDisabled:s,children:e.jsxs("button",{className:I("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold",c&&"transition-all duration-150",r||o?"!rounded-2xl bg-blue-250 text-blue-1000 hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:hover:bg-[#1A416A]":s?"opacity-30":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-pressed":r,"aria-label":m.formatMessage({id:"Sl1VH/",defaultMessage:"Search the web"}),disabled:s,onTransitionEnd:()=>u(!1),onClick:h=>{h.stopPropagation(),h.preventDefault(),u(!0),K.logEventWithStatsig(X.composerSearchButtonClicked,"composer_search_button_clicked",d),a(!r,d,yn.CONVERSATION_COMPOSER_WEB_ICON),/^search\s?$/i.test(t.getCurrentText())&&t.setText(""),t.replaceSlashCommandTokensWithText(),t.focus()},children:[e.jsx(Rn,{}),e.jsx(Zt,{children:r&&e.jsx(ne.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:l?0:.15},children:e.jsx("div",{className:"whitespace-nowrap pl-1 pr-2",children:e.jsx(H,{id:"TbHx8d",defaultMessage:"Search"})})})})]})})}function zm(){const t=In(rt.hasSeenComposerSearchButtonTooltip);return!t.isLoading&&t.eligible}function Gm({children:t,highlightTooltip:s,analyticsMetadata:o,isThreadUsingSearchMode:n,isDisabled:a}){const r=zm()&&!n,l=In(rt.hasSeenComposerSearchButtonTooltip);return r?e.jsx(Pn,{announcementKey:rt.hasSeenComposerSearchButtonTooltip,side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(H,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:l.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(H,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:e.jsx(Pl,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:e.jsx(H,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:e.jsx("div",{children:t})}):e.jsx("div",{children:e.jsx(Kt,{sideOffset:0,label:a?e.jsx(H,{id:"GpDAWD",defaultMessage:"Search is unavailable"}):e.jsx(H,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"right",open:s||(n?!1:void 0),onOpenChange:c=>{c&&K.logEventWithStatsig(X.composerSearchButtonHovered,"composer_search_button_hovered",o)},children:t})})}function Wm({composerController:t,clientThreadId:s}){const o=Xt(s),{setThreadSearchMode:n}=An(),r=_a().size>0,l=ln(s,on.Search),c=ka(s),[u,m]=i.useState([]),[d,h]=i.useState(void 0),[g,b]=i.useState(0);i.useEffect(()=>{m(d?c.filter(j=>j.name.toLocaleLowerCase().startsWith(d.text.toLocaleLowerCase())||j.systemHint.toLocaleLowerCase().startsWith(d.text.toLocaleLowerCase())):[])},[d]),i.useEffect(()=>{const j=N=>{h(M=>ti(M,N)?M:N)};t.view.dispatch(Yu(t.view.state.tr,{onHintMatch:j}))},[t]);const v=r||!c.length||!u.length||!d;i.useEffect(()=>{v&&b(0)},[v]);const x=u.length,E=i.useCallback(j=>{b(N=>(j(N)%x+x)%x)},[x]),w=u[g],k=({hintToSave:j=w,expectPerfectMatch:N,appendSpace:M=!0})=>{if(!d||!w||N&&j.name.toLowerCase()!==d.text.toLowerCase())return;K.logEvent(X.systemHintSelected,{system_hint:j.systemHint,conversation_id:o??xo});const D=d.text+j.name.slice(d.text.length),p={clientThreadId:s};Xu(t.view,{id:j.systemHint,hint:D},d.range,M,l,L=>n(L,p,yn.CONVERSATION_COMPOSER_SLASH_SEARCH)),fs(t.view)},y=i.useRef(k);y.current=k;const S=i.useRef(E);S.current=E;const T=i.useRef(d);T.current=d;const P=t.view;return i.useEffect(()=>(v||Ku(P,j=>{j==="up"?S.current(N=>N-1):j==="down"?S.current(N=>N+1):j==="cancel"?(fs(P),Qu(P)):j==="submit"?(y.current({expectPerfectMatch:!1}),fs(P)):j==="checkMatch"&&y.current({expectPerfectMatch:!0,appendSpace:!1})}),()=>fs(P)),[v,P]),i.useEffect(()=>{v||K.logEvent(X.systemHintListOpened,{conversation_id:o??xo})},[v]),v?null:e.jsx(Zr,{className:"max-w-60",onMouseDown:j=>{j.preventDefault()},children:u.map((j,N)=>e.jsx("div",{onMouseOver:()=>b(N),onClick:()=>{k({hintToSave:j,expectPerfectMatch:!1}),t.focus()},children:e.jsx(Jr,{autoFocus:!1,className:"group rounded-lg px-1 py-2 hover:bg-token-hint-text",$spoofHovered:N===g,children:e.jsx(Vm,{title:j.name,description:j.description,icon:e.jsx(Dl,{svgString:j.logo,className:"icon-lg text-token-text-secondary group-hover:text-white"}),checked:!1})})},j.systemHint))})}function Vm({title:t,description:s,icon:o,checked:n}){return e.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-1.5 pl-1.5 pr-3",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:o}),e.jsxs("div",{className:"shrink grow basis-0",children:[e.jsx("p",{className:"text-sm font-normal leading-tight text-token-text-primary group-hover:text-white",children:t}),!!s&&e.jsx("p",{className:"text-[13px] font-normal leading-[18px] text-token-text-secondary group-hover:text-white",children:s})]}),n&&e.jsx(ei,{className:I("icon-md text-token-text-primary",{"group-hover:hidden":!n})})]})}function qm({composerController:t,clientThreadId:s}){return t instanceof Xn?e.jsx(Wm,{composerController:t,clientThreadId:s}):null}function $m({suggestions:t,composerController:s,onSelect:o,onChange:n}){const a=Ls(),r=i.useCallback((d,h,g)=>{o?.(d,h,g),a(d,h,g)},[o,a]),[l,c]=i.useState(-1),[u,m]=i.useState(!1);return i.useEffect(()=>{const d=h=>{if(h.key==="ArrowDown"){const g=l===t.length-1?0:l+1;c(g),n?.(g,!0,t[g])}else if(h.key==="ArrowUp"){h.preventDefault();const g=l<=0?t.length-1:l-1;c(g),n?.(g,!0,t[g])}else h.key==="Enter"&&!h.shiftKey&&t[l]&&r(t[l],t,l)};return s.subscribe("keydown",d)},[t,l,n,r,s]),i.useEffect(()=>s.subscribe("blur",()=>{c(-1),n?.(-1,!1)}),[s,n]),i.useEffect(()=>{if(!u){const d=()=>{m(!0),window.removeEventListener("mousemove",d)};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}}},[u]),i.useEffect(()=>{c(-1),n?.(-1,!1),m(!1)},[t,n]),e.jsx(ne.ul,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hidden w-full flex-col p-2.5 group-focus-within:flex group-focus-within:max-lg:flex-col-reverse",children:t.map((d,h)=>e.jsxs(ne.li,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:h*.03},exit:{opacity:0,translateY:4},className:"w-full",children:[h>0&&e.jsx("div",{className:I("h-[1px] opacity-60 max-lg:hidden",l===h||l===h-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")}),e.jsxs("button",{className:I("flex w-full cursor-pointer items-center justify-start whitespace-pre-wrap rounded-lg px-2.5 py-3 text-start",l===h?"bg-token-main-surface-secondary":"bg-token-main-surface-primary"),onClick:g=>{g.preventDefault(),r(d,t,h)},onMouseDown:g=>{g.preventDefault()},onMouseEnter:()=>{u&&(c(h),n?.(h,!1,d))},onMouseLeave:()=>{c(-1),n?.(-1,!1,d)},children:[d.icon?e.jsx("span",{className:"mr-4 h-6 w-6 text-token-text-secondary",children:d.icon}):null,e.jsx("span",{className:"whitespace-pre-wrap",children:d.autocompletionChunks&&d.autocompletionChunks.length>0?e.jsx(e.Fragment,{children:d.autocompletionChunks.map((g,b)=>e.jsx("span",{className:I(g.isMatched?"text-token-text-tertiary":"text-token-text-primary"),children:g.text},b))}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:I(d.type===ks.Starter?"text-token-text-secondary":"text-token-text-tertiary"),children:d.title}),e.jsx("span",{className:"text-token-text-primary",children:d.body})]})})]}),h>0&&e.jsx("div",{className:I("h-[1px] opacity-60 lg:hidden",l===h||l===h-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")})]},d.id??h))})}function Ym(t,s){t=t.toLocaleLowerCase();const o=s;s=s.toLocaleLowerCase();const n=[];let a=0;for(let c=0;c<s.length&&(a<t.length&&t[a]===s[c]&&(n.push(c),a++),a!==t.length);c++);const r=[];let l=0;if(n.forEach(c=>{if(c>l){const u=o.slice(l,c);u&&r.push({text:u,isMatched:!1})}r.push({text:o[c],isMatched:!0}),l=c+1}),l<s.length){const c=o.slice(l);c&&r.push({text:c,isMatched:!1})}return Km(r)}function Km(t){if(t.length===0)return t;let s=[t[0]];for(let n=1;n<t.length;n++){const a=s[s.length-1],r=t[n];a.isMatched===r.isMatched?a.text+=r.text:s.push(r)}const o=s.filter(n=>n.isMatched).reduce((n,a)=>n+a.text.trim().length,0);return s.length<=4&&o>=2?s:[{text:s.map(n=>n.text).join(""),isMatched:!1}]}function Xm({composerController:t,isDisabled:s,clientThreadId:o}){const n=fe(),a=In(rt.hasSeenComposerSystemHintButtonTooltip),l=ka(o).length>0,u=_a().size>0,m=s===!0||!l||u;if(!(t instanceof Xn))return null;const d=t,h={clientThreadId:o};function g(){K.logEventWithStatsig(X.composerSystemHintButtonClicked,"composer_system_hint_button_clicked",h),a.markAsViewed(),d.focus(),Zu(d.view)}const b=e.jsx("button",{className:I("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold",m?"opacity-30":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-label":n.formatMessage({id:"oDAnGy",defaultMessage:"Use a tool"}),disabled:m,onPointerDown:g,onMouseDown:v=>{v.preventDefault()},onClick:v=>{v.preventDefault(),v.detail===0&&g()},children:e.jsx(Ll,{})});return!a.isLoading&&a.eligible?e.jsx(Pn,{announcementKey:rt.hasSeenComposerSystemHintButtonTooltip,show:!0,side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(H,{id:"tTydhk",defaultMessage:"All your tools, in one handy place"}),onDismiss:a.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(H,{id:"S+BFNe",defaultMessage:"Create a canvas, generate a picture, and more."}),children:b}):e.jsx(Kt,{side:"right",sideOffset:0,label:s?e.jsx(H,{id:"uw9x80",defaultMessage:"Tools unavailable"}):e.jsx(H,{id:"mrYNGk",defaultMessage:"View tools"}),onOpenChange:v=>{v&&K.logEventWithStatsig(X.composerSystemHintButtonHovered,"composer_system_hint_button_hovered",h)},children:b})}const Qm=1,Zm=3e3;function Jm({files:t,className:s}){const o=zn(),n=Na(),a=xc();return e.jsxs("div",{className:s,children:[a.map(r=>e.jsx(vc,{textdocId:r.tempTextdocId,userCreatedTextdoc:r},r.tempTextdocId)),t.map(r=>e.jsx(Sc,{borderRadius:"2xl",useV2Style:!0,width:o?"normal":"wide",onRemoveFileClick:()=>cn.remove(n,r.tempId,"none"),file:r.file,fileId:r.fileId??void 0,contextConnectorInfo:r.contextConnectorInfo,loadingPercentage:r.status===bc.Uploading?r.progress:void 0},r.tempId))]})}function eh({onAbortCompletion:t,onCreateNewCompletion:s,onContinueGenerating:o,currentModelId:n,clientThreadId:a,isNewThread:r,isCompletionInProgress:l,className:c,disabled:u=!1,disabledReason:m,canPause:d=!1,canContinue:h=!1,suggestions:g,isInteractableSharedThread:b,composerContainerRef:v,autocompletions:x,requiresFileUpload:E,onComposerInput:w,onComposerChange:k,onAutocompleteSelect:y,headerClassName:S,hideHeader:T,setComposerBarElement:P,onTaggingDropdownOpen:j,onTaggingDropdownClose:N}){const M=i.useRef(null),D=yc(M,P),p=Fs(),L=Dn(),C=Is(),{isUnauthenticated:B}=Pe(),O=fe(),A=na(),R=Na(),f=it(a),z=Rs(a),[Y]=oa(),te=wn(),{gizmoEditorData:q,mode:xe,getGizmoId:ie}=Bl(),Z=aa(),ue=Fl(),we=lt(),De=Aa(),le=Xt(a),pe=!!si(),je=!!jn(),[ve,Ae]=i.useState({}),{setThreadSearchMode:Ee,clearSearchModeTrigger:Le,getSearchModeTrigger:Ce}=An(),U=En(),[F,V]=i.useState(!1),[G,Q]=i.useState(!1),oe=Ue(),me=i.useRef(!1),Se=Ea(),ae=n!==null?Se[n]:void 0,Re=ni(a);let $=Ln(a),Me=$&&"gizmo"in $?$.gizmo:void 0;const Ge=Jt(Me?.gizmo.id),[J,ct]=i.useState(null);J!==null&&($={gizmo:J,gizmo_id:J.gizmo.id,kind:Qe.GizmoInteraction},Me=J);const dt=wo(ae,$);let ut=!1;Hl($)&&Me?.gizmo.id===Ul&&(ut=!0);const Hs=oi(),Pt=!u&&!ut&&dt!==jo.None&&!B,qe=Ol(ae,$),mt=zl(ae,$);let _e=Co(_=>_.files);const[ht]=i.useState(()=>Gl());xe==="magic"?_e=_e.filter(_=>_.gizmoId!=null):_e=_e.filter(_=>_.gizmoId==null);const es=Wl(),gt=_e.length>0||es,Dt=Co(wc.hasUploadInProgress),Lt=p.useState(_=>{const ce=Vl(_);return typeof ae?.maxTokens=="number"&&ce>ae.maxTokens}),Bt=p.useState(_=>!_.isEmpty()),pt=!Lt&&!Dt&&(Bt||gt);Bn(_e.length>0||Dt||Bt);const Ze=(dt===jo.Multimodal?ql:$l)-_e.length,Ft=Ze<=0,$e=pt&&!u&&!l&&!je,[Je,Us]=i.useState(!1),ft=Ra(),xt=n||ft.id,vt=ln(a,on.Search),St=!u&&!Me&&Z?.includes(ys.SearchTool)&&(Z?.includes(ys.BrowsingAvailable)||!C?.isEnterprisey()),Ht=St&&vt,Os=Se[xt]?.tags,{targetedContent:zs,setTargetedContent:et}=Fn(),ke=zs?.isFocusedViewContent&&!De?void 0:zs,{rebaseSystemMessageContent:ts}=Hn();i.useEffect(()=>{if(!L?.id)return;const _=Mo.getAndReset(L?.id,le);_&&p.setText(_.inputText)},[L?.id,le,p]),i.useEffect(()=>{Je!==$e&&(Us($e),$e&&ai(!0).then(_=>{ri.startEnforcement(_),Yl.startEnforcement(_),ii.startEnforcement(_)}))},[$e,Je,$?.kind,Z]);const bt=Kl(ae,$),{handleFileAccepted:so}=Xl(O,wo(ae,$),qe,"mouse",ie,bt?.attachments),{getInputProps:Gs,open:Ws}=Ql({disabled:u||!Pt||Ft,noClick:!0,onDropAccepted:so,onDropRejected:_=>Zl(_,O,A,dt),multiple:!0,maxSize:Jl,maxFiles:Ze,...ec(mt)}),ss=li(ht),ns=i.useCallback(()=>{p.eraseContent(),ss.clearMessages(),p.resize(Qm),ee.clearOverrideModelId(a),tc();for(const _ of _e)cn.remove(R,_.tempId,"none");sc.markAllAsSent()},[p,ss,_e,R,a]),yt=async(_,ce)=>{if(_?.preventDefault(),u||!pt&&!ce||!$||kt.isLoading(a)!==!1)return;const Ne=new Vt;V(!0);const be=p.getContentToSend(),st=jc(be.content),Ys=`${f}-nextPrompt`,zt=new Cc(Ia.CompletionRequest,{expectedTimingLogs:[{name:"prompt_submitted",expectedInMs:3e3}]}),{content:Vr,attachments:co}=Mc(R,st,ae,$),uo=[],Ks=[];ts&&Ks.push(ui(ts));const Xs={...$};"gizmo"in Xs&&delete Xs.gizmo;let cs=p.getSystemHints();U&&(cs=[Gn.Search]);const mo=Ce(),qr=U?mo??yn.CONVERSATION_COMPOSER_WEB_ICON:void 0,ho=Tc(),go=_c();let Gt={promptId:Ys,content:Vr,eventMetadata:{eventSource:_?"mouse":"keyboard"},completionMetadata:{suggestions:g,conversationMode:Xs,systemHints:cs,searchSource:qr},messageMetadata:{...co.length>0&&{attachments:co},...J&&{gizmo_id:J?.gizmo.id},...ve,...cs.length>0&&{system_hints:cs},...!!be.metadata&&{serialization_metadata:be.metadata},...ho.length>0&&{canvas:{user_created_textdocs:ho.map(ds=>({user_created_temp_textdoc_id:ds.tempTextdocId,type:ds.type,title:ds.title,content:ds.content}))}},...Object.keys(go).length>0&&{__internal:{search_settings:go}}},prependMessages:uo.length>0?uo:void 0,appendMessages:Ks.length>0?Ks:void 0,turnTracker:Ne,profiler:zt,requestedModelId:Re};Gt=kc(Gt),ke?.createNewCompletionParams&&(Gt=await ke.createNewCompletionParams(Gt)),zt.logTiming("request_params_ready"),await s(Gt),ke?.onCreateCompletion?.({serverThreadId:le,currentLeafId:f}),ke?.shouldPersistAcrossMessages!==!0&&et(void 0),Ns.hideThreadHeader(),ns(),V(!1),zt.logTiming("prompt_submitted"),g!==void 0&&(de.logEvent("chatgpt_prompt_ignore_suggestions"),K.logEvent(X.promptIgnoreSuggestions)),U&&mo&&Le()},Vs=i.useRef(yt);i.useEffect(()=>{Vs.current=yt});const qs=_=>{et(_.targetedReply),_.targetedReply&&(p.focus(),K.logEvent(X.targetedReplyButtonClicked,{conversationId:le,sourceMessageId:_.messageId}))},os=i.useCallback(()=>{ke?.onCleared?.({serverThreadId:le,currentLeafId:f}),et(void 0),p.focus()},[f,le,ke,et,p]),as={Enter:{validator:_=>{const ce=_.isComposing||_.keyCode===229;return!(G&&me.current)&&(_.metaKey||(ue||mi)&&!_.shiftKey&&!ce)},handler:_=>{if(!$e){Lt&&A.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}_.preventDefault(),yt()}},Escape:{validator:_=>!_.isComposing,handler:_=>{d&&l&&(t("",z),K.logEvent(X.pauseCompletion,{threadId:ee.getServerThreadId(a),currentLeafId:ee.getTree(a).getMessageId(f),eventSource:"keyboard"})),_.target.value===""&&os()}}},W=i.useRef(as);W.current=as;const he=nc(Os,$?.kind),[tt,wt]=i.useState(!1),[Ut,no]=i.useState(!1),rs=he&&tt&&!Ge,oo=p.isReady();i.useEffect(()=>p.subscribe("keydown",_=>{p.acceptLegacyKeydown()&&W.current[_.key]?.validator(_)&&W.current[_.key].handler(_);const Ne=p.getCurrentText();if(_.key==="@"){const be=p.getSelectionStart(),st=Ne.substring(0,be);(!st||/\s$/.test(st)||be===0)&&setTimeout(()=>wt(!0),10)}else tt&&wt(!1);if(_.key==="Escape"&&(ct(null),Q(!1)),Ht&&!U){let be;_.key==="Backspace"?be=Ne.substring(0,Ne.length-1):be=Ne+_.key,/^search\s?$/i.test(be)?no(!0):Ut&&no(!1)}U&&_.key==="Escape"&&Ee(!1,{clientThreadId:a})}),[p,oo,tt,Ut,Ht,U,Ee,a]),i.useEffect(()=>{const _=Object.fromEntries(Object.keys(W.current).map(ce=>[ce,be=>{const st=W.current[ce];if(!st||p.acceptLegacyKeydown())return!1;const{validator:Ys,handler:zt}=st;return Ys(be)?(zt(be),!0):!1}]));p.registerKeyHandlers(_)},[p,oo]),i.useEffect(()=>p.subscribe("paste",_=>{oc({filePickerStore:R,event:_,intl:O,toaster:A,clientThreadId:a,conversationMode:$,currentModelConfig:ae,getEditorGizmoId:ie,modelSupportedImageMimeTypes:qe})}),[O,a,$,ae,ie,qe,p,A,R]);const yr=_=>{pe||ct(_),p.trimLeadingText("@"),Ts(),wt(!1)},wr=ac(a,ht,qe,bt?.attachments),jr=i.useCallback(_=>{_?.preventDefault(),t("",z),K.logEvent(X.pauseCompletion,{threadId:ee.getServerThreadId(a),currentLeafId:ee.getTree(a).getMessageId(f),eventSource:"mouse"}),Ts()},[t,a,z,f]),ao=i.useCallback(()=>{Mo.set(L?.id,le,p.getCurrentText())},[le,L?.id,p]);i.useEffect(()=>{q||!F&&!rc()&&p.focus()},[F,p]),i.useEffect(()=>{q||cn.reset(R)},[n,R,q]),i.useEffect(()=>{(!he&&J||pe)&&ct(null)},[he,J,pe]);const[Cr,Mr]=(()=>{switch(m){case"workspaceDisallowsGizmo":return[Be.disallowedByWorkspacePlaceholder,!0];case"feedbackRequired":return[Be.disabledFeedbackPlaceholder,!0];case"noModelsAvailable":return[Be.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[Be.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[Be.loading,!0];case"noTestGizmoId":return[Be.noTestGizmoId,!0];default:return b?[Be.placeholderWithName,!1]:ke?.placeholderTextOverride!=null?[ke.placeholderTextOverride,!1]:[Be.placeholderWithName,!1]}})(),Tr=Ge&&r?O.formatMessage(dn.newChatInProject):O.formatMessage(Cr,{name:q!=null?xe==="magic"?ic:q.name||"GPT":Me?.gizmo.display.name??"ChatGPT"});i.useEffect(()=>p.subscribe("input",()=>{Un.getState().isThreadHeaderVisible&&Ns.hideThreadHeader(),Q(!0)}),[p]),i.useEffect(()=>{if(w)return p.subscribe("input",()=>{w?.()})},[p,w]),i.useEffect(()=>{if(k)return p.subscribe("change",()=>{k?.()})},[p,k]),i.useEffect(()=>p.subscribe("focus",()=>{Q(!0)}),[p]);const ro=$?.kind===Qe.PrimaryAssistant&&!U,_r=ci(ys.CanvasOptIn),{layer:kr}=We("4211831761"),{value:Nr}=js("3131522605"),Ar=Nr||kr.get("enable",!1)||_r,Er={clientThreadId:a,uploadType:dt,modelAcceptedMimeTypes:mt,modelSupportedImageMimeTypes:qe,attachmentsProductFeature:bt?.attachments,getInputProps:Gs,openFileDialog:Ws,historyDisabled:we,onOauthRedirect:ao,highlightTooltip:E&&!gt},is=[],Rr=!u&&!Ft&&(Pt||Hs!=null)&&!U;is.push(e.jsx(fm,{...Er,isDisabled:!Rr},"file-upload-button")),Ar&&is.push(e.jsx(Xm,{composerController:p,clientThreadId:a,isDisabled:!ro},"system-hint-button")),St&&is.push(e.jsx(Om,{composerController:p,highlightTooltip:Ut,clientThreadId:a,isDisabled:!Ht||gt},"search-button"));const Ir=gt&&e.jsxs(e.Fragment,{children:[xe==="magic"&&e.jsx("div",{className:"m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",children:e.jsx(H,{...Be.gizmoKnowledgeWarning})}),e.jsx(Jm,{files:_e,className:"flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),Pr=Mr?"disabled":"default",Dr=l&&d,Lr=di(),Br=!$e||F||Lr,Fr=Nc(Dt,Bt,Lt),ls=Dr?"streaming":Br?"disabled":"idle",Ot=i.useRef(null),jt=i.useRef(null),Hr=n&&n.startsWith("o1");i.useEffect(()=>{const _=()=>{Ot.current!=null&&an.addAction("composer_state_disabled",{threadId:ee.getServerThreadId(a),disabledReason:Ot.current})};if(pt&&ls==="disabled"){let ce="unknown";u?ce=m??"component_disabled_unknown":l?ce="completion_in_progress":je?ce="thread_hard_blocked":F&&(ce="starting_new_completion_request"),Ot.current!==ce&&(jt.current&&clearTimeout(jt.current),jt.current=setTimeout(_,Zm)),Ot.current=ce}else Ot.current=null;return()=>{jt.current&&(clearTimeout(jt.current),jt.current=null)}},[a,pt,ls,u,m,l,je,F]);const $s=[];if(ke?.label&&$s.push({type:ke.type,value:ke.label,onRemoveRegion:os}),J!==null){const _=!!J.gizmo.tags?.includes(On.FirstParty);$s.push({type:"mention",value:J.gizmo.display.name,icon:e.jsx(lc,{isFirstParty:_,src:J.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{ct(null),p.focus()}})}i.useEffect(()=>{(!x||x.length===0||!G)&&(me.current=!1)},[x,G]);const Ur=(_,ce,Ne)=>{me.current=_>=0,ce&&p.setText(Ne?`${Ne.title}${Ne.body}`:"")},io=G&&x&&x.length>0&&!rs&&!p.hasMultipleLines()&&p.canShowAutocompletion();i.useEffect(()=>{rs?j?.():N?.()},[rs,j,N]);const lo=ls==="streaming"?jr:yt,Or=ln(a,on.Canvas),{value:zr}=js("61299031"),Gr=zn(),Wr=Or&&zr&&!es&&!Gr;return e.jsxs(cc.Provider,{value:ht,children:[e.jsx(dc,{onOauthRedirect:ao,children:e.jsx("form",{className:c,onSubmit:lo,children:e.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col",children:[!T&&!oe&&e.jsx(sr,{className:S}),rs&&e.jsx("div",{className:I("absolute bottom-full my-3",r&&"lg:top-full",_s.TagGpt),children:e.jsx(uc,{onClick:_=>yr(_),onClose:()=>{wt(!1),p.focus()}})}),ro&&e.jsx("div",{className:I("absolute bottom-full my-3",r&&"lg:top-full",_s.TagGpt),children:e.jsx(qm,{composerController:p,clientThreadId:a})}),e.jsxs("div",{ref:v,className:"group relative flex w-full items-center",children:[r&&Y.has("from_template_row")&&e.jsx("button",{type:"button",onClick:()=>{te("/")},className:"mr-2 flex h-8 w-8 items-center justify-center text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(mc,{className:"icon-lg"})}),e.jsx(xm,{type:we?"temporary":"default",ref:D,replyRegions:$s,placeholder:Tr,inputState:Pr,composerController:p,leftSideActions:is,topRightAction:Wr&&e.jsx(hc,{composerRef:M,composerController:p,clientThreadId:a}),state:ls,onSubmit:lo,renderFiles:Ir,currentLeafId:f,clientThreadId:a,gizmoId:Me?.gizmo.id,disableReason:Fr,modelId:xt}),io&&e.jsx("div",{className:"absolute left-0 z-10 box-border w-full bg-token-main-surface-primary pl-0 max-lg:bottom-full lg:top-full",children:e.jsx($m,{suggestions:x,composerController:p,onSelect:y,onChange:Ur})})]}),e.jsx(gc,{composerController:p,parsedDocumentHandler:wr})]})})}),e.jsx(im,{canUseInlineTagging:he,isDisabled:u,clientThreadId:a,currentLeafId:f,currentRequestId:z,canContinue:h,composerController:p,setPromptInputMetadata:Ae,suggestions:g,isNewThread:r,onCreateNewCompletion:s,onContinueGenerating:o,onResetState:ns,conversationMode:$,isShowingAutocomplete:!!io}),$!=null&&!Hr&&pc.includes($.kind)&&e.jsx(fc,{clientThreadId:a,onTargetedReply:qs})]})}function th(t){const s=t.message?.author.role===He.User,o=t.metadata?.err!=null&&t.metadata?.errCode!==So.ContentPolicy,n=t.metadata?.errCode===So.ModelIncompatibility;return t.metadata?.canRetry===!1||n?!1:s||o}function sh(t){return e.jsx(Qa,{clientThreadId:t.clientThreadId,children:e.jsx(nh,{...t})})}function nh({clientThreadId:t,isNewThread:s,currentModelId:o,showPromptStarters:n,noWrap:a,onRequestCompletion:r,composerContainerRef:l}){const c=Fs(),u=Cn(),m=Mn(),d=Tn(g=>{const b=kt.getCurrentNode(t,g);return th(b)});if(Pa(c),!m&&d)return e.jsx(oh,{clientThreadId:t});const h=e.jsx(e.Fragment,{children:e.jsx(ar,{composerContainerRef:l,clientThreadId:t,currentModelId:o,isNewThread:s,showPromptStarters:n,onRequestCompletion:r})});return a?h:e.jsxs(e.Fragment,{children:[e.jsx(tm,{clientThreadId:t}),e.jsx(Wn,{clientThreadId:t,isStaticSharedThread:u,withVerticalPadding:!1,withHorizontalPadding:!0,children:e.jsx(qt,{children:h})})]})}function oh({clientThreadId:t}){const s=Dc(t),o=Tn(r=>kt.getCurrentNode(t,r).metadata?.errCode===Lc),n=Bc(r=>r.isoDate),a=it(t);return o&&n!=null&&n!==""?null:e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 text-center text-xs",children:e.jsx(H,{...Ro.errorGeneratingResponse})}),e.jsx("div",{className:"flex items-center md:mb-4",children:e.jsx(Rt,{as:"button",color:"primary",onClick:()=>{const r=new Vt;de.logEvent("chatgpt_regenerate_due_to_error_button_clicked",void 0,Xe({clientThreadId:t})),s({id:a,eventMetadata:{eventSource:"mouse"},conversationMode:kt.getConversationMode(t),turnTracker:r})},className:"m-auto",icon:Ma,"data-testid":"regenerate-thread-error-button",children:e.jsx(H,{...Ro.regenerateResponse})})})]})}function ar({clientThreadId:t,currentModelId:s,isNewThread:o,onRequestCompletion:n,showPromptStarters:a,composerContainerRef:r,autocompletions:l,requiresFileUpload:c,onComposerInput:u,onComposerChange:m,onAutocompleteSelect:d,headerClassName:h,hideHeader:g,onTaggingDropdownClose:b,onTaggingDropdownOpen:v}){const x=it(t),E=Rs(t),w=un(),{isUnauthenticated:k}=Pe(),S=ra(t)===ia.STREAMING,T=la({clientThreadId:t,conversationLeafId:x}),P=at(E),j=hi({clientThreadId:t}),N=!k,M=gi(),{isOpen:D,onClose:p}=Ac({type:"just-hit-rate-limit"}),L=i.useCallback((F,V)=>{K.logEvent(X.continueCompletion),n({type:vo.Continue,promptId:F,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!1,completionMetadata:{conversationMode:kt.getConversationMode(t)},turnTracker:V})},[n,t]),C=ca(),B=i.useCallback(async(F,V)=>Ec({clientThreadId:t,currentRequestId:V,isHistoryAndTrainingDisabled:M,queryClient:C}),[t,M,C]),O=i.useCallback(async({promptId:F,content:V,eventMetadata:G,completionMetadata:Q,messageMetadata:oe,prependMessages:me,appendMessages:Se,turnTracker:ae,profiler:Re,requestedModelId:$})=>{const Me=ee.getThreadCurrentLeafId(t);ee.updateTree(t,Ge=>{Ge.addNode(F,V,Me,He.User,void 0,oe)}),await n({type:vo.Next,promptId:F,eventMetadata:G,cancelActiveRequests:!0,completionMetadata:Q,prependMessages:me,appendMessages:Se,turnTracker:ae,profiler:Re,...$?{requestedModelId:$}:{}})},[t,n]),A=pi(t,x),R=fi(t,x),f=!T&&(P||S),z=i.useMemo(()=>f?!1:!A&&R,[A,R,f]),Y=f&&s!=="gpt-4-pbrowse",te=Qt(t),q=Te(t),xe=It(q).data,{promptStarters:ie,isSuccess:Z}=mn(o&&!te,t,4),ue=ba(),we=(()=>{if(ue?.messageId===ee.getTree(t).getLastValidNode(x)?.message?.id)return ue?.suggestions;if(a&&!te&&Z&&!N)return ie})(),De=Rc(),le=xi(),pe=(()=>{if(xe?.gizmo.tags?.includes(On.WorkspaceDisabled)&&!le)return"workspaceDisallowsGizmo";if(De.size){if(w.displayingSideBySideFeedback&&w.unskippable)return"feedbackRequired"}else return"noModelsAvailable";const V=kt.getConversationMode(t);return V?.kind===Qe.GizmoTest&&V.gizmo_id==null?"noTestGizmoId":null})(),je=da(t),ve=Ps(t),Ae=js("15117983")?.value,Ee=vi(),Le=Ds(),Ce=Ee.action==="moderate",{value:U}=Ve("1860647109");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center",children:Le&&Ce&&U?e.jsx(Ic,{}):null}),D?e.jsx(Pc,{onClose:p}):null,Ae&&ve&&ve.kind===Qe.PrimaryAssistant&&ve.plugin_ids&&ve.plugin_ids.length>0?e.jsx(ah,{}):e.jsx(eh,{composerContainerRef:r,clientThreadId:t,onCreateNewCompletion:O,onAbortCompletion:B,onContinueGenerating:L,currentModelId:s,isNewThread:o,isCompletionInProgress:j,className:"w-full",canContinue:z,suggestions:we??[],disabled:!!pe,disabledReason:pe??void 0,canPause:Y,isInteractableSharedThread:je,autocompletions:l,requiresFileUpload:c,onComposerInput:u,onComposerChange:m,onAutocompleteSelect:d,headerClassName:h,hideHeader:g,onTaggingDropdownClose:b,onTaggingDropdownOpen:v},t)]})}function ah(){return e.jsxs("div",{className:"mx-auto flex max-w-md flex-col items-center justify-center gap-2 rounded-xl border border-token-border-light bg-token-main-surface-primary p-6 shadow-lg",children:[e.jsx("span",{className:"text-token-text-primary",children:e.jsx(H,{id:"PluginsDecrepatedNotice.pluginsDeprecationTitle",defaultMessage:"Conversations with plugins are archived"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(H,{id:"PluginsDecrepatedNotice.pluginsDeprecationSubtitle",defaultMessage:"Explore GPT Store to find a replacement"})}),e.jsxs("a",{href:"https://chat.openai.com/gpts",className:"text-green-500 hover:cursor-pointer dark:text-green-400",children:[e.jsx(H,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLink",defaultMessage:"Explore GPTs"}),e.jsx("span",{className:"ml-2",children:e.jsx(H,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLinkArrow",defaultMessage:"→"})})]})]})}const Ro=Ie({errorGeneratingResponse:{id:"PromptTextarea.errorGeneratingResponse",defaultMessage:"There was an error generating a response"},regenerateResponse:{id:"PromptTextarea.regenerateResponse",defaultMessage:"Regenerate"}}),rr=i.memo(function(){return e.jsxs("div",{className:`flex flex-col gap-2 ${_s.PromptTextareaHeader}`,children:[e.jsx(nr,{}),e.jsx(or,{})]})}),bg=Object.freeze(Object.defineProperty({__proto__:null,ChatScreenComposerAlerts:rr},Symbol.toStringTag,{value:"Module"})),Io=Oe(()=>ze(()=>import("./lo1c2e117npgmgjl.js"),__vite__mapDeps([6,1,2,3,4,7,8,9,10,11,12])).then(t=>t.SnorlaxSplashScreen)),Zs=4;function rh(t){const{layer:s}=We("3533083032"),{layer:o}=_t("3533083032"),{value:n,isLoading:a}=Ve("3006519778");return a||!n?!1:t?s.get("enable_new_homepage_anon",!1):o.get("enable_new_homepage_anon",!1)}function ih(){const{layer:t}=_t("4031588851"),s=t.get("autocomplete_qualified_start_date","2099-09-13T00:00:00Z"),o=Dn();return!!o&&o.created*1e3>=new Date(s).getTime()}function lh(t){const{layer:s}=We("4031588851"),{layer:o}=_t("4031588851"),{value:n,isLoading:a}=Ve("633009675");return a||!n?!1:t?s.get("enable_new_autocomplete_homepage",!1):o.get("enable_new_autocomplete_homepage",!1)}const Js=t=>`${t.title}${t.body}`.toLocaleLowerCase();function ir(t){const s=Te(t.clientThreadId),o=Jt(s);return e.jsx(Qa,{clientThreadId:t.clientThreadId,children:o&&s&&Io?e.jsx(Io,{clientThreadId:t.clientThreadId,gizmoId:s,currentModelId:t.currentModelId,onRequestCompletion:t.onRequestCompletion}):e.jsx(hh,{...t})})}function ch({children:t}){const{store:s}=ye(),[o,n]=i.useState(!1),a=Fs();i.useEffect(()=>a.subscribe("focus",()=>{n(!0)}),[a]),i.useEffect(()=>a.subscribe("blur",()=>{n(!1)}),[a]);const l=!!s.useSharedProps()?.isShowingAutocomplete;return t(l&&o)}function dh({isUnauthenticated:t,shouldShowLegacyStarterPrompts:s,legacyPromptStarters:o,isSendBlocked:n,clientThreadId:a}){return e.jsxs("div",{className:I(t?"justify-end lg:justify-center":"justify-center","flex h-full flex-shrink flex-col items-center overflow-y-hidden text-token-text-primary lg:hidden"),children:[e.jsx("div",{className:I(t&&"flex sm:items-center md:flex-1","flex-shrink-0"),children:e.jsx(Yt,{className:"mb-6 h-12 w-12"})}),s&&(o&&o.length>0?e.jsx(xh,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},promptStarters:o,isSendBlocked:n,clientThreadId:a,isSquare:t}):e.jsx(zu,{}))]})}function uh({isSendBlocked:t,clientThreadId:s,headlineOption:o,enableNewMobileDesign:n,shouldShowStarterPrompts:a,promptChips:r,onSelectStarterPrompt:l,starterPromptExpanded:c,setStarterPromptExpanded:u}){const m=Vn();return e.jsx(ch,{children:d=>e.jsxs(ne.div,{initial:{opacity:0},animate:{opacity:d?0:1},exit:{opacity:0},transition:{duration:.1},className:I("justify-center",d?"pointer-events-none":"","mt-[var(--screen-optical-compact-offset-amount)] flex h-full flex-shrink flex-col items-center overflow-hidden text-token-text-primary",m?"@lg/thread:hidden":"lg:hidden"),children:[o==="CHATGPT_LOGO"?e.jsx(Yt,{className:"inline-block h-12 w-12"}):e.jsx(lr,{headlineOption:o}),e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:I(!n&&(m?"@lg/thread:hidden":"lg:hidden"),!c&&"h-[116px]"),children:a&&e.jsx(dr,{starterPrompts:r,onSelectStarterPrompt:l,disabled:t,clientThreadId:s,onExpand:()=>u(!0),mobileLayout:!0})})]})})}function mh(t,s,o){const n=Ve("1468311859").value,a=Ve("3664702598").value,{layer:r}=We("4031588851"),l=ih(),c=t||s,u=c&&n,m=c&&a&&l;let d="HARDCODED";if(c)if(o){const h=r.get("search_autocomplete_mode","");u&&h&&(d=h)}else m&&(d=r.get("autocomplete_mode","HARDCODED"));return d}function hh({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,v2HomepageDisclaimer:a}){const r=Fs(),l=Tt(t),c=Qt(t),u=jn(),[m,d]=i.useState([]),{trendingSuggestions:h,fetchTrendingSuggestions:g}=vh(Zs),b=i.useRef(!1),{isUnauthenticated:v}=Pe(),x=Fc(),[E,w]=i.useState(!1),k=En(),y=Ue();Pa(r);const S=Ve("589604007").value,{layer:T}=_t("4031588851"),{layer:P}=We("4031588851"),{layer:j}=_t("3533083032"),{layer:N}=We("3533083032"),{promptStarters:M,isSuccess:D}=mn(l&&!c&&o,t,8,S,!0,s??void 0),{promptStarters:p,isSuccess:L,isError:C}=mn(l&&!c&&o,t,4,void 0,void 0,s??void 0),B=x&&!!m.find(U=>!!U.requires_file_upload),O=i.useCallback(U=>{const F=r.getCurrentText();return F&&Js(U).startsWith(F.toLocaleLowerCase())},[r]),A=i.useCallback(U=>{const F=r.getCurrentText(),V=U.title+U.body;return O(U)?{...U,title:F,body:V.slice(F.length)}:{...U,title:V,body:""}},[r,O]),R=i.useCallback((U=!1)=>{d(F=>!F.some(O)&&F.length>0?[]:U?F:F.map(A))},[O,A]),f=(U,F,V)=>{const G=U.title;d([]),r.focus(),r.setText(G),requestAnimationFrame(()=>{const Q=(M?.filter(oe=>oe.theme===U.theme)??[]).map(oe=>{const me=Ct(oe.oneliner),Se=me.startsWith(oe.title);return{...oe,title:Se?`${oe.title} `:"",body:Se?oe.body:me,autocompletionChunks:Ym(G,me),type:ks.Autocomplete}});d(Q),Q.length>0&&Et(Q,t),Oc(U,V,t)})};i.useEffect(()=>{const U=m.some(F=>F.theme===hn.Search);k&&r.getCurrentText()===""?h.length>0?d(h):g():U&&!k&&d(F=>F.filter(V=>V.theme!==hn.Search))},[m,k,h,g,r]);const z=M?.reduce((U,F)=>(F.theme&&!U[F.theme]&&(U[F.theme]=F),U),{}),Y=[];if(z)for(const U in z)Y.push(z[U]);const te=Y&&Y.length>0,q=!!(D&&te&&o),xe=!!((L||C)&&o),ie=Zs-m.filter(O).length,Z=v?N.get("enable_new_mobile",!1):P.get("enable_new_mobile",!1),ue=mh(Z,x,k),we=v?j.get("headline_option","HELP_WITH"):T.get("headline_option","HELP_WITH"),De=T.get("autocomplete_min_char",4),le=T.get("autocomplete_fetch_interval",200),pe=i.useRef(null),je=i.useCallback(Da(async U=>{const F=r.getCurrentText();if(!F||F.length<De||F.length>80||r.hasMultipleLines()){d([]);return}if(!b.current&&!(pe.current&&pe.current.length>De&&F.startsWith(pe.current)))try{const V=await Nt.generateAutocompletions(F,U,k);if(V.completions.length===0){pe.current=F;return}const G=V.completions.map(Q=>({id:Si(),type:ks.Autocomplete,title:Q.slice(0,F.length),body:Q.slice(F.length),oneliner:Q,prompt:Q,source:ue})).filter(O).map(A);d(Q=>{const oe=Q.filter(O),me=G.filter(Se=>{const ae=Js(Se);return!oe.some(Re=>{const $=Js(Re);if(ae===$)return!0;const Me=/[\p{P}\p{S}]$/u,Ge=ae.replace(Me,""),J=$.replace(Me,"");return Ge===$||ae===J||Ge===J})}).slice(0,Zs-oe.length);return[...oe,...me]}),G.length>0&&Et(G,t)}catch{}},ue==="BING"?150:le),[r,ue,A,le]),ve=i.useCallback(()=>{R(),ie>0&&je(ie)},[je,R,ie]);i.useEffect(()=>{b.current&&d([])},[b]);const Ae=i.useMemo(()=>ue==="HARDCODED"?R:ve,[ue,ve,R]),Ee=i.useCallback(()=>{r instanceof Xn&&R(!0),r.getCurrentText().indexOf(`
`)>0&&d([])},[r,R]),Le=i.useCallback((U,F,V)=>{F.forEach(G=>{G.id===U.id&&(G.userInput=r.getCurrentText())}),d([F[V]])},[r]),Ce=Vn();return e.jsx(e.Fragment,{children:e.jsx(Zt,{children:e.jsx("div",{className:I("h-full w-full",Ce?"@lg/thread:py-[18px]":"lg:py-[18px]"),children:e.jsx(Wn,{isStaticSharedThread:!1,withVerticalPadding:!1,withHorizontalPadding:!0,clientThreadId:t,fullHeight:!0,children:e.jsxs(To,{children:[e.jsx("div",{className:I("mb-7 hidden text-center",Ce?"@lg/thread:block":"lg:block"),children:we==="CHATGPT_LOGO"?e.jsx(Yt,{className:"inline-block h-12 w-12"}):e.jsx(lr,{headlineOption:we})}),!Z&&e.jsx(dh,{isUnauthenticated:v,shouldShowLegacyStarterPrompts:xe,legacyPromptStarters:p,isSendBlocked:u,clientThreadId:t}),Z&&e.jsx(uh,{headlineOption:we,enableNewMobileDesign:Z,shouldShowStarterPrompts:q,promptChips:Y,onSelectStarterPrompt:f,starterPromptExpanded:E,setStarterPromptExpanded:w,isSendBlocked:u,clientThreadId:t}),e.jsx("div",{className:I(Ce?"@lg/thread:absolute @lg/thread:bottom-8 @lg/thread:left-0 @lg/thread:w-full":"lg:absolute lg:bottom-8 lg:left-0 lg:w-full"),children:e.jsx(To,{children:y?e.jsx(rr,{}):e.jsx(sr,{className:"block"})})}),e.jsx("div",{className:"w-full",children:e.jsx(ar,{clientThreadId:t,isNewThread:l,currentModelId:s,onRequestCompletion:n,showPromptStarters:!1,autocompletions:m,requiresFileUpload:B,onComposerInput:Ae,onComposerChange:Ee,onAutocompleteSelect:Le,onTaggingDropdownClose:()=>{b.current=!1},onTaggingDropdownOpen:()=>{b.current=!0},hideHeader:!0})}),e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:I("hidden",Ce?"@lg/thread:block":"lg:block",a&&v&&E?"":"h-[70px]"),children:q&&e.jsx(dr,{starterPrompts:Y,onSelectStarterPrompt:f,disabled:u,clientThreadId:t,onExpand:()=>w(!0)})}),a&&e.jsx("div",{className:I("w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",Ce?"@lg/thread:absolute @lg/thread:bottom-0 @lg/thread:left-0":"lg:absolute lg:bottom-0 lg:left-0"),children:e.jsx("div",{className:"min-h-4",children:a})})]})})})})})}function lr({headlineOption:t}){const o=fe().formatMessage(Sh[t]||Wt.whatCanIHelpWith);return e.jsx("div",{className:"relative inline-flex justify-center text-center text-2xl font-semibold leading-9",children:e.jsx("h1",{children:o})})}function cr({label:t,onClick:s,disabled:o=!1,icon:n}){return e.jsxs("button",{className:"group relative flex h-[42px] items-center gap-1.5 rounded-full border border-token-border-light px-3 py-2 text-start text-[13px] shadow-xxs transition enabled:hover:bg-token-main-surface-secondary disabled:cursor-not-allowed xl:gap-2 xl:text-[14px]",disabled:o,onClick:s,children:[n,e.jsx("span",{className:"max-w-full select-none whitespace-nowrap text-gray-600 transition group-hover:text-token-text-primary dark:text-gray-500",children:t})]})}function gh({starterPrompt:t,starterPrompts:s,index:o,disabled:n,onSelectStarterPrompt:a}){const r=t.theme??t.title,l=Ls(),{mutate:c}=zc(),u=t.category==="onboarding"?()=>{c({key:rt.hasUsedConversationalOnboardingStarterPrompt}),l(t,s,o)}:()=>a(t,s,o);return e.jsx(cr,{disabled:n,onClick:u,icon:e.jsx(Gc,{starterPrompt:t,useV2Colors:!0}),label:r})}function Po({clientThreadId:t,onClick:s}){i.useEffect(()=>{Wc(t)},[t]);const o=fe();return e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:e.jsx(cr,{onClick:()=>{Vc(t),s()},label:o.formatMessage(Wt.moreStarterPrompts)})})}const ph=5,fh=3;function dr({starterPrompts:t,onSelectStarterPrompt:s,disabled:o,clientThreadId:n,onExpand:a,mobileLayout:r=!1}){const l=r?fh:ph,[c,u]=i.useState(l),[m,d]=i.useState(!1),h=i.useRef(null),g=t.length<=c;i.useEffect(()=>{Et(t.slice(0,l),n)},[n]),i.useEffect(()=>{if(!m&&!g&&h.current){const v=h.current,x=v.getBoundingClientRect(),E=x.width,w=Array.from(v.children);let k=0;for(let y=0;y<w.length&&w[y].getBoundingClientRect().right-x.left<=E;y++)k++;u(k),d(!0)}},[t,g,m]);const b=()=>{const v=t.slice(c,t.length).map(x=>({...x,isAdditional:!0}));v.length>0&&Et(v,n),u(t.length),a()};return e.jsxs("div",{className:I("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",m&&t.length>0?"opacity-100":"opacity-[0.01]",r?"flex-wrap":"flex-nowrap"),children:[e.jsxs("ul",{className:I("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",g||r?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:h,children:[t.slice(0,c).map((v,x)=>e.jsx(ne.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:e.jsx(gh,{starterPrompt:v,starterPrompts:t,index:x,disabled:o,onSelectStarterPrompt:s})},v.id??x)),r&&t.length>c&&e.jsx(Po,{clientThreadId:n,onClick:b})]}),!r&&t.length>c&&e.jsx(Po,{clientThreadId:n,onClick:b})]})}function xh({promptStarters:t,isSendBlocked:s,clientThreadId:o,isSquare:n,...a}){i.useEffect(()=>{Et(t,o)},[o]);const r=Ls(),l=Vn();return e.jsx(e.Fragment,{children:n?e.jsx(ne.div,{...a,className:"mb-2 w-full flex-shrink overflow-y-hidden",children:e.jsx(qt,{children:e.jsx(Xa,{starterPrompts:t,onSelectStarterPrompt:r,disabled:s})})}):e.jsx(ne.div,{...a,className:"flex-shrink overflow-y-hidden",children:e.jsx(Gu,{starterPrompts:t,onSelectStarterPrompt:r,disabled:s,cssMobileDisplayLimit:2,marginOverride:I("mt-6",l?"@lg/thread:mt-12":"lg:mt-12")})})})}const vh=t=>{const[s,o]=i.useState([]),n=i.useCallback(async()=>{const r=(await Nt.generateTrendingSuggestions(t)).suggestions.map((l,c)=>({type:ks.Starter,title:Do(l),body:"",icon:e.jsx(Hc,{}),prompt:Do(l),id:`starter-${c}`,theme:hn.Search}));o(r)},[t]);return{trendingSuggestions:s,fetchTrendingSuggestions:n}};function Do(t){return t.split(" ").map(Uc).join(" ")}const Wt=Ie({whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),Sh={HELP_WITH:Wt.whatCanIHelpWith,WHERE_TO_START:Wt.whereShouldWeStart,ASK_CHATGPT:Wt.askChatgptAnything};function ur({clientThreadId:t,currentLeafId:s}){const{currentModelId:o}=Za(),n=Ln(t),a=ua(t,s),r=Te(t),l=lt(),c=Bs(o),u=Tt(t)&&!a&&(ws(n)||n?.kind===Qe.GizmoTest),m=Jt(r);return{showEmptyState:u,canUseNewHomepage:u&&m||u&&!r&&!c&&!l}}const Lo=ge.button`max-w-28 xs:max-w-40 sm:max-w-60 md:max-w-none group flex cursor-pointer items-center gap-1 rounded-lg py-1.5 ${({$shimmer:t})=>t?"loading-shimmer":""} ${({$isScreenArch:t})=>t?"text-md px-2":"px-3 text-lg"} hover:bg-token-main-surface-secondary radix-state-open:bg-token-main-surface-secondary font-semibold text-token-text-secondary overflow-hidden whitespace-nowrap`;function bh({conversation:t,gizmoResource:s,elementRef:o}){const n=Ci(t.id)??t.title;return e.jsx(Cs,{to:Kc(t.id,s),children:e.jsx(re.Item,{icon:Xc,children:e.jsx("div",{ref:o,children:n})},t.id)})}function yh({gizmoId:t,clientThreadId:s,inMobileHeader:o}){const n=fe(),{data:a}=It(t),{items:r,hasNextPage:l,fetchNextPage:c,isLoading:u,isFetchingNextPage:m}=qc(t),d=i.useRef(null),h=i.useCallback(M=>{u||M==null||(d.current?.disconnect(),d.current=new IntersectionObserver(D=>{D[0].isIntersecting&&l&&c()}),d.current.observe(M))},[u,l,c]);i.useEffect(()=>()=>{d.current?.disconnect()},[]);const{title:g,titleSource:b}=bi(s),v=Ue(),{conversationLeafId:x}=Za(),{showEmptyState:E}=ur({clientThreadId:s,currentLeafId:x}),w=Qt(s),k=$c(),y=n.formatMessage(dn.newChatTitle),{resolvedTitle:S,isTypingEffect:T}=Yc(s,g??null,!0);if(!a||E)return null;const P=S==null&&(Tt(s)||b===yi.NewChat),j=w?e.jsx(e.Fragment,{}):e.jsxs(Lo,{$isScreenArch:v,$shimmer:P,children:[e.jsx("div",{className:"truncate",children:T?e.jsx(Qc,{text:S??""}):S??y}),e.jsx(qn,{className:"icon-md text-token-text-tertiary"})]}),N=k&&a.gizmo.display.emoji?e.jsxs(e.Fragment,{children:[a.gizmo.display.emoji," ",a.gizmo.display.name]}):a.gizmo.display.name;return e.jsxs("div",{className:"flex items-center gap-1 overflow-hidden whitespace-nowrap px-2 py-1.5",children:[e.jsx(Lo,{$isScreenArch:v,children:e.jsx(Cs,{className:"truncate",to:_o(a),children:N})}),e.jsxs(e.Fragment,{children:[e.jsx(wi,{className:"icon-md text-token-text-tertiary"}),e.jsxs(ma,{contentAlign:o?"center":"start",size:"small",triggerButton:j,contentClassName:"max-h-[50dvh] overflow-y-scroll",children:[e.jsx(Cs,{to:_o(a),children:e.jsx(re.Item,{icon:La,children:e.jsx(H,{...dn.newChatProjectDropdownItem,values:{name:`"${a.gizmo.display.name}"`}})},"new-chat")}),r.filter(M=>M.id!==s).map((M,D)=>{const p=l&&D===r.length-4?h:void 0;return e.jsx(bh,{elementRef:p,conversation:M,gizmoResource:a},M.id)}),m&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(ji,{})})]})]})]})}const wh=Oe(()=>ze(()=>import("./jgtdmbwjtz8r8ewv.js"),__vite__mapDeps([13,1,2,3,4,14])).then(t=>t.ThreadHeaderGizmoDropdown)),Bo=ge.button`group flex cursor-pointer items-center gap-1 rounded-lg py-1.5 ${({$isScreenArch:t})=>t?"h-[44px] @lg/screen-composer:pl-3 [line-height:26px] [font-size:17px] pl-1 pr-3":"px-3 text-lg"} hover:bg-token-main-surface-secondary radix-state-open:bg-token-main-surface-secondary font-semibold text-token-text-secondary overflow-hidden whitespace-nowrap`;function jh({clientThreadId:t}){const s=fe(),o=lt(),n=Ti(t),a=wn(),[,r]=oa(),l=()=>{!n&&!o?a({pathname:"/",search:new URLSearchParams({[hs]:"true"}).toString()}):r(c=>(c.get(hs)==="true"?c.delete(hs):c.set(hs,"true"),c),{replace:n,state:dd()})};return e.jsx(re.Item,{size:"large",className:"!pr-3",onClick:l,icon:id,children:e.jsxs("div",{className:"flex grow items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-1 items-center gap-3",children:e.jsx(H,{...pr.temporaryChat})}),e.jsx(ld,{enabled:o,label:s.formatMessage({defaultMessage:"Temporary",id:"temporaryChatToggleLabel"}),testId:"temporary-chat-toggle"})]})})}function mr(t,s,o){let n=t;if(t===bo.AUTO){const l=s.filter(({defaultModel:c})=>c!==bo.AUTO);l.length===1&&(n=l[0].defaultModel)}const a=s.find(({defaultModel:l})=>l===n);if(a){const{categoryId:l,shortLabel:c}=a;return{selectedCategory:l,modelLabel:c}}const r=o.find(({modelIds:l})=>l.includes(n));if(r){const{group:l,shortLabel:c}=r;return{selectedCategory:l,modelLabel:c}}return{selectedCategory:null,modelLabel:null}}function Ch({modelLabel:t}){return e.jsx("span",{className:"overflow-x-clip text-ellipsis text-token-text-secondary",children:t})}function Mh({clientThreadId:t,inMobileHeader:s}){const{isLoading:o,categories:n,groups:a}=$n(),r=Mi(),c=Yn(t).id,u=Zc(),{modelLabel:m}=mr(c,n,a),d=_h(t,u),h=fe(),{isUnauthenticated:g}=Pe(),b=hr(),v=(!g||!b)&&!r;i.useEffect(()=>{o||Jc({namespace:Ia.ChatPageLoad})?.logTiming("render_model_switcher")},[o]);const x=Ue(),E=e.jsxs("div",{className:I(x?"overflow-x-hidden text-ellipsis":"text-token-text-secondary"),children:[ed," ",v?e.jsx("span",{className:"text-token-text-secondary",children:m}):g&&m?e.jsx(Ch,{modelLabel:m}):null]});return d.length?o?null:e.jsx(ma,{sideOffset:8,size:"large",triggerButton:e.jsxs(Bo,{$isScreenArch:x,"aria-label":m?h.formatMessage({id:"JrtGPQ",defaultMessage:"Model selector, current model is {modelLabel}"},{modelLabel:m}):"",children:[E,x?e.jsx(td,{className:"icon-md text-token-text-tertiary"}):e.jsx(qn,{className:"icon-md text-token-text-tertiary"})]}),onOpenChange:w=>{K.logEvent(X.toggleModelSwitcher,{isOpen:w}),de.logEvent("toggle_model_switcher",null,{isOpen:String(w)})},contentAlign:s?"center":"start",testId:"model-switcher-dropdown",children:e.jsx(Nh,{sections:d})}):e.jsx(Bo,{className:"cursor-default",children:E})}function hr(){return Ve("462735957").value}function Th({category:t,modelSwitcherDenialsBySlug:s,currentGizmoId:o,currentModelId:n,omitIcon:a,testId:r}){const{defaultModel:l,label:c,categoryId:u,description:m,isBeta:d}=t;return e.jsx(gn,{value:l,currentModelId:n,modelSwitcherDenialsBySlug:s,renderName:h=>e.jsx(Sn,{categoryId:u,name:c,description:m,isDisabled:h,omitIcon:a,isBeta:d}),isSelected:!o&&n===l,testId:r},l)}function _h(t,s){const o=Yn(t),n=o.id,a=Te(t),{categories:r,groups:l}=$n(),{doesUserHaveAnyAccountsWithPlusFeatures:c}=_n(),u=ee.getServerThreadId(t),m=sd({clientThreadId:t}),d=fe(),h=!u,{isUnauthenticated:g}=Pe(),b=nd(),{layer:v}=We("2723963139"),x=v.get("is_dynamic_model_enabled",!1),E=hr(),w=s.find(({categoryId:R})=>R===Ye.ALPHA),k=s.find(({categoryId:R})=>R===Ye.DATA_CAMPAIGNS),y=s.find(({categoryId:R})=>R===Ye.EXPERIMENTS),S=s.find(({categoryId:R})=>R===Ye.MAINLINE),T=!0,P=!!w?.options?.length,j=!!k?.options?.length,N=!!y?.options?.length,M=!!S?.options?.length,D=wn(),p=i.useCallback(()=>{K.logEvent(X.openModalAccountPaymentfromModelPicker,{content:"gizmo-button"}),od(D,"Thread header dropdown")},[D]),L=()=>{de.logEvent("chatgpt_model_switcher_plus_upgrade_button_clicked"),K.logEvent(X.modelSwitcherPlusUpgradeButtonClicked),g?b({shouldOpenPaymentModalOnAuth:!0,callback:R=>{K.logSignUpButtonClicked({location:"Model switcher GPT-4 upsell",provider:R})}}):p()},C=[],B=e.jsxs("div",{className:"mb-1 flex items-center justify-between px-5 pt-2",children:[e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(H,{id:"ilkdMh",defaultMessage:"Model"})}),e.jsx("a",{href:x?"https://help.openai.com/en/articles/9155758-what-is-the-chatgpt-plus-model-selector":"https://help.openai.com/en/articles/7102672-how-can-i-access-gpt-4",target:"_blank",rel:"noreferrer",children:e.jsx(ud,{className:"icon-md h-5 w-5 pl-0.5 text-token-text-tertiary"})})]},"header");if(E&&g){const R={id:"modelSection",content:[]};R.content.push(e.jsx(ad,{},"noAuthUpsell")),C.push(R)}else if(c){const R={id:"modelSection",content:[]};r.length&&R.content.push(B);const f=new Map;r.forEach(z=>{const Y=e.jsx(Th,{category:z,currentGizmoId:a,currentModelId:n,modelSwitcherDenialsBySlug:m,omitIcon:T,testId:`model-switcher-${z.defaultModel}`},z.categoryId);z.subcategory?(f.has(z.subcategory)||f.set(z.subcategory,[]),f.get(z.subcategory)?.push(Y)):R.content.push(Y)}),f.forEach((z,Y)=>{const te=r.find(q=>q.subcategory===Y&&q.defaultModel===o.id);R.content.push(e.jsxs(re.Sub,{children:[e.jsx(re.SubMenuTrigger,{"data-testid":Y==="More models"?"more-models-submenu":void 0,children:e.jsxs("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:[Y,!!te&&e.jsx("div",{className:"truncate text-token-text-tertiary",children:te.label})]})}),e.jsx(re.Portal,{children:e.jsx(re.SubContent,{className:"min-w-72",children:z})})]},Y))}),C.push(R)}else{const R={id:"modelSection",content:[]};R.content.push(e.jsx(gn,{value:"",currentModelId:n,onClick:L,modelSwitcherDenialsBySlug:m,isUpgradeUpsell:!0,renderName:f=>e.jsx(Sn,{icon:cd,isDisabled:f,name:d.formatMessage({id:"mzDzkX",defaultMessage:"ChatGPT Plus"}),description:d.formatMessage({id:"bqTHri",defaultMessage:"Our smartest model & more"}),omitIcon:!1}),isSelected:!1,showNewChatHint:!1},"plusUpgrade")),R.content.push(e.jsx(gn,{value:Qs.AUTO,currentModelId:n,modelSwitcherDenialsBySlug:m,renderName:f=>e.jsx(Sn,{icon:rd,name:d.formatMessage({id:"U9E7Rx",defaultMessage:"ChatGPT"}),description:d.formatMessage({id:"n96qML",defaultMessage:"Great for everyday tasks"}),isDisabled:f,omitIcon:!1}),isSelected:!a&&n===Qs.AUTO,showNewChatHint:!0},Qs.AUTO)),C.push(R)}const O={id:"otherOptionsSection",content:[]},{selectedCategory:A}=mr(n,r,l);return h&&(P&&O.content.push(e.jsx(ms,{isSelected:A===Ye.ALPHA,currentModel:o,option:w,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},w.value)),j&&O.content.push(e.jsx(ms,{isSelected:A===Ye.DATA_CAMPAIGNS,currentModel:o,option:k,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},k.value)),N&&O.content.push(e.jsx(ms,{currentModel:o,isSelected:A===Ye.EXPERIMENTS,option:y,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},y.value)),M&&O.content.push(e.jsx(ms,{isSelected:A===Ye.MAINLINE,currentModel:o,option:S,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},S.value))),O.content.length&&C.push(O),g||C.push({id:"temporaryChatSection",content:[e.jsx(jh,{clientThreadId:t},"tempChat")]}),C}function kh(){const t=fe();return e.jsx("div",{className:"border-token-text-quartenary items-center rounded-full border px-1 py-0.5 text-[8px] font-semibold uppercase leading-3 text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary",children:t.formatMessage(pr.beta)})}function Sn({isDisabled:t,name:s,icon:o,categoryId:n,description:a,extra:r,omitIcon:l,isBeta:c=!1}){let u=s;return c&&(u=e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s}),e.jsx(kh,{})]})),e.jsxs("div",{className:"flex items-center gap-3",children:[!l&&e.jsx("span",{className:"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-token-main-surface-secondary",children:o?e.jsx(o,{className:"h-4 w-4 text-token-text-primary"}):n&&e.jsx(Ba,{type:"filled",className:I("h-4 w-4",t&&"text-gray-300",!t&&"text-token-text-primary"),categoryId:n})}),e.jsxs("div",{children:[u,e.jsxs("div",{className:I(!t&&"text-token-text-secondary","text-xs"),children:[a,r]})]})]})}function Nh({sections:t}){return e.jsx(e.Fragment,{children:t.map((s,o)=>e.jsxs(ha.Fragment,{children:[o!==0?e.jsx(re.Separator,{}):null,s.content]},s.id))})}function gr({clientThreadId:t,inMobileHeader:s=!1}){const o=Te(t),n=Jt(o);return o==null?e.jsx(Mh,{clientThreadId:t,inMobileHeader:s}):n?e.jsx(yh,{gizmoId:o,clientThreadId:t,inMobileHeader:s}):e.jsx(wh,{clientThreadId:t,gizmoId:o,inMobileHeader:s})}const pr=Ie({beta:{id:"XZwFET",defaultMessage:"Beta"},gpt35ShortExplainer:{defaultMessage:"Great for everyday tasks",id:"ModelSwitcher.gpt35ShortExplainer"},modelTunerSmartSelectionTitle:{id:"czjW8I",defaultMessage:"Dynamic"},modelTunerSmartSelectionExplainer:{id:"gp/YH1",defaultMessage:"Optimized for speed and intelligence"},gpt4ShortExplainer:{defaultMessage:"With DALL·E, browsing and analysis",id:"ModelSwitcher.gpt4ShortExplainer"},gpt4ShortExplainerWithoutBrowse:{defaultMessage:"With DALL·E and analysis",id:"ModelSwitcher.gpt4ShortExplainerWithoutBrowse"},gpt4UpsellExplainer:{id:"ModelSwitcher.gpt4Upsell",defaultMessage:"Our smartest and most capable model. Includes DALL·E, browsing and more."},userUpgrade:{id:"ModelSwithcer.upgradeButton",defaultMessage:"Upgrade to Plus"},userUpgradeSignup:{id:"ModelSwitcher.signupUpgradeButton",defaultMessage:"Sign up for ChatGPT Plus"},temporaryChat:{id:"ModelSwitcher.temporaryChat",defaultMessage:"Temporary chat"},shareChat:{id:"ModelSwitcher.shareChat",defaultMessage:"Share chat"}}),Ah=Oe(()=>ze(()=>import("./hvcfpboy784ti5qg.js"),__vite__mapDeps([15,1,2,16,17,3,4,18,19,20,21,22,23,24,12,25,9,26,27,28,11,14,29,30,31,32])).then(t=>t.GizmoUsingAsOwnerNotice)),fr=({clientThreadId:t})=>{const s=Un(m=>m.activeStageSidebar),o=ee.getServerThreadId(t),n=md(ys.WorkspaceShareLinks),{isUnauthenticated:a}=Pe(),r=lt(),l=n&&o&&!a&&!r,c=Ue(),u=!s&&!(c&&!a);return e.jsx("div",{className:I(!c&&"gap-2",c&&"@lg/screen-composer:gap-2","flex items-center pr-1 leading-[0]"),children:e.jsx(Ju,{showShareButton:l,showProfileDropdown:u,clientThreadId:t})})};function Eh({clientThreadId:t,gizmoId:s}){const o=hd(),{data:n}=It(s),a=Is();return e.jsxs(e.Fragment,{children:[e.jsxs(gd,{className:"max-md:hidden",children:[e.jsxs("div",{className:"absolute start-1/2 ltr:-translate-x-1/2 rtl:translate-x-1/2",children:[n!=null&&a?.isWorkspaceAccount()&&n.gizmo.tags?.includes(On.WorkspaceDisabled)&&e.jsx(Ah,{gizmo:n}),e.jsx(pd,{gizmoId:s,clientThreadId:t})]}),e.jsx(fd,{children:e.jsxs("div",{className:"flex items-center gap-0 overflow-hidden",children:[e.jsx(em,{clientThreadId:t}),e.jsx(gr,{clientThreadId:t})]})}),e.jsx(fr,{clientThreadId:t})]}),o&&e.jsx(xd,{})]})}function xr({clientThreadId:t}){const s=Te(t),o=Cn(),n=Ue();return o||n?null:e.jsx(Eh,{gizmoId:s,clientThreadId:t})}function Rh({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,enableV2Homepage:a,v2HomepageDisclaimer:r}){const l=lt();let c=e.jsx(Vu,{}),u;return l?(u=e.jsx(Ih,{}),c=e.jsx(Yt,{className:"mb-6 h-12 w-12"})):t!=null?(u=a?e.jsx(ir,{clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,v2HomepageDisclaimer:r}):e.jsx(qu,{clientThreadId:t}),c=null):u=e.jsx(Ph,{}),e.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-token-text-primary",children:[c,u]})}function Ih({gizmo:t}){const s=Sd(),o=t?bd(t.tools):!1,n=Is();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-5 text-2xl font-semibold","data-testid":"temporary-chat-label",children:[e.jsx(yd,{id:"temporary-chat-checkbox",name:"temporary-chat-checkbox",checked:!0}),e.jsx(H,{...ot.temporaryChat})]}),e.jsxs("div",{className:"max-w-sm text-center text-sm font-normal text-token-text-tertiary",children:[e.jsx(H,{...n?.isWorkspaceAccount()?s?ot.temporaryChatBizMemoryAvailable:ot.temporaryChatBizMemoryUnavailable:s?ot.temporaryChatDescriptionMemoryAvailable:ot.temporaryChatDescriptionMemoryUnavailable}),o&&e.jsx("div",{className:"mt-3",children:e.jsx(H,{...ot.temporaryChatDescriptionGptActions,values:{link:a=>e.jsx("a",{href:"https://help.openai.com/en/articles/8914046-temporary-chat-faq",target:"_blank",className:"underline",rel:"noreferrer",children:a})}})})]})]})}function Ph(){return e.jsx("div",{className:"mb-5 text-2xl font-semibold",children:e.jsx(H,{...ot.howCanIHelpYouToday})})}function vr({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,enableV2Homepage:a,v2HomepageDisclaimer:r}){const l=Te(t),c=_i(),u=jn(),{data:m}=It(l),d=vd(),h=ki(()=>navigator.windowControlsOverlay);return(c!=null||l!=null)&&m==null?null:e.jsxs("div",{className:"relative h-full",children:[e.jsx("div",{className:h?.visible?I("absolute right-[calc(100dvw-env(titlebar-area-width,100dvw)-env(titlebar-area-x,0))]",d?"left-[env(titlebar-area-x,0)]":"left-0"):"absolute left-0 right-0",children:e.jsx(xr,{clientThreadId:t})}),m!=null?e.jsx(Wu,{gizmo:m,showStarterPrompts:!0,disableStarterPrompts:u}):e.jsx(Rh,{clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,enableV2Homepage:a,v2HomepageDisclaimer:r})]})}const ot=Ie({temporaryChat:{id:"GizmoLanding.temporaryChat",defaultMessage:"Temporary Chat"},temporaryChatBizMemoryAvailable:{id:"g1opBW",defaultMessage:"This chat won't appear in your history and won't use or create memories."},temporaryChatBizMemoryUnavailable:{id:"fQmbtG",defaultMessage:"This chat won't appear your conversation history."},temporaryChatDescriptionMemoryAvailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryAvailable",defaultMessage:"This chat won't appear in history, use or create memories, or be used to train our models. For safety purposes, we may keep a copy for up to 30 days."},temporaryChatDescriptionMemoryUnavailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryUnavailable",defaultMessage:"This chat won't appear in history or be used to train our models. For safety purposes, we may keep a copy of this chat for up to 30 days."},temporaryChatDescriptionGptActions:{id:"GizmoLanding.temporaryChatDescriptionGptActions",defaultMessage:"Any data shared with a third party through GPT actions are subject to the third party's privacy policy. <link>Learn more</link>"},howCanIHelpYouToday:{id:"GizmoLanding.howCanIHelpYouToday",defaultMessage:"How can I help you today?"}});function Dh({className:t,clientThreadId:s,message:o,onModelSelect:n,onDropdownChange:a}){const r=fe(),[l,c]=i.useState(null),[u,m]=i.useState(!1),[d,h]=i.useState(!1),g=wd(),b=Fa(s),v=Te(s),x=Ha({clientThreadId:s,message:o}),E=o.message.metadata?.model_slug,{modelOptions:w,modelSlug:k,animateModelLabelOnRender:y,nuxProps:S,messageModelEnabledTools:T}=x,P=Ua(o.message),j=T.includes(Gn.Search),N=i.useMemo(()=>w.find(A=>A.value==E),[w,E]),{doesUserHaveAnyAccountsWithPlusFeatures:M}=_n(),D=i.useRef(null),p=A=>{A||setTimeout(()=>{D.current&&D.current.blur()},10)};if(i.useEffect(()=>{p(u)},[u]),!g||v)return null;const L=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:r.formatMessage(Fo.search),icon:e.jsx(Rn,{className:"icon-sm"}),condition:j&&!P,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:r.formatMessage(Fo.nosearch),icon:e.jsx(Oa,{className:"icon-sm"}),condition:j&&P,eventName:"chatgpt_regenerate_without_search_button_clicked"}];let C,B;S.shouldRenderNux?(C=Bh,B={title:e.jsx(H,{id:"g/+2Hh",defaultMessage:"Optimized your response"}),description:e.jsx(H,{id:"H0Flqm",defaultMessage:"Used {usedModelName} for a faster response that saves your limited {largestModelName} messages",values:{usedModelName:S.usedModelName,largestModelName:S.largestModelName}}),markAsViewed:S.announcement.markAsViewed}):(C=Lh,B={label:b?e.jsx(H,{id:"LBYK9a",defaultMessage:"Change model"}):e.jsx(H,{id:"nygjPN",defaultMessage:"Used {modelName}",values:{modelName:S.usedModelName}})});const O=b&&w.some(A=>$t(A,M));return e.jsxs(re.Root,{onOpenChange:A=>{b&&(m(A),a(A),p(A)),A&&K.logEvent(X.conversationOpenMessageModelSelector,{has_get_plus_button:O})},children:[e.jsx(C,{...B,children:e.jsx(ga,{ref:D,className:I("cursor-pointer",t),onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:e.jsx(Sr,{modelSlug:k,animateModelLabelOnRender:y,isDropdownOpen:u,isRegenerateEnabled:b,isHovered:d})})}),b&&e.jsxs(re.Content,{className:"z-30 origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[w.map(A=>{const R=$t(A,M),{value:f,...z}=A;return e.jsx(Mt,{value:f,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",f,{requestedModelId:f,...Xe({clientThreadId:s})}),n({requestedModelId:f})},onMouseEnter:()=>c(f),onMouseLeave:()=>c(null),isHovered:l===f,messageModelSlug:o.message.metadata?.model_slug,shouldShowUpsell:R,...z},f)}),!!N&&e.jsxs(e.Fragment,{children:[e.jsx(re.Separator,{}),L.filter(A=>A.condition).map(A=>e.jsx(Mt,{onSelect:()=>{de.logEvent(A.eventName,N.value,{requestedModelId:N.value,...Xe({clientThreadId:s})}),n({requestedModelId:N.value,extraStreamParams:A.extraStreamParams})},includeRegenerate:!0,onMouseEnter:()=>c(A.key),onMouseLeave:()=>c(null),isHovered:l===A.key,messageModelSlug:E,includeCheck:!1,...N,label:A.label,subtitle:"",icon:A.icon},A.key))]})]})]})}function Sr({modelSlug:t,animateModelLabelOnRender:s,isDropdownOpen:o,isRegenerateEnabled:n,isHovered:a,isRegenLabel:r=!1,animateShortLabel:l,omitIcon:c}){const[u,m]=i.useState("initial"),{categories:d}=$n({isRegen:!!r});i.useEffect(()=>{if(s){const w=setTimeout(()=>m("show"),500),k=setTimeout(()=>m("initial"),2e3);return()=>{clearTimeout(w),clearTimeout(k)}}m("initial")},[s]);const h=d.find(({defaultModel:w})=>w===t),g=t===jd?{categoryId:"gpt_3.5",shorterLabel:"3.5"}:{},{categoryId:b,shorterLabel:v}=h??g,x={initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"100%"},visible:{opacity:1,paddingLeft:2,width:"100%",transition:{delay:0,duration:0}}},E=o?"visible":a?"show":u;return e.jsxs(ne.div,{initial:"initial",animate:E,className:"flex items-center pb-0",children:[!c&&(r?e.jsx(Kn,{className:"icon-md"}):b&&e.jsx(Ba,{type:"outline",categoryId:b,className:"icon-md h-4 w-4"})),(n||l)&&e.jsx(ne.span,{className:"overflow-hidden text-clip whitespace-nowrap text-sm",variants:x,transition:{type:"tween",duration:.18},children:v}),n&&e.jsx(qn,{className:I("icon-sm",{"text-token-text-quaternary":!a&&!r},{"text-token-text-secondary":a&&!r})})]})}function Lh({children:t,label:s}){return e.jsx(Kt,{label:s,sideOffset:0,children:t})}function Bh({children:t,title:s,description:o,markAsViewed:n}){return e.jsx(Pn,{announcementKey:rt.ModelSwitcherAutoDowngrade,show:!0,side:"bottom",sideOffset:-4,title:s,description:o,badge:"beta",onDismiss:n,dismissOnOutsideClick:!0,children:t})}function $t(t,s){const{modelSwitcherDeny:o,subscriptionLevel:n}=t;return!!o&&o.reason===Ni.RATE_LIMIT&&n===Ai.PLUS&&!s}const Fo=Ie({search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),Fh=i.memo(Dh),Ss="rounded-lg radix-disabled:pointer-events-auto radix-disabled:cursor-not-allowed";function Hh({className:t,clientThreadId:s,message:o,onModelSelect:n,onDropdownChange:a,canRegenerateResponse:r}){const[c,u]=i.useState(null),[m,d]=i.useState(!1),[h,g]=i.useState(!1),b=Te(s),v=Ha({clientThreadId:s,message:o}),x=o.message.metadata?.model_slug,E=o.message.id,{modelOptions:w,modelSlug:k,animateModelLabelOnRender:y,messageModelEnabledTools:S}=v,T=Ua(o.message),P=S.includes(Gn.Search),j=i.useMemo(()=>w.find(C=>C.value===x),[w,x]),N=i.useRef(null),{doesUserHaveAnyAccountsWithPlusFeatures:M}=_n(),D=C=>{C||setTimeout(()=>{N.current&&N.current.blur()},10)};if(i.useEffect(()=>{D(m)},[m]),Ei(s))return null;const L=r&&w.some(C=>$t(C,M));return b?null:e.jsxs(re.Root,{onOpenChange:C=>{r&&(d(C),a(C),D(C)),C&&K.logEvent(X.conversationOpenMessageModelSelector,{has_get_plus_button:L,is_new_regen_dropdown:!0})},children:[r?e.jsx(Oh,{label:e.jsx(H,{id:"wDs5sz",defaultMessage:"Switch model"}),children:e.jsx(ga,{ref:N,className:I("cursor-pointer",t),onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:e.jsx(Sr,{modelSlug:k,animateModelLabelOnRender:y,isDropdownOpen:m,isRegenerateEnabled:r,isHovered:h,isRegenLabel:!0,omitIcon:!1})})}):null,r&&e.jsx(re.Portal,{children:e.jsxs(re.Content,{className:"z-30 min-w-fit origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[e.jsx(re.Item,{disabled:!0,className:"pb-0 pt-2",children:e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(H,{id:"bFLh5u",defaultMessage:"Switch model"})})}),e.jsx(Uh,{clientThreadId:s,messageId:E,onModelSelect:n,messageModelSlug:x,omitModelIcons:!0,modelOptions:w,setHoveredOption:u,hoveredOption:c,retryOption:j,lastResponseUsedSearch:T,modelSupportsSearch:P,doesUserHaveAnyAccountsWithPlusFeatures:M})]})})]})}function Uh({clientThreadId:t,messageId:s,modelOptions:o,messageModelSlug:n,onModelSelect:a,omitModelIcons:r,setHoveredOption:l,hoveredOption:c,retryOption:u,lastResponseUsedSearch:m,modelSupportsSearch:d,doesUserHaveAnyAccountsWithPlusFeatures:h}){const g=fe(),[b,v]=i.useMemo(()=>Cd(o,y=>y.subcategory),[o]),x=i.useMemo(()=>{const y=new Map;return b.forEach(S=>{const T=S.subcategory;T&&(y.has(T)||y.set(T,[]),y.get(T)?.push(S))}),y},[b]),E=I("icon-sm",r&&"order-10 ml-auto text-token-text-tertiary icon-md"),w=r?"right":"left",k=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:g.formatMessage(en.search),icon:e.jsx(Rn,{className:E}),condition:d&&!m,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:g.formatMessage(en.nosearch),icon:e.jsx(Oa,{className:E}),condition:d&&m,eventName:"chatgpt_regenerate_without_search_button_clicked"}];return e.jsxs(e.Fragment,{children:[v.map(y=>{const{value:S,...T}=y;return e.jsx(Mt,{value:S,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",S,{requestedModelId:S,...Xe({clientThreadId:t,messageId:s})}),a({requestedModelId:S})},includeRegenerate:!1,onMouseEnter:()=>l(S),onMouseLeave:()=>l(null),isHovered:c===S,messageModelSlug:n,includeCheck:!1,shouldShowUpsell:$t(y,h),className:Ss,...T,icon:r?e.jsx("span",{className:E}):T.icon,justifyIcon:w,wrapIcon:!r},S)}),[...x.entries()].map(([y,S])=>e.jsxs(re.Sub,{children:[e.jsx(re.SubMenuTrigger,{children:e.jsx("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:y})}),e.jsx(re.Portal,{children:e.jsx(re.SubContent,{className:"min-w-fit",children:S.map(T=>{const{value:P,...j}=T;return e.jsx(Mt,{value:P,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",P,{requestedModelId:P,...Xe({clientThreadId:t,messageId:s})}),a({requestedModelId:P})},includeRegenerate:!1,onMouseEnter:()=>l(P),onMouseLeave:()=>l(null),isHovered:c===P,messageModelSlug:n,includeCheck:!1,className:Ss,...j,icon:null,justifyIcon:w,wrapIcon:!r,shouldShowUpsell:$t(T,h)},y+"-"+P)})})})]},y)),!!u&&e.jsxs(e.Fragment,{children:[e.jsx(re.Separator,{}),e.jsx(Mt,{onSelect:()=>{de.logEvent("chatgpt_regenerate_try_again_button_clicked",u.value,{requestedModelId:u.value,...Xe({clientThreadId:t,messageId:s})}),a({requestedModelId:u.value})},includeRegenerate:!0,onMouseEnter:()=>l(u.value),onMouseLeave:()=>l(null),messageModelSlug:n,includeCheck:!1,className:Ss,...u,label:g.formatMessage(en.tryAgain),subtitle:u.label,icon:e.jsx(Kn,{className:E}),justifyIcon:w,wrapIcon:!r},u.value),k.filter(y=>y.condition).map(y=>e.jsx(Mt,{onSelect:()=>{de.logEvent(y.eventName,u.value,{requestedModelId:u.value,...Xe({clientThreadId:t,messageId:s})}),a({requestedModelId:u.value,extraStreamParams:y.extraStreamParams})},includeRegenerate:!1,onMouseEnter:()=>l(y.key),onMouseLeave:()=>l(null),isHovered:c===y.key,messageModelSlug:n,includeCheck:!1,className:Ss,...u,label:y.label,subtitle:"",icon:y.icon,justifyIcon:w,wrapIcon:!r},y.key))]})]})}function Oh({children:t,label:s}){return e.jsx(Kt,{label:s,sideOffset:0,children:t})}const en=Ie({tryAgain:{id:"VbsBGW",defaultMessage:"Try again"},search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),zh=i.memo(Hh),Ho=Oe(()=>ze(()=>import("./ohfy421oyz5q6uux.js").then(t=>t.r3),__vite__mapDeps([3,1,2,4])).then(t=>t.MemoryActionResult));function Uo(t,s,o){ee.updateTree(t,n=>{n.updateNodeMetadata(s,{inlineComparisonRating:o})})}function Oo(t){return{is_dark_mode:t,time_since_loaded:Math.floor(performance.now()/1e3),page_height:window?.innerHeight,page_width:window?.innerWidth,pixel_ratio:window?.devicePixelRatio,screen_height:window?.screen?.height,screen_width:window?.screen?.width}}const zo=({messages:t})=>{for(const{message:{metadata:s}}of t){const{augmented_paragen_prompt_label:o}=s??{};if(o)return o}};function Gh(t){const s=i.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null}),o=i.useRef({left:null,right:null});return t.stubSideBySideFeedback?e.jsx(br,{setPreferredFeedback:()=>{},leftVariantId:"left-placeholder",rightVariantId:"right-placeholder",leftTurn:null,rightTurn:null,originalTurn:null,hasActiveRequest:!0,visibilityStateRef:s,firstVisibleTokenTimestampsRef:o,...t}):e.jsx(Wh,{...t,visibilityStateRef:s,firstVisibleTokenTimestampsRef:o})}function Wh(t){const{clientThreadId:s,variantIds:o,variantsInStreamInfo:n,turnIndex:a,firstVisibleTokenTimestampsRef:r}=t;if(o.length!==2)throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");const l=to(),c=qh(),u=Mn(),m=Ri(),[d,h]=i.useMemo(()=>za(o.join(""))()<.5?[0,1]:[1,0],[o[0],o[1]]),g=d<h?"left":"right",b=g==="left"?"right":"left",v=o[d],x=o[h],E=Ct(yo(s,v)).id,w=Ct(yo(s,x)).id,k=Ct(rn(s,a,E)),y=Ct(rn(s,a,w)),S=g==="left"?k:y,T=g==="left"?y:k,P=n.display_treatment==="unskippable",j=l?"skippable_parallel_2_in_stream:a:2.0":"skippable_parallel_2_in_stream:a:1.5";i.useEffect(()=>(un.setState({displayingSideBySideFeedback:!0,unskippable:P}),()=>{un.setState({displayingSideBySideFeedback:!1,unskippable:!1})}),[P]),Md();const N=i.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null});i.useEffect(()=>Ii(Pi,{requestCompletion:()=>{const D=Ke(S.messages)?.completionSampleFinishTime,p=Ke(T.messages)?.completionSampleFinishTime,L=ee.getServerThreadId(s);if(c){const B=ee.getTree(s).getParentPromptNode(E),O=[k,y].map((f,z)=>({messageId:f.messages[f.messages.length-1].message.id,loadFirstTokenTime:z===0?r.current.left:r.current.right,loadEndTime:Ke(f.messages)?.completionSampleFinishTime})),A={},R=B.metadata?.variantsInStreamInfo==null&&B.message.metadata?.paragen_variants_info!=null;for(const f of O)A[f.messageId]=R?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:f.loadFirstTokenTime,load_end_time:f.loadEndTime};bs({shouldUseNewParagenEndpoint:c,params:{conversation_id:L,displayed_message_ids:O.map(f=>f.messageId),message_metadatas:A,rating:"skipped",selected_message_id:null,source_timestamp:Date.now(),ui_variant:l?2:1,user_prompt_message_id:B.message.id}})}else bs({shouldUseNewParagenEndpoint:c,params:{feedback_version:j,original_message_id:S.messages[S.messages.length-1]?.message.id,new_message_id:T.messages[T.messages.length-1]?.message.id,conversation_id:L,completion_comparison_rating:"skip",new_completion_placement:b,feedback_start_time:t.conversationTurnMountTime,compare_step_start_time:t.conversationTurnMountTime,original_completion_load_start_time:t.conversationTurnMountTime,original_completion_load_end_time:D??0,new_completion_load_start_time:t.conversationTurnMountTime,new_completion_load_end_time:p??0,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:Oo(m),...N.current}})}}),[k,y,E,s,t.conversationTurnMountTime,j,b,S?.messages,T?.messages,m,c,l,r]);const M=D=>{const L=ee.getTree(s).getLeafFromNode(D);ee.setThreadCurrentLeafId(s,L.id);const C=D===v,B=C===(g==="left"),O=Ke(S.messages)?.completionSampleFinishTime,A=Ke(T.messages)?.completionSampleFinishTime;S.messages.length>0&&Uo(s,S.messages[S.messages.length-1].nodeId,B?"original":"new"),T.messages.length>0&&Uo(s,T.messages[T.messages.length-1].nodeId,B?"original":"new");let R;O==null||A==null?R=B?"partial_load_comparison_original":"partial_load_comparison_new":R=B?"original":"new";const f=ee.getServerThreadId(s);if(c){const z=[k,y].map((Z,ue)=>({messageId:Z.messages[Z.messages.length-1].message.id,loadFirstTokenTime:ue===0?r.current.left:r.current.right,loadEndTime:Ke(Z.messages)?.completionSampleFinishTime})),Y=C?z[0].messageId:z[1].messageId,q=ee.getTree(s).getParentPromptNode(E),xe={},ie=q.metadata?.variantsInStreamInfo==null&&q.message.metadata?.paragen_variants_info!=null;for(const Z of z)xe[Z.messageId]=ie?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:Z.loadFirstTokenTime,load_end_time:Z.loadEndTime};bs({shouldUseNewParagenEndpoint:c,params:{conversation_id:f,displayed_message_ids:z.map(Z=>Z.messageId),message_metadatas:xe,rating:"selected",selected_message_id:Y,source_timestamp:Date.now(),ui_variant:l?2:1,user_prompt_message_id:q.message.id}})}else bs({shouldUseNewParagenEndpoint:c,params:{feedback_version:j,original_message_id:S.messages[S.messages.length-1]?.message.id,new_message_id:T.messages[T.messages.length-1]?.message.id,conversation_id:f,completion_comparison_rating:R,new_completion_placement:b,feedback_start_time:t.conversationTurnMountTime,compare_step_start_time:t.conversationTurnMountTime,original_completion_load_start_time:t.conversationTurnMountTime,original_completion_load_end_time:O??null,new_completion_load_start_time:t.conversationTurnMountTime,new_completion_load_end_time:A??null,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:Oo(m),...N.current}})};return e.jsx(br,{...t,setPreferredFeedback:M,leftVariantId:v,rightVariantId:x,leftTurn:k,rightTurn:y,hasActiveRequest:u,originalTurn:S,visibilityStateRef:N})}function Vh(t){if(!t.length)return!1;const s=t.filter(o=>o.type===No.Text||o.type===No.MultiText).filter(o=>o.message.message.status!=="finished_successfully"&&o.message.message.metadata?.snorkle_status!==void 0);return s.length>0&&s.every(o=>{const n=o.message.message.content;return n?.content_type===pa.Text&&n.parts.join("")===""})}function br({setPreferredFeedback:t,leftVariantId:s,rightVariantId:o,leftTurn:n,rightTurn:a,hasActiveRequest:r,originalTurn:l,visibilityStateRef:c,...u}){const{defaultParagenLabel:m,shouldShowParagenLabels:d=!1}=Ta(),h=n&&zo(n)||m,g=a&&zo(a)||m,b=i.useMemo(()=>n?.messages??[],[n?.messages]),v=i.useMemo(()=>a?.messages??[],[a?.messages]),{avatarClassName:x,firstVisibleTokenTimestampsRef:E}=u,w=i.useMemo(()=>As(b),[b]),k=i.useMemo(()=>As(v),[v]),y=xa(),[S,T]=i.useMemo(()=>[w,k].map(z=>Vh(z)),[w,k]),P=at(n?Ms.getRequestIdFromConversationTurn(n):"")||S,j=at(a?Ms.getRequestIdFromConversationTurn(a):"")||T,N=n?.role===He.User,M=a?.role===He.User,D=i.useRef(null),p=i.useRef(null),L=i.useRef(null),C=u.stubSideBySideFeedback||S,B=u.stubSideBySideFeedback||T;!C&&E.current.left==null&&(E.current.left=Date.now()),!B&&E.current.right==null&&(E.current.right=Date.now()),i.useEffect(()=>{if(D.current&&p.current&&L.current){const z=Array(11).fill(0).map((te,q)=>q/10),Y=new IntersectionObserver(te=>te.forEach(q=>{q.target===p.current?(c.current.left_visibility_initial==null&&(c.current.left_visibility_initial=q.intersectionRatio),c.current.left_visibility_max=Math.max(c.current.left_visibility_max??0,q.intersectionRatio)):q.target===L.current&&(c.current.right_visibility_initial==null&&(c.current.right_visibility_initial=q.intersectionRatio),c.current.right_visibility_max=Math.max(c.current.right_visibility_max??0,q.intersectionRatio))}),{root:D.current,threshold:z});return Y.observe(p.current),Y.observe(L.current),()=>Y.disconnect()}},[c]);const{data:O}=va(void 0,!1,y),A=to(),R=e.jsx("div",{className:"text-pretty px-6 pb-5 pt-1 text-center text-sm text-token-text-secondary",children:e.jsx(H,{id:"TK934w",defaultMessage:"Which response do you prefer? Responses may take a moment to load."})}),f=Ue();return e.jsxs("div",{className:"relative flex flex-col",children:[e.jsxs("div",{className:I("sticky z-[1] text-pretty bg-token-main-surface-primary px-6 text-center text-lg",f&&"top-[var(--thread-leading-height)] pt-3",!f&&"top-[-1px]",A&&!f?"md:top-header-height":f?"":"md:static"),"data-testid":"paragen-feedback-title",children:[e.jsx(H,{id:"JgCHDY",defaultMessage:"You’re giving feedback on a new version of ChatGPT."}),A?R:null]}),A?null:R,e.jsx("div",{className:"relative -mb-2 snap-x snap-mandatory overflow-x-auto px-3 pb-4 md:px-5 lg:px-10",ref:D,children:e.jsx("div",{className:I(!f&&"min-w-fit"),children:e.jsxs("div",{className:I("mx-auto flex max-w-6xl items-start",A&&!f&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",!A&&!f&&"gap-4 sm:gap-6",A&&f&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",f&&!A&&"gap-4 sm:gap-6"),children:[e.jsxs(Go,{horizontalScrollContainerRef:D,rootElementRef:p,onClick:()=>{t(s)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:C,children:[e.jsxs(qo,{children:[e.jsx(pn,{messages:b,isUserTurn:N,avatarClassName:x}),e.jsx(Vo,{children:d?e.jsx("span",{className:"font-bold text-token-text-primary",children:h}):e.jsx(H,{...Yo.responseNumber,values:{responseIndex:1}})})]}),A&&C?e.jsx(Wo,{}):e.jsxs(e.Fragment,{children:[O!=null&&!N&&e.jsx(Ho,{clientThreadId:u.clientThreadId,messages:b,isParagen:!0}),e.jsx(fn,{...u,groupedMessagesToRender:w,allGroupedMessages:w,isEditing:!1,isUserTurn:N,isCompletionRequestInProgress:P,hasActiveRequest:r,handleEnterEdit:us,handleExitEdit:us,shouldGrowContainer:!1}),e.jsx($o,{clientThreadId:u.clientThreadId,conversationTurnMountTime:u.conversationTurnMountTime,turn:n,originalTurn:l})]})]}),e.jsxs(Go,{horizontalScrollContainerRef:D,rootElementRef:L,onClick:()=>{t(o)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:B,children:[e.jsxs(qo,{children:[e.jsx(pn,{messages:v,isUserTurn:M,avatarClassName:x}),e.jsx(Vo,{children:d?e.jsx("span",{className:"font-bold text-token-text-primary",children:g}):e.jsx(H,{...Yo.responseNumber,values:{responseIndex:2}})})]}),A&&B?e.jsx(Wo,{}):e.jsxs(e.Fragment,{children:[O!=null&&!M&&e.jsx(Ho,{clientThreadId:u.clientThreadId,messages:v,isParagen:!0}),e.jsx(fn,{...u,groupedMessagesToRender:k,allGroupedMessages:k,isEditing:!1,isUserTurn:M,isCompletionRequestInProgress:j,hasActiveRequest:r,handleEnterEdit:us,handleExitEdit:us,shouldGrowContainer:!1}),e.jsx($o,{clientThreadId:u.clientThreadId,conversationTurnMountTime:u.conversationTurnMountTime,turn:a,originalTurn:l})]})]})]})})})]})}function Go({horizontalScrollContainerRef:t,rootElementRef:s,onClick:o,children:n,hasActiveRequest:a,isWaitingOnFirstUserVisibleToken:r}){const l=to(),c=Ue(),{scrollX:u}=Td({layoutEffect:!1,container:t,target:s}),m=_d(),d=kd(),h=i.useRef(null),g=i.useRef(null),b=i.useRef(null),[v,x]=i.useState(!1),[E,w]=i.useState(!1),[k,y]=i.useState(!1),[S,T]=i.useState(0);i.useEffect(()=>{if(!l)return;const L=new IntersectionObserver(C=>{for(const B of C)B.target===h.current?x(B.isIntersecting):B.target===b.current?y(B.isIntersecting):B.target===g.current&&w(B.isIntersecting)},{root:m?.current,rootMargin:c?`0px 0px -${S}px 0px`:void 0});return h.current&&g.current&&b.current&&(L.observe(h.current),L.observe(g.current),L.observe(b.current)),()=>{L.disconnect()}},[S,l,c,m]);const P=!k&&(E||v),j=Nd(u,L=>P?-1*L:0),N=ko(0);i.useEffect(()=>{if(!l)return;const L=new ResizeObserver(C=>{gs(C.length===1,"entryList.length === 1");const B=C[0];gs(B.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),N.set(B.contentBoxSize[0].inlineSize)});return s.current&&L.observe(s.current),()=>{L.disconnect()}},[l,N,s]);const M=ko(0);i.useEffect(()=>{if(!l)return;const L=new ResizeObserver(C=>{gs(C.length===1,"entryList.length === 1");const B=C[0];gs(B.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),M.set(B.contentBoxSize[0].blockSize+16),T(B.contentBoxSize[0].blockSize)});return d.current&&L.observe(d.current),()=>{L.disconnect()}},[l,M,d]);const D=e.jsx(Rt,{className:l?"px-5":"mt-4 self-start",onClick:o,"data-testid":"paragen-prefer-response-button",children:e.jsx(H,{id:"U2EAH6",defaultMessage:"I prefer this response"})}),p=r;return e.jsxs("div",{"data-paragen-root":!0,className:I("relative flex w-full min-w-[min(450px,80vw)] snap-center flex-col gap-1 text-left",c&&l&&"pl-3 pr-5 sm:w-[calc(100cqw-62px)] sm:pl-3 sm:pr-5 md:px-10",!c&&l&&"px-10",l?"min-h-60 py-4":"rounded-2xl border border-token-main-surface-tertiary bg-white p-5 dark:bg-gray-700"),ref:s,children:[e.jsx("div",{className:I("absolute left-0 right-0 top-48 h-px","invisible"),ref:h}),e.jsx("div",{className:I("absolute bottom-0 left-0 right-0 top-48","invisible"),ref:g}),e.jsx("div",{className:I("absolute bottom-0 left-0 right-0 h-px","invisible"),ref:b}),n,l?e.jsx("div",{className:"flex-1"}):null,l?e.jsx("div",{className:"mt-4 min-h-10",children:p?null:e.jsx(ne.div,{style:{translateX:j,width:N,bottom:M},animate:{opacity:100},initial:{opacity:0},transition:{ease:"easeOut",duration:.2,delay:.5},className:I({fixed:P,"z-20 flex w-full justify-center":!0}),children:D})}):a?null:D]})}function Wo(){return e.jsxs("div",{className:"flex w-full flex-col gap-4 pb-5 pt-3",children:[e.jsx(nt,{className:"h-4 w-[75%]"}),e.jsx(nt,{className:"h-4 w-[50%]"}),e.jsx(nt,{className:"h-4 w-[80%]"}),e.jsx(nt,{className:"h-4 w-[55%]"}),e.jsx(nt,{className:"h-4 w-[66%]"}),e.jsx(nt,{className:"h-4 w-[64%]"}),e.jsx(nt,{className:"h-4 w-[48%]"})]})}function to(){const{layer:t}=We("3119715334");return t.get("should-enable-hojicha",!1)}const Vo=ge.div`text-sm text-token-text-secondary font-semibold`,qo=ge.div`flex gap-4 items-center mb-1`,nt=ge.div`animate-pulse rounded-[4px] bg-token-main-surface-tertiary`;function $o({clientThreadId:t,conversationTurnMountTime:s,turn:o,originalTurn:n}){const a=Hn();if(!a.showParagenMetadata||!a.showDebugConversationTurns&&!a.forceParagen||o==null)return null;let r=o===n?"ORIGINAL":"NEW";const l=o.messages[o.messages.length-1],c=l?.message?.metadata?.__internal;if(c){const{model_id:h,model_definition_slug:g,model_definition_virtual_model_id:b,alternative_model_selection_rule:v,augmented_paragen_prompt_group_id:x,augmented_paragen_prompt_id:E,augmented_paragen_prompt:w}=c;h&&(r+=`
Model ID: ${h}`),g&&(r+=`
Model Slug: ${g}`),b&&(r+=`
Virtual Model ID: ${b}`),v&&(r+=`
Alternative Model Rule: ${v}`),x&&(r+=`
Prompt Group ID: ${x}`),E&&(r+=`
Prompt ID: ${E}`),w&&(r+=`
Prompt: ${w}`)}r+=`
Message ID: ${l.message.id}`;const m=ee.getTree(t).getParentPromptNode(o.variantIds[0]),d=m.metadata?.variantsInStreamInfo==null&&m.message.metadata?.paragen_variants_info!=null;return r+=`
User prompt message ID: ${m.message.id}`,r+=`
Is Persisted Paragen? ${d}`,r+=`
Completion Sample Finish Time: ${d?`${s} (persisted)`:Ke(o.messages)?.completionSampleFinishTime}`,e.jsx("div",{className:"whitespace-pre-wrap text-sm text-red-500",children:r})}async function bs({shouldUseNewParagenEndpoint:t,params:s}){t?await Nt.submitParagenSelectionV2(s):await Nt.submitMessageComparisonFeedback(s)}function qh(){const{value:t}=Ve("3894844102");return t}const Yo=Ie({responseNumber:{id:"ConversationTurnTwoUpFeedback.responseNumber",defaultMessage:"Response {responseIndex, number}"}}),Ko=[1,2,3,4,10,20,30],$h=.5;function Yh({clientThreadId:t,conversationLeafId:s}){const o=Ga(Wa.isBusinessWorkspace),n=i.useRef(!1),a=Xt(t),r=Ps(t),{isUnauthenticated:l}=Pe(),c=i.useMemo(()=>{if(!a)return-1;const M=za(a);return M()>$h?-1:Ko[Math.floor(M()*Ko.length)]},[a]),u=Di(t,s),m=u[u.length-1],d=i.useMemo(()=>Ms.getRequestIdFromConversationTurn(m),[m]),h=at(d),[g,b]=i.useState(null),[v,x]=i.useState(!1),[E,w]=i.useState(!1),[k,y]=i.useState(!1),S=M=>{const D=Ke(u)?.messages[0]?.message.id;b(M),j(D,M)},T=u.filter(M=>M.role===He.Assistant).length,P=m?.role===He.Assistant,j=i.useMemo(()=>Da((M,D)=>{a&&M&&Nt.submitConversationRating({conversation_id:a,message_id:M,rating:D,shown_at_assistant_turn:c}),K.logEvent(X.conversationRatingSubmitted,{rating:D,showAtAssistantTurn:c,conversationId:a}),x(!0),setTimeout(()=>{w(!0)},1500)},2e3),[a,c]),N=T!==c||h||!P||!!o||r?.kind!==Qe.PrimaryAssistant||k||l;return i.useEffect(()=>{!N&&!n.current&&(K.logEvent(X.conversationRatingShown,{showAtAssistantTurn:c,conversationId:a}),n.current=!0)},[N]),k||N?null:e.jsxs("div",{className:"mx-auto",children:[e.jsx(Zt,{children:v&&!E&&e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Xo,{$padded:!0,children:e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(H,{id:"rating.thanks",defaultMessage:"Thanks for your feedback!"})})})},"submitted")}),!v&&e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},children:e.jsxs(Xo,{$padded:!1,children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 px-4 py-3 text-sm text-token-text-secondary",children:[e.jsx(H,{id:"rating.instructions",defaultMessage:"Is this conversation helpful so far?"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx(tn,{$selected:g==="thumbsUp",onClick:()=>S("thumbsUp"),children:e.jsx(Va,{className:"icon-md"})}),e.jsx(tn,{$selected:g==="thumbsDown",onClick:()=>S("thumbsDown"),children:e.jsx(qa,{className:"icon-md"})})]})]}),e.jsx("div",{className:"w-px flex-1 self-stretch bg-token-main-surface-tertiary"}),e.jsx(tn,{className:"p-3",$selected:!1,onClick:()=>y(!0),children:e.jsx(Li,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})})]})},"rating")]})}const tn=ge.button`
  ${t=>t.$selected?"text-token-text-primary":"text-token-text-secondary"}
  hover:text-token-text-primary
`,Xo=ge.div`inline-flex rounded-xl border border-gray-100 dark:border-gray-700
${t=>t.$padded&&"py-3 px-4"}
`,Kh=Oe(()=>ze(()=>import("./maqvzo8ucjaq2m1m.js"),__vite__mapDeps([33,1,2,3,4,34,9])));function Xh({clientThreadId:t,conversationLeafId:s,canShowInlineMessageFeedback:o,messageForRating:n,allGroupedMessages:a,currentModelId:r}){let l=null;const c=Bi(t,s),u=Xt(t),m=Un(g=>g.voiceFeedbackThread),d=u===m,{voiceName:h}=Ad();return c?null:(d&&u?(Fi.feedbackShown.success({voice:h}),l=e.jsx("div",{className:"text-center",children:e.jsx(Ed,{serverThreadId:u})})):n.rating&&o?l=e.jsx(Kh,{clientThreadId:t,conversationMessage:n,allGroupedMessages:a,currentModelId:r}):l=e.jsx("div",{className:"text-center",children:e.jsx(Yh,{clientThreadId:t,conversationLeafId:s})}),e.jsx("div",{className:"mt-3 w-full empty:hidden",children:l}))}const Qh=Oe(()=>ze(()=>import("./j573n0nvcc2pb880.js"),__vite__mapDeps([35,1,2,36,3,4,37])).then(t=>t.VoicePlayButton)),Qo=128,Zo={minHeight:"calc(100cqh - var(--thread-leading-height) - var(--thread-trailing-height) - var(--previous-turn-min-height))"};function Zh(t){const{turnIndex:s,conversationLeafId:o,isFinalTurn:n,clientThreadId:a,onChangeItemInView:r,onChangeRating:l,currentModelId:c,avatarClassName:u,showAvatar:m=!0,scrollToMessageId:d,shouldShowDateHeader:h}=t,g=fe(),b=Dn(),v=!!b&&Hi(b),x=Cn(),E=Ga(Wa.isBusinessWorkspace),w=na(),{value:k}=Ve("2848981774"),y=ee.getServerThreadId(a),S=Ct(rn(a,s,o)),{messages:T,variantIds:P,variantsInStreamInfo:j}=S,N=As(T),M=Rd();let D=T[T.length-1];for(const W of N){const he=Ou(W);if(he.some(tt=>M.has(tt.message.id))){D=he[he.length-1];break}}const p=T.slice(0,T.indexOf(D)+1),L=zn(),[C,B]=i.useState(!1),[O,A]=i.useState(!1),R=P.findIndex(W=>p.some(he=>he.nodeId===W)),f=S.role===He.User,z=lt(),Y=Te(a),te=It(S.gizmoId??Y)?.data,q=Bs(c),xe=Id(c),ie=Ue(),Z=Ps(a,te?.gizmo.id),we=ra(a)===ia.STREAMING,De=!1,{value:le}=js("2291672486"),pe=p.some(W=>W.message.content.content_type===pa.MultimodalText),{layer:je}=We("1547743984"),ve=y&&L&&je.get("show_share_button_inline",!1),{isUnauthenticated:Ae}=Pe(),[Ee,Le]=i.useState(!1),[Ce,U]=i.useState(!1),F=S.messages.map(W=>W.message.id),V=i.useRef(null),G=T[T.length-1],Q=G.rating,oe=(d?.length??0)>2&&d!=="finalAgentTurn"&&n&&k&&ie,me=()=>{p.length===1&&(K.logEvent(X.editPrompt,{id:p[0].message.id,threadId:ee.getServerThreadId(a)}),de.logEvent("chatgpt_edit_prompt"),B(!0))},Se=i.useCallback(()=>{B(!1)},[]),ae=i.useCallback(W=>{Pd(a,s,w,W)},[a,s,w]),Re=W=>{l({nodeId:G.nodeId,messageId:G.message.id,rating:W}),K.logEvent(W==="thumbsDown"?X.messageFeedbackThumbsDownClicked:X.messageFeedbackThumbsUpClicked,{id:G.message.id,threadId:ee.getServerThreadId(a),model:c,rating:W}),A(!0)},[$]=i.useState(()=>Date.now()),Me=i.useMemo(()=>Ms.getRequestIdFromConversationTurn(S),[S]),Ge=la({clientThreadId:a,conversationLeafId:o}),J=at(Me)&&!Ge,ct=Mn(),dt=As(p),ut=i.useRef(!1);i.useEffect(()=>{if(ut.current||d===void 0||!k||!ie||!V.current){d==="finalAgentTurn"&&n&&ut.current&&ee.updateScrollToMessageId(a,void 0);return}(F.includes(d)||d==="finalAgentTurn"&&n)&&(ut.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(V.current)if(d==="finalAgentTurn"&&n)V.current.scrollIntoView({behavior:"instant",block:"end"}),ee.updateScrollToMessageId(a,void 0);else{const W=V.current.offsetHeight;let he;W>Qo?he=Qo-W:he=0,V.current.style.scrollMarginTop=`calc(${he}px + 2px + var(--thread-leading-height))`,V.current.scrollIntoView({behavior:"smooth"})}})}))},[d,V.current]);const{showDebugConversationTurns:Hs}=Hn(),Pt=da(a),qe=Fa(a),mt=Dd({clientThreadId:a,conversationMode:Z}),_e=it(a),ht=i.useCallback(({requestedModelId:W,systemMessage:he,juice:tt,extraStreamParams:wt})=>{const Ut=new Vt;mt({id:G.nodeId,eventMetadata:{eventSource:"mouse"},turnTracker:Ut,requestedModelId:W,systemMessage:he,juice:tt,extraStreamParams:wt})},[G,mt]),es=De,gt=!x&&!Pt&&!z&&!f,Dt=Ld(),Lt=D.message.author.role===He.Assistant?D.message:null;Bd({isCompletionRequestInProgress:J,isUserTurn:f,message:Lt});const Bt=Ui(a,P),{isOpen:pt}=Fd(),Ze=Hd(Z),Ft=!Dt&&!Ze&&gt&&n&&j?.num_variants_in_stream===2&&!G.inlineComparisonRating&&!Bt,$e=Ud(S),Je=Ft,Us=Ft&&!$e,ft=!f&&!x&&!Pt&&!Ze&&!we&&!J&&!pt,xt=ft&&(!E||es||xe||v)&&!Ze&&!Ae&&!z,vt=!x&&!((J||we)&&n)&&P.length>1&&!C&&!Je;let St=!1;if(f&&p.length===1){const{shouldHideContent:W}=Od(p[0]);W&&(St=!0)}const Ht=f&&!Ze&&!x&&!pe&&p.length===1&&!St&&!C&&!Ae,Os=W=>{r(P[W]),K.logEvent(X.changeNode,{intent:"toggle_between"})};if(!zd(S,p,Hs)&&!Je)return oe?e.jsx("div",{style:Zo}):null;const et=p.some(({message:W})=>Oi.getAssetPointers(W).length>0),ts=!et&&n&&qe&&!le?e.jsx(ps,{onClick:()=>{de.logEvent("chatgpt_regenerate_try_again_button_clicked",c,{requestedModelId:c,...Xe({clientThreadId:a,turnIndex:s})});const W=new Vt;mt({id:_e,eventMetadata:{eventSource:"mouse"},turnTracker:W}),Ts()},icon:Kn,label:g.formatMessage({id:"ConversationTurn.regenerateTooltip",defaultMessage:"Regenerate"}),testId:"regenerate-turn-action-button"}):null,bt="h-[30px] rounded-md px-1 text-token-text-secondary hover:bg-token-main-surface-secondary",Gs=!et&&le?e.jsx(zh,{className:bt,clientThreadId:a,message:G,onModelSelect:ht,onDropdownChange:Le,canRegenerateResponse:qe}):null,Ws=!f&&!St&&(!n||!J)?e.jsx(eu,{onClick:ae}):null,ss=!f&&(!n||!J)&&(G.disclaimers??[]).length===0&&G.nodeId?e.jsx(Qh,{conversationId:a,message:G,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-xs text-token-text-tertiary hover:text-token-text-primary"}):null,ns=!f&&G&&(!n||!J)?e.jsx(tu,{message:G,isFinalTurn:n,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-token-text-tertiary hover:text-token-text-primary"}):null,yt=xt&&!J?e.jsxs("div",{className:"flex",children:[Q!=="thumbsDown"&&e.jsx(ps,{onClick:()=>Re("thumbsUp"),disabled:Q==="thumbsUp",icon:Q==="thumbsUp"?Gd:Va,label:g.formatMessage({id:"ConversationTurn.goodResponseTooltip",defaultMessage:"Good response"}),testId:"good-response-turn-action-button"},`thumbsUp:${G.nodeId}`),Q!=="thumbsUp"&&e.jsx(ps,{onClick:()=>Re("thumbsDown"),disabled:Q==="thumbsDown",icon:Q==="thumbsDown"?Wd:qa,label:g.formatMessage({id:"ConversationTurn.badResponseTooltip",defaultMessage:"Bad response"}),testId:"bad-response-turn-action-button"},`thumbsDown:${G.nodeId}`)]}):null,Vs=ve&&e.jsx(ps,{onClick:()=>{Ns.openSharingModal(y)},label:g.formatMessage({id:"ConversationTurn.shareButtonTooltip",defaultMessage:"Share conversation"}),className:"sm:hidden",icon:Vd}),qs=!le&&e.jsx(Fh,{className:bt,clientThreadId:a,message:G,onModelSelect:ht,onDropdownChange:Le});function os(W){return ie?W:e.jsx(Wn,{clientThreadId:a,isStaticSharedThread:x,withVerticalPadding:!0,withHorizontalPadding:!Je,children:W})}function as(W){return ie?W:e.jsx(qt,{children:W})}return e.jsxs(e.Fragment,{children:[h&&e.jsx(qd,{turn:S}),e.jsxs("article",{className:I("w-full scroll-mb-[var(--thread-trailing-height,150px)] text-token-text-primary focus-visible:outline-2 focus-visible:outline-offset-[-4px]",d==="finalAgentTurn"&&k&&ie?"opacity-0":""),style:oe?Zo:void 0,ref:V,dir:"auto","data-testid":`conversation-turn-${s}`,"data-scroll-anchor":n,onMouseEnter:()=>U(!0),onMouseLeave:()=>U(!1),children:[e.jsx($d,{role:S.role}),os(e.jsx(e.Fragment,{children:Je?e.jsx(Gh,{isFeedbackEnabled:xt,variantIds:P,variantsInStreamInfo:j,conversationTurnMountTime:$,stubSideBySideFeedback:Us,...t}):as(e.jsxs(e.Fragment,{children:[!f&&m&&e.jsx(Jh,{children:e.jsx(pn,{messages:p,isUserTurn:f,avatarClassName:u,gizmo:te})}),e.jsx("div",{className:I("group/conversation-turn relative flex w-full min-w-0 flex-col",!f&&Yd),children:e.jsx("div",{className:"flex-col gap-1 md:gap-3",children:e.jsxs(e.Fragment,{children:[!f&&!x&&e.jsx(Kd,{messages:p,clientThreadId:a,gizmoId:te?.gizmo.id}),!1,e.jsx(fn,{groupedMessagesToRender:dt,allGroupedMessages:N,...t,isEditing:C,isUserTurn:f,isCompletionRequestInProgress:J,isFeedbackEnabled:xt,isFinalTurn:n,hasActiveRequest:ct,showEditButton:Ht,handleEnterEdit:me,handleExitEdit:Se}),q&&e.jsx("div",{className:"mb-4",children:e.jsx(Xd,{messages:p})}),(ft||vt)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:I("mb-2 flex gap-3 empty:hidden",f?"mr-1 flex-row-reverse":"-ml-2"),children:e.jsx(Qd,{alwaysShow:n,showInline:n||vt,isHovered:Ce||Ee,pagination:vt&&e.jsx(Zd,{showInline:n||vt,currentPage:R,onChangeIndex:Os,length:P.length,className:I("self-center",P.length>1?"visible":"!invisible")}),actions:ft&&e.jsxs(e.Fragment,{children:[ss,Ws,ts,yt,ns,qs,Vs,Gs]})})}),ft&&!J?e.jsx("div",{className:"pr-2 lg:pr-0",children:e.jsx(Jd,{message:G,isFinalTurn:n})}):null,n&&!J&&e.jsx(Xh,{canShowInlineMessageFeedback:O,clientThreadId:a,conversationLeafId:o,messageForRating:G,allGroupedMessages:N,currentModelId:c})]})]})})})]}))}))]})]})}const bn=ha.memo(Zh),Jh=ge.div`flex-shrink-0 flex flex-col relative items-end`;function eg({onChangeItemInView:t,onRequestMoreCompletions:s,onChangeRating:o,onRequestCompletion:n,clientThreadId:a,conversationLeafId:r,hideHeader:l}){const c=ye(),u=Ds(),m=su(),[d]=nu(),h=ou(),[g]=au(),b=Ps(a),v=Is(),x=Yn(a),E=zi(a),w=c.store.useContentAreaDimensions(At.Header,f=>f?.height?f.height:void 0),k=c.store.useIsHeaderContentAreaPopulated(),y=fa(a),{isArchived:S}=y,T=ru(x.id),P=b?.kind===Qe.GizmoMagicCreate?"bg-token-main-surface-primary text-token-text-primary":T,j=kn(a,r),N=iu(),[M,D]=i.useState(0),[p,L]=i.useState(!1);i.useEffect(()=>{u&&(M===0?D(j):!p&&j>M&&(L(!0),de.logEvent("chatgpt_continue_conversation_first_message_sent"),K.logEvent(X.continueConversationFirstMessageSent)))},[j,M,p,u]),i.useEffect(()=>{u&&(de.logEvent("chatgpt_continue_conversation_page_loaded"),K.logEvent(X.continueConversationPageLoaded))},[u]);const C=i.useCallback(()=>{m({behavior:"smooth"})},[m]),B=lu(a),O=N&&!S,A=$a(a,r),R=(f,z,Y)=>[...new Array(z-f).keys()].map(te=>{const q=te+f;return e.jsx(bn,{isFinalTurn:Y(q),turnIndex:q,clientThreadId:a,conversationLeafId:r,onChangeItemInView:t,onChangeRating:o,onRequestMoreCompletions:s,onRequestCompletion:n,currentModelId:x.id,avatarClassName:P,scrollToBottom:C,shouldShowDateHeader:A(q)},q)});return e.jsxs("div",{onCopy:B,className:I("flex flex-col text-sm",O&&"pb-[120px]",w||O?null:"md:pb-9"),style:{paddingBottom:O?void 0:w},children:[!l&&v?.data&&e.jsx(xr,{clientThreadId:a}),u&&e.jsxs(e.Fragment,{children:[e.jsx(qt,{children:e.jsx("p",{className:"text-xs text-gray-500",children:e.jsx(H,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),j-M===0&&e.jsx("div",{className:"text-center text-xs font-semibold text-token-text-primary",children:e.jsx("button",{onClick:()=>{Ns.openModal(cu.ReportConversation),de.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),K.logEvent(X.sharedConversationReportContentClicked,{location:"Dynamic Shared Thread Page"})},children:e.jsx(H,{id:"thread.reportSharedConversation",defaultMessage:"Report content"})})}),R(0,M,f=>f===M-1),e.jsx(qt,{children:e.jsxs("p",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(du,{className:"icon-xs mr-2"}),e.jsx(H,{id:"threadLayout.sharedConversationPrivateDisclaimer",defaultMessage:"Messages beyond this point are only visible to you"})]})}),R(M,j,f=>f===j-1)]}),!u&&R(0,j,f=>f===j-1),E&&d&&!g&&e.jsx(Jo,{className:I("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{de.logEvent("chatgpt_thread_scroll_to_top"),h({behavior:"smooth"})},children:e.jsx(uu,{className:"icon-md text-token-text-primary"})}),!d&&e.jsx(Jo,{className:I(w?null:"bottom-5",O?k?"translate-y-[-50px]":"translate-y-[-10px]":""),style:{bottom:N?"calc(var(--composer-bar_footer-current-height) + var(--composer-bar_current-height))":w},onClick:()=>{de.logEvent("chatgpt_thread_scroll_to_bottom"),m({behavior:"smooth"})},children:e.jsx(mu,{className:"icon-md text-token-text-primary"})})]})}const Jo=ge.button`cursor-pointer absolute z-10 rounded-full bg-clip-padding border text-token-text-secondary border-token-border-light right-1/2 translate-x-1/2 bg-token-main-surface-primary w-8 h-8 flex items-center justify-center`,tg=60,sg=({children:t,scrollViewClassName:s,scrollAnchorTopOffset:o=0})=>{const n=i.useRef(null);return e.jsx("div",{className:"h-full",ref:n,children:e.jsx(Nn,{children:e.jsx(Uu,{className:"h-full",followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:s,scroller:()=>ng(n,o)?0:1/0,children:t})})})},ng=(t,s)=>{const o=og(t.current);if(o==null)return!1;const n=o>s,a=o<s-tg;return!n&&!a};function og(t){if(!t)return null;const s=t.querySelector('[data-scroll-anchor="true"]');if(!s)return null;const o=s.getBoundingClientRect().top,n=t.getBoundingClientRect().top;return o-n}const ag=Oe(()=>ze(()=>import("./nbnzbjtk43rlwmeo.js"),__vite__mapDeps([38,1,2,3,4,39,40,41,42,43,37,44])).then(t=>t.OpenDebugSidebarButton)),rg=Oe(()=>ze(()=>import("./krglaqwify041lpx.js"),__vite__mapDeps([45,1,2,3,4,9]))),ea=Ie({doNotShareSensitive:{id:"thread.modal.onboarding.title",defaultMessage:"Do not share sensitive materials with this application"},somethingWentWrong:{id:"thread.modal.unrecoverableError.title",defaultMessage:"Something went wrong"},tryAgainLater:{id:"thread.modal.unrecoverableError.description",defaultMessage:"We're sorry, but something went wrong. Please try again later."},resetThread:{id:"thread.modal.unrecoverableError.resetThread",defaultMessage:"Reset thread"},sharedConversationReportConversation:{id:"thread.sharedConversation.report",defaultMessage:"Report conversation"},latencyButton:{id:"thread.latencyButton",defaultMessage:"Latency"},archivedConversationDescription:{id:"thread.archivedConversationDescription",defaultMessage:"This conversation is archived. To continue, please unarchive it first."},unarchiveButton:{id:"thread.unarchiveButton",defaultMessage:"Unarchive"}});function ig({clientThreadId:t}){const s=ca(),o=Xt(t),n=async()=>{o&&(await Nt.patchConversation(o,{is_archived:!1}),s.invalidateQueries({queryKey:["conversation",t]}),Tn.setState(a=>{const r=a.threads[o];r!=null&&(r.initialThreadData.isArchived=!1)}),Au(s))};return e.jsxs("div",{className:"my-6 flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"px-3 text-center text-sm text-token-text-secondary",children:e.jsx(H,{...ea.archivedConversationDescription})}),e.jsx("div",{children:e.jsx(Rt,{disabled:!o,onClick:n,icon:ku,children:e.jsx(H,{...ea.unarchiveButton})})})]})}const yg=function({clientThreadId:t,onCompletionFinished:s,onCreate:o,preRequestCompletion:n,hideHeader:a,hideMessages:r,hideFooter:l,hideToolsOverlay:c,messagesVerticalAlign:u="top",prependThreadChildren:m,renderEmptyState:d,prefetchSearch:h}){const g=aa(),b=Ln(t),v=Qt(t),x=it(t),w=fa(t).isArchived;i.useEffect(()=>{v||(Tt(t)?an.addTiming("chatgpt.web.chatPage.renderNewConversation"):an.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[t,v]);const k=ua(t,x),y=kn(t,x),{setTargetedContent:S}=Fn(),T=g?.includes(Gi),P=hu(),j=y>=2;Bn(j);const N=Tt(t)&&!j&&ws(b),M=Tt(t)&&!k&&(ws(b)||b?.kind===Qe.GizmoTest),p=Ra().id,L=Wi(t),C=L??p,B=!!L,O=Bs(C),R=Ea()[C],f=gu(t,b),z=Aa();Ya(y,t,x),i.useEffect(()=>{z||S(void 0)},[t,S,z,x]);const{caModal:Y,onRequestCompletion:te,onChangeItemInView:q,onChangeRating:xe,onRequestMoreCompletions:ie}=pu({clientThreadId:t,currentModelId:C,defaultModelId:p,onCompletionFinished:s,onThreadCreated:o,preRequestCompletion:n}),{isUnauthenticated:Z,isLoading:ue}=Pe(),we=Ka({clientThreadId:t,currentLeafId:x,handleRequestCompletion:te,prefetchSearchPromise:h});fu({clientThreadId:t,currentModelId:C});const De=Re=>e.jsx(sg,{scrollAnchorTopOffset:a?0:Nu,children:u==="bottom"?e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1"}),Re]}):Re});i.useEffect(()=>{document.title=f??"ChatGPT"},[f]);const le=Te(t),pe=lt(),je=Vi(),ve=M&&!je&&!d&&!le&&!O&&!pe,Ae=ve&&!ue&&Z,Ee=ve&&!ue&&!Z,Le=rh(Ae),Ce=lh(Ee),U=Ae&&Le||Ee&&Ce,F=Ds(),V=xu(),{reset:G,streamingContext:Q,StreamingProvider:oe}=vu();i.useEffect(()=>{V&&(Q.setOnResetContext=()=>{G()})},[V,G,Q]);const me=i.useRef(null),Se=i.useRef(null),ae=i.useMemo(()=>({threadContentScrollContainerElementRef:me,footerRootContainerElementRef:Se}),[]);return e.jsx(Su,{clientThreadId:t,currentLeafId:x,children:e.jsxs(oe,{value:Q,children:[T&&e.jsx(rg,{}),e.jsx(bu,{children:f!=null&&e.jsx("title",{children:f})}),e.jsx(qi.Provider,{value:te,children:e.jsxs(yu,{children:[e.jsxs(wu,{clientThreadId:t,currentModelConfig:R,className:"composer-parent flex h-full flex-col focus-visible:outline-0",children:[!r&&e.jsx(ju,{value:ae,children:e.jsx(lg,{ref:me,children:!v&&!we?M?d??e.jsx(vr,{clientThreadId:t,currentModelId:C,isModelLoaded:B,onRequestCompletion:te,enableV2Homepage:U,v2HomepageDisclaimer:U&&e.jsx(Es,{clientThreadId:t})}):j?De(e.jsxs(e.Fragment,{children:[m,e.jsx(eg,{onChangeItemInView:q,onRequestMoreCompletions:ie,onChangeRating:xe,onRequestCompletion:te,clientThreadId:t,conversationLeafId:x,hideHeader:a},t)]})):null:null})}),e.jsx(cg,{ref:Se,children:w?e.jsx(ig,{clientThreadId:t}):e.jsxs("div",{children:[!U&&e.jsx(sh,{clientThreadId:t,isNewThread:N,showPromptStarters:N||!k,currentModelId:C,onRequestCompletion:te}),!l&&e.jsx("div",{className:"relative w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",children:ws(b)&&!U&&e.jsx("div",{className:"min-h-4",children:e.jsx(Es,{clientThreadId:t})})})]})})]}),!c&&e.jsxs("div",{className:"group absolute bottom-2 end-2 z-20 flex flex-col gap-1 md:flex lg:bottom-3 lg:end-3",children:[P?e.jsxs(e.Fragment,{children:[e.jsx(ag,{}),!1]}):null,e.jsx(Cu,{})]}),Y,e.jsx(Mu,{clientThreadId:t,isStaticSharedThread:!1,isDynamicSharedThread:F}),e.jsx(Tu,{}),e.jsx(_u,{conversationId:t,currentModelId:C,isActiveWindow:!je})]})})]})})},lg=ge.div`grow flex-1 overflow-hidden @container/thread`,cg=ge.div`md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent w-full`;function dg({clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,v2HomepageDisclaimer:a}){return e.jsx(ir,{clientThreadId:t,currentModelId:s,isModelLoaded:o,onRequestCompletion:n,v2HomepageDisclaimer:a})}const ug=Oe(()=>ze(()=>import("./bdobjn3dzkcbjxyh.js"),__vite__mapDeps([46,1,2,47,3,4,12])).then(t=>t.ChatScreenContentModals));function mg({disableEmptyState:t,fullWidth:s,renderEmptyState:o}){const{clientThreadId:n,currentModelId:a,conversationLeafId:r,isCompanionWindow:l,isEmbeddedInFocusedView:c,onChangeItemInView:u,onChangeRating:m,onRequestCompletion:d,onRequestMoreCompletions:h,isModelLoaded:g,prefetchSearch:b}=i.useContext(Ja),v=kn(n,r),x=$i(n),E={clientThreadId:n,conversationLeafId:r,currentModelId:a,onChangeItemInView:u,onChangeRating:m,onRequestMoreCompletions:h,onRequestCompletion:d,showAvatar:!1},w=Qt(n),k=Ka({clientThreadId:n,currentLeafId:r,handleRequestCompletion:d,prefetchSearchPromise:b}),y=w||k||t,S=Ds(),{initialConversationTurns:T,continuedConversationTurns:P}=Eu(v,S),{canUseNewHomepage:j,showEmptyState:N}=ur({clientThreadId:n,currentLeafId:r}),M=v>=2;Bn(M);const{setTargetedContent:D}=Fn(),p=Bs(a);Ya(v,n,r),i.useEffect(()=>{c||D(void 0)},[n,D,c]);const L=$a(n,r);if(N){if(o!=null)return o();if(j&&!y){const C=l?null:e.jsx("div",{className:"text-center text-xs text-token-text-secondary",children:e.jsx(Es,{clientThreadId:n})});return e.jsx(dg,{clientThreadId:n,currentModelId:a,isModelLoaded:g,onRequestCompletion:d,v2HomepageDisclaimer:C})}else if(!j&&!y)return e.jsx(vr,{clientThreadId:n,currentModelId:a,isModelLoaded:g,onRequestCompletion:d,enableV2Homepage:!p,v2HomepageDisclaimer:e.jsx(Es,{clientThreadId:n})})}return e.jsxs(e.Fragment,{children:[S&&e.jsx(Ru,{}),S&&P.length===0&&e.jsx(Iu,{}),e.jsx(Nn,{children:e.jsxs(i.Suspense,{fallback:null,children:[e.jsx(Pu,{}),T.length>0&&e.jsx("ol",{className:Fe.conversationTurnList,children:T.map(({turnIndex:C,isFinalTurn:B})=>e.jsx("li",{className:I(Fe.conversationTurnWrapper,s&&"w-full"),children:i.createElement(bn,{...E,key:`${n}-${C}`,turnIndex:C,isFinalTurn:B,scrollToMessageId:x,shouldShowDateHeader:L(C)})},C))}),S&&e.jsx(Du,{}),e.jsx("ol",{className:Fe.conversationTurnList,children:P.map(({turnIndex:C,isFinalTurn:B})=>e.jsx("li",{className:I(Fe.conversationTurnWrapper,s&&"w-full"),children:i.createElement(bn,{...E,key:`${n}-${C}`,turnIndex:C,isFinalTurn:B,scrollToMessageId:x,shouldShowDateHeader:L(C)})},C))})]})}),e.jsx(ug,{}),v>0&&e.jsx(Lu,{})]})}function wg({renderEmptyState:t}){return e.jsx(mg,{renderEmptyState:t})}function jg(){const t=fe(),{clientThreadId:s,isLoggedInUser:o,onNewThread:n}=i.useContext(Ja),a=Te(s),r=Jt(a);return e.jsxs(Bu,{leading:!0,type:"primary",className:Fe.header,children:[e.jsxs("div",{className:Fe.headerLeading,children:[o&&e.jsx(Fu,{}),!r&&e.jsx(Kt,{label:t.formatMessage(ta.newChat),className:"hidden @lg/thread:inline-flex",children:e.jsx(Cs,{to:"/",className:Fe.newThread,onClick:l=>{n?(l.preventDefault(),n()):de.logEvent("chatgpt_web_thread_tap_new_thread")},tabIndex:0,children:e.jsx(Hu,{className:I(Fe.sidebarIcon),icon:e.jsx(La,{}),tabIndex:-1,label:t.formatMessage(ta.newChat),style:{viewTransitionName:"var(--vt_new_chat_thread)"}})})}),e.jsx("div",{className:Fe.threadDropdown,children:e.jsx(gr,{clientThreadId:s})})]}),e.jsx("div",{className:Fe.headerTrailing,children:e.jsx(Nn,{children:e.jsx(fr,{clientThreadId:s})})})]})}const ta=Ie({newChat:{id:"rnCpM4",defaultMessage:"New Chat"}});export{jg as C,Bo as G,ar as P,gr as T,sg as W,yg as a,xr as b,wg as c,sh as d,bn as e,bg as f,ur as u};
//# sourceMappingURL=ivaueezr69le5sv0.js.map
