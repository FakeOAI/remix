import{es as q,G,r as m,Z as F,m as e,aJ as O,F as V,dS as J,aS as z,eW as Q,aC as I,bw as L,d3 as X,b0 as E,fw as k,b$ as ee,c0 as se,gl as te,dM as A}from"./ntjeacke9fd34naf.js";import{v as P,bR as ae,f2 as ne,iY as M,c7 as ie,aM as re,cp as oe,iZ as C,i_ as le,i$ as ce,cd as _,j0 as de,ec as me,U as B,ev as ue,av as ge,j1 as xe,iH as fe,iI as pe,j2 as he,j3 as v,j4 as Se,j5 as h,d6 as je,j6 as be,j7 as ve,j8 as Ce,dU as ye,j9 as U,aw as D,ja as Ie,jb as ke,jc as ze,jd as y,je as Ne,dV as Me,jf as Ge,jg as Fe,jh as Te,e$ as Oe,ji as we,jj as Le}from"./e9i9vw5grjeh1b9v.js";import{av as Ee,bx as Ae,y as Pe,az as _e,L as Be,ba as Ue,M as W,aN as De,ag as We}from"./mz0bka9bte50162c.js";import{m as R}from"./d97e3rf44nmvob8j.js";import{a as Re}from"./gjf66wmugjkb0up5.js";import{U as He,P as Ke}from"./olyihqkcdlac3ovz.js";function Ze({gizmo:s,historyDisabled:r,section:a,onClick:o,isActive:l,hideOverflowMenu:f=!1}){const{clientThreadId:c}=P(),u=q(c),d=G(),[p,n]=m.useState(!1),[S,t]=m.useState(!1),[i,g]=m.useState(null),x=F(),j=!!s?.gizmo.tags?.includes(ae.FirstParty),T=!1;let Y=!1;m.useEffect(()=>{i==null&&l&&u&&g(!0)},[l,u,i]);const[$,es]=m.useState(0);let b;if(s!=null)b=s.gizmo.display.name||ne;else{if(x==null)return null;r?b=d.formatMessage(M.clearChat):x.canInteractWithGizmos()?b=ce:b=d.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(R.div,{whileTap:{scale:.98},onMouseEnter:()=>{t(!0)},onMouseLeave:()=>{t(!1)},children:e.jsx(ie,{loggingGizmoId:s?.gizmo.id??"primary",href:s!=null?re(s):"/",onClick:o,showActiveIndicator:Y,icon:e.jsx(oe,{gizmoId:s?.gizmo.id,isFirstParty:s==null||j,gizmoEmoji:s?.gizmo.display.emoji,gizmoTheme:s?.gizmo.display.theme,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6"}),isMenuOpen:p,label:b,hoverLeftIcon:S&&s&&T&&$&&e.jsx("button",{onClick:N=>{N.preventDefault(),g(!i)},className:"flex text-token-text-secondary hover:text-token-text-primary",children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:i?e.jsx(Ee,{className:"icon-md"}):e.jsx(Ae,{className:"icon-md"})})})}),rightIcon:a===C.Workspace&&e.jsx(O,{side:"right",label:d.formatMessage(w.workspaceRecommended,{workspace_name:x?.name??"Your Workspace"}),children:e.jsx(Pe,{className:"icon-md text-token-text-secondary",alt:d.formatMessage(w.workspaceRecommended,{workspace_name:x?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(S||p)&&s!=null&&!T&&!f&&e.jsx("div",{className:"text-token-text-tertiary",onClick:N=>{N.preventDefault()},children:e.jsx(le,{gizmo:s,isOpen:p,setIsOpen:n,section:a})}),!f&&e.jsx(O,{side:"right",label:d.formatMessage(r?M.clearChat:M.newChat),className:"flex items-center",children:e.jsx("button",{className:p?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:r?e.jsx(_e,{className:"icon-md"}):e.jsx(Be,{className:"icon-md"})})})]})})}),!1]})}const w=V({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}});function H(){const s=G(),r=_(),a=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(de,{children:e.jsx(R.div,{whileTap:{scale:.98},children:e.jsx(J,{to:me(),onClick:()=>{r.activeSidebar==="popover-nav"&&B.setActiveSidebar(!1)},children:e.jsx(ue,{icon:Ue,"data-testid":"explore-gpts-button",children:a})},"explore")})})}const Ye=2;function K({gizmos:s,isGizmoFlyout:r,isLoaded:a,maxToShowOnLoad:o=4,isScreenArch:l,showAllSidebarItems:f}){const c=he(s,i=>i.flair.kind),u=[...(c[v.Workspace]?.map(({resource:i})=>({gizmo:i,section:C.Workspace}))??[]).slice(0,3),...c[v.FirstParty]?.map(({resource:i})=>({gizmo:i,section:C.Keep}))??[],...c[v.SidebarKeep]?.map(({resource:i})=>({gizmo:i,section:C.Keep}))??[]],d=c[v.Recent]?.slice(0,l||a?c[v.Recent]?.length:Ye).map(({resource:i})=>({gizmo:i,section:C.Recents}))??[],p=d.length,n=u.length,S=l?p>0:s.length>o;let t=[];return r&&l?t=[...u,...d]:!r&&l?t=u:(t=[...u,...d],f||(t.length>o&&n>o?t=t.slice(0,n):t.length>o&&(t=t.slice(0,o)))),{listItems:t,itemsLeft:s.length-t.length,needsToCollapseItems:S,total:s.length}}function Z({gizmo:s,currentGizmoId:r,maxToShowOnLoad:a,hideOverflowMenu:o=!1}){const l=m.useRef(!1),f=!a,c=ge(),[u,d]=m.useState(!1),p=_(g=>!xe.isGptListCollapsed(g)),{listItems:n,needsToCollapseItems:S,itemsLeft:t}=K({gizmos:s,isGizmoFlyout:f,isLoaded:u,maxToShowOnLoad:a,isScreenArch:c,showAllSidebarItems:p});m.useEffect(()=>{u||d(!0)},[u]),m.useEffect(()=>{n.length>0&&!l.current&&(fe({namespace:pe.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),l.current=!0)},[n]);function i(g,x){const j=e.jsx(Ze,{gizmo:g,isActive:g.gizmo.id===r,section:x,hideOverflowMenu:o},g.gizmo.id);return c?e.jsx("li",{children:j}):j}return e.jsxs("div",{children:[n.map(({gizmo:g,section:x},j)=>e.jsxs(m.Fragment,{children:[j>1&&x!==n[j-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),i(g,x)]},j)),!c&&S?e.jsxs("button",{onClick:B.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(W,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:p?e.jsxs(e.Fragment,{children:[e.jsx(z,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(De,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:t}}),e.jsx(We,{className:"icon-xs"})]})})]}):null,!c&&e.jsx(H,{})]})}function $e({currentGizmoId:s,gizmos:r,onClick:a}){const{isSidebarFlyoutOpen:o,onSidebarFlyoutOpenChange:l}=Se(),f=o(h.Gizmo);return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(Q,{onOpenChange:c=>l(h.Gizmo,c),side:"right",sideOffset:4,open:f,contentAlign:"end",triggerButton:e.jsxs("button",{className:I("flex flex-1 select-none items-center gap-2 rounded-lg px-2 py-2 text-sm tracking-condensed text-token-text-secondary hover:bg-token-main-surface-secondary focus:ring-0",f&&"bg-token-main-surface-secondary"),onClick:a,children:[e.jsx(W,{className:I("icon-md mr-1 font-semibold text-token-sidebar-icon")}),e.jsx("span",{className:"text-left",children:e.jsx(z,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(L,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(Z,{gizmo:r,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function qe({currentGizmoId:s}){const{data:{gizmos:r}={}}=je();let a=r;const o=!a||a?.length===0,{needsToCollapseItems:l}=K({gizmos:a??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return o?null:e.jsx(e.Fragment,{children:e.jsxs(be,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(z,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(H,{}),e.jsx(Z,{gizmo:a??[],currentGizmoId:s,maxToShowOnLoad:ve}),l&&e.jsx(L,{children:e.jsx($e,{currentGizmoId:s,gizmos:a??[]})})]})})}function Ve({clientThreadId:s}){const r=F(),a=X(s),{isUnauthenticated:o}=E();return o?null:e.jsxs("div",{className:I(k.screenContent),children:[null,null,e.jsx(Ce,{clientThreadId:s}),r?.canInteractWithGizmos()?e.jsx(qe,{currentGizmoId:a}):null]})}function Je(){const s=F(),r=s?.data==null,{isUnauthenticated:a}=E(),{openSettings:o}=ye(),[l]=m.useState(()=>{const n=ee.getCookie(se.Workspace);return typeof n=="string"&&n!==te}),f=G(),{store:c,actions:u}=U(),d=c(n=>n.mode);if(!s||l&&r)return null;const p=a?e.jsx(He,{}):e.jsx(Re,{onClickSettings:()=>o()});return e.jsxs(D,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[p,e.jsx("div",{className:k.togglePinWrapper,children:e.jsx(Ie,{tooltipSideOffset:14,className:k.pinSidebarAction,icon:e.jsx(ke,{}),onActivate:n=>{n.preventDefault(),n.persist(),ze.togglePinSidebar(n,u,d===y.Floating?y.Pinned:y.Floating)},label:d===y.Floating?f.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):f.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:A.FloatingOrPinned})})]})}function Qe(){return e.jsx(D,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(Ke,{})})}function Xe(){return e.jsxs(Ne,{className:I(k.screenTrailingBarContainer),children:[e.jsx(Me,{}),e.jsx(Qe,{}),e.jsx(Je,{})]})}function os(){const{clientThreadId:s,onNewThread:r}=P(),[a,o]=m.useState(!1),[l,f]=m.useState(!1),[c,u]=m.useState(!1),{store:d}=U(),p=m.useCallback(t=>t===h.Conversation?a:t===h.Gizmo?l:t===h.Conversation2?c:!1,[a,l,c]),n=m.useCallback((t,i)=>{const g=x=>{t===h.Conversation?o(x):t===h.Gizmo?f(x):t===h.Conversation2&&u(x)};if(i){g(i);return}setTimeout(()=>{g(i)},100)},[]),S=m.useRef(null);return Ge((t,i)=>{n(h.Conversation,!1),n(h.Gizmo,!1),n(h.Conversation2,!1);const g=window.matchMedia("(max-width: 700px)").matches,x=Le(S.current);i!=null&&g&&d.getState().isSidebarOpen&&(d.getState().mode===y.Floating||x)&&setTimeout(()=>{document.getElementById(A.OpenOrClosed)?.click()},100)}),e.jsxs(Fe,{value:{isSidebarFlyoutOpen:p,onSidebarFlyoutOpenChange:n},children:[e.jsx(Te,{}),e.jsx(Oe,{anchor:"vertical",className:I(k.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(we,{onNewThread:r}),ref:S,trackLeading:!0,trailing:e.jsx(Xe,{}),children:e.jsx(Ve,{clientThreadId:s})})]})}export{os as C,Ze as G,Z as a};
//# sourceMappingURL=c3xzhp3iwst472pr.js.map
