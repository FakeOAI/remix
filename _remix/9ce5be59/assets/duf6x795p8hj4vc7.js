import{m as e,r as o,bV as h,bs as j,aE as p}from"./kn3psbdn34hsxlfl.js";import{g as f}from"./kqwdyvkaaavvn8k3.js";import{a as v}from"./on9085kcmzar5108.js";import{dd as g,de as N,df as b,dg as _,dh as F}from"./oq6fe2kd6rett5o3.js";function P({url:s}){const l=v(s).data??f(s,"short");return e.jsx(e.Fragment,{children:l})}function D({item:s}){const l=g(),d=N();let x=s.attributions_debug&&b(s.attributions_debug,s.attributions_debug.influence_temperature??void 0,void 0,d);const c=s.attributions_debug&&l!==s.attributions_debug.influence_temperature&&b(s.attributions_debug,l,void 0,d);return e.jsxs("div",{className:"text-left text-xs text-token-text-secondary",children:[e.jsx("div",{className:"font-bold",children:"Highlighted Segments"}),e.jsx("ul",{children:s.attribution_segments?.map((i,r)=>e.jsx("li",{children:i},r))}),c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:s.attributions_debug?.ref_id}),e.jsxs("label",{className:"font-bold",children:["Probabilities (temperature: ",l,")"]}),e.jsxs("div",{className:"grid grid-cols-[auto,auto,auto] place-items-start gap-1",children:[e.jsx("div",{children:"Segment"}),e.jsx("div",{children:"Probability"}),e.jsx("div",{children:"Influence"}),c?.map(({attribution_index:i,probability:r,influence:n})=>e.jsxs(o.Fragment,{children:[e.jsx("div",{children:i}),e.jsx("div",{children:r.toPrecision(4)}),e.jsx("div",{children:n?.toPrecision(4)})]},i))]})]}),e.jsxs("label",{className:"font-bold",children:["Probabilities (default temp"," ",s.attributions_debug?.influence_temperature,")"]}),e.jsxs("div",{className:"grid grid-cols-[auto,1fr] place-items-start gap-1",children:[e.jsx("div",{children:"Segment"}),e.jsx("div",{children:"Probability"}),x?.map(({attribution_index:i,probability:r})=>e.jsxs(o.Fragment,{children:[e.jsx("div",{children:i}),e.jsx("div",{children:r.toPrecision(4)})]},i))]}),s.attributions_debug?.timings&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-bold",children:"Timings"}),e.jsx("div",{className:"grid grid-cols-[auto,1fr] place-items-start gap-1",children:Object.entries(s.attributions_debug.timings).map(([i,r])=>e.jsxs(o.Fragment,{children:[e.jsx("div",{children:i}),e.jsxs("div",{children:[r.toFixed(0),"ms"]})]},i))})]}),e.jsx("label",{className:"font-bold",children:"Debug info"}),e.jsxs("div",{className:"grid grid-cols-[auto,1fr] place-items-start gap-1",children:[e.jsx("div",{children:"Segment start idx"}),e.jsx("div",{children:s.attributions_debug?.start_idx}),e.jsx("div",{children:"Segment end idx"}),e.jsx("div",{children:s.attributions_debug?.end_idx})]})]})}function M({attributions:s,attributionsDebug:l,children:d}){const x=_(),c=h(),i=o.useMemo(()=>s?.map((t,a)=>({...t,originalIndex:a}))?.toSorted((t,a)=>a.probability-t.probability),[s]),r=g(),n=l&&s&&l.influence_temperature!==r&&F(s,r);return!i||!x?d:e.jsx(j,{label:e.jsxs("div",{className:"text-left text-xs font-normal text-token-text-primary",children:[e.jsx("div",{className:"font-bold",children:"Attributions (Debug)"}),e.jsxs("div",{className:"grid grid-cols-[200px,1fr,1fr] gap-1",children:[e.jsx("div",{children:"Source"}),e.jsxs("div",{children:["τ=",l?.influence_temperature]}),e.jsx("div",{children:n&&`τ=${r}`}),i.map((t,a)=>{const m=t.source_type==="prior",u=m?"text-red-500":t.url?"":"text-gray-500";return e.jsxs(o.Fragment,{children:[e.jsx("div",{className:p("flex flex-col",u),children:m?e.jsx("div",{className:"line-clamp-1 font-bold",children:"Model Prior"}):t.url?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"line-clamp-1 font-bold",children:e.jsx(P,{url:t.url})}),"(",t.source_type,")"]}),e.jsx("div",{className:"line-clamp-1 text-xs",children:t.url})]}):e.jsxs("div",{className:"text-xxs line-clamp-1",children:["(",t.source_type,")"]})}),e.jsxs("div",{className:u,children:[(t.probability*100).toFixed(2),"%"]}),e.jsx("div",{className:u,children:n&&`${(n[t.originalIndex].probability*100).toFixed(2)}%`})]},a)})]})]}),theme:c?"default":"white",delayDuration:0,className:"inline",side:"left",children:d})}export{M as A,D as E,P as a};
//# sourceMappingURL=duf6x795p8hj4vc7.js.map
