import{G as l,z as o,cl as v,m as t,bm as p,bi as m,q as x,d as C}from"./ogb0m6wfmpkwr4v0.js";import{bu as M,bv as b,bw as f,bx as h}from"./m0ujq4si8sio1lz0.js";import{u as T}from"./mth7lkecabvrdtw9.js";import{q as y}from"./b9t2rzfm26s20fe0.js";import{m as O}from"./cymro46oa7nb2e4p.js";const k=e=>{for(const s of e.concat().reverse()){if("messages"in s)return s.messages[s.messages.length-1].nodeId;if("message"in s)return s.message.nodeId}},_=({clientThreadId:e,lastMessageNodeId:s})=>{const n=p(e),r=M({clientThreadId:e,conversationMode:n}),i=async()=>{b();const a=[x.CANMORE],c=new f;r({id:s,eventMetadata:{eventSource:"mouse"},systemMessage:"The user has requested the canvas tool be disabled for this conversation. You should not call the tool again.",systemMessageMetadata:{disable_tool_ids:a},turnTracker:c});const u=o.getTree(e),d=u.getConversationTurns(s).length,g=u.getParentPromptNode(s).message.id;h.logEventWithStatsig(C.canvasOptOutClicked,"chatgpt_canvas_opt_out_clicked",{num_turns:String(d),user_message_id:g}),o.setDisabledToolsForThread(e,a)};return t.jsxs(O.div,{className:"mb-2 flex flex-wrap gap-2",initial:{opacity:0},animate:{opacity:1},children:[t.jsx(m,{id:"9NFVc4",defaultMessage:"Don't want me to use canvas?"}),t.jsxs("button",{onClick:i,className:"inline-flex min-h-5 w-fit select-none items-center text-start text-token-text-secondary hover:text-token-text-primary",children:[t.jsx(m,{id:"cXTG4f",defaultMessage:"I can answer in chat instead"}),t.jsx(y,{className:"icon-md text-token-text-secondary"})]})]})},w=({clientThreadId:e,groupedMessages:s,isFinalTurn:n,hasActiveRequest:r})=>{const i=T(e),a=k(s),c=l(()=>o.getLastMessgageSystemHints(e,o.getThreadCurrentLeafId(e)).includes(v.CANVAS));return n&&!c&&!r&&!i&&a&&t.jsx(_,{clientThreadId:e,lastMessageNodeId:a})};export{w as CanvasOptOutMessage};
//# sourceMappingURL=eegpznsf8ixqrtd5.js.map
