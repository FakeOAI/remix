const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/h8933mnh4d08np9o.js","assets/ogb0m6wfmpkwr4v0.js","assets/b9t2rzfm26s20fe0.js","assets/root-jhqn5s0d.css","assets/m0ujq4si8sio1lz0.js","assets/conversation-small-lkohtmkm.css"])))=>i.map(i=>d[i]);
import{V as O,W as Z,r as A,m as e,cE as R,bi as n,bo as ee,U as W,F as B,aO as ae,cl as T,cj as ge,aJ as he,B as V,a0 as te,b8 as xe,b9 as fe,cG as se,aa as pe,bG as ie,u as L,bt as U,gg as ve,eA as Se,br as ne,ae as oe,bO as i,P as je,z as K,g7 as we,bh as ye,e9 as be}from"./ogb0m6wfmpkwr4v0.js";import{bB as Ge,_ as q,$ as f,bL as Ce,ds as F,U as x,fc as Ie,dH as ze,dI as Me,dJ as ke,fd as re,fe as Pe,ff as Te,fg as Ae,fh as Fe,fi as _e,b0 as $,cU as ce,aT as le,aP as Ee,z as Ne,fj as De,cv as Le,ch as k,fk as Ue,fl as Oe,fm as We,cu as J,fn as D}from"./m0ujq4si8sio1lz0.js";import{V as Be,L as Ve,n as qe,z as He,Q as Ke,d as $e,ao as Je,H as Qe,b3 as Xe,aq as Ye,b4 as de,m as Ze,b5 as Re,T as Q,b6 as ea,p as aa,b7 as ta,B as sa,b8 as ia}from"./b9t2rzfm26s20fe0.js";import{R as na}from"./g52w6ro568qcospb.js";import{c as oa,d as ra}from"./d25d6p0merrgbn69.js";import"./gvbypchrabr3tx6x.js";import"./cymro46oa7nb2e4p.js";function ca(a){return B({mutationFn:async({message:t,includeFrom:s})=>{await F.sendFeedbackEmail(a,t,s)}})}const la=({gizmo:a})=>{const t=Ge(),s=q(f.GPTFeedbackEmail),r=()=>x.closeModal(f.GPTFeedbackEmail),c=O(),o=Z(),[l,p]=A.useState(""),[v,d]=A.useState(!0),g=ca(a.gizmo.id),h=l.length===0;return e.jsx(R,{type:"success",title:c.formatMessage(P.title,{name:a.gizmo.display.name}),isOpen:s,onClose:r,size:"custom",showCloseButton:!0,className:"max-w-xl overflow-y-auto",hideSeparator:!0,children:e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"-mt-4 flex flex-grow flex-col space-y-4",children:[e.jsx(Ce,{className:"mb-1 w-full resize-none overflow-y-auto rounded-md bg-transparent focus:border-gray-200 focus:ring-gray-200 dark:focus:border-white dark:focus:ring-white",placeholder:`Write feedback about ${a.gizmo.display.name}...`,value:l,rows:4,onChange:m=>p(m.target.value)}),e.jsxs("div",{className:"flex flex-row items-center space-x-2 self-start",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:m=>d(m.target.checked)}),t&&e.jsx("span",{className:"text-sm",children:e.jsx(n,{...P.includeFrom,values:{email:e.jsx("strong",{children:t.email})}})})]}),e.jsx(ee,{color:"primary",disabled:h,onClick:async()=>{await g.mutateAsync({message:l,includeFrom:v}),o.success(c.formatMessage(P.successToast),{duration:3}),r()},children:e.jsx(n,{...P.send,values:{name:a.gizmo.author.display_name}})})]})})})},P=W({title:{id:"GizmoFeedbackEmailModal.title",defaultMessage:"Feedback about {name}"},send:{id:"GizmoFeedbackEmailModal.sendTo",defaultMessage:"Send To {name}"},successToast:{id:"GizmoFeedbackEmailModal.successToast",defaultMessage:"Feedback sent"},includeFrom:{id:"GizmoFeedbackEmailModal.includeFrom",defaultMessage:"Include my email address {email}"}});function da(a){const t=V();return B({mutationFn:async({actionId:s,domain:r,settings:c})=>F.upsertUserActionSettings(s,r,c),onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}function ma(a){const t=V();return B({mutationFn:async({pluginId:s})=>{await te.deletePluginUserSettings({pluginId:s})},onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}const ua=({gizmo:a})=>{const{data:t,isLoading:s}=Ie(a.gizmo.id,!0),r=q(f.GPTPrivacySettings),c=()=>x.closeModal(f.GPTPrivacySettings),o=O(),[l,p]=A.useState("actions"),v=t!=null&&t.settings.some(d=>d.oauth_status!=null&&a.tools.some(g=>g.type===T.JIT_PLUGIN&&g.metadata?.action_id===d.action_id));return l==="connected_accounts"&&!v&&p("actions"),e.jsx(R,{title:o.formatMessage(S.title),isOpen:r,onClose:c,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:s?e.jsx(ge,{}):e.jsxs(ze,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:l,onValueChange:d=>{p(d)},children:[v&&e.jsxs(Me,{className:he("flex min-w-[180px] max-w-[200px] flex-shrink-0 flex-col gap-2"),children:[e.jsx(X,{value:"actions",message:S.actions}),v&&e.jsx(X,{value:"connected_accounts",message:S.connectedAccounts})]}),e.jsxs("div",{className:"flex-1 text-sm",children:[l==="actions"&&e.jsxs(Y,{children:[e.jsx(n,{...S.allowedActionsDesc,values:{gizmoName:a.gizmo.display.name}}),t?.settings.map((d,g)=>{const h=a.tools?.find(m=>m.type===T.JIT_PLUGIN&&m.metadata?.action_id===d.action_id);return h&&e.jsx(ga,{gizmoId:a.gizmo.id,actionSettings:d,actionTool:h},g)})]}),l==="connected_accounts"&&e.jsxs(Y,{children:[e.jsx(n,{...S.connectedAccountsDesc,values:{gizmoName:a.gizmo.display.name}}),e.jsx("div",{children:t?.settings.map((d,g)=>{const h=a.tools?.find(m=>m.type===T.JIT_PLUGIN&&m.metadata?.action_id===d.action_id);return h&&d.oauth_status&&e.jsx(ha,{gizmoId:a.gizmo.id,actionSettings:d,actionTool:h},g)})})]})]})]})})};function X({value:a,message:t}){return e.jsx(ke,{className:"flex rounded-md px-2 py-1.5 text-sm text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary",value:a,children:e.jsx("div",{className:"truncate",children:e.jsx(n,{...t})})})}function ga({gizmoId:a,actionSettings:t,actionTool:s}){const r=da(a),c=t.action_settings?.all,o=l=>{s.metadata?.action_id&&s.metadata?.domain&&r.mutateAsync({actionId:s.metadata.action_id,domain:s.metadata.domain,settings:{all:l}})};return e.jsx("div",{children:e.jsxs(me,{className:"border-b border-black/10 dark:border-white/10",children:[e.jsxs("div",{className:"flex flex-row space-x-4",children:[e.jsx("div",{className:"font-semibold",children:s.metadata?.domain}),e.jsxs("a",{href:s.metadata?.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"flex items-center gap-1 text-token-text-tertiary hover:cursor-pointer hover:text-token-text-secondary",children:[e.jsx(n,{...S.privacyPolicyLink}),e.jsx(Be,{className:"icon-md"})]})]}),e.jsxs("select",{value:c?"always_allow":"unset",onChange:l=>o(l.target.value),className:"rounded border-none bg-token-main-surface-primary text-sm",children:[e.jsx("option",{value:"always_allow",children:e.jsx(n,{...S.alwaysAllowDropdown})}),e.jsx("option",{value:"unset",children:e.jsx(n,{...S.askDropdown})})]})]})})}function ha({gizmoId:a,actionSettings:t,actionTool:s}){const r=ma(a),c=t.oauth_status==="valid";return e.jsxs(me,{children:[e.jsx("div",{className:"font-semibold",children:s?.metadata?.domain}),e.jsx(ee,{color:"secondary",size:"small",onClick:()=>{s.metadata?.action_id&&s.metadata?.domain&&(c?r.mutateAsync({pluginId:s.metadata?.action_id}):F.doOAuthRedirect(a,s.metadata?.action_id,s.metadata?.domain,window.location.href))},children:e.jsx(n,{...c?S.logout:S.login})})]})}const Y=ae.div`flex flex-col gap-6`,me=ae.div`flex flex-row justify-between py-3 items-center`,S=W({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}}),xa=xe(()=>fe(()=>import("./h8933mnh4d08np9o.js"),__vite__mapDeps([0,1,2,3,4,5])).then(a=>a.GizmoKeepInSidebarMenuItem));function za({children:a,clientThreadId:t,gizmoResource:s,showReportModal:r,inMobileHeader:c}){return e.jsxs(e.Fragment,{children:[e.jsx(se,{contentAlign:c?"center":"start",size:"small",triggerButton:a,children:e.jsx(pa,{clientThreadId:t,gizmoResource:s,showReportModal:r})}),e.jsx(fa,{gizmoResource:s})]})}function fa({gizmoResource:a}){const t=q(f.GPTRemoveThirdParty),s=pe(),r=re(a);return e.jsxs(e.Fragment,{children:[e.jsx(oa,{gizmoId:a.gizmo.id,creatorId:a.gizmo.author.user_id}),e.jsx(ua,{gizmo:a}),r&&e.jsx(la,{gizmo:a}),r&&e.jsx(Pe,{gizmo:a}),e.jsx(na,{gpt:a,isOpen:t,onClose:()=>x.closeModal(f.GPTRemoveThirdParty),account:s})]})}function pa({clientThreadId:a,gizmoResource:t,showReportModal:s}){const r=Te(t),c=Ae(t),o=Fe(t.gizmo.id),l=ie(),p=_e(t),v=t.gizmo.share_recipient===$.Marketplace||t.gizmo.share_recipient===$.Link,d=!p&&v,g=L("1825130190").value,h=L("3645668434").value,m=g&&!p&&re(t),_=l?.includes(U.GizmoSupportEmails)&&!p&&t.gizmo.author.will_receive_support_emails&&m,E=ve(),I=Se(a),z=ce(U.WorkspaceShareLinks),{isUnauthenticated:C}=ne(),b=I&&z&&!C,j=oe();return e.jsxs(e.Fragment,{children:[e.jsx(i.Item,{onClick:()=>{je.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:t.gizmo.id}),le(j,`/g/${t.gizmo.short_url}`)},icon:Ve,children:e.jsx(n,{...u.newChat})}),e.jsx(i.Item,{onClick:()=>x.openModal(f.GPTDetails),icon:qe,children:e.jsx(n,{...u.about})}),t.tools?.find(w=>w.type===T.JIT_PLUGIN)&&e.jsx(i.Item,{onClick:()=>x.openModal(f.GPTPrivacySettings),icon:He,children:e.jsx(n,{...u.privacySettings})}),r&&e.jsx(i.Item,{onClick:()=>{j(o)},icon:Ke,children:e.jsx(n,{...u.customize})}),!r&&c&&h&&e.jsxs(e.Fragment,{children:[e.jsx(i.Item,{onClick:async()=>{j(`/g/${t.gizmo.id}/view`)},icon:$e,children:e.jsx(n,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),e.jsx(i.Item,{onClick:async()=>{const w=await F.copyGizmo({gizmoId:t.gizmo.id});w.gizmo.id&&j(`/gpts/editor/${w.gizmo.id}`)},icon:Je,children:e.jsx(n,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),e.jsx(xa,{gizmoResource:t}),e.jsx(ra,{gizmoResource:t}),_&&e.jsx(i.Item,{onClick:()=>x.openModal(f.GPTFeedbackEmail),icon:Qe,children:e.jsx(n,{...u.feedbackEmail})}),m&&e.jsx(i.Item,{onClick:()=>x.openModal(f.GPTReview),icon:Xe,children:e.jsx(n,{...u.reviewGPT})}),d&&e.jsx(i.Item,{onClick:s,icon:Ye,children:e.jsx(n,{...u.report})}),b&&e.jsx(i.Item,{onClick:()=>x.openSharingModal(I),icon:de,children:e.jsx(n,{...u.shareChat})}),E&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{color:"danger",onClick:()=>x.openModal(f.GPTRemoveThirdParty),icon:Ze,children:e.jsx(n,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),l?.includes("debug")&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{onClick:()=>{j(Ee(t))},children:"(Internal) See share page"})]})]})}const va=({conversation:a,inMainScreen:t=!1})=>{const s=a.id,c=ie()?.includes("debug"),o=K.getServerThreadId(s),l=ce(U.WorkspaceShareLinks),{isUnauthenticated:p}=ne(),v=l&&o&&!p,d=we.useStore(),{value:g}=L("3653083604"),{value:h}=ye("2851018874"),m=g||h&&window.documentPictureInPicture,_=be(s),E=oe(),I=Ne(),z=Z(),C=O(),b=V(),j=a.gizmo_id,w=De(j);let G=null;const{snorlaxes:ue}=Le();G=ue;let H=null;w&&G&&(H=G.find(({gizmo:y})=>y.gizmo.id===j)?.gizmo);const N=A.useCallback(async(y,M)=>{try{await te.updateConversationGizmo(y,M)}catch{z.danger(C.formatMessage(k.moveConversationToSnorlaxError))}Ue(b),Oe(b),K.setGizmoId(y,M),M&&b.invalidateQueries({queryKey:We(b,M,!1).queryKey})},[b,z,C]);return e.jsxs(e.Fragment,{children:[v&&e.jsx(i.Item,{onClick:()=>x.openSharingModal(o,"History Item Menu"),icon:de,"data-testid":"share-chat-menu-item",children:e.jsx(n,{...u.shareChat})}),m&&e.jsx(i.Item,{onClick:()=>{d.setThreadId(s,!0),_&&le(E)},icon:Re,children:e.jsx(n,{...u.openInCompanionWindow})}),I&&G&&G?.length>0&&o&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),w&&e.jsxs(e.Fragment,{children:[G.length>1&&e.jsxs(i.Sub,{children:[e.jsx(i.SubMenuTrigger,{icon:Q,children:e.jsx(n,{...k.moveConversationToSnorlax})}),e.jsx(i.Portal,{children:e.jsx(i.SubContent,{children:e.jsx(J,{inSidebar:!1,onUpdateConversationGizmo:y=>{N(o,y)},currentGizmoId:j})})})]}),e.jsx(i.Item,{onClick:()=>{N(o,null)},icon:ea,children:e.jsx("div",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:e.jsx(n,{...k.removeConversationFromSnorlax,values:{projectName:H?.gizmo.display.name??"project"}})})})]}),!w&&e.jsxs(i.Sub,{children:[e.jsx(i.SubMenuTrigger,{icon:Q,children:C.formatMessage(k.addConversationToSnorlax)}),e.jsx(i.Portal,{children:e.jsx(i.SubContent,{children:e.jsx(J,{inSidebar:!1,onUpdateConversationGizmo:y=>N(o,y)})})})]}),e.jsx(i.Separator,{})]}),e.jsx(i.Item,{disabled:!o,onClick:()=>{setTimeout(()=>{o&&D.publish({kind:t?"editTitleInMainScreen":"editTitle",serverThreadId:o})},100)},icon:aa,children:e.jsx(n,{...u.renameChat})}),e.jsx(i.Item,{disabled:!o,onClick:()=>{o&&D.publish({kind:"archiveChat",serverThreadId:o})},icon:ta,children:e.jsx(n,{...u.archiveChat})}),e.jsx(i.Item,{color:"danger",disabled:!o,onClick:()=>{o&&D.publish({kind:"deleteChat",serverThreadId:o})},icon:sa,"data-testid":"delete-chat-menu-item",children:e.jsx(n,{...u.deleteChat})}),c&&e.jsxs(e.Fragment,{children:[e.jsx(i.Separator,{}),e.jsx(i.Item,{onClick:()=>x.toggleActiveSidebar("debug"),icon:ia,children:e.jsx(n,{...u.debugChat})})]})]})},Ma=({conversation:a,children:t,onOpenChange:s,inMainScreen:r=!1})=>e.jsx(se,{onOpenChange:s,side:"bottom",contentAlign:"start",triggerButton:t,size:"auto",children:e.jsx(va,{conversation:a,inMainScreen:r})}),u=W({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},openInCompanionWindow:{defaultMessage:"Open in companion window",id:"GizmoInformation.openInCompanionWindow1"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}});export{Ma as GizmoConversationOptionsDropdown,za as GizmoInformationDropdown,pa as GizmoInformationDropdownItems};
//# sourceMappingURL=mjzwjf2blunmnuo0.js.map
