const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/hgbn5h3l9xp07n6a.js","assets/ogb0m6wfmpkwr4v0.js","assets/b9t2rzfm26s20fe0.js","assets/root-jhqn5s0d.css","assets/m0ujq4si8sio1lz0.js","assets/conversation-small-lkohtmkm.css","assets/uksy3v3qlnetpsqm.js","assets/kcpzm2dkvh9cepg8.js","assets/nath3ahjullxvkj2.js","assets/cymro46oa7nb2e4p.js","assets/k16m2blxis1lpu5v.js","assets/gvbypchrabr3tx6x.js","assets/d1lfm62m2dkdm23l.js","assets/cof65v04mq70bnz9.js","assets/1mq4bl028ayzaqnn.js","assets/ltznf2htv1wfodfi.js","assets/lqsr6h2q3b39sv0s.js","assets/hv14zmctf4zc11c3.js","assets/cha66w63sa0wggto.js","assets/g2i7v17gpghzc1gh.js","assets/c4bxzbp1808foto4.js","assets/npcv6h3z914inh9s.js","assets/bw3tfuc2a2wfbcma.js","assets/hunslofye2gde7y3.js","assets/fjtqvuwt5aqn5yh5.js","assets/dbnmdjnv5aff71w4.js","assets/gt3bg9icktft9kyz.js","assets/mdqkewg741qbnpzv.js","assets/b7aghlqazxw23bun.js","assets/n8ha3nors449nj4p.js","assets/d25d6p0merrgbn69.js","assets/g0zqo4hge54mtcge.js","assets/dcgn0igpgzt1fhca.js","assets/f0uslfhqo9gxaicg.js","assets/g5l6bv0jupdyz5on.js","assets/hl0q2jenep9o3bit.js","assets/dn4wahbewcmhdzq3.js","assets/grtnmyfpagnrl09d.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/mmu1mgyeh9mpscy4.js","assets/g25th3hpr1nav7tx.js","assets/hnqxft4u5zrx5v2z.js","assets/g04e24001bc4ci45.js","assets/nix9ztxp0gekqab0.js","assets/km6xsvm2fb17lr21.js"])))=>i.map(i=>d[i]);
import{r as l,aO as be,hK as Kr,m as t,P as J,d as Z,bi as F,bI as pa,aH as Hs,aI as ut,hL as ao,cW as fa,c as Yr,j as Xr,df as Oe,bL as dn,V as ze,U as Ue,e1 as mn,br as Ve,aF as Ze,dl as _t,z as Q,o as He,bw as Qr,aJ as I,ch as oo,c6 as ro,e6 as Je,aQ as es,bo as Pt,b8 as Ge,b9 as We,an as En,ba as ts,eA as ss,aj as io,bn as xa,gs as Zr,gq as Jr,cD as ei,aa as Os,W as lo,af as ti,ae as si,bG as co,aB as ns,ep as ni,gp as Nn,hM as ai,ay as dt,eK as oi,bt as ks,cP as ri,cQ as ii,cR as li,bv as ci,c5 as Xe,bs as ui,hN as di,u as Rn,am as kt,hO as mi,$ as he,D as hn,gD as uo,az as mo,e0 as ho,fr as hi,a7 as gi,ak as va,B as go,hP as pi,hQ as fi,dS as zs,gg as xi,hR as po,bm as Us,fY as vi,gf as Gs,bh as Qe,aC as An,gO as Pn,G as In,ai as Ye,bk as Sa,aE as qt,a0 as Et,v as Si,n as Tt,dd as bi,al as yi,a9 as fo,bO as Re,fe as xo,a3 as wi,hS as ji,fm as Ti,bM as Mi,hT as ba,d_ as gn,ea as Ci,l as $e,c$ as _i,d$ as As,bB as ys,M as vo,aG as ki,hU as Ei,eY as Ni,aN as Ri,cM as Ai,hV as Pi,bb as Ii,hW as Di,hX as So,h2 as Ws,N as Dn,fg as bo,hY as Bi,hZ as Fi,d7 as Li,f2 as Hi,h_ as Oi,fu as Ne,e7 as zi}from"./ogb0m6wfmpkwr4v0.js";import{fb as Vs,l3 as Ui,aY as as,fd as Gi,l4 as Wi,l5 as Vi,b1 as Nt,l6 as qi,jo as yo,jr as wo,eo as $i,B as Ki,da as Yi,jn as Xi,l7 as ye,l8 as Rt,l9 as Qi,la as Zi,lb as Ji,lc as el,ld as tl,le as sl,lf as nl,lg as al,lh as ol,li as se,lj as jo,lk as To,d0 as rl,cW as il,ll,lm as cl,ln as Mo,kp as ul,gm as dl,lo as ml,lp as Co,lq as hl,lr as _o,ls as gl,lt as ko,lu as pl,a0 as fl,cJ as At,lv as Eo,lw as No,cF as qs,bw as Kt,lx as Ps,ly as Fe,lz as Ro,lA as xl,lB as vl,lC as Is,lD as Sl,lE as bl,lF as yl,lG as wl,eq as jl,lH as Tl,lI as Ml,lJ as Cl,lK as _l,lL as Bn,f9 as Fn,lM as kl,fO as Ln,fP as mt,fU as Hn,bZ as El,lN as Ao,i4 as Po,lO as Io,lP as Nl,lQ as Ds,bB as On,bD as Do,dx as Rl,d8 as Al,dy as Bo,K as Fo,bF as zn,fj as Un,lR as ya,lS as Pl,lT as Il,bK as wa,bH as Dl,iG as Bl,jU as ja,lU as Fl,lV as Ll,lW as Hl,lX as Gn,lY as Ol,lZ as zl,bO as Lo,f_ as Wn,iu as Vn,l_ as Ta,gG as Ul,bG as Gl,l$ as Wl,ga as Vl,j_ as ql,gb as $l,gc as Kl,m0 as Yl,bI as pn,m1 as Ho,m2 as Xl,m3 as Ql,m4 as Zl,cr as Jl,ch as ec,m5 as tc,fo as qn,U as Bs,c0 as $n,cM as sc,m6 as nc,m7 as ac,m8 as oc,m9 as rc,ma as ic,mb as lc,mc as cc,cE as Oo,md as uc,me as dc,du as mc,gd as hc,mf as gc,mg as pc,k_ as fc,cy as xc,mh as vc,mi as Sc,fa as bc,mj as yc,mk as wc,ml as fn,mm as jc,mn as Tc,cH as xn,mo as Mc,mp as Cc,mq as _c,mr as zo,iS as Kn,cK as Yt,ms as kc,mt as Ec,mu as Nc,v as Rc,mv as vn,i as Uo,mw as Ma,b5 as Ac,mx as Pc,my as Ic,cD as Dc,mz as Bc,mA as Fc,cU as Lc,mB as Hc,f4 as Oc,p as zc,mC as Uc,o as Go,mD as Gc,f1 as Wc,mE as Vc,mF as qc,X as $c,mG as Kc,mH as Wo,mI as Vo,mJ as qo,mK as Mt,mL as Yc,mM as Xc,mN as Qc,k0 as Zc,mO as $o,mP as Jc,g1 as Fs,mQ as Sn,mR as eu,mS as tu,mT as su,mU as nu,mV as Ca,mW as ws,c4 as _a,cd as Ko,ce as Yo,fW as au,mX as ou,gn as ru,cG as Yn,mY as iu,mZ as lu,bu as cu,m_ as uu,m$ as du,bA as mu,dt as hu,g0 as gu,c5 as pu,n0 as fu,fX as js,n1 as xu,n2 as vu,n3 as Su,n4 as bu,n5 as yu,n6 as wu,n7 as ju,n8 as Tu,n9 as Mu,na as Cu,bM as _u,km as ku,kl as Eu,nb as Nu,bE as Ru,gs as Au,nc as Pu,nd as Iu,ne as Xo,$ as Du,kZ as Bu,nf as Es,ng as Fu,nh as Qo,bP as Lu,ni as Zo,nj as Hu,nk as Ou,nl as zu,Q as Uu,R as Gu,P as Wu,V as Vu,nm as qu,nn as Xt,f6 as $u,c1 as Ku,c2 as Yu,no as Xu,np as Qu,fl as Zu,nq as Xn,nr as Ju,J as ed,ns as td,nt as sd,nu as nd,nv as ad,nw as od,W as rd,jL as id,aS as bn,nx as ld,f2 as cd,c3 as ud}from"./m0ujq4si8sio1lz0.js";import{bX as dd,o as Jo,bB as md,bA as er,bY as Qn,an as hd,G as gd,as as pd,bZ as fd,b_ as tr,aE as Zn,O as xd,bp as sr,br as nr,m as vd,bo as Sd,bq as bd,b4 as yd,z as wd,bu as jd,I as Td,bJ as Md,L as Cd}from"./b9t2rzfm26s20fe0.js";import{B as _d}from"./nath3ahjullxvkj2.js";import{m as ne}from"./cymro46oa7nb2e4p.js";import{j as ht,P as It,h as kd,D as Ed,T as yn,M as Nd,k as Rd,E as Ad,m as Pd,C as wn,n as Id}from"./k16m2blxis1lpu5v.js";import{S as ar,a as Dd,b as Bd,G as Fd,L as Ld,c as Hd}from"./gvbypchrabr3tx6x.js";import{p as Od,k as jn,c as ka,g as zd,i as Ud,n as Gd}from"./d1lfm62m2dkdm23l.js";import{d as Wd}from"./cof65v04mq70bnz9.js";import{C as Vd,f as qd}from"./1mq4bl028ayzaqnn.js";const or=new ht("transactionEventPlugin"),Tn="prosemirrorDispatchTransaction";function Ea(e,s){const{eventTarget:n}=or.getState(e.state);return n.addEventListener(Tn,s),()=>{n.removeEventListener(Tn,s)}}function $d(e){return new It({key:or,state:{init(){return{eventTarget:e}},apply(s,n){return n}}})}const Ns=new ht("customKeymapPlugin");function Kd(e,s){e.dispatch(e.state.tr.setMeta(Ns,{handlers:s}))}function Yd(e={handlers:{}}){return new It({key:Ns,state:{init(){return{...e}},apply(s,n){const a=s.getMeta(Ns);return a?{...n,...a}:n}},props:{handleKeyDown(s,n){const o=Ns.getState(s.state).handlers[n.key];return o?o(n):!1}}})}const lt=new ht("menuSelectorPlugin");function Ct(e){e.dispatch(e.state.tr.setMeta(lt,{active:!1,onMenuAction:void 0}))}function Xd(e,s){e.dispatch(e.state.tr.setMeta(lt,{active:!0,onMenuAction:s}))}function Qd(e={submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[]}){return new It({key:lt,state:{init(){return{...e,active:!1}},apply(s,n){const a=s.getMeta(lt);return a?{...n,...a}:n}},props:{handleKeyDown(s,n){const a=lt.getState(s.state);return a.active?a.submitKeys.includes(n.key)?(n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),a.onMenuAction?.("submit"),Ct(s),!0):a.cancelKeys.includes(n.key)?(n.preventDefault(),a.onMenuAction?.("cancel"),Ct(s),!0):n.key==="ArrowUp"?(n.preventDefault(),a.onMenuAction?.("up"),!0):n.key==="ArrowDown"?(n.preventDefault(),a.onMenuAction?.("down"),!0):(a.checkStrictMatchKeys.includes(n.key)&&a.onMenuAction?.("checkMatch"),!1):!1},handleDOMEvents:{blur:s=>{lt.getState(s.state).onMenuAction?.("cancel")}}}})}const Vt=new ht("placeholderPlugin");function Zd(e){return new It({key:Vt,state:{init(){return{placeholder:e}},apply(s,n){return s.getMeta(Vt)?{placeholder:s.getMeta(Vt).placeholder}:n}},props:{decorations(s){const{doc:n}=s;if(n.childCount===1&&n.firstChild?.isTextblock&&n.firstChild.content.size===0){const o=[],{placeholder:r}=Vt.getState(s);return s.doc.descendants((i,c)=>{const u=kd.node(c,c+i.nodeSize,{class:"placeholder","data-placeholder":r});o.push(u)}),Ed.create(n,o)}}}})}const Qt="command_token",Jd={group:"inline",inline:!0,atom:!0,content:"text*",attrs:{id:"",hint:""},selectable:!1,draggable:!1,toDOM:e=>["span",{"data-mention-id":e.attrs.id,"data-mention-hint":e.attrs.hint,class:"hint-pill"},e.attrs.hint],parseDOM:[{tag:"span[data-mention-id][data-mention-hint]",getAttrs:e=>{const s=e.getAttribute("data-mention-id"),n=e.getAttribute("data-mention-hint");return{id:s,hint:n}}}]};function rr(e,s){if(e.depth===0)return;const n=e.nodeBefore?.text?.match(/(?:^|\s)(\/(\w*))$/);if(n?.[1].length!==void 0){const a=e.pos-n[1].length,o=e.pos,r=a===s?.from;return{range:{from:a,to:o},queryText:n[2],isDismissed:r}}}const Ls=new ht("slashCommandPlugin");function $s(e,s){return e.setMeta(Ls,s),e}function em(e){const n=e.state.selection.$from,a=rr(n,void 0);e.dispatch($s(e.state.tr,{...Zt(),dismissedRange:a?.range}))}function Zt(){return{queryText:"",active:!1,range:void 0,dismissedRange:void 0}}function tm(e,s,n={from:1,to:1},a,o,r){const i=e.state.tr;if($s(i,Zt()),s.id===Vs.Search&&o)i.delete(n.from,n.to),r(!0);else{const c=s.hint+(a?" ":""),u=e.state.schema.nodes[Qt].create({id:s.id,hint:c},e.state.schema.text(c));i.replaceWith(n.from,n.to,u),i.doc.descendants((m,d)=>{m.type.name===Qt&&m!==u&&(n.from===1&&d===n.from+u.nodeSize||d===1&&n.from===d+m.nodeSize?i.delete(d,d+m.nodeSize):i.insertText(m.textContent,d,d+m.nodeSize))})}e.dispatch(i)}function Na(e){const{active:s,range:n,queryText:a,onHintMatch:o}=e;if(o)return o(s?{text:a,range:n}:void 0)}function sm(e){const s=[];return e.descendants(n=>{n.type.name===Qt&&typeof n.attrs?.id=="string"&&s.push(n.attrs.id)}),s}function nm(e){const s=e.state.tr;s.doc.descendants((n,a)=>{n.type.name===Qt&&s.insertText(n.textContent,a,a+n.nodeSize)}),s.steps.length>0&&e.dispatch(s)}function am(e){const{active:s,queryText:n}=Ls.getState(e.state);e.dispatch($s(e.state.tr,{...Zt(),active:!s||n!==""}))}function om(){return new It({key:Ls,state:{init(){return Zt()},apply(e,s,n,a){const o=e.getMeta(Ls),r={...Zt(),...s,...o},i=e.selection;if(i.from!==i.to||a.doc.eq(n.doc))return Na(r),r;const c=i.$from,u=rr(c,s.dismissedRange);return r.active=!!u&&!u.isDismissed,u&&(r.queryText=u.queryText,r.range=u.range,u.isDismissed&&(u.queryText===""&&s.queryText!==""?r.dismissedRange=void 0:r.dismissedRange=u.range)),Na(r),r}}})}class os extends Ui{constructor(s){super(),this.view=s}get document(){return this.view.dom.ownerDocument}isEmpty(){return this.view.state.doc.textContent.trim().length===0}trimLeadingText(s){const a=this.view.state.tr;let o=!1,r=!1;return a.doc.descendants((i,c)=>{o||!i.isText||(o=!0,i.text?.startsWith(s)&&(r=!0,a.insertText(i.text.replace(s,""),c,c+i.text.length)))}),r&&this.view.dispatch(a),r}replaceAll(s,n){const o=this.view.state.tr,r=[];o.doc.descendants((i,c)=>{!i.isText||i.text===void 0||r.push({node:i,pos:c})}),r.reverse(),r.forEach(({node:i,pos:c})=>{!i.isText||i.text===void 0||i.text.includes(s)&&o.insertText(i.text.replaceAll(s,n),c,c+i.text.length)}),this.view.dispatch(o)}appendText(s){this.view.dispatch(this.view.state.tr.insertText(s))}focus(){this.view.focus(),this.view.dispatch(this.view.state.tr.setSelection(yn.atEnd(this.view.state.doc)).scrollIntoView())}setText(s){const{tr:n,schema:a}=this.view.state,o=s?a.nodes.paragraph.create(null,a.text(s)):a.nodes.paragraph.create();this.view.dispatch(n.replaceWith(0,this.view.state.doc.content.size,o)),this.view.hasFocus()&&this.view.dispatch(this.view.state.tr.setSelection(yn.atEnd(this.view.state.doc)))}getCurrentText(){return this.view.state.doc.textContent}hasMultipleLines(){let s=0;return this.view.state.doc.descendants(n=>{n.isBlock&&s++}),s>1}getContentToSend(){return Od(this.view)}resize(){}isReady(){return!!this.view.state.doc}setPlaceholder(s){this.view.dispatch(this.view.state.tr.setMeta(Vt,{placeholder:s}))}getSelectionStart(){return this.view.state.selection.ranges[0].$from.pos}isMenuSelectorActive(){return lt.getState(this.view.state).active}registerKeyHandlers(s){Kd(this.view,s)}acceptLegacyKeydown(){return!1}subscribe(s,n){if(s==="change"){const a=()=>n(void 0);return Ea(this.view,a)}return this.view.dom?.addEventListener(s,n,{capture:!0}),()=>{this.view.dom?.removeEventListener(s,n,{capture:!0})}}useState(s){return l.useSyncExternalStore(n=>Ea(this.view,n),()=>s(this),()=>s(this))}getSystemHintsFromDoc(){return sm(this.view.state.tr.doc)}getSystemHints(){const s=this.getSystemHintsFromDoc();return s.length?[s[0]]:[]}replaceSlashCommandTokensWithText(){nm(this.view)}canShowAutocompletion(){return!this.isMenuSelectorActive()&&!this.getSystemHintsFromDoc().length}}const Ra=be.div`m-8 flex flex-col items-center`;function Aa(e){return t.jsx(ne.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...e})}function rm({clientThreadId:e}){const n=Kr(e)?.gizmoId,{data:a}=as(n);return n==null||a==null||!Gi(a)?null:t.jsx(im,{gizmoId:n})}function im({gizmoId:e}){const[s,n]=l.useState(!1),[a,o]=l.useState(!1),r=Wi(e),i=async u=>{n(!0),setTimeout(()=>{o(!0)},5e3),J.logEvent(Z.submitInlineRating,{gizmo_id:e,rating:u}),await r.mutateAsync({rating:u})},c=async()=>{o(!0),J.logEvent(Z.dismissInlineRating,{gizmo_id:e}),await r.mutateAsync({})};return l.useEffect(()=>{a||J.logEvent(Z.showInlineRating,{gizmo_id:e})},[a,e]),a?null:s?t.jsx(Ra,{children:t.jsxs(Aa,{className:"flex flex-col items-center gap-4",children:[t.jsx("div",{className:"rounded-lg border border-token-border-heavy p-4",children:t.jsxs("div",{className:"flex justify-between gap-2",children:[t.jsx(F,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),t.jsx(pa,{onClick:()=>{o(!0)}})]})}),t.jsx("div",{className:"text-xs text-token-text-tertiary",children:t.jsx(F,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):t.jsx(Ra,{children:t.jsxs(Aa,{className:"flex flex-col items-center gap-4 rounded-lg border border-token-border-heavy p-4",children:[t.jsxs("div",{className:"flex justify-between gap-2",children:[t.jsx(F,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),t.jsx(pa,{onClick:c})]}),t.jsx(Vi,{rating:void 0,onRating:i})]})})}const lm=({clientThreadId:e})=>{const s=ao(),n=Hs(e),a=ut(n);l.useEffect(()=>{a&&fa.dismissBanner()},[a]);const o=s?.is_dismissible?()=>fa.dismissBanner():void 0;return t.jsx(Nt,{children:s&&t.jsx(ne.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:t.jsx(qi,{clientThreadId:e,rateLimitInfo:s,onDismiss:o})})})};function cm(e){const s=Hs(e),n=ut(s),a=ao();return!n&&a!=null}const Mn=window.sessionStorage,Cn=Yr(Xr(()=>({memoryFullBannerDismissed:!!Mn?.getItem(dn.MemoryFullBannerDismissed)}))),ir={dismissBanner(){Cn.setState(e=>{e.memoryFullBannerDismissed=!0}),Mn?.setItem(dn.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){Cn.setState(e=>{e.memoryFullBannerDismissed=!1}),Mn?.removeItem(dn.MemoryFullBannerDismissed)}};function um(e){const s=Oe(e),n=yo(),{data:a}=wo(s,!1,n),o=a!=null,r=o&&a.memoryFullPct>=100,[i,c]=l.useState(!1);l.useEffect(()=>{!r&&o&&(c(!0),ir.clearDismissedBanner())},[r,o]);const u=Cn(m=>m.memoryFullBannerDismissed);return r&&i&&!u}function dm(){const e=ze(),{openSettings:s}=$i();return t.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},children:t.jsx(Ki,{title:e.formatMessage(Ts.memoryFullTitle),content:e.formatMessage(Ts.memoryFullTooltip,Ts.memoryFullTooltip.values),primaryCtaText:e.formatMessage(Ts.memoryManageButton),onPrimaryCtaClick:()=>s(Yi.Personalization),onDismiss:()=>ir.dismissBanner()})})}const Ts=Ue({memoryFullTitle:{id:"yRGU2/",defaultMessage:"Memory is full."},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"neUc+N",defaultMessage:"New memories won’t be created until you make space. <a>Learn more</a>",values:{a:e=>t.jsx("a",{href:Xi,target:"_blank",rel:"noopener noreferrer",className:"underline",children:e})}}}),mm=l.memo(function(s){return hm(s),gm(s),pm(),null});function hm(e){const{store:s}=ye(),n=s.useSetSharedProps();mn(()=>{n(e)},[e,n])}function gm(e){const{clientThreadId:s,canContinue:n}=e,{store:a}=ye(),o=l.useRef({top:a.useContentAreaApi(Rt.HeaderTop),bottom:a.useContentAreaApi(Rt.HeaderBottom)}).current,r=vm(e),i=Qi(s),{shouldShowBannerSignup:c,shouldShowBannerTermsDisclaimer:u}=Sm(s),m=cm(s),d=Zi(e),h=Ji(e),p=el(e),f=um(s),x=tl(),g=sl(e);mn(()=>{g.eligible?o.top.set(se.AdvancedVoiceOnMobileAnnouncement):x?o.top.set(se.ParagenControls):u?o.top.set(se.BannerTermsDisclaimer):m?o.top.set(se.BannersRateLimit):d.eligible?o.top.set(se.BannerSidekickAnnouncement):h?o.top.set(se.SearchBrowserExtensionAnnouncement):p?o.top.set(se.SearchBrowserExtensionReactiveAnnouncement):r?o.top.set(se.ItemActions):n?o.top.set(se.PromptTextareaAction):c?o.top.set(se.BannerSignup):f?o.top.set(se.BannerMemoryFull):o.top.set(null)},[o,r,n,u,c,m,d,f,x,g]),mn(()=>{i&&o.bottom.set(jo.DallePromptControls)},[o,i])}function pm(){const{store:e}=ye();l.useEffect(()=>()=>{e.reset()},[e])}function fm(e){const s=To(),n=Ze(e),a=Q.getTree(e).getLastValidNode(n)?.message?.id;return s?.messageId===a?s.suggestions:[]}function xm(e){return fm(e).length>0}function vm(e){const s=nl(e.clientThreadId),n=xm(e.clientThreadId);return e.isDisabled?!1:e.isNewThread||s||n}function Sm(e){const{isUnauthenticated:s}=Ve(),n=Ze(e),{layer:a}=_t("3637408529"),o=a.get("should_show_no_auth_signup_banner",!0),r=al(p=>p.bannerDisclaimerClientThreadId),i=ol(),c={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1};if(!e)return c;const u=Q.getTree(e),m=u.countMessagesByAuthor(He.User),d=u.getNodeByIdOrMessageId(n),h=d?.message?.author.role===He.Assistant&&Qr(d.message);return c.shouldShowBannerTermsDisclaimer=h&&s&&m===1&&!i&&(r==null||r===e),c.shouldShowBannerSignup=o&&h&&s&&m>0&&m%5===0,c}function bm({children:e,className:s,showBackground:n}){return t.jsxs("div",{className:"relative",children:[e,n&&t.jsx(ne.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:I("pointer-events-none absolute bottom-0 top-0 h-8 w-8 rounded-full",s)})]})}function ym({clientThreadId:e,uploadType:s,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,getInputProps:r,openFileDialog:i,onOauthRedirect:c,historyDisabled:u,isDisabled:m,highlightTooltip:d}){const h=rl(),{gdriveStatus:p,o365Status:f}=il(),x=t.jsx(dd,{className:u?"text-white":d?"text-brand-blue-800":void 0}),g=p!=="false"||f!=="false"||h;return t.jsx("div",{className:"relative",children:t.jsx(bm,{showBackground:d,className:"bg-brand-blue-800/20",children:g?t.jsx(ll,{clientThreadId:e,icon:x,modelAcceptedMimeTypes:n,modelSupportedImageMimeTypes:a,attachmentsProductFeature:o,onOauthRedirect:c,uploadType:s,openFileDialog:i,getInputProps:r,isDisabled:m,highlightTooltip:d}):t.jsx(cl,{clientThreadId:e,uploadType:s,openFileDialog:i,getInputProps:r,icon:x,isDisabled:m,highlightTooltip:d})})})}const wm=500;class Ie{constructor(s,n){this.items=s,this.eventCount=n}popEvent(s,n){if(this.eventCount==0)return null;let a=this.items.length;for(;;a--)if(this.items.get(a-1).selection){--a;break}let o,r;n&&(o=this.remapping(a,this.items.length),r=o.maps.length);let i=s.tr,c,u,m=[],d=[];return this.items.forEach((h,p)=>{if(!h.step){o||(o=this.remapping(a,p+1),r=o.maps.length),r--,d.push(h);return}if(o){d.push(new Le(h.map));let f=h.step.map(o.slice(r)),x;f&&i.maybeStep(f).doc&&(x=i.mapping.maps[i.mapping.maps.length-1],m.push(new Le(x,void 0,void 0,m.length+d.length))),r--,x&&o.appendMap(x,r)}else i.maybeStep(h.step);if(h.selection)return c=o?h.selection.map(o.slice(r)):h.selection,u=new Ie(this.items.slice(0,a).append(d.reverse().concat(m)),this.eventCount-1),!1},this.items.length,0),{remaining:u,transform:i,selection:c}}addTransform(s,n,a,o){let r=[],i=this.eventCount,c=this.items,u=!o&&c.length?c.get(c.length-1):null;for(let d=0;d<s.steps.length;d++){let h=s.steps[d].invert(s.docs[d]),p=new Le(s.mapping.maps[d],h,n),f;(f=u&&u.merge(p))&&(p=f,d?r.pop():c=c.slice(0,c.length-1)),r.push(p),n&&(i++,n=void 0),o||(u=p)}let m=i-a.depth;return m>Tm&&(c=jm(c,m),i-=m),new Ie(c.append(r),i)}remapping(s,n){let a=new Nd;return this.items.forEach((o,r)=>{let i=o.mirrorOffset!=null&&r-o.mirrorOffset>=s?a.maps.length-o.mirrorOffset:void 0;a.appendMap(o.map,i)},s,n),a}addMaps(s){return this.eventCount==0?this:new Ie(this.items.append(s.map(n=>new Le(n))),this.eventCount)}rebased(s,n){if(!this.eventCount)return this;let a=[],o=Math.max(0,this.items.length-n),r=s.mapping,i=s.steps.length,c=this.eventCount;this.items.forEach(p=>{p.selection&&c--},o);let u=n;this.items.forEach(p=>{let f=r.getMirror(--u);if(f==null)return;i=Math.min(i,f);let x=r.maps[f];if(p.step){let g=s.steps[f].invert(s.docs[f]),S=p.selection&&p.selection.map(r.slice(u+1,f));S&&c++,a.push(new Le(x,g,S))}else a.push(new Le(x))},o);let m=[];for(let p=n;p<i;p++)m.push(new Le(r.maps[p]));let d=this.items.slice(0,o).append(m).append(a),h=new Ie(d,c);return h.emptyItemCount()>wm&&(h=h.compress(this.items.length-a.length)),h}emptyItemCount(){let s=0;return this.items.forEach(n=>{n.step||s++}),s}compress(s=this.items.length){let n=this.remapping(0,s),a=n.maps.length,o=[],r=0;return this.items.forEach((i,c)=>{if(c>=s)o.push(i),i.selection&&r++;else if(i.step){let u=i.step.map(n.slice(a)),m=u&&u.getMap();if(a--,m&&n.appendMap(m,a),u){let d=i.selection&&i.selection.map(n.slice(a));d&&r++;let h=new Le(m.invert(),u,d),p,f=o.length-1;(p=o.length&&o[f].merge(h))?o[f]=p:o.push(h)}}else i.map&&a--},this.items.length,0),new Ie(Mo.from(o.reverse()),r)}}Ie.empty=new Ie(Mo.empty,0);function jm(e,s){let n;return e.forEach((a,o)=>{if(a.selection&&s--==0)return n=o,!1}),e.slice(n)}class Le{constructor(s,n,a,o){this.map=s,this.step=n,this.selection=a,this.mirrorOffset=o}merge(s){if(this.step&&s.step&&!s.selection){let n=s.step.merge(this.step);if(n)return new Le(n.getMap().invert(),n,this.selection)}}}class Ke{constructor(s,n,a,o,r){this.done=s,this.undone=n,this.prevRanges=a,this.prevTime=o,this.prevComposition=r}}const Tm=20;function Mm(e,s,n,a){let o=n.getMeta(ct),r;if(o)return o.historyState;n.getMeta(km)&&(e=new Ke(e.done,e.undone,null,0,-1));let i=n.getMeta("appendedTransaction");if(n.steps.length==0)return e;if(i&&i.getMeta(ct))return i.getMeta(ct).redo?new Ke(e.done.addTransform(n,void 0,a,Rs(s)),e.undone,Pa(n.mapping.maps),e.prevTime,e.prevComposition):new Ke(e.done,e.undone.addTransform(n,void 0,a,Rs(s)),null,e.prevTime,e.prevComposition);if(n.getMeta("addToHistory")!==!1&&!(i&&i.getMeta("addToHistory")===!1)){let c=n.getMeta("composition"),u=e.prevTime==0||!i&&e.prevComposition!=c&&(e.prevTime<(n.time||0)-a.newGroupDelay||!Cm(n,e.prevRanges)),m=i?an(e.prevRanges,n.mapping):Pa(n.mapping.maps);return new Ke(e.done.addTransform(n,u?s.selection.getBookmark():void 0,a,Rs(s)),Ie.empty,m,n.time,c??e.prevComposition)}else return(r=n.getMeta("rebased"))?new Ke(e.done.rebased(n,r),e.undone.rebased(n,r),an(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new Ke(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),an(e.prevRanges,n.mapping),e.prevTime,e.prevComposition)}function Cm(e,s){if(!s)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((a,o)=>{for(let r=0;r<s.length;r+=2)a<=s[r+1]&&o>=s[r]&&(n=!0)}),n}function Pa(e){let s=[];for(let n=e.length-1;n>=0&&s.length==0;n--)e[n].forEach((a,o,r,i)=>s.push(r,i));return s}function an(e,s){if(!e)return null;let n=[];for(let a=0;a<e.length;a+=2){let o=s.map(e[a],1),r=s.map(e[a+1],-1);o<=r&&n.push(o,r)}return n}function _m(e,s,n){let a=Rs(s),o=ct.get(s).spec.config,r=(n?e.undone:e.done).popEvent(s,a);if(!r)return null;let i=r.selection.resolve(r.transform.doc),c=(n?e.done:e.undone).addTransform(r.transform,s.selection.getBookmark(),o,a),u=new Ke(n?c:r.remaining,n?r.remaining:c,null,0,-1);return r.transform.setSelection(i).setMeta(ct,{redo:n,historyState:u})}let on=!1,Ia=null;function Rs(e){let s=e.plugins;if(Ia!=s){on=!1,Ia=s;for(let n=0;n<s.length;n++)if(s[n].spec.historyPreserveItems){on=!0;break}}return on}const ct=new ht("history"),km=new ht("closeHistory");function Em(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new It({key:ct,state:{init(){return new Ke(Ie.empty,Ie.empty,null,0,-1)},apply(s,n,a){return Mm(n,a,s,e)}},config:e,props:{handleDOMEvents:{beforeinput(s,n){let a=n.inputType,o=a=="historyUndo"?cr:a=="historyRedo"?_n:null;return o?(n.preventDefault(),o(s.state,s.dispatch)):!1}}}})}function lr(e,s){return(n,a)=>{let o=ct.getState(n);if(!o||(e?o.undone:o.done).eventCount==0)return!1;if(a){let r=_m(o,n,e);r&&a(s?r.scrollIntoView():r)}return!0}}const cr=lr(!1,!0),_n=lr(!0,!0);function Nm(){return jn({"Shift-Enter":(e,s)=>ka(e,s),Enter:(e,s)=>window.innerWidth>ul[dl.Medium]||oo?!1:ka(e,s)})}const Rm=["p",0],Am=["br"],Pm=new Rd({nodes:{paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p",preserveWhitespace:"full"}],toDOM(){return Rm}},text:{group:"inline"},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM(){return Am}},[Qt]:Jd,doc:{content:"block+"}},marks:{}});function Im(){const e=new EventTarget,s=new Ad(null,{state:Pd.create({schema:Pm,plugins:[Em(),Qd({submitKeys:["Enter","Tab"],cancelKeys:["Escape"],checkStrictMatchKeys:[" "]}),Zd(""),om(),Nm(),jn({"Mod-z":cr,"Mod-y":_n,"Mod-Shift-z":_n}),Yd(),jn(Wd),$d(e),zd()]}),dispatchTransaction(n){const a=s.state.apply(n);s.updateState(a),n.docChanged&&e.dispatchEvent(new Event(Tn))},handlePaste(n,a){const o=a.clipboardData?.getData("text/plain");return o===void 0?!1:(a.defaultPrevented||Ud(n,o),!0)},clipboardTextSerializer(n){return Gd(n.content).content}});return s}function Dm(){try{return navigator.userAgent.toLocaleLowerCase().includes("firefox")}catch{return!1}}const Bm=[I([ml["prosemirror-parent"],"text-token-text-primary","max-h-[25dvh]","max-h-52","overflow-auto",Dm()?"firefox":"default-browser"])],Fm=({children:e})=>{const[s]=l.useState(()=>new os(Im()));return e(s)},Lm=({composerController:e,placeholder:s})=>{const n=l.useContext(ro),a=l.useRef(null),o=l.useRef(null),r=l.useRef(!1);return l.useEffect(()=>{if(r.current)return;if(!(e instanceof os))throw new Error(`Expected instance of ProseMirrorComposerController but got ${e.constructor.name}`);r.current=!0;const i=o.current;if(i!=null){const{value:c,selectionStart:u,selectionEnd:m}=i;e.view.dispatch(e.view.state.tr.insertText(c)),e.view.dispatch(e.view.state.tr.setSelection(yn.create(e.view.state.doc,u+1,m+1))),i.style.display="none",i.value=""}a.current.appendChild(e.view.dom),e.view.dom.id=Co,hl(e.view.dom),_o()||e.view.focus()},[e]),l.useEffect(()=>{e.setPlaceholder(s)},[s,e]),l.useEffect(()=>{e.logPageMount()},[]),t.jsxs("div",{ref:a,className:I(Bm),children:[t.jsx("textarea",{className:"block h-10 w-full resize-none border-0 bg-transparent px-0 py-2 text-token-text-primary placeholder:text-token-text-secondary",autoFocus:!0,placeholder:s,ref:o}),t.jsx("script",{nonce:n.cspScriptNonce,suppressHydrationWarning:!0,children:"window.__oai_logHTML?window.__oai_logHTML():window.__oai_SSR_HTML=window.__oai_SSR_HTML||Date.now();requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI||Date.now()}))"})]})},Hm=l.forwardRef(function({type:s,placeholder:n,replyRegions:a,state:o,renderFiles:r,leftSideActions:i,topRightAction:c,onSubmit:u,inputState:m,currentLeafId:d,composerController:h,clientThreadId:p,gizmoId:f,disableReason:x},g){const S=Je(),y=gl();l.useEffect(()=>{_o()||h.focus()},[y?.modelId,h]);const E=w=>{Vm({target:w.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||h.focus()};return t.jsxs("div",{id:"composer-background",ref:g,className:I("flex w-full cursor-text flex-col rounded-3xl px-2.5 py-1 transition-colors contain-inline-size",S&&"backdrop-blur-2xl no-transparency:backdrop-blur-none",S&&s!=="temporary"&&"bg-token-composer-surface",!S&&s!=="temporary"&&"bg-[#f4f4f4] dark:bg-token-main-surface-secondary",s==="temporary"&&"dark bg-black"),onClick:E,children:[c&&t.jsx(Nt,{children:t.jsx("div",{className:"absolute right-2 top-2",children:c})}),t.jsx(Nt,{initial:!1,children:a.length>0&&t.jsx(ne.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:t.jsx(zm,{replyRegions:a})})}),t.jsxs(t.Fragment,{children:[r,t.jsx("div",{className:"flex min-h-[44px] items-center px-2",children:t.jsx("div",{className:"max-w-full flex-1",children:h instanceof ko?t.jsx(Om,{composerController:h,currentLeafId:d,placeholder:n,inputState:m}):t.jsx(Lm,{composerController:h,placeholder:n})})}),t.jsxs("div",{className:"flex h-[44px] items-center justify-between",children:[t.jsx("div",{className:"flex gap-x-1",children:i}),t.jsx(pl,{inputState:m,state:o,onSubmit:u,composerController:h,clientThreadId:p,gizmoId:f,disableReason:x})]})]})]})});function Om({composerController:e,currentLeafId:s,placeholder:n,inputState:a}){const o=l.useContext(ro);return t.jsxs(t.Fragment,{children:[t.jsx(fl,{id:Co,autoFocus:!0,tabIndex:0,"data-id":s,dir:"auto",ref:r=>{if(!(e instanceof ko))throw new Error("Expected TextAreaComposerController");r!=null&&(e.textArea=r,e.logPageMount())},rows:1,placeholder:n,disabled:a!=="default",className:I("m-0 resize-none border-0 bg-transparent px-0 text-token-text-primary focus:ring-0 focus-visible:ring-0",a==="disabled"&&"text-center",["max-h-[25dvh]","max-h-52"])}),t.jsx("script",{nonce:o.cspScriptNonce,suppressHydrationWarning:!0,children:"requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI??Date.now()}))"})]})}function zm({replyRegions:e}){return t.jsx("div",{className:"flex cursor-auto flex-col divide-y divide-token-border-light overflow-hidden rounded-b-lg rounded-t-[20px] bg-token-main-surface-primary",children:e.map((s,n)=>{switch(s.type){case"text":return t.jsx(Um,{value:s.value,onRemoveRegion:s.onRemoveRegion},n);case"object":return t.jsx(Gm,{value:s.value,onRemoveRegion:s.onRemoveRegion},n);case"mention":case"system_hint":return t.jsx(Wm,{value:s.value,icon:s.icon,onRemoveRegion:s.onRemoveRegion},n)}})})}function Um({value:e,onRemoveRegion:s}){return t.jsxs(ea,{className:"text-token-text-secondary",children:[t.jsx(ta,{children:t.jsx(Jo,{className:"icon-lg-heavy"})}),t.jsx(sa,{children:`“${e}”`}),t.jsx(Jn,{onClick:s})]})}function Gm({value:e,onRemoveRegion:s}){return t.jsxs(ea,{className:"text-blue-selection",children:[t.jsx(ta,{children:t.jsx(Jo,{className:"icon-lg-heavy"})}),t.jsx(sa,{className:"font-semibold",children:e}),t.jsx(Jn,{onClick:s})]})}function Wm({value:e,icon:s,onRemoveRegion:n}){return t.jsxs(ea,{children:[t.jsx(ta,{className:"mt-0",children:s}),t.jsx(sa,{className:"font-semibold text-token-text-primary",children:e}),t.jsx(Jn,{onClick:n})]})}function Jn({onClick:e}){return t.jsx("button",{onClick:e,type:"button",className:"flex-shrink-0 text-token-text-secondary",children:t.jsx(md,{className:"icon-lg"})})}const ea=be.div`flex items-start py-2.5 gap-3 pl-3 pr-1.5 text-sm`,ta=be.span`flex-shrink-0 mt-0.5 w-7 h-6 flex justify-center items-center`,sa=be.span`flex-1 line-clamp-3 py-0.5`;function Vm({target:e,rootId:s,additonalInteractiveIds:n}){let a=e;for(;a&&a!=null;){if(a.tagName==="BUTTON"||a.tagName==="INPUT"||a.tagName==="TEXTAREA"||a.isContentEditable||n.includes(a.id))return!0;if(a.id===s)return!1;a=a.parentElement}return!1}const Ms={initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:.1},exit:{opacity:0,scale:.5,transition:{duration:.2}}},qm=({suggestions:e,onSelectingSuggestedReply:s})=>t.jsx("div",{className:"absolute bottom-full flex w-full max-w-[100vw] grow gap-2 overflow-auto px-1 pb-1 contain-inline-size sm:mb-0 sm:justify-start sm:px-2 sm:pb-0 md:static md:mb-2 md:max-w-none md:justify-center md:overflow-visible",children:e.slice(0,2).map((n,a)=>t.jsx(ne.div,{initial:Ms.initial,animate:Ms.animate,transition:{delay:(a-1)*Ms.transition.delay},exit:Ms.exit,children:t.jsx(Pt,{as:"button",color:"secondary",size:"small",onClick:()=>{s(n,e,a)},className:"group whitespace-nowrap md:whitespace-normal",children:t.jsx(Km,{suggestion:n})},a)},a))});function $m({suggestions:e,onSelectingSuggestedReply:s,clientThreadId:n}){const a=e?.length>0;l.useEffect(()=>{a&&At(e,n)},[a,n]);const{isUnauthenticated:o}=Ve();return a?e.every(Eo)?t.jsxs(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col items-center",children:[o&&t.jsx(es,{className:"mb-6 h-12 w-12 sm:hidden"}),t.jsx(ar,{starterPrompts:e,onSelectStarterPrompt:s})]}):e.every(No)?t.jsx(qm,{suggestions:e,onSelectingSuggestedReply:s}):null:null}function Km({suggestion:e}){return No(e)?t.jsx(t.Fragment,{children:e.text}):Eo(e)?t.jsxs("div",{className:"flex flex-col overflow-hidden",children:[e.title&&t.jsx("div",{className:"truncate font-semibold",children:e.title}),t.jsx("div",{className:I("truncate font-normal",e.title?"opacity-50":""),children:e.body})]}):null}function Ym(){const{store:e}=ye(),s=e.useSharedProps();return s?t.jsx(Xm,{...s}):null}function Xm({clientThreadId:e,suggestions:s}){const n=qs();return s===void 0||s.length===0?null:t.jsx("div",{children:t.jsx(Qm,{children:t.jsx("div",{className:"grow",children:s!==void 0&&t.jsx($m,{suggestions:s,onSelectingSuggestedReply:n,clientThreadId:e})})})})}const Qm=be.div`h-full flex ml-1 md:w-full md:m-auto gap-0 md:gap-2 justify-center`,ur=({className:e,children:s})=>t.jsx(ne.div,{className:e,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:s});function Zm({currentLeafId:e,canContinue:s,onContinueGenerating:n}){const a=l.useCallback(()=>{const r=new Kt;n(e,r),Ps()},[n,e]);let o=null;return s&&(o=t.jsx(eh,{onHandleContinueGenerating:a})),o&&t.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:o})}function Jm({className:e}){return t.jsx(er,{className:I("-rotate-180",e)})}const eh=({onHandleContinueGenerating:e})=>t.jsx(ur,{children:t.jsx(Pt,{as:"button",color:"secondary",onClick:e,className:"whitespace-nowrap py-2",icon:Jm,size:"small",children:t.jsx(F,{...Fe.continueGenerating})})}),th=()=>{const{shouldShowSkipButton:e}=Ro();return e?t.jsx(ur,{className:"flex justify-center",children:t.jsx(Pt,{as:"button",color:"secondary",onClick:()=>xl.skipParagen(),children:t.jsx(F,{...sh.skip})})}):null},sh=Ue({skip:{id:"dvcUbp",defaultMessage:"Skip"}}),dr=l.memo(function({className:s}){const{store:n}=ye(),a=n.useIsHeaderContentAreaPopulated();return t.jsx("div",{className:I(s??"absolute bottom-full left-0 right-0",Is.PromptTextareaHeader),children:t.jsx(vl,{shouldRender:a,contentArea:Rt.Header,children:t.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[t.jsx(mr,{}),t.jsx(hr,{})]})})})});function mr(){const{store:e}=ye(),s=e.useSharedProps(o=>o?.clientThreadId),n=e.useContentAreaId(Rt.HeaderTop);let a;switch(n){case se.AdvancedVoiceOnMobileAnnouncement:a=t.jsx(wl,{clientThreadId:s});break;case se.ParagenControls:a=t.jsx(th,{});break;case se.ItemActions:a=t.jsx(Ym,{});break;case se.BannerSignup:a=t.jsx(oh,{});break;case se.BannerTermsDisclaimer:a=t.jsx(rh,{});break;case se.PromptTextareaAction:a=t.jsx(ih,{});break;case se.BannersRateLimit:a=t.jsx(lh,{});break;case se.BannerSidekickAnnouncement:a=t.jsx(yl,{});break;case se.SearchBrowserExtensionAnnouncement:a=t.jsx(bl,{});break;case se.SearchBrowserExtensionReactiveAnnouncement:a=t.jsx(Sl,{});break;case se.BannerMemoryFull:a=t.jsx(dm,{});break;case se.Box:a=t.jsxs("div",{className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",t.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",t.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;default:a=null;break}return a}function hr(){const{store:e}=ye(),s=e.useContentAreaId(Rt.HeaderBottom);let n;switch(s){case jo.DallePromptControls:n=t.jsx(ah,{});break;default:n=null;break}return n}const nh=Ge(()=>We(()=>import("./hgbn5h3l9xp07n6a.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(e=>e.default));function ah(){const{store:e}=ye(),s=e.useSharedProps(n=>n?.composerController);return s?t.jsx(nh,{composerController:s}):null}function oh(){const{store:e}=ye(),s=e.useSharedProps(o=>o?.clientThreadId),n=jl(),a=Tl();return s?n?t.jsx(Ml,{threadId:s,showSignUp:a}):t.jsx(Cl,{threadId:s,showLogin:a}):null}function rh(){const{store:e}=ye(),s=e.useSharedProps(n=>n?.clientThreadId);return s?t.jsx(_l,{threadId:s}):null}function ih(){const{store:e}=ye(),s=e.useSharedProps();return s?t.jsx(Zm,{...s}):null}function lh(){const{store:e}=ye(),s=e.useSharedProps(n=>n?.clientThreadId);return s?t.jsx(lm,{clientThreadId:s}):null}function ch({composerController:e,isDisabled:s,highlightTooltip:n,clientThreadId:a}){const{setThreadSearchMode:o}=Bn(),r=Fn(),i=kl(),[c,u]=l.useState(!1),m=ze(),d={clientThreadId:a};return t.jsx(dh,{highlightTooltip:n,analyticsMetadata:d,isThreadUsingSearchMode:r,isDisabled:s,children:t.jsxs("button",{className:I("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold",c&&"transition-all duration-150",r||n?"!rounded-2xl bg-blue-250 text-blue-1000 hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:hover:bg-[#1A416A]":s?"opacity-30":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-pressed":r,"aria-label":m.formatMessage({id:"Sl1VH/",defaultMessage:"Search the web"}),disabled:s,onTransitionEnd:()=>u(!1),onClick:h=>{h.stopPropagation(),h.preventDefault(),u(!0),J.logEventWithStatsig(Z.composerSearchButtonClicked,"composer_search_button_clicked",d),o(!r,d,En.CONVERSATION_COMPOSER_WEB_ICON),/^search\s?$/i.test(e.getCurrentText())&&e.setText(""),e.replaceSlashCommandTokensWithText(),e.focus()},children:[t.jsx(Qn,{}),t.jsx(Nt,{children:r&&t.jsx(ne.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:i?0:.15},children:t.jsx("div",{className:"whitespace-nowrap pl-1 pr-2",children:t.jsx(F,{id:"TbHx8d",defaultMessage:"Search"})})})})]})})}function uh(){const e=Ln(mt.hasSeenComposerSearchButtonTooltip);return!e.isLoading&&e.eligible}function dh({children:e,highlightTooltip:s,analyticsMetadata:n,isThreadUsingSearchMode:a,isDisabled:o}){const r=uh()&&!a,i=Ln(mt.hasSeenComposerSearchButtonTooltip);return r?t.jsx(Hn,{announcementKey:mt.hasSeenComposerSearchButtonTooltip,side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:t.jsx(F,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:i.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:t.jsx(F,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:t.jsx(El,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:t.jsx(F,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:t.jsx("div",{children:e})}):t.jsx("div",{children:t.jsx(ts,{sideOffset:0,label:o?t.jsx(F,{id:"GpDAWD",defaultMessage:"Search is unavailable"}):t.jsx(F,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"right",open:s||(a?!1:void 0),onOpenChange:c=>{c&&J.logEventWithStatsig(Z.composerSearchButtonHovered,"composer_search_button_hovered",n)},children:e})})}function mh({composerController:e,clientThreadId:s}){const n=ss(s),{setThreadSearchMode:a}=Bn(),r=Ao().size>0,i=Po(s,io.Search),c=Io(s),[u,m]=l.useState([]),[d,h]=l.useState(void 0),[p,f]=l.useState(0);l.useEffect(()=>{m(d?c.filter(j=>j.name.toLocaleLowerCase().startsWith(d.text.toLocaleLowerCase())||j.systemHint.toLocaleLowerCase().startsWith(d.text.toLocaleLowerCase())):[])},[d]),l.useEffect(()=>{const j=k=>{h(N=>ei(N,k)?N:k)};e.view.dispatch($s(e.view.state.tr,{onHintMatch:j}))},[e]);const x=r||!c.length||!u.length||!d;l.useEffect(()=>{x&&f(0)},[x]);const g=u.length,S=l.useCallback(j=>{f(k=>(j(k)%g+g)%g)},[g]),y=u[p],E=({hintToSave:j=y,expectPerfectMatch:k,appendSpace:N=!0})=>{if(!d||!y||k&&j.name.toLowerCase()!==d.text.toLowerCase())return;J.logEvent(Z.systemHintSelected,{system_hint:j.systemHint,conversation_id:n??xa});const P=d.text+j.name.slice(d.text.length),L={clientThreadId:s};tm(e.view,{id:j.systemHint,hint:P},d.range,N,i,B=>a(B,L,En.CONVERSATION_COMPOSER_SLASH_SEARCH)),Ct(e.view)},w=l.useRef(E);w.current=E;const v=l.useRef(S);v.current=S;const C=l.useRef(d);C.current=d;const R=e.view;return l.useEffect(()=>(x||Xd(R,j=>{j==="up"?v.current(k=>k-1):j==="down"?v.current(k=>k+1):j==="cancel"?(Ct(R),em(R)):j==="submit"?(w.current({expectPerfectMatch:!1}),Ct(R)):j==="checkMatch"&&w.current({expectPerfectMatch:!0,appendSpace:!1})}),()=>Ct(R)),[x,R]),l.useEffect(()=>{x||J.logEvent(Z.systemHintListOpened,{conversation_id:n??xa})},[x]),x?null:t.jsx(Zr,{className:"max-w-60",onMouseDown:j=>{j.preventDefault()},children:u.map((j,k)=>t.jsx("div",{onMouseOver:()=>f(k),onClick:()=>{E({hintToSave:j,expectPerfectMatch:!1}),e.focus()},children:t.jsx(Jr,{autoFocus:!1,className:"group rounded-lg px-1 py-2 hover:bg-token-hint-text",$spoofHovered:k===p,children:t.jsx(hh,{title:j.name,description:j.description,icon:t.jsx(Nl,{svgString:j.logo,className:"icon-lg text-token-text-secondary group-hover:text-white"}),checked:!1})})},j.systemHint))})}function hh({title:e,description:s,icon:n,checked:a}){return t.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-1.5 pl-1.5 pr-3",children:[t.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:n}),t.jsxs("div",{className:"shrink grow basis-0",children:[t.jsx("p",{className:"text-sm font-normal leading-tight text-token-text-primary group-hover:text-white",children:e}),!!s&&t.jsx("p",{className:"text-[13px] font-normal leading-[18px] text-token-text-secondary group-hover:text-white",children:s})]}),a&&t.jsx(hd,{className:I("icon-md text-token-text-primary",{"group-hover:hidden":!a})})]})}function gh({composerController:e,clientThreadId:s}){return e instanceof os?t.jsx(mh,{composerController:e,clientThreadId:s}):null}function ph({suggestions:e,composerController:s,onSelect:n,onChange:a}){const o=qs(),r=l.useCallback((d,h,p)=>{n?.(d,h,p),o(d,h,p)},[n,o]),[i,c]=l.useState(-1),[u,m]=l.useState(!1);return l.useEffect(()=>{const d=h=>{if(h.key==="ArrowDown"){const p=i===e.length-1?0:i+1;c(p),a?.(p,!0,e[p])}else if(h.key==="ArrowUp"){h.preventDefault();const p=i<=0?e.length-1:i-1;c(p),a?.(p,!0,e[p])}else h.key==="Enter"&&!h.shiftKey&&e[i]&&r(e[i],e,i)};return s.subscribe("keydown",d)},[e,i,a,r,s]),l.useEffect(()=>s.subscribe("blur",()=>{c(-1),a?.(-1,!1)}),[s,a]),l.useEffect(()=>{if(!u){const d=()=>{m(!0),window.removeEventListener("mousemove",d)};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}}},[u]),l.useEffect(()=>{c(-1),a?.(-1,!1),m(!1)},[e,a]),t.jsx(ne.ul,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hidden w-full flex-col p-2.5 group-focus-within:flex group-focus-within:max-lg:flex-col-reverse",children:e.map((d,h)=>t.jsxs(ne.li,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:h*.03},exit:{opacity:0,translateY:4},className:"w-full",children:[h>0&&t.jsx("div",{className:I("h-[1px] opacity-60 max-lg:hidden",i===h||i===h-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")}),t.jsxs("button",{className:I("flex w-full cursor-pointer items-center justify-start whitespace-pre-wrap rounded-lg px-2.5 py-3 text-start",i===h?"bg-token-main-surface-secondary":"bg-token-main-surface-primary"),onClick:p=>{p.preventDefault(),r(d,e,h)},onMouseDown:p=>{p.preventDefault()},onMouseEnter:()=>{u&&(c(h),a?.(h,!1,d))},onMouseLeave:()=>{c(-1),a?.(-1,!1,d)},children:[d.icon?t.jsx("span",{className:"mr-4 h-6 w-6 text-token-text-secondary",children:d.icon}):null,t.jsx("span",{className:"whitespace-pre-wrap",children:d.autocompletionChunks&&d.autocompletionChunks.length>0?t.jsx(t.Fragment,{children:d.autocompletionChunks.map((p,f)=>t.jsx("span",{className:I(p.isMatched?"text-token-text-tertiary":"text-token-text-primary"),children:p.text},f))}):t.jsxs(t.Fragment,{children:[t.jsx("span",{className:I(d.type===Ds.Starter?"text-token-text-secondary":"text-token-text-tertiary"),children:d.title}),t.jsx("span",{className:"text-token-text-primary",children:d.body})]})})]}),h>0&&t.jsx("div",{className:I("h-[1px] opacity-60 lg:hidden",i===h||i===h-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")})]},d.id??h))})}function fh(e,s){e=e.toLocaleLowerCase();const n=s;s=s.toLocaleLowerCase();const a=[];let o=0;for(let c=0;c<s.length&&(o<e.length&&e[o]===s[c]&&(a.push(c),o++),o!==e.length);c++);const r=[];let i=0;if(a.forEach(c=>{if(c>i){const u=n.slice(i,c);u&&r.push({text:u,isMatched:!1})}r.push({text:n[c],isMatched:!0}),i=c+1}),i<s.length){const c=n.slice(i);c&&r.push({text:c,isMatched:!1})}return xh(r)}function xh(e){if(e.length===0)return e;let s=[e[0]];for(let a=1;a<e.length;a++){const o=s[s.length-1],r=e[a];o.isMatched===r.isMatched?o.text+=r.text:s.push(r)}const n=s.filter(a=>a.isMatched).reduce((a,o)=>a+o.text.trim().length,0);return s.length<=4&&n>=2?s:[{text:s.map(a=>a.text).join(""),isMatched:!1}]}function vh({composerController:e,isDisabled:s,clientThreadId:n}){const a=ze(),o=Ln(mt.hasSeenComposerSystemHintButtonTooltip),i=Io(n).length>0,u=Ao().size>0,m=s===!0||!i||u;if(!(e instanceof os))return null;const d=e,h={clientThreadId:n};function p(){J.logEventWithStatsig(Z.composerSystemHintButtonClicked,"composer_system_hint_button_clicked",h),o.markAsViewed(),d.focus(),am(d.view)}const f=t.jsx("button",{className:I("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold",m?"opacity-30":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-label":a.formatMessage({id:"oDAnGy",defaultMessage:"Use a tool"}),disabled:m,onPointerDown:p,onMouseDown:x=>{x.preventDefault()},onClick:x=>{x.preventDefault(),x.detail===0&&p()},children:t.jsx(gd,{})});return!o.isLoading&&o.eligible?t.jsx(Hn,{announcementKey:mt.hasSeenComposerSystemHintButtonTooltip,show:!0,side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:t.jsx(F,{id:"tTydhk",defaultMessage:"All your tools, in one handy place"}),onDismiss:o.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:t.jsx(F,{id:"S+BFNe",defaultMessage:"Create a canvas, generate a picture, and more."}),children:f}):t.jsx(ts,{side:"right",sideOffset:0,label:s?t.jsx(F,{id:"uw9x80",defaultMessage:"Tools unavailable"}):t.jsx(F,{id:"mrYNGk",defaultMessage:"View tools"}),onOpenChange:x=>{x&&J.logEventWithStatsig(Z.composerSystemHintButtonHovered,"composer_system_hint_button_hovered",h)},children:f})}const Sh=1,bh=3e3;function yh({files:e,className:s,composerController:n}){const a=Oo(),o=Do(),r=uc();return t.jsxs("div",{className:s,children:[r.map(i=>{const{tempId:c,content:u}=i;return t.jsx(dc,{pastedTextdoc:i,textdocId:c,onClickSwitchToInline:()=>{n.appendText(u),n.focus(),Ho.removePastedContent(c)}},c)}),e.map(i=>t.jsx(mc,{borderRadius:"2xl",useV2Style:!0,width:a?"normal":"wide",onRemoveFileClick:()=>pn.remove(o,i.tempId,"none"),file:i.file,fileId:i.fileId??void 0,contextConnectorInfo:i.contextConnectorInfo,loadingPercentage:i.status===hc.Uploading?i.progress:void 0},i.tempId))]})}function wh({onAbortCompletion:e,onCreateNewCompletion:s,onContinueGenerating:n,currentModelId:a,clientThreadId:o,isNewThread:r,isCompletionInProgress:i,className:c,disabled:u=!1,disabledReason:m,canPause:d=!1,canContinue:h=!1,suggestions:p,isInteractableSharedThread:f,composerContainerRef:x,composerController:g,autocompletions:S,requiresFileUpload:y,onComposerInput:E,onComposerChange:w,onAutocompleteSelect:v,headerClassName:C,hideHeader:R,setComposerBarElement:j,onTaggingDropdownOpen:k,onTaggingDropdownClose:N}){const P=On(),L=Os(),{isUnauthenticated:B}=Ve(),T=ze(),A=lo(),z=Do(),_=Ze(o),G=Hs(o),[b]=ti(),q=si(),{gizmoEditorData:Y,mode:ee,getGizmoId:V}=Rl(),fe=co(),ce=Al(),X=ns(),ge=Bo(),oe=ss(o),je=!!ni(),xe=!!Nn(),[Te,Me]=l.useState({}),{setThreadSearchMode:Ce,clearSearchModeTrigger:ve,getSearchModeTrigger:De}=Bn(),ue=Fn(),[O,D]=l.useState(!1),[te,W]=l.useState(!1),H=Je(),K=l.useRef(!1),pe=Fo(),ae=a!==null?pe[a]:void 0,_e=ai(o);let $=zn(o),ie=$&&"gizmo"in $?$.gizmo:void 0;const Be=Un(ie?.gizmo.id),[re,Ae]=l.useState(null);re!==null&&($={gizmo:re,gizmo_id:re.gizmo.id,kind:dt.GizmoInteraction},ie=re);const de=ya(ae,$);let rs=!1;Pl($)&&ie?.gizmo.id===Il&&(rs=!0);const Ks=oi(),gt=!u&&!rs&&de!==wa.None&&!B,et=Dl(ae,$),Dt=Bl(ae,$);let we=ja(M=>M.files);const[tt]=l.useState(()=>Fl());ee==="magic"?we=we.filter(M=>M.gizmoId!=null):we=we.filter(M=>M.gizmoId==null);const Ys=Ll(),st=we.length>0||Ys,Bt=ja(gc.hasUploadInProgress),Ft=g.useState(M=>{const le=Hl(M);return typeof ae?.maxTokens=="number"&&le>ae.maxTokens}),Lt=g.useState(M=>!M.isEmpty()),pt=!Ft&&!Bt&&(Lt||st);Gn(we.length>0||Bt||Lt);const is=(de===wa.Multimodal?Ol:zl)-we.length,ls=is<=0,Pe=pt&&!u&&!i&&!xe,[Ht,Xs]=l.useState(!1),ft=Lo(),cs=a||ft.id,xt=Po(o,io.Search),vt=!u&&(!ie||Be)&&fe?.includes(ks.SearchTool)&&(fe?.includes(ks.BrowsingAvailable)||!L?.isEnterprisey()),qe=vt&&xt,Ot=pe[cs]?.tags,{targetedContent:us,setTargetedContent:St}=Wn(),ke=us?.isFocusedViewContent&&!ge?void 0:us,{rebaseSystemMessageContent:zt}=Vn();l.useEffect(()=>{if(!P?.id)return;const M=Ta.getAndReset(P?.id,oe);M&&g.setText(M.inputText)},[P?.id,oe,g]),l.useEffect(()=>{Ht!==Pe&&(Xs(Pe),Pe&&ri(!0).then(M=>{ii.startEnforcement(M),Ul.startEnforcement(M),li.startEnforcement(M)}))},[Pe,Ht,$?.kind,fe]);const ds=Gl(ae,$),{handleFileAccepted:Qs}=Wl(T,ya(ae,$),et,"mouse",V,ds?.attachments),{getInputProps:ms,open:aa}=Vl({disabled:u||!gt||ls,noClick:!0,onDropAccepted:Qs,onDropRejected:M=>ql(M,T,A,de),multiple:!0,maxSize:$l,maxFiles:is,...Kl(Dt)}),hs=ci(tt),gs=l.useCallback(()=>{g.eraseContent(),hs.clearMessages(),g.resize(Sh),Q.clearOverrideModelId(o),Yl();for(const M of we)pn.remove(z,M.tempId,"none");Ho.markAllAsSent()},[g,hs,we,z,o]),bt=async(M,le)=>{if(M?.preventDefault(),u||!pt&&!le||!$||kt.isLoading(o)!==!1)return;const Ee=new Kt;D(!0);const Se=g.getContentToSend(),ot=pc(Se.content),tn=`${_}-nextPrompt`,Gt=new fc(xc.CompletionRequest,{expectedTimingLogs:[{name:"prompt_submitted",expectedInMs:3e3}]}),{content:qr,attachments:ua}=vc(z,ot,ae,$),da=[],sn=[];zt&&sn.push(mi(zt));const nn={...$};"gizmo"in nn&&delete nn.gizmo;let bs=g.getSystemHints();ue&&(bs=[Vs.Search]);const ma=De(),$r=ue?ma??En.CONVERSATION_COMPOSER_WEB_ICON:void 0,ha=Sc(),ga=bc();let Wt={promptId:tn,content:qr,eventMetadata:{eventSource:M?"mouse":"keyboard"},completionMetadata:{suggestions:p,conversationMode:nn,systemHints:bs,searchSource:$r},messageMetadata:{...ua.length>0&&{attachments:ua},...re&&{gizmo_id:re?.gizmo.id},...Te,...bs.length>0&&{system_hints:bs},...!!Se.metadata&&{serialization_metadata:Se.metadata},...ha.length>0&&{canvas:{pasted_textdocs:ha}},...Object.keys(ga).length>0&&{__internal:{search_settings:ga}}},prependMessages:da.length>0?da:void 0,appendMessages:sn.length>0?sn:void 0,turnTracker:Ee,profiler:Gt,requestedModelId:_e};Wt=yc(Wt),ke?.createNewCompletionParams&&(Wt=await ke.createNewCompletionParams(Wt)),Gt.logTiming("request_params_ready"),await s(Wt),ke?.onCreateCompletion?.({serverThreadId:oe,currentLeafId:_}),ke?.shouldPersistAcrossMessages!==!0&&St(void 0),Bs.hideThreadHeader(),gs(),D(!1),Gt.logTiming("prompt_submitted"),p!==void 0&&(he.logEvent("chatgpt_prompt_ignore_suggestions"),J.logEvent(Z.promptIgnoreSuggestions)),ue&&ma&&ve()},Zs=l.useRef(bt);l.useEffect(()=>{Zs.current=bt});const Js=M=>{St(M.targetedReply),M.targetedReply&&(g.focus(),J.logEvent(Z.targetedReplyButtonClicked,{conversationId:oe,sourceMessageId:M.messageId}))},ps=l.useCallback(()=>{ke?.onCleared?.({serverThreadId:oe,currentLeafId:_}),St(void 0),g.focus()},[_,oe,ke,St,g]),fs={Enter:{validator:M=>{const le=M.isComposing||M.keyCode===229;return!(te&&K.current)&&(M.metaKey||(ce||oo)&&!M.shiftKey&&!le)},handler:M=>{if(!Pe){Ft&&A.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}M.preventDefault(),bt()}},Escape:{validator:M=>!M.isComposing,handler:M=>{d&&i&&(e("",G),J.logEvent(Z.pauseCompletion,{threadId:Q.getServerThreadId(o),currentLeafId:Q.getTree(o).getMessageId(_),eventSource:"keyboard"})),M.target.value===""&&ps()}}},nt=l.useRef(fs);nt.current=fs;const yt=Xl(Ot,$?.kind),[U,me]=l.useState(!1),[at,xs]=l.useState(!1),wt=yt&&U&&!Be,oa=g.isReady();l.useEffect(()=>g.subscribe("keydown",M=>{g.acceptLegacyKeydown()&&nt.current[M.key]?.validator(M)&&nt.current[M.key].handler(M);const Ee=g.getCurrentText();if(M.key==="@"){const Se=g.getSelectionStart(),ot=Ee.substring(0,Se);(!ot||/\s$/.test(ot)||Se===0)&&setTimeout(()=>me(!0),10)}else U&&me(!1);if(M.key==="Escape"&&(Ae(null),W(!1)),qe&&!ue){let Se;M.key==="Backspace"?Se=Ee.substring(0,Ee.length-1):Se=Ee+M.key,/^search\s?$/i.test(Se)?xs(!0):at&&xs(!1)}ue&&M.key==="Escape"&&Ce(!1,{clientThreadId:o})}),[g,oa,U,at,qe,ue,Ce,o]),l.useEffect(()=>{const M=Object.fromEntries(Object.keys(nt.current).map(le=>[le,Se=>{const ot=nt.current[le];if(!ot||g.acceptLegacyKeydown())return!1;const{validator:tn,handler:Gt}=ot;return tn(Se)?(Gt(Se),!0):!1}]));g.registerKeyHandlers(M)},[g,oa]),l.useEffect(()=>g.subscribe("paste",M=>{Ql({filePickerStore:z,event:M,intl:T,toaster:A,clientThreadId:o,conversationMode:$,currentModelConfig:ae,getEditorGizmoId:V,modelSupportedImageMimeTypes:et})}),[T,o,$,ae,V,et,g,A,z]);const _r=M=>{je||Ae(M),g.trimLeadingText("@"),Ps(),me(!1)},kr=Zl(o,tt,et,ds?.attachments),Er=l.useCallback(M=>{M?.preventDefault(),e("",G),J.logEvent(Z.pauseCompletion,{threadId:Q.getServerThreadId(o),currentLeafId:Q.getTree(o).getMessageId(_),eventSource:"mouse"}),Ps()},[e,o,G,_]),ra=l.useCallback(()=>{Ta.set(P?.id,oe,g.getCurrentText())},[oe,P?.id,g]);l.useEffect(()=>{Y||!O&&!Jl()&&g.focus()},[O,g]),l.useEffect(()=>{Y||pn.reset(z)},[a,z,Y]),l.useEffect(()=>{(!yt&&re||je)&&Ae(null)},[yt,re,je]);const[Nr,Rr]=(()=>{switch(m){case"workspaceDisallowsGizmo":return[Fe.disallowedByWorkspacePlaceholder,!0];case"feedbackRequired":return[Fe.disabledFeedbackPlaceholder,!0];case"noModelsAvailable":return[Fe.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[Fe.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[Fe.loading,!0];case"noTestGizmoId":return[Fe.noTestGizmoId,!0];default:return f?[Fe.placeholderWithName,!1]:ke?.placeholderTextOverride!=null?[ke.placeholderTextOverride,!1]:[Fe.placeholderWithName,!1]}})(),Ar=Be&&r?T.formatMessage(ec.newChatInProject):T.formatMessage(Nr,{name:Y!=null?ee==="magic"?tc:Y.name||"GPT":ie?.gizmo.display.name??"ChatGPT"});l.useEffect(()=>g.subscribe("input",()=>{qn.getState().isThreadHeaderVisible&&Bs.hideThreadHeader(),W(!0)}),[g]),l.useEffect(()=>{if(E)return g.subscribe("input",()=>{E?.()})},[g,E]),l.useEffect(()=>{if(w)return g.subscribe("change",()=>{w?.()})},[g,w]),l.useEffect(()=>g.subscribe("focus",()=>{W(!0)}),[g]);const ia=$?.kind===dt.PrimaryAssistant&&!ue,{layer:Pr}=Xe("4211831761"),Ir=ui(ks.CanvasOptIn)||Pr.get("enable",!1),Dr={clientThreadId:o,uploadType:de,modelAcceptedMimeTypes:Dt,modelSupportedImageMimeTypes:et,attachmentsProductFeature:ds?.attachments,getInputProps:ms,openFileDialog:aa,historyDisabled:X,onOauthRedirect:ra,highlightTooltip:y&&!st},vs=[],Br=!u&&!ls&&(gt||Ks!=null)&&!ue;vs.push(t.jsx(ym,{...Dr,isDisabled:!Br},"file-upload-button")),Ir&&vs.push(t.jsx(vh,{composerController:g,clientThreadId:o,isDisabled:!ia},"system-hint-button")),vt&&vs.push(t.jsx(ch,{composerController:g,highlightTooltip:at,clientThreadId:o,isDisabled:!qe||st},"search-button"));const Fr=st&&t.jsxs(t.Fragment,{children:[ee==="magic"&&t.jsx("div",{className:"m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",children:t.jsx(F,{...Fe.gizmoKnowledgeWarning})}),t.jsx(yh,{files:we,className:"flex flex-nowrap gap-2 overflow-x-auto p-1.5",composerController:g})]}),Lr=Rr?"disabled":"default",Hr=i&&d,Or=di(),zr=!Pe||O||Or,Ur=wc(Bt,Lt,Ft),Ss=Hr?"streaming":zr?"disabled":"idle",Ut=l.useRef(null),jt=l.useRef(null),Gr=a&&a.startsWith("o1");l.useEffect(()=>{const M=()=>{Ut.current!=null&&hn.addAction("composer_state_disabled",{threadId:Q.getServerThreadId(o),disabledReason:Ut.current})};if(pt&&Ss==="disabled"){let le="unknown";u?le=m??"component_disabled_unknown":i?le="completion_in_progress":xe?le="thread_hard_blocked":O&&(le="starting_new_completion_request"),Ut.current!==le&&(jt.current&&clearTimeout(jt.current),jt.current=setTimeout(M,bh)),Ut.current=le}else Ut.current=null;return()=>{jt.current&&(clearTimeout(jt.current),jt.current=null)}},[o,pt,Ss,u,m,i,xe,O]);const en=[];if(ke?.label&&en.push({type:ke.type,value:ke.label,onRemoveRegion:ps}),re!==null){const M=!!re.gizmo.tags?.includes($n.FirstParty);en.push({type:"mention",value:re.gizmo.display.name,icon:t.jsx(sc,{isFirstParty:M,src:re.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{Ae(null),g.focus()}})}l.useEffect(()=>{(!S||S.length===0||!te)&&(K.current=!1)},[S,te]);const Wr=(M,le,Ee)=>{K.current=M>=0,le&&g.setText(Ee?`${Ee.title}${Ee.body}`:"")},la=te&&S&&S.length>0&&!wt&&!g.hasMultipleLines()&&g.canShowAutocompletion();l.useEffect(()=>{wt?k?.():N?.()},[wt,k,N]);const ca=Ss==="streaming"?Er:bt,{value:Vr}=Rn("61299031");return t.jsxs(nc.Provider,{value:tt,children:[t.jsx(ac,{onOauthRedirect:ra,children:t.jsx("form",{className:c,onSubmit:ca,children:t.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col",children:[!R&&!H&&t.jsx(dr,{className:C}),wt&&t.jsx("div",{className:I("absolute bottom-full my-3",r&&"lg:top-full",Is.TagGpt),children:t.jsx(oc,{onClick:M=>_r(M),onClose:()=>{me(!1),g.focus()}})}),ia&&t.jsx("div",{className:I("absolute bottom-full my-3",r&&"lg:top-full",Is.TagGpt),children:t.jsx(gh,{composerController:g,clientThreadId:o})}),t.jsxs("div",{ref:x,className:"group relative flex w-full items-center",children:[r&&b.has("from_template_row")&&t.jsx("button",{type:"button",onClick:()=>{q("/")},className:"mr-2 flex h-8 w-8 items-center justify-center text-token-text-tertiary hover:text-token-text-secondary",children:t.jsx(pd,{className:"icon-lg"})}),t.jsx(Hm,{type:X?"temporary":"default",ref:j,replyRegions:en,placeholder:Ar,inputState:Lr,composerController:g,leftSideActions:vs,topRightAction:Vr&&t.jsx(rc,{composerController:g,clientThreadId:o}),state:Ss,onSubmit:ca,renderFiles:Fr,currentLeafId:_,clientThreadId:o,gizmoId:ie?.gizmo.id,disableReason:Ur,modelId:cs}),la&&t.jsx("div",{className:"absolute left-0 z-10 box-border w-full bg-token-main-surface-primary pl-0 max-lg:bottom-full lg:top-full",children:t.jsx(ph,{suggestions:S,composerController:g,onSelect:v,onChange:Wr})})]}),t.jsx(ic,{composerController:g,parsedDocumentHandler:kr})]})})}),t.jsx(mm,{canUseInlineTagging:yt,isDisabled:u,clientThreadId:o,currentLeafId:_,currentRequestId:G,canContinue:h,composerController:g,setPromptInputMetadata:Me,suggestions:p,isNewThread:r,onCreateNewCompletion:s,onContinueGenerating:n,onResetState:gs,conversationMode:$,isShowingAutocomplete:!!la}),$!=null&&!Gr&&lc.includes($.kind)&&t.jsx(cc,{clientThreadId:o,onTargetedReply:Js})]})}const gr=Fm;function jh(e){const s=e.message?.author.role===He.User,n=e.metadata?.err!=null&&e.metadata?.errCode!==Sa.ContentPolicy,a=e.metadata?.errCode===Sa.ModelIncompatibility;return e.metadata?.canRetry===!1||a?!1:s||n}function pr(e){return e.composerController?t.jsx(Da,{...e,composerController:e.composerController}):t.jsx(gr,{children:s=>t.jsx(Da,{...e,composerController:s})})}function Da({clientThreadId:e,isNewThread:s,currentModelId:n,showPromptStarters:a,noWrap:o,onRequestCompletion:r,composerContainerRef:i,composerController:c}){const u=An(),m=Pn(),d=In(p=>{const f=kt.getCurrentNode(e,p);return jh(f)});if(zo(c),!m&&d)return t.jsx(Th,{clientThreadId:e});const h=t.jsx(t.Fragment,{children:t.jsx(fr,{composerContainerRef:i,composerController:c,clientThreadId:e,currentModelId:n,isNewThread:s,showPromptStarters:a,onRequestCompletion:r})});return o?h:t.jsxs(t.Fragment,{children:[t.jsx(rm,{clientThreadId:e}),t.jsx(Kn,{clientThreadId:e,isStaticSharedThread:u,withVerticalPadding:!1,withHorizontalPadding:!0,children:t.jsx(Yt,{children:h})})]})}function Th({clientThreadId:e}){const s=kc(e),n=In(r=>kt.getCurrentNode(e,r).metadata?.errCode===Ec),a=Nc(r=>r.isoDate),o=Ze(e);return n&&a!=null&&a!==""?null:t.jsxs("div",{children:[t.jsx("div",{className:"mb-3 text-center text-xs",children:t.jsx(F,{...Ba.errorGeneratingResponse})}),t.jsx("div",{className:"flex items-center md:mb-4",children:t.jsx(Pt,{as:"button",color:"primary",onClick:()=>{const r=new Kt;he.logEvent("chatgpt_regenerate_due_to_error_button_clicked",void 0,Ye({clientThreadId:e})),s({id:o,eventMetadata:{eventSource:"mouse"},conversationMode:kt.getConversationMode(e),turnTracker:r})},className:"m-auto",icon:er,"data-testid":"regenerate-thread-error-button",children:t.jsx(F,{...Ba.regenerateResponse})})})]})}function fr({clientThreadId:e,currentModelId:s,isNewThread:n,onRequestCompletion:a,showPromptStarters:o,composerContainerRef:r,composerController:i,autocompletions:c,requiresFileUpload:u,onComposerInput:m,onComposerChange:d,onAutocompleteSelect:h,headerClassName:p,hideHeader:f,onTaggingDropdownClose:x,onTaggingDropdownOpen:g}){const S=Ze(e),y=Hs(e),E=fn(),{isUnauthenticated:w}=Ve(),C=uo(e)===mo.STREAMING,R=ho({clientThreadId:e,conversationLeafId:S}),j=ut(y),k=hi({clientThreadId:e}),N=!w,P=gi(),{isOpen:L,onClose:B}=jc({type:"just-hit-rate-limit"}),T=l.useCallback((W,H)=>{J.logEvent(Z.continueCompletion),a({type:va.Continue,promptId:W,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!1,completionMetadata:{conversationMode:kt.getConversationMode(e)},turnTracker:H})},[a,e]),A=go(),z=l.useCallback(async(W,H)=>Tc({clientThreadId:e,currentRequestId:H,isHistoryAndTrainingDisabled:P,queryClient:A}),[e,P,A]),_=l.useCallback(async({promptId:W,content:H,eventMetadata:K,completionMetadata:pe,messageMetadata:ae,prependMessages:_e,appendMessages:$,turnTracker:ie,profiler:Be,requestedModelId:re})=>{const Ae=Q.getThreadCurrentLeafId(e);Q.updateTree(e,de=>{de.addNode(W,H,Ae,He.User,void 0,ae)}),await a({type:va.Next,promptId:W,eventMetadata:K,cancelActiveRequests:!0,completionMetadata:pe,prependMessages:_e,appendMessages:$,turnTracker:ie,profiler:Be,...re?{requestedModelId:re}:{}})},[e,a]),G=pi(e,S),b=fi(e,S),q=!R&&(j||C),Y=l.useMemo(()=>q?!1:!G&&b,[G,b,q]),ee=q&&s!=="gpt-4-pbrowse",V=zs(e),fe=Oe(e),ce=as(fe).data,{promptStarters:X,isSuccess:ge}=xn(n&&!V,e,4),oe=To(),je=(()=>{if(oe?.messageId===Q.getTree(e).getLastValidNode(S)?.message?.id)return oe?.suggestions;if(o&&!V&&ge&&!N)return X})(),xe=Mc(),Te=xi(),Me=(()=>{if(ce?.gizmo.tags?.includes($n.WorkspaceDisabled)&&!Te)return"workspaceDisallowsGizmo";if(xe.size){if(E.displayingSideBySideFeedback&&E.unskippable)return"feedbackRequired"}else return"noModelsAvailable";const H=kt.getConversationMode(e);return H?.kind===dt.GizmoTest&&H.gizmo_id==null?"noTestGizmoId":null})(),Ce=po(e),ve=Us(e),De=Rn("15117983")?.value,ue=vi(),O=Gs(),D=ue.action==="moderate",{value:te}=Qe("1860647109");return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex justify-center",children:O&&D&&te?t.jsx(Cc,{}):null}),L?t.jsx(_c,{onClose:B}):null,De&&ve&&ve.kind===dt.PrimaryAssistant&&ve.plugin_ids&&ve.plugin_ids.length>0?t.jsx(Mh,{}):t.jsx(wh,{composerContainerRef:r,composerController:i,clientThreadId:e,onCreateNewCompletion:_,onAbortCompletion:z,onContinueGenerating:T,currentModelId:s,isNewThread:n,isCompletionInProgress:k,className:"w-full",canContinue:Y,suggestions:je??[],disabled:!!Me,disabledReason:Me??void 0,canPause:ee,isInteractableSharedThread:Ce,autocompletions:c,requiresFileUpload:u,onComposerInput:m,onComposerChange:d,onAutocompleteSelect:h,headerClassName:p,hideHeader:f,onTaggingDropdownClose:x,onTaggingDropdownOpen:g},e)]})}function Mh(){return t.jsxs("div",{className:"mx-auto flex max-w-md flex-col items-center justify-center gap-2 rounded-xl border border-token-border-light bg-token-main-surface-primary p-6 shadow-lg",children:[t.jsx("span",{className:"text-token-text-primary",children:t.jsx(F,{id:"PluginsDecrepatedNotice.pluginsDeprecationTitle",defaultMessage:"Conversations with plugins are archived"})}),t.jsx("span",{className:"text-token-text-secondary",children:t.jsx(F,{id:"PluginsDecrepatedNotice.pluginsDeprecationSubtitle",defaultMessage:"Explore GPT Store to find a replacement"})}),t.jsxs("a",{href:"https://chat.openai.com/gpts",className:"text-green-500 hover:cursor-pointer dark:text-green-400",children:[t.jsx(F,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLink",defaultMessage:"Explore GPTs"}),t.jsx("span",{className:"ml-2",children:t.jsx(F,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLinkArrow",defaultMessage:"→"})})]})]})}const Ba=Ue({errorGeneratingResponse:{id:"PromptTextarea.errorGeneratingResponse",defaultMessage:"There was an error generating a response"},regenerateResponse:{id:"PromptTextarea.regenerateResponse",defaultMessage:"Regenerate"}}),xr=l.memo(function(){return t.jsxs("div",{className:`flex flex-col gap-2 ${Is.PromptTextareaHeader}`,children:[t.jsx(mr,{}),t.jsx(hr,{})]})}),Ch=Object.freeze(Object.defineProperty({__proto__:null,ChatScreenComposerAlerts:xr},Symbol.toStringTag,{value:"Module"})),Fa=Ge(()=>We(()=>import("./kcpzm2dkvh9cepg8.js"),__vite__mapDeps([7,1,2,3,4,5,8,9,10,11,12,13,14])).then(e=>e.SnorlaxSplashScreen)),rn=4;function _h(e){const{layer:s}=Xe("3533083032"),{layer:n}=_t("3533083032"),{value:a,isLoading:o}=Qe("3006519778");return o||!a?!1:e?s.get("enable_new_homepage_anon",!1):n.get("enable_new_homepage_anon",!1)}function kh(){const{layer:e}=_t("4031588851"),s=e.get("autocomplete_qualified_start_date","2099-09-13T00:00:00Z"),n=On();return!!n&&n.created*1e3>=new Date(s).getTime()}function Eh(e){const{layer:s}=Xe("4031588851"),{layer:n}=_t("4031588851"),{value:a,isLoading:o}=Qe("633009675");return o||!a?!1:e?s.get("enable_new_autocomplete_homepage",!1):n.get("enable_new_autocomplete_homepage",!1)}const ln=e=>`${e.title}${e.body}`.toLocaleLowerCase();function vr(e){const s=Oe(e.clientThreadId),n=Un(s);return t.jsx(gr,{children:a=>n&&s&&Fa?t.jsx(Fa,{clientThreadId:e.clientThreadId,gizmoId:s,currentModelId:e.currentModelId,onRequestCompletion:e.onRequestCompletion,composerController:a}):t.jsx(Ih,{...e,composerController:a})})}function Nh({children:e,composerController:s}){const{store:n}=ye(),[a,o]=l.useState(!1);l.useEffect(()=>s.subscribe("focus",()=>{o(!0)}),[s]),l.useEffect(()=>s.subscribe("blur",()=>{o(!1)}),[s]);const i=!!n.useSharedProps()?.isShowingAutocomplete;return e(i&&a)}function Rh({isUnauthenticated:e,shouldShowLegacyStarterPrompts:s,legacyPromptStarters:n,isSendBlocked:a,clientThreadId:o}){return t.jsxs("div",{className:I(e?"justify-end lg:justify-center":"justify-center","flex h-full flex-shrink flex-col items-center overflow-y-hidden text-token-text-primary lg:hidden"),children:[t.jsx("div",{className:I(e&&"flex sm:items-center md:flex-1","flex-shrink-0"),children:t.jsx(es,{className:"mb-6 h-12 w-12"})}),s&&(n&&n.length>0?t.jsx(Lh,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},promptStarters:n,isSendBlocked:a,clientThreadId:o,isSquare:e}):t.jsx(Dd,{}))]})}function Ah({composerController:e,isSendBlocked:s,clientThreadId:n,isModelLoaded:a,headlineOption:o,enableNewMobileDesign:r,shouldShowStarterPrompts:i,promptChips:c,onSelectStarterPrompt:u,starterPromptExpanded:m,setStarterPromptExpanded:d}){return t.jsx(Nh,{composerController:e,children:h=>t.jsxs(ne.div,{initial:{opacity:0},animate:{opacity:h?0:1},exit:{opacity:0},transition:{duration:.1},className:I("justify-center",h?"pointer-events-none":"","mt-[var(--screen-optical-compact-offset-amount)] flex h-full flex-shrink flex-col items-center overflow-hidden text-token-text-primary lg:hidden"),children:[o==="CHATGPT_LOGO"?t.jsx(es,{className:"inline-block h-12 w-12"}):t.jsx(Sr,{headlineOption:o,isModelLoaded:a}),t.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:I(!r&&"lg:hidden",!m&&"h-[116px]"),children:i&&t.jsx(yr,{starterPrompts:c,onSelectStarterPrompt:u,disabled:s,clientThreadId:n,onExpand:()=>d(!0),mobileLayout:!0})})]})})}function Ph(e,s,n){const a=Qe("1468311859").value,o=Qe("3664702598").value,{layer:r}=Xe("4031588851"),i=kh(),c=e||s,u=c&&a,m=c&&o&&i;let d="HARDCODED";if(c)if(n){const h=r.get("search_autocomplete_mode","");u&&h&&(d=h)}else m&&(d=r.get("autocomplete_mode","HARDCODED"));return d}function Ih({clientThreadId:e,currentModelId:s,isModelLoaded:n,onRequestCompletion:a,composerController:o,v2HomepageDisclaimer:r}){const i=qt(e),c=zs(e),u=Nn(),[m,d]=l.useState([]),{trendingSuggestions:h,fetchTrendingSuggestions:p}=Hh(rn),f=l.useRef(!1),{isUnauthenticated:x}=Ve(),g=Rc(),[S,y]=l.useState(!1),E=Fn(),w=Je();zo(o);const v=Qe("589604007").value,{layer:C}=_t("4031588851"),{layer:R}=Xe("4031588851"),{layer:j}=_t("3533083032"),{layer:k}=Xe("3533083032"),{promptStarters:N,isSuccess:P}=xn(i&&!c&&n,e,8,v,!0,s??void 0),{promptStarters:L,isSuccess:B,isError:T}=xn(i&&!c&&n,e,4,void 0,void 0,s??void 0),A=g&&!!m.find(O=>!!O.requires_file_upload),z=l.useCallback(O=>{const D=o.getCurrentText();return D&&ln(O).startsWith(D.toLocaleLowerCase())},[o]),_=l.useCallback(O=>{const D=o.getCurrentText(),te=O.title+O.body;return z(O)?{...O,title:D,body:te.slice(D.length)}:{...O,title:te,body:""}},[o,z]),G=l.useCallback((O=!1)=>{d(D=>!D.some(z)&&D.length>0?[]:O?D:D.map(_))},[z,_]),b=(O,D,te)=>{const W=O.title;d([]),o.focus(),o.setText(W),requestAnimationFrame(()=>{const H=(N?.filter(K=>K.theme===O.theme)??[]).map(K=>{const pe=Tt(K.oneliner),ae=pe.startsWith(K.title);return{...K,title:ae?`${K.title} `:"",body:ae?K.body:pe,autocompletionChunks:fh(W,pe),type:Ds.Autocomplete}});d(H),H.length>0&&At(H,e),Pc(O,te,e)})};l.useEffect(()=>{const O=m.some(D=>D.theme===vn.Search);E&&o.getCurrentText()===""?h.length>0?d(h):p():O&&!E&&d(D=>D.filter(te=>te.theme!==vn.Search))},[m,E,h,p,o]);const q=N?.reduce((O,D)=>(D.theme&&!O[D.theme]&&(O[D.theme]=D),O),{}),Y=[];if(q)for(const O in q)Y.push(q[O]);const ee=Y&&Y.length>0,V=!!(P&&ee&&n),fe=!!((B||T)&&n),ce=rn-m.filter(z).length,X=x?k.get("enable_new_mobile",!1):R.get("enable_new_mobile",!1),ge=Ph(X,g,E),oe=x?j.get("headline_option","HELP_WITH"):C.get("headline_option","HELP_WITH"),je=C.get("autocomplete_min_char",4),xe=C.get("autocomplete_fetch_interval",200),Te=l.useRef(null),Me=l.useCallback(Uo(async O=>{const D=o.getCurrentText();if(!D||D.length<je||D.length>80||o.hasMultipleLines()){d([]);return}if(!f.current&&!(Te.current&&Te.current.length>je&&D.startsWith(Te.current)))try{const te=await Et.generateAutocompletions(D,O,E);if(te.completions.length===0){Te.current=D;return}const W=te.completions.map(H=>({id:Si(),type:Ds.Autocomplete,title:H.slice(0,D.length),body:H.slice(D.length),oneliner:H,prompt:H,source:ge})).filter(z).map(_);d(H=>{const K=H.filter(z),pe=W.filter(ae=>{const _e=ln(ae);return!K.some($=>{const ie=ln($);if(_e===ie)return!0;const Be=/[\p{P}\p{S}]$/u,re=_e.replace(Be,""),Ae=ie.replace(Be,"");return re===ie||_e===Ae||re===Ae})}).slice(0,rn-K.length);return[...K,...pe]}),W.length>0&&At(W,e)}catch{}},ge==="BING"?150:xe),[o,ge,_,xe]),Ce=l.useCallback(()=>{G(),ce>0&&Me(ce)},[Me,G,ce]);l.useEffect(()=>{f.current&&d([])},[f]);const ve=l.useMemo(()=>ge==="HARDCODED"?G:Ce,[ge,Ce,G]),De=l.useCallback(()=>{o instanceof os&&G(!0),o.getCurrentText().indexOf(`
`)>0&&d([])},[o,G]),ue=l.useCallback((O,D,te)=>{D.forEach(W=>{W.id===O.id&&(W.userInput=o.getCurrentText())}),d([D[te]])},[o]);return t.jsx(t.Fragment,{children:t.jsx(Nt,{children:t.jsx("div",{className:"h-full w-full lg:py-[18px]",children:t.jsx(Kn,{isStaticSharedThread:!1,withVerticalPadding:!1,withHorizontalPadding:!0,clientThreadId:e,fullHeight:!0,children:t.jsxs(Ma,{children:[t.jsx("div",{className:"mb-7 hidden text-center lg:block",children:oe==="CHATGPT_LOGO"?t.jsx(es,{className:"inline-block h-12 w-12"}):t.jsx(Sr,{headlineOption:oe,isModelLoaded:n})}),!X&&t.jsx(Rh,{isUnauthenticated:x,shouldShowLegacyStarterPrompts:fe,legacyPromptStarters:L,isSendBlocked:u,clientThreadId:e}),X&&t.jsx(Ah,{composerController:o,isModelLoaded:n,headlineOption:oe,enableNewMobileDesign:X,shouldShowStarterPrompts:V,promptChips:Y,onSelectStarterPrompt:b,starterPromptExpanded:S,setStarterPromptExpanded:y,isSendBlocked:u,clientThreadId:e}),t.jsx("div",{className:I("lg:w-full","lg:absolute lg:bottom-8 lg:left-0"),children:t.jsx(Ma,{children:w?t.jsx(xr,{}):t.jsx(dr,{className:"block"})})}),t.jsx("div",{className:"w-full",children:t.jsx(fr,{clientThreadId:e,isNewThread:i,currentModelId:s,onRequestCompletion:a,showPromptStarters:!1,composerController:o,autocompletions:m,requiresFileUpload:A,onComposerInput:ve,onComposerChange:De,onAutocompleteSelect:ue,onTaggingDropdownClose:()=>{f.current=!1},onTaggingDropdownOpen:()=>{f.current=!0},hideHeader:!0})}),t.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:I("hidden lg:block",r&&x&&S?"":"h-[70px]"),children:V&&t.jsx(yr,{starterPrompts:Y,onSelectStarterPrompt:b,disabled:u,clientThreadId:e,onExpand:()=>y(!0)})}),r&&t.jsx("div",{className:"w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px] lg:absolute lg:bottom-0 lg:left-0",children:t.jsx("div",{className:"min-h-4",children:r})})]})})})})})}function Sr({headlineOption:e,isModelLoaded:s}){const n=ze(),[a,o]=l.useState(0),[r,i]=l.useState(!0),c=20,u=n.formatMessage(Oh[e]||$t.whatCanIHelpWith);return l.useEffect(()=>{if(!s)return;let m;return a<u.length?m=setTimeout(()=>{o(a+1)},c):r&&(m=setTimeout(()=>{i(!1)},500)),()=>clearTimeout(m)},[u,a,r,s]),t.jsxs("div",{className:"relative inline-flex justify-center text-center text-2xl font-semibold leading-9",children:[t.jsx("h1",{children:u.substring(0,a)||"​"}),t.jsx("h1",{className:"result-streaming absolute left-full transition-opacity",style:{opacity:r?1:0},children:t.jsx("span",{})})]})}function br({label:e,onClick:s,disabled:n=!1,icon:a}){return t.jsxs("button",{className:"group relative flex h-[42px] items-center gap-1.5 rounded-full border border-token-border-light px-3 py-2 text-start text-[13px] shadow-xxs transition enabled:hover:bg-token-main-surface-secondary disabled:cursor-not-allowed xl:gap-2 xl:text-[14px]",disabled:n,onClick:s,children:[a,t.jsx("span",{className:"max-w-full select-none whitespace-nowrap text-gray-600 transition group-hover:text-token-text-primary dark:text-gray-500",children:e})]})}function Dh({starterPrompt:e,starterPrompts:s,index:n,disabled:a,onSelectStarterPrompt:o}){const r=e.theme??e.title,i=qs(),{mutate:c}=Ic(),u=e.category==="onboarding"?()=>{c({key:mt.hasUsedConversationalOnboardingStarterPrompt}),i(e,s,n)}:()=>o(e,s,n);return t.jsx(br,{disabled:a,onClick:u,icon:t.jsx(Dc,{starterPrompt:e,useV2Colors:!0}),label:r})}function La({clientThreadId:e,onClick:s}){l.useEffect(()=>{Bc(e)},[e]);const n=ze();return t.jsx(ne.div,{initial:{opacity:0,translateY:5},animate:{opacity:1,translateY:0},exit:{opacity:0,translateY:5},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:t.jsx(br,{onClick:()=>{Fc(e),s()},label:n.formatMessage($t.moreStarterPrompts)})})}const Bh=5,Fh=3;function yr({starterPrompts:e,onSelectStarterPrompt:s,disabled:n,clientThreadId:a,onExpand:o,mobileLayout:r=!1}){const i=r?Fh:Bh,[c,u]=l.useState(i),[m,d]=l.useState(i),[h,p]=l.useState(!1),f=l.useRef(null),x=e.length<=c;l.useEffect(()=>{At(e.slice(0,i),a)},[a]),l.useEffect(()=>{if(!h&&!x&&f.current){const S=f.current,y=S.getBoundingClientRect(),E=y.width,w=Array.from(S.children);let v=0;for(let C=0;C<w.length&&w[C].getBoundingClientRect().right-y.left<=E;C++)v++;u(v),d(v),p(!0)}},[e,x,h]);const g=()=>{const S=e.slice(c,e.length).map(y=>({...y,isAdditional:!0}));S.length>0&&At(S,a),u(e.length),o()};return t.jsxs("div",{className:I("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",h&&e.length>0?"opacity-100":"opacity-[0.01]",r?"flex-wrap":"flex-nowrap"),children:[t.jsxs("ul",{className:I("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",x||r?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:f,children:[e.slice(0,c).map((S,y)=>t.jsx(ne.li,{initial:{opacity:0,...y<m?{translateY:5}:{}},animate:{opacity:1,...y<m?{translateY:0}:{}},exit:{opacity:0,...y<m?{translateY:5}:{}},transition:{duration:.3,delay:y>=m?(y-m)*.06:0,ease:"easeOut"},children:t.jsx(Dh,{starterPrompt:S,starterPrompts:e,index:y,disabled:n,onSelectStarterPrompt:s})},S.id??y)),r&&e.length>c&&t.jsx(La,{clientThreadId:a,onClick:g})]}),!r&&e.length>c&&t.jsx(La,{clientThreadId:a,onClick:g})]})}function Lh({promptStarters:e,isSendBlocked:s,clientThreadId:n,isSquare:a,...o}){l.useEffect(()=>{At(e,n)},[n]);const r=qs();return t.jsx(t.Fragment,{children:a?t.jsx(ne.div,{...o,className:"mb-2 w-full flex-shrink overflow-y-hidden",children:t.jsx(Yt,{children:t.jsx(ar,{starterPrompts:e,onSelectStarterPrompt:r,disabled:s})})}):t.jsx(ne.div,{...o,className:"flex-shrink overflow-y-hidden",children:t.jsx(Bd,{starterPrompts:e,onSelectStarterPrompt:r,disabled:s,cssMobileDisplayLimit:2,marginOverride:"mt-6 lg:mt-12"})})})}const Hh=e=>{const[s,n]=l.useState([]),a=l.useCallback(async()=>{const r=(await Et.generateTrendingSuggestions(e)).suggestions.map((i,c)=>({type:Ds.Starter,title:Ha(i),body:"",icon:t.jsx(fd,{}),prompt:Ha(i),id:`starter-${c}`,theme:vn.Search}));n(r)},[e]);return{trendingSuggestions:s,fetchTrendingSuggestions:a}};function Ha(e){return e.split(" ").map(Ac).join(" ")}const $t=Ue({whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),Oh={HELP_WITH:$t.whatCanIHelpWith,WHERE_TO_START:$t.whereShouldWeStart,ASK_CHATGPT:$t.askChatgptAnything},zh=Ge(()=>We(()=>import("./ltznf2htv1wfodfi.js"),__vite__mapDeps([15,1,2,3,16,17,4,5,18,19,20,21,22,14,23,9,24,25,26,27,11,28,29,30,31])).then(e=>e.GizmoUsingAsOwnerNotice)),wr=({clientThreadId:e})=>{const s=qn(m=>m.activeStageSidebar),n=Q.getServerThreadId(e),a=Lc(ks.WorkspaceShareLinks),{isUnauthenticated:o}=Ve(),r=ns(),i=a&&n&&!o&&!r,c=Je(),u=!s&&!(c&&!o);return t.jsx("div",{className:I(!c&&"gap-2",c&&"@lg/screen-composer:gap-2","flex items-center pr-1 leading-[0]"),children:t.jsx(Vd,{showShareButton:i,showProfileDropdown:u,clientThreadId:e})})};function Uh({clientThreadId:e,gizmoId:s}){const n=Hc(),{data:a}=as(s),o=Os();return t.jsxs(t.Fragment,{children:[t.jsxs(Oc,{className:"max-md:hidden",children:[t.jsxs("div",{className:"absolute start-1/2 ltr:-translate-x-1/2 rtl:translate-x-1/2",children:[a!=null&&o?.isWorkspaceAccount()&&a.gizmo.tags?.includes($n.WorkspaceDisabled)&&t.jsx(zh,{gizmo:a}),t.jsx(zc,{gizmoId:s,clientThreadId:e})]}),t.jsx(Uc,{children:t.jsxs("div",{className:"flex items-center gap-0 overflow-hidden",children:[t.jsx(qd,{clientThreadId:e}),t.jsx(Go,{clientThreadId:e})]})}),t.jsx(wr,{clientThreadId:e})]}),n&&t.jsx(Gc,{})]})}function jr({clientThreadId:e}){const s=Oe(e),n=An(),a=Je();return n||a?null:t.jsx(Uh,{gizmoId:s,clientThreadId:e})}function Gh({clientThreadId:e,currentModelId:s,isModelLoaded:n,onRequestCompletion:a,enableV2Homepage:o,v2HomepageDisclaimer:r}){const i=ns();let c=t.jsx(Ld,{}),u;return i?(u=t.jsx(Wh,{}),c=t.jsx(es,{className:"mb-6 h-12 w-12"})):e!=null?(u=o?t.jsx(vr,{clientThreadId:e,currentModelId:s,isModelLoaded:n,onRequestCompletion:a,v2HomepageDisclaimer:r}):t.jsx(Hd,{clientThreadId:e}),c=null):u=t.jsx(Vh,{}),t.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-token-text-primary",children:[c,u]})}function Wh({gizmo:e}){const s=Vc(),n=e?qc(e.tools):!1,a=Os();return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-5 text-2xl font-semibold","data-testid":"temporary-chat-label",children:[t.jsx($c,{id:"temporary-chat-checkbox",name:"temporary-chat-checkbox",checked:!0}),t.jsx(F,{...it.temporaryChat})]}),t.jsxs("div",{className:"max-w-sm text-center text-sm font-normal text-token-text-tertiary",children:[t.jsx(F,{...a?.isWorkspaceAccount()?s?it.temporaryChatBizMemoryAvailable:it.temporaryChatBizMemoryUnavailable:s?it.temporaryChatDescriptionMemoryAvailable:it.temporaryChatDescriptionMemoryUnavailable}),n&&t.jsx("div",{className:"mt-3",children:t.jsx(F,{...it.temporaryChatDescriptionGptActions,values:{link:o=>t.jsx("a",{href:"https://help.openai.com/en/articles/8914046-temporary-chat-faq",target:"_blank",className:"underline",rel:"noreferrer",children:o})}})})]})]})}function Vh(){return t.jsx("div",{className:"mb-5 text-2xl font-semibold",children:t.jsx(F,{...it.howCanIHelpYouToday})})}function Tr({clientThreadId:e,currentModelId:s,isModelLoaded:n,onRequestCompletion:a,enableV2Homepage:o,v2HomepageDisclaimer:r}){const i=Oe(e),c=bi(),u=Nn(),{data:m}=as(i),d=Wc(),h=yi(()=>navigator.windowControlsOverlay);return(c!=null||i!=null)&&m==null?null:t.jsxs("div",{className:"relative h-full",children:[t.jsx("div",{className:h?.visible?I("absolute right-[calc(100dvw-env(titlebar-area-width,100dvw)-env(titlebar-area-x,0))]",d?"left-[env(titlebar-area-x,0)]":"left-0"):"absolute left-0 right-0",children:t.jsx(jr,{clientThreadId:e})}),m!=null?t.jsx(Fd,{gizmo:m,showStarterPrompts:!0,disableStarterPrompts:u}):t.jsx(Gh,{clientThreadId:e,currentModelId:s,isModelLoaded:n,onRequestCompletion:a,enableV2Homepage:o,v2HomepageDisclaimer:r})]})}const it=Ue({temporaryChat:{id:"GizmoLanding.temporaryChat",defaultMessage:"Temporary Chat"},temporaryChatBizMemoryAvailable:{id:"g1opBW",defaultMessage:"This chat won't appear in your history and won't use or create memories."},temporaryChatBizMemoryUnavailable:{id:"fQmbtG",defaultMessage:"This chat won't appear your conversation history."},temporaryChatDescriptionMemoryAvailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryAvailable",defaultMessage:"This chat won't appear in history, use or create memories, or be used to train our models. For safety purposes, we may keep a copy for up to 30 days."},temporaryChatDescriptionMemoryUnavailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryUnavailable",defaultMessage:"This chat won't appear in history or be used to train our models. For safety purposes, we may keep a copy of this chat for up to 30 days."},temporaryChatDescriptionGptActions:{id:"GizmoLanding.temporaryChatDescriptionGptActions",defaultMessage:"Any data shared with a third party through GPT actions are subject to the third party's privacy policy. <link>Learn more</link>"},howCanIHelpYouToday:{id:"GizmoLanding.howCanIHelpYouToday",defaultMessage:"How can I help you today?"}});function qh({className:e,clientThreadId:s,message:n,onModelSelect:a,onDropdownChange:o}){const r=ze(),[i,c]=l.useState(null),[u,m]=l.useState(!1),[d,h]=l.useState(!1),p=Kc(),f=Wo(s),x=Oe(s),g=Vo({clientThreadId:s,message:n}),S=n.message.metadata?.model_slug,{modelOptions:y,modelSlug:E,animateModelLabelOnRender:w,nuxProps:v,messageModelEnabledTools:C}=g,R=qo(n.message),j=C.includes(Vs.Search),k=l.useMemo(()=>y.find(_=>_.value==S),[y,S]),{doesUserHaveAnyAccountsWithPlusFeatures:N}=fo(),P=l.useRef(null),L=_=>{_||setTimeout(()=>{P.current&&P.current.blur()},10)};if(l.useEffect(()=>{L(u)},[u]),!p||x)return null;const B=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:r.formatMessage(Oa.search),icon:t.jsx(Qn,{className:"icon-sm"}),condition:j&&!R,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:r.formatMessage(Oa.nosearch),icon:t.jsx(tr,{className:"icon-sm"}),condition:j&&R,eventName:"chatgpt_regenerate_without_search_button_clicked"}];let T,A;v.shouldRenderNux?(T=Kh,A={title:t.jsx(F,{id:"g/+2Hh",defaultMessage:"Optimized your response"}),description:t.jsx(F,{id:"H0Flqm",defaultMessage:"Used {usedModelName} for a faster response that saves your limited {largestModelName} messages",values:{usedModelName:v.usedModelName,largestModelName:v.largestModelName}}),markAsViewed:v.announcement.markAsViewed}):(T=$h,A={label:f?t.jsx(F,{id:"LBYK9a",defaultMessage:"Change model"}):t.jsx(F,{id:"nygjPN",defaultMessage:"Used {modelName}",values:{modelName:v.usedModelName}})});const z=f&&y.some(_=>Jt(_,N));return t.jsxs(Re.Root,{onOpenChange:_=>{f&&(m(_),o(_),L(_)),_&&J.logEvent(Z.conversationOpenMessageModelSelector,{has_get_plus_button:z})},children:[t.jsx(T,{...A,children:t.jsx(xo,{ref:P,className:I("cursor-pointer",e),onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:t.jsx(Mr,{modelSlug:E,animateModelLabelOnRender:w,isDropdownOpen:u,isRegenerateEnabled:f,isHovered:d})})}),f&&t.jsxs(Re.Content,{className:"z-30 origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[y.map(_=>{const G=Jt(_,N),{value:b,...q}=_;return t.jsx(Mt,{value:b,onSelect:()=>{he.logEvent("chatgpt_regenerate_switch_model_button_clicked",b,{requestedModelId:b,...Ye({clientThreadId:s})}),a({requestedModelId:b})},onMouseEnter:()=>c(b),onMouseLeave:()=>c(null),isHovered:i===b,messageModelSlug:n.message.metadata?.model_slug,shouldShowUpsell:G,...q},b)}),!!k&&t.jsxs(t.Fragment,{children:[t.jsx(Re.Separator,{}),B.filter(_=>_.condition).map(_=>t.jsx(Mt,{onSelect:()=>{he.logEvent(_.eventName,k.value,{requestedModelId:k.value,...Ye({clientThreadId:s})}),a({requestedModelId:k.value,extraStreamParams:_.extraStreamParams})},includeRegenerate:!0,onMouseEnter:()=>c(_.key),onMouseLeave:()=>c(null),isHovered:i===_.key,messageModelSlug:S,includeCheck:!1,...k,label:_.label,subtitle:"",icon:_.icon},_.key))]})]})]})}function Mr({modelSlug:e,animateModelLabelOnRender:s,isDropdownOpen:n,isRegenerateEnabled:a,isHovered:o,isRegenLabel:r=!1,animateShortLabel:i,omitIcon:c}){const[u,m]=l.useState("initial"),{categories:d}=Yc({isRegen:!!r});l.useEffect(()=>{if(s){const y=setTimeout(()=>m("show"),500),E=setTimeout(()=>m("initial"),2e3);return()=>{clearTimeout(y),clearTimeout(E)}}m("initial")},[s]);const h=d.find(({defaultModel:y})=>y===e),p=e===Qc?{categoryId:"gpt_3.5",shorterLabel:"3.5"}:{},{categoryId:f,shorterLabel:x}=h??p,g={initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"100%"},visible:{opacity:1,paddingLeft:2,width:"100%",transition:{delay:0,duration:0}}},S=n?"visible":o?"show":u;return t.jsxs(ne.div,{initial:"initial",animate:S,className:"flex items-center pb-0",children:[!c&&(r?t.jsx(Zn,{className:"icon-md"}):f&&t.jsx(Xc,{type:"outline",categoryId:f,className:"icon-md h-4 w-4"})),(a||i)&&t.jsx(ne.span,{className:"overflow-hidden text-clip whitespace-nowrap text-sm",variants:g,transition:{type:"tween",duration:.18},children:x}),a&&t.jsx(xd,{className:I("icon-sm",{"text-token-text-quaternary":!o&&!r},{"text-token-text-secondary":o&&!r})})]})}function $h({children:e,label:s}){return t.jsx(ts,{label:s,sideOffset:0,children:e})}function Kh({children:e,title:s,description:n,markAsViewed:a}){return t.jsx(Hn,{announcementKey:mt.ModelSwitcherAutoDowngrade,show:!0,side:"bottom",sideOffset:-4,title:s,description:n,badge:"beta",onDismiss:a,dismissOnOutsideClick:!0,children:e})}function Jt(e,s){const{modelSwitcherDeny:n,subscriptionLevel:a}=e;return!!n&&n.reason===wi.RATE_LIMIT&&a===ji.PLUS&&!s}const Oa=Ue({search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),Yh=l.memo(qh),Cs="rounded-lg radix-disabled:pointer-events-auto radix-disabled:cursor-not-allowed";function Xh({className:e,clientThreadId:s,message:n,onModelSelect:a,onDropdownChange:o,canRegenerateResponse:r}){const[c,u]=l.useState(null),[m,d]=l.useState(!1),[h,p]=l.useState(!1),f=Oe(s),x=Vo({clientThreadId:s,message:n}),g=n.message.metadata?.model_slug,S=n.message.id,{modelOptions:y,modelSlug:E,animateModelLabelOnRender:w,messageModelEnabledTools:v}=x,C=qo(n.message),R=v.includes(Vs.Search),j=l.useMemo(()=>y.find(T=>T.value===g),[y,g]),k=l.useRef(null),{doesUserHaveAnyAccountsWithPlusFeatures:N}=fo(),P=T=>{T||setTimeout(()=>{k.current&&k.current.blur()},10)};if(l.useEffect(()=>{P(m)},[m]),Ti(s))return null;const B=r&&y.some(T=>Jt(T,N));return f?null:t.jsxs(Re.Root,{onOpenChange:T=>{r&&(d(T),o(T),P(T)),T&&J.logEvent(Z.conversationOpenMessageModelSelector,{has_get_plus_button:B,is_new_regen_dropdown:!0})},children:[r?t.jsx(Zh,{label:t.jsx(F,{id:"wDs5sz",defaultMessage:"Switch model"}),children:t.jsx(xo,{ref:k,className:I("cursor-pointer",e),onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:t.jsx(Mr,{modelSlug:E,animateModelLabelOnRender:w,isDropdownOpen:m,isRegenerateEnabled:r,isHovered:h,isRegenLabel:!0,omitIcon:!1})})}):null,r&&t.jsx(Re.Portal,{children:t.jsxs(Re.Content,{className:"z-30 min-w-fit origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[t.jsx(Re.Item,{disabled:!0,className:"pb-0 pt-2",children:t.jsx("span",{className:"text-token-text-secondary",children:t.jsx(F,{id:"bFLh5u",defaultMessage:"Switch model"})})}),t.jsx(Qh,{clientThreadId:s,messageId:S,onModelSelect:a,messageModelSlug:g,omitModelIcons:!0,modelOptions:y,setHoveredOption:u,hoveredOption:c,retryOption:j,lastResponseUsedSearch:C,modelSupportsSearch:R,doesUserHaveAnyAccountsWithPlusFeatures:N})]})})]})}function Qh({clientThreadId:e,messageId:s,modelOptions:n,messageModelSlug:a,onModelSelect:o,omitModelIcons:r,setHoveredOption:i,hoveredOption:c,retryOption:u,lastResponseUsedSearch:m,modelSupportsSearch:d,doesUserHaveAnyAccountsWithPlusFeatures:h}){const p=ze(),[f,x]=l.useMemo(()=>Zc(n,w=>w.subcategory),[n]),g=l.useMemo(()=>{const w=new Map;return f.forEach(v=>{const C=v.subcategory;C&&(w.has(C)||w.set(C,[]),w.get(C)?.push(v))}),w},[f]),S=I("icon-sm",r&&"order-10 ml-auto text-token-text-tertiary icon-md"),y=r?"right":"left",E=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:p.formatMessage(cn.search),icon:t.jsx(Qn,{className:S}),condition:d&&!m,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:p.formatMessage(cn.nosearch),icon:t.jsx(tr,{className:S}),condition:d&&m,eventName:"chatgpt_regenerate_without_search_button_clicked"}];return t.jsxs(t.Fragment,{children:[x.map(w=>{const{value:v,...C}=w;return t.jsx(Mt,{value:v,onSelect:()=>{he.logEvent("chatgpt_regenerate_switch_model_button_clicked",v,{requestedModelId:v,...Ye({clientThreadId:e,messageId:s})}),o({requestedModelId:v})},includeRegenerate:!1,onMouseEnter:()=>i(v),onMouseLeave:()=>i(null),isHovered:c===v,messageModelSlug:a,includeCheck:!1,shouldShowUpsell:Jt(w,h),className:Cs,...C,icon:r?t.jsx("span",{className:S}):C.icon,justifyIcon:y,wrapIcon:!r},v)}),[...g.entries()].map(([w,v])=>t.jsxs(Re.Sub,{children:[t.jsx(Re.SubMenuTrigger,{children:t.jsx("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:w})}),t.jsx(Re.Portal,{children:t.jsx(Re.SubContent,{className:"min-w-fit",children:v.map(C=>{const{value:R,...j}=C;return t.jsx(Mt,{value:R,onSelect:()=>{he.logEvent("chatgpt_regenerate_switch_model_button_clicked",R,{requestedModelId:R,...Ye({clientThreadId:e,messageId:s})}),o({requestedModelId:R})},includeRegenerate:!1,onMouseEnter:()=>i(R),onMouseLeave:()=>i(null),isHovered:c===R,messageModelSlug:a,includeCheck:!1,className:Cs,...j,icon:null,justifyIcon:y,wrapIcon:!r,shouldShowUpsell:Jt(C,h)},w+"-"+R)})})})]},w)),!!u&&t.jsxs(t.Fragment,{children:[t.jsx(Re.Separator,{}),t.jsx(Mt,{onSelect:()=>{he.logEvent("chatgpt_regenerate_try_again_button_clicked",u.value,{requestedModelId:u.value,...Ye({clientThreadId:e,messageId:s})}),o({requestedModelId:u.value})},includeRegenerate:!0,onMouseEnter:()=>i(u.value),onMouseLeave:()=>i(null),messageModelSlug:a,includeCheck:!1,className:Cs,...u,label:p.formatMessage(cn.tryAgain),subtitle:u.label,icon:t.jsx(Zn,{className:S}),justifyIcon:y,wrapIcon:!r},u.value),E.filter(w=>w.condition).map(w=>t.jsx(Mt,{onSelect:()=>{he.logEvent(w.eventName,u.value,{requestedModelId:u.value,...Ye({clientThreadId:e,messageId:s})}),o({requestedModelId:u.value,extraStreamParams:w.extraStreamParams})},includeRegenerate:!1,onMouseEnter:()=>i(w.key),onMouseLeave:()=>i(null),isHovered:c===w.key,messageModelSlug:a,includeCheck:!1,className:Cs,...u,label:w.label,subtitle:"",icon:w.icon,justifyIcon:y,wrapIcon:!r},w.key))]})]})}function Zh({children:e,label:s}){return t.jsx(ts,{label:s,sideOffset:0,children:e})}const cn=Ue({tryAgain:{id:"VbsBGW",defaultMessage:"Try again"},search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),Jh=l.memo(Xh),za=Ge(()=>We(()=>import("./m0ujq4si8sio1lz0.js").then(e=>e.pv),__vite__mapDeps([4,1,2,3,5])).then(e=>e.MemoryActionResult));function Ua(e,s,n){Q.updateTree(e,a=>{a.updateNodeMetadata(s,{inlineComparisonRating:n})})}function Ga(e){return{is_dark_mode:e==="dark",time_since_loaded:Math.floor(performance.now()/1e3),page_height:window?.innerHeight,page_width:window?.innerWidth,pixel_ratio:window?.devicePixelRatio,screen_height:window?.screen?.height,screen_width:window?.screen?.width}}const Wa=({messages:e})=>{for(const{message:{metadata:s}}of e){const{augmented_paragen_prompt_label:n}=s??{};if(n)return n}};function eg(e){const s=l.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null}),n=l.useRef({left:null,right:null});return e.stubSideBySideFeedback?t.jsx(Cr,{setPreferredFeedback:()=>{},leftVariantId:"left-placeholder",rightVariantId:"right-placeholder",leftTurn:null,rightTurn:null,originalTurn:null,hasActiveRequest:!0,visibilityStateRef:s,firstVisibleTokenTimestampsRef:n,...e}):t.jsx(tg,{...e,visibilityStateRef:s,firstVisibleTokenTimestampsRef:n})}function tg(e){const{clientThreadId:s,variantIds:n,variantsInStreamInfo:a,turnIndex:o,firstVisibleTokenTimestampsRef:r}=e;if(n.length!==2)throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");const i=na(),c=ng(),u=Pn(),{resolvedTheme:m}=Mi(),[d,h]=l.useMemo(()=>$o(n.join(""))()<.5?[0,1]:[1,0],[n[0],n[1]]),p=d<h?"left":"right",f=p==="left"?"right":"left",x=n[d],g=n[h],S=Tt(ba(s,x)).id,y=Tt(ba(s,g)).id,E=Tt(gn(s,o,S)),w=Tt(gn(s,o,y)),v=p==="left"?E:w,C=p==="left"?w:E,R=a.display_treatment==="unskippable",j=i?"skippable_parallel_2_in_stream:a:2.0":"skippable_parallel_2_in_stream:a:1.5";l.useEffect(()=>(fn.setState({displayingSideBySideFeedback:!0,unskippable:R}),()=>{fn.setState({displayingSideBySideFeedback:!1,unskippable:!1})}),[R]),Jc();const k=l.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null});l.useEffect(()=>Ci(_i,{requestCompletion:()=>{const P=$e(v.messages)?.completionSampleFinishTime,L=$e(C.messages)?.completionSampleFinishTime,B=Q.getServerThreadId(s);if(c){const A=Q.getTree(s).getParentPromptNode(S),z=[E,w].map((b,q)=>({messageId:b.messages[b.messages.length-1].message.id,loadFirstTokenTime:q===0?r.current.left:r.current.right,loadEndTime:$e(b.messages)?.completionSampleFinishTime})),_={},G=A.metadata?.variantsInStreamInfo==null&&A.message.metadata?.paragen_variants_info!=null;for(const b of z)_[b.messageId]=G?{load_first_token_time:e.conversationTurnMountTime,load_end_time:e.conversationTurnMountTime}:{load_first_token_time:b.loadFirstTokenTime,load_end_time:b.loadEndTime};_s({shouldUseNewParagenEndpoint:c,params:{conversation_id:B,displayed_message_ids:z.map(b=>b.messageId),message_metadatas:_,rating:"skipped",selected_message_id:null,source_timestamp:Date.now(),ui_variant:i?2:1,user_prompt_message_id:A.message.id}})}else _s({shouldUseNewParagenEndpoint:c,params:{feedback_version:j,original_message_id:v.messages[v.messages.length-1]?.message.id,new_message_id:C.messages[C.messages.length-1]?.message.id,conversation_id:B,completion_comparison_rating:"skip",new_completion_placement:f,feedback_start_time:e.conversationTurnMountTime,compare_step_start_time:e.conversationTurnMountTime,original_completion_load_start_time:e.conversationTurnMountTime,original_completion_load_end_time:P??0,new_completion_load_start_time:e.conversationTurnMountTime,new_completion_load_end_time:L??0,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:Ga(m),...k.current}})}}),[E,w,S,s,e.conversationTurnMountTime,j,f,v?.messages,C?.messages,m,c,i,r]);const N=P=>{const B=Q.getTree(s).getLeafFromNode(P);Q.setThreadCurrentLeafId(s,B.id);const T=P===x,A=T===(p==="left"),z=$e(v.messages)?.completionSampleFinishTime,_=$e(C.messages)?.completionSampleFinishTime;v.messages.length>0&&Ua(s,v.messages[v.messages.length-1].nodeId,A?"original":"new"),C.messages.length>0&&Ua(s,C.messages[C.messages.length-1].nodeId,A?"original":"new");let G;z==null||_==null?G=A?"partial_load_comparison_original":"partial_load_comparison_new":G=A?"original":"new";const b=Q.getServerThreadId(s);if(c){const q=[E,w].map((X,ge)=>({messageId:X.messages[X.messages.length-1].message.id,loadFirstTokenTime:ge===0?r.current.left:r.current.right,loadEndTime:$e(X.messages)?.completionSampleFinishTime})),Y=T?q[0].messageId:q[1].messageId,V=Q.getTree(s).getParentPromptNode(S),fe={},ce=V.metadata?.variantsInStreamInfo==null&&V.message.metadata?.paragen_variants_info!=null;for(const X of q)fe[X.messageId]=ce?{load_first_token_time:e.conversationTurnMountTime,load_end_time:e.conversationTurnMountTime}:{load_first_token_time:X.loadFirstTokenTime,load_end_time:X.loadEndTime};_s({shouldUseNewParagenEndpoint:c,params:{conversation_id:b,displayed_message_ids:q.map(X=>X.messageId),message_metadatas:fe,rating:"selected",selected_message_id:Y,source_timestamp:Date.now(),ui_variant:i?2:1,user_prompt_message_id:V.message.id}})}else _s({shouldUseNewParagenEndpoint:c,params:{feedback_version:j,original_message_id:v.messages[v.messages.length-1]?.message.id,new_message_id:C.messages[C.messages.length-1]?.message.id,conversation_id:b,completion_comparison_rating:G,new_completion_placement:f,feedback_start_time:e.conversationTurnMountTime,compare_step_start_time:e.conversationTurnMountTime,original_completion_load_start_time:e.conversationTurnMountTime,original_completion_load_end_time:z??null,new_completion_load_start_time:e.conversationTurnMountTime,new_completion_load_end_time:_??null,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:Ga(m),...k.current}})};return t.jsx(Cr,{...e,setPreferredFeedback:N,leftVariantId:x,rightVariantId:g,leftTurn:E,rightTurn:w,hasActiveRequest:u,originalTurn:v,visibilityStateRef:k})}function sg(e){if(!e.length)return!1;const s=e.filter(n=>n.type===_a.Text||n.type===_a.MultiText).filter(n=>n.message.message.status!=="finished_successfully"&&n.message.message.metadata?.snorkle_status!==void 0);return s.length>0&&s.every(n=>{const a=n.message.message.content;return a?.content_type===vo.Text&&a.parts.join("")===""})}function Cr({setPreferredFeedback:e,leftVariantId:s,rightVariantId:n,leftTurn:a,rightTurn:o,hasActiveRequest:r,originalTurn:i,visibilityStateRef:c,...u}){const{defaultParagenLabel:m,shouldShowParagenLabels:d=!1}=Ro(),h=a&&Wa(a)||m,p=o&&Wa(o)||m,f=l.useMemo(()=>a?.messages??[],[a?.messages]),x=l.useMemo(()=>o?.messages??[],[o?.messages]),{avatarClassName:g,firstVisibleTokenTimestampsRef:S}=u,y=l.useMemo(()=>Fs(f),[f]),E=l.useMemo(()=>Fs(x),[x]),w=yo(),[v,C]=l.useMemo(()=>[y,E].map(q=>sg(q)),[y,E]),R=ut(a?As.getRequestIdFromConversationTurn(a):"")||v,j=ut(o?As.getRequestIdFromConversationTurn(o):"")||C,k=a?.role===He.User,N=o?.role===He.User,P=l.useRef(null),L=l.useRef(null),B=l.useRef(null),T=u.stubSideBySideFeedback||v,A=u.stubSideBySideFeedback||C;!T&&S.current.left==null&&(S.current.left=Date.now()),!A&&S.current.right==null&&(S.current.right=Date.now()),l.useEffect(()=>{if(P.current&&L.current&&B.current){const q=Array(11).fill(0).map((ee,V)=>V/10),Y=new IntersectionObserver(ee=>ee.forEach(V=>{V.target===L.current?(c.current.left_visibility_initial==null&&(c.current.left_visibility_initial=V.intersectionRatio),c.current.left_visibility_max=Math.max(c.current.left_visibility_max??0,V.intersectionRatio)):V.target===B.current&&(c.current.right_visibility_initial==null&&(c.current.right_visibility_initial=V.intersectionRatio),c.current.right_visibility_max=Math.max(c.current.right_visibility_max??0,V.intersectionRatio))}),{root:P.current,threshold:q});return Y.observe(L.current),Y.observe(B.current),()=>Y.disconnect()}},[c]);const{data:z}=wo(void 0,!1,w),_=na(),G=t.jsx("div",{className:"text-pretty px-6 pb-5 pt-1 text-center text-sm text-token-text-secondary",children:t.jsx(F,{id:"TK934w",defaultMessage:"Which response do you prefer? Responses may take a moment to load."})}),b=Je();return t.jsxs("div",{className:"relative flex flex-col",children:[t.jsxs("div",{className:I("sticky z-[1] text-pretty bg-token-main-surface-primary px-6 text-center text-lg",b&&"top-[var(--thread-leading-height)] pt-3",!b&&"top-[-1px]",_&&!b?"md:top-header-height":b?"":"md:static"),"data-testid":"paragen-feedback-title",children:[t.jsx(F,{id:"JgCHDY",defaultMessage:"You’re giving feedback on a new version of ChatGPT."}),_?G:null]}),_?null:G,t.jsx("div",{className:"relative -mb-2 snap-x snap-mandatory overflow-x-auto px-3 pb-4 md:px-5 lg:px-10",ref:P,children:t.jsx("div",{className:I(!b&&"min-w-fit"),children:t.jsxs("div",{className:I("mx-auto flex max-w-6xl items-start",_&&!b&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",!_&&!b&&"gap-4 sm:gap-6",_&&b&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",b&&!_&&"gap-4 sm:gap-6"),children:[t.jsxs(Va,{horizontalScrollContainerRef:P,rootElementRef:L,onClick:()=>{e(s)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:T,children:[t.jsxs(Ka,{children:[t.jsx(Sn,{messages:f,isUserTurn:k,avatarClassName:g}),t.jsx($a,{children:d?t.jsx("span",{className:"font-bold text-token-text-primary",children:h}):t.jsx(F,{...Xa.responseNumber,values:{responseIndex:1}})})]}),_&&T?t.jsx(qa,{}):t.jsxs(t.Fragment,{children:[z!=null&&!k&&t.jsx(za,{clientThreadId:u.clientThreadId,messages:f,isParagen:!0}),t.jsx(wn,{...u,groupedMessagesToRender:y,allGroupedMessages:y,isEditing:!1,isUserTurn:k,isCompletionRequestInProgress:R,hasActiveRequest:r,handleEnterEdit:ys,handleExitEdit:ys,shouldGrowContainer:!1}),t.jsx(Ya,{clientThreadId:u.clientThreadId,conversationTurnMountTime:u.conversationTurnMountTime,turn:a,originalTurn:i})]})]}),t.jsxs(Va,{horizontalScrollContainerRef:P,rootElementRef:B,onClick:()=>{e(n)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:A,children:[t.jsxs(Ka,{children:[t.jsx(Sn,{messages:x,isUserTurn:N,avatarClassName:g}),t.jsx($a,{children:d?t.jsx("span",{className:"font-bold text-token-text-primary",children:p}):t.jsx(F,{...Xa.responseNumber,values:{responseIndex:2}})})]}),_&&A?t.jsx(qa,{}):t.jsxs(t.Fragment,{children:[z!=null&&!N&&t.jsx(za,{clientThreadId:u.clientThreadId,messages:x,isParagen:!0}),t.jsx(wn,{...u,groupedMessagesToRender:E,allGroupedMessages:E,isEditing:!1,isUserTurn:N,isCompletionRequestInProgress:j,hasActiveRequest:r,handleEnterEdit:ys,handleExitEdit:ys,shouldGrowContainer:!1}),t.jsx(Ya,{clientThreadId:u.clientThreadId,conversationTurnMountTime:u.conversationTurnMountTime,turn:o,originalTurn:i})]})]})]})})})]})}function Va({horizontalScrollContainerRef:e,rootElementRef:s,onClick:n,children:a,hasActiveRequest:o,isWaitingOnFirstUserVisibleToken:r}){const i=na(),c=Je(),{scrollX:u}=eu({layoutEffect:!1,container:e,target:s}),m=tu(),d=su(),h=l.useRef(null),p=l.useRef(null),f=l.useRef(null),[x,g]=l.useState(!1),[S,y]=l.useState(!1),[E,w]=l.useState(!1),[v,C]=l.useState(0);l.useEffect(()=>{if(!i)return;const B=new IntersectionObserver(T=>{for(const A of T)A.target===h.current?g(A.isIntersecting):A.target===f.current?w(A.isIntersecting):A.target===p.current&&y(A.isIntersecting)},{root:m?.current,rootMargin:c?`0px 0px -${v}px 0px`:void 0});return h.current&&p.current&&f.current&&(B.observe(h.current),B.observe(p.current),B.observe(f.current)),()=>{B.disconnect()}},[v,i,c,m]);const R=!E&&(S||x),j=nu(u,B=>R?-1*B:0),k=Ca(0);l.useEffect(()=>{if(!i)return;const B=new ResizeObserver(T=>{ws(T.length===1,"entryList.length === 1");const A=T[0];ws(A.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),k.set(A.contentBoxSize[0].inlineSize)});return s.current&&B.observe(s.current),()=>{B.disconnect()}},[i,k,s]);const N=Ca(0);l.useEffect(()=>{if(!i)return;const B=new ResizeObserver(T=>{ws(T.length===1,"entryList.length === 1");const A=T[0];ws(A.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),N.set(A.contentBoxSize[0].blockSize+16),C(A.contentBoxSize[0].blockSize)});return d.current&&B.observe(d.current),()=>{B.disconnect()}},[i,N,d]);const P=t.jsx(Pt,{className:i?"px-5":"mt-4 self-start",onClick:n,"data-testid":"paragen-prefer-response-button",children:t.jsx(F,{id:"U2EAH6",defaultMessage:"I prefer this response"})}),L=r;return t.jsxs("div",{"data-paragen-root":!0,className:I("relative flex w-full min-w-[min(450px,80vw)] snap-center flex-col gap-1 text-left",c&&i&&"pl-3 pr-5 sm:w-[calc(100cqw-62px)] sm:pl-3 sm:pr-5 md:px-10",!c&&i&&"px-10",i?"min-h-60 py-4":"rounded-2xl border border-token-main-surface-tertiary bg-white p-5 dark:bg-gray-700"),ref:s,children:[t.jsx("div",{className:I("absolute left-0 right-0 top-48 h-px","invisible"),ref:h}),t.jsx("div",{className:I("absolute bottom-0 left-0 right-0 top-48","invisible"),ref:p}),t.jsx("div",{className:I("absolute bottom-0 left-0 right-0 h-px","invisible"),ref:f}),a,i?t.jsx("div",{className:"flex-1"}):null,i?t.jsx("div",{className:"mt-4 min-h-10",children:L?null:t.jsx(ne.div,{style:{translateX:j,width:k,bottom:N},animate:{opacity:100},initial:{opacity:0},transition:{ease:"easeOut",duration:.2,delay:.5},className:I({fixed:R,"z-20 flex w-full justify-center":!0}),children:P})}):o?null:P]})}function qa(){return t.jsxs("div",{className:"flex w-full flex-col gap-4 pb-5 pt-3",children:[t.jsx(rt,{className:"h-4 w-[75%]"}),t.jsx(rt,{className:"h-4 w-[50%]"}),t.jsx(rt,{className:"h-4 w-[80%]"}),t.jsx(rt,{className:"h-4 w-[55%]"}),t.jsx(rt,{className:"h-4 w-[66%]"}),t.jsx(rt,{className:"h-4 w-[64%]"}),t.jsx(rt,{className:"h-4 w-[48%]"})]})}function na(){const{layer:e}=Xe("3119715334");return e.get("should-enable-hojicha",!1)}const $a=be.div`text-sm text-token-text-secondary font-semibold`,Ka=be.div`flex gap-4 items-center mb-1`,rt=be.div`animate-pulse rounded-[4px] bg-token-main-surface-tertiary`;function Ya({clientThreadId:e,conversationTurnMountTime:s,turn:n,originalTurn:a}){const o=Vn();if(!o.showParagenMetadata||!o.showDebugConversationTurns&&!o.forceParagen||n==null)return null;let r=n===a?"ORIGINAL":"NEW";const i=n.messages[n.messages.length-1],c=i?.message?.metadata?.__internal;if(c){const{model_id:h,model_definition_slug:p,model_definition_virtual_model_id:f,alternative_model_selection_rule:x,augmented_paragen_prompt_group_id:g,augmented_paragen_prompt_id:S,augmented_paragen_prompt:y}=c;h&&(r+=`
Model ID: ${h}`),p&&(r+=`
Model Slug: ${p}`),f&&(r+=`
Virtual Model ID: ${f}`),x&&(r+=`
Alternative Model Rule: ${x}`),g&&(r+=`
Prompt Group ID: ${g}`),S&&(r+=`
Prompt ID: ${S}`),y&&(r+=`
Prompt: ${y}`)}r+=`
Message ID: ${i.message.id}`;const m=Q.getTree(e).getParentPromptNode(n.variantIds[0]),d=m.metadata?.variantsInStreamInfo==null&&m.message.metadata?.paragen_variants_info!=null;return r+=`
User prompt message ID: ${m.message.id}`,r+=`
Is Persisted Paragen? ${d}`,r+=`
Completion Sample Finish Time: ${d?`${s} (persisted)`:$e(n.messages)?.completionSampleFinishTime}`,t.jsx("div",{className:"whitespace-pre-wrap text-sm text-red-500",children:r})}async function _s({shouldUseNewParagenEndpoint:e,params:s}){e?await Et.submitParagenSelectionV2(s):await Et.submitMessageComparisonFeedback(s)}function ng(){const{value:e}=Qe("3894844102");return e}const Xa=Ue({responseNumber:{id:"ConversationTurnTwoUpFeedback.responseNumber",defaultMessage:"Response {responseIndex, number}"}}),Qa=[1,2,3,4,10,20,30],ag=.5;function og({clientThreadId:e,conversationLeafId:s}){const n=Ko(Yo.isBusinessWorkspace),a=l.useRef(!1),o=ss(e),r=Us(e),{isUnauthenticated:i}=Ve(),c=l.useMemo(()=>{if(!o)return-1;const N=$o(o);return N()>ag?-1:Qa[Math.floor(N()*Qa.length)]},[o]),u=ki(e,s),m=u[u.length-1],d=l.useMemo(()=>As.getRequestIdFromConversationTurn(m),[m]),h=ut(d),[p,f]=l.useState(null),[x,g]=l.useState(!1),[S,y]=l.useState(!1),[E,w]=l.useState(!1),v=N=>{const P=$e(u)?.messages[0]?.message.id;f(N),j(P,N)},C=u.filter(N=>N.role===He.Assistant).length,R=m?.role===He.Assistant,j=l.useMemo(()=>Uo((N,P)=>{o&&N&&Et.submitConversationRating({conversation_id:o,message_id:N,rating:P,shown_at_assistant_turn:c}),J.logEvent(Z.conversationRatingSubmitted,{rating:P,showAtAssistantTurn:c,conversationId:o}),g(!0),setTimeout(()=>{y(!0)},1500)},2e3),[o,c]),k=C!==c||h||!R||!!n||r?.kind!==dt.PrimaryAssistant||E||i;return l.useEffect(()=>{!k&&!a.current&&(J.logEvent(Z.conversationRatingShown,{showAtAssistantTurn:c,conversationId:o}),a.current=!0)},[k]),E||k?null:t.jsxs("div",{className:"mx-auto",children:[t.jsx(Nt,{children:x&&!S&&t.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:t.jsx(Za,{$padded:!0,children:t.jsx("span",{className:"text-sm text-token-text-tertiary",children:t.jsx(F,{id:"rating.thanks",defaultMessage:"Thanks for your feedback!"})})})},"submitted")}),!x&&t.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},children:t.jsxs(Za,{$padded:!1,children:[t.jsxs("div",{className:"flex items-center justify-center gap-4 px-4 py-3 text-sm text-token-text-secondary",children:[t.jsx(F,{id:"rating.instructions",defaultMessage:"Is this conversation helpful so far?"}),t.jsxs("div",{className:"flex items-center gap-5",children:[t.jsx(un,{$selected:p==="thumbsUp",onClick:()=>v("thumbsUp"),children:t.jsx(sr,{className:"icon-md"})}),t.jsx(un,{$selected:p==="thumbsDown",onClick:()=>v("thumbsDown"),children:t.jsx(nr,{className:"icon-md"})})]})]}),t.jsx("div",{className:"w-px flex-1 self-stretch bg-token-main-surface-tertiary"}),t.jsx(un,{className:"p-3",$selected:!1,onClick:()=>w(!0),children:t.jsx(vd,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})})]})},"rating")]})}const un=be.button`
  ${e=>e.$selected?"text-token-text-primary":"text-token-text-secondary"}
  hover:text-token-text-primary
`,Za=be.div`inline-flex rounded-xl border border-gray-100 dark:border-gray-700
${e=>e.$padded&&"py-3 px-4"}
`,rg=Ge(()=>We(()=>import("./dcgn0igpgzt1fhca.js"),__vite__mapDeps([32,1,2,3,4,5,33,9])));function ig({clientThreadId:e,conversationLeafId:s,canShowInlineMessageFeedback:n,messageForRating:a,allGroupedMessages:o,currentModelId:r}){let i=null;const c=Ei(e,s),u=ss(e),m=qn(p=>p.voiceFeedbackThread),d=u===m,{voiceName:h}=au();return c?null:(d&&u?(Ni.feedbackShown.success({voice:h}),i=t.jsx("div",{className:"text-center",children:t.jsx(ou,{serverThreadId:u})})):a.rating&&n?i=t.jsx(rg,{clientThreadId:e,conversationMessage:a,allGroupedMessages:o,currentModelId:r}):i=t.jsx("div",{className:"text-center",children:t.jsx(og,{clientThreadId:e,conversationLeafId:s})}),t.jsx("div",{className:"mt-3 w-full empty:hidden",children:i}))}const lg=Ge(()=>We(()=>import("./g5l6bv0jupdyz5on.js"),__vite__mapDeps([34,1,2,3,4,5,35])).then(e=>e.VoicePlayButton)),Ja=128,eo={minHeight:"calc(100cqh - var(--thread-leading-height) - var(--thread-trailing-height) - var(--previous-turn-min-height))"};function cg(e){const{turnIndex:s,conversationLeafId:n,isFinalTurn:a,clientThreadId:o,onChangeItemInView:r,onChangeRating:i,currentModelId:c,avatarClassName:u,showAvatar:m=!0,scrollToMessageId:d,shouldShowDateHeader:h}=e,p=ze(),f=On(),x=!!f&&Ai(f),g=An(),S=Ko(Yo.isBusinessWorkspace),y=lo(),{value:E}=Qe("2848981774"),w=Q.getServerThreadId(o),v=Tt(gn(o,s,n)),{messages:C,variantIds:R,variantsInStreamInfo:j}=v,k=Fs(C),N=ru();let P=C[C.length-1];for(const U of k){const me=Id(U);if(me.some(at=>N.has(at.message.id))){P=me[me.length-1];break}}const L=C.slice(0,C.indexOf(P)+1),B=Oo(),[T,A]=l.useState(!1),[z,_]=l.useState(!1),G=R.findIndex(U=>L.some(me=>me.nodeId===U)),b=v.role===He.User,q=ns(),Y=Oe(o),ee=as(v.gizmoId??Y)?.data,V=Yn(c),fe=iu(c),ce=Je(),X=Us(o,ee?.gizmo.id),oe=uo(o)===mo.STREAMING,je=!1,{value:xe}=Rn("2291672486"),Te=L.some(U=>U.message.content.content_type===vo.MultimodalText),{layer:Me}=Xe("1547743984"),Ce=w&&B&&Me.get("show_share_button_inline",!1),{isUnauthenticated:ve}=Ve(),[De,ue]=l.useState(!1),[O,D]=l.useState(!1),te=v.messages.map(U=>U.message.id),W=l.useRef(null),H=C[C.length-1],K=H.rating,pe=(d?.length??0)>2&&d!=="finalAgentTurn"&&a&&E&&ce,ae=()=>{L.length===1&&(J.logEvent(Z.editPrompt,{id:L[0].message.id,threadId:Q.getServerThreadId(o)}),he.logEvent("chatgpt_edit_prompt"),A(!0))},_e=l.useCallback(()=>{A(!1)},[]),$=l.useCallback(U=>{lu(o,s,y,U)},[o,s,y]),ie=U=>{i({nodeId:H.nodeId,messageId:H.message.id,rating:U}),J.logEvent(U==="thumbsDown"?Z.messageFeedbackThumbsDownClicked:Z.messageFeedbackThumbsUpClicked,{id:H.message.id,threadId:Q.getServerThreadId(o),model:c,rating:U}),_(!0)},[Be]=l.useState(()=>Date.now()),re=l.useMemo(()=>As.getRequestIdFromConversationTurn(v),[v]),Ae=ho({clientThreadId:o,conversationLeafId:n}),de=ut(re)&&!Ae,rs=Pn(),Ks=Fs(L),gt=l.useRef(!1);l.useEffect(()=>{if(gt.current||d===void 0||!E||!ce||!W.current){d==="finalAgentTurn"&&a&&gt.current&&Q.updateScrollToMessageId(o,void 0);return}(te.includes(d)||d==="finalAgentTurn"&&a)&&(gt.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(W.current)if(d==="finalAgentTurn"&&a)W.current.scrollIntoView({behavior:"instant",block:"end"}),Q.updateScrollToMessageId(o,void 0);else{const U=W.current.offsetHeight;let me;U>Ja?me=Ja-U:me=0,W.current.style.scrollMarginTop=`calc(${me}px + 2px + var(--thread-leading-height))`,W.current.scrollIntoView({behavior:"smooth"})}})}))},[d,W.current]);const{showDebugConversationTurns:et}=Vn(),Dt=po(o),we=Wo(o),tt=cu({clientThreadId:o,conversationMode:X}),Ys=Ze(o),st=l.useCallback(({requestedModelId:U,systemMessage:me,juice:at,extraStreamParams:xs})=>{const wt=new Kt;tt({id:H.nodeId,eventMetadata:{eventSource:"mouse"},turnTracker:wt,requestedModelId:U,systemMessage:me,juice:at,extraStreamParams:xs})},[H,tt]),Bt=je,Ft=!g&&!Dt&&!q&&!b,Lt=uu(),pt=P.message.author.role===He.Assistant?P.message:null;du({isCompletionRequestInProgress:de,isUserTurn:b,message:pt});const is=Pi(o,R),{isOpen:ls}=mu(),Pe=hu(X),Ht=!Lt&&!Pe&&Ft&&a&&j?.num_variants_in_stream===2&&!H.inlineComparisonRating&&!is,Xs=gu(v),ft=Ht,cs=Ht&&!Xs,xt=!b&&!g&&!Dt&&!Pe&&!oe&&!de&&!ls,vt=xt&&(!S||Bt||fe||x)&&!Pe&&!ve&&!q,qe=!g&&!((de||oe)&&a)&&R.length>1&&!T&&!ft;let Ot=!1;if(b&&L.length===1){const{shouldHideContent:U}=pu(L[0]);U&&(Ot=!0)}const us=b&&!Pe&&!g&&!Te&&L.length===1&&!Ot&&!T&&!ve,St=U=>{r(R[U]),J.logEvent(Z.changeNode,{intent:"toggle_between"})};if(!fu(v,L,et)&&!ft)return pe?t.jsx("div",{style:eo}):null;const zt=L.some(({message:U})=>Ii.getAssetPointers(U).length>0),Qs=!zt&&a&&we&&!xe?t.jsx(js,{onClick:()=>{he.logEvent("chatgpt_regenerate_try_again_button_clicked",c,{requestedModelId:c,...Ye({clientThreadId:o,turnIndex:s})});const U=new Kt;tt({id:Ys,eventMetadata:{eventSource:"mouse"},turnTracker:U}),Ps()},icon:Zn,label:p.formatMessage({id:"ConversationTurn.regenerateTooltip",defaultMessage:"Regenerate"}),testId:"regenerate-turn-action-button"}):null,ms="h-[30px] rounded-md px-1 text-token-text-secondary hover:bg-token-main-surface-secondary",hs=!zt&&xe?t.jsx(Jh,{className:ms,clientThreadId:o,message:H,onModelSelect:st,onDropdownChange:ue,canRegenerateResponse:we}):null,gs=!b&&!Ot&&(!a||!de)?t.jsx(Mu,{onClick:$}):null,bt=!b&&(!a||!de)&&(H.disclaimers??[]).length===0&&H.nodeId?t.jsx(lg,{conversationId:o,message:H,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-xs text-token-text-tertiary hover:text-token-text-primary"}):null,Zs=!b&&H&&(!a||!de)?t.jsx(Cu,{message:H,isFinalTurn:a,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-token-text-tertiary hover:text-token-text-primary"}):null,Js=vt&&!de?t.jsxs("div",{className:"flex",children:[K!=="thumbsDown"&&t.jsx(js,{onClick:()=>ie("thumbsUp"),disabled:K==="thumbsUp",icon:K==="thumbsUp"?Sd:sr,label:p.formatMessage({id:"ConversationTurn.goodResponseTooltip",defaultMessage:"Good response"}),testId:"good-response-turn-action-button"},`thumbsUp:${H.nodeId}`),K!=="thumbsUp"&&t.jsx(js,{onClick:()=>ie("thumbsDown"),disabled:K==="thumbsDown",icon:K==="thumbsDown"?bd:nr,label:p.formatMessage({id:"ConversationTurn.badResponseTooltip",defaultMessage:"Bad response"}),testId:"bad-response-turn-action-button"},`thumbsDown:${H.nodeId}`)]}):null,ps=Ce&&t.jsx(js,{onClick:()=>{Bs.openSharingModal(w)},label:p.formatMessage({id:"ConversationTurn.shareButtonTooltip",defaultMessage:"Share conversation"}),className:"sm:hidden",icon:yd}),fs=!xe&&t.jsx(Yh,{className:ms,clientThreadId:o,message:H,onModelSelect:st,onDropdownChange:ue});function nt(U){return ce?U:t.jsx(Kn,{clientThreadId:o,isStaticSharedThread:g,withVerticalPadding:!0,withHorizontalPadding:!ft,children:U})}function yt(U){return ce?U:t.jsx(Yt,{children:U})}return t.jsxs(t.Fragment,{children:[h&&t.jsx(xu,{turn:v}),t.jsxs("article",{className:I("w-full scroll-mb-[var(--thread-trailing-height,150px)] text-token-text-primary focus-visible:outline-2 focus-visible:outline-offset-[-4px]",d==="finalAgentTurn"&&E&&ce?"opacity-0":""),style:pe?eo:void 0,ref:W,dir:"auto","data-testid":`conversation-turn-${s}`,"data-scroll-anchor":a,onMouseEnter:()=>D(!0),onMouseLeave:()=>D(!1),children:[t.jsx(vu,{role:v.role}),nt(t.jsx(t.Fragment,{children:ft?t.jsx(eg,{isFeedbackEnabled:vt,variantIds:R,variantsInStreamInfo:j,conversationTurnMountTime:Be,stubSideBySideFeedback:cs,...e}):yt(t.jsxs(t.Fragment,{children:[!b&&m&&t.jsx(ug,{children:t.jsx(Sn,{messages:L,isUserTurn:b,avatarClassName:u,gizmo:ee})}),t.jsx("div",{className:I("group/conversation-turn relative flex w-full min-w-0 flex-col",!b&&Su),children:t.jsx("div",{className:"flex-col gap-1 md:gap-3",children:t.jsxs(t.Fragment,{children:[!b&&!g&&t.jsx(bu,{messages:L,clientThreadId:o,gizmoId:ee?.gizmo.id}),!1,t.jsx(wn,{groupedMessagesToRender:Ks,allGroupedMessages:k,...e,isEditing:T,isUserTurn:b,isCompletionRequestInProgress:de,isFeedbackEnabled:vt,isFinalTurn:a,hasActiveRequest:rs,showEditButton:us,handleEnterEdit:ae,handleExitEdit:_e}),V&&t.jsx("div",{className:"mb-4",children:t.jsx(yu,{messages:L})}),(xt||qe)&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:I("mb-2 flex gap-3 empty:hidden",b?"mr-1 flex-row-reverse":"-ml-2"),children:t.jsx(wu,{alwaysShow:a,showInline:a||qe,isHovered:O||De,pagination:qe&&t.jsx(ju,{showInline:a||qe,currentPage:G,onChangeIndex:St,length:R.length,className:I("self-center",R.length>1?"visible":"!invisible")}),actions:xt&&t.jsxs(t.Fragment,{children:[bt,gs,Qs,Js,Zs,fs,ps,hs]})})}),xt&&!de?t.jsx("div",{className:"pr-2 lg:pr-0",children:t.jsx(Tu,{message:H,isFinalTurn:a})}):null,a&&!de&&t.jsx(ig,{canShowInlineMessageFeedback:z,clientThreadId:o,conversationLeafId:n,messageForRating:H,allGroupedMessages:k,currentModelId:c})]})]})})})]}))}))]})]})}const kn=Ri.memo(cg),ug=be.div`flex-shrink-0 flex flex-col relative items-end`;function dg({onChangeItemInView:e,onRequestMoreCompletions:s,onChangeRating:n,onRequestCompletion:a,clientThreadId:o,conversationLeafId:r,hideHeader:i}){const c=ye(),u=Gs(),m=_u(),[d]=ku(),h=Eu(),[p]=Nu(),f=Us(o),x=Os(),g=Ru(o),S=Di(o),y=c.store.useContentAreaDimensions(Rt.Header,b=>b?.height?b.height:void 0),E=c.store.useIsHeaderContentAreaPopulated(),w=So(o),{isArchived:v}=w,C=Au(g.id),R=f?.kind===dt.GizmoMagicCreate?"bg-token-main-surface-primary text-token-text-primary":C,j=Ws(o,r),k=Pu(),[N,P]=l.useState(0),[L,B]=l.useState(!1);l.useEffect(()=>{u&&(N===0?P(j):!L&&j>N&&(B(!0),he.logEvent("chatgpt_continue_conversation_first_message_sent"),J.logEvent(Z.continueConversationFirstMessageSent)))},[j,N,L,u]),l.useEffect(()=>{u&&(he.logEvent("chatgpt_continue_conversation_page_loaded"),J.logEvent(Z.continueConversationPageLoaded))},[u]);const T=l.useCallback(()=>{m({behavior:"smooth"})},[m]),A=Iu(o),z=k&&!v,_=Xo(o,r),G=(b,q,Y)=>[...new Array(q-b).keys()].map(ee=>{const V=ee+b;return t.jsx(kn,{isFinalTurn:Y(V),turnIndex:V,clientThreadId:o,conversationLeafId:r,onChangeItemInView:e,onChangeRating:n,onRequestMoreCompletions:s,onRequestCompletion:a,currentModelId:g.id,avatarClassName:R,scrollToBottom:T,shouldShowDateHeader:_(V)},V)});return t.jsxs("div",{onCopy:A,className:I("flex flex-col text-sm",z&&"pb-[120px]",y||z?null:"md:pb-9"),style:{paddingBottom:z?void 0:y},children:[!i&&x?.data&&t.jsx(jr,{clientThreadId:o}),u&&t.jsxs(t.Fragment,{children:[t.jsx(Yt,{children:t.jsx("p",{className:"text-xs text-gray-500",children:t.jsx(F,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),j-N===0&&t.jsx("div",{className:"text-center text-xs font-semibold text-token-text-primary",children:t.jsx("button",{onClick:()=>{Bs.openModal(Du.ReportConversation),he.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),J.logEvent(Z.sharedConversationReportContentClicked,{location:"Dynamic Shared Thread Page"})},children:t.jsx(F,{id:"thread.reportSharedConversation",defaultMessage:"Report content"})})}),G(0,N,b=>b===N-1),t.jsx(Yt,{children:t.jsxs("p",{className:"flex items-center text-xs text-gray-500",children:[t.jsx(wd,{className:"icon-xs mr-2"}),t.jsx(F,{id:"threadLayout.sharedConversationPrivateDisclaimer",defaultMessage:"Messages beyond this point are only visible to you"})]})}),G(N,j,b=>b===j-1)]}),!u&&G(0,j,b=>b===j-1),S&&d&&!p&&t.jsx(to,{className:I("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{he.logEvent("chatgpt_thread_scroll_to_top"),h({behavior:"smooth"})},children:t.jsx(jd,{className:"icon-md text-token-text-primary"})}),!d&&t.jsx(to,{className:I(y?null:"bottom-5",z?E?"translate-y-[-50px]":"translate-y-[-10px]":""),style:{bottom:k?"calc(var(--composer-bar_footer-current-height) + var(--composer-bar_current-height))":y},onClick:()=>{he.logEvent("chatgpt_thread_scroll_to_bottom"),m({behavior:"smooth"})},children:t.jsx(Td,{className:"icon-md text-token-text-primary"})})]})}const to=be.button`cursor-pointer absolute z-10 rounded-full bg-clip-padding border text-token-text-secondary border-token-border-light right-1/2 translate-x-1/2 bg-token-main-surface-primary w-8 h-8 flex items-center justify-center`,mg=60,hg=({children:e,scrollViewClassName:s,scrollAnchorTopOffset:n=0})=>{const a=l.useRef(null);return t.jsx("div",{className:"h-full",ref:a,children:t.jsx(Dn,{children:t.jsx(_d,{className:"h-full",followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:s,scroller:()=>gg(a,n)?0:1/0,children:e})})})},gg=(e,s)=>{const n=pg(e.current);if(n==null)return!1;const a=n>s,o=n<s-mg;return!a&&!o};function pg(e){if(!e)return null;const s=e.querySelector('[data-scroll-anchor="true"]');if(!s)return null;const n=s.getBoundingClientRect().top,a=e.getBoundingClientRect().top;return n-a}const fg=Ge(()=>We(()=>import("./dn4wahbewcmhdzq3.js"),__vite__mapDeps([36,1,2,3,4,5,37,38,39,40,35,41])).then(e=>e.OpenDebugSidebarButton)),xg=Ge(()=>We(()=>import("./hnqxft4u5zrx5v2z.js"),__vite__mapDeps([42,1,2,3,4,5,43,9]))),so=Ue({doNotShareSensitive:{id:"thread.modal.onboarding.title",defaultMessage:"Do not share sensitive materials with this application"},somethingWentWrong:{id:"thread.modal.unrecoverableError.title",defaultMessage:"Something went wrong"},tryAgainLater:{id:"thread.modal.unrecoverableError.description",defaultMessage:"We're sorry, but something went wrong. Please try again later."},resetThread:{id:"thread.modal.unrecoverableError.resetThread",defaultMessage:"Reset thread"},sharedConversationReportConversation:{id:"thread.sharedConversation.report",defaultMessage:"Report conversation"},latencyButton:{id:"thread.latencyButton",defaultMessage:"Latency"},archivedConversationDescription:{id:"thread.archivedConversationDescription",defaultMessage:"This conversation is archived. To continue, please unarchive it first."},unarchiveButton:{id:"thread.unarchiveButton",defaultMessage:"Unarchive"}});function vg({clientThreadId:e}){const s=go(),n=ss(e),a=async()=>{n&&(await Et.patchConversation(n,{is_archived:!1}),s.invalidateQueries({queryKey:["conversation",e]}),In.setState(o=>{const r=o.threads[n];r!=null&&(r.initialThreadData.isArchived=!1)}),Zu(s))};return t.jsxs("div",{className:"my-6 flex flex-col items-center justify-center gap-4",children:[t.jsx("div",{className:"px-3 text-center text-sm text-token-text-secondary",children:t.jsx(F,{...so.archivedConversationDescription})}),t.jsx("div",{children:t.jsx(Pt,{disabled:!n,onClick:a,icon:Md,children:t.jsx(F,{...so.unarchiveButton})})})]})}const Dg=function({clientThreadId:e,onCompletionFinished:s,onCreate:n,preRequestCompletion:a,hideHeader:o,hideMessages:r,hideFooter:i,hideToolsOverlay:c,messagesVerticalAlign:u="top",prependThreadChildren:m,renderEmptyState:d,prefetchSearch:h}){const p=co(),f=zn(e),x=zs(e),g=Ze(e),y=So(e).isArchived;l.useEffect(()=>{x||(qt(e)?hn.addTiming("chatgpt.web.chatPage.renderNewConversation"):hn.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[e,x]);const E=bo(e,g),w=Ws(e,g),{setTargetedContent:v}=Wn(),C=p?.includes(Bi),R=Bu(),j=w>=2;Gn(j);const k=qt(e)&&!j&&Es(f),N=qt(e)&&!E&&(Es(f)||f?.kind===dt.GizmoTest),L=Lo().id,B=Fi(e),T=B??L,A=!!B,z=Yn(T),G=Fo()[T],b=Fu(e,f),q=Bo();Qo(w,e,g),l.useEffect(()=>{q||v(void 0)},[e,v,q,g]);const{caModal:Y,onRequestCompletion:ee,onChangeItemInView:V,onChangeRating:fe,onRequestMoreCompletions:ce}=Lu({clientThreadId:e,currentModelId:T,defaultModelId:L,onCompletionFinished:s,onThreadCreated:n,preRequestCompletion:a}),{isUnauthenticated:X,isLoading:ge}=Ve(),oe=Zo({clientThreadId:e,currentLeafId:g,handleRequestCompletion:ee,prefetchSearchPromise:h});Hu({clientThreadId:e,currentModelId:T});const je=ie=>t.jsx(hg,{scrollAnchorTopOffset:o?0:Qu,children:u==="bottom"?t.jsxs("div",{className:"flex h-full flex-col",children:[t.jsx("div",{className:"flex-1"}),ie]}):ie});l.useEffect(()=>{document.title=b??"ChatGPT"},[b]);const xe=Oe(e),Te=ns(),Me=Li(),Ce=N&&!Me&&!d&&!xe&&!z&&!Te,ve=Ce&&!ge&&X,De=Ce&&!ge&&!X,ue=_h(ve),O=Eh(De),D=ve&&ue||De&&O,te=Gs(),W=Ou(),{reset:H,streamingContext:K,StreamingProvider:pe}=zu();l.useEffect(()=>{W&&(K.setOnResetContext=()=>{H()})},[W,H,K]);const ae=l.useRef(null),_e=l.useRef(null),$=l.useMemo(()=>({threadContentScrollContainerElementRef:ae,footerRootContainerElementRef:_e}),[]);return t.jsx(Uu,{clientThreadId:e,currentLeafId:g,children:t.jsxs(pe,{value:K,children:[C&&t.jsx(xg,{}),t.jsx(Gu,{children:b!=null&&t.jsx("title",{children:b})}),t.jsx(Hi.Provider,{value:ee,children:t.jsxs(Wu,{children:[t.jsxs(Vu,{clientThreadId:e,currentModelConfig:G,className:"composer-parent flex h-full flex-col focus-visible:outline-0",children:[!r&&t.jsx(qu,{value:$,children:t.jsx(Sg,{ref:ae,children:!x&&!oe?N?d??t.jsx(Tr,{clientThreadId:e,currentModelId:T,isModelLoaded:A,onRequestCompletion:ee,enableV2Homepage:D,v2HomepageDisclaimer:D&&t.jsx(Xt,{clientThreadId:e})}):j?je(t.jsxs(t.Fragment,{children:[m,t.jsx(dg,{onChangeItemInView:V,onRequestMoreCompletions:ce,onChangeRating:fe,onRequestCompletion:ee,clientThreadId:e,conversationLeafId:g,hideHeader:o},e)]})):null:null})}),t.jsx(bg,{ref:_e,children:y?t.jsx(vg,{clientThreadId:e}):t.jsxs("div",{children:[!D&&t.jsx(pr,{clientThreadId:e,isNewThread:k,showPromptStarters:k||!E,currentModelId:T,onRequestCompletion:ee}),!i&&t.jsx("div",{className:"relative w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",children:Es(f)&&!D&&t.jsx("div",{className:"min-h-4",children:t.jsx(Xt,{clientThreadId:e})})})]})})]}),!c&&t.jsxs("div",{className:"group absolute bottom-2 end-2 z-20 flex flex-col gap-1 md:flex lg:bottom-3 lg:end-3",children:[R?t.jsxs(t.Fragment,{children:[t.jsx(fg,{}),!1]}):null,t.jsx($u,{})]}),Y,t.jsx(Ku,{clientThreadId:e,isStaticSharedThread:!1,isDynamicSharedThread:te}),t.jsx(Yu,{}),t.jsx(Xu,{conversationId:e,currentModelId:T,isActiveWindow:!Me})]})})]})})},Sg=be.div`grow flex-1 overflow-hidden`,bg=be.div`md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent w-full`;function yg({clientThreadId:e,currentModelId:s,isModelLoaded:n,onRequestCompletion:a,v2HomepageDisclaimer:o}){return t.jsx(vr,{clientThreadId:e,currentModelId:s,isModelLoaded:n,onRequestCompletion:a,v2HomepageDisclaimer:o})}const wg=Ge(()=>We(()=>import("./nix9ztxp0gekqab0.js"),__vite__mapDeps([44,1,2,3,45,4,5])).then(e=>e.ChatScreenContentModals));function jg({disableEmptyState:e,fullWidth:s,renderEmptyState:n}){const{clientThreadId:a,currentModelId:o,conversationLeafId:r,isCompanionWindow:i,isEmbeddedInFocusedView:c,onChangeItemInView:u,onChangeRating:m,onRequestCompletion:d,onRequestMoreCompletions:h,isModelLoaded:p,prefetchSearch:f}=l.useContext(Xn),x=Ws(a,r),g=Oi(a),S={clientThreadId:a,conversationLeafId:r,currentModelId:o,onChangeItemInView:u,onChangeRating:m,onRequestMoreCompletions:h,onRequestCompletion:d,showAvatar:!1},y=zs(a),E=Zo({clientThreadId:a,currentLeafId:r,handleRequestCompletion:d,prefetchSearchPromise:f}),w=y||E||e,v=Gs(),{initialConversationTurns:C,continuedConversationTurns:R}=Ju(x,v),{canUseNewHomepage:j,showEmptyState:k}=ed({clientThreadId:a,currentLeafId:r}),N=x>=2;Gn(N);const{setTargetedContent:P}=Wn(),L=Yn(o);Qo(x,a,r),l.useEffect(()=>{c||P(void 0)},[a,P,c]);const B=Xo(a,r);if(k){if(n!=null)return n();if(j&&!w){const T=i?null:t.jsx("div",{className:"text-center text-xs text-token-text-secondary",children:t.jsx(Xt,{clientThreadId:a})});return t.jsx(yg,{clientThreadId:a,currentModelId:o,isModelLoaded:p,onRequestCompletion:d,v2HomepageDisclaimer:T})}else if(!j&&!w)return t.jsx(Tr,{clientThreadId:a,currentModelId:o,isModelLoaded:p,onRequestCompletion:d,enableV2Homepage:!L,v2HomepageDisclaimer:t.jsx(Xt,{clientThreadId:a})})}return t.jsxs(t.Fragment,{children:[v&&t.jsx(td,{}),v&&R.length===0&&t.jsx(sd,{}),t.jsx(Dn,{children:t.jsxs(l.Suspense,{fallback:null,children:[t.jsx(nd,{}),C.length>0&&t.jsx("ol",{className:Ne.conversationTurnList,children:C.map(({turnIndex:T,isFinalTurn:A})=>t.jsx("li",{className:I(Ne.conversationTurnWrapper,s&&"w-full"),children:l.createElement(kn,{...S,key:`${a}-${T}`,turnIndex:T,isFinalTurn:A,scrollToMessageId:g,shouldShowDateHeader:B(T)})},T))}),v&&t.jsx(ad,{}),t.jsx("ol",{className:Ne.conversationTurnList,children:R.map(({turnIndex:T,isFinalTurn:A})=>t.jsx("li",{className:I(Ne.conversationTurnWrapper,s&&"w-full"),children:l.createElement(kn,{...S,key:`${a}-${T}`,turnIndex:T,isFinalTurn:A,scrollToMessageId:g,shouldShowDateHeader:B(T)})},T))})]})}),t.jsx(wg,{}),x>0&&t.jsx(od,{})]})}function Bg({renderEmptyState:e}){return t.jsx(jg,{renderEmptyState:e})}const Tg=Ge(()=>We(()=>Promise.resolve().then(()=>Ch),void 0).then(e=>e.ChatScreenComposerAlerts));function Fg(){const{clientThreadId:e,currentModelId:s,isCompanionWindow:n,onRequestCompletion:a}=l.useContext(Xn),o=zn(e),r=Ze(e),c=Ws(e,r)>=2,u=bo(e,r),m=qt(e)&&!c&&Es(o),{setComposerFooterElement:d}=l.useContext(rd);return t.jsx("div",{className:Ne.footer,children:t.jsxs(id,{style:{"--bar-gap":"0.5rem","--bar-background-color":"transparent"},children:[t.jsxs(bn,{type:"secondary",className:"relative",children:[c&&t.jsx(ld,{className:Ne.scrollButton}),t.jsx(Tg,{})]}),t.jsxs(bn,{type:"primary",ref:d,name:"composer-bar",className:"bottom-[var(--screen-keyboard-bottom,env(keyboard-inset-bottom,0px))]",children:[t.jsx(pr,{clientThreadId:e,currentModelId:s,isNewThread:m,noWrap:!0,onRequestCompletion:a,showPromptStarters:m||!u}),!n&&t.jsx("div",{className:"text-center text-xs text-token-text-secondary",children:t.jsx(Xt,{clientThreadId:e})})]})]})})}function Lg(){const e=ze(),{clientThreadId:s,isLoggedInUser:n,onNewThread:a}=l.useContext(Xn),o=Oe(s),r=Un(o);return t.jsxs(bn,{leading:!0,type:"primary",className:Ne.header,children:[t.jsxs("div",{className:Ne.headerLeading,children:[n&&t.jsx(cd,{}),!r&&t.jsx(ts,{label:e.formatMessage(no.newChat),className:"hidden @lg/thread:inline-flex",children:t.jsx(zi,{to:"/",className:Ne.newThread,onClick:i=>{a?(i.preventDefault(),a()):he.logEvent("chatgpt_web_thread_tap_new_thread")},tabIndex:0,children:t.jsx(ud,{className:I(Ne.sidebarIcon),icon:t.jsx(Cd,{}),tabIndex:-1,label:e.formatMessage(no.newChat),style:{viewTransitionName:"var(--vt_new_chat_thread)"}})})}),t.jsx("div",{className:Ne.threadDropdown,children:t.jsx(Go,{clientThreadId:s})})]}),t.jsx("div",{className:Ne.headerTrailing,children:t.jsx(Dn,{children:t.jsx(wr,{clientThreadId:s})})})]})}const no=Ue({newChat:{id:"rnCpM4",defaultMessage:"New Chat"}});export{Lg as C,fr as P,Dg as T,hg as W,Fg as a,Bg as b,kn as c};
//# sourceMappingURL=jxguh64ess8asey2.js.map
