const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/krbfy44r7lxwctx8.js","assets/d4y2abq31gz7lub8.js","assets/njkpu8a6d0voyh5h.js","assets/root-vof5cayc.css"])))=>i.map(i=>d[i]);
import{u as U,R,H as v,E as w,F as A,a7 as k,N as C,cm as G,c2 as z,r as j,j as e,K as d,aQ as X,bt as I,O as Z,as as J,X as Y,el as ee,c as se}from"./d4y2abq31gz7lub8.js";import{D as f,B as te}from"./itnbit061g3sd3m8.js";import{b9 as E,ba as W,aA as n,bc as T,be as _,n as ae,bf as ne,eH as re,B as ie,ck as oe,U as S,b3 as le}from"./nxzpvtytuf2lbwz0.js";import{c as ce}from"./iej0cupg2dqkmejt.js";import{a8 as N,g as de,B as ue}from"./njkpu8a6d0voyh5h.js";import{A as me}from"./g80yj7iqql1db505.js";import{a as ge,b as xe}from"./gvbbitmzu8ep9390.js";import{A as D,W as F,u as fe,U as pe}from"./gwpstx4zxwot3617.js";import{u as ve}from"./g09cyb02uy91x8ri.js";import"./o2nnoq641ojxkv85.js";import"./ofr0gppwtt4q6qhe.js";import"./fc825x24btr83sfd.js";import"./fkkpocemzbohdb19.js";import"./cx2xnz8su40decr8.js";import"./lc6bmcdf670ik4nl.js";import"./h278gd6if8gzfbmh.js";import"./iym48c2ngl915g6q.js";import"./g89ott43fohnxa22.js";import"./g5qxkfl3syrrnvic.js";import"./fgsoniec7zm7tn0o.js";import"./fmz3ub4golfh3lap.js";import"./cd3drq4i13b6f20s.js";import"./kz7dp10wr3lol4vw.js";const M=25;function je(s,a,t){return U({queryKey:["workspace",s,"invites",a,t],queryFn:async()=>await R.getWorkspaceInvites(s,a,M,t)})}function he(s,a,t){return U({queryKey:["workspace",s,"invites","requests",a,t],queryFn:async()=>await R.getWorkspaceInviteRequests(s,a,M,t)})}function H(s){const a=v(),t=w();return A({mutationFn:({inviteId:o,role:l,acceptRequest:i})=>R.patchWorkspaceInvite(s,o,{role:l,acceptRequest:i}).catch(r=>{k.danger(a.formatMessage(P.updateInviteError,{error:r.message}))}),onSuccess:()=>{t.invalidateQueries({queryKey:["workspace",s,"invites"]}),t.invalidateQueries({queryKey:["workspace",s,"invites","requests"]}),t.invalidateQueries({queryKey:["workspace",s]})}})}function B(s){const a=v(),t=w();return A({mutationFn:({email:o})=>R.deleteWorkspaceInvite(s,o).catch(l=>{k.danger(a.formatMessage(P.deleteInviteError,{email:o,error:l.message}))}),onSuccess:()=>{t.invalidateQueries({queryKey:["workspace",s,"invites"]}),t.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}function Me(s){const a=v(),t=w();return A({mutationFn:({role:o,email:l})=>R.addWorkspaceUsers(s,[l],o,!0).then(({account_invites:i,errored_emails:r})=>{if(r.length>0)throw new Error(r[0].error);i.length>0&&k.success(a.formatMessage(P.resendInviteSuccess,{email:l}))}).catch(i=>{k.danger(a.formatMessage(P.resendInviteError,{email:l,error:i.message}))}),onSuccess:()=>{t.invalidateQueries({queryKey:["workspace",s,"invites"]}),t.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}const P=C({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to update invite from workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}}),be=G(()=>z(()=>import("./krbfy44r7lxwctx8.js"),__vite__mapDeps([0,1,2,3])).then(s=>s.DirectorySyncResourceManagedIndication));function ye({workspaceId:s,filterInputValue:a}){const[t,o]=j.useState(0),l=E(s),i=W(s),r=l||i,{data:c}=je(s,t*M,a);if(c===void 0)return e.jsx(D,{});const u=c.items,m=Math.ceil((c.total??0)/M);return t>=m&&m!==0&&o(Math.max(m-1,0)),e.jsxs("div",{children:[e.jsxs(n.Root,{fixed:!0,size:"normal",children:[e.jsxs(n.Header,{children:[e.jsx(n.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(d,{...y.email})}),e.jsx(n.HeaderCell,{className:"w-28 bg-token-main-surface-primary",children:e.jsx("span",{className:r?"pl-3":"",children:e.jsx(d,{...y.role})})}),r&&e.jsx(n.HeaderCell,{className:"w-16 bg-token-main-surface-primary"})]}),e.jsxs(n.Body,{children:[u.map(g=>e.jsx(Ie,{workspaceId:s,invite:g,isCurrentUserOwner:l,currentUserHasAdminRights:r},g.id)),u.length===0&&e.jsx(n.Row,{children:e.jsx(n.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(d,{...y.noResults})})})})]})]}),m>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(T,{currentPage:t,onChangeIndex:o,length:m})})]})}function Ie({workspaceId:s,invite:a,isCurrentUserOwner:t,currentUserHasAdminRights:o}){const l=_(),i=H(s),r=B(s),c=Me(s),{value:u}=X("3999712942");return e.jsxs(n.Row,{disabled:i.isPending||r.isPending||r.isSuccess||c.isPending,children:[e.jsx(n.Cell,{children:e.jsxs("span",{className:"flex flex-grow justify-between",children:[e.jsx("span",{children:a.email_address}),u&&a.is_scim_managed&&e.jsx(be,{})]})}),e.jsx(n.Cell,{children:t?e.jsx(F,{currentRole:a.role,onUpdateUserRole:m=>{i.mutate({inviteId:a.id,role:m})}}):l[a.role]}),o&&e.jsx(e.Fragment,{children:e.jsx(n.Cell,{children:e.jsx(Re,{onDeleteUser:()=>{r.mutate({email:a.email_address??""})},onResendInvite:()=>{c.mutate({email:a.email_address??"",role:a.role??""})},disabled:a.is_scim_managed})})})]})}function Re({onDeleteUser:s,onResendInvite:a,disabled:t}){const o=v();return e.jsx(e.Fragment,{children:t?e.jsx(f.Root,{children:e.jsx(f.Trigger,{disabled:!0,children:e.jsx(ae,{sideOffset:0,label:o.formatMessage(ne.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(N,{className:"icon-sm"})})})}):e.jsxs(f.Root,{children:[e.jsx(f.Trigger,{children:e.jsx(N,{className:"icon-sm"})}),e.jsx(f.Portal,{children:e.jsxs(f.Content,{children:[e.jsx(f.Item,{onClick:a,children:e.jsx(d,{...y.resendInvite})}),e.jsx(f.Item,{onClick:s,children:e.jsx(d,{...y.revokeInvite})})]})})]})})}const y=C({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Role"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}});function ke({workspaceId:s,filterInputValue:a}){const[t,o]=j.useState(0),{data:l}=he(s,t*M,a),i=E(s),r=W(s),c=v(),u=i||r;if(l===void 0)return e.jsx(D,{});const m=l.items,g=Math.ceil(l.total/M);return t>=g&&g!==0&&o(Math.max(g-1,0)),e.jsxs("div",{children:[e.jsxs(n.Root,{fixed:!0,size:"normal",children:[e.jsxs(n.Header,{children:[e.jsx(n.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(d,{...h.email})}),e.jsx(n.HeaderCell,{className:"w-28 bg-token-main-surface-primary",children:e.jsx("span",{className:u?"pl-3":"",children:e.jsx(d,{...h.role})})}),u&&e.jsx(n.HeaderCell,{className:"w-40 bg-token-main-surface-primary",children:c.formatMessage(h.actions)})]}),e.jsxs(n.Body,{children:[m.map(b=>e.jsx(Pe,{workspaceId:s,invite:b,isCurrentUserOwner:i,currentUserHasAdminRights:u},b.id)),m.length===0&&e.jsx(n.Row,{children:e.jsx(n.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(d,{...h.noResults})})})})]})]}),g>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(T,{currentPage:t,onChangeIndex:o,length:g})})]})}function Pe({workspaceId:s,invite:a,isCurrentUserOwner:t,currentUserHasAdminRights:o}){const l=_(),i=H(s),r=B(s),c=v();return e.jsxs(n.Row,{disabled:i.isPending||r.isPending||r.isPending,children:[e.jsx(n.Cell,{children:a.email_address}),e.jsx(n.Cell,{children:t?e.jsx(F,{currentRole:a.role,onUpdateUserRole:u=>{i.mutate({inviteId:a.id,role:u})}}):l[a.role]}),o&&e.jsx(e.Fragment,{children:e.jsx(n.Cell,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:()=>i.mutate({inviteId:a.id,acceptRequest:!0}),children:c.formatMessage(h.accept)}),e.jsx(I,{color:"secondary",onClick:()=>r.mutate({email:a.email_address}),children:c.formatMessage(h.reject)})]})})})]})}const h=C({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Role"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}});var O=(s=>(s.Members="members",s.Invites="invites",s.Requests="requests",s))(O||{});function Ce({tab:s}){switch(s){case"members":return e.jsx(d,{...p.allMembers});case"invites":return e.jsx(d,{...p.pendingInvites});case"requests":return e.jsx(d,{...p.pendingRequests})}}function qe({tab:s,filterInputValue:a,workspaceId:t}){switch(s){case"members":return e.jsx(pe,{workspaceId:t,filterInputValue:a});case"invites":return e.jsx(ye,{workspaceId:t,filterInputValue:a});case"requests":return e.jsx(ke,{workspaceId:t,filterInputValue:a})}}const Ne=ce(O);function we({currentWorkspaceId:s}){const a=v(),t=J(),o=fe(s)??"?",l=re(t),i=t==null?void 0:t.isTeam(),r=Y(),c=typeof r.query.tab=="string"&&Ne(r.query.tab)?r.query.tab:"members",[u,m]=j.useState(""),[g,b]=j.useState("");j.useEffect(()=>{b("")},[c]);const Q=j.useCallback(ie(x=>{b(x)},250),[]),q=oe(),K=!!(q!=null&&q.length);if(!t)return null;const L=t.isAdminOfAccount(),V=t.isOwnerOfAccount(),$=i||!K?["members","invites"]:["members","invites","requests"];return e.jsxs(e.Fragment,{children:[e.jsx(ee,{children:e.jsx("title",{children:a.formatMessage(p.adminBrowserPageTitle)})}),e.jsx(ge,{title:a.formatMessage(p.adminPageTitle),subtitle:e.jsx(d,{values:{totalMembers:o,planName:l},...p.totalMembers})}),e.jsxs(xe,{children:[e.jsxs(Se,{children:[e.jsx("div",{className:"mb-6 flex gap-2",children:$.map(x=>e.jsx(Ae,{onClick:()=>{r.push(x!=null?`/admin?tab=${x}`:"/admin")},isSelected:c===x,children:e.jsx(Ce,{tab:x})},x))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(de,{className:"icon-sm absolute left-2 top-1/2 -translate-y-1/2 transform text-token-text-tertiary"}),e.jsx("input",{type:"text",value:u,onChange:x=>{m(x.target.value),Q(x.target.value)},placeholder:a.formatMessage(p.search),className:"w-48 rounded-lg border border-token-border-light bg-token-main-surface-primary pl-8 placeholder:text-token-text-tertiary"})]}),(L||V||i)&&e.jsx(I,{onClick:()=>{S.openModal(le.InviteUsersToWorkspace)},icon:ue,children:e.jsx(d,{...p.inviteMemberButton})}),i?e.jsx(te,{triggerButton:e.jsx(I,{color:"secondary",icon:N}),children:e.jsx(f.Item,{onClick:()=>{t&&S.setLeaveWorkspaceData(t)},children:e.jsx(d,{...p.leaveWorkspace})})}):null]})]}),e.jsx(qe,{workspaceId:s,tab:c,filterInputValue:g})]}),t!=null?e.jsx(me,{workspace:t}):null]})}function Ae({children:s,isSelected:a,onClick:t}){return e.jsx(I,{color:"ghost",className:se(a?"bg-token-main-surface-tertiary":"hover:bg-token-main-surface-tertiary"),onClick:t,children:s})}const Se=Z.div`mb-4 py-6 flex flex-col gap-4 lg:flex-row md:items-start lg:justify-between`,p=C({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Member admin"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} · {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"All members"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"},analytics:{id:"adminPage.analytics",defaultMessage:"Analytics"},inviteMemberButton:{id:"adminPage.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"},search:{id:"adminPage.search",defaultMessage:"Search"}});function ts(){const s=ve();return e.jsx(we,{...s})}export{ts as default};
//# sourceMappingURL=cir1bu9fp9ai3b1c.js.map
