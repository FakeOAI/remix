import{en as V,G,r as m,Z as F,m as e,aJ as O,F as q,dO as J,aS as z,eR as X,aD as I,bp as w,d2 as $,b0 as E,fu as k,bV as ee,bW as se,gj as te,fp as A}from"./l2v3dn084awsfmlt.js";import{n as P,bA as ae,eT as ne,iw as M,bS as ie,aF as re,c8 as oe,ix as v,iy as le,iz as ce,bY as _,iA as de,e0 as me,U as B,ek as ue,ao as ge,iB as xe,hK as fe,hL as pe,iC as he,iD as C,iE as Se,iF as h,cV as be,iG as je,iH as Ce,iI as ve,dH as ye,iJ as U,ap as D,iK as Ie,iL as ke,iM as ze,iN as y,iO as Ne,dI as Me,iP as Ge,iQ as Fe,iR as Te,eQ as Oe,iS as Le,iT as we}from"./dvpzw3f488g1g0a6.js";import{au as Ee,bx as Ae,x as Pe,ay as _e,K as Be,ba as Ue,L as R,aI as De,af as Re}from"./gqkv2pz2400wyxy0.js";import{m as W}from"./ic8huh33es9o731f.js";import{a as We}from"./l3my01bk9bm5kzn3.js";import{U as He,P as Ke}from"./k7w85djf9jdvbi9k.js";function Ye({gizmo:s,historyDisabled:r,section:a,onClick:o,isActive:l,hideOverflowMenu:f=!1}){const{clientThreadId:c}=P(),u=V(c),d=G(),[p,n]=m.useState(!1),[S,t]=m.useState(!1),[i,g]=m.useState(null),x=F(),b=!!s?.gizmo.tags?.includes(ae.FirstParty),T=!1;let Z=!1;m.useEffect(()=>{i==null&&l&&u&&g(!0)},[l,u,i]);const[Q,es]=m.useState(0);let j;if(s!=null)j=s.gizmo.display.name||ne;else{if(x==null)return null;r?j=d.formatMessage(M.clearChat):x.canInteractWithGizmos()?j=ce:j=d.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(W.div,{whileTap:{scale:.98},onMouseEnter:()=>{t(!0)},onMouseLeave:()=>{t(!1)},children:e.jsx(ie,{loggingGizmoId:s?.gizmo.id??"primary",href:s!=null?re(s):"/",onClick:o,showActiveIndicator:Z,icon:e.jsx(oe,{gizmoId:s?.gizmo.id,isFirstParty:s==null||b,gizmoEmoji:s?.gizmo.display.emoji,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6"}),isMenuOpen:p,label:j,hoverLeftIcon:S&&s&&T&&Q&&e.jsx("button",{onClick:N=>{N.preventDefault(),g(!i)},className:"flex text-token-text-secondary hover:text-token-text-primary",children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:i?e.jsx(Ee,{className:"icon-md"}):e.jsx(Ae,{className:"icon-md"})})})}),rightIcon:a===v.Workspace&&e.jsx(O,{side:"right",label:d.formatMessage(L.workspaceRecommended,{workspace_name:x?.name??"Your Workspace"}),children:e.jsx(Pe,{className:"icon-md text-token-text-secondary",alt:d.formatMessage(L.workspaceRecommended,{workspace_name:x?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(S||p)&&s!=null&&!T&&!f&&e.jsx("div",{className:"text-token-text-tertiary",onClick:N=>{N.preventDefault()},children:e.jsx(le,{gizmo:s,isOpen:p,setIsOpen:n,section:a})}),!f&&e.jsx(O,{side:"right",label:d.formatMessage(r?M.clearChat:M.newChat),className:"flex items-center",children:e.jsx("button",{className:p?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:r?e.jsx(_e,{className:"icon-md"}):e.jsx(Be,{className:"icon-md"})})})]})})}),!1]})}const L=q({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}});function H(){const s=G(),r=_(),a=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(de,{children:e.jsx(W.div,{whileTap:{scale:.98},children:e.jsx(J,{to:me(),onClick:()=>{r.activeSidebar==="popover-nav"&&B.setActiveSidebar(!1)},children:e.jsx(ue,{icon:Ue,"data-testid":"explore-gpts-button",children:a})},"explore")})})}const Ze=2;function K({gizmos:s,isGizmoFlyout:r,isLoaded:a,maxToShowOnLoad:o=4,isScreenArch:l,showAllSidebarItems:f}){const c=he(s,i=>i.flair.kind),u=[...(c[C.Workspace]?.map(({resource:i})=>({gizmo:i,section:v.Workspace}))??[]).slice(0,3),...c[C.FirstParty]?.map(({resource:i})=>({gizmo:i,section:v.Keep}))??[],...c[C.SidebarKeep]?.map(({resource:i})=>({gizmo:i,section:v.Keep}))??[]],d=c[C.Recent]?.slice(0,l||a?c[C.Recent]?.length:Ze).map(({resource:i})=>({gizmo:i,section:v.Recents}))??[],p=d.length,n=u.length,S=l?p>0:s.length>o;let t=[];return r&&l?t=[...u,...d]:!r&&l?t=u:(t=[...u,...d],f||(t.length>o&&n>o?t=t.slice(0,n):t.length>o&&(t=t.slice(0,o)))),{listItems:t,itemsLeft:s.length-t.length,needsToCollapseItems:S,total:s.length}}function Y({gizmo:s,currentGizmoId:r,maxToShowOnLoad:a,hideOverflowMenu:o=!1}){const l=m.useRef(!1),f=!a,c=ge(),[u,d]=m.useState(!1),p=_(g=>!xe.isGptListCollapsed(g)),{listItems:n,needsToCollapseItems:S,itemsLeft:t}=K({gizmos:s,isGizmoFlyout:f,isLoaded:u,maxToShowOnLoad:a,isScreenArch:c,showAllSidebarItems:p});m.useEffect(()=>{u||d(!0)},[u]),m.useEffect(()=>{n.length>0&&!l.current&&(fe({namespace:pe.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),l.current=!0)},[n]);function i(g,x){const b=e.jsx(Ye,{gizmo:g,isActive:g.gizmo.id===r,section:x,hideOverflowMenu:o},g.gizmo.id);return c?e.jsx("li",{children:b}):b}return e.jsxs("div",{children:[n.map(({gizmo:g,section:x},b)=>e.jsxs(m.Fragment,{children:[b>1&&x!==n[b-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),i(g,x)]},b)),!c&&S?e.jsxs("button",{onClick:B.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(R,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:p?e.jsxs(e.Fragment,{children:[e.jsx(z,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(De,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:t}}),e.jsx(Re,{className:"icon-xs"})]})})]}):null,!c&&e.jsx(H,{})]})}function Qe({currentGizmoId:s,gizmos:r,onClick:a}){const{isSidebarFlyoutOpen:o,onSidebarFlyoutOpenChange:l}=Se(),f=o(h.Gizmo);return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(X,{onOpenChange:c=>l(h.Gizmo,c),side:"right",sideOffset:4,open:f,contentAlign:"end",triggerButton:e.jsxs("button",{className:I("flex flex-1 select-none items-center gap-2 rounded-lg px-2 py-2 text-sm tracking-condensed text-token-text-secondary hover:bg-token-main-surface-secondary focus:ring-0",f&&"bg-token-main-surface-secondary"),onClick:a,children:[e.jsx(R,{className:I("icon-md mr-1 font-semibold text-token-sidebar-icon")}),e.jsx("span",{className:"text-left",children:e.jsx(z,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(w,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(Y,{gizmo:r,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function Ve({currentGizmoId:s}){const{data:{gizmos:r}={}}=be();let a=r;const o=!a||a?.length===0,{needsToCollapseItems:l}=K({gizmos:a??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return o?null:e.jsx(e.Fragment,{children:e.jsxs(je,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(z,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(H,{}),e.jsx(Y,{gizmo:a??[],currentGizmoId:s,maxToShowOnLoad:Ce}),l&&e.jsx(w,{children:e.jsx(Qe,{currentGizmoId:s,gizmos:a??[]})})]})})}function qe({clientThreadId:s}){const r=F(),a=$(s),{isUnauthenticated:o}=E();return o?null:e.jsxs("div",{className:I(k.screenContent),children:[null,e.jsx(ve,{clientThreadId:s}),r?.canInteractWithGizmos()?e.jsx(Ve,{currentGizmoId:a}):null]})}function Je(){const s=F(),r=s?.data==null,{isUnauthenticated:a}=E(),{openSettings:o}=ye(),[l]=m.useState(()=>{const n=ee.getCookie(se.Workspace);return typeof n=="string"&&n!==te}),f=G(),{store:c,actions:u}=U(),d=c(n=>n.mode);if(!s||l&&r)return null;const p=a?e.jsx(He,{}):e.jsx(We,{onClickSettings:()=>o()});return e.jsxs(D,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[p,e.jsx("div",{className:k.togglePinWrapper,children:e.jsx(Ie,{tooltipSideOffset:14,className:k.pinSidebarAction,icon:e.jsx(ke,{}),onActivate:n=>{n.preventDefault(),n.persist(),ze.togglePinSidebar(n,u,d===y.Floating?y.Pinned:y.Floating)},label:d===y.Floating?f.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):f.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:A.FloatingOrPinned})})]})}function Xe(){return e.jsx(D,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(Ke,{})})}function $e(){return e.jsxs(Ne,{className:I(k.screenTrailingBarContainer),children:[e.jsx(Me,{}),e.jsx(Xe,{}),e.jsx(Je,{})]})}function os(){const{clientThreadId:s,onNewThread:r}=P(),[a,o]=m.useState(!1),[l,f]=m.useState(!1),[c,u]=m.useState(!1),{store:d}=U(),p=m.useCallback(t=>t===h.Conversation?a:t===h.Gizmo?l:t===h.Conversation2?c:!1,[a,l,c]),n=m.useCallback((t,i)=>{const g=x=>{t===h.Conversation?o(x):t===h.Gizmo?f(x):t===h.Conversation2&&u(x)};if(i){g(i);return}setTimeout(()=>{g(i)},100)},[]),S=m.useRef(null);return Ge((t,i)=>{n(h.Conversation,!1),n(h.Gizmo,!1),n(h.Conversation2,!1);const g=window.matchMedia("(max-width: 700px)").matches,x=we(S.current);i!=null&&g&&d.getState().isSidebarOpen&&(d.getState().mode===y.Floating||x)&&setTimeout(()=>{document.getElementById(A.OpenOrClosed)?.click()},100)}),e.jsxs(Fe,{value:{isSidebarFlyoutOpen:p,onSidebarFlyoutOpenChange:n},children:[e.jsx(Te,{}),e.jsx(Oe,{anchor:"vertical",className:I(k.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Le,{onNewThread:r}),ref:S,trackLeading:!0,trailing:e.jsx($e,{}),children:e.jsx(qe,{clientThreadId:s})})]})}export{os as C,Ye as G,Y as a};
//# sourceMappingURL=g3vu1l6adolhbc71.js.map
