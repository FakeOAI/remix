import{bJ as _,aB as w,cM as H,cN as q,aU as B}from"./h60ucn2y7ct2d4ke.js";import{bQ as A,aB as D,aK as U,eB as F,aq as S,eC as K,d8 as T,eD as V,r as k,R as Q,bF as X,ak as p,P as b,A as v,j as i,K as h,bt as N,N as Y,eE as W,X as z,bw as J,H as Z}from"./csnclwvitc93pb4o.js";import{a as C}from"./lgr0r7bzqvy8fmdk.js";import{L as O}from"./e58nm5wssonic2eo.js";import{d as L}from"./bttpfgsfg4ef0gbl.js";function j(){return D("437245079").value}function $(){const e=j(),o=L(),n=A("1908072088").config.value,{eligible:t,isLoading:s}=_(w.AG8PqS2q);return{eligible:t&&e&&o&&n.blocking_modal===!0,singleButtonVariant:n.single_button_variant===!0,isLoading:s}}function he(){const e=j(),o=L(),n=A("1908072088").config.value,{eligible:t,isLoading:s}=_(w.AG8PqS2q);return{eligible:t&&e&&o&&n.dropdown_tooltip,isLoading:s}}const G=28,P="conversationHistory";function pe(){const e=U(),o=(e==null?void 0:e.includes(F))??!1,n=S(),t=!o&&!!(n!=null&&n.data),s=K.useRelayEnvironment(),{value:c}=D("2893406386"),g=ee(s,t&&c),m=ne(t&&!c),{conversations:a,data:l,fetchNextPage:d,hasNextPage:r,isInitialLoading:f,isFetchingNextPage:M,isError:E}=c?g:m;return{data:l,conversations:a,fetchNextPage:d,hasNextPage:r,isLoading:f,isFetchingNextPage:M,isError:t&&E}}function ee(e,o){const{data:n,fetchNextPage:t,hasNextPage:s,isInitialLoading:c,isFetchingNextPage:g,isError:m}=T({queryKey:[P],queryFn:({pageParam:l})=>V.fetchQuery_DEPRECATED(e,oe,{after:l,first:G,order:"updated",expand:!1,isArchived:!1}),initialPageParam:"aWR4Oi0x",getNextPageParam:l=>{var d,r;if((d=l.conversationDisplayHistory)!=null&&d.pageInfo.hasNextPage)return(r=l.conversationDisplayHistory)==null?void 0:r.pageInfo.endCursor},enabled:o}),a=k.useMemo(()=>(n==null?void 0:n.pages.flatMap(l=>{var d;return(((d=l.conversationDisplayHistory)==null?void 0:d.edges)??[]).flatMap(r=>{var f;return r!=null&&r.node?[{id:r.node.id,title:r.node.title??"",create_time:r.node.createTime,update_time:r.node.updateTime,conversation_template_id:(f=r.node.primaryGizmo)==null?void 0:f.id,async_status:r.node.asyncStatus}]:[]})}))??[],[n]);return k.useEffect(()=>{C(a)},[a]),{conversations:a,data:n,fetchNextPage:t,hasNextPage:s,isInitialLoading:c,isFetchingNextPage:g,isError:m}}function ne(e){const{data:o,fetchNextPage:n,hasNextPage:t,isInitialLoading:s,isFetchingNextPage:c,isError:g}=T({queryKey:[P],queryFn:async({pageParam:a})=>{const l=await Q.getConversations({offset:a,limit:G});return C(l.items),l},initialPageParam:0,getNextPageParam:a=>{const l=a.offset+a.limit;return l<a.total?l:void 0},enabled:e});return{conversations:k.useMemo(()=>(o==null?void 0:o.pages.flatMap(a=>a.items))??[],[o]),data:o,fetchNextPage:n,hasNextPage:t,isInitialLoading:s,isFetchingNextPage:c,isError:g}}function fe(e){e.invalidateQueries({queryKey:[P]})}const oe=H,I=w.UseSidekick,te=w.SidekickLauncherOnboarding,y="https://persistent.oaistatic.com/sidekick/public/ChatGPT_Desktop_public_latest.dmg",R="download";function x(){const e=S(),o=W("1696863369").layer.get("has_sidekick_access",!1);return e!=null&&o}function ie(e){return e===R}function se(){const e=z(),n=(J(()=>e.asPath)??"").split("#"),t=ie(n[1]);return{openModal:()=>{const c=e.asPath.split("#");e.replace(c[0]+"#"+R)},closeModal:()=>{e.replace(n[0])},isOpen:t}}function be(e){var d;const{eligible:o,isLoading:n}=$(),t=x(),{eligible:s,isLoading:c}=_(I),{eligible:g,isLoading:m}=_(te),a=o||!s||!g||!t||((d=e.conversationMode)==null?void 0:d.kind)!==X.PrimaryAssistant,l=n||m||c;return{eligible:!a&&p.getLayerValue({layerName:"1696863369",key:"show_nux_banner",defaultValue:!1}),isLoading:l}}function ve({onClose:e}){k.useEffect(()=>{b.logEvent(v.sidekickAnnouncementShown),p.logEvent("chatgpt_sidekick_announcement_shown")},[]);const{markAsViewed:o}=_(I),n=k.useCallback(()=>{o(),b.logEvent(v.sidekickAnnouncementDismissed),p.logEvent("chatgpt_sidekick_announcement_closed"),e&&e()},[o,e]),t=k.useCallback(()=>{b.logEvent(v.sidekickAnnouncementLinkClicked),p.logEvent("chatgpt_sidekick_announcement_download_clicked"),o(),e&&e()},[o,e]),s={downloadUrl:y,markAsDownloaded:t,markAsViewed:n,isSidekickAvailable:x()};return i.jsx(re,{...s})}function ae(){window.open(y,"_blank")}function le(){var e;return(e=S())!=null&&e.isPlus()?u.bannerTitleMentioningPlus:u.bannerTitleNotMentioningPlus}function _e(){const{closeModal:e,isOpen:o}=se(),n=x(),t=k.useMemo(()=>({isDesktopAppAvailable:n}),[n]),s=()=>{b.logEvent(v.sidekickDownloadModalClosed,t),p.logEvent("chatgpt_sidekick_modal_closed"),e()},c=()=>{b.logEvent(v.sidekickDownloadModalDownloaded,t),p.logEvent("chatgpt_sidekick_modal_download_clicked"),e()};return k.useEffect(()=>{o&&(b.logEvent(v.sidekickDownloadModalShown,{...t}),p.logEvent("chatgpt_sidekick_modal_shown"))},[t,o]),o?i.jsx(ce,{downloadUrl:y,markAsDownloaded:c,markAsViewed:s,isSidekickAvailable:n}):null}function ce({downloadUrl:e,markAsDownloaded:o,markAsViewed:n,isSidekickAvailable:t}){const s=t?u.modalTitleEligible:u.modalTitleNotEligible,c=i.jsx(h,{...s}),g=i.jsx(h,{...u.modalContent}),m=t?u.disclaimer:u.comingSoonDisclaimer,a=i.jsx(h,{...m,values:{learnMoreLink:E=>i.jsx(O,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:E})}}),l=i.jsxs("div",{children:[i.jsx("div",{children:g}),i.jsx("div",{className:"mt-2",children:a})]}),d=i.jsx(N,{as:"link",to:e,color:"primary",onClick:o,openNewTab:!0,children:i.jsx(h,{...u.download})}),r=i.jsx(N,{color:"secondary",onClick:n,children:i.jsx(h,{...u.close})}),f=t?d:r,M=t?r:void 0;return i.jsx(q,{onClose:n,title:c,description:l,actionButton:f,cancelButton:M})}function re({markAsDownloaded:e,markAsViewed:o}){const n=Z(),t=k.useCallback(()=>{ae(),e()},[e]),s=i.jsx(h,{...le()}),c=i.jsx(h,{...u.bannerContent}),g=i.jsx(h,{...u.disclaimer,values:{learnMoreLink:a=>i.jsx(O,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:a})}}),m=i.jsxs("div",{className:"flex-grow",children:[i.jsx("div",{className:"mb-0.5 font-semibold",children:s}),i.jsxs("span",{className:"text-token-text-secondary",children:[c," ",g]})]});return i.jsx(B,{onPrimaryCtaClick:t,primaryCtaText:n.formatMessage(u.download),onDismiss:o,content:m})}const u=Y({bannerTitleNotMentioningPlus:{id:"SidekickOnboarding.bannerTitleEnterprisey_2",defaultMessage:"ChatGPT is available for macOS 14+ with Apple Silicon"},bannerTitleMentioningPlus:{id:"SidekickOnboarding.bannerTitleMentioningPlus",defaultMessage:"ChatGPT is now available for macOSâ€”Plus users get early access"},modalTitleEligible:{id:"SidekickOnboarding.modalTitleEligible",defaultMessage:"The ChatGPT app is now available for macOS"},modalTitleNotEligible:{id:"SidekickOnboarding.modalTitleNotEligible",defaultMessage:"The ChatGPT macOS desktop app is coming soon"},modalContent:{id:"SidekickOnboarding.modal_content_eligible",defaultMessage:"Quickly access ChatGPT from anywhere on your computer with a shortcut: Option + Space. Share screenshots, upload files and photos, have voice conversations, and search through past conversations."},bannerContent:{id:"SidekickOnboarding.banner_content_3",defaultMessage:"Get faster access to ChatGPT with the Option + Space shortcut and the floating companion window."},disclaimer:{id:"SidekickOnboarding.disclaimer_3",defaultMessage:"<learnMoreLink>Learn more</learnMoreLink>."},comingSoonDisclaimer:{id:"SidekickOnboarding.coming_soon_disclaimer",defaultMessage:"The app will be available over the next couple of weeks."},download:{id:"SidekickOnboarding.download",defaultMessage:"Download"},close:{id:"SidekickOnboarding.close",defaultMessage:"Close"}});export{P as C,_e as D,x as a,se as b,pe as c,ve as d,be as e,he as f,fe as r,$ as u};
//# sourceMappingURL=km9s5iryouklsfgz.js.map
