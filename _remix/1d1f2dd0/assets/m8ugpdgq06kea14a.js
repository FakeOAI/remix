import{j as e,aw as T,r as f,L as S,b as D,cj as v,aX as F,ar as M}from"./lyvmbpf7ocwbhkqv.js";import{bE as h,bF as P,bG as p,bH as I,br as y,bs as _}from"./g6lhcxpyem234o4q.js";import{b as z,aX as O}from"./c7ci0rjyj4htmm6k.js";import{g as A}from"./kqwdyvkaaavvn8k3.js";import{a as G}from"./nw3jrqq4fv08urtb.js";import{u as $,a as X,b as q}from"./bcaj2jtx6u3fmmp2.js";import{m as k}from"./fum5k2u9xxdkha3i.js";import"./m196oa93c25o2qds.js";import"./o8tdo8futvlmxk8x.js";function re({clientThreadId:t}){const s=h.useCurrentImage();if(!s)return null;const{image:r,source:a,turnIndex:o}=s;if(a==null||t==null||o==null)return e.jsx(x,{image:r});const c=P(t,o);return e.jsx(x,{image:r,group:c,turnIndex:o,groupSource:a})}function ne(){const t=h.useCurrentImage();if(!t)return null;const{image:s,source:r}=t;if(r==null)return e.jsx(x,{image:s});switch(r){case p.ImagesTab:return e.jsx(H,{image:s});case p.Turn:return e.jsx(U,{image:s})}}function H({image:t}){const{imageResults:s}=$();return e.jsx(x,{image:t,group:s,groupSource:p.ImagesTab})}function U({image:t}){const{imageResults:s}=X();return e.jsx(x,{image:t,group:s,groupSource:p.Turn})}const N=T.div`grow flex items-start p-8`;function L({title:t,urls:s,placeholder:r}){const a=s[0],{data:o,isError:c}=q(a);if(s.length===0)return;if(c)return s.length>1?e.jsx(L,{placeholder:r,title:t,urls:s.slice(1)}):e.jsx("div",{className:"flex h-full grow items-center justify-center",children:e.jsx("div",{className:"flex h-96 w-96 items-center justify-center bg-white/10",children:e.jsx(O,{className:"h-12 w-12 text-token-text-tertiary"})})});const i="max-w-[100vw] sm:max-w-[calc(100vw-10rem)] object-scale-down h-full";return o!=null?e.jsx(k.img,{src:a,alt:t,style:{backgroundImage:r?`url(${r})`:void 0},initial:{opacity:0},animate:{opacity:1},className:i}):e.jsx("div",{className:M("w-full animate-pulse bg-white/10",i)})}const B={enter:t=>({x:t>0?1e3:-1e3,opacity:0}),center:{zIndex:1,x:0,opacity:1},exit:t=>({zIndex:0,x:t<0?1e3:-1e3,opacity:0})},C=1e4,J=(t,s)=>Math.abs(t)*s;function x({image:t,group:s,groupSource:r,turnIndex:a}){const o=G(t?.url??""),c=h.useCurrentImage(),i=h.useStore(),w=c?.mountDirection;f.useEffect(()=>{window?.history?.state?.imageModalOpen||window.history.pushState({imageModalOpen:!0},"",window.location.href);const n=()=>{window?.history?.state?.imageModalOpen||i.setCurrentImage(void 0)};return window.addEventListener("popstate",n),()=>window.removeEventListener("popstate",n)},[i]);const b=()=>{window.history.go(-1),i.setCurrentImage(void 0)},l=s?.findIndex(n=>S(t,n)),u=s?.length??1,m=l!=null&&u>1,g=f.useCallback(()=>{!m||s==null||i.setCurrentImage({image:s[(l+1)%s.length],source:r,mountDirection:I.FromRight,turnIndex:a})},[m,s,i,l,r,a]),d=f.useCallback(()=>{!m||s==null||i.setCurrentImage({image:s[(l-1+s.length)%s.length],source:r,mountDirection:I.FromLeft,turnIndex:a})},[m,s,i,l,r,a]);return f.useEffect(()=>D(document,{keydown:n=>{n.key==="ArrowRight"?g():n.key==="ArrowLeft"&&d()}}),[g,d]),e.jsx(y,{children:t&&e.jsx(v.Root,{isOpen:!0,onClose:b,children:e.jsx(v.Overlay,{children:e.jsxs(F,{className:"flex h-full w-full flex-col bg-black/95",children:[e.jsxs("div",{className:"relative flex w-full grow justify-center overflow-hidden",children:[e.jsxs("div",{className:"absolute right-4 top-4 flex items-center sm:right-6 sm:top-6",children:[m&&e.jsxs("div",{className:"shrink-0 px-4 py-2 text-token-text-tertiary",children:[l+1," / ",u]}),e.jsx("button",{onClick:n=>{n.stopPropagation(),b()},className:"flex h-9 w-9 items-center justify-center outline-none hover:opacity-70",children:e.jsx(z,{className:"h-6 w-6 text-gray-400"})})]}),u>1&&e.jsx(N,{className:"cursor-w-resize",onClick:n=>{n.stopPropagation(),d()}}),e.jsx(y,{initial:!1,custom:w,children:e.jsx(k.div,{variants:B,custom:w??0,className:"absolute bottom-4 top-24",initial:"enter",animate:"center",exit:"exit",transition:{x:{type:"spring",stiffness:300,damping:30},opacity:{duration:.2}},drag:u>1?"x":!1,dragConstraints:{left:0,right:0},dragElastic:1,onDragEnd:(n,{offset:E,velocity:R})=>{const j=J(E.x,R.x);j<-C?g():j>C&&d()},children:e.jsx(L,{placeholder:t.thumbnail_url,title:t.title,urls:[t.content_url.replace(/^http:\/\//,"https://"),t.thumbnail_url]})},l)}),u>1&&e.jsx(N,{className:"cursor-e-resize",onClick:n=>{n.stopPropagation(),g()}})]}),e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"flex min-h-20 w-full shrink-0 items-center gap-8 px-6 pb-3 pt-8 text-sm hover:opacity-70 sm:px-8 sm:pb-8",children:e.jsxs("div",{className:"flex grow flex-col gap-0.5 overflow-hidden pr-2",children:[e.jsxs("div",{className:"flex items-center gap-2 truncate text-token-text-tertiary",children:[e.jsx(_,{url:t.content_url,className:"rounded",size:16}),o.data??A(t.url)]}),e.jsx("div",{className:"truncate font-semibold text-white",children:t.title})]})})]})})})})}export{re as ImageLightbox,ne as ImageLightboxSearchGPT,x as ImageResultModal};
//# sourceMappingURL=m8ugpdgq06kea14a.js.map
