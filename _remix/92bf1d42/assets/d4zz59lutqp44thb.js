import{r as l,g2 as O,an as F,o as R,e as B,b9 as K,P as y,d as _,m as e,aC as p,aY as $,aS as L}from"./g92hdia1euilhv3m.js";import{o as U,p as C,F as W,q as D,P as X,r as Y}from"./l912w0bwi7cbhgoi.js";import{T as q,a as E}from"./jx68egcobq9vg9nd.js";import"./j9bb93dkfix5hp9e.js";import"./bz2yxwsv6hrttawy.js";const H={strong:s=>{const{node:t,children:a,...n}=s;return e.jsx("strong",{...n,className:p(n.className,"font-semibold text-token-text-primary"),children:a})},p:s=>{const{node:t,children:a,...n}=s;return e.jsx("p",{...n,className:p(n.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:a})}};function Q({message:s,isExpandable:t}){const n=s.create_time?new Date(s.create_time*1e3):Date.now(),r=D(+n,48e4);return e.jsx(X,{percentage:r,className:p("mr-4",t?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-r)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"})}function V({headline:s,message:t}){const n=t.create_time?new Date(t.create_time*1e3):Date.now(),r=D(+n,48e4);return e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(Y,{percentage:r,thickness:1/8,className:"h-5 w-5 text-token-text-primary",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-r)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"}),s]})}function G({isExpandable:s,handleOpenSidebarSummarizer:t,summarizationHeadline:a,latestTitle:n,message:r}){return e.jsx("div",{className:"py-2",children:e.jsx(C,{buttons:s?[e.jsx($,{onClick:t,color:"secondary",className:"text-base font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(L,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")]:[],title:a,time:null,icon:e.jsx("div",{className:""}),content:`${n}...`,size:"small",progressBar:e.jsx(Q,{message:r,isExpandable:s})})})}function J({handleOpenSidebarSummarizer:s,summarizationHeadline:t,message:a}){return e.jsx("div",{className:"py-2",children:e.jsx(C,{buttons:[],title:t,time:null,content:a.metadata?.finished_text??"",size:"small",disabled:!0,onClick:s})})}function T({completionInProgress:s,summarizationHeadline:t,latestTitle:a,message:n,summaryText:r,isExpandable:u,disableExpansion:m,onOpenAnalytics:i,handleOpenSidebarSummarizer:x}){return e.jsx(q,{status:s?E.Running:E.Finished,highlightedCommand:s?t==null?a:e.jsx(V,{headline:t,message:n}):n.metadata?.finished_text??"",onOpenAnalytics:i,onClick:x,children:r&&u&&!m?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(W,{componentOverrides:H,className:"not-prose leading-6",children:r})}):null})}function ne({messages:s,isStreaming:t,clientThreadId:a,currentGroupedMessageIndex:n,turnIndex:r}){const[u,m]=l.useState(""),[i,x]=l.useState(!1),h=O(a)===F.STREAMING,S=h||t,o=s[0].message,j=o.id,N=R.getServerThreadId(a),d=B(o),c=o.metadata?.summarization_headline,P=t&&c!=null,{toggleThreadSidebar:M}=K(),z=c!=null,A=U(),g=l.useCallback(()=>{M({type:"summarizer",clientThreadId:a,currentGroupedMessageIndex:n,turnIndex:r})},[M,a,n,r]);l.useEffect(()=>{const w=/\*\*(.*?)(?:\*\*|\n|$)/g;let v,b="";for(;(v=w.exec(d))!=null;)b=v[1].trim();b?m(b):o.metadata?.initial_text!=null&&m(o.metadata.initial_text)},[d,o.metadata?.initial_text]),l.useEffect(()=>{d.length>0&&x(!0)},[d]);const f=l.useMemo(()=>({client_thread_id:a,message_id:j,conversationId:N}),[a,j,N]);l.useEffect(()=>{i&&y.logEvent(_.receivedA8KM123Message,f)},[i]);const k=l.useCallback(()=>{y.logEvent(_.openedA8KM123Message,{...f,isStreaming:t})},[f,t]);return A?z?h||t?e.jsx(G,{isExpandable:i,handleOpenSidebarSummarizer:g,summarizationHeadline:c,latestTitle:u,message:o}):e.jsx(J,{handleOpenSidebarSummarizer:i?g:void 0,summarizationHeadline:c,message:o}):e.jsx(T,{completionInProgress:S,summarizationHeadline:c,latestTitle:u,message:o,onOpenAnalytics:k,handleOpenSidebarSummarizer:i?g:void 0}):e.jsx(T,{completionInProgress:S,summarizationHeadline:c,latestTitle:u,message:o,onOpenAnalytics:k,summaryText:d,isExpandable:i,disableExpansion:P})}export{H as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,ne as default};
//# sourceMappingURL=d4zz59lutqp44thb.js.map
