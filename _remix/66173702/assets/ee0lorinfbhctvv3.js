import{j as s,U as d,V as L,eR as F,ew as U,bT as S,r as M,aQ as k,df as _,bc as N,u as A,R as O,a2 as I,eS as b,aA as Q,d3 as V,eT as R}from"./hloj85fregi26ji6.js";import{dO as x,dP as p,ak as G,dQ as W,dR as z,dS as q,dT as Y,b$ as D,dU as P,r as H,dV as B,dW as $}from"./g7w33hsyqmw6f524.js";import{u as K,k as Z,g as J,w as X,x as ee}from"./oxm37jjpmmj4jh4x.js";import{q as se,i as te,r as oe,T}from"./dkqa9jl3k2y8d11k.js";import{u as ne}from"./j8xrc2euwar8tjsu.js";function ae(e){var t,o;return((o=(t=e.message.metadata)==null?void 0:t.finish_details)==null?void 0:o.type)==="content_filter"}function ie(e){if(e===void 0)return{flagSeverity:void 0,shouldHideContent:!1,errCode:void 0,errMessage:void 0};const{errType:t,errCode:o,err:a,disclaimers:n}=e,l=ae(e);return!(n&&n.length>0)&&l?{flagSeverity:"warning",shouldHideContent:!0,errCode:x.ContentOrTos,errMessage:a}:{flagSeverity:t,shouldHideContent:t==="danger"&&(o===x.ContentPolicy||o===x.ModelIncompatibility),disclaimers:n,errCode:o,errMessage:a}}function Te(e){return s.jsx(p,{flag:"danger",isUserTurn:!1,children:s.jsx(d,{...c.somethingWentWrong})})}function ke({message:e,onRequestMoreCompletions:t,clientThreadId:o,id:a,isFeedbackEnabled:n,isUserTurn:l,className:i}){const{errCode:f,errMessage:m,flagSeverity:u}=ie(e);switch(f){case x.ContentPolicy:return s.jsx(p,{flag:u,isUserTurn:l,className:i,children:s.jsx(de,{isFeedbackEnabled:n})});case x.ModelIncompatibility:return s.jsx(p,{flag:u,isUserTurn:l,className:i,children:s.jsx(d,{...c.modelIncompatibilityMessage})});case x.ContentOrTos:return s.jsx(p,{flag:u,isUserTurn:l,className:i,children:s.jsx(le,{isFeedbackEnabled:n})});case z:return s.jsx(re,{className:i,id:a,onRequestMoreCompletions:t,flag:u,clientThreadId:o,isUserTurn:l});case F:return s.jsx(p,{flag:u,isUserTurn:l,className:i,children:s.jsx(d,{...c.historyDisabledConversationMissing})});default:return m!==void 0?s.jsx(p,{flag:u,isUserTurn:l,className:i,children:s.jsx(G,{rehypePlugins:[[W,{target:"_new",rel:"noopener noreferrer"}]],className:"markdown prose w-full break-words dark:prose-invert",children:m})}):null}}function re({className:e,id:t,onRequestMoreCompletions:o,flag:a,clientThreadId:n,isUserTurn:l}){const i=q(g=>g.isoDate),f=Y(i),m=se(n??U),u=m&&m.kind!==S.PrimaryAssistant,v=K(),y=Z(),h=M.useCallback(()=>{const g=new D;o(t,{eventSource:"mouse"},g,!0,"none",!1)},[t,o]),C=M.useCallback(()=>{const g=new D,E=y.id;v({modelId:E,location:"Model switcher menu item"}),o(t,{eventSource:"mouse"},g,!0,"none",!0)},[o,t,y.id,v]);let r;return u?r=i!=null?s.jsx("span",{children:s.jsx(d,{...c.gptUsageCapExceededCustomFeature,values:{link:j,formattedTime:f}})}):s.jsx(d,{...c.gptUsageCapExceededExpired}):r=i!=null?s.jsx("span",{children:s.jsx(d,{...c.gptUsageCapExceeded,values:{link:j,formattedTime:f}})}):s.jsx(d,{...c.gptUsageCapExceededExpired}),s.jsx(p,{flag:i!=null?a:void 0,isUserTurn:l,className:e,children:s.jsxs("div",{className:"flex items-center gap-6",children:[r,i==null&&s.jsx(k,{color:"secondary",className:"flex-shrink-0",onClick:h,children:s.jsx(d,{...c.buttonTryAgain})}),i!=null&&!u&&s.jsx(k,{color:"secondary",className:"flex-shrink-0",onClick:C,children:s.jsx(d,{...c.buttonUseDefaultModel})})]})})}const j=e=>s.jsx("a",{href:"https://share.hsforms.com/16d0ZZVM3QZirXnCD_q7u1Q4sk30",target:"_blank",rel:"noreferrer",className:"underline",children:e});function le({isFeedbackEnabled:e}){return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:e?"font-semibold":"",children:s.jsx(d,{...c.contentOrTosViolationNoFeedback,values:{contentPolicyLink:w,termsLink:ce}})}),s.jsx("div",{children:e&&s.jsx(d,{...c.contentPolicyFeedback})})]})}function de({isFeedbackEnabled:e}){return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:e?"font-semibold":"",children:s.jsx(d,{...c.contentPolicyViolationNoFeedback,values:{contentPolicyLink:w}})}),s.jsx("div",{children:e&&s.jsx(d,{...c.contentPolicyFeedback})})]})}const w=e=>s.jsx(P,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:e}),ce=e=>s.jsx(P,{target:"_blank",href:"https://openai.com/policies/terms-of-use",rel:"noreferrer",children:e}),c=L({contentPolicyFeedback:{id:"TextMessageDisplay.contentPolicyFeedback",defaultMessage:"Did we get it wrong? Please tell us by giving this response a thumbs down."},contentPolicyViolation:{id:"TextMessageDisplay.contentPolicyViolation.2",defaultMessage:"This content may violate our <contentPolicyLink>usage policies</contentPolicyLink>. Did we get it wrong? Please tell us by giving this response a thumbs down."},contentPolicyViolationNoFeedback:{id:"TextMessageDisplay.contentPolicyViolationNoFeedback",defaultMessage:"This content may violate our <contentPolicyLink>usage policies</contentPolicyLink>."},modelIncompatibilityMessage:{id:"cyOWhN",defaultMessage:"Your request was flagged as potentially violating our usage policy. Please try again with a different prompt."},contentOrTosViolation:{id:"TextMessageDisplay.contentOrTosViolation.2",defaultMessage:"This content may violate our <termsLink>Terms of Use</termsLink> or <contentPolicyLink>usage policies</contentPolicyLink>. Did we get it wrong? Please tell us by giving this response a thumbs down."},contentOrTosViolationNoFeedback:{id:"TextMessageDisplay.contentOrTosViolationNoFeedback",defaultMessage:"This content may violate our <termsLink>Terms of Use</termsLink> or <contentPolicyLink>usage policies</contentPolicyLink>."},historyDisabledConversationMissing:{id:"TextMessageDisplay.historyDisabledConversationMissing",defaultMessage:"Sorry, conversations created when Chat History is off expire after 6 hours of inactivity. Please start a new conversation to continue using ChatGPT."},somethingWentWrong:{id:"TextMessageDisplay.somethingWentWrong",defaultMessage:"Something went wrong."},gptUsageCapExceeded:{id:"TextMessageDisplay.gptUsageCapExceeded",defaultMessage:"You've reached the current usage cap for GPT-4. You can continue with the default model now, or try again {formattedTime}. <link>Learn more</link>"},gptUsageCapExceededCustomFeature:{id:"TextMessageDisplay.gptUsageCapExceededCustomFeature",defaultMessage:"You've reached the current usage cap for GPT-4, please try again {formattedTime}. <link>Learn more</link>"},gptUsageCapExceededExpired:{id:"TextMessageDisplay.gptUsageCapExceededExpired",defaultMessage:"You previously reached your usage cap for GPT-4, but you can now try sending your message again"},buttonUseDefaultModel:{id:"TextMessageDisplay.buttonUseDefaultModel",defaultMessage:"Use default model"},buttonTryAgain:{id:"TextMessageDisplay.buttonTryAgain",defaultMessage:"Try again"}});function ue(e){return`https://chatgpt.com${J(e)}`}function be(e,t,o,a){H(ue(e),t,o),a&&t.info(a)}function De(e){return e.some(t=>t.type===_.JIT_PLUGIN)}function ge(e){return"gizmo_id"in e?e.gizmo_id??null:null}const fe=e=>["conversation","init",e],me=({clientThreadId:e,conversationMode:t,clientModelId:o},a)=>{const n=ge(t),l=te(e)?null:e;return{gcTime:0,refetchOnWindowFocus:!0,refetchOnMount:"always",queryKey:fe(e),queryFn:()=>O.getConversationDetails({conversationId:l,gizmoId:n,requestedDefaultModel:o}),enabled:!B(e)}},pe=e=>(N(),A(me(e))),ye=(e,t)=>{const o=(typeof e=="string"?[e]:e)??[];for(const a of o)if(a&&t.has(a))return a;return null},je=(e,t)=>{const o=X(),{query:a}=I(),n=ee(a),{modelId:l=null}=$()??{};ne(e);const i=oe(e)??null,f=[n,i,l],m=ye(f,o);M.useEffect(()=>{T.initThread(e,t,m),b.reset()},[e]);const u=Q(),v=M.useCallback(()=>{const r={...a};delete r.model;const g=V.stringify(r);u({search:g.length>0?`?${g}`:""})},[a,u]),{isLoading:y,data:h}=pe({clientThreadId:e,clientModelId:f.find(r=>!!r)??null,conversationMode:t}),C=R();M.useEffect(()=>{if(!(!n||y)){if(!o.has(n)||C.find(r=>r.model_slug===n))return v();T.setThreadModelId(e,n)}},[n,C,o,e]),M.useEffect(()=>{if(y||!h)return;const{default_model_slug:r}=h;n&&r&&n!==r&&v(),b.updateDetails(h),r&&T.setThreadModelId(e,r)},[y,h])};export{ke as E,Te as F,ue as a,be as c,ie as g,De as h,je as u};
//# sourceMappingURL=ee0lorinfbhctvv3.js.map
