import{m as e,aJ as c,r as u,gz as R,az as F,z as K,e as U,bA as $,P as E,d as _,bo as B,bi as H}from"./kqru8lsn8we722yx.js";import{u as L}from"./o7igidzcgzhnak6o.js";import{cU as W,ba as Q}from"./nms257ef1lzn00g8.js";import{e as X,d as C}from"./glw5ca81jajbw24p.js";import{P as J}from"./l6b3euh6ncxmeb2p.js";import{aQ as V}from"./jtfo8pfmx9vwsskh.js";import"./ewos3yaiq011b9ly.js";function T({title:a,content:t,buttons:n,time:s,icon:o,size:r="default",progressBar:d,disabled:i=!1,onClick:m}){const g=i?"border-token-dot-color border-opacity-10":"border-[rgba(0,0,0,0.1)] dark:border-[rgba(255,255,255,0.1)]",v=r==="small"?`w-[380px] pr-[15px] pl-[20px] pt-[13px] pb-[10px] ${i?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",f=m?"cursor-pointer":"",p=r==="small"?"text-[15px]":"";return e.jsxs("div",{className:c("inline-flex flex-col items-start justify-start rounded-2xl border",g,"bg-token-main-surface-primary dark:bg-token-main-surface-secondary",v,f,p),onClick:m,style:r==="small"&&!i?{boxShadow:"rgba(0, 0, 0, 0.06) 0px 2px 6px 0px"}:void 0,children:[e.jsxs("div",{className:c("flex flex-col items-start justify-start self-stretch",r!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:c("inline-flex items-start justify-start self-stretch",r!=="small"&&"gap-2"),children:[e.jsx("div",{className:c("shrink grow basis-0 font-medium leading-normal",i?"text-token-text-secondary":"text-token-text-primary"),children:a}),e.jsx("div",{className:"relative h-6 w-6"}),!i&&(o||e.jsx(V,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:c("flex w-full flex-col items-start justify-start",r==="small"&&"mt-[-2px]"),children:e.jsx("div",{className:c("inline-flex w-full items-start justify-start self-stretch rounded",r==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:c("w-full font-normal leading-relaxed",i?"text-token-text-tertiary":"text-token-text-secondary"),children:t})})})]}),d?e.jsxs("div",{className:c("mb-2 inline-flex items-center justify-between self-stretch",n?.length&&"mt-[-10px]"),children:[d,n]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[s&&e.jsx("div",{className:"shrink grow basis-0 text-[15px] font-normal leading-normal text-token-text-tertiary",children:s}),e.jsx("div",{className:"flex gap-2",children:n})]})]})}const Y={strong:a=>{const{node:t,children:n,...s}=a;return e.jsx("strong",{...s,className:c(s.className,"font-semibold text-token-text-primary"),children:n})},p:a=>{const{node:t,children:n,...s}=a;return e.jsx("p",{...s,className:c(s.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:n})}};function q({message:a,isExpandable:t}){const s=a.create_time?new Date(a.create_time*1e3):Date.now(),o=L(+s,48e4);return e.jsx(J,{percentage:o,className:c("mr-4",t?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-o)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function G({isExpandable:a,handleOpenSidebarSummarizer:t,summarizationHeadline:n,latestTitle:s,message:o}){return e.jsx("div",{className:"py-2",children:e.jsx(T,{buttons:[e.jsx(B,{onClick:t,color:"secondary",className:"!h-[38px] text-[15px] font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(H,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")],title:n,time:null,icon:e.jsx("div",{className:""}),content:`${s}...`,size:"small",progressBar:e.jsx(q,{message:o,isExpandable:a})})})}function Z({handleOpenSidebarSummarizer:a,summarizationHeadline:t,message:n}){return e.jsx("div",{className:"py-2",children:e.jsx(T,{buttons:[],title:t,time:null,content:n.metadata?.finished_text??"",size:"small",disabled:!0,onClick:a})})}function P({completionInProgress:a,latestTitle:t,message:n,summaryText:s,isExpandable:o,disableExpansion:r,onOpenAnalytics:d,handleOpenSidebarSummarizer:i}){return e.jsx(X,{status:a?C.Running:C.Finished,highlightedCommand:a?t:n.metadata?.finished_text??"",onOpenAnalytics:d,onClick:i,children:s&&o&&!r?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(Q,{componentOverrides:Y,className:"not-prose leading-6",children:s})}):null})}function le({messages:a,isStreaming:t,isLastMessage:n,clientThreadId:s,currentGroupedMessageIndex:o,turnIndex:r}){const[d,i]=u.useState(""),[m,g]=u.useState(!1),f=R(s)===F.STREAMING,p=f||t,l=a[0].message,N=l.id,k=K.getServerThreadId(s),x=U(l),h=l.metadata?.summarization_headline,A=t&&h!=null,{toggleThreadSidebar:S}=$(),D=l.metadata?.model_slug?.startsWith("o1")&&l.metadata?.model_slug?.endsWith("o"),z=W(),b=u.useCallback(()=>{S({type:"summarizer",clientThreadId:s,currentGroupedMessageIndex:o,turnIndex:r})},[S,s,o,r]);u.useEffect(()=>{const O=/\*\*(.*?)(?:\*\*|\n|$)/g;let w,y="";for(;(w=O.exec(x))!=null;)y=w[1].trim();y?i(y):l.metadata?.initial_text!=null&&i(l.metadata.initial_text)},[x,l.metadata?.initial_text]),u.useEffect(()=>{x.length>0&&g(!0)},[x]);const j=u.useMemo(()=>({client_thread_id:s,message_id:N,conversationId:k}),[s,N,k]);u.useEffect(()=>{m&&E.logEvent(_.receivedA8KM123Message,j)},[m]);const M=u.useCallback(()=>{E.logEvent(_.openedA8KM123Message,{...j,isStreaming:t})},[j,t]);return z?D?f&&n||t?e.jsx(G,{isExpandable:m,handleOpenSidebarSummarizer:b,summarizationHeadline:h??null,latestTitle:d,message:l}):e.jsx(Z,{handleOpenSidebarSummarizer:b,summarizationHeadline:h??null,message:l}):e.jsx(P,{completionInProgress:p,latestTitle:d,message:l,onOpenAnalytics:M,handleOpenSidebarSummarizer:m||!t?b:void 0}):e.jsx(P,{completionInProgress:p,latestTitle:d,message:l,onOpenAnalytics:M,summaryText:x,isExpandable:m,disableExpansion:A})}export{Y as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,le as default};
//# sourceMappingURL=ka01uml7k1d9yvnv.js.map
