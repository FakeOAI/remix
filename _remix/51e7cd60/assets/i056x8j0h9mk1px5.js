import{G as l,z as o,d9 as v,m as t,bm as p,bi as m,q as f,d as x}from"./kqru8lsn8we722yx.js";import{bc as C,bd as M,be as b,bf as h}from"./nms257ef1lzn00g8.js";import{u as T}from"./j1u34bbllqszg71b.js";import{q as y}from"./jtfo8pfmx9vwsskh.js";import{m as O}from"./ewos3yaiq011b9ly.js";const k=e=>{for(const s of e.concat().reverse()){if("messages"in s)return s.messages[s.messages.length-1].nodeId;if("message"in s)return s.message.nodeId}},_=({clientThreadId:e,lastMessageNodeId:s})=>{const n=p(e),r=C({clientThreadId:e,conversationMode:n}),i=async()=>{M();const a=[f.CANMORE],c=new b;r({id:s,eventMetadata:{eventSource:"mouse"},systemMessage:"The user has requested the canvas tool be disabled for this conversation. You should not call the tool again.",systemMessageMetadata:{disable_tool_ids:a},turnTracker:c});const d=o.getTree(e),u=d.getConversationTurns(s).length,g=d.getParentPromptNode(s).message.id;h.logEventWithStatsig(x.canvasOptOutClicked,"chatgpt_canvas_opt_out_clicked",{num_turns:String(u),user_message_id:g}),o.setDisabledToolsForThread(e,a)};return t.jsxs(O.div,{className:"mb-2 flex flex-wrap gap-2",initial:{opacity:0},animate:{opacity:1},children:[t.jsx(m,{id:"9NFVc4",defaultMessage:"Don't want me to use canvas?"}),t.jsxs("button",{onClick:i,className:"inline-flex min-h-5 w-fit select-none items-center text-start text-token-text-secondary hover:text-token-text-primary",children:[t.jsx(m,{id:"cXTG4f",defaultMessage:"I can answer in chat instead"}),t.jsx(y,{className:"icon-md text-token-text-secondary"})]})]})},q=({clientThreadId:e,groupedMessages:s,isFinalTurn:n,hasActiveRequest:r})=>{const i=T(e),a=k(s),c=l(()=>o.getLastMessgageSystemHints(e,o.getThreadCurrentLeafId(e)).includes(v.CANVAS));return n&&!c&&!r&&!i&&a&&t.jsx(_,{clientThreadId:e,lastMessageNodeId:a})};export{q as CanvasOptOutMessage};
//# sourceMappingURL=i056x8j0h9mk1px5.js.map
