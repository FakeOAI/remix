import{f5 as me,f6 as Y,cF as fe,f7 as b,r as m,df as ye,bn as ge,f8 as he,P as U,dN as pe,h as y,aQ as x,j as te,el as O,aM as re,c$ as Se,a as Z,f9 as Me,l as _e,a8 as Pe,aJ as N,R as ze,e3 as Ge,bz as ve,v as Ce,d7 as se,u as _,e as E,aG as J}from"./ges7pegusuwm6s29.js";import{cp as ne,cs as k,dc as Ee,fs as we,ft as De,cv as g,fu as Te,b$ as be,eS as T,ag as u,fv as qe,dJ as Fe,dD as Le,fw as Re,fx as Qe}from"./ca47xldfgc4qco9w.js";import{T as C,G as Ue,a as Ae}from"./nbmwj2w4tsu04xko.js";function He({clientThreadId:e}){const t=C.getThreadCurrentLeafId(e),s=C.getTree(e).getMessage(t).metadata?.model_switcher_deny??[],n={};s.forEach(i=>{const{slug:a,context:l,reason:d,description:c}=i,f=n[a]??{},h=f[l]??[];h.push({reason:d,description:c}),f[l]=h,n[a]=f});const o=me();for(const{resets_after:i,model_slug:a}of o)[Y.CONVERSATION,Y.REGENERATE].forEach(l=>{const d=n[a]??{},c=d[l]??[],f={reason:fe.RATE_LIMIT,resetsAfter:i};c.push(f),d[l]=c,n[a]=d});return n}const it="text-davinci-002-render-sha",at="gpt-4",ut="gpt-4o",ct="o1-preview",lt="o1-mini",A=ne({slug:k,max_tokens:4097,title:"Default",description:"",tags:[b.GPT_3_5],product_features:{}}),xe=({default_model:e,tagline:t,color:r,human_category_name:s,category:n,human_category_short_name:o,human_category_shorter_name:i,subscription_level:a,short_explainer:l,subcategory:d,is_beta:c,...f})=>({color:r,tagline:t,defaultModel:e,label:s,shortLabel:o,description:l,shorterLabel:i??o,subscriptionLevel:a,categoryId:n,subcategory:d,isBeta:c,...f}),Ke=({icon:e,icon_filled_src:t,icon_outline_src:r})=>({iconName:e,iconFilledSrc:t,iconOutlineSrc:r}),Ie=({group:e,human_group_name:t,human_group_short_name:r,model_ids:s})=>({group:e,label:t,shortLabel:r,modelIds:s});function Oe(){return x({retry:5,queryKey:["modelIcons"],queryFn:async()=>await te.getModelIcons().then(e=>Object.fromEntries(Object.entries(e).map(([t,r])=>[t,Ke(r)])))})}function Ne(e){return x({retry:5,queryKey:["models",{isHistoryDisabled:e}],queryFn:async()=>await te.getModels(e).then(t=>{const{models:r,internal_groups:s,categories:n}=t,o=r.map(ne);return{categories:n.concat().reverse().map(xe),groups:s?.map(Ie)??[],modelsList:o,modelsMap:Object.fromEntries(o.map(i=>[i.id,i]))}})})}function w(){const e=pe();return y(Ne(e))}function dt(){return y(Oe())}function ke({isRegen:e=!1}={}){const{isLoading:t,data:{categories:r=[],groups:s=[]}={}}=w(),n=m.useMemo(()=>e?r.filter(o=>o.is_regenerate_category!==!1):r.filter(o=>!o.is_regenerate_category),[r,e]);return{isLoading:t,categories:n,groups:s??[]}}function mt(){const{categories:e}=ke();return!!e.find(({categoryId:t})=>t===Ee.GPT4o)}function ft(){const{data:e}=w();return m.useMemo(()=>e?new Set(Object.keys(e.modelsMap)):new Set([k]),[e])}const Be={[k]:A};function $e(){const{data:e}=w();return e?.modelsMap??Be}function oe(e,t,r){let s=b.GPT_3_5;return r?s=b.GPT_4:t&&(s=b.GPT_4o),e?.modelsList.find(n=>n.tags.includes(s))??e?.modelsList[0]??A}function yt(e=!1){const t=ye(),r=ge(),[,s]=he();return m.useCallback(({location:n,modelId:o})=>{const i=t.pathname.includes("/g/");e||i?(U.logNewChatButtonClicked({location:n}),r({pathname:"/",search:`?model=${encodeURIComponent(o)}`})):(s(a=>(a.set("model",encodeURIComponent(o)),a)),U.logNewChatButtonClicked({location:n}))},[e,t,r,s])}function gt(){const{data:{categories:e=[]}={}}=w(),{doesUserHaveAnyAccountsWithPlusFeatures:t}=O();return t?null:e.find(we)?.defaultModel??null}function je(e){return Ue(e)}function ie(e){const t=je(e),r=$e();return m.useMemo(()=>t==null?A:r[t]??A,[t,r])}function We(e,t){return ie(e).enabledTools?.includes(t)??!1}function ht(e){const t=De(),r=ie(e),s=m.useMemo(()=>!t.isSuccess||!t.data?[]:t.data,[t.data,t.isSuccess]),n=He({clientThreadId:e});return m.useMemo(()=>{const i=new Set(r.enabledTools||[]);return s.filter(a=>!(!(a.requiredFeatures.length===0||a.requiredFeatures.every(c=>i.has(c)))||!(a.requiredModels.length===0||a.requiredModels.some(c=>!n[c]))))},[s,r,n])}function pt(e){return decodeURIComponent(e.model??"")||null}function St(){const{data:e}=w(),{doesUserHaveAnyAccountsWithPlusFeatures:t}=O(),r=re();return oe(e,!!t,!!r?.isEnterprise())}const X=e=>({turn_index:e.turnIndex,thread_id:e.threadId,conversation_id:e.clientThreadId?C.getServerThreadId(e.clientThreadId):void 0,message_id:e?.messageId}),Ve="hints";class H extends Se()(t=>({persistedSystemHints:new Set(t)})){static getPersistedSystemHints=({persistedSystemHints:t})=>t;addPersistedSystemHint=(t,r)=>{t===g.Search&&U.logEvent(Z.searchModeEngaged,X(r)),this.setState(({persistedSystemHints:s})=>({persistedSystemHints:new Set(s).add(t)}))};removePersistedSystemHint=(t,r)=>{t===g.Search&&U.logEvent(Z.searchModeDisabled,X(r)),this.setState(({persistedSystemHints:s})=>{const n=new Set(s);return n.delete(t),{persistedSystemHints:n}})}}const Mt=()=>H.useState(H.getPersistedSystemHints);function _t({children:e,clientThreadId:t,currentLeafId:r}){const s=We(t,Me.Search),o=C.getLastMessgageSystemHints(t,r).includes(g.Search)&&s,[i]=m.useState(()=>new H(o?[g.Search]:[]));return m.useEffect(()=>{const a=i.getState().persistedSystemHints;o&&!a.has(g.Search)&&i?.addPersistedSystemHint(g.Search,{clientThreadId:t,turnIndex:0})},[o,i,t]),_e.jsx(H.Provider,{store:i,children:e})}function Ye(e){const t=new Set;if(e){const r=e.split(",");Array.isArray(r)&&r.forEach(s=>{Object.values(g).includes(s)&&t.add(s)})}return t}const ae="q",Ze="m";function Pt(e){const{clientThreadId:t,currentLeafId:r,handleRequestCompletion:s}=e,n=m.useRef(!1),{isLoading:o,data:i}=w(),{doesUserHaveAnyAccountsWithPlusFeatures:a,isLoading:l}=O(),d=re(),c=Pe(),f=N(),h=m.useCallback((p,P,S,z)=>{C.updateTree(t,G=>{G.addNode(p,S,P,ze.User,void 0,z)})},[t]),$=m.useCallback(async(p,{content:P,attachments:S},z,G,D,R)=>{const I=r,v=S.length>0?{attachments:S}:{};v.system_hints=G.systemHints,h(p,I,P,v),s({type:Ge.Next,promptId:p,requestedModelId:R,eventMetadata:z,cancelActiveRequests:!0,completionMetadata:G,turnTracker:D})},[h,s,r]),F=ve(()=>window.location.pathname)??null,j=Te();let W=!o&&!l&&F!=null;const[K,L]=m.useState(!0);return m.useEffect(()=>{if(!K||n.current)return;const p=Ae.getConversationMode(t);if(!W||p==null)return;if(!Xe(F)||Je(F)&&j===void 0||C.getServerThreadId(t)!=null){L(!1);return}const{[ae]:P,[Ze]:S,[Ve]:z,...G}=c.query,D=(typeof P=="string"?P:null)??(typeof S=="string"?S:null);if(!D||!D.trim()){L(!1);return}const R=Ye(z),I=Ce();n.current=!0;let v=i?.modelsList;R.has(g.Search)&&(v=v?.filter(Q=>Q.enabledTools?.includes(g.Search)));const V=i&&oe({...i,modelsList:v??[]},!!a,!!d?.isEnterprise());if(c.replace({query:G},void 0,{shallow:!0}),V==null){f.warning("No model available for this request"),L(!1);return}const de=new be;(e.prefetchSearchPromise??Promise.resolve(null)).then(Q=>{$(I,{content:D,attachments:[]},{eventSource:"url"},{conversationMode:p,source:"instant-query",systemHints:z?Array.from(R):void 0,prefetchIds:Q!=null?[Q]:void 0},de,V?.id),L(!1)})},[o,l,W,F,c,i,a,d,$,K,t,j,f,e.prefetchSearchPromise]),K}function Je(e){return ue(e)}function ue(e){return e==null?!1:/^\/g\/[\w-]+$/.test(e)}function Xe(e){return e==null?!1:e==="/"||ue(e)}const zt="GPT Builder";function Gt(e){if(e)return`ChatGPT - ${e}`}function B(e){return e.gizmo.short_url??e.gizmo.id??"-"}function ce(e){return`/g/${e}`}function vt(e){return`https://chatgpt.com${ce(e)}`}function et(e){return ce(B(e))}function Ct(e,t){const r=new URLSearchParams;return t!=null&&r.set(ae,t),qe(new URL(`${et(e)}?${r}`,"https://chatgpt.com"))}function Et(e){return`/g/${B(e)}`}function wt(e){return Fe(e)&&e.gizmo.live_version===0||Le(e)&&e.liveVersion===0}function Dt(e,t){return y({queryKey:["gizmos","discovery",{locale:e,isAnon:t}],queryFn:async()=>u.getGizmoDiscovery(e,t)})}function Tt({cutId:e,locale:t,limit:r,cursor:s,enabled:n=!0}){return se({queryKey:["gizmos","discovery",{cutId:e,locale:t,limit:r}],queryFn:async({pageParam:o})=>u.getGizmoDiscoveryCut(e,{locale:t,cursor:o,limit:r}),initialPageParam:s,getNextPageParam:o=>o.list.cursor??void 0,enabled:n})}function bt(){return y({queryKey:["gizmos","pinned"],queryFn:async()=>u.getGizmoPinned()})}function q(){return x({queryKey:["gizmos","bootstrap"],queryFn:async()=>u.getGizmoBootstrap().then(e=>({gizmos:e.gizmos.map(t=>({resource:t.resource,flair:t.flair}))}))})}function qt(){return y(q())}function ee(e,t){const r=e.filter(n=>n.resource.gizmo.id!==t.resource.gizmo.id);let s=r.findIndex(n=>n.flair.kind===T.Recent);return s===-1&&(s=r.length),r.splice(s,0,t),r}const Ft={handleGizmoInteracted(e,t){const r=e.getQueryData(M(e,t).queryKey);r!=null&&e.setQueryData(q().queryKey,s=>{if(s==null)return s;const n=s.gizmos.find(o=>o.resource.gizmo.id===t);return n?.flair.kind===T.FirstParty||n?.flair.kind===T.SidebarKeep?s:{gizmos:ee(s.gizmos,{resource:r,flair:{kind:T.Recent}})}})},handleGizmoSidebarKeep(e,t){const r=e.getQueryData(M(e,t).queryKey);r!=null&&e.setQueryData(q().queryKey,s=>s==null?s:{gizmos:ee(s.gizmos,{resource:r,flair:{kind:T.SidebarKeep}})})},handleGizmoSidebarHide(e,t){e.setQueryData(q().queryKey,r=>r?.gizmos.some(s=>s.resource.gizmo.id===t)?{gizmos:r.gizmos.filter(s=>s.resource.gizmo.id!==t)}:r)}};function Lt(e,t=!1){const r=_();return y(M(r,e,t))}function Rt({gizmoId:e,draft:t,version:r}){const s=_(),n=r?{queryKey:["gizmo","version",{gizmoId:e,version:r}],queryFn:async()=>u.getVersion({gizmoId:e,version:r}),enabled:e!=null}:M(s,e,t);return y(n)}function Qt(e,t){return y({queryKey:["gizmo","userActionSettings",{gizmoId:e}],queryFn:async()=>u.getUserActionSettings(e),enabled:e!=null&&t})}function M(e,t,r=!1){return x({queryKey:["gizmo",{gizmoId:t},{draft:r}],queryFn:async()=>u.getGizmo(t,r),enabled:t!=null,initialData:()=>{if(r===!0)return;const s=e.getQueryData(q().queryKey);if(s!=null)return s.gizmos.find(o=>o.resource.gizmo.id===t)?.resource;const n=e.getQueryData(["gizmos","discovery"]);if(n!=null)for(const o of n.cuts){const i=o.list.items.find(a=>a.resource.gizmo.id===t)?.resource;if(i!=null)return i}}})}function Ut(e,t){return e.fetchQuery(M(e,t))}function At(e){return y({queryKey:["gizmo",{search:e}],queryFn:async()=>u.getGizmoSearch(e),enabled:e.length>0})}function Ht(e,t){return y({queryKey:["gizmo-search-workspace",{search:e}],queryFn:async()=>u.getGizmoSearchForWorkspace(e),enabled:e.length>0&&t})}function xt(e,t=!1,r=!1,s=null){return se({queryKey:[r?"gizmo-search-workspace":"gizmo",{query:e,cursor:s}],queryFn:async({pageParam:n})=>r?u.getGizmoSearchForWorkspace(e,s=n):u.getGizmoSearch(e,s=n),initialPageParam:s,getNextPageParam:n=>n.cursor??void 0,enabled:t})}function Kt(){const e=_();return E({mutationFn:async({gizmoId:t,editorData:r})=>{const{instructions:s,name:n,description:o,profilePictureId:i,profilePictureUrl:a,promptStarters:l,tools:d,files:c,trainingDisabled:f}=r;return u.upsertDraft({instructions:s,display:{name:n,description:o,profile_pic_id:i,profile_picture_url:a,prompt_starters:l},tools:d,files:c.map(h=>({...h,location:Re.FILE_SERVICE})),training_disabled:f},t)},onSettled:t=>{t&&(e.setQueryData(M(e,t.gizmo.id,!0).queryKey,t),e.invalidateQueries({queryKey:["gizmos","mine"],refetchType:"none"}))}})}function It(){const e=_();return E({mutationFn:async({gizmoId:t,data:r})=>{const{sharingRecipient:s,categories:n}=r,o=await u.promoteDraft({sharing:r.sharingSubjects&&r.sharingSubjects.length>0?r.sharingSubjects:{recipient:s},categories:n},t);if(o.error)throw new Qe(o);return o.resource},onSettled:t=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"}),e.invalidateQueries({queryKey:["gizmos","pinned"],refetchType:"none"}),t&&e.setQueryData(M(e,t.gizmo.id,!1).queryKey,t)}})}function Ot(){const e=_();return E({mutationFn:async({gizmoId:t})=>u.deleteGizmo(t),onSettled:()=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"})}})}function Nt(){const e=_(),t=N();return E({mutationFn:async({name:r,hideName:s,websiteUrl:n,willReceiveSupportEmails:o})=>u.updateBuilderProfile({name:r,hide_name:s,website_url:n,will_receive_support_emails:o}),onSuccess:r=>{e.setQueryData(["builderProfile"],r)},onError:r=>{t.warning(r.message)}})}function kt(){return y({queryKey:["builderProfile"],queryFn:async()=>u.getBuilderProfile()})}function Bt(){return E({mutationFn:async({gizmoId:e})=>u.copyGizmo({gizmoId:e})})}function $t(){return y({queryKey:["gizmoCategories"],queryFn:async()=>u.getCategories()})}function jt(e,t){return!!(t!=null&&[J.PrimaryAssistant,J.GizmoInteraction].includes(t)&&e?.includes(b.GPT_4))}function Wt(e,t){const r=_(),s=N();return E({mutationFn:async({rating:n,message:o,includeFrom:i})=>{await u.upsertUserReview(e,n,o,i)},onSuccess:async()=>{r.invalidateQueries({queryKey:["gizmo","review",{gizmoId:e}]})},onError:n=>{s.danger(n.message)}})}function Vt(e,t){return t?`/g/${B(t)}/c/${e}`:`/c/${e}`}function Yt(){return"/gpts"}function Zt(){return"/gpts/mine"}function le(e){return e?`/gpts/editor/${e}`:"/gpts/editor"}function Jt(e){const t=tt();return e==null?t:le(e)}function tt(e){return le(e)}function Xt(e){try{const t=new URL(e);return t.hostname=t.hostname.replace(/^(www\.|web\.|mbasic\.|mobile\.)(secure\.)?/,""),t.pathname="",[...t.searchParams.keys()].forEach(r=>t.searchParams.delete(r)),t.toString()}catch{return e}}function rt(e){if(!e)return null;try{return new URL(e).hostname}catch{return null}}function er(e){const t=rt(e);return t?t.replace(/^www\./,""):e}export{$e as $,Ct as A,Bt as B,Xt as C,Qt as D,Jt as E,Mt as F,ut as G,X as H,ie as I,St as J,_t as K,Zt as L,kt as M,Nt as N,$t as O,H as P,Rt as Q,w as R,at as S,Kt as T,It as U,M as V,Ut as W,ft as X,pt as Y,We as Z,ht as _,je as a,jt as a0,zt as a1,ct as a2,lt as a3,dt as a4,He as a5,gt as a6,it as a7,Pt as a8,Lt as b,mt as c,et as d,Wt as e,Ot as f,Vt as g,Et as h,At as i,Ht as j,Tt as k,xt as l,Dt as m,Yt as n,le as o,er as p,ce as q,Gt as r,wt as s,tt as t,yt as u,ke as v,qt as w,Ft as x,bt as y,vt as z};
//# sourceMappingURL=k0upi5o9s0wxrxei.js.map
