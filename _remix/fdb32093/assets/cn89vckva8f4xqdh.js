import{r as u,ay as z,fs as ie,d9 as B,L as M,U as b,P as y,d as _,m as e,cc as re,aZ as v,t as le,aT as S,N as ce,fq as de,ae as ue,n as pe,ag as ge,K as me,V as Q,ge as fe,q as R,e_ as he,o as xe}from"./iu6mboesujxn4nfb.js";import{bl as be,bm as G,bn as Y,bo as ye,aJ as $,bp as K,bq as _e,br as we,bs as Se,bt as ve,bu as V,bv as ke,bw as Me,z as je,bx as Ee,by as Ce,bz as Ne,bA as Te,bB as Pe,bb as Ie}from"./c2hyzre7f4ii3ino.js";import{aI as De}from"./jv6pyre8jh3l43kj.js";import{C as Le}from"./ifbyvbggfvncivq2.js";import{H as qe}from"./g4tl5lt9yqf20m4s.js";import"./jqapc3rgx3huae9u.js";import{m as k}from"./jd3emv5q80oapmi8.js";import"./hjb1gvpzf4dnrl85.js";import"./ey0gohdhgx5jn14h.js";import"./mmlc82xsfvko1ivt.js";import"./hrwtj2qx4tti9ch9.js";import"./fst6tvozowwv982i.js";import"./b86ctlripa44g4rx.js";function Ue(t,n){const{data:o,isLoading:r,isSuccess:p,isError:i}=le({queryKey:["onboardingSteps",t,n],queryFn:()=>Q.createOnboardingSteps(void 0,t,n)});return{steps:o?.steps??[],isLoading:r,isSuccess:p,isError:i}}function j({children:t,className:n}){return e.jsx(k.div,{className:n,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.25},exit:{opacity:0,y:-10},children:t})}function Ae({isFirstStep:t,userName:n}){return e.jsx(j,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...t?a.preparingOnboardingExperience:a.allSetLetMeShowYouAroundWithoutName,values:{name:n,nextLine:o=>e.jsx("span",{className:"block",children:o})}})})})}function Fe({setIsInWelcomePage:t}){const n=G();return u.useEffect(()=>{n&&setTimeout(()=>{t(!1)},2500)},[n,t]),n?e.jsx(j,{children:e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...a.imChaggptNiceToMeetYou})})}):null}function Oe(t){const n=K(),o=M(),r=ce(),p=_e(t);let i=we(t);const g=Se(p,i),s=ve(p,i);return u.useCallback(async l=>{const h="text/plain",x=new Blob([l],{type:h}),m=new File([x],"My_File.txt",{type:h});return V.uploadFile(n,ke(m),m,Me.Retrieval,s,o,r,void 0,g?.attachments)},[n,o,r,s,g?.attachments])}function nt({clientThreadId:t,setClientThreadId:n}){const[o,r]=u.useState(!0),{isOpen:p,setIsOpen:i,markAsViewed:g}=be(),[s,l]=u.useState(0),[h,x]=u.useState(new Set(["usage_question"])),[m,E]=u.useState([]),[P,J]=u.useState(),[I,D]=u.useState(!1),{steps:f,isLoading:C,isError:N}=Ue(I?m:[],I?P:void 0),Z=G(),L=ze({clientThreadId:t,setClientThreadId:n}),q=Oe(t),{createNewThread:U}=Y({clientThreadId:t,setClientThreadId:n}),X=z(t),A=ie(t,X),{layer:ee}=B("717266490"),te=ee.get("keep_onboarding_after_dismiss",!1),F=M();u.useEffect(()=>{p&&(b.logEvent("chatgpt_onboarding_flow_shown"),y.logEvent(_.onboardingShown))},[p]),u.useEffect(()=>{N&&(g(),b.logEvent("chatgpt_onboarding_flow_error"),y.logEvent(_.onboardingError))},[N,g]),u.useEffect(()=>{if(!(C||!f[s])&&!h.has(f[s].step_type)){x(w=>new Set([...w,f[s].step_type]));const d=f[s].step_prompt;d&&(L({stepPrompt:d}),f[s].step_type==="file_upload"&&f[s].additional_info&&q(f[s].additional_info))}},[s,C,h,L,f,q]);const c=f[s];if(u.useEffect(()=>{const d=c?.step_type;(d==="usage_question"||d==="self_description")&&A&&(U(),x(w=>new Set(Array.from(w).filter(O=>O==="usage_question"||O==="self_description"))))},[c?.step_type,U,A]),u.useEffect(()=>{c?.step_type&&(b.logEvent("chatgpt_onboarding_step_shown",null,{step_type:c?.step_type,step_index:s.toString()}),y.logEvent(_.onboardingStepShown,{step_type:c?.step_type,step_index:s.toString()}))},[s,c?.step_type]),N)return null;const T=d=>{i(!1),s===f.length-1?(b.logEvent("chatgpt_onboarding_flow_finished"),y.logEvent(_.onboardingFinished)):(b.logEvent("chatgpt_onboarding_flow_dismissed",null,{step_type:c?.step_type,step_index:s.toString()}),y.logEvent(_.onboardingDismissed,{step_type:c?.step_type,step_index:s.toString()})),d&&!te&&g()},se=d=>{E(d),f.find(w=>w.step_type==="self_description")||D(!0),l(w=>w+1),b.logEvent("chatgpt_onboarding_usage_question_selected",null,{main_usages:d.join(", ")}),y.logEvent(_.onboardingUsageQuestionSelected,{main_usages:d.join(", ")})},ne=d=>{J(d),D(!0),l(w=>w+1),b.logEvent("chatgpt_onboarding_self_description_entered",null,{main_usages:m.join(", ")}),y.logEvent(_.onboardingSelfDescriptionEntered,{main_usages:m.join(", ")})},oe=()=>{b.logEvent("chatgpt_onboarding_usage_question_skipped",null,{step_type:c?.step_type,step_index:s.toString()}),y.logEvent(_.onboardingUsageQuestionSkipped,{step_type:c?.step_type,step_index:s.toString()}),l(d=>d+1)},ae=()=>{b.logEvent("chatgpt_onboarding_go_back",null,{step_type:c?.step_type,step_index:s.toString()}),y.logEvent(_.onboardingGoBack,{step_type:c?.step_type,step_index:s.toString()}),l(d=>d-1)};return e.jsx(re,{isOpen:p,onClose:()=>T(!1),type:"success",size:"fullscreen",noPadding:!0,className:"w-full",children:e.jsx(ye,{clientThreadId:t,children:e.jsxs("div",{className:"flex h-full max-h-full flex-col bg-gradient-to-b from-brand-blue-800/15 to-gray-50 dark:from-brand-blue-800/15 dark:to-token-main-surface-primary",children:[e.jsxs("div",{className:"absolute left-0 top-0 z-10 flex w-full items-center justify-between bg-none px-4",style:{minHeight:"var(--screen-thread-header-min-height,60px)"},children:[f&&f.length>0&&e.jsx("div",{className:"absolute left-0 top-0 h-2 w-full",children:e.jsx(k.div,{className:"h-1.5 bg-token-main-surface-primary-inverse",initial:{width:"0%",opacity:0},animate:{width:`${(s+1)/f.length*100}%`,opacity:1},transition:{duration:.3}})}),s>0?e.jsx(v,{onClick:ae,color:"ghost",className:"border-none",icon:De}):e.jsx("div",{}),c?.step_type==="usage_question"||c?.step_type==="self_description"?e.jsx(v,{onClick:oe,color:"ghost",className:"border-none",children:F.formatMessage(a.skip)}):e.jsx(v,{onClick:()=>T(!0),color:"ghost",className:"border-none",children:F.formatMessage(a.close)})]}),e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center overflow-hidden",children:e.jsx($,{mode:"wait",children:o?e.jsx(Fe,{setIsInWelcomePage:r},"welcome"):C?e.jsx(Ae,{isFirstStep:s<1,userName:Z?.name},"loading"):c?.step_type==="usage_question"?e.jsx(Re,{mainUsagesProp:m,onSelectMainUsages:se},"usage-question"):c?.step_type==="self_description"?e.jsx(We,{mainUsages:m,selfDescriptionProp:P,onEnterSelfDescription:ne},"self-description"):["dalle","file_upload","canvas","voice"].includes(c?.step_type)?e.jsx(He,{step:c,gotoStep:l,stepIndex:s,totalSteps:f.length,endOnboarding:T,clientThreadId:t},"tools-onboarding"):null})})]})})})}function Re({mainUsagesProp:t,onSelectMainUsages:n}){const[o,r]=u.useState(new Set(t)),p=M();return e.jsxs(j,{children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-2 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...a.tellMeWhyHere})}),e.jsx("p",{className:"mb-6 text-base text-token-text-secondary",children:e.jsx(S,{...a.suggestUsefulIdeas})})]}),e.jsx("div",{className:"flex flex-col items-start justify-start gap-5",children:["school","work","personalTasks","funAndEntertainment"].map(i=>e.jsx(je,{id:`main-usage-${i}`,checked:o.has(i),onChange:g=>r(s=>{const l=new Set(s);return g.target.checked?l.add(i):l.delete(i),l}),label:e.jsx("span",{className:"cursor-pointer",children:p.formatMessage(a[i])})},i))}),e.jsx(v,{size:"medium",color:"primary",onClick:()=>n(Array.from(o)),className:"mt-10",disabled:o.size===0,children:e.jsx(S,{...a.next})})]})}function We({mainUsages:t,selfDescriptionProp:n,onEnterSelfDescription:o}){const[r,p]=u.useState(n),i=M(),g=u.useMemo(()=>t.includes("school")?a.exampleSchoolSelfDescription:t.includes("work")?a.exampleWorkSelfDescription:t.includes("funAndEntertainment")?a.exampleFunAndEntertainmentSelfDescription:a.examplePersonalTasksSelfDescription,[t]),{layer:s}=B("717266490"),l=s.get("write_custom_instructions_in_onboarding",!1),h=async()=>{o(r),l&&r&&Q.createOrUpdateUserSystemMessage({aboutUserMessage:r,aboutModelMessage:"",disabledTools:[],enabled:!0}).catch(()=>{})};return e.jsxs(j,{className:"flex w-[640px] flex-col items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"mb-4 text-3xl font-medium leading-9 text-token-text-primary",children:e.jsx(S,{...a.anythingElseYouWantMeToKnow})}),e.jsx("p",{className:"text-base text-token-text-secondary",children:e.jsx(S,{...l?a.selfDescriptionReasonSaveToCustomInstructions:a.selfDescriptionReason,values:{customInstructions:x=>e.jsx("a",{href:qe,className:"underline",target:"_blank",rel:"noreferrer",children:x})}})})]}),e.jsx(Ee,{className:"!dark:bg-white/5 mt-10 rounded border border-token-border-light !bg-black/5 p-5 !text-base placeholder-token-text-tertiary",placeholder:i.formatMessage(g),rows:4,value:r,onChange:x=>p(x.target.value),autoFocus:!0}),e.jsx(v,{size:"medium",color:"primary",onClick:h,className:"mt-10",children:e.jsx(S,{...a.next})})]})}function He({step:t,gotoStep:n,stepIndex:o,totalSteps:r,endOnboarding:p,clientThreadId:i}){const g=de({clientThreadId:i}),s=Ce(),l=K(),h=M(),x=o===r-1,m=()=>{o<r-1?(b.logEvent("chatgpt_onboarding_flow_next_clicked",null,{source_step_type:t?.step_type,source_step_index:o.toString()}),y.logEvent(_.onboardingNextClicked,{source_step_type:t?.step_type,source_step_index:o.toString()}),t?.step_type==="file_upload"&&V.reset(l),n(o+1)):(p(!0),s())};return e.jsxs(j,{className:"flex h-full w-full flex-row px-8 md:px-12 lg:px-16 xl:px-24",children:[e.jsx("div",{className:"flex flex-1 flex-col items-center justify-center",children:e.jsxs(k.div,{className:"flex w-[90%] flex-1 flex-col items-start justify-center gap-2 md:w-[85%] lg:w-[80%]",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsxs($,{mode:"wait",children:[e.jsx(k.h1,{className:"mb-2 text-3xl font-medium text-token-text-primary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.title?t.title:W[t.step_type]?h.formatMessage(W[t.step_type]):null},`title-${o}`),e.jsx(k.p,{className:"mb-6 text-base text-token-text-secondary",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.5},exit:{opacity:0,y:-10},children:t.subtitle?t.subtitle:H[t.step_type]?h.formatMessage(H[t.step_type]):null},`subtitle-${o}`)]}),e.jsx(v,{size:"large",color:"primary",onClick:m,disabled:g&&!x,children:e.jsx(S,{...x?a.tryChatGPT:a.next})})]})}),e.jsx("div",{className:"relative flex h-full min-w-[360px] flex-1 flex-col pb-16 pt-16",children:e.jsx("div",{className:"h-full w-full overflow-auto rounded-[30px] bg-token-main-surface-primary shadow-2xl shadow-token-border-xlight",children:e.jsx(Le,{hideHeader:!0,hideTools:!0,embedded:!0})})})]})}const ze=({clientThreadId:t,setClientThreadId:n})=>{const o=Ne(t),r=Te(),{onThreadCreated:p}=Y({clientThreadId:t,setClientThreadId:n}),{onRequestCompletion:i}=Pe({clientThreadId:t,currentModelId:o,defaultModelId:r.id,onThreadCreated:p}),g=z(t);return u.useCallback(({stepPrompt:s})=>{const l=new Ie,h=`${g}-nextPrompt`,x=()=>{const m=fe.getTextAsMessage(s,R.User);m.author.metadata=m.author.metadata||{},m.author.metadata.real_author=he.Onboarding,xe.updateTree(t,E=>{E.addNode(h,m,g,R.User,void 0,void 0)})};i({type:ue.Next,promptId:h,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!0,completionMetadata:{conversationMode:pe(ge.getConversationMode(t)),isOnboardingConversation:!0},updateTree:x,turnTracker:l})},[t,i,g])},a=me({skip:{defaultMessage:"Skip",id:"chatgpt.new-onboarding.skip"},close:{defaultMessage:"Close",id:"chatgpt.new-onboarding.close"},submit:{defaultMessage:"Submit",id:"chatgpt.new-onboarding.submit"},next:{defaultMessage:"Next",id:"chatgpt.new-onboarding.next"},finish:{defaultMessage:"Finish",id:"chatgpt.new-onboarding.finish"},tellMeWhyHere:{defaultMessage:"Tell me about why you’re here.",id:"chatgpt.new-onboarding.tell-me-why-here"},suggestUsefulIdeas:{defaultMessage:"I’ll use this information to suggest ideas you might find useful.",id:"chatgpt.new-onboarding.suggest-useful-ideas"},school:{defaultMessage:"School",id:"chatgpt.new-onboarding.school"},work:{defaultMessage:"Work",id:"chatgpt.new-onboarding.work"},personalTasks:{defaultMessage:"Personal tasks",id:"chatgpt.new-onboarding.personal-tasks"},funAndEntertainment:{defaultMessage:"Fun and entertainment",id:"chatgpt.new-onboarding.fun-and-entertainment"},imChaggptNiceToMeetYou:{defaultMessage:"Hi, I’m ChatGPT. It’s nice to meet you!",id:"chatgpt.new-onboarding.im-chatgpt-nice-to-meet-you"},preparingOnboardingExperience:{defaultMessage:"Preparing your onboarding experience...",id:"chatgpt.new-onboarding.preparing-onboarding-experience"},oneLastQuestion:{defaultMessage:"One last question:",id:"chatgpt.new-onboarding.one-last-question-2"},anythingElseYouWantMeToKnow:{defaultMessage:"Is there anything else you’d like me to know?",id:"chatgpt.new-onboarding.anything-else-you-want-me-to-know-2"},oneQuestionAnythingElse:{defaultMessage:"One last question: Is there anything else you’d like me to know?",id:"chatgpt.new-onboarding.one-more-question"},selfDescriptionReason:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant.",id:"chatgpt.new-onboarding.self-description-reason"},allSetLetMeShowYouAroundWithoutName:{defaultMessage:"All set!<nextLine></nextLine>Now, let me show you around...",id:"chatgpt.new-onboarding.all-set-let-me-show-you-around-without-name"},selfDescriptionReasonSaveToCustomInstructions:{defaultMessage:"Details like your job, hobbies, or interests make my responses more relevant. I’ll save this information as <customInstructions>Custom Instructions</customInstructions>, which you can update any time.",id:"chatgpt.new-onboarding.self-description-reason-save-to-custom-instructions"},exampleSchoolSelfDescription:{defaultMessage:"I'm a college student studying computer science, and I love to play the guitar.",id:"chatgpt.new-onboarding.example-school-self-description"},exampleWorkSelfDescription:{defaultMessage:"I'm a graphic designer based in Berlin, and I enjoy painting and attending art exhibitions.",id:"chatgpt.new-onboarding.example-work-self-description"},examplePersonalTasksSelfDescription:{defaultMessage:"I live in Sydney and love cooking new recipes and planning travel itineraries.",id:"chatgpt.new-onboarding.example-personal-tasks-self-description"},exampleFunAndEntertainmentSelfDescription:{defaultMessage:"I'm a music enthusiast based in Nashville, and I can talk for hours about guitar techniques and songwriting.",id:"chatgpt.new-onboarding.example-fun-and-entertainment-self-description"},tryChatGPT:{defaultMessage:"Try ChatGPT",id:"chatgpt.new-onboarding.try-chatgpt"}}),W={usage_question:a.tellMeWhyHere},H={usage_question:a.suggestUsefulIdeas};export{Ae as LoadingState,nt as default};
//# sourceMappingURL=cn89vckva8f4xqdh.js.map
