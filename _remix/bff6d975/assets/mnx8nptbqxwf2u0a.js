const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/e04nd7pz1mn10n0u.js","assets/pd64dl4pt4e5g9vc.js","assets/iw8eqo9ou59qhn0h.js","assets/root-fk4ggifc.css","assets/be5j3lin9z9akqco.js","assets/g5tg1ou1mdwoqo8e.js","assets/conversation-small-ni0cc2o5.css","assets/jff4q9zofpalq4v1.js","assets/gea76n0cnf3u5b5x.js","assets/dhmm93wh7jq47k0y.js"])))=>i.map(i=>d[i]);
import{V as D,aJ as te,r as I,l as e,W as E,Z as n,bd as L,a0 as k,e as z,a1 as U,dh as j,a_ as se,m as ie,u as O,j as ne,aC as oe,aD as re,aM as ce,bi as de,bP as W,bT as C,bQ as M,d$ as le,Q as $,bA as B,P as me,e2 as ue,az as ge}from"./pd64dl4pt4e5g9vc.js";import{aB as he,aQ as P,aF as f,W as pe,ak as S,a3 as p,Y as fe,Z as xe,_ as ve,e0 as V,d3 as we,e1 as be,e2 as ye,bO as _,cY as q,bF as K}from"./g5tg1ou1mdwoqo8e.js";import{F as je,H as Se,h as Ge}from"./jff4q9zofpalq4v1.js";import{p as Ie,T as Ce,b as Me,S as ke,aN as ze,v as Pe,Y as Ae,O as Te,b8 as _e,aK as Fe,b9 as Q,a as Ne,ba as De,r as Ee,aD as Le,N as Ue,aw as Oe}from"./iw8eqo9ou59qhn0h.js";import{b as We,T as $e,s as Be}from"./gea76n0cnf3u5b5x.js";import{G}from"./js63cbf9w70vcbjp.js";import{R as Ve}from"./o6r2244vsndh82mo.js";import{B as J,D as o}from"./be5j3lin9z9akqco.js";import{c as qe,d as Ke}from"./hvaa7e877k2b6ldb.js";import{G as Qe}from"./f31xo4f7p3gnlwjn.js";import"./dhmm93wh7jq47k0y.js";import"./oypc9t5q5413y6i2.js";import"./f5szkclm2kittk11.js";import"./9ymg7e089l6mcavz.js";import"./c5ozct7nsfv8lm6r.js";import"./kzzucb3j3gugc3vq.js";import"./8xi7nk1gdjiwya9w.js";import"./c75xpyzc0peppmem.js";function Je(a){return z({mutationFn:async({message:t,includeFrom:s})=>{await S.sendFeedbackEmail(a,t,s)}})}const He=({gizmo:a})=>{const t=he(),s=P(f.GPTFeedbackEmail),i=()=>p.closeModal(f.GPTFeedbackEmail),r=D(),v=te(),[d,w]=I.useState(""),[u,c]=I.useState(!0),g=Je(a.gizmo.id),h=d.length===0;return e.jsx(E,{type:"success",title:r.formatMessage(y.title,{name:a.gizmo.display.name}),isOpen:s,onClose:i,size:"custom",showCloseButton:!0,className:"max-w-xl overflow-y-auto",hideSeparator:!0,children:e.jsx("div",{className:"flex flex-row",children:e.jsxs("div",{className:"-mt-4 flex flex-grow flex-col space-y-4",children:[e.jsx(pe,{className:"mb-1 w-full resize-none overflow-y-auto rounded-md bg-transparent focus:border-gray-200 focus:ring-gray-200 dark:focus:border-white dark:focus:ring-white",placeholder:`Write feedback about ${a.gizmo.display.name}...`,value:d,rows:4,onChange:m=>w(m.target.value)}),e.jsxs("div",{className:"flex flex-row items-center space-x-2 self-start",children:[e.jsx("input",{type:"checkbox",checked:u,onChange:m=>c(m.target.checked)}),t&&e.jsx("span",{className:"text-sm",children:e.jsx(n,{...y.includeFrom,values:{email:e.jsx("strong",{children:t.email})}})})]}),e.jsx(L,{color:"primary",disabled:h,onClick:async()=>{await g.mutateAsync({message:d,includeFrom:u}),v.success(r.formatMessage(y.successToast),{duration:3}),i()},children:e.jsx(n,{...y.send,values:{name:a.gizmo.author.display_name}})})]})})})},y=k({title:{id:"GizmoFeedbackEmailModal.title",defaultMessage:"Feedback about {name}"},send:{id:"GizmoFeedbackEmailModal.sendTo",defaultMessage:"Send To {name}"},successToast:{id:"GizmoFeedbackEmailModal.successToast",defaultMessage:"Feedback sent"},includeFrom:{id:"GizmoFeedbackEmailModal.includeFrom",defaultMessage:"Include my email address {email}"}});function Ye(a){const t=O();return z({mutationFn:async({actionId:s,domain:i,settings:r})=>S.upsertUserActionSettings(s,i,r),onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}function Ze(a){const t=O();return z({mutationFn:async({pluginId:s})=>{await ne.deletePluginUserSettings({pluginId:s})},onSuccess:()=>{t.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:a}]})}})}const Xe=({gizmo:a})=>{const{data:t,isLoading:s}=je(a.gizmo.id,!0),i=P(f.GPTPrivacySettings),r=()=>p.closeModal(f.GPTPrivacySettings),v=D(),[d,w]=I.useState("actions"),u=t!=null&&t.settings.some(c=>c.oauth_status!=null&&a.tools.some(g=>g.type===j.JIT_PLUGIN&&g.metadata?.action_id===c.action_id));return d==="connected_accounts"&&!u&&w("actions"),e.jsx(E,{title:v.formatMessage(x.title),isOpen:i,onClose:r,type:"success",size:"custom",className:"min-h-[50vh] max-w-3xl overflow-y-auto scroll-smooth",noPadding:!0,showCloseButton:!0,children:s?e.jsx(se,{}):e.jsxs(fe,{className:"flex flex-row gap-6 p-4",orientation:"vertical",defaultValue:d,onValueChange:c=>{w(c)},children:[u&&e.jsxs(xe,{className:ie("flex min-w-[180px] max-w-[200px] flex-shrink-0 flex-col gap-2"),children:[e.jsx(F,{value:"actions",message:x.actions}),u&&e.jsx(F,{value:"connected_accounts",message:x.connectedAccounts})]}),e.jsxs("div",{className:"flex-1 text-sm",children:[d==="actions"&&e.jsxs(N,{children:[e.jsx(n,{...x.allowedActionsDesc,values:{gizmoName:a.gizmo.display.name}}),t?.settings.map((c,g)=>{const h=a.tools?.find(m=>m.type===j.JIT_PLUGIN&&m.metadata?.action_id===c.action_id);return h&&e.jsx(Re,{gizmoId:a.gizmo.id,actionSettings:c,actionTool:h},g)})]}),d==="connected_accounts"&&e.jsxs(N,{children:[e.jsx(n,{...x.connectedAccountsDesc,values:{gizmoName:a.gizmo.display.name}}),e.jsx("div",{children:t?.settings.map((c,g)=>{const h=a.tools?.find(m=>m.type===j.JIT_PLUGIN&&m.metadata?.action_id===c.action_id);return h&&c.oauth_status&&e.jsx(ea,{gizmoId:a.gizmo.id,actionSettings:c,actionTool:h},g)})})]})]})]})})};function F({value:a,message:t}){return e.jsx(ve,{className:"flex rounded-md px-2 py-1.5 text-sm text-token-text-primary radix-state-active:bg-white dark:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:bg-token-main-surface-tertiary md:radix-state-active:text-token-text-primary",value:a,children:e.jsx("div",{className:"truncate",children:e.jsx(n,{...t})})})}function Re({gizmoId:a,actionSettings:t,actionTool:s}){const i=Ye(a),r=t.action_settings?.all,v=d=>{s.metadata?.action_id&&s.metadata?.domain&&i.mutateAsync({actionId:s.metadata.action_id,domain:s.metadata.domain,settings:{all:d}})};return e.jsx("div",{children:e.jsxs(H,{className:"border-b border-black/10 dark:border-white/10",children:[e.jsxs("div",{className:"flex flex-row space-x-4",children:[e.jsx("div",{className:"font-semibold",children:s.metadata?.domain}),e.jsxs("a",{href:s.metadata?.privacy_policy_url,target:"_blank",rel:"noreferrer",className:"flex items-center gap-1 text-token-text-tertiary hover:cursor-pointer hover:text-token-text-secondary",children:[e.jsx(n,{...x.privacyPolicyLink}),e.jsx(Ie,{className:"icon-md"})]})]}),e.jsxs("select",{value:r?"always_allow":"unset",onChange:d=>v(d.target.value),className:"rounded border-none bg-token-main-surface-primary text-sm",children:[e.jsx("option",{value:"always_allow",children:e.jsx(n,{...x.alwaysAllowDropdown})}),e.jsx("option",{value:"unset",children:e.jsx(n,{...x.askDropdown})})]})]})})}function ea({gizmoId:a,actionSettings:t,actionTool:s}){const i=Ze(a),r=t.oauth_status==="valid";return e.jsxs(H,{children:[e.jsx("div",{className:"font-semibold",children:s?.metadata?.domain}),e.jsx(L,{color:"secondary",size:"small",onClick:()=>{s.metadata?.action_id&&s.metadata?.domain&&(r?i.mutateAsync({pluginId:s.metadata?.action_id}):S.doOAuthRedirect(a,s.metadata?.action_id,s.metadata?.domain,window.location.href))},children:e.jsx(n,{...r?x.logout:x.login})})]})}const N=U.div`flex flex-col gap-6`,H=U.div`flex flex-row justify-between py-3 items-center`,x=k({title:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.title"},actions:{defaultMessage:"Actions",id:"GizmoPrivacySettings.actions"},connectedAccounts:{defaultMessage:"Connected accounts",id:"GizmoPrivacySettings.connectedAccounts"},connectedAccountsDesc:{defaultMessage:"Manage which 3rd party accounts can be accessed by {gizmoName}.",id:"GizmoPrivacySettings.connectedAccountsDesc"},allowedActionsTitle:{defaultMessage:"GPT's privacy settings",id:"GizmoPrivacySettings.allowedActionsTitle"},allowedActionsDesc:{defaultMessage:"Select which 3rd party actions are allowed in conversations with {gizmoName}.",id:"GizmoPrivacySettings.allowedActionsDesc"},privacyPolicyLink:{defaultMessage:"Privacy policy",id:"GizmoPrivacySettings.privacyPolicyLink"},alwaysAllowDropdown:{defaultMessage:"Always allow",id:"GizmoPrivacySettings.alwaysAllowDropdown"},askDropdown:{defaultMessage:"Ask",id:"GizmoPrivacySettings.askDropdown"},login:{defaultMessage:"Log in",id:"GizmoPrivacySettings.login"},logout:{defaultMessage:"Log out",id:"GizmoPrivacySettings.logout"}}),aa=oe(()=>re(()=>import("./e04nd7pz1mn10n0u.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9])).then(a=>a.GizmoKeepInSidebarMenuItem));function Sa({children:a,clientThreadId:t,gizmoResource:s,showReportModal:i,inMobileHeader:r}){return e.jsxs(e.Fragment,{children:[e.jsx(J,{contentAlign:r?"center":"start",size:"small",triggerButton:a,children:e.jsx(sa,{clientThreadId:t,gizmoResource:s,showReportModal:i})}),e.jsx(ta,{gizmoResource:s})]})}function ta({gizmoResource:a}){const t=P(f.GPTRemoveThirdParty),s=ce(),i=V(a);return e.jsxs(e.Fragment,{children:[e.jsx(qe,{gizmoId:a.gizmo.id,creatorId:a.gizmo.author.user_id}),e.jsx(Xe,{gizmo:a}),i&&e.jsx(He,{gizmo:a}),i&&e.jsx(Qe,{gizmo:a}),e.jsx(Ve,{gpt:a,isOpen:t,onClose:()=>p.closeModal(f.GPTRemoveThirdParty),account:s})]})}function sa({clientThreadId:a,gizmoResource:t,showReportModal:s}){const i=de(),r=we(t),v=be(t),d=Se(t.gizmo.id),w=W(),u=ye(t),c=t.gizmo.share_recipient===_.Marketplace||t.gizmo.share_recipient===_.Link,g=!u&&c,h=C("1825130190").value,m=C("3645668434").value,A=h&&!u&&V(t),Y=w?.includes(M.GizmoSupportEmails)&&!u&&t.gizmo.author.will_receive_support_emails&&A,Z=le(),T=We(a),X=q(M.WorkspaceShareLinks),{isUnauthenticated:R}=$(),ee=T&&X&&!R,ae=B();return e.jsxs(e.Fragment,{children:[e.jsx(o.Item,{onClick:()=>{me.logNewChatButtonClicked({location:"Gizmo information dropdown",gizmo_id:t.gizmo.id}),K(ae,`/g/${t.gizmo.short_url}`)},icon:Ce,children:e.jsx(n,{...l.newChat})}),e.jsx(o.Item,{onClick:()=>p.openModal(f.GPTDetails),icon:Me,children:e.jsx(n,{...l.about})}),t.tools?.find(b=>b.type===j.JIT_PLUGIN)&&e.jsx(o.Item,{onClick:()=>p.openModal(f.GPTPrivacySettings),icon:ke,children:e.jsx(n,{...l.privacySettings})}),r&&e.jsx(o.Item,{onClick:()=>{i.push(d)},icon:ze,children:e.jsx(n,{...l.customize})}),!r&&v&&m&&e.jsxs(e.Fragment,{children:[e.jsx(o.Item,{onClick:async()=>{i.push(`/g/${t.gizmo.id}/view`)},icon:Pe,children:e.jsx(n,{id:"GizmoInformation.viewGizmoLabel",defaultMessage:"View configuration"})}),e.jsx(o.Item,{onClick:async()=>{const b=await S.copyGizmo({gizmoId:t.gizmo.id});b.gizmo.id&&i.push(`/gpts/editor/${b.gizmo.id}`)},icon:Ae,children:e.jsx(n,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})})]}),e.jsx(aa,{gizmoResource:t}),e.jsx(Ke,{gizmoResource:t}),Y&&e.jsx(o.Item,{onClick:()=>p.openModal(f.GPTFeedbackEmail),icon:Te,children:e.jsx(n,{...l.feedbackEmail})}),A&&e.jsx(o.Item,{onClick:()=>p.openModal(f.GPTReview),icon:_e,children:e.jsx(n,{...l.reviewGPT})}),g&&e.jsx(o.Item,{onClick:s,icon:Fe,children:e.jsx(n,{...l.report})}),ee&&e.jsx(o.Item,{onClick:()=>p.openSharingModal(T),icon:Q,children:e.jsx(n,{...l.shareChat})}),Z&&e.jsxs(e.Fragment,{children:[e.jsx(o.Separator,{}),e.jsx(o.Item,{color:"danger",onClick:()=>p.openModal(f.GPTRemoveThirdParty),icon:Ne,children:e.jsx(n,{defaultMessage:"Remove GPT from workspace",id:"GizmoInformation.removeGPT"})})]}),w?.includes("debug")&&e.jsxs(e.Fragment,{children:[e.jsx(o.Separator,{}),e.jsx(o.Item,{onClick:()=>{i.push(Ge(t))},children:"(Internal) See share page"})]})]})}const ia=({clientThreadId:a})=>{const s=W()?.includes("debug"),i=$e.getServerThreadId(a),r=q(M.WorkspaceShareLinks),{isUnauthenticated:v}=$(),d=r&&i&&!v,w=ue.useStore(),{value:u}=C("3653083604"),{value:c}=ge("2851018874"),g=u||c&&window.documentPictureInPicture,h=Be(a),m=B();return e.jsxs(e.Fragment,{children:[d&&e.jsx(o.Item,{onClick:()=>p.openSharingModal(i,"History Item Menu"),icon:Q,"data-testid":"share-chat-menu-item",children:e.jsx(n,{...l.shareChat})}),g&&e.jsx(o.Item,{onClick:()=>{w.setThreadId(a),h&&K(m)},icon:De,children:e.jsx(n,{...l.openInCompanionWindow})}),e.jsx(o.Item,{disabled:!i,onClick:()=>{setTimeout(()=>{i&&G.publish({kind:"editTitle",serverThreadId:i})},100)},icon:Ee,children:e.jsx(n,{...l.renameChat})}),e.jsx(o.Item,{disabled:!i,onClick:()=>{i&&G.publish({kind:"archiveChat",serverThreadId:i})},icon:Le,children:e.jsx(n,{...l.archiveChat})}),e.jsx(o.Item,{color:"danger",disabled:!i,onClick:()=>{i&&G.publish({kind:"deleteChat",serverThreadId:i})},icon:Ue,"data-testid":"delete-chat-menu-item",children:e.jsx(n,{...l.deleteChat})}),s&&e.jsxs(e.Fragment,{children:[e.jsx(o.Separator,{}),e.jsx(o.Item,{onClick:()=>p.toggleActiveSidebar("debug"),icon:Oe,children:e.jsx(n,{...l.debugChat})})]})]})},Ga=({clientThreadId:a,children:t,onOpenChange:s})=>e.jsx(J,{onOpenChange:s,side:"bottom",contentAlign:"start",triggerButton:t,size:"auto",children:e.jsx(ia,{clientThreadId:a})}),l=k({newChat:{defaultMessage:"New chat",id:"GizmoInformation.newChat"},about:{defaultMessage:"About",id:"GizmoInformation.about"},privacySettings:{defaultMessage:"Privacy settings",id:"GizmoInformation.privacySettings"},viewDetails:{defaultMessage:"View details",id:"GizmoInformation.viewDetails"},share:{defaultMessage:"Share",id:"GizmoInformation.share"},favorite:{defaultMessage:"Favorite",id:"GizmoInformation.favorite"},customize:{defaultMessage:"Edit GPT",id:"GizmoInformation.customize"},feedbackEmail:{defaultMessage:"Send feedback",id:"GizmoInformation.feedbackEmail"},reviewGPT:{defaultMessage:"Review GPT",id:"GizmoInformation.reviewGPT"},report:{defaultMessage:"Report",id:"GizmoInformation.report"},privacy:{defaultMessage:"Privacy",id:"GizmoInformation.privacy"},deleteChat:{defaultMessage:"Delete",id:"GizmoInformation.deleteChat.0"},debugChat:{defaultMessage:"(Internal) Debug",id:"GizmoInformation.debugChat"},renameChat:{defaultMessage:"Rename",id:"GizmoInformation.renameChat"},archiveChat:{defaultMessage:"Archive",id:"GizmoInformation.archiveChat.0"},shareChat:{defaultMessage:"Share",id:"GizmoInformation.shareChat"},openInCompanionWindow:{defaultMessage:"Open in Companion Window",id:"GizmoInformation.openInCompanionWindow"},shareChatLong:{defaultMessage:"Share chat",id:"GizmoInformation.shareChatLong"}});export{Ga as GizmoConversationOptionsDropdown,Sa as GizmoInformationDropdown,sa as GizmoInformationDropdownItems};
//# sourceMappingURL=mnx8nptbqxwf2u0a.js.map
