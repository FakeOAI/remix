const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/n9joji9cb2461und.js","assets/i50pu8hyebaw9kd6.js","assets/ler115iciu2bvc07.js","assets/root-kyx67gpb.css"])))=>i.map(i=>d[i]);
import{aE as oe,j as s,aw as o,u as fs,r as A,b2 as j,Y as q,m as le,a8 as ce,bM as F,ay as E,c5 as xs,g9 as Be,aq as hs,k as Ee,ga as Fe,W as ys,gb as bs,gc as js,gd as vs,dt as ks,C as Oe,ge as ws,eO as _s,eM as de,e0 as ze,e1 as Ge,dy as $e,gf as Ms,eN as Ss,gg as Ts,gh as Ns,ap as Ps,g as As,c6 as We,aM as Cs,aN as Ls,Z as De,L as K,aR as W,az as D,bb as P,d5 as je,dF as Is,l as Us,N as qe,X as Ye}from"./i50pu8hyebaw9kd6.js";import{_ as Rs}from"./fsddy3bxlesj6ecw.js";import{be as n,l_ as Ke,ba as Bs,d1 as ue,l4 as Es,l5 as Fs,l6 as Os,hv as b,bS as zs,kS as Gs,kY as $s,kV as Ve,l$ as Ws,m0 as re,m1 as Ds,kU as L,m2 as Q,kR as qs,cc as Ys,ce as Ks,hp as Vs,I as Qs,kT as Hs}from"./mixmhi71ciem9jn6.js";import{ap as ne,Q as Xs,ag as se,t as Js,ak as Zs,R as ea,aY as ae,b8 as ve,K as sa,b2 as aa}from"./ler115iciu2bvc07.js";import{S as k}from"./cdli15fahs96hcpj.js";import{a as ta}from"./moh4ip2hvdwaf05m.js";import{a as ke}from"./e7yzofgmpnjgxdq3.js";function Qe(e){return e==n.User||e==n.Group?n.Private:e==n.WorkspaceLink?n.Workspace:e}function U(e,a){return e=Qe(e),a===void 0?!1:a.some(t=>t.recipient===e&&t.allowed)}function pe(e,a){return a===void 0?[]:(e=Qe(e),a.find(i=>i.recipient===e)?.moderated_fields)}function te(e,a){const t=pe(e,a);return t&&t.length>0}const we=oe.a`bold underline`,ia=oe.textarea`w-full text-sm overflow-y-auto rounded-lg border px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium bg-token-main-surface-primary h-32`;var He=(e=>(e[e.None=0]="None",e[e.AppealAvailable=1]="AppealAvailable",e[e.AppealSent=2]="AppealSent",e))(He||{}),Xe=(e=>(e[e.None=0]="None",e[e.PublishBlocked=1]="PublishBlocked",e[e.RemovedFromMarketplace=2]="RemovedFromMarketplace",e[e.RemovedFromPublic=3]="RemovedFromPublic",e[e.RemovedFromPrivate=4]="RemovedFromPrivate",e[e.Recategorized=5]="Recategorized",e))(Xe||{});function ur(e){if(!e)return;const a=e.gizmo.appeal_info?.state.kind==="appeal_sent",t=ra(e.gizmo.share_recipient,e.gizmo.sharing_targets);return{sharingRecipient:e.gizmo.share_recipient,categories:e.gizmo.categories,gizmoId:e.gizmo.id,moderationType:t,sharingTargets:e.gizmo.sharing_targets,showModal:a?2:t!==0?1:0}}const _e={[n.User]:n.Private,[n.Group]:n.Private,[n.WorkspaceLink]:n.Workspace};function ra(e,a=[]){const t=new Set(a.filter(d=>d.allowed).map(d=>d.recipient));if(!e||(e in _e&&(e=_e[e]),t.has(e)))return 0;const i=t.has(n.Private)||t.has(n.Workspace),l=t.has(n.Link)||t.has(n.Marketplace);return e===n.Marketplace&&l?2:!l&&i?3:4}function Me(e){switch(e){case 0:case 1:return j({id:"gizmo.appeals.publishBlockedTitle",defaultMessage:"Your changes couldn’t be published"});case 2:return j({id:"gizmo.appeals.removedFromMarketplaceTitle",defaultMessage:"Your GPT has been removed from the marketplace"});case 3:return j({id:"gizmo.appeals.removedFromPublicTitle",defaultMessage:"Your GPT has been removed from public view"});case 5:return j({id:"gizmo.appeals.recategorizedTitle",defaultMessage:"Your GPT has been recategorized"});default:Ke(e)}}function na(e){switch(e){case"profile_picture":return j({id:"gizmo.appeals.profilePictureFieldName",defaultMessage:"Profile Picture"});case"gizmo_name":return j({id:"gizmo.appeals.gizmoNameFieldName",defaultMessage:"Name"});case"gizmo_description":return j({id:"gizmo.appeals.gizmoDescriptionFieldName",defaultMessage:"Description"});case"gizmo_instructions":return j({id:"gizmo.appeals.gizmoInstructionsFieldName",defaultMessage:"Instructions"});case"gizmo_welcome_message":return j({id:"gizmo.appeals.gizmoWelcomeMessageFieldName",defaultMessage:"Welcome Message"});case"custom_actions":return j({id:"gizmo.appeals.customActionsFieldName",defaultMessage:"Custom Actions"});case"conversation_starter":return j({id:"gizmo.appeals.conversationStarterFieldName",defaultMessage:"Conversation Starter"});case"file":return j({id:"gizmo.appeals.fileFieldName",defaultMessage:"File"});case"gizmo_combined_content":return j({id:"gizmo.appeals.gizmoCombinedContentFieldName",defaultMessage:"Overall GPT Config"})}}function oa(e){switch(e){case n.Private:case n.Workspace:return j({id:"gizmo.appeals.privateRecipientModerationText",defaultMessage:"Your GPT can’t be updated because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case n.Link:return j({id:"gizmo.appeals.linkRecipientModerationText",defaultMessage:"Your GPT can’t be shared publicly because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case n.Marketplace:return j({id:"gizmo.appeals.marketplaceRecipientModerationText",defaultMessage:"Your GPT can’t appear in the Explore GPTs page because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});default:Ke(e)}}function Je({sharingRecipient:e,moderatedFields:a,appealAvailable:t}){const i=a.length;return s.jsxs(s.Fragment,{children:[s.jsxs("p",{children:[s.jsx(o,{...oa(e),values:{usagePolicyLink:l=>s.jsx(we,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:l})}})," ",i>0&&s.jsx(o,{id:"gizmo.appeals.seeBelowForSpecificIssues",defaultMessage:`{numModeratedFields, plural,
              one {See below for the specific issue:}
              other {See below for the specific issues:}
            }`,values:{numModeratedFields:i}})]}),i>0&&a?.map(l=>s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"font-bold",children:s.jsx(o,{...na(l.name)})}),s.jsx("ul",{className:"list-disc pl-5",children:l.reasons.map(d=>s.jsxs("li",{children:[d.description," ",d.link?s.jsx(we,{href:d.link,target:"_blank",rel:"noreferrer",children:s.jsx(o,{id:"gizmo.appeals.learnMore",defaultMessage:"Learn more"})}):""]},d.description))})]})),t&&s.jsx("p",{children:s.jsx(o,{id:"gizmo.appeals.appealAvailableText",defaultMessage:"Alternatively you may appeal this decision and we will get back to you as soon as possible. Or you can publish to “Only me” and use this GPT privately."})})]})}function la({gizmoId:e,sharingRecipient:a,categories:t,moderationType:i,sharingTargets:l,appealAvailable:d,onClose:u,onAppealSubmitted:p}){const c=q(),[v,w]=A.useState(""),[y,_]=A.useState(0),S=le(),g=async()=>{await ue.postGizmoAppeal(S,e,v,a,t),_(2),p?.()},M=pe(a,l),x=M?.length??0,T=ce();if(x==0&&T?.isEnterprisey())return s.jsx(F,{title:c.formatMessage(Me(i)),isOpen:!0,onClose:u,showCloseButton:!0,type:"warning",primaryButton:s.jsx(E.Button,{color:"primary",onClick:u,children:s.jsx(o,{id:"wEsAOU",defaultMessage:"OK"})}),children:s.jsx("p",{className:"text-sm",children:s.jsx(o,{id:"gizmo.appeals.workspaceSettingsMessage",defaultMessage:"Access to your GPT has been reduced by your workspace's GPT sharing settings. An owner of the workspace can change these settings in the workspace settings page."})})});switch(y){case 0:return s.jsx(F,{title:c.formatMessage(Me(i)),isOpen:!0,onClose:u,showCloseButton:!0,primaryButton:s.jsx(E.Button,{color:"primary",onClick:u,children:s.jsx(o,{id:"gizmo.appeals.contunueButton",defaultMessage:"Continue"})}),secondaryButton:d?s.jsx(E.Button,{onClick:()=>_(1),children:s.jsx(o,{id:"gizmo.appeals.appealButton",defaultMessage:"Appeal"})}):void 0,type:"warning",children:s.jsx("div",{className:"flex flex-col gap-2 text-sm",children:s.jsx(Je,{sharingRecipient:a,moderatedFields:M??[],appealAvailable:d})})});case 1:return s.jsx(F,{title:c.formatMessage({id:"gizmo.appeals.appealModalTitle",defaultMessage:"Appeal"}),isOpen:!0,onClose:u,showCloseButton:!0,shouldIgnoreClickOutside:!0,primaryButton:s.jsx(E.Button,{color:"primary",onClick:g,disabled:v.trim().length===0,children:s.jsx(o,{id:"gizmo.appeals.submitAppealButton",defaultMessage:"Submit"})}),secondaryButton:s.jsx(E.Button,{onClick:()=>_(0),children:s.jsx(o,{id:"gizmo.appeals.backButton",defaultMessage:"Back"})}),type:"warning",children:s.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[s.jsx("p",{children:s.jsx(o,{id:"gizmo.appeals.appealReasonText",defaultMessage:"Please provide a reason for why you believe this GPT doesn’t violate our policies and should be published"})}),s.jsx(ia,{value:v,onChange:Z=>w(Z.target.value)})]})});case 2:return s.jsx(s.Fragment,{})}}function ca({onClose:e}){const a=q();return s.jsx(F,{title:a.formatMessage({id:"gizmo.appeals.appealSubmittedModalTitle",defaultMessage:"Appeal submitted"}),isOpen:!0,onClose:e,showCloseButton:!0,primaryButton:s.jsx(E.Button,{color:"primary",onClick:e,children:s.jsx(o,{id:"gizmo.appeals.closeButton",defaultMessage:"Close"})}),type:"success",children:s.jsx("div",{className:"flex flex-col gap-2 text-sm",children:s.jsx("div",{children:s.jsx(o,{id:"gizmo.appeals.appealSubmittedText",defaultMessage:"Your appeal has been submitted. We will get back to you as soon as possible."})})})})}function da({gizmoId:e,onClose:a}){const{data:t}=Bs(e,!0),i=le(),l=async()=>{await ue.postGizmoCancelAppeal(i,e)};return s.jsx(F,{isOpen:!0,onClose:xs,primaryButton:s.jsx(E.Button,{color:"primary",onClick:()=>{l(),a?.()},children:s.jsx(o,{id:"gizmo.appeals.cancelAppealButton",defaultMessage:"Cancel appeal"})}),type:"warning",children:s.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[s.jsx("h2",{className:"text-lg font-semibold",children:s.jsx(o,{id:"gizmo.appeals.appealReviewingHeader",defaultMessage:"Reviewing your appeal"})}),s.jsx("p",{children:s.jsx(o,{id:"gizmo.appeals.appealSentModalText",defaultMessage:"During the review you can continue using “{gizmoName}” as your private GPT, but won’t be able to update it or share it with others.",values:{gizmoName:t?.gizmo.display.name}})})]})})}function pr({appealState:e,onAppealClose:a,onAppealSubmitted:t}){const{value:i}=fs("4226692983"),[l,d]=A.useState(!1);return l?s.jsx(ca,{onClose:()=>{d(!1),t?.()}}):s.jsxs(s.Fragment,{children:[e?.showModal==2&&s.jsx(da,{gizmoId:e.gizmoId,onClose:a}),e?.showModal==1&&s.jsx(la,{gizmoId:e.gizmoId,sharingRecipient:e.sharingRecipient,categories:e.categories,moderationType:e.moderationType,sharingTargets:e.sharingTargets,appealAvailable:i,onClose:()=>a?.(),onAppealSubmitted:()=>d(!0)})]})}function ua(e,a){for(var t=-1,i=e==null?0:e.length;++t<i&&a(e[t],t,e)!==!1;);return e}var pa=ua,ga=Be,ma=hs;function fa(e,a,t,i){var l=!t;t||(t={});for(var d=-1,u=a.length;++d<u;){var p=a[d],c=i?i(t[p],e[p],p,t,e):void 0;c===void 0&&(c=e[p]),l?ma(t,p,c):ga(t,p,c)}return t}var J=fa,xa=J,ha=Ee;function ya(e,a){return e&&xa(a,ha(a),e)}var ba=ya,ja=J,va=Fe;function ka(e,a){return e&&ja(a,va(a),e)}var wa=ka,X={exports:{}};X.exports;(function(e,a){var t=ys,i=a&&!a.nodeType&&a,l=i&&!0&&e&&!e.nodeType&&e,d=l&&l.exports===i,u=d?t.Buffer:void 0,p=u?u.allocUnsafe:void 0;function c(v,w){if(w)return v.slice();var y=v.length,_=p?p(y):new v.constructor(y);return v.copy(_),_}e.exports=c})(X,X.exports);var _a=X.exports,Ma=J,Sa=bs;function Ta(e,a){return Ma(e,Sa(e),a)}var Na=Ta,Pa=J,Aa=js;function Ca(e,a){return Pa(e,Aa(e),a)}var La=Ca,Ia=Object.prototype,Ua=Ia.hasOwnProperty;function Ra(e){var a=e.length,t=new e.constructor(a);return a&&typeof e[0]=="string"&&Ua.call(e,"index")&&(t.index=e.index,t.input=e.input),t}var Ba=Ra,Se=vs;function Ea(e){var a=new e.constructor(e.byteLength);return new Se(a).set(new Se(e)),a}var ge=Ea,Fa=ge;function Oa(e,a){var t=a?Fa(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)}var za=Oa,Ga=/\w*$/;function $a(e){var a=new e.constructor(e.source,Ga.exec(e));return a.lastIndex=e.lastIndex,a}var Wa=$a,Te=ks,Ne=Te?Te.prototype:void 0,Pe=Ne?Ne.valueOf:void 0;function Da(e){return Pe?Object(Pe.call(e)):{}}var qa=Da,Ya=ge;function Ka(e,a){var t=a?Ya(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}var Va=Ka,Qa=ge,Ha=za,Xa=Wa,Ja=qa,Za=Va,et="[object Boolean]",st="[object Date]",at="[object Map]",tt="[object Number]",it="[object RegExp]",rt="[object Set]",nt="[object String]",ot="[object Symbol]",lt="[object ArrayBuffer]",ct="[object DataView]",dt="[object Float32Array]",ut="[object Float64Array]",pt="[object Int8Array]",gt="[object Int16Array]",mt="[object Int32Array]",ft="[object Uint8Array]",xt="[object Uint8ClampedArray]",ht="[object Uint16Array]",yt="[object Uint32Array]";function bt(e,a,t){var i=e.constructor;switch(a){case lt:return Qa(e);case et:case st:return new i(+e);case ct:return Ha(e,t);case dt:case ut:case pt:case gt:case mt:case ft:case xt:case ht:case yt:return Za(e,t);case at:return new i;case tt:case nt:return new i(e);case it:return Xa(e);case rt:return new i;case ot:return Ja(e)}}var jt=bt,vt=Oe,Ae=Object.create,kt=function(){function e(){}return function(a){if(!vt(a))return{};if(Ae)return Ae(a);e.prototype=a;var t=new e;return e.prototype=void 0,t}}(),wt=kt,_t=wt,Mt=ws,St=_s;function Tt(e){return typeof e.constructor=="function"&&!St(e)?_t(Mt(e)):{}}var Nt=Tt,Pt=de,At=ze,Ct="[object Map]";function Lt(e){return At(e)&&Pt(e)==Ct}var It=Lt,Ut=It,Rt=$e,Ce=Ge,Le=Ce&&Ce.isMap,Bt=Le?Rt(Le):Ut,Et=Bt,Ft=de,Ot=ze,zt="[object Set]";function Gt(e){return Ot(e)&&Ft(e)==zt}var $t=Gt,Wt=$t,Dt=$e,Ie=Ge,Ue=Ie&&Ie.isSet,qt=Ue?Dt(Ue):Wt,Yt=qt,Kt=Ms,Vt=pa,Qt=Be,Ht=ba,Xt=wa,Jt=_a,Zt=Rs,ei=Na,si=La,ai=Ts,ti=Ns,ii=de,ri=Ba,ni=jt,oi=Nt,li=Ps,ci=Ss,di=Et,ui=Oe,pi=Yt,gi=Ee,mi=Fe,fi=1,xi=2,hi=4,Ze="[object Arguments]",yi="[object Array]",bi="[object Boolean]",ji="[object Date]",vi="[object Error]",es="[object Function]",ki="[object GeneratorFunction]",wi="[object Map]",_i="[object Number]",ss="[object Object]",Mi="[object RegExp]",Si="[object Set]",Ti="[object String]",Ni="[object Symbol]",Pi="[object WeakMap]",Ai="[object ArrayBuffer]",Ci="[object DataView]",Li="[object Float32Array]",Ii="[object Float64Array]",Ui="[object Int8Array]",Ri="[object Int16Array]",Bi="[object Int32Array]",Ei="[object Uint8Array]",Fi="[object Uint8ClampedArray]",Oi="[object Uint16Array]",zi="[object Uint32Array]",f={};f[Ze]=f[yi]=f[Ai]=f[Ci]=f[bi]=f[ji]=f[Li]=f[Ii]=f[Ui]=f[Ri]=f[Bi]=f[wi]=f[_i]=f[ss]=f[Mi]=f[Si]=f[Ti]=f[Ni]=f[Ei]=f[Fi]=f[Oi]=f[zi]=!0;f[vi]=f[es]=f[Pi]=!1;function H(e,a,t,i,l,d){var u,p=a&fi,c=a&xi,v=a&hi;if(t&&(u=l?t(e,i,l,d):t(e)),u!==void 0)return u;if(!ui(e))return e;var w=li(e);if(w){if(u=ri(e),!p)return Zt(e,u)}else{var y=ii(e),_=y==es||y==ki;if(ci(e))return Jt(e,p);if(y==ss||y==Ze||_&&!l){if(u=c||_?{}:oi(e),!p)return c?si(e,Xt(u,e)):ei(e,Ht(u,e))}else{if(!f[y])return l?e:{};u=ni(e,y,p)}}d||(d=new Kt);var S=d.get(e);if(S)return S;d.set(e,u),pi(e)?e.forEach(function(x){u.add(H(x,a,t,x,e,d))}):di(e)&&e.forEach(function(x,T){u.set(T,H(x,a,t,T,e,d))});var g=v?c?ti:ai:c?mi:gi,M=w?void 0:g(e);return Vt(M||e,function(x,T){M&&(T=x,x=e[T]),Qt(u,T,H(x,a,t,T,e,d))}),u}var Gi=H,$i=Gi,Wi=1,Di=4;function qi(e){return $i(e,Wi|Di)}var Yi=qi;const V=As(Yi);function gr(e){return{id:e.gizmo.id,instructions:e.gizmo.instructions,name:e.gizmo.display.name,description:e.gizmo.display.description??"",profilePictureId:e.gizmo.display.profile_pic_id??void 0,profilePictureUrl:e.gizmo.display.profile_picture_url??void 0,promptStarters:e.gizmo.display.prompt_starters??[],tools:V(e.tools),files:V(e.files),sharing:e.gizmo.sharing?V(e.gizmo.sharing):{subjects:[],recipient:e.gizmo.share_recipient},trainingDisabled:e.gizmo.training_disabled??!1,sharingRecipient:e.gizmo.share_recipient,sharingTargets:V(e.gizmo.sharing_targets),liveVersion:e.gizmo.live_version??0,contextStuffingBudget:e.gizmo.context_stuffing_budget}}function mr(e,a){if(a==null)return e;function t(i){return typeof i=="object"&&i!=null?Array.isArray(i)?i.map(t):Object.fromEntries(Object.entries(i).map(([l,d])=>[l,t(d)])):i===null?void 0:i}return a=t(a),{...e,...a}}var as=(e=>(e[e.Loading=0]="Loading",e[e.UploadingProfilePic=1]="UploadingProfilePic",e[e.GeneratingProfilePic=2]="GeneratingProfilePic",e[e.GizmoNameTooLong=3]="GizmoNameTooLong",e[e.GizmoDescriptionTooLong=4]="GizmoDescriptionTooLong",e[e.GizmoInstructionsTooLong=5]="GizmoInstructionsTooLong",e[e.NameEmpty=6]="NameEmpty",e[e.MissingPublicActionPrivacyPolicyURL=7]="MissingPublicActionPrivacyPolicyURL",e[e.MissingCategory=8]="MissingCategory",e))(as||{});function fr(e){switch(e){case 0:return"Loading";case 1:return"Uploading profile picture";case 2:return"Generating profile picture";case 3:return"GPT name too long";case 4:return"GPT description too long";case 5:return"GPT instructions too long";case 6:return"GPT name cannot be empty";case 7:return"Public actions require valid privacy policy URLs";case 8:return"Public GPTs must have a category"}}function Ki(e){return e==="link"||e==="marketplace"}function Vi(e){try{return new URL(e),!0}catch{return!1}}function Qi(e,a,t){const i=e.name.length>Es,l=(e.description?.length??0)>Fs,d=(e.instructions?.length??0)>Os,u=[];if(e?.name===""&&u.push(6),i&&u.push(3),l&&u.push(4),d&&u.push(5),a!=null&&Ki(a)){const p=e.tools?.filter(c=>c.type===We.JIT_PLUGIN);for(const c of p){const v=c.metadata?.privacy_policy_url;if(v==null||!Vi(v)){u.push(7);break}}}return a===n.Marketplace&&t==null&&u.push(8),u}const ts=Cs(()=>Ls(()=>import("./n9joji9cb2461und.js"),__vite__mapDeps([0,1,2,3])).then(e=>e.DirectorySyncResourceManagedIndication)),Hi=[L,Q];function Xi(e,a){return e.type===b.USER?e.user_id===a.user_id:e.type===b.GROUP?e.group_id===a.group_id:e.type===a.type}const Ji={[b.USER]:n.User,[b.GROUP]:n.Group,[b.WORKSPACE]:n.Workspace,[b.ALL]:n.Marketplace};function Zi(e){const a=Ji[e.type];if(!a)throw new Error("Unknown sharing subject type: "+e.type);return{...e,type:a}}function xr({gizmo:e,publishedGizmo:a,updateGizmo:t,promoteGizmo:i,appealGizmo:l,setAppealState:d,showActionsModal:u,shareOnly:p,onClose:c,workspaceOwner:v=!1}){const w=q(),y=De(),_=ce(),S=_?.data?.name??"your workspace",g=zs(),M=Gs(),[x,T]=A.useState(void 0);A.useEffect(()=>{if(x==null)if(a?.gizmo.display.categories&&a?.gizmo.display.categories.length>0){const r=M.data?.categories.find(h=>h.id===a?.gizmo.display.categories[0]);r&&T(r)}else M.data!=null&&T(M.data.categories[M.data.categories.length-1])},[M.data,x,a]);const[m,Z]=A.useState(e.sharingRecipient??n.Private),[N,G]=A.useState(e.sharing?.subjects??[]),[me,os]=A.useState(null),[fe,xe]=A.useState(!1),ls=A.useCallback(()=>!K(e.sharing?.subjects,N)||e.sharingRecipient!==m,[e.sharing,e.sharingRecipient,m,N]),z=le(),he=Qi(e,m,x?.id??void 0),cs=he.includes(as.MissingPublicActionPrivacyPolicyURL),ds=e.tools.find(r=>r.type===We.JIT_PLUGIN&&!r.metadata.privacy_policy_url);if(me)return s.jsx(sr,{publishedGizmo:me,sharing:{recipient:m,subjects:N},workspaceName:S,onClose:c});function us(r){N.find(h=>Xi(h,r))||G([...N,r])}const R=$s(N);function ee(r){const h=N.filter(I=>[b.WORKSPACE,b.ALL].indexOf(I.type)===-1);r!=null&&h.push(r),G(h)}function ps(r){switch(Z(r),r){case n.Marketplace:case n.Link:ee({type:b.ALL,capabilities:L});break;case n.Workspace:case n.WorkspaceLink:ee({type:b.WORKSPACE,capabilities:L});break;default:ee(null)}}function ye(r){R!=null&&G(N.map(h=>h===R?{...h,capabilities:r}:h))}function gs(r,h,I){return r.type===b.USER&&r.user_id.indexOf("__")===-1?{...r,user_id:r.user_id+"__"+_?.getWorkspaceId()}:r}async function ms(r,h){if(fe)return;if(r&&!h)throw new Error("Cannot share a gizmo that hasn't been promoted before");if(!x)return;xe(!0);let B=N.map(gs).map(Zi);if(B=Hs(m,B,R?.capabilities??L),v)return!_||!h?(y.warning("Unable to change sharing settings"),c()):(await qe.updateWorkspaceGPTSharing(_.id,h,B),y.success(w.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),z.invalidateQueries({queryKey:["workspace"]}),c());if(r){if(!h||!a)throw new Error("No gizmo ID to share");try{const C={sharing:B};x&&(C.categories=[x.id]);const Y=await ue.shareGizmo(h,C);Y.error?te(m,Y.sharing_targets)?(d({gizmoId:a.gizmo.id,sharingRecipient:m,categories:a.gizmo.display.categories,moderationType:Xe.PublishBlocked,sharingTargets:Y.sharing_targets,showModal:He.AppealAvailable}),c()):y.warning(w.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})):(z.setQueryData(["gizmo",{gizmoId:a.gizmo.id},{draft:!1}],be=>Y.resource),t(be=>({...be,sharingRecipient:m})),y.success(w.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),c())}catch{return y.warning(w.formatMessage({id:"dKC65l",defaultMessage:"Failed to update sharing settings"})),c()}}else{const C=await i({subjects:B,recipient:m},x.id);h||(h=C?.gizmo.id),os(C??null),t({liveVersion:C?.gizmo.live_version??void 0}),z.invalidateQueries({queryKey:["gizmo",{gizmoId:h}]})}xe(!1),z.invalidateQueries({queryKey:["gizmos"]}),z.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:h}]}),z.invalidateQueries({queryKey:["workspace"]}),t({sharing:{recipient:m,subjects:N},sharingRecipient:m},!1)}return s.jsx(F,{type:"success",className:"max-w-[555px]",size:"custom",isOpen:!0,onClose:c,primaryButton:te(m,e.sharingTargets)?s.jsx(W,{onClick:()=>l(m,x?.id),children:s.jsx(o,{id:"HRzqKK",defaultMessage:"Appeal"})}):s.jsx(W,{onClick:()=>ms(p,a?.gizmo.id),loading:fe,disabled:he.length>0||!U(m,e.sharingTargets),children:p?s.jsx(o,{id:"BEKjVh",defaultMessage:"Save"}):s.jsx(o,{id:"24j5ts",defaultMessage:"Update"})}),secondaryButton:s.jsxs(s.Fragment,{children:[ls()&&s.jsx("div",{className:"absolute bottom-8 left-6 text-sm text-token-text-secondary",children:s.jsx(o,{id:"9CkgC4",defaultMessage:"Unsaved changes"})}),a&&s.jsx(W,{color:"secondary",onClick:r=>Ve(a,y,r,w.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:s.jsx(o,{id:"wvL15a",defaultMessage:"Copy link"})})]}),title:w.formatMessage({id:"7JggXH",defaultMessage:"Share GPT"}),showCloseButton:!0,children:s.jsxs("div",{className:"flex flex-col space-y-4",children:[s.jsx(ar,{onAdd:r=>us(r),publishedGizmo:a}),s.jsx("h3",{className:"text-base font-semibold",children:s.jsx(o,{id:"bNQXcV",defaultMessage:"Share with..."})}),s.jsxs("div",{className:"max-h-[200px] space-y-2 overflow-y-auto",children:[s.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[s.jsx("div",{className:"shrink-0 grow-0 self-start",children:s.jsx(Ws,{user:g,size:"gizmoConversation",roundedStyle:"rounded-full"})}),s.jsx("div",{className:"grow",children:!a||tr(a?.gizmo.author.user_id.split("__")[0],g?.id)?s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-base font-semibold",children:s.jsx(o,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:g?.name}})}),s.jsx("span",{className:"-mt-1 text-sm text-token-text-secondary",children:g?.email})]}):s.jsx("span",{className:"text-base font-semibold",children:s.jsx(o,{id:"scRZqV",defaultMessage:"{userName} (builder)",values:{userName:a?.gizmo.author.display_name}})})})]}),N.map((r,h)=>re(r)&&s.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[s.jsx(Ds,{name:r.type===b.GROUP?r.group_name:`${r.user_name} ${r.user_email}`,initialsCount:r.type===b.USER?2:1,size:"gizmoConversation",className:D("shrink-0 grow-0",r.type===b.USER&&"self-start")}),s.jsxs("div",{className:"flex grow flex-col",children:[s.jsxs("span",{className:"flex flex-row",children:[s.jsx("span",{className:"mr-2 text-base font-semibold",children:r.type===b.GROUP?r.group_name:r.user_name}),r.type===b.GROUP&&r.is_scim_managed&&s.jsx(ts,{})]}),r.type===b.USER&&s.jsx("span",{className:"-mt-1 text-sm text-token-text-secondary",children:r.user_email})]}),s.jsxs(P.Root,{children:[s.jsxs(P.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[s.jsx(o,{...O(r.capabilities)}),s.jsx(ne,{className:"icon-md"})]}),s.jsx(P.Portal,{children:s.jsxs(P.Content,{className:"max-w-[280px]",children:[Hi.map((I,B)=>s.jsx(ie,{caps:I,selected:K(I,r.capabilities),onClick:()=>{G(N.map(C=>C===r?{...C,capabilities:I}:C))}},B)),s.jsx(P.Separator,{}),s.jsx(P.Item,{onClick:()=>G(N.filter(I=>I!==r)),color:"danger",icon:Xs,children:s.jsx(o,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},h))]}),s.jsx("hr",{className:"border-token-border-medium"}),s.jsx("h3",{className:"text-base font-semibold",children:s.jsx(o,{id:"uqD7Y8",defaultMessage:"Access"})}),s.jsxs("div",{className:"-ms-3.5 flex flex-row items-center justify-between space-x-3",children:[s.jsxs(k.Root,{value:m,onValueChange:r=>ps(r),children:[s.jsxs(k.Trigger,{children:[s.jsx(k.Value,{}),s.jsx(k.Icon,{})]}),s.jsx(k.Portal,{children:s.jsxs(k.Content,{children:[s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:s.jsx(o,{id:"YIQwaP",defaultMessage:"Private"})}),s.jsx(k.Item,{value:n.Private,children:s.jsx($,{shareLevel:n.Private,workspaceName:S})})]}),s.jsx(k.Separator,{}),s.jsx(je,{label:w.formatMessage({id:"n0m61x",defaultMessage:"Your workspace has disabled sharing with the workspace."}),side:"bottom",disabled:U("workspace",e.sharingTargets),children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:S}),s.jsx(k.Item,{value:n.WorkspaceLink,disabled:!U(n.WorkspaceLink,e.sharingTargets)&&!U(n.Workspace,e.sharingTargets),children:s.jsx($,{shareLevel:n.WorkspaceLink,workspaceName:S})}),s.jsx(k.Item,{value:n.Workspace,disabled:!U("workspace",e.sharingTargets),children:s.jsx($,{shareLevel:n.Workspace,workspaceName:S})})]})}),s.jsx(k.Separator,{}),s.jsx(je,{label:w.formatMessage({id:"IHnort",defaultMessage:"Your workspace has disabled public sharing."}),side:"bottom",disabled:U("marketplace",e.sharingTargets),children:s.jsxs(k.Group,{children:[s.jsx(k.Label,{children:s.jsx(o,{id:"PjY9bi",defaultMessage:"Public"})}),s.jsx(k.Item,{value:n.Link,disabled:!U("link",e.sharingTargets),children:s.jsx($,{shareLevel:n.Link,workspaceName:S})}),s.jsx(k.Item,{disabled:!U("marketplace",e.sharingTargets),value:n.Marketplace,children:s.jsx($,{shareLevel:n.Marketplace,workspaceName:S})})]})})]})})]}),m!==n.Private&&m!==n.User&&s.jsxs(P.Root,{children:[s.jsxs(P.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[R==null?s.jsx(o,{...O(L)}):s.jsx(o,{...O(R.capabilities)}),s.jsx(ne,{className:"icon-md"})]}),s.jsx(P.Portal,{children:s.jsxs(P.Content,{className:"max-w-[280px]",children:[s.jsx(ie,{onClick:()=>ye(L),caps:L,selected:K(R?.capabilities,L)}),m!==n.Marketplace&&m!==n.Link&&s.jsx(ie,{onClick:()=>ye(Q),caps:Q,selected:K(R?.capabilities,Q)})]})})]})]}),cs&&s.jsx("div",{className:"text-xs text-red-500",children:s.jsx(o,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:r=>s.jsx("button",{onClick:()=>{u(ds?.metadata.action_id),c()},className:"underline",children:r})}})}),(m===n.Marketplace||m===n.Workspace)&&(U(m,e.sharingTargets)?s.jsx(ns,{gizmo:e,category:x?.id,categories:M.data?.categories,onCategoryChange:r=>T(r)}):te(m,e.sharingTargets)?s.jsx("div",{className:"pb-2 text-xs text-red-500",children:s.jsx(Je,{sharingRecipient:m,moderatedFields:pe(m,e.sharingTargets)??[],appealAvailable:!0})}):s.jsx("div",{className:"pb-2 text-xs text-red-500",children:s.jsx(o,{id:"BzqqKH",defaultMessage:"Your workspace's settings don't allow this level of access. An owner of the workspace can change this setting in the workspace's GPTs settings."})}))]})})}const is=Ye({private:{id:"pSXBWQ",defaultMessage:"Invite-only"},user:{id:"pSXBWQ",defaultMessage:"Invite-only"},group:{id:"pSXBWQ",defaultMessage:"Invite-only"},workspace_link:{id:"Giaxt1",defaultMessage:"Anyone at {workspaceName} with the link"},workspace:{id:"XLHaTU",defaultMessage:"{workspaceName}"},link:{id:"uP1+Ri",defaultMessage:"Anyone with the link"},marketplace:{id:"82Ilac",defaultMessage:"GPT Store"}}),er=Ye({workspace:{id:"1kpopF",defaultMessage:"Published to {workspaceName}"},marketplace:{id:"hdTRpJ",defaultMessage:"Published to GPT Store"}});function O(e){return e.can_write?j({id:"SubCqD",defaultMessage:"Can edit"}):e.can_view_config?j({id:"ud3lp4",defaultMessage:"Can view configuration"}):e.can_read?j({id:"/0j34W",defaultMessage:"Can chat"}):j({id:"x2E8ET",defaultMessage:"Unknown"})}function ie({caps:e,selected:a,onClick:t}){let i=Js;return e.can_view_config?i=Zs:e.can_read&&(i=ea),s.jsx(P.Item,{className:"flex h-auto flex-row items-start space-x-3 px-3 py-3",onClick:t,icon:i,children:e.can_write?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex grow flex-col",children:s.jsx("span",{className:"text-base font-semibold leading-tight",children:s.jsx(o,{...O(e)})})}),s.jsx(se,{className:D("icon-lg shrink-0",!a&&"invisible")})]}):e.can_view_config?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex grow flex-col",children:[s.jsx("span",{className:"align-baseline text-base font-semibold leading-tight",children:s.jsx(o,{...O(e)})}),s.jsx("span",{className:"text-xs text-token-text-secondary",children:s.jsx(o,{id:"fL1rWw",defaultMessage:"View configuration settings, duplicate, and chat"})})]}),s.jsx(se,{className:D("icon-lg shrink-0",!a&&"invisible")})]}):e.can_read?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex grow flex-col",children:[s.jsx("span",{className:"text-base font-semibold leading-tight",children:s.jsx(o,{...O(e)})}),s.jsx("span",{className:"text-xs text-token-text-secondary",children:s.jsx(o,{id:"tx5q1o",defaultMessage:"Users can only chat with this GPT"})})]}),s.jsx(se,{className:D("icon-lg shrink-0",!a&&"invisible")})]}):null})}const rs={private:ae,user:ae,group:ae,workspace_link:ve,workspace:sa,link:ve,marketplace:aa};function $({shareLevel:e,workspaceName:a,hasInviteSharing:t=!0}){(e===n.User||e===n.Group)&&(e=n.Private);const i=rs[e];return s.jsxs("div",{className:"flex flex-row items-center gap-3 text-base",children:[s.jsx(i,{className:"icon-lg"}),s.jsx("div",{className:"line-clamp-1 pt-px text-start font-semibold",children:!t&&e===n.Private?s.jsx(o,{id:"vVJhYB",defaultMessage:"Only me"}):s.jsx(o,{...is[e],values:{workspaceName:a}})})]})}function sr({publishedGizmo:e,sharing:a,workspaceName:t,onClose:i}){const l=a.recipient,d=rs[l],u=q(),p=De();return s.jsxs(F,{isOpen:!0,onClose:i,showCloseButton:!0,className:"w-[304px]",title:s.jsx(o,{id:"5CEceY",defaultMessage:"GPT Updated"}),primaryButton:s.jsx(W,{onClick:()=>{window.location.href=`/g/${e.gizmo.id}`},children:s.jsx(o,{id:"RF75o5",defaultMessage:"View GPT"})}),secondaryButton:s.jsx(W,{color:"secondary",onClick:c=>Ve(e,p,c,u.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:s.jsx(o,{id:"9hLOl9",defaultMessage:"Copy link"})}),type:"success",children:[s.jsx(ns,{gizmo:{profilePictureUrl:e.gizmo.display.profile_picture_url??void 0,name:e.gizmo.display.name}}),a.subjects.filter(c=>re(c)).length>0&&s.jsxs("div",{className:"my-4",children:[s.jsx("h4",{className:"text-xs font-semibold text-token-text-secondary",children:s.jsx(o,{id:"/paYH9",defaultMessage:"Shared with"})}),a.subjects&&a.subjects.map((c,v)=>re(c)&&s.jsxs("div",{className:"flex flex-row items-center justify-between space-x-3 py-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-base font-semibold",children:c.type===b.GROUP?c.group_name:c.user_name}),c.type===b.USER&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("span",{className:"text-sm text-token-text-secondary",children:c.user_email})]})]}),s.jsx("span",{className:"text-token-text-secondary",children:s.jsx(o,{...O(c.capabilities)})})]},v))]}),s.jsxs("div",{className:"my-4",children:[s.jsx("h4",{className:"text-xs font-semibold text-token-text-secondary",children:s.jsx(o,{id:"q9XNZ7",defaultMessage:"Access"})}),s.jsxs("div",{className:"ml-[3px] flex flex-row items-center py-3 text-left text-base font-semibold",children:[s.jsx(d,{className:"md:icon-lg mr-3 h-6 w-6 shrink-0"}),s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-semibold",children:s.jsx(o,{...er[l]??is[l],values:{workspaceName:t}})}),(l===n.Workspace||l===n.Marketplace)&&s.jsx("span",{className:"text-xs text-token-text-secondary"})]})]})]})]})}function ns({gizmo:e,category:a,categories:t,onCategoryChange:i}){const{data:l,isLoading:d}=qs(),u=t?.find(p=>p.id===a);return s.jsxs("div",{children:[s.jsxs("div",{className:D("mb-[1px] flex flex-row items-center space-x-2 bg-token-main-surface-secondary p-4",d&&"invisible",t?"rounded-t-lg":"rounded-lg"),children:[s.jsx(Ys,{isFirstParty:!1,className:"h-11 w-11",src:e.profilePictureUrl}),s.jsxs("div",{className:"flex grow flex-col space-y-0",children:[s.jsx("span",{className:"text-base font-semibold",children:e.name}),s.jsx(Ks,{builderName:l?.display_name,builderUrl:l?.website_url,socials:[l?.socials.linkedin,l?.socials.github,l?.socials.twitter].filter(p=>p!=null),className:"text-xs text-token-text-secondary"})]})]}),t&&s.jsxs("div",{className:"flex min-h-[56px] flex-row items-center justify-between space-x-2 rounded-b-lg bg-token-main-surface-secondary px-4 text-base",children:[s.jsx("span",{className:"font-semibold",children:s.jsx(o,{id:"JcA4/t",defaultMessage:"Category"})}),s.jsx("div",{className:"text-token-text-secondary",children:i?s.jsx(Is,{size:"small",triggerButton:s.jsxs("button",{className:"flex items-center gap-1",children:[u?.title,s.jsx(ne,{className:"icon-md"})]}),children:t.map((p,c)=>s.jsx(P.Item,{onClick:()=>i(p),children:p.title},c))}):s.jsx("span",{className:"text-token-text-secondary",children:u?.title})})]})]})}const Re=oe.li`flex flex-col rounded-sm p-1 hover:bg-token-main-surface-secondary`;function ar({onAdd:e,publishedGizmo:a}){const t=q(),i=ce(),[l,d]=A.useState(""),p=Vs(i?.id,0,l,5).data?.items.filter(g=>g.id!==a?.gizmo.author.user_id.split("__")[0]),{data:c}=Us({queryKey:[i?.id,"groups","filtered",l],queryFn:()=>qe.getWorkspaceGroups(i.id,{query:l,orderby:"@score"}),enabled:l.trim()!==""&&i!=null&&!!i.getWorkspaceId()}),v=(p?.length??0)>0||(c?.items.length??0)>0,[w,y]=A.useState(!1);function _(g,M,x){e({type:b.GROUP,group_id:g,group_name:M,capabilities:{...L},is_scim_managed:x}),d("")}function S(g,M,x){i&&(e({type:b.USER,user_id:g+"__"+i.getWorkspaceId(),user_name:M,user_email:x,capabilities:{...L}}),d(""))}return s.jsx(s.Fragment,{children:s.jsx("div",{className:"flex w-full flex-row space-x-3",children:s.jsxs(ke,{as:"div",className:"group relative z-10 grow",children:[s.jsx(Qs,{list:"suggested-choices",name:"share-with-input",placeholder:i?.isEnterprisey()?t.formatMessage({id:"xy/AMO",defaultMessage:"Add people and groups from your workspace"}):t.formatMessage({id:"Lh9njB",defaultMessage:"Add people from your workspace"}),value:l,onChange:g=>d(g.target.value),onFocus:()=>y(!0),onBlur:()=>y(!1)}),s.jsx(ta,{show:l.trim()!==""&&v&&w,children:s.jsx(ke.Panel,{static:!0,className:"absolute top-8 ml-0 w-full cursor-pointer overflow-y-auto rounded-lg rounded-t-none border border-t-0 border-token-border-light bg-token-main-surface-primary px-1 py-1 group-has-[:focus]:border-token-border-xheavy",children:l.trim()!==""&&s.jsxs("ul",{id:"suggested-choices",children:[p&&p.map(g=>s.jsxs(Re,{tabIndex:0,className:"rounded-sm p-1 text-sm hover:bg-token-main-surface-secondary",onClick:()=>S(g.id,g.name,g.email??""),children:[s.jsx("span",{className:"w-full font-semibold",children:g.name}),s.jsx("span",{className:"text-sm text-token-text-secondary",children:g.email})]},g.id)),c?.items&&c.items.slice(0,5).map(g=>s.jsx(Re,{tabIndex:0,onClick:()=>_(g.id,g.name,g.is_scim_managed??!1),children:s.jsxs("span",{className:"flex flex-col",children:[s.jsxs("span",{className:"flex flex-row",children:[s.jsx("span",{className:"mr-2 font-semibold",children:g.name}),g.is_scim_managed&&s.jsx(ts,{})]}),s.jsx("span",{className:"text-sm text-token-text-secondary",children:s.jsx(o,{id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}",values:{numMembers:g.num_members}})})]})},g.id))]})})})]})})})}function tr(e,a){return e===void 0||a===void 0?!1:e.split("__")[0]===a.split("__")[0]}export{He as A,as as C,ns as G,Xe as M,xr as S,Qi as a,$ as b,gr as c,rs as d,sr as e,V as f,ur as g,pr as h,U as i,mr as j,fr as r,Zi as s};
//# sourceMappingURL=kt3nh4nokwekb4tj.js.map
