import{X as E,y as e,O as F,a6 as B,r as d,a9 as z,bC as $,bq as oe,a1 as m,u as ie,h as ce,l as Q,bn as le,a2 as de,n as ue,f1 as me,bc as N,Y as pe,bL as xe,av as fe,W as S,ag as _,ap as q,ad as ge,ar as ve,x as ke,an as be}from"./hbchlcqon2hwxr80.js";import{fy as he,fz as je,fA as we,fB as A,U as ye,cg as K,cd as L,fC as Me,fD as Ae,bC as Ne,fE as Pe,aB as Se,fF as Ce,ch as C,al as We,ci as Ue,fG as De}from"./bj9u7c4m96v4ynu9.js";import{S as Ie,a as Ee}from"./icpk1o89aiyc59sk.js";import{bk as Be,S as Re,r as Te,bl as Fe,bm as X,bn as Le,aK as ze,bo as _e,b0 as Ge,bp as He,bi as Oe,J as $e}from"./mu86dgakvedfv6hm.js";import{a as qe,G as P,U as I}from"./fopi3aherabk7cf4.js";import{d as Z,a as V}from"./m9q4cowb70c4pr8r.js";import{p as Y}from"./nmbaat51mx0cnwxl.js";import{b as Ke,c as Xe}from"./kwi5bgvhgh3fkzt9.js";function Ye({onFileChange:a,className:t,message:s,mimeTypes:n}){const r=E(),o=s??r.formatMessage(J.helpText),i=W=>{if(W.length>0){const U=W[0];n&&n.includes(U.type)&&a(U)}},{open:u,getRootProps:x,getInputProps:y,isDragActive:b}=he({disabled:!1,noClick:!0,onDropAccepted:i,onDropRejected:()=>null,multiple:!1,maxSize:je,...we(n)});return e.jsxs("div",{className:F("flex flex-col content-center justify-center gap-3 rounded-xl border border-dashed px-6 py-16 text-center",b?"border-green-600 bg-green-600 bg-opacity-10":"border-token-border-medium",t),...x(),children:[e.jsx("input",{...y()}),e.jsx("div",{className:"text-center dark:text-white",children:e.jsx("div",{className:"inline-block",children:e.jsx(Be,{})})}),e.jsx("div",{className:"text-center text-sm",children:o}),e.jsx("div",{className:"cursor-pointer text-center text-sm font-bold text-green-600",onClick:()=>{u()},children:r.formatMessage(J.openFilePicker)})]})}const J=B({helpText:{id:"FileUploadBox.helpText",defaultMessage:"Drop file here to upload"},openFilePicker:{id:"FileUploadBox.openFilePicker",defaultMessage:"Browse files"}});function Je(a){const t=ie(),s=E(),n=z();return ce({mutationFn:({name:r,profilePictureId:o,profilePictureUrl:i})=>Q.patchWorkspace({workspaceId:a,name:r,profile_picture_id:o,profile_picture_url:i}).catch(u=>{n.danger(s.formatMessage(k.saveError,{error:u.message}))}),onSuccess:()=>{t.invalidateQueries({queryKey:["account-status"]})}})}function Qe({workspace:a}){const[t,s]=d.useState(a?.name??""),[n,r]=d.useState(!1);!n&&a&&(r(!0),t==""&&s(a?.name??""));const[o,i]=d.useState(a.profilePictureUrl),[u,x]=d.useState(a.profilePictureId),y=qe(P.WorkspaceAppearance),b=E(),W=z(),U=()=>I.closeModal(P.WorkspaceAppearance),[l,j]=d.useState(void 0);async function se(f){const M=await Pe(f,K.workspaceAvatarPreview*2),H=Se(M);j({tempId:H,file:M,status:A.Uploading,progress:1,fileId:null,cdnUrl:null}),Ce(H,M,b,W,le.ProfilePicture,{onFileCreated(w,h,g){j(c=>c!=="initial"&&c?.tempId===w&&c.status===A.Uploading?{...c,progress:10,fileId:h,cdnUrl:g}:c)},onFileUploadProgress(w,h){j(g=>g!=="initial"&&g?.tempId===w&&g.status===A.Uploading?{...g,progress:h}:g)},onFileUploaded(w,h,g){j(c=>c!=="initial"&&c&&c.cdnUrl&&c.tempId===w?(Q.getFileDownloadLink(c.fileId).then(O=>{O.status===de.Success&&(x(c.fileId),i(O.download_url))}),{...c,status:A.Ready,progress:100,fileSpec:{name:c.file.name,id:c.fileId,size:c.file.size,...g??{}}}):c)},onError(w){j(h=>{if(h!=="initial"&&h?.tempId===w){x(void 0),i(void 0),T(null);return}return h})}})}const G=Je(a.id),te=e.jsx($.Button,{color:"primary",disabled:l!=="initial"&&l!==void 0&&l.status!==A.Ready||l!=="initial"&&l!==void 0&&l.status===A.Ready&&!o||G.isPending||t.trim().length===0,onClick:async()=>{G.mutate({name:t,profilePictureId:u,profilePictureUrl:o}),I.closeModal(P.WorkspaceAppearance)},title:b.formatMessage(k.modalSubmit)}),ne=e.jsx($.Button,{onClick:()=>{j(void 0),x(a.profilePictureId),i(a.profilePictureUrl),I.closeModal(P.WorkspaceAppearance)},title:b.formatMessage(k.modalCancel)}),[R,T]=d.useState(null);d.useEffect(()=>{if(l!=="initial"&&l!=null&&R==null){const f=new FileReader;f.addEventListener("load",()=>{const M=f.result;typeof M=="string"&&T(M)}),f.readAsDataURL(l.file)}},[l,R]);const re=()=>{x(null),i(null),j(void 0),T(null)};return e.jsxs(oe,{isOpen:y,onClose:U,showCloseButton:!0,primaryButton:te,secondaryButton:ne,type:"danger",title:b.formatMessage(k.modalTitle),children:[e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-name",className:"block pb-1 font-semibold text-token-text-primary",children:e.jsx(m,{...k.workspaceName})}),e.jsx("p",{className:"font-base text-sm text-token-text-secondary",children:e.jsx(m,{...k.workspaceNameDescription})})]}),e.jsx("div",{className:"mb-4",children:e.jsx(ye,{type:"text",name:"workspace-name",value:t,onChange:f=>s(f.target.value),maxLength:64})}),e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-avatar",className:"block pb-1 font-semibold text-token-text-primary",children:e.jsx(m,{...k.workspaceAvatar})}),e.jsx("p",{className:"font-base text-sm text-token-text-secondary",children:b.formatMessage(k.workspaceAvatarDescription,{size:K.workspaceAvatarPreview*2})})]}),e.jsxs("div",{className:"mb-4 flex-wrap text-center",children:[o?e.jsxs("div",{className:"relative mb-3 inline-flex",children:[e.jsx(L,{src:o,size:"workspaceAvatarPreview"}),e.jsx("div",{className:"absolute -right-1 -top-1",children:e.jsx(Ze,{onClick:re})})]}):l!=null&&l!=="initial"&&R?e.jsx("div",{className:"flex flex-col justify-center text-center",children:e.jsxs("div",{className:"relative mb-3 text-center",children:[e.jsx(L,{src:URL.createObjectURL(l.file),size:"workspaceAvatarPreview"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:e.jsx(Me,{percentage:l.progress,className:"h-6 w-6"})})]})}):e.jsx(Ye,{onFileChange:f=>{se(f)},mimeTypes:Ae}),e.jsx(Ne,{className:"mt-3",children:b.formatMessage(k.propagationWarning)})]})]})}function Ze({onClick:a}){return e.jsx("div",{className:"flex h-6 w-6 cursor-pointer flex-row flex-wrap content-center justify-center rounded-full border-2 border-white bg-black text-white",onClick:a,children:e.jsx(Re,{className:"h-3 w-3"})})}const k=B({modalTitle:{id:"workspaceAppearanceModal.title",defaultMessage:"Workspace appearance"},modalSubmit:{id:"workspaceAppearanceModal.submit",defaultMessage:"Save"},modalCancel:{id:"workspaceAppearanceModal.cancel",defaultMessage:"Cancel"},workspaceName:{id:"workspaceAppearanceModal.workspaceName",defaultMessage:"Workspace name"},workspaceNameDescription:{id:"workspaceAppearanceModal.workspaceNameDescription",defaultMessage:"Update the name of the workspace."},workspaceAvatar:{id:"workspaceAppearanceModal.workspaceAvatar",defaultMessage:"Workspace image"},workspaceAvatarDescription:{id:"workspaceAppearanceModal.workspaceAvatarDescription",defaultMessage:"Upload a JPEG or PNG workspace image for your team. (Minimum {size}Ã—{size}px recommended.)"},propagationWarning:{id:"workspaceAppearanceModal.propagationWarning",defaultMessage:"Changes to the workspace name and image may take some time to take effect."},saveError:{id:"workspaceAppearanceModal.saveError",defaultMessage:"Failed to save workspace appearance"}});function ma(){return ue(me("routes/admin"))}function pa(){const a=C(n=>n.currentWorkspace),t=a!=null?Z(a.role):void 0,s=N();d.useEffect(()=>{t===!1&&s("/admin")},[t,s])}function xa(){const a=C(n=>n.currentWorkspace),t=a!=null?V(a.role):void 0,s=N();d.useEffect(()=>{t===!1&&s("/admin")},[t,s])}function ee(){return pe("1001765573").config.get("ca_enabled",!1)}function fa(){const a=ee(),t=N();d.useEffect(()=>{a===!1&&t("/admin")},[a,t])}function Ve({accountId:a,subscription:t}){const s=E(),n=z(),r=Ke(a),[o,i]=d.useState(!1),u=We(a),x=async()=>{i(!0);try{await r.mutateAsync(a)}catch{n.warning(s.formatMessage(D.errorRenewingSubscription),{hasCloseButton:!0})}finally{i(!1)}};return e.jsx("div",{className:"bg-token-main-surface-secondary",children:e.jsxs("div",{className:"mx-auto flex w-full max-w-5xl items-center justify-between px-2 py-4 md:px-6 lg:px-10 lg:py-6",children:[e.jsxs("div",{className:"mx-2 flex-grow md:mx-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"mr-4 hidden text-orange-500 md:block"}),e.jsx("p",{className:"text-lg font-semibold",children:e.jsx(m,{...D.workspaceWillBeDeactivated})})]}),t.active_until!=null&&e.jsx("p",{className:"md:ml-8",children:e.jsx(m,{...D.retainAccessUntil,values:{expiryDate:new Date(t.active_until)}})})]}),u&&e.jsx(fe,{color:"primary",onClick:x,loading:o,children:e.jsx(m,{...D.reactivateBtn})})]})})}const D=B({retainAccessUntil:{id:"adminPage.retainAccessUntil",defaultMessage:"You will retain access to the workspace until the end of your billing cycle on {expiryDate, date, long}."},workspaceWillBeDeactivated:{id:"adminPage.workspaceWillBeDeactivated",defaultMessage:"This workspace will be deactivated."},reactivateBtn:{id:"adminPage.reactivateBtn",defaultMessage:"Reactivate"},errorRenewingSubscription:{id:"adminPage.errorRenewingSubscription",defaultMessage:"There was an error reactivating your subscription."}});function v({route:a,icon:t,name:s,upsellEnterprise:n=!1}){const r=ke().pathname.replace(/\/$/,"")||"/",o=N();return n?e.jsx(be,{label:e.jsx(m,{...p.availableForEnterprise}),side:"right",children:e.jsxs(Y,{$as:"button",className:F("w-full rounded text-left","hover:bg-token-sidebar-surface-secondary"),children:[e.jsx($e,{className:"icon-sm shrink-0 text-token-text-secondary"}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(m,{...s})})]})}):e.jsxs(Y,{$as:"button",className:F("w-full rounded text-left hover:bg-token-sidebar-surface-secondary",r===a&&"bg-token-sidebar-surface-secondary"),onClick:i=>{o(a),i.stopPropagation()},children:[t,e.jsx(m,{...s})]})}function ea({workspace:a,hasAdminPrivileges:t,hasOwnerPrivileges:s}){const n=N(),r=d.useCallback(()=>{n("/")},[n]),o=C(Ue.isEnterpriseyPlan),i=ee();return e.jsxs("nav",{className:"p-2",children:[e.jsx("div",{className:"mb-1 flex flex-row gap-2",children:e.jsxs(Ee,{onClick:r,children:[e.jsx(De,{className:"icon-sm"}),e.jsx(m,{...p.backToChat})]})}),e.jsxs("div",{className:"flex flex-col gap-2 py-2",children:[e.jsxs("div",{className:`flex flex-col gap-2 rounded px-2 py-2 ${s?"cursor-pointer hover:bg-token-main-surface-secondary":""}`,onClick:()=>{s&&I.openModal(P.WorkspaceAppearance)},children:[e.jsx(L,{size:"large",src:a?.profilePictureUrl}),e.jsxs("div",{className:"align-center flex flex-row",children:[e.jsx("h2",{className:"flex-1 text-lg text-token-text-primary dark:text-white",children:a?.name}),s?e.jsx("div",{className:"my-auto h-4 flex-initial align-middle dark:text-white",children:e.jsx(Te,{className:"icon-sm opacity-70 hover:opacity-100"})}):null]})]}),e.jsx(v,{route:"/admin",icon:e.jsx(Fe,{className:"icon-sm"}),name:p.membersPageTitle}),o&&e.jsx(v,{route:"/admin/groups",icon:e.jsx(X,{className:"icon-sm"}),upsellEnterprise:!o,name:q({id:"aecR1i",defaultMessage:"Groups"})}),s&&e.jsx(v,{route:"/admin/billing",icon:e.jsx(Le,{className:"icon-sm"}),name:p.billing}),s&&e.jsx(v,{route:"/admin/gpts",icon:e.jsx(ze,{className:"icon-sm"}),name:p.gpts}),t&&i&&e.jsx(v,{route:"/admin/connectors",icon:e.jsx(_e,{className:"icon-sm"}),name:p.connectors}),s&&e.jsx(v,{route:"/admin/settings",icon:e.jsx(Ge,{className:"icon-sm"}),name:p.settings}),!o&&e.jsx("span",{className:"mx-3 border-t border-y-token-border-medium"}),!o&&e.jsx(v,{route:"/admin/groups",icon:e.jsx(X,{className:"icon-sm"}),upsellEnterprise:!o,name:q({id:"aecR1i",defaultMessage:"Groups"})}),t&&e.jsx(v,{route:"/admin/analytics",icon:e.jsx(He,{className:"icon-sm"}),name:p.analytics,upsellEnterprise:!o}),s&&e.jsx(v,{route:"/admin/identity",upsellEnterprise:!o,icon:e.jsx(Oe,{className:"icon-sm"}),name:p.identity})]})]})}function ga({mobilePageTitle:a,requireAdminPrivileges:t=!1,requireOwnerPrivileges:s=!1,children:n}){const r=C(y=>y.currentWorkspace),o=N(),i=r!=null?Z(r.role):void 0,u=r!=null?V(r.role):void 0;return d.useEffect(()=>{t&&i===!1&&o("/admin"),s&&u===!1&&o("/admin")},[t,i,o,s,u]),_()==null?null:e.jsxs(e.Fragment,{children:[e.jsx(Ie,{mobileHeaderContent:a,forceOpenDesktopSidebar:!0,sidebar:e.jsx(ea,{workspace:r??void 0,hasAdminPrivileges:i,hasOwnerPrivileges:u}),children:n}),r==null?null:e.jsx(Qe,{workspace:r})]})}const aa=S.div`border-b border-token-main-surface-tertiary hidden md:block py-6 lg:py-10`,ae=S.h2`mx-auto w-full max-w-4xl px-2 md:px-6 lg:px-10`,sa=S(ae)`font-normal text-base text-token-text-secondary`;S.p`text-sm text-token-text-tertiary`;function va({title:a,subtitle:t}){const{data:s}=Xe(),n=_(),r=n&&s&&s.plan_type===ge.TEAM&&!s.will_renew;return e.jsxs(e.Fragment,{children:[r&&e.jsx(Ve,{accountId:n.id,subscription:s}),e.jsxs(aa,{children:[e.jsx(ae,{children:a}),t&&e.jsx(sa,{children:t})]})]})}const ta=S.div`max-w-4xl mx-auto w-full px-2 md:px-6 lg:px-10`;function ka({children:a,showSpinner:t}){const s=_(),n=C(o=>o.currentWorkspace),r=!s||t;return e.jsxs(ta,{children:[r&&e.jsx("div",{className:"flex min-h-[80vh] items-center justify-center",children:e.jsx(ve,{})}),!r&&!n&&e.jsx("div",{className:"flex min-h-[80vh] items-center justify-center",children:e.jsx(m,{...p.workspaceNotFound})}),!r&&n&&a]})}const p=B({workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},membersPageTitle:{id:"adminPage.membersPageTitle",defaultMessage:"Members"},analytics:{id:"adminPage.analytics",defaultMessage:"Analytics"},billing:{id:"adminPage.billing.1",defaultMessage:"Billing"},gpts:{id:"adminPage.gpts",defaultMessage:"GPTs"},connectors:{id:"adminPage.connectors",defaultMessage:"Connectors"},settings:{id:"adminPage.Settings",defaultMessage:"Settings"},identity:{id:"adminPage.identity.0",defaultMessage:"Identity & provisioning"},availableForEnterprise:{id:"adminPage.availableForEnterprise",defaultMessage:"Available for Enterprise plan"}});export{ga as A,va as a,ka as b,pa as c,xa as d,fa as e,ma as u};
//# sourceMappingURL=owdfeu68zx2kjldp.js.map
