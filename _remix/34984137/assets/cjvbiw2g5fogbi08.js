import{aB as L,az as j,aG as G,ao as h,r as d,P as p,a as f,l as t,Z as r,bc as T,a0 as I,aM as w,eM as B,a8 as U,bz as R,V as H,c as K,i as F,bO as V,eN as q,d7 as Y,j as Q}from"./kqqkpdulatnhj153.js";import{da as M,a8 as _,dp as z,au as W}from"./n3rs6b5m6tqfdjyk.js";import{L as O}from"./gg12z91ptfq2dx0l.js";import{c as X}from"./ljkmhw662c6t9mhx.js";import{T as Z}from"./difcbbya6lgzvb2g.js";function J(){return j("437245079").value}function $(){const e=J(),n=X(),s=L("1908072088").config.value,{eligible:o,isLoading:a}=M(_.AG8PqS2q);return{eligible:o&&e&&n&&s.blocking_modal===!0,singleButtonVariant:s.single_button_variant===!0,isLoading:a}}const x=_.UseSidekick,ee=_.SidekickLauncherOnboarding,v="https://persistent.oaistatic.com/sidekick/public/ChatGPT_Desktop_public_latest.dmg",P="download";function A(){const e=w(),n=B("1696863369").layer.get("has_sidekick_access",!1);return e!=null&&n}function ne(e){return e===P}function oe(){const e=U(),s=(R(()=>e.asPath)??"").split("#"),o=ne(s[1]);return{openModal:()=>{const c=e.asPath.split("#");e.replace(c[0]+"#"+P)},closeModal:()=>{e.replace(s[0])},isOpen:o}}function me(e){const{eligible:n,isLoading:s}=$(),o=A(),{eligible:a,isLoading:c}=M(x),{eligible:u,isLoading:g}=M(ee),m=n||!a||!u||!o||e.conversationMode?.kind!==G.PrimaryAssistant,b=s||g||c;return{eligible:!m&&h.getLayerValue({layerName:"1696863369",key:"show_nux_banner",defaultValue:!1}),isLoading:b}}function ke({onClose:e}){d.useEffect(()=>{p.logEvent(f.sidekickAnnouncementShown),h.logEvent("chatgpt_sidekick_announcement_shown")},[]);const{markAsViewed:n}=M(x),s=d.useCallback(()=>{n(),p.logEvent(f.sidekickAnnouncementDismissed),h.logEvent("chatgpt_sidekick_announcement_closed"),e&&e()},[n,e]),o=d.useCallback(()=>{p.logEvent(f.sidekickAnnouncementLinkClicked),h.logEvent("chatgpt_sidekick_announcement_download_clicked"),n(),e&&e()},[n,e]),a={downloadUrl:v,markAsDownloaded:o,markAsViewed:s,isSidekickAvailable:A()};return t.jsx(ie,{...a})}function se(){window.open(v,"_blank")}function te(){return w()?.isPlus()?i.bannerTitleMentioningPlus:i.bannerTitleNotMentioningPlus}function he(){const{closeModal:e,isOpen:n}=oe(),s=A(),o=d.useMemo(()=>({isDesktopAppAvailable:s}),[s]),a=()=>{p.logEvent(f.sidekickDownloadModalClosed,o),h.logEvent("chatgpt_sidekick_modal_closed"),e()},c=()=>{p.logEvent(f.sidekickDownloadModalDownloaded,o),h.logEvent("chatgpt_sidekick_modal_download_clicked"),e()};return d.useEffect(()=>{n&&(p.logEvent(f.sidekickDownloadModalShown,{...o}),h.logEvent("chatgpt_sidekick_modal_shown"))},[o,n]),n?t.jsx(ae,{downloadUrl:v,markAsDownloaded:c,markAsViewed:a,isSidekickAvailable:s}):null}function ae({downloadUrl:e,markAsDownloaded:n,markAsViewed:s,isSidekickAvailable:o}){const a=o?i.modalTitleEligible:i.modalTitleNotEligible,c=t.jsx(r,{...a}),u=t.jsx(r,{...i.modalContent}),g=o?i.disclaimer:i.comingSoonDisclaimer,m=t.jsx(r,{...g,values:{learnMoreLink:y=>t.jsx(O,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:y})}}),b=t.jsxs("div",{children:[t.jsx("div",{children:u}),t.jsx("div",{className:"mt-2",children:m})]}),S=t.jsx(T,{as:"link",to:e,color:"primary",onClick:n,openNewTab:!0,children:t.jsx(r,{...i.download})}),l=t.jsx(T,{color:"secondary",onClick:s,children:t.jsx(r,{...i.close})}),k=o?S:l,N=o?l:void 0;return t.jsx(z,{onClose:s,title:c,description:b,actionButton:k,cancelButton:N})}function ie({markAsDownloaded:e,markAsViewed:n}){const s=H(),o=d.useCallback(()=>{se(),e()},[e]),a=t.jsx(r,{...te()}),c=t.jsx(r,{...i.bannerContent}),u=t.jsx(r,{...i.disclaimer,values:{learnMoreLink:m=>t.jsx(O,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:m})}}),g=t.jsxs("div",{className:"flex-grow",children:[t.jsx("div",{className:"mb-0.5 font-semibold",children:a}),t.jsxs("span",{className:"text-token-text-secondary",children:[c," ",u]})]});return t.jsx(W,{onPrimaryCtaClick:o,primaryCtaText:s.formatMessage(i.download),onDismiss:n,content:g})}const i=I({bannerTitleNotMentioningPlus:{id:"SidekickOnboarding.bannerTitleEnterprisey_2",defaultMessage:"ChatGPT is available for macOS 14+ with Apple Silicon"},bannerTitleMentioningPlus:{id:"SidekickOnboarding.bannerTitleMentioningPlus",defaultMessage:"ChatGPT is now available for macOSâ€”Plus users get early access"},modalTitleEligible:{id:"SidekickOnboarding.modalTitleEligible",defaultMessage:"The ChatGPT app is now available for macOS"},modalTitleNotEligible:{id:"SidekickOnboarding.modalTitleNotEligible",defaultMessage:"The ChatGPT macOS desktop app is coming soon"},modalContent:{id:"SidekickOnboarding.modal_content_eligible",defaultMessage:"Quickly access ChatGPT from anywhere on your computer with a shortcut: Option + Space. Share screenshots, upload files and photos, have voice conversations, and search through past conversations."},bannerContent:{id:"SidekickOnboarding.banner_content_3",defaultMessage:"Get faster access to ChatGPT with the Option + Space shortcut and the floating companion window."},disclaimer:{id:"SidekickOnboarding.disclaimer_3",defaultMessage:"<learnMoreLink>Learn more</learnMoreLink>."},comingSoonDisclaimer:{id:"SidekickOnboarding.coming_soon_disclaimer",defaultMessage:"The app will be available over the next couple of weeks."},download:{id:"SidekickOnboarding.download",defaultMessage:"Download"},close:{id:"SidekickOnboarding.close",defaultMessage:"Close"}}),E=K(F(()=>({statusMap:{}}))),pe=e=>E(n=>n.statusMap[e]),fe=(e,n)=>{E.setState(s=>{s.statusMap[e]=n;const o=Z.getServerThreadId(e);o&&(s.statusMap[o]=n)})},D=e=>{E.setState(n=>{for(const{id:s,async_status:o}of e)n.statusMap[s]=o})},ce=28,C="conversationHistory";function be(){const n=V()?.includes(q)??!1,s=w(),o=!n&&!!s?.data,{data:a,fetchNextPage:c,hasNextPage:u,isInitialLoading:g,isFetchingNextPage:m,isError:b}=Y({queryKey:[C],queryFn:async({pageParam:l})=>{const k=await Q.getConversations({offset:l,limit:ce});return D(k.items),k},initialPageParam:0,getNextPageParam:l=>{const k=l.offset+l.limit;return k<l.total?k:void 0},enabled:o}),S=d.useMemo(()=>a?.pages.flatMap(l=>l.items)??[],[a]);return d.useEffect(()=>{D(S)},[S]),{conversations:S,data:a,fetchNextPage:c,hasNextPage:u,isLoading:g,isFetchingNextPage:m,isError:b}}function Se(e){e.invalidateQueries({queryKey:[C]})}export{C,he as D,$ as a,pe as b,A as c,oe as d,ke as e,me as f,Se as r,fe as s,be as u};
//# sourceMappingURL=cjvbiw2g5fogbi08.js.map
