import{K as u,L as d,r as m,a8 as S,cn as l,aK as y,h as T,j as p,D as f}from"./knistvoayd9w5dlh.js";import{cA as a,cB as v,cC as R}from"./bzpogxw1ym966dib.js";import{P as h,r as A}from"./c3cyng6qx8iiz8qa.js";import{s as C}from"./hr63ipejtreaccw8.js";import{e as P,i as H,T as b}from"./g3edk9aakj5fvio1.js";const M="prompt-textarea";function O(){document.getElementById(M)?.focus()}const F={getAndReset:(e,s)=>{const t=u.getItem(d.RestoreMessageAfterOauthRedirect);return u.removeItem(d.RestoreMessageAfterOauthRedirect),!t||t.userId!==e||s!==t.serverThreadId||Date.now()>t.expiresAt?null:t},set:(e,s,t)=>{const r={userId:e,serverThreadId:s,inputText:t,expiresAt:Date.now()+6e4};u.setItem(d.RestoreMessageAfterOauthRedirect,r)}},K=()=>h.useState(h.getPersistedSystemHints).has(a.Search),k=()=>{const e=h.useStore(),s=m.useCallback(()=>e.getPersistedSystemHintTrigger(a.Search),[e]),t=m.useCallback(()=>e.clearPersistedSystemHintTrigger(a.Search),[e]),r=m.useCallback((o,n,i)=>{(o?e.addPersistedSystemHint:e.removePersistedSystemHint)(a.Search,n,i)},[e]);return{getSearchModeTrigger:s,clearSearchModeTrigger:t,setThreadSearchMode:r}};async function x(e,s){const t=R(e),r=t??await p.getConversation(e);return s==null&&t&&(s=!0),t||f.addTiming("chatgpt.web.chatPage.loadExistingConversation"),b.initThreadFromServerData(e,r,s,void 0,s),C(r.conversation_id,r.async_status??null),r}const q=e=>{const{asPath:s,replace:t}=S(),r=l(),o=P(),n=y();T({queryKey:["conversation",e],queryFn:()=>x(e).catch(i=>{const c=v(s),g=c!=null?A(c):"/";throw t(g,void 0,{shallow:!0}),n.danger(`Unable to load conversation ${e}`,{testId:"conversation-fetch-error-toaster"}),i}),enabled:!H(e)&&!r&&!o,refetchOnMount:!0})};export{F as P,M as T,k as a,K as b,x as f,O as t,q as u};
//# sourceMappingURL=29q49b6ohvllb80t.js.map
