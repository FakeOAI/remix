import{eo as Y,G,r as m,Z as F,m as e,aI as T,F as q,dP as Q,aQ as z,eS as X,aC as y,bo as L,d2 as $,a_ as w,fu as I,bU as J,bV as ee,gi as se,fp as A}from"./b6hz7w82w2qja9j6.js";import{j as E,bu as te,eL as ae,iS as M,bM as ne,aB as ie,c2 as oe,iT as C,iU as re,iV as le,bS as P,iW as ce,dV as de,U as _,ed as me,ak as ue,iX as ge,i0 as xe,i1 as fe,iY as pe,iZ as v,i_ as he,i$ as f,cO as Se,j0 as be,j1 as je,j2 as ve,dA as Ce,j3 as B,al as U,j4 as ke,j5 as ye,j6 as Ie,j7 as k,f9 as ze,dB as Ne,j8 as Me,j9 as Ge,ja as Fe,eI as Te,jb as Oe,jc as Le}from"./fd0nu61alu12xp2y.js";import{as as we,bu as Ae,x as Ee,aw as Pe,K as _e,b7 as Be,L as D,aG as Ue,ad as De}from"./sujxda05pmld8bxp.js";import{m as W}from"./h670elogidx3nae7.js";import{a as We}from"./lo1tuqhw1i3rqb8v.js";import{U as Re,P as He}from"./c42k56y6iuym81g4.js";function Ke({gizmo:s,historyDisabled:i,section:a,onClick:r,isActive:d,hideOverflowMenu:x=!1}){const{clientThreadId:l}=E();Y(l);const c=G(),[u,p]=m.useState(!1),[n,S]=m.useState(!1),[t,o]=m.useState(!1),g=F(),h=!!s?.gizmo.tags?.includes(te.FirstParty),b=!1;let Z=!1;const[V,Je]=m.useState(0);let j;if(s!=null)j=s.gizmo.display.name||ae;else{if(g==null)return null;i?j=c.formatMessage(M.clearChat):g.canInteractWithGizmos()?j=le:j=c.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(W.div,{whileTap:{scale:.98},onMouseEnter:()=>{S(!0)},onMouseLeave:()=>{S(!1)},children:e.jsx(ne,{loggingGizmoId:s?.gizmo.id??"primary",href:s!=null?ie(s):"/",onClick:r,showActiveIndicator:Z,icon:e.jsx(oe,{gizmoId:s?.gizmo.id,isFirstParty:s==null||h,gizmoEmoji:s?.gizmo.display.emoji,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6"}),isMenuOpen:u,label:j,hoverLeftIcon:n&&s&&b&&V&&e.jsx("button",{onClick:N=>{N.preventDefault(),o(!t)},className:"flex text-token-text-secondary hover:text-token-text-primary",children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:t?e.jsx(we,{className:"icon-md"}):e.jsx(Ae,{className:"icon-md"})})})}),rightIcon:a===C.Workspace&&e.jsx(T,{side:"right",label:c.formatMessage(O.workspaceRecommended,{workspace_name:g?.name??"Your Workspace"}),children:e.jsx(Ee,{className:"icon-md text-token-text-secondary",alt:c.formatMessage(O.workspaceRecommended,{workspace_name:g?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(n||u)&&s!=null&&!b&&!x&&e.jsx("div",{className:"text-token-text-tertiary",onClick:N=>{N.preventDefault()},children:e.jsx(re,{gizmo:s,isOpen:u,setIsOpen:p,section:a})}),!x&&e.jsx(T,{side:"right",label:c.formatMessage(i?M.clearChat:M.newChat),className:"flex items-center",children:e.jsx("button",{className:u?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:i?e.jsx(Pe,{className:"icon-md"}):e.jsx(_e,{className:"icon-md"})})})]})})}),!1]})}const O=q({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}});function R(){const s=G(),i=P(),a=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(ce,{children:e.jsx(W.div,{whileTap:{scale:.98},children:e.jsx(Q,{to:de(),onClick:()=>{i.activeSidebar==="popover-nav"&&_.setActiveSidebar(!1)},children:e.jsx(me,{icon:Be,"data-testid":"explore-gpts-button",children:a})},"explore")})})}const Ze=2;function H({gizmos:s,isGizmoFlyout:i,isLoaded:a,maxToShowOnLoad:r=4,isScreenArch:d,showAllSidebarItems:x}){const l=pe(s,o=>o.flair.kind),c=[...(l[v.Workspace]?.map(({resource:o})=>({gizmo:o,section:C.Workspace}))??[]).slice(0,3),...l[v.FirstParty]?.map(({resource:o})=>({gizmo:o,section:C.Keep}))??[],...l[v.SidebarKeep]?.map(({resource:o})=>({gizmo:o,section:C.Keep}))??[]],u=l[v.Recent]?.slice(0,d||a?l[v.Recent]?.length:Ze).map(({resource:o})=>({gizmo:o,section:C.Recents}))??[],p=u.length,n=c.length,S=d?p>0:s.length>r;let t=[];return i&&d?t=[...c,...u]:!i&&d?t=c:(t=[...c,...u],x||(t.length>r&&n>r?t=t.slice(0,n):t.length>r&&(t=t.slice(0,r)))),{listItems:t,itemsLeft:s.length-t.length,needsToCollapseItems:S,total:s.length}}function K({gizmo:s,currentGizmoId:i,maxToShowOnLoad:a,hideOverflowMenu:r=!1}){const d=m.useRef(!1),x=!a,l=ue(),[c,u]=m.useState(!1),p=P(g=>!ge.isGptListCollapsed(g)),{listItems:n,needsToCollapseItems:S,itemsLeft:t}=H({gizmos:s,isGizmoFlyout:x,isLoaded:c,maxToShowOnLoad:a,isScreenArch:l,showAllSidebarItems:p});m.useEffect(()=>{c||u(!0)},[c]),m.useEffect(()=>{n.length>0&&!d.current&&(xe({namespace:fe.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),d.current=!0)},[n]);function o(g,h){const b=e.jsx(Ke,{gizmo:g,isActive:g.gizmo.id===i,section:h,hideOverflowMenu:r},g.gizmo.id);return l?e.jsx("li",{children:b}):b}return e.jsxs("div",{children:[n.map(({gizmo:g,section:h},b)=>e.jsxs(m.Fragment,{children:[b>1&&h!==n[b-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),o(g,h)]},b)),!l&&S?e.jsxs("button",{onClick:_.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(D,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:p?e.jsxs(e.Fragment,{children:[e.jsx(z,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(Ue,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:t}}),e.jsx(De,{className:"icon-xs"})]})})]}):null,!l&&e.jsx(R,{})]})}function Ve({currentGizmoId:s,gizmos:i,onClick:a}){const{isSidebarFlyoutOpen:r,onSidebarFlyoutOpenChange:d}=he(),x=r(f.Gizmo);return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(X,{onOpenChange:l=>d(f.Gizmo,l),side:"right",sideOffset:4,open:x,contentAlign:"end",triggerButton:e.jsxs("button",{className:y("flex flex-1 select-none items-center gap-2 rounded-lg px-2 py-2 text-sm tracking-condensed text-token-text-secondary hover:bg-token-main-surface-secondary focus:ring-0",x&&"bg-token-main-surface-secondary"),onClick:a,children:[e.jsx(D,{className:y("icon-md mr-1 font-semibold text-token-sidebar-icon")}),e.jsx("span",{className:"text-left",children:e.jsx(z,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(L,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(K,{gizmo:i,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function Ye({currentGizmoId:s}){const{data:{gizmos:i}={}}=Se();let a=i;const r=!a||a?.length===0,{needsToCollapseItems:d}=H({gizmos:a??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return r?null:e.jsx(e.Fragment,{children:e.jsxs(be,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(z,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(R,{}),e.jsx(K,{gizmo:a??[],currentGizmoId:s,maxToShowOnLoad:je}),d&&e.jsx(L,{children:e.jsx(Ve,{currentGizmoId:s,gizmos:a??[]})})]})})}function qe({clientThreadId:s}){const i=F(),a=$(s),{isUnauthenticated:r}=w();return r?null:e.jsxs("div",{className:y(I.screenContent),children:[null,e.jsx(ve,{clientThreadId:s}),i?.canInteractWithGizmos()?e.jsx(Ye,{currentGizmoId:a}):null]})}function Qe(){const s=F(),i=s?.data==null,{isUnauthenticated:a}=w(),{openSettings:r}=Ce(),[d]=m.useState(()=>{const n=J.getCookie(ee.Workspace);return typeof n=="string"&&n!==se}),x=G(),{store:l,actions:c}=B(),u=l(n=>n.mode);if(!s||d&&i)return null;const p=a?e.jsx(Re,{}):e.jsx(We,{onClickSettings:()=>r()});return e.jsxs(U,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[p,e.jsx("div",{className:I.togglePinWrapper,children:e.jsx(ke,{tooltipSideOffset:14,className:I.pinSidebarAction,icon:e.jsx(ye,{}),onActivate:n=>{n.preventDefault(),n.persist(),Ie.togglePinSidebar(n,c,u===k.Floating?k.Pinned:k.Floating)},label:u===k.Floating?x.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):x.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:A.FloatingOrPinned})})]})}function Xe(){return e.jsx(U,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(He,{})})}function $e(){return e.jsxs(ze,{className:y(I.screenTrailingBarContainer),children:[e.jsx(Ne,{}),e.jsx(Xe,{}),e.jsx(Qe,{})]})}function os(){const{clientThreadId:s,onNewThread:i}=E(),[a,r]=m.useState(!1),[d,x]=m.useState(!1),[l,c]=m.useState(!1),{store:u}=B(),p=m.useCallback(t=>t===f.Conversation?a:t===f.Gizmo?d:t===f.Conversation2?l:!1,[a,d,l]),n=m.useCallback((t,o)=>{const g=h=>{t===f.Conversation?r(h):t===f.Gizmo?x(h):t===f.Conversation2&&c(h)};if(o){g(o);return}setTimeout(()=>{g(o)},100)},[]),S=m.useRef(null);return Me(()=>{n(f.Conversation,!1),n(f.Gizmo,!1),n(f.Conversation2,!1);const t=window.matchMedia("(max-width: 700px)").matches,o=Le(S.current);t&&(u.getState().mode===k.Floating||o)&&setTimeout(()=>{document.getElementById(A.OpenOrClosed)?.click()},100)}),e.jsxs(Ge,{value:{isSidebarFlyoutOpen:p,onSidebarFlyoutOpenChange:n},children:[e.jsx(Fe,{}),e.jsx(Te,{anchor:"vertical",className:y(I.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Oe,{onNewThread:i}),ref:S,trackLeading:!0,trailing:e.jsx($e,{}),children:e.jsx(qe,{clientThreadId:s})})]})}export{os as C,Ke as G,K as a};
//# sourceMappingURL=d41nh8ppaag0veke.js.map
