import{eQ as q,r as f,dq as ue,bo as ae,eR as ce,P as H,eS as le,ao as c,e6 as A,ar as j,av as T,F as V,W as fe,cQ as ye,e4 as me,bk as de,bq as ge,a6 as K,bF as Y,B as G,D as M,bR as B}from"./b95k5sm390dfb82m.js";import{bX as Z,D as O,bC as pe,d8 as he,d9 as ze,da as _e,db as x,bt as Ge,dc as Pe,dd as b,aL as i,de as Me,df as Se,dg as ve,dh as Ce,di as be}from"./d570jy65vqz0su9a.js";import{r as qe,T as $,g as Ee}from"./ficmbl9xyfodol3v.js";const We="text-davinci-002-render-sha",je="gpt-4",Ve="gpt-4o",Ye="o1-preview",Ze="o1-mini",L=Z({slug:O,max_tokens:4097,title:"Default",description:"",tags:[q.GPT_3_5],product_features:{}}),Fe=({default_model:e,tagline:r,color:t,human_category_name:n,category:s,human_category_short_name:o,human_category_shorter_name:u,subscription_level:a,short_explainer:y,subcategory:l,...m})=>({color:t,tagline:r,defaultModel:e,label:n,shortLabel:o,description:y,shorterLabel:u??o,subscriptionLevel:a,categoryId:s,subcategory:l,...m}),we=({icon:e,icon_filled_src:r,icon_outline_src:t})=>({iconName:e,iconFilledSrc:r,iconOutlineSrc:t}),Qe=({group:e,human_group_name:r,human_group_short_name:t,model_ids:n})=>({group:e,label:r,shortLabel:t,modelIds:n});function Le(){return T({retry:5,queryKey:["modelIcons"],queryFn:async()=>await V.getModelIcons().then(e=>Object.fromEntries(Object.entries(e).map(([r,t])=>[r,we(t)])))})}function Te(e){return T({retry:5,queryKey:["models",{isHistoryDisabled:e}],queryFn:async()=>await V.getModels(e).then(r=>{const{models:t,internal_groups:n,categories:s}=r,o=t.map(Z);return{categories:s.concat().reverse().map(Fe),groups:(n==null?void 0:n.map(Qe))??[],modelsList:o,modelsMap:Object.fromEntries(o.map(u=>[u.id,u]))}})})}function S(){const e=le();return c(Te(e))}function Xe(){return c(Le())}function Re({isRegen:e=!1}={}){const{isLoading:r,data:{categories:t=[],groups:n=[]}={}}=S(),s=f.useMemo(()=>e?t.filter(o=>o.is_regenerate_category!==!1):t.filter(o=>!o.is_regenerate_category),[t,e]);return{isLoading:r,categories:s,groups:n??[]}}function Je(){const{categories:e}=Re();return!!e.find(({categoryId:r})=>r===pe.GPT4o)}function er(){const{data:e}=S();return f.useMemo(()=>e?new Set(Object.keys(e.modelsMap)):new Set([O]),[e])}const Ue={[O]:L};function De(){const{data:e}=S();return(e==null?void 0:e.modelsMap)??Ue}function X(e,r,t){let n=q.GPT_3_5;return t?n=q.GPT_4:r&&(n=q.GPT_4o),(e==null?void 0:e.modelsList.find(s=>s.tags.includes(n)))??(e==null?void 0:e.modelsList[0])??L}function rr(e=!1){const r=ue(),t=ae(),[,n]=ce();return f.useCallback(({location:s,modelId:o})=>{const u=r.pathname.includes("/g/");e||u?(H.logNewChatButtonClicked({location:s}),t({pathname:"/",search:`?model=${encodeURIComponent(o)}`})):(n(a=>(a.set("model",encodeURIComponent(o)),a)),H.logNewChatButtonClicked({location:s}))},[e,r,t,n])}function tr(){const{data:{categories:e=[]}={}}=S(),{doesUserHaveAnyAccountsWithPlusFeatures:r}=A();if(r)return null;const t=e.find(he);return(t==null?void 0:t.defaultModel)??null}function Ae(e){return qe(e)}function nr(e){const r=Ae(e),t=De();return f.useMemo(()=>r==null?L:t[r]??L,[r,t])}function sr(e){return decodeURIComponent(e.model??"")||null}function or(){const{data:e}=S(),{doesUserHaveAnyAccountsWithPlusFeatures:r}=A(),t=j();return X(e,!!r,!!(t!=null&&t.isEnterprise()))}const J="q",Ke="m";function ir(e){const{clientThreadId:r,currentLeafId:t,handleRequestCompletion:n}=e,s=f.useRef(!1),{isLoading:o,data:u}=S(),{doesUserHaveAnyAccountsWithPlusFeatures:a,isLoading:y}=A(),l=j(),m=fe(),F=f.useCallback((d,P,g,C)=>{$.updateTree(r,p=>{p.addNode(d,g,P,ye.User,void 0,C)})},[r]),w=f.useCallback(async(d,{content:P,attachments:g},C,p,Q,D)=>{const h=t,z=g.length>0?{attachments:g}:{};z.system_hints=p.systemHints,F(d,h,P,z),n({type:me.Next,promptId:d,requestedModelId:D,eventMetadata:C,cancelActiveRequests:!0,completionMetadata:p,turnTracker:Q})},[F,n,t]),k=de(()=>window.location.pathname)??null;let R=!o&&!y&&Ie(k);const U=Ee.getConversationMode(r),ne=ze(),[se,v]=f.useState(!0);return Oe(k)&&ne===void 0&&(R=!1),f.useEffect(()=>{if(!R||s.current)return;const{[J]:d,[Ke]:P,[Pe]:g,...C}=m.query,p=(typeof d=="string"?d:null)??(typeof P=="string"?P:null);if(!p){v(!1);return}const Q=_e(g);if($.getServerThreadId(r)!=null){v(!1);return}if(U==null){v(!1);return}const D=ge();s.current=!0;let h=u==null?void 0:u.modelsList;Q.has(x.Search)&&(h=h==null?void 0:h.filter(ie=>{var N;return(N=ie.enabledTools)==null?void 0:N.includes(x.Search)}));const z=u&&X({...u,modelsList:h??[]},!!a,!!(l!=null&&l.isEnterprise()));if(m.replace({query:C},void 0,{shallow:!0}),z==null){K.warning("No model available for this request"),v(!1);return}const oe=new Ge;w(D,{content:p,attachments:[]},{eventSource:"url"},{conversationMode:U,source:"instant-query",systemHints:g?Array.from(Q):void 0},oe,z==null?void 0:z.id),v(!1)},[R,m,w,r,U,u,a,l]),se}function Oe(e){return ee(e)}function ee(e){return e==null?!1:/^\/g\/[\w-]+$/.test(e)}function Ie(e){return e==null?!1:e==="/"||ee(e)}const ur="GPT Builder";function ar(e){if(e)return`ChatGPT - ${e}`}function I(e){return e.gizmo.short_url??e.gizmo.id??"-"}function re(e){return`/g/${e}`}function cr(e){return`https://chatgpt.com${re(e)}`}function ke(e){return re(I(e))}function lr(e,r){const t=new URLSearchParams;return r!=null&&t.set(J,r),Me(new URL(`${ke(e)}?${t}`,"https://chatgpt.com"))}function fr(e){return`/g/${I(e)}`}function yr(e){return Se(e)&&e.gizmo.live_version===0||ve(e)&&e.liveVersion===0}function mr(e,r){return c({queryKey:["gizmos","discovery",{locale:e,isAnon:r}],queryFn:async()=>i.getGizmoDiscovery(e,r)})}function dr({cutId:e,locale:r,limit:t,cursor:n,enabled:s=!0}){return Y({queryKey:["gizmos","discovery",{cutId:e,locale:r,limit:t}],queryFn:async({pageParam:o})=>i.getGizmoDiscoveryCut(e,{locale:r,cursor:o,limit:t}),initialPageParam:n,getNextPageParam:o=>o.list.cursor??void 0,enabled:s})}function gr(){return c({queryKey:["gizmos","pinned"],queryFn:async()=>i.getGizmoPinned()})}function E(){return T({queryKey:["gizmos","bootstrap"],queryFn:async()=>i.getGizmoBootstrap().then(e=>({gizmos:e.gizmos.map(r=>({resource:r.resource,flair:r.flair}))}))})}function pr(){return c(E())}function W(e,r){const t=e.filter(s=>s.resource.gizmo.id!==r.resource.gizmo.id);let n=t.findIndex(s=>s.flair.kind===b.Recent);return n===-1&&(n=t.length),t.splice(n,0,r),t}const hr={handleGizmoInteracted(e,r){const t=e.getQueryData(_(e,r).queryKey);t!=null&&e.setQueryData(E().queryKey,n=>{if(n==null)return n;const s=n.gizmos.find(o=>o.resource.gizmo.id===r);return(s==null?void 0:s.flair.kind)===b.FirstParty||(s==null?void 0:s.flair.kind)===b.SidebarKeep?n:{gizmos:W(n.gizmos,{resource:t,flair:{kind:b.Recent}})}})},handleGizmoSidebarKeep(e,r){const t=e.getQueryData(_(e,r).queryKey);t!=null&&e.setQueryData(E().queryKey,n=>n==null?n:{gizmos:W(n.gizmos,{resource:t,flair:{kind:b.SidebarKeep}})})},handleGizmoSidebarHide(e,r){e.setQueryData(E().queryKey,t=>t!=null&&t.gizmos.some(n=>n.resource.gizmo.id===r)?{gizmos:t.gizmos.filter(n=>n.resource.gizmo.id!==r)}:t)}};function zr(e,r=!1){const t=G();return c(_(t,e,r))}function _r({gizmoId:e,draft:r,version:t}){const n=G(),s=t?{queryKey:["gizmo","version",{gizmoId:e,version:t}],queryFn:async()=>i.getVersion({gizmoId:e,version:t}),enabled:e!=null}:_(n,e,r);return c(s)}function Gr(e,r){return c({queryKey:["gizmo","userActionSettings",{gizmoId:e}],queryFn:async()=>i.getUserActionSettings(e),enabled:e!=null&&r})}function _(e,r,t=!1){return T({queryKey:["gizmo",{gizmoId:r},{draft:t}],queryFn:async()=>i.getGizmo(r,t),enabled:r!=null,initialData:()=>{var o,u;if(t===!0)return;const n=e.getQueryData(E().queryKey);if(n!=null)return(o=n.gizmos.find(a=>a.resource.gizmo.id===r))==null?void 0:o.resource;const s=e.getQueryData(["gizmos","discovery"]);if(s!=null)for(const a of s.cuts){const y=(u=a.list.items.find(l=>l.resource.gizmo.id===r))==null?void 0:u.resource;if(y!=null)return y}}})}function Pr(e,r){return e.fetchQuery(_(e,r))}function Mr(e){return c({queryKey:["gizmo",{search:e}],queryFn:async()=>i.getGizmoSearch(e),enabled:e.length>0})}function Sr(e,r){return c({queryKey:["gizmo-search-workspace",{search:e}],queryFn:async()=>i.getGizmoSearchForWorkspace(e),enabled:e.length>0&&r})}function vr(e,r=!1,t=!1,n=null){return Y({queryKey:[t?"gizmo-search-workspace":"gizmo",{query:e,cursor:n}],queryFn:async({pageParam:s})=>t?i.getGizmoSearchForWorkspace(e,n=s):i.getGizmoSearch(e,n=s),initialPageParam:n,getNextPageParam:s=>s.cursor??void 0,enabled:r})}function Cr(){const e=G();return M({mutationFn:async({gizmoId:r,editorData:t})=>{const{instructions:n,name:s,description:o,profilePictureId:u,profilePictureUrl:a,promptStarters:y,tools:l,files:m,trainingDisabled:F}=t;return i.upsertDraft({instructions:n,display:{name:s,description:o,profile_pic_id:u,profile_picture_url:a,prompt_starters:y},tools:l,files:m.map(w=>({...w,location:Ce.FILE_SERVICE})),training_disabled:F},r)},onSettled:r=>{r&&(e.setQueryData(_(e,r.gizmo.id,!0).queryKey,r),e.invalidateQueries({queryKey:["gizmos","mine"],refetchType:"none"}))}})}function br(){const e=G();return M({mutationFn:async({gizmoId:r,data:t})=>{const{sharingRecipient:n,categories:s}=t,o=await i.promoteDraft({sharing:t.sharingSubjects&&t.sharingSubjects.length>0?t.sharingSubjects:{recipient:n},categories:s},r);if(o.error)throw new be(o);return o.resource},onSettled:r=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"}),e.invalidateQueries({queryKey:["gizmos","pinned"],refetchType:"none"}),r&&e.setQueryData(_(e,r.gizmo.id,!1).queryKey,r)}})}function qr(){const e=G();return M({mutationFn:async({gizmoId:r})=>i.deleteGizmo(r),onSettled:()=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"})}})}function Er(){const e=G();return M({mutationFn:async({name:r,hideName:t,websiteUrl:n,willReceiveSupportEmails:s})=>i.updateBuilderProfile({name:r,hide_name:t,website_url:n,will_receive_support_emails:s}),onSuccess:r=>{e.setQueryData(["builderProfile"],r)},onError:r=>{K.warning(r.message)}})}function Fr(){return c({queryKey:["builderProfile"],queryFn:async()=>i.getBuilderProfile()})}function wr(){return M({mutationFn:async({gizmoId:e})=>i.copyGizmo({gizmoId:e})})}function Qr(){return c({queryKey:["gizmoCategories"],queryFn:async()=>i.getCategories()})}function Lr(e,r){return!!(r!=null&&[B.PrimaryAssistant,B.GizmoInteraction].includes(r)&&(e!=null&&e.includes(q.GPT_4)))}function Tr(e,r){const t=G();return M({mutationFn:async({rating:n,message:s,includeFrom:o})=>{await i.upsertUserReview(e,n,s,o)},onSuccess:async()=>{t.invalidateQueries({queryKey:["gizmo","review",{gizmoId:e}]})},onError:n=>{K.danger(n.message)}})}function Rr(e,r){return r?`/g/${I(r)}/c/${e}`:`/c/${e}`}function Ur(){return"/gpts"}function Dr(){return"/gpts/mine"}function te(e){return e?`/gpts/editor/${e}`:"/gpts/editor"}function Ar(e){const r=Ne();return e==null?r:te(e)}function Ne(e){return te(e)}function Kr(e){try{const r=new URL(e);return r.hostname=r.hostname.replace(/^(www\.|web\.|mbasic\.|mobile\.)(secure\.)?/,""),r.pathname="",[...r.searchParams.keys()].forEach(t=>r.searchParams.delete(t)),r.toString()}catch{return e}}function He(e){if(!e)return null;try{return new URL(e).hostname}catch{return null}}function Or(e){const r=He(e);return r?r.replace(/^www\./,""):e}export{tr as $,nr as A,Dr as B,Ur as C,Mr as D,Sr as E,vr as F,Ve as G,mr as H,Fr as I,Er as J,Qr as K,_r as L,S as M,je as N,Cr as O,br as P,_ as Q,re as R,er as S,sr as T,Pr as U,De as V,Lr as W,ur as X,Ye as Y,Ze as Z,Xe as _,Ae as a,We as a0,ir as a1,Re as b,or as c,zr as d,Je as e,Tr as f,Rr as g,qr as h,fr as i,yr as j,te as k,ke as l,Ne as m,Or as n,pr as o,ar as p,hr as q,dr as r,gr as s,cr as t,rr as u,lr as v,Kr as w,Gr as x,Ar as y,wr as z};
//# sourceMappingURL=jn0qrdhjlis4y3ks.js.map
