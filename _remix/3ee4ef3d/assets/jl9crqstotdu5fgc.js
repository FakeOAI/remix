const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jz8g9u9epw6xs8e6.js","assets/nqo5y2f0dorhrqsr.js","assets/ph3npw8ji7sj8uot.js","assets/root-il8atsax.css","assets/lhyhests3vwi7plx.js","assets/conversation-small-ile61fj8.css","assets/n2v9m6ywpq3mguz2.js","assets/jcb576cjbsl4xz7f.js","assets/jujg8edbx5xm3whm.js","assets/m49nfhshmqjugqqj.js","assets/eouuddjjjwgfogv6.js","assets/gl3h6njm8fppi5zi.js","assets/jo6fah6ux9h3vi1j.js","assets/f71pk7u4uvvf6e4w.js","assets/lg42vyezz54z7xzl.js","assets/j839xdjncm5lalf7.js","assets/ged7m112ez8egh5t.js","assets/i8vfikxmunqo2z1b.js","assets/hlct3eb3xk2p1ia6.js","assets/lyavr3lhycg41l3w.js","assets/c4bxzbp1808foto4.js","assets/ma7zq7og4qe95610.js","assets/gi7s3ts4iagluxq1.js","assets/jam95du8h1mhhg2u.js","assets/e4740arakvl7pb3y.js","assets/ij4p3qtt4loi6rlq.js","assets/b6wfqna4ze8tcuxz.js","assets/dduhe859habeo4yz.js","assets/ku3fasckzsaql595.js","assets/fz0adr8psvvmhrhk.js","assets/mqahdqry26xzroiy.js","assets/mav83crfduvkg85m.js","assets/o1rsmk1ehf12f1r8.js","assets/i1mv0afppjc5ls1i.js","assets/dnnrp3wbc7tso9y8.js","assets/l70wr62zmgek07u9.js","assets/l35pvk6j2ug7fgbc.js","assets/oe9cfjaq1efams39.js","assets/j975hgtxudafmd08.js","assets/do1pxkpitrnpxiq3.js","assets/hifxaxopvmjhgnfa.js","assets/mpwocw7n0yqrt1rs.js","assets/fzrn137102spawew.js","assets/e9lafxuzyeh4418f.js","assets/jduckhgljimdwo8y.js","assets/k07phahnb07ezy5k.js","assets/5q1oosqb59xuupbm.js","assets/lqgvblqpf19lbkho.js","assets/gkzarv243uxrgro3.js"])))=>i.map(i=>d[i]);
import{aw as pe,h5 as Yr,P as K,e as X,bC as ga,ar as Rs,as as ot,h6 as to,cM as pa,c as Kr,d as Xr,d5 as Te,bF as sn,F as Ie,dR as nn,b0 as Pe,ap as it,d7 as _t,r as J,o as Oe,br as Qr,at as P,dW as De,cb as Jr,ay as Yt,bp as Rt,aS as Ue,aT as ze,a8 as yn,be as Kt,el as Xt,a3 as an,bo as fa,fT as Zr,fR as ei,eI as ti,cA as si,j as Is,G as so,aV as no,al as lt,ec as ni,fP as wn,h7 as ai,ai as Qe,er as oi,m as ys,cJ as ri,cK as ii,b8 as li,bq as ci,bS as We,u as js,h8 as di,a7 as kt,h9 as ui,S as de,cg as mi,D as on,f_ as ao,aj as oo,dQ as ro,f3 as hi,X as gi,a5 as xa,ha as pi,hb as fi,dG as Qt,fF as xi,hc as io,aU as Ps,fE as Ds,bm as Ve,am as jn,gf as Cn,s as Mn,a2 as Xe,b9 as va,ao as Tt,K as Nt,n as Ct,a4 as lo,dX as vi,aX as Si,bc as bi,cB as co,bT as re,ci as yi,fJ as wi,hd as ji,Z as Tn,$ as Qs,e1 as Ci,he as Sa,d4 as Mi,a6 as Ti,eX as uo,Q as _i,hf as ki,e$ as Ni,bG as Ai,hg as ba,dO as rn,dZ as Ei,l as Ke,cR as Ri,dP as Cs,bw as us,M as mo,aq as Ii,bg as Pi,hh as Di,eE as Li,cG as Bi,hi as Fi,bf as Hi,dH as Oi,hj as ho,fN as _n,N as kn,fO as Ui,hk as zi,hl as Gi,cY as Wi,bb as Vi,hm as qi,f6 as He}from"./ph3npw8ji7sj8uot.js";import{j as e,r as i,M as O,ae as ne,af as Jt,c as xe,az as $i,f as go,e as Nn,a as po,Z as Yi,v as Ki,L as Ms,R as fo,aA as Xi,aB as Qi,aC as ya}from"./nqo5y2f0dorhrqsr.js";import{aJ as It,gR as Ji,l5 as Zi,l6 as el,l7 as tl,iP as xo,iS as vo,ep as sl,B as nl,fo as al,iO as ol,l8 as ye,l9 as At,la as rl,lb as il,lc as ll,ld as cl,le as dl,lf as ul,lg as ml,lh as hl,li as gl,lj as se,lk as So,ll as bo,d0 as pl,e$ as fl,lm as xl,ln as vl,lo as Sl,lp as bl,kM as yl,lq as yo,lr as wl,x as jl,kK as Cl,jP as wo,hB as Ml,cN as Et,ls as jo,lt as Co,cJ as Ls,bC as Vt,lu as Ts,lv as Fe,ho as Mo,lw as To,lx as Tl,ly as _l,lz as _s,lA as kl,lB as Nl,lC as Al,lD as El,er as Rl,lE as Il,lF as Pl,lG as Dl,lH as Ll,lI as An,fv as En,lJ as Rn,hg as In,hh as rt,hi as Pn,bM as Bl,lK as _o,kN as ln,lL as ko,lM as Fl,lN as ks,lO as Hl,bo as Dn,bp as No,du as Ol,d8 as Ul,dv as Ao,c2 as Eo,br as Ln,gW as Zt,lP as wa,lQ as zl,lR as Gl,bw as ja,bt as Wl,hF as Vl,iY as Ca,lS as ql,lT as $l,lU as Yl,lV as Bn,lW as Kl,lX as Xl,bA as Ro,ga as Fn,fK as Hn,lY as Ma,ir as Ql,bs as Jl,lZ as Zl,hI as ec,j2 as tc,hJ as sc,hG as nc,l_ as ac,bu as cn,l$ as oc,m0 as rc,m1 as ic,m2 as lc,cn as cc,b6 as dn,m3 as dc,cg as On,U as Ns,bP as Un,cQ as uc,cI as zn,m4 as mc,m5 as hc,m6 as gc,hj as pc,m7 as fc,m8 as xc,m9 as vc,ma as Sc,mb as bc,mc as yc,dl as wc,hA as jc,k6 as Cc,md as Mc,me as Tc,mf as _c,cv as Io,mg as kc,fx as Gn,mh as Nc,fw as Ac,mi as Ec,mj as Rc,mk as un,ml as Ic,mm as Pc,cL as mn,mn as Dc,mo as Lc,mp as Bc,mq as Po,hV as Wn,cO as qt,mr as Fc,ms as Hc,mt as Oc,r as Uc,mu as hn,i as Do,mv as Vn,mw as Ta,mx as zc,my as Gc,mz as Wc,mA as Vc,cH as qc,mB as $c,mC as Yc,cK as Bs,cA as ws,cc as Kc,hY as Xc,mD as Qc,aQ as _a,dA as Lo,di as Jc,eO as Zc,mE as ed,aW as qn,mF as $n,bq as Yn,hq as td,cu as sd,dB as nd,mG as ad,mH as od,aB as rd,mI as Ye,aU as id,mJ as ld,mK as gn,mL as cd,mM as ms,mN as Bo,mO as dd,gE as ud,mP as md,is as hs,mQ as hd,aS as gd,cZ as pd,mR as fd,fk as xd,o as vd,mS as Sd,mT as bd,fg as yd,mU as wd,mV as jd,c8 as Cd,mW as Md,mX as Fo,mY as Ho,mZ as Oo,m_ as Uo,m$ as Mt,eS as Kn,n0 as Td,j4 as _d,n1 as zo,n2 as kd,gd as As,n3 as pn,n4 as Nd,n5 as Ad,n6 as gs,bQ as ka,c0 as Go,c1 as Wo,gq as Vo,gs as qo,gO as Ed,n7 as Rd,gJ as Id,n8 as Pd,n9 as Dd,na as Ld,nb as Bd,nc as Fd,bn as Hd,dk as Od,gc as Ud,bR as zd,nd as Gd,gP as ps,gp as Wd,gr as Vd,gA as qd,ne as $d,nf as Yd,ng as Kd,nh as Xd,ni as Qd,nj as Jd,nk as Zd,nl as eu,nm as tu,nn as su,by as nu,jJ as au,jI as ou,no as ru,g$ as iu,np as lu,nq as cu,nr as $o,w as du,f$ as uu,h8 as mu,h9 as hu,ns as gu,nt as pu,nu as Yo,bB as fu,nv as Ko,nw as xu,nx as vu,ny as Su,c6 as bu,c7 as yu,c5 as wu,ca as ju,nz as Cu,cE as Es,fm as Mu,bS as Tu,bT as _u,il as ku,jN as Nu,nA as Au,hd as Eu,nB as Ru,nC as Iu,nD as Pu,nE as Du,nF as Lu,nG as Bu,aD as Fu,fh as Hu,bU as Ou}from"./lhyhests3vwi7plx.js";import{B as Uu}from"./m49nfhshmqjugqqj.js";import{C as fn,g as zu}from"./eouuddjjjwgfogv6.js";import{S as Xo,a as Gu,b as Wu,G as Vu,L as qu,c as $u}from"./gl3h6njm8fppi5zi.js";import{h as Yu,i as Xn,s as Ku,j as Xu,k as fs,l as Qu,m as Ju,t as Zu,n as Fs,C as Qo,u as Jo,o as em,p as Zo,c as er}from"./jo6fah6ux9h3vi1j.js";const Na=pe.div`m-8 flex flex-col items-center`;function Aa(t){return e.jsx(ne.div,{initial:{opacity:0,translateY:20},animate:{opacity:1,translateY:0,transition:{duration:.5,ease:"easeIn"}},...t})}function tm({clientThreadId:t}){const a=Yr(t)?.gizmoId,{data:n}=It(a);return a==null||n==null||!Ji(n)?null:e.jsx(sm,{gizmoId:a})}function sm({gizmoId:t}){const[s,a]=i.useState(!1),[n,o]=i.useState(!1),r=Zi(t),c=async u=>{a(!0),setTimeout(()=>{o(!0)},5e3),K.logEvent(X.submitInlineRating,{gizmo_id:t,rating:u}),await r.mutateAsync({rating:u})},l=async()=>{o(!0),K.logEvent(X.dismissInlineRating,{gizmo_id:t}),await r.mutateAsync({})};return i.useEffect(()=>{n||K.logEvent(X.showInlineRating,{gizmo_id:t})},[n,t]),n?null:s?e.jsx(Na,{children:e.jsxs(Aa,{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"rounded-lg border border-token-border-heavy p-4",children:e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(O,{id:"gizmo.inlineReview.reviewLeft",defaultMessage:"Feedback sent"}),e.jsx(ga,{onClick:()=>{o(!0)}})]})}),e.jsx("div",{className:"text-xs text-token-text-tertiary",children:e.jsx(O,{id:"gizmo.inlineReview.reviewLeftSubtext",defaultMessage:'To update your rating, click "Send Feedback" in the GPT Menu'})})]})}):e.jsx(Na,{children:e.jsxs(Aa,{className:"flex flex-col items-center gap-4 rounded-lg border border-token-border-heavy p-4",children:[e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx(O,{id:"gizmo.inlineReview.prompt",defaultMessage:"How would you rate this GPT so far?"}),e.jsx(ga,{onClick:l})]}),e.jsx(el,{rating:void 0,onRating:c})]})})}const nm=({clientThreadId:t})=>{const s=to(),a=Rs(t),n=ot(a);i.useEffect(()=>{n&&pa.dismissBanner()},[n]);const o=s?.is_dismissible?()=>pa.dismissBanner():void 0;return e.jsx(Jt,{children:s&&e.jsx(ne.div,{transition:{type:"tween",ease:"easeInOut",duration:.1},initial:{opacity:0,transform:"translateY(8px)"},animate:{opacity:1,transform:"translateY(0px)"},exit:{opacity:0,transform:"translateY(8px)"},children:e.jsx(tl,{clientThreadId:t,rateLimitInfo:s,onDismiss:o})})})};function am(t){const s=Rs(t),a=ot(s),n=to();return!a&&n!=null}const xn=window.sessionStorage,vn=Kr(Xr(()=>({memoryFullBannerDismissed:!!xn?.getItem(sn.MemoryFullBannerDismissed)}))),tr={dismissBanner(){vn.setState(t=>{t.memoryFullBannerDismissed=!0}),xn?.setItem(sn.MemoryFullBannerDismissed,"true")},clearDismissedBanner(){vn.setState(t=>{t.memoryFullBannerDismissed=!1}),xn?.removeItem(sn.MemoryFullBannerDismissed)}};function om(t){const s=Te(t),a=xo(),{data:n}=vo(s,!1,a),o=n!=null,r=o&&n.memoryFullPct>=100,[c,l]=i.useState(!1);i.useEffect(()=>{!r&&o&&(l(!0),tr.clearDismissedBanner())},[r,o]);const u=vn(m=>m.memoryFullBannerDismissed);return r&&c&&!u}function rm(){const t=xe(),{openSettings:s}=sl();return e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(nl,{title:t.formatMessage(xs.memoryFullTitle),content:t.formatMessage(xs.memoryFullTooltip,xs.memoryFullTooltip.values),primaryCtaText:t.formatMessage(xs.memoryManageButton),onPrimaryCtaClick:()=>s(al.Personalization),onDismiss:()=>tr.dismissBanner()})})}const xs=Ie({memoryFullTitle:{id:"yRGU2/",defaultMessage:"Memory is full."},memoryManageButton:{id:"a5A88o",defaultMessage:"Manage"},memoryFullTooltip:{id:"neUc+N",defaultMessage:"New memories won’t be created until you make space. <a>Learn more</a>",values:{a:t=>e.jsx("a",{href:ol,target:"_blank",rel:"noopener noreferrer",className:"underline",children:t})}}}),im=i.memo(function(s){return lm(s),cm(s),dm(),null});function lm(t){const{store:s}=ye(),a=s.useSetSharedProps();nn(()=>{a(t)},[t,a])}function cm(t){const{clientThreadId:s,canContinue:a}=t,{store:n}=ye(),o=i.useRef({top:n.useContentAreaApi(At.HeaderTop),bottom:n.useContentAreaApi(At.HeaderBottom)}).current,r=hm(t),c=rl(s),{shouldShowBannerSignup:l,shouldShowBannerTermsDisclaimer:u}=gm(s),m=am(s),d=il(t),h=ll(t),g=cl(t),S=om(s),x=dl(),f=ul(t);nn(()=>{f.eligible?o.top.set(se.AdvancedVoiceOnMobileAnnouncement):x?o.top.set(se.ParagenControls):u?o.top.set(se.BannerTermsDisclaimer):m?o.top.set(se.BannersRateLimit):d.eligible?o.top.set(se.BannerSidekickAnnouncement):h?o.top.set(se.SearchBrowserExtensionAnnouncement):g?o.top.set(se.SearchBrowserExtensionReactiveAnnouncement):r?o.top.set(se.ItemActions):a?o.top.set(se.PromptTextareaAction):l?o.top.set(se.BannerSignup):S?o.top.set(se.BannerMemoryFull):o.top.set(null)},[o,r,a,u,l,m,d,S,x,f]),nn(()=>{c&&o.bottom.set(So.DallePromptControls)},[o,c])}function dm(){const{store:t}=ye();i.useEffect(()=>()=>{t.reset()},[t])}function um(t){const s=bo(),a=it(t),n=J.getTree(t).getLastValidNode(a)?.message?.id;return s?.messageId===n?s.suggestions:[]}function mm(t){return um(t).length>0}function hm(t){const s=ml(t.clientThreadId),a=mm(t.clientThreadId);return t.isDisabled?!1:t.isNewThread||s||a}function gm(t){const{isUnauthenticated:s}=Pe(),a=it(t),{layer:n}=_t("3637408529"),o=n.get("should_show_no_auth_signup_banner",!0),r=hl(g=>g.bannerDisclaimerClientThreadId),c=gl(),l={shouldShowBannerTermsDisclaimer:!1,shouldShowBannerSignup:!1};if(!t)return l;const u=J.getTree(t),m=u.countMessagesByAuthor(Oe.User),d=u.getNodeByIdOrMessageId(a),h=d?.message?.author.role===Oe.Assistant&&Qr(d.message);return l.shouldShowBannerTermsDisclaimer=h&&s&&m===1&&!c&&(r==null||r===t),l.shouldShowBannerSignup=o&&h&&s&&m>0&&m%5===0,l}function pm({children:t,className:s,showBackground:a}){return e.jsxs("div",{className:"relative",children:[t,a&&e.jsx(ne.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:P("pointer-events-none absolute bottom-0 top-0 h-8 w-8 rounded-full",s)})]})}function fm({clientThreadId:t,uploadType:s,modelAcceptedMimeTypes:a,modelSupportedImageMimeTypes:n,attachmentsProductFeature:o,getInputProps:r,openFileDialog:c,onOauthRedirect:l,historyDisabled:u,isDisabled:m,highlightTooltip:d}){const h=pl(),{gdriveStatus:g,o365Status:S}=fl(),x=e.jsx(Sl,{className:u?"text-white":d?"text-brand-blue-800":void 0}),f=g!=="false"||S!=="false"||h;return e.jsx("div",{className:"relative",children:e.jsx(pm,{showBackground:d,className:"bg-brand-blue-800/20",children:f?e.jsx(xl,{clientThreadId:t,icon:x,modelAcceptedMimeTypes:a,modelSupportedImageMimeTypes:n,attachmentsProductFeature:o,onOauthRedirect:l,uploadType:s,openFileDialog:c,getInputProps:r,isDisabled:m,highlightTooltip:d}):e.jsx(vl,{clientThreadId:t,uploadType:s,openFileDialog:c,getInputProps:r,icon:x,isDisabled:m,highlightTooltip:d})})})}const xm=i.forwardRef(function({type:s,placeholder:a,replyRegions:n,state:o,renderFiles:r,leftSideActions:c,topRightAction:l,onSubmit:u,inputState:m,currentLeafId:d,composerController:h,clientThreadId:g,gizmoId:S,disableReason:x},f){const E=De(),j=bl();let M=null;const{isLoading:y}=j;y||(M=j.modelId),i.useEffect(()=>{y||yl()||h.focus()},[M,h,y]);const v=k=>{jm({target:k.target,rootId:"composer-background",additonalInteractiveIds:["reply-regions"]})||h.focus()};return e.jsxs("div",{id:"composer-background",ref:f,className:P("flex w-full cursor-text flex-col rounded-3xl px-2.5 py-1 transition-colors contain-inline-size",E&&"backdrop-blur-2xl no-transparency:backdrop-blur-none",E&&s!=="temporary"&&"bg-token-composer-surface",!E&&s!=="temporary"&&"bg-[#f4f4f4] dark:bg-token-main-surface-secondary",s==="temporary"&&"dark bg-black"),onClick:v,children:[e.jsx(Jt,{initial:!1,children:n.length>0&&e.jsx(ne.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0,transition:{duration:.06}},transition:{ease:"easeOut",duration:.1},id:"reply-regions",children:e.jsx(Sm,{replyRegions:n})})}),e.jsxs(e.Fragment,{children:[r,e.jsxs("div",{className:"flex min-h-[44px] items-start pl-2",children:[e.jsx("div",{className:"min-w-0 max-w-full flex-1",children:h instanceof yo?e.jsx(vm,{composerController:h,currentLeafId:d,placeholder:a,inputState:m}):e.jsx(Yu,{composerController:h,placeholder:a})}),e.jsx("div",{className:"w-[32px] pt-1",children:l})]}),e.jsxs("div",{className:"flex h-[44px] items-center justify-between",children:[e.jsx("div",{className:"flex gap-x-1",children:c}),e.jsx(wl,{inputState:m,state:o,onSubmit:u,composerController:h,clientThreadId:g,gizmoId:S,disableReason:x})]})]})]})});function vm({composerController:t,currentLeafId:s,placeholder:a,inputState:n}){const o=i.useContext(Jr);return e.jsxs(e.Fragment,{children:[e.jsx(jl,{id:Cl,autoFocus:!0,tabIndex:0,"data-id":s,dir:"auto",ref:r=>{if(!(t instanceof yo))throw new Error("Expected TextAreaComposerController");r!=null&&(t.textArea=r,t.logPageMount())},rows:1,placeholder:a,disabled:n!=="default",className:P("m-0 resize-none border-0 bg-transparent px-0 text-token-text-primary focus:ring-0 focus-visible:ring-0",n==="disabled"&&"text-center",["max-h-[25dvh]","max-h-52"])}),e.jsx("script",{nonce:o.cspScriptNonce,suppressHydrationWarning:!0,children:"requestAnimationFrame((function(){window.__oai_logTTI?window.__oai_logTTI():window.__oai_SSR_TTI=window.__oai_SSR_TTI??Date.now()}))"})]})}function Sm({replyRegions:t}){return e.jsx("div",{className:"flex cursor-auto flex-col divide-y divide-token-border-light overflow-hidden rounded-b-lg rounded-t-[20px] bg-token-main-surface-primary",children:t.map((s,a)=>{switch(s.type){case"text":return e.jsx(bm,{value:s.value,onRemoveRegion:s.onRemoveRegion},a);case"object":return e.jsx(ym,{value:s.value,onRemoveRegion:s.onRemoveRegion},a);case"mention":case"system_hint":return e.jsx(wm,{value:s.value,icon:s.icon,onRemoveRegion:s.onRemoveRegion},a)}})})}function bm({value:t,onRemoveRegion:s}){return e.jsxs(Jn,{className:"text-token-text-secondary",children:[e.jsx(Zn,{children:e.jsx(wo,{className:"icon-lg-heavy"})}),e.jsx(ea,{children:`“${t}”`}),e.jsx(Qn,{onClick:s})]})}function ym({value:t,onRemoveRegion:s}){return e.jsxs(Jn,{className:"text-blue-selection",children:[e.jsx(Zn,{children:e.jsx(wo,{className:"icon-lg-heavy"})}),e.jsx(ea,{className:"font-semibold",children:t}),e.jsx(Qn,{onClick:s})]})}function wm({value:t,icon:s,onRemoveRegion:a}){return e.jsxs(Jn,{children:[e.jsx(Zn,{className:"mt-0",children:s}),e.jsx(ea,{className:"font-semibold text-token-text-primary",children:t}),e.jsx(Qn,{onClick:a})]})}function Qn({onClick:t}){return e.jsx("button",{onClick:t,type:"button",className:"flex-shrink-0 text-token-text-secondary",children:e.jsx(Ml,{className:"icon-lg"})})}const Jn=pe.div`flex items-start py-2.5 gap-3 pl-3 pr-1.5 text-sm`,Zn=pe.span`flex-shrink-0 mt-0.5 w-7 h-6 flex justify-center items-center`,ea=pe.span`flex-1 line-clamp-3 py-0.5`;function jm({target:t,rootId:s,additonalInteractiveIds:a}){let n=t;for(;n&&n!=null;){if(n.tagName==="BUTTON"||n.tagName==="INPUT"||n.tagName==="TEXTAREA"||n.isContentEditable||a.includes(n.id))return!0;if(n.id===s)return!1;n=n.parentElement}return!1}const vs={initial:{opacity:0,y:20,scale:.9},animate:{opacity:1,y:0,scale:1},transition:{delay:.1},exit:{opacity:0,scale:.5,transition:{duration:.2}}},Cm=({suggestions:t,onSelectingSuggestedReply:s})=>e.jsx("div",{className:"absolute bottom-full flex w-full max-w-[100vw] grow gap-2 overflow-auto px-1 pb-1 contain-inline-size sm:mb-0 sm:justify-start sm:px-2 sm:pb-0 md:static md:mb-2 md:max-w-none md:justify-center md:overflow-visible",children:t.slice(0,2).map((a,n)=>e.jsx(ne.div,{initial:vs.initial,animate:vs.animate,transition:{delay:(n-1)*vs.transition.delay},exit:vs.exit,children:e.jsx(Rt,{as:"button",color:"secondary",size:"small",onClick:()=>{s(a,t,n)},className:"group whitespace-nowrap md:whitespace-normal",children:e.jsx(Tm,{suggestion:a})},n)},n))});function Mm({suggestions:t,onSelectingSuggestedReply:s,clientThreadId:a}){const n=t?.length>0;i.useEffect(()=>{n&&Et(t,a)},[n,a]);const{isUnauthenticated:o}=Pe();return n?t.every(jo)?e.jsxs(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex flex-col items-center",children:[o&&e.jsx(Yt,{className:"mb-6 h-12 w-12 sm:hidden"}),e.jsx(Xo,{starterPrompts:t,onSelectStarterPrompt:s})]}):t.every(Co)?e.jsx(Cm,{suggestions:t,onSelectingSuggestedReply:s}):null:null}function Tm({suggestion:t}){return Co(t)?e.jsx(e.Fragment,{children:t.text}):jo(t)?e.jsxs("div",{className:"flex flex-col overflow-hidden",children:[t.title&&e.jsx("div",{className:"truncate font-semibold",children:t.title}),e.jsx("div",{className:P("truncate font-normal",t.title?"opacity-50":""),children:t.body})]}):null}function _m(){const{store:t}=ye(),s=t.useSharedProps();return s?e.jsx(km,{...s}):null}function km({clientThreadId:t,suggestions:s}){const a=Ls();return s===void 0||s.length===0?null:e.jsx("div",{children:e.jsx(Nm,{children:e.jsx("div",{className:"grow",children:s!==void 0&&e.jsx(Mm,{suggestions:s,onSelectingSuggestedReply:a,clientThreadId:t})})})})}const Nm=pe.div`h-full flex ml-1 md:w-full md:m-auto gap-0 md:gap-2 justify-center`,sr=({className:t,children:s})=>e.jsx(ne.div,{className:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.1,delay:0}},transition:{type:"tween",duration:.3,delay:.2},children:s});function Am({currentLeafId:t,canContinue:s,onContinueGenerating:a}){const n=i.useCallback(()=>{const r=new Vt;a(t,r),Ts()},[a,t]);let o=null;return s&&(o=e.jsx(Rm,{onHandleContinueGenerating:n})),o&&e.jsx("div",{className:"flex h-full w-full items-center justify-end gap-0 py-4 md:gap-2",children:o})}function Em({className:t}){return e.jsx(Mo,{className:P("-rotate-180",t)})}const Rm=({onHandleContinueGenerating:t})=>e.jsx(sr,{children:e.jsx(Rt,{as:"button",color:"secondary",onClick:t,className:"whitespace-nowrap py-2",icon:Em,size:"small",children:e.jsx(O,{...Fe.continueGenerating})})}),Im=()=>{const{shouldShowSkipButton:t}=To();return t?e.jsx(sr,{className:"flex justify-center",children:e.jsx(Rt,{as:"button",color:"secondary",onClick:()=>Tl.skipParagen(),children:e.jsx(O,{...Pm.skip})})}):null},Pm=Ie({skip:{id:"dvcUbp",defaultMessage:"Skip"}}),nr=i.memo(function({className:s}){const{store:a}=ye(),n=a.useIsHeaderContentAreaPopulated();return e.jsx("div",{className:P(s??"absolute bottom-full left-0 right-0",_s.PromptTextareaHeader),children:e.jsx(_l,{shouldRender:n,contentArea:At.Header,children:e.jsxs("div",{className:"mb-2 flex flex-col gap-3.5 pt-2",children:[e.jsx(ar,{}),e.jsx(or,{})]})})})});function ar(){const{store:t}=ye(),s=t.useSharedProps(o=>o?.clientThreadId),a=t.useContentAreaId(At.HeaderTop);let n;switch(a){case se.AdvancedVoiceOnMobileAnnouncement:n=e.jsx(El,{clientThreadId:s});break;case se.ParagenControls:n=e.jsx(Im,{});break;case se.ItemActions:n=e.jsx(_m,{});break;case se.BannerSignup:n=e.jsx(Bm,{});break;case se.BannerTermsDisclaimer:n=e.jsx(Fm,{});break;case se.PromptTextareaAction:n=e.jsx(Hm,{});break;case se.BannersRateLimit:n=e.jsx(Om,{});break;case se.BannerSidekickAnnouncement:n=e.jsx(Al,{});break;case se.SearchBrowserExtensionAnnouncement:n=e.jsx(Nl,{});break;case se.SearchBrowserExtensionReactiveAnnouncement:n=e.jsx(kl,{});break;case se.BannerMemoryFull:n=e.jsx(rm,{});break;case se.Box:n=e.jsxs("div",{className:"flex h-20 w-full items-center justify-center gap-2 bg-red-500 p-2",children:["box",e.jsxs("div",{className:"flex h-full w-full items-center justify-center gap-2 bg-blue-500 p-2",children:["inner",e.jsx("div",{className:"flex h-full w-full items-center justify-center bg-yellow-400 text-center",children:"actual content"})]})]});break;default:n=null;break}return n}function or(){const{store:t}=ye(),s=t.useContentAreaId(At.HeaderBottom);let a;switch(s){case So.DallePromptControls:a=e.jsx(Lm,{});break;default:a=null;break}return a}const Dm=Ue(()=>ze(()=>import("./jz8g9u9epw6xs8e6.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.default));function Lm(){const{store:t}=ye(),s=t.useSharedProps(a=>a?.composerController);return s?e.jsx(Dm,{composerController:s}):null}function Bm(){const{store:t}=ye(),s=t.useSharedProps(o=>o?.clientThreadId),a=Rl(),n=Il();return s?a?e.jsx(Pl,{threadId:s,showSignUp:n}):e.jsx(Dl,{threadId:s,showLogin:n}):null}function Fm(){const{store:t}=ye(),s=t.useSharedProps(a=>a?.clientThreadId);return s?e.jsx(Ll,{threadId:s}):null}function Hm(){const{store:t}=ye(),s=t.useSharedProps();return s?e.jsx(Am,{...s}):null}function Om(){const{store:t}=ye(),s=t.useSharedProps(a=>a?.clientThreadId);return s?e.jsx(nm,{clientThreadId:s}):null}function Um({composerController:t,isDisabled:s,highlightTooltip:a,clientThreadId:n}){const{setThreadSearchMode:o}=An(),r=En(),c=$i(),[l,u]=i.useState(!1),m=xe(),d={clientThreadId:n};return e.jsx(Gm,{highlightTooltip:a,analyticsMetadata:d,isThreadUsingSearchMode:r,isDisabled:s,children:e.jsxs("button",{className:P("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold",l&&"transition-all duration-150",r||a?"!rounded-2xl bg-blue-250 text-blue-1000 hover:bg-[#BDDCF4] dark:bg-[#2A4A6D] dark:text-[#48AAFF] dark:hover:bg-[#1A416A]":s?"opacity-30":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-pressed":r,"aria-label":m.formatMessage({id:"Sl1VH/",defaultMessage:"Search the web"}),disabled:s,onTransitionEnd:()=>u(!1),onClick:h=>{h.stopPropagation(),h.preventDefault(),u(!0),K.logEventWithStatsig(X.composerSearchButtonClicked,"composer_search_button_clicked",d),o(!r,d,yn.CONVERSATION_COMPOSER_WEB_ICON),/^search\s?$/i.test(t.getCurrentText())&&t.setText(""),t.replaceSlashCommandTokensWithText(),t.focus()},children:[e.jsx(Rn,{}),e.jsx(Jt,{children:r&&e.jsx(ne.span,{initial:{x:-10,width:0,opacity:0},animate:{x:0,width:"fit-content",opacity:1},exit:{x:-10,width:0,opacity:0},transition:{ease:"easeOut",duration:c?0:.15},children:e.jsx("div",{className:"whitespace-nowrap pl-1 pr-2",children:e.jsx(O,{id:"TbHx8d",defaultMessage:"Search"})})})})]})})}function zm(){const t=In(rt.hasSeenComposerSearchButtonTooltip);return!t.isLoading&&t.eligible}function Gm({children:t,highlightTooltip:s,analyticsMetadata:a,isThreadUsingSearchMode:n,isDisabled:o}){const r=zm()&&!n,c=In(rt.hasSeenComposerSearchButtonTooltip);return r?e.jsx(Pn,{announcementKey:rt.hasSeenComposerSearchButtonTooltip,side:"right",show:!0,theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(O,{id:"Yjduqi",defaultMessage:"Search the web"}),onDismiss:c.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(O,{id:"W51Aei",defaultMessage:"Get fast answers with trusted sources. {learnMore}",values:{learnMore:e.jsx(Bl,{href:"https://openai.com/index/introducing-chatgpt-search",className:"underline",children:e.jsx(O,{id:"stA7F4",defaultMessage:"Learn more"})})}}),children:e.jsx("div",{children:t})}):e.jsx("div",{children:e.jsx(Kt,{sideOffset:0,label:o?e.jsx(O,{id:"GpDAWD",defaultMessage:"Search is unavailable"}):e.jsx(O,{id:"c+4o2s",defaultMessage:"Search the web"}),side:"right",open:s||(n?!1:void 0),onOpenChange:l=>{l&&K.logEventWithStatsig(X.composerSearchButtonHovered,"composer_search_button_hovered",a)},children:t})})}function Wm({composerController:t,clientThreadId:s}){const a=Xt(s),{setThreadSearchMode:n}=An(),r=_o().size>0,c=ln(s,an.Search),l=ko(s),[u,m]=i.useState([]),[d,h]=i.useState(void 0),[g,S]=i.useState(0);i.useEffect(()=>{m(d?l.filter(T=>T.name.toLocaleLowerCase().startsWith(d.text.toLocaleLowerCase())||T.systemHint.toLocaleLowerCase().startsWith(d.text.toLocaleLowerCase())):[])},[d]),i.useEffect(()=>{const T=C=>{h(A=>si(A,C)?A:C)};t.view.dispatch(Ku(t.view.state.tr,{onHintMatch:T}))},[t]);const x=r||!l.length||!u.length||!d;i.useEffect(()=>{x&&S(0)},[x]);const f=u.length,E=i.useCallback(T=>{S(C=>(T(C)%f+f)%f)},[f]),j=u[g],M=({hintToSave:T=j,expectPerfectMatch:C,appendSpace:A=!0})=>{if(!d||!j||C&&T.name.toLowerCase()!==d.text.toLowerCase())return;K.logEvent(X.systemHintSelected,{system_hint:T.systemHint,conversation_id:a??fa});const R=d.text+T.name.slice(d.text.length),p={clientThreadId:s};Qu(t.view,{id:T.systemHint,hint:R},d.range,A,c,L=>n(L,p,yn.CONVERSATION_COMPOSER_SLASH_SEARCH)),fs(t.view)},y=i.useRef(M);y.current=M;const v=i.useRef(E);v.current=E;const k=i.useRef(d);k.current=d;const D=t.view;return i.useEffect(()=>(x||Xu(D,T=>{T==="up"?v.current(C=>C-1):T==="down"?v.current(C=>C+1):T==="cancel"?(fs(D),Ju(D)):T==="submit"?(y.current({expectPerfectMatch:!1}),fs(D)):T==="checkMatch"&&y.current({expectPerfectMatch:!0,appendSpace:!1})}),()=>fs(D)),[x,D]),i.useEffect(()=>{x||K.logEvent(X.systemHintListOpened,{conversation_id:a??fa})},[x]),x?null:e.jsx(Zr,{className:"max-w-60",onMouseDown:T=>{T.preventDefault()},children:u.map((T,C)=>e.jsx("div",{onMouseOver:()=>S(C),onClick:()=>{M({hintToSave:T,expectPerfectMatch:!1}),t.focus()},children:e.jsx(ei,{autoFocus:!1,className:"group rounded-lg px-1 py-2 hover:bg-token-hint-text",$spoofHovered:C===g,children:e.jsx(Vm,{title:T.name,description:T.description,icon:e.jsx(Fl,{svgString:T.logo,className:"icon-lg text-token-text-secondary group-hover:text-white"}),checked:!1})})},T.systemHint))})}function Vm({title:t,description:s,icon:a,checked:n}){return e.jsxs("div",{className:"group inline-flex w-full items-center justify-start gap-1.5 pl-1.5 pr-3",children:[e.jsx("div",{className:"flex h-7 w-7 items-center justify-center gap-2.5",children:a}),e.jsxs("div",{className:"shrink grow basis-0",children:[e.jsx("p",{className:"text-sm font-normal leading-tight text-token-text-primary group-hover:text-white",children:t}),!!s&&e.jsx("p",{className:"text-[13px] font-normal leading-[18px] text-token-text-secondary group-hover:text-white",children:s})]}),n&&e.jsx(ti,{className:P("icon-md text-token-text-primary",{"group-hover:hidden":!n})})]})}function qm({composerController:t,clientThreadId:s}){return t instanceof Xn?e.jsx(Wm,{composerController:t,clientThreadId:s}):null}function $m({suggestions:t,composerController:s,onSelect:a,onChange:n}){const o=Ls(),r=i.useCallback((d,h,g)=>{a?.(d,h,g),o(d,h,g)},[a,o]),[c,l]=i.useState(-1),[u,m]=i.useState(!1);return i.useEffect(()=>{const d=h=>{if(h.key==="ArrowDown"){const g=c===t.length-1?0:c+1;l(g),n?.(g,!0,t[g])}else if(h.key==="ArrowUp"){h.preventDefault();const g=c<=0?t.length-1:c-1;l(g),n?.(g,!0,t[g])}else h.key==="Enter"&&!h.shiftKey&&t[c]&&r(t[c],t,c)};return s.subscribe("keydown",d)},[t,c,n,r,s]),i.useEffect(()=>s.subscribe("blur",()=>{l(-1),n?.(-1,!1)}),[s,n]),i.useEffect(()=>{if(!u){const d=()=>{m(!0),window.removeEventListener("mousemove",d)};return window.addEventListener("mousemove",d),()=>{window.removeEventListener("mousemove",d)}}},[u]),i.useEffect(()=>{l(-1),n?.(-1,!1),m(!1)},[t,n]),e.jsx(ne.ul,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hidden w-full flex-col p-2.5 group-focus-within:flex group-focus-within:max-lg:flex-col-reverse",children:t.map((d,h)=>e.jsxs(ne.li,{initial:{opacity:0,translateY:4},animate:{opacity:1,translateY:0},transition:{delay:h*.03},exit:{opacity:0,translateY:4},className:"w-full",children:[h>0&&e.jsx("div",{className:P("h-[1px] opacity-60 max-lg:hidden",c===h||c===h-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")}),e.jsxs("button",{className:P("flex w-full cursor-pointer items-center justify-start whitespace-pre-wrap rounded-lg px-2.5 py-3 text-start",c===h?"bg-token-main-surface-secondary":"bg-token-main-surface-primary"),onClick:g=>{g.preventDefault(),r(d,t,h)},onMouseDown:g=>{g.preventDefault()},onMouseEnter:()=>{u&&(l(h),n?.(h,!1,d))},onMouseLeave:()=>{l(-1),n?.(-1,!1,d)},children:[d.icon?e.jsx("span",{className:"mr-4 h-6 w-6 text-token-text-secondary",children:d.icon}):null,e.jsx("span",{className:"whitespace-pre-wrap",children:d.autocompletionChunks&&d.autocompletionChunks.length>0?e.jsx(e.Fragment,{children:d.autocompletionChunks.map((g,S)=>e.jsx("span",{className:P(g.isMatched?"text-token-text-tertiary":"text-token-text-primary"),children:g.text},S))}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:P(d.type===ks.Starter?"text-token-text-secondary":"text-token-text-tertiary"),children:d.title}),e.jsx("span",{className:"text-token-text-primary",children:d.body})]})})]}),h>0&&e.jsx("div",{className:P("h-[1px] opacity-60 lg:hidden",c===h||c===h-1?"mx-2 bg-token-main-surface-secondary":"bg-token-border-light")})]},d.id??h))})}function Ym(t,s){t=t.toLocaleLowerCase();const a=s;s=s.toLocaleLowerCase();const n=[];let o=0;for(let l=0;l<s.length&&(o<t.length&&t[o]===s[l]&&(n.push(l),o++),o!==t.length);l++);const r=[];let c=0;if(n.forEach(l=>{if(l>c){const u=a.slice(c,l);u&&r.push({text:u,isMatched:!1})}r.push({text:a[l],isMatched:!0}),c=l+1}),c<s.length){const l=a.slice(c);l&&r.push({text:l,isMatched:!1})}return Km(r)}function Km(t){if(t.length===0)return t;let s=[t[0]];for(let n=1;n<t.length;n++){const o=s[s.length-1],r=t[n];o.isMatched===r.isMatched?o.text+=r.text:s.push(r)}const a=s.filter(n=>n.isMatched).reduce((n,o)=>n+o.text.trim().length,0);return s.length<=4&&a>=2?s:[{text:s.map(n=>n.text).join(""),isMatched:!1}]}function Xm({composerController:t,isDisabled:s,clientThreadId:a}){const n=xe(),o=In(rt.hasSeenComposerSystemHintButtonTooltip),c=ko(a).length>0,u=_o().size>0,m=s===!0||!c||u;if(!(t instanceof Xn))return null;const d=t,h={clientThreadId:a};function g(){K.logEventWithStatsig(X.composerSystemHintButtonClicked,"composer_system_hint_button_clicked",h),o.markAsViewed(),d.focus(),Zu(d.view)}const S=e.jsx("button",{className:P("flex h-8 min-w-8 items-center justify-center rounded-lg p-1 text-xs font-semibold",m?"opacity-30":"hover:bg-black/10 focus-visible:outline-black dark:focus-visible:outline-white"),"aria-label":n.formatMessage({id:"oDAnGy",defaultMessage:"Use a tool"}),disabled:m,onPointerDown:g,onMouseDown:x=>{x.preventDefault()},onClick:x=>{x.preventDefault(),x.detail===0&&g()},children:e.jsx(Hl,{})});return!o.isLoading&&o.eligible?e.jsx(Pn,{announcementKey:rt.hasSeenComposerSystemHintButtonTooltip,show:!0,side:"bottom",theme:"bright",dismissOnOutsideClick:!0,badge:"new",title:e.jsx(O,{id:"tTydhk",defaultMessage:"All your tools, in one handy place"}),onDismiss:o.markAsViewed,sideOffset:0,className:"!max-w-2xs xs:!max-w-sm",description:e.jsx(O,{id:"S+BFNe",defaultMessage:"Create a canvas, generate a picture, and more."}),children:S}):e.jsx(Kt,{side:"right",sideOffset:0,label:s?e.jsx(O,{id:"uw9x80",defaultMessage:"Tools unavailable"}):e.jsx(O,{id:"mrYNGk",defaultMessage:"View tools"}),onOpenChange:x=>{x&&K.logEventWithStatsig(X.composerSystemHintButtonHovered,"composer_system_hint_button_hovered",h)},children:S})}const Qm=1,Jm=3e3;function Zm({files:t,className:s}){const a=zn(),n=No(),o=bc();return e.jsxs("div",{className:s,children:[o.map(r=>e.jsx(yc,{textdocId:r.tempTextdocId,userCreatedTextdoc:r},r.tempTextdocId)),t.map(r=>e.jsx(wc,{borderRadius:"2xl",useV2Style:!0,width:a?"normal":"wide",onRemoveFileClick:()=>cn.remove(n,r.tempId,"none"),file:r.file,fileId:r.fileId??void 0,contextConnectorInfo:r.contextConnectorInfo,loadingPercentage:r.status===jc.Uploading?r.progress:void 0},r.tempId))]})}function eh({onAbortCompletion:t,onCreateNewCompletion:s,onContinueGenerating:a,currentModelId:n,clientThreadId:o,isNewThread:r,isCompletionInProgress:c,className:l,disabled:u=!1,disabledReason:m,canPause:d=!1,canContinue:h=!1,suggestions:g,isInteractableSharedThread:S,composerContainerRef:x,autocompletions:f,requiresFileUpload:E,onComposerInput:j,onComposerChange:M,onAutocompleteSelect:y,headerClassName:v,hideHeader:k,setComposerBarElement:D,onTaggingDropdownOpen:T,onTaggingDropdownClose:C}){const A=i.useRef(null),R=Cc(A,D),p=Fs(),L=Dn(),w=Is(),{isUnauthenticated:F}=Pe(),z=xe(),_=so(),I=No(),b=it(o),B=Rs(o),[Y]=go(),te=Nn(),{gizmoEditorData:q,mode:ie,getGizmoId:le}=Ol(),Z=no(),me=Ul(),we=lt(),Le=Ao(),ce=Xt(o),fe=!!ni(),je=!!wn(),[ve,Ae]=i.useState({}),{setThreadSearchMode:Ee,clearSearchModeTrigger:Be,getSearchModeTrigger:Ce}=An(),U=En(),[H,V]=i.useState(!1),[G,Q]=i.useState(!1),ae=De(),he=i.useRef(!1),Se=Eo(),oe=n!==null?Se[n]:void 0,Re=ai(o);let $=Ln(o),Me=$&&"gizmo"in $?$.gizmo:void 0;const Ge=Zt(Me?.gizmo.id),[ee,ct]=i.useState(null);ee!==null&&($={gizmo:ee,gizmo_id:ee.gizmo.id,kind:Qe.GizmoInteraction},Me=ee);const dt=wa(oe,$);let ut=!1;zl($)&&Me?.gizmo.id===Gl&&(ut=!0);const Hs=oi(),Pt=!u&&!ut&&dt!==ja.None&&!F,qe=Wl(oe,$),mt=Vl(oe,$);let _e=Ca(N=>N.files);const[ht]=i.useState(()=>ql());ie==="magic"?_e=_e.filter(N=>N.gizmoId!=null):_e=_e.filter(N=>N.gizmoId==null);const es=$l(),gt=_e.length>0||es,Dt=Ca(Mc.hasUploadInProgress),Lt=p.useState(N=>{const ue=Yl(N);return typeof oe?.maxTokens=="number"&&ue>oe.maxTokens}),Bt=p.useState(N=>!N.isEmpty()),pt=!Lt&&!Dt&&(Bt||gt);Bn(_e.length>0||Dt||Bt);const Je=(dt===ja.Multimodal?Kl:Xl)-_e.length,Ft=Je<=0,$e=pt&&!u&&!c&&!je,[Ze,Os]=i.useState(!1),ft=Ro(),xt=n||ft.id,vt=ln(o,an.Search),St=!u&&!Me&&Z?.includes(ys.SearchTool)&&(Z?.includes(ys.BrowsingAvailable)||!w?.isEnterprisey()),Ht=St&&vt,Us=Se[xt]?.tags,{targetedContent:zs,setTargetedContent:et}=Fn(),ke=zs?.isFocusedViewContent&&!Le?void 0:zs,{rebaseSystemMessageContent:ts}=Hn();i.useEffect(()=>{if(!L?.id)return;const N=Ma.getAndReset(L?.id,ce);N&&p.setText(N.inputText)},[L?.id,ce,p]),i.useEffect(()=>{Ze!==$e&&(Os($e),$e&&ri(!0).then(N=>{Ql.startEnforcement(N),ii.startEnforcement(N)}))},[$e,Ze,$?.kind,Z]);const bt=Jl(oe,$),{handleFileAccepted:sa}=Zl(z,wa(oe,$),qe,"mouse",le,bt?.attachments),{getInputProps:Gs,open:Ws}=ec({disabled:u||!Pt||Ft,noClick:!0,onDropAccepted:sa,onDropRejected:N=>tc(N,z,_,dt),multiple:!0,maxSize:sc,maxFiles:Je,...nc(mt)}),ss=li(ht),ns=i.useCallback(()=>{p.eraseContent(),ss.clearMessages(),p.resize(Qm),J.clearOverrideModelId(o),ac();for(const N of _e)cn.remove(I,N.tempId,"none");oc.markAllAsSent()},[p,ss,_e,I,o]),yt=async(N,ue)=>{if(N?.preventDefault(),u||!pt&&!ue||!$||kt.isLoading(o)!==!1)return;const Ne=new Vt;V(!0);const be=p.getContentToSend(),st=Tc(be.content),Ys=`${b}-nextPrompt`,zt=new _c(Io.CompletionRequest,{expectedTimingLogs:[{name:"prompt_submitted",expectedInMs:3e3}]}),{content:qr,attachments:ca}=kc(I,st,oe,$),da=[],Ks=[];ts&&Ks.push(ui(ts));const Xs={...$};"gizmo"in Xs&&delete Xs.gizmo;let cs=p.getSystemHints();U&&(cs=[Gn.Search]);const ua=Ce(),$r=U?ua??yn.CONVERSATION_COMPOSER_WEB_ICON:void 0,ma=Nc(),ha=Ac();let Gt={promptId:Ys,content:qr,eventMetadata:{eventSource:N?"mouse":"keyboard"},completionMetadata:{suggestions:g,conversationMode:Xs,systemHints:cs,searchSource:$r},messageMetadata:{...ca.length>0&&{attachments:ca},...ee&&{gizmo_id:ee?.gizmo.id},...ve,...cs.length>0&&{system_hints:cs},...!!be.metadata&&{serialization_metadata:be.metadata},...ma.length>0&&{canvas:{user_created_textdocs:ma.map(ds=>({user_created_temp_textdoc_id:ds.tempTextdocId,type:ds.type,title:ds.title,content:ds.content}))}},...Object.keys(ha).length>0&&{__internal:{search_settings:ha}}},prependMessages:da.length>0?da:void 0,appendMessages:Ks.length>0?Ks:void 0,turnTracker:Ne,profiler:zt,requestedModelId:Re};Gt=Ec(Gt),ke?.createNewCompletionParams&&(Gt=await ke.createNewCompletionParams(Gt)),zt.logTiming("request_params_ready"),await s(Gt),ke?.onCreateCompletion?.({serverThreadId:ce,currentLeafId:b}),ke?.shouldPersistAcrossMessages!==!0&&et(void 0),Ns.hideThreadHeader(),ns(),V(!1),zt.logTiming("prompt_submitted"),g!==void 0&&(de.logEvent("chatgpt_prompt_ignore_suggestions"),K.logEvent(X.promptIgnoreSuggestions)),U&&ua&&Be()},Vs=i.useRef(yt);i.useEffect(()=>{Vs.current=yt});const qs=N=>{et(N.targetedReply),N.targetedReply&&(p.focus(),K.logEvent(X.targetedReplyButtonClicked,{conversationId:ce,sourceMessageId:N.messageId}))},as=i.useCallback(()=>{ke?.onCleared?.({serverThreadId:ce,currentLeafId:b}),et(void 0),p.focus()},[b,ce,ke,et,p]),os={Enter:{validator:N=>{const ue=N.isComposing||N.keyCode===229;return!(G&&he.current)&&(N.metaKey||(me||mi)&&!N.shiftKey&&!ue)},handler:N=>{if(!$e){Lt&&_.danger("The message you submitted was too long, please submit something shorter.",{hasCloseButton:!0});return}N.preventDefault(),yt()}},Escape:{validator:N=>!N.isComposing,handler:N=>{d&&c&&(t("",B),K.logEvent(X.pauseCompletion,{threadId:J.getServerThreadId(o),currentLeafId:J.getTree(o).getMessageId(b),eventSource:"keyboard"})),N.target.value===""&&as()}}},W=i.useRef(os);W.current=os;const ge=rc(Us,$?.kind),[tt,wt]=i.useState(!1),[Ot,na]=i.useState(!1),rs=ge&&tt&&!Ge,aa=p.isReady();i.useEffect(()=>p.subscribe("keydown",N=>{p.acceptLegacyKeydown()&&W.current[N.key]?.validator(N)&&W.current[N.key].handler(N);const Ne=p.getCurrentText();if(N.key==="@"){const be=p.getSelectionStart(),st=Ne.substring(0,be);(!st||/\s$/.test(st)||be===0)&&setTimeout(()=>wt(!0),10)}else tt&&wt(!1);if(N.key==="Escape"&&(ct(null),Q(!1)),Ht&&!U){let be;N.key==="Backspace"?be=Ne.substring(0,Ne.length-1):be=Ne+N.key,/^search\s?$/i.test(be)?na(!0):Ot&&na(!1)}U&&N.key==="Escape"&&Ee(!1,{clientThreadId:o})}),[p,aa,tt,Ot,Ht,U,Ee,o]),i.useEffect(()=>{const N=Object.fromEntries(Object.keys(W.current).map(ue=>[ue,be=>{const st=W.current[ue];if(!st||p.acceptLegacyKeydown())return!1;const{validator:Ys,handler:zt}=st;return Ys(be)?(zt(be),!0):!1}]));p.registerKeyHandlers(N)},[p,aa]),i.useEffect(()=>p.subscribe("paste",N=>{ic({filePickerStore:I,event:N,intl:z,toaster:_,clientThreadId:o,conversationMode:$,currentModelConfig:oe,getEditorGizmoId:le,modelSupportedImageMimeTypes:qe})}),[z,o,$,oe,le,qe,p,_,I]);const wr=N=>{fe||ct(N),p.trimLeadingText("@"),Ts(),wt(!1)},jr=lc(o,ht,qe,bt?.attachments),Cr=i.useCallback(N=>{N?.preventDefault(),t("",B),K.logEvent(X.pauseCompletion,{threadId:J.getServerThreadId(o),currentLeafId:J.getTree(o).getMessageId(b),eventSource:"mouse"}),Ts()},[t,o,B,b]),oa=i.useCallback(()=>{Ma.set(L?.id,ce,p.getCurrentText())},[ce,L?.id,p]);i.useEffect(()=>{q||!H&&!cc()&&p.focus()},[H,p]),i.useEffect(()=>{q||cn.reset(I)},[n,I,q]),i.useEffect(()=>{(!ge&&ee||fe)&&ct(null)},[ge,ee,fe]);const[Mr,Tr]=(()=>{switch(m){case"workspaceDisallowsGizmo":return[Fe.disallowedByWorkspacePlaceholder,!0];case"feedbackRequired":return[Fe.disabledFeedbackPlaceholder,!0];case"noModelsAvailable":return[Fe.noModelsAvailablePlaceholder,!0];case"requiresPluginsToBeInstalled":return[Fe.requiresPluginsToBeInstalled,!0];case"loadingPlugins":return[Fe.loading,!0];case"noTestGizmoId":return[Fe.noTestGizmoId,!0];default:return S?[Fe.placeholderWithName,!1]:ke?.placeholderTextOverride!=null?[ke.placeholderTextOverride,!1]:[Fe.placeholderWithName,!1]}})(),_r=Ge&&r?z.formatMessage(dn.newChatInProject):z.formatMessage(Mr,{name:q!=null?ie==="magic"?dc:q.name||"GPT":Me?.gizmo.display.name??"ChatGPT"});i.useEffect(()=>p.subscribe("input",()=>{On.getState().isThreadHeaderVisible&&Ns.hideThreadHeader(),Q(!0)}),[p]),i.useEffect(()=>{if(j)return p.subscribe("input",()=>{j?.()})},[p,j]),i.useEffect(()=>{if(M)return p.subscribe("change",()=>{M?.()})},[p,M]),i.useEffect(()=>p.subscribe("focus",()=>{Q(!0)}),[p]);const ra=$?.kind===Qe.PrimaryAssistant&&!U,kr=ci(ys.CanvasOptIn),{layer:Nr}=We("4211831761"),{value:Ar}=js("3131522605"),Er=Ar||Nr.get("enable",!1)||kr,Rr={clientThreadId:o,uploadType:dt,modelAcceptedMimeTypes:mt,modelSupportedImageMimeTypes:qe,attachmentsProductFeature:bt?.attachments,getInputProps:Gs,openFileDialog:Ws,historyDisabled:we,onOauthRedirect:oa,highlightTooltip:E&&!gt},is=[],Ir=!u&&!Ft&&(Pt||Hs!=null)&&!U;is.push(e.jsx(fm,{...Rr,isDisabled:!Ir},"file-upload-button")),Er&&is.push(e.jsx(Xm,{composerController:p,clientThreadId:o,isDisabled:!ra},"system-hint-button")),St&&is.push(e.jsx(Um,{composerController:p,highlightTooltip:Ot,clientThreadId:o,isDisabled:!Ht||gt},"search-button"));const Pr=gt&&e.jsxs(e.Fragment,{children:[ie==="magic"&&e.jsx("div",{className:"m-2 mb-0 rounded-lg bg-token-main-surface-secondary p-2 text-xs text-token-text-secondary",children:e.jsx(O,{...Fe.gizmoKnowledgeWarning})}),e.jsx(Zm,{files:_e,className:"flex flex-nowrap gap-2 overflow-x-auto p-1.5"})]}),Dr=Tr?"disabled":"default",Lr=c&&d,Br=di(),Fr=!$e||H||Br,Hr=Rc(Dt,Bt,Lt),ls=Lr?"streaming":Fr?"disabled":"idle",Ut=i.useRef(null),jt=i.useRef(null),Or=n&&n.startsWith("o1");i.useEffect(()=>{const N=()=>{Ut.current!=null&&on.addAction("composer_state_disabled",{threadId:J.getServerThreadId(o),disabledReason:Ut.current})};if(pt&&ls==="disabled"){let ue="unknown";u?ue=m??"component_disabled_unknown":c?ue="completion_in_progress":je?ue="thread_hard_blocked":H&&(ue="starting_new_completion_request"),Ut.current!==ue&&(jt.current&&clearTimeout(jt.current),jt.current=setTimeout(N,Jm)),Ut.current=ue}else Ut.current=null;return()=>{jt.current&&(clearTimeout(jt.current),jt.current=null)}},[o,pt,ls,u,m,c,je,H]);const $s=[];if(ke?.label&&$s.push({type:ke.type,value:ke.label,onRemoveRegion:as}),ee!==null){const N=!!ee.gizmo.tags?.includes(Un.FirstParty);$s.push({type:"mention",value:ee.gizmo.display.name,icon:e.jsx(uc,{isFirstParty:N,src:ee.gizmo.display.profile_picture_url,className:"icon-md"}),onRemoveRegion:()=>{ct(null),p.focus()}})}i.useEffect(()=>{(!f||f.length===0||!G)&&(he.current=!1)},[f,G]);const Ur=(N,ue,Ne)=>{he.current=N>=0,ue&&p.setText(Ne?`${Ne.title}${Ne.body}`:"")},ia=G&&f&&f.length>0&&!rs&&!p.hasMultipleLines()&&p.canShowAutocompletion();i.useEffect(()=>{rs?T?.():C?.()},[rs,T,C]);const la=ls==="streaming"?Cr:yt,zr=ln(o,an.Canvas),{value:Gr}=js("61299031"),Wr=zn(),Vr=zr&&Gr&&!es&&!Wr;return e.jsxs(mc.Provider,{value:ht,children:[e.jsx(hc,{onOauthRedirect:oa,children:e.jsx("form",{className:l,onSubmit:la,children:e.jsxs("div",{className:"relative flex h-full max-w-full flex-1 flex-col",children:[!k&&!ae&&e.jsx(nr,{className:v}),rs&&e.jsx("div",{className:P("absolute bottom-full my-3",r&&"lg:top-full",_s.TagGpt),children:e.jsx(gc,{onClick:N=>wr(N),onClose:()=>{wt(!1),p.focus()}})}),ra&&e.jsx("div",{className:P("absolute bottom-full my-3",r&&"lg:top-full",_s.TagGpt),children:e.jsx(qm,{composerController:p,clientThreadId:o})}),e.jsxs("div",{ref:x,className:"group relative flex w-full items-center",children:[r&&Y.has("from_template_row")&&e.jsx("button",{type:"button",onClick:()=>{te("/")},className:"mr-2 flex h-8 w-8 items-center justify-center text-token-text-tertiary hover:text-token-text-secondary",children:e.jsx(pc,{className:"icon-lg"})}),e.jsx(xm,{type:we?"temporary":"default",ref:R,replyRegions:$s,placeholder:_r,inputState:Dr,composerController:p,leftSideActions:is,topRightAction:Vr&&e.jsx(fc,{composerRef:A,composerController:p,clientThreadId:o}),state:ls,onSubmit:la,renderFiles:Pr,currentLeafId:b,clientThreadId:o,gizmoId:Me?.gizmo.id,disableReason:Hr,modelId:xt}),ia&&e.jsx("div",{className:"absolute left-0 z-10 box-border w-full bg-token-main-surface-primary pl-0 max-lg:bottom-full lg:top-full",children:e.jsx($m,{suggestions:f,composerController:p,onSelect:y,onChange:Ur})})]}),e.jsx(xc,{composerController:p,parsedDocumentHandler:jr})]})})}),e.jsx(im,{canUseInlineTagging:ge,isDisabled:u,clientThreadId:o,currentLeafId:b,currentRequestId:B,canContinue:h,composerController:p,setPromptInputMetadata:Ae,suggestions:g,isNewThread:r,onCreateNewCompletion:s,onContinueGenerating:a,onResetState:ns,conversationMode:$,isShowingAutocomplete:!!ia}),$!=null&&!Or&&vc.includes($.kind)&&e.jsx(Sc,{clientThreadId:o,onTargetedReply:qs})]})}function th(t){const s=t.message?.author.role===Oe.User,a=t.metadata?.err!=null&&t.metadata?.errCode!==va.ContentPolicy,n=t.metadata?.errCode===va.ModelIncompatibility;return t.metadata?.canRetry===!1||n?!1:s||a}function sh(t){return e.jsx(Qo,{clientThreadId:t.clientThreadId,children:e.jsx(nh,{...t})})}function nh({clientThreadId:t,isNewThread:s,currentModelId:a,showPromptStarters:n,noWrap:o,onRequestCompletion:r,composerContainerRef:c}){const l=Fs(),u=jn(),m=Cn(),d=Mn(g=>{const S=kt.getCurrentNode(t,g);return th(S)});if(Po(l),!m&&d)return e.jsx(ah,{clientThreadId:t});const h=e.jsx(e.Fragment,{children:e.jsx(rr,{composerContainerRef:c,clientThreadId:t,currentModelId:a,isNewThread:s,showPromptStarters:n,onRequestCompletion:r})});return o?h:e.jsxs(e.Fragment,{children:[e.jsx(tm,{clientThreadId:t}),e.jsx(Wn,{clientThreadId:t,isStaticSharedThread:u,withVerticalPadding:!1,withHorizontalPadding:!0,children:e.jsx(qt,{children:h})})]})}function ah({clientThreadId:t}){const s=Fc(t),a=Mn(r=>kt.getCurrentNode(t,r).metadata?.errCode===Hc),n=Oc(r=>r.isoDate),o=it(t);return a&&n!=null&&n!==""?null:e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 text-center text-xs",children:e.jsx(O,{...Ea.errorGeneratingResponse})}),e.jsx("div",{className:"flex items-center md:mb-4",children:e.jsx(Rt,{as:"button",color:"primary",onClick:()=>{const r=new Vt;de.logEvent("chatgpt_regenerate_due_to_error_button_clicked",void 0,Xe({clientThreadId:t})),s({id:o,eventMetadata:{eventSource:"mouse"},conversationMode:kt.getConversationMode(t),turnTracker:r})},className:"m-auto",icon:Mo,"data-testid":"regenerate-thread-error-button",children:e.jsx(O,{...Ea.regenerateResponse})})})]})}function rr({clientThreadId:t,currentModelId:s,isNewThread:a,onRequestCompletion:n,showPromptStarters:o,composerContainerRef:r,autocompletions:c,requiresFileUpload:l,onComposerInput:u,onComposerChange:m,onAutocompleteSelect:d,headerClassName:h,hideHeader:g,onTaggingDropdownClose:S,onTaggingDropdownOpen:x}){const f=it(t),E=Rs(t),j=un(),{isUnauthenticated:M}=Pe(),v=ao(t)===oo.STREAMING,k=ro({clientThreadId:t,conversationLeafId:f}),D=ot(E),T=hi({clientThreadId:t}),C=!M,A=gi(),{isOpen:R,onClose:p}=Ic({type:"just-hit-rate-limit"}),L=i.useCallback((H,V)=>{K.logEvent(X.continueCompletion),n({type:xa.Continue,promptId:H,eventMetadata:{eventSource:"mouse"},cancelActiveRequests:!1,completionMetadata:{conversationMode:kt.getConversationMode(t)},turnTracker:V})},[n,t]),w=po(),F=i.useCallback(async(H,V)=>Pc({clientThreadId:t,currentRequestId:V,isHistoryAndTrainingDisabled:A,queryClient:w}),[t,A,w]),z=i.useCallback(async({promptId:H,content:V,eventMetadata:G,completionMetadata:Q,messageMetadata:ae,prependMessages:he,appendMessages:Se,turnTracker:oe,profiler:Re,requestedModelId:$})=>{const Me=J.getThreadCurrentLeafId(t);J.updateTree(t,Ge=>{Ge.addNode(H,V,Me,Oe.User,void 0,ae)}),await n({type:xa.Next,promptId:H,eventMetadata:G,cancelActiveRequests:!0,completionMetadata:Q,prependMessages:he,appendMessages:Se,turnTracker:oe,profiler:Re,...$?{requestedModelId:$}:{}})},[t,n]),_=pi(t,f),I=fi(t,f),b=!k&&(D||v),B=i.useMemo(()=>b?!1:!_&&I,[_,I,b]),Y=b&&s!=="gpt-4-pbrowse",te=Qt(t),q=Te(t),ie=It(q).data,{promptStarters:le,isSuccess:Z}=mn(a&&!te,t,4),me=bo(),we=(()=>{if(me?.messageId===J.getTree(t).getLastValidNode(f)?.message?.id)return me?.suggestions;if(o&&!te&&Z&&!C)return le})(),Le=Dc(),ce=xi(),fe=(()=>{if(ie?.gizmo.tags?.includes(Un.WorkspaceDisabled)&&!ce)return"workspaceDisallowsGizmo";if(Le.size){if(j.displayingSideBySideFeedback&&j.unskippable)return"feedbackRequired"}else return"noModelsAvailable";const V=kt.getConversationMode(t);return V?.kind===Qe.GizmoTest&&V.gizmo_id==null?"noTestGizmoId":null})(),je=io(t),ve=Ps(t),Ae=js("15117983")?.value,Ee=Yi(),Be=Ds(),Ce=Ee.action==="moderate",{value:U}=Ve("1860647109");return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-center",children:Be&&Ce&&U?e.jsx(Lc,{}):null}),R?e.jsx(Bc,{onClose:p}):null,Ae&&ve&&ve.kind===Qe.PrimaryAssistant&&ve.plugin_ids&&ve.plugin_ids.length>0?e.jsx(oh,{}):e.jsx(eh,{composerContainerRef:r,clientThreadId:t,onCreateNewCompletion:z,onAbortCompletion:F,onContinueGenerating:L,currentModelId:s,isNewThread:a,isCompletionInProgress:T,className:"w-full",canContinue:B,suggestions:we??[],disabled:!!fe,disabledReason:fe??void 0,canPause:Y,isInteractableSharedThread:je,autocompletions:c,requiresFileUpload:l,onComposerInput:u,onComposerChange:m,onAutocompleteSelect:d,headerClassName:h,hideHeader:g,onTaggingDropdownClose:S,onTaggingDropdownOpen:x},t)]})}function oh(){return e.jsxs("div",{className:"mx-auto flex max-w-md flex-col items-center justify-center gap-2 rounded-xl border border-token-border-light bg-token-main-surface-primary p-6 shadow-lg",children:[e.jsx("span",{className:"text-token-text-primary",children:e.jsx(O,{id:"PluginsDecrepatedNotice.pluginsDeprecationTitle",defaultMessage:"Conversations with plugins are archived"})}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(O,{id:"PluginsDecrepatedNotice.pluginsDeprecationSubtitle",defaultMessage:"Explore GPT Store to find a replacement"})}),e.jsxs("a",{href:"https://chat.openai.com/gpts",className:"text-green-500 hover:cursor-pointer dark:text-green-400",children:[e.jsx(O,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLink",defaultMessage:"Explore GPTs"}),e.jsx("span",{className:"ml-2",children:e.jsx(O,{id:"PluginsDecrepatedNotice.pluginsDeprecationGptStoreLinkArrow",defaultMessage:"→"})})]})]})}const Ea=Ie({errorGeneratingResponse:{id:"PromptTextarea.errorGeneratingResponse",defaultMessage:"There was an error generating a response"},regenerateResponse:{id:"PromptTextarea.regenerateResponse",defaultMessage:"Regenerate"}}),ir=i.memo(function(){return e.jsxs("div",{className:`flex flex-col gap-2 ${_s.PromptTextareaHeader}`,children:[e.jsx(ar,{}),e.jsx(or,{})]})}),bg=Object.freeze(Object.defineProperty({__proto__:null,ChatScreenComposerAlerts:ir},Symbol.toStringTag,{value:"Module"})),Ra=Ue(()=>ze(()=>import("./jcb576cjbsl4xz7f.js"),__vite__mapDeps([7,1,4,2,3,5,8,9,10,11,12])).then(t=>t.SnorlaxSplashScreen)),Js=4;function rh(t){const{layer:s}=We("3533083032"),{layer:a}=_t("3533083032"),{value:n,isLoading:o}=Ve("3006519778");return o||!n?!1:t?s.get("enable_new_homepage_anon",!1):a.get("enable_new_homepage_anon",!1)}function ih(){const{layer:t}=_t("4031588851"),s=t.get("autocomplete_qualified_start_date","2099-09-13T00:00:00Z"),a=Dn();return!!a&&a.created*1e3>=new Date(s).getTime()}function lh(t){const{layer:s}=We("4031588851"),{layer:a}=_t("4031588851"),{value:n,isLoading:o}=Ve("633009675");return o||!n?!1:t?s.get("enable_new_autocomplete_homepage",!1):a.get("enable_new_autocomplete_homepage",!1)}const Zs=t=>`${t.title}${t.body}`.toLocaleLowerCase();function lr(t){const s=Te(t.clientThreadId),a=Zt(s);return e.jsx(Qo,{clientThreadId:t.clientThreadId,children:a&&s&&Ra?e.jsx(Ra,{clientThreadId:t.clientThreadId,gizmoId:s,currentModelId:t.currentModelId,onRequestCompletion:t.onRequestCompletion}):e.jsx(hh,{...t})})}function ch({children:t}){const{store:s}=ye(),[a,n]=i.useState(!1),o=Fs();i.useEffect(()=>o.subscribe("focus",()=>{n(!0)}),[o]),i.useEffect(()=>o.subscribe("blur",()=>{n(!1)}),[o]);const c=!!s.useSharedProps()?.isShowingAutocomplete;return t(c&&a)}function dh({isUnauthenticated:t,shouldShowLegacyStarterPrompts:s,legacyPromptStarters:a,isSendBlocked:n,clientThreadId:o}){return e.jsxs("div",{className:P(t?"justify-end lg:justify-center":"justify-center","flex h-full flex-shrink flex-col items-center overflow-y-hidden text-token-text-primary lg:hidden"),children:[e.jsx("div",{className:P(t&&"flex sm:items-center md:flex-1","flex-shrink-0"),children:e.jsx(Yt,{className:"mb-6 h-12 w-12"})}),s&&(a&&a.length>0?e.jsx(xh,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},promptStarters:a,isSendBlocked:n,clientThreadId:o,isSquare:t}):e.jsx(Gu,{}))]})}function uh({isSendBlocked:t,clientThreadId:s,headlineOption:a,enableNewMobileDesign:n,shouldShowStarterPrompts:o,promptChips:r,onSelectStarterPrompt:c,starterPromptExpanded:l,setStarterPromptExpanded:u}){const m=Vn();return e.jsx(ch,{children:d=>e.jsxs(ne.div,{initial:{opacity:0},animate:{opacity:d?0:1},exit:{opacity:0},transition:{duration:.1},className:P("justify-center",d?"pointer-events-none":"","mt-[var(--screen-optical-compact-offset-amount)] flex h-full flex-shrink flex-col items-center overflow-hidden text-token-text-primary",m?"@lg/thread:hidden":"lg:hidden"),children:[a==="CHATGPT_LOGO"?e.jsx(Yt,{className:"inline-block h-12 w-12"}):e.jsx(cr,{headlineOption:a}),e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:P(!n&&(m?"@lg/thread:hidden":"lg:hidden"),!l&&"h-[116px]"),children:o&&e.jsx(ur,{starterPrompts:r,onSelectStarterPrompt:c,disabled:t,clientThreadId:s,onExpand:()=>u(!0),mobileLayout:!0})})]})})}function mh(t,s,a){const n=Ve("1468311859").value,o=Ve("3664702598").value,{layer:r}=We("4031588851"),c=ih(),l=t||s,u=l&&n,m=l&&o&&c;let d="HARDCODED";if(l)if(a){const h=r.get("search_autocomplete_mode","");u&&h&&(d=h)}else m&&(d=r.get("autocomplete_mode","HARDCODED"));return d}function hh({clientThreadId:t,currentModelId:s,isModelLoaded:a,onRequestCompletion:n,v2HomepageDisclaimer:o}){const r=Fs(),c=Tt(t),l=Qt(t),u=wn(),[m,d]=i.useState([]),{trendingSuggestions:h,fetchTrendingSuggestions:g}=vh(Js),S=i.useRef(!1),{isUnauthenticated:x}=Pe(),f=Uc(),[E,j]=i.useState(!1),M=En(),y=De();Po(r);const v=Ve("589604007").value,{layer:k}=_t("4031588851"),{layer:D}=We("4031588851"),{layer:T}=_t("3533083032"),{layer:C}=We("3533083032"),{promptStarters:A,isSuccess:R}=mn(c&&!l&&a,t,8,v,!0,s??void 0),{promptStarters:p,isSuccess:L,isError:w}=mn(c&&!l&&a,t,4,void 0,void 0,s??void 0),F=f&&!!m.find(U=>!!U.requires_file_upload),z=i.useCallback(U=>{const H=r.getCurrentText();return H&&Zs(U).startsWith(H.toLocaleLowerCase())},[r]),_=i.useCallback(U=>{const H=r.getCurrentText(),V=U.title+U.body;return z(U)?{...U,title:H,body:V.slice(H.length)}:{...U,title:V,body:""}},[r,z]),I=i.useCallback((U=!1)=>{d(H=>!H.some(z)&&H.length>0?[]:U?H:H.map(_))},[z,_]),b=(U,H,V)=>{const G=U.title;d([]),r.focus(),r.setText(G),requestAnimationFrame(()=>{const Q=(A?.filter(ae=>ae.theme===U.theme)??[]).map(ae=>{const he=Ct(ae.oneliner),Se=he.startsWith(ae.title);return{...ae,title:Se?`${ae.title} `:"",body:Se?ae.body:he,autocompletionChunks:Ym(G,he),type:ks.Autocomplete}});d(Q),Q.length>0&&Et(Q,t),Wc(U,V,t)})};i.useEffect(()=>{const U=m.some(H=>H.theme===hn.Search);M&&r.getCurrentText()===""?h.length>0?d(h):g():U&&!M&&d(H=>H.filter(V=>V.theme!==hn.Search))},[m,M,h,g,r]);const B=A?.reduce((U,H)=>(H.theme&&!U[H.theme]&&(U[H.theme]=H),U),{}),Y=[];if(B)for(const U in B)Y.push(B[U]);const te=Y&&Y.length>0,q=!!(R&&te&&a),ie=!!((L||w)&&a),le=Js-m.filter(z).length,Z=x?C.get("enable_new_mobile",!1):D.get("enable_new_mobile",!1),me=mh(Z,f,M),we=x?T.get("headline_option","HELP_WITH"):k.get("headline_option","HELP_WITH"),Le=k.get("autocomplete_min_char",4),ce=k.get("autocomplete_fetch_interval",200),fe=i.useRef(null),je=i.useCallback(Do(async U=>{const H=r.getCurrentText();if(!H||H.length<Le||H.length>80||r.hasMultipleLines()){d([]);return}if(!S.current&&!(fe.current&&fe.current.length>Le&&H.startsWith(fe.current)))try{const V=await Nt.generateAutocompletions(H,U,M);if(V.completions.length===0){fe.current=H;return}const G=V.completions.map(Q=>({id:Ki(),type:ks.Autocomplete,title:Q.slice(0,H.length),body:Q.slice(H.length),oneliner:Q,prompt:Q,source:me})).filter(z).map(_);d(Q=>{const ae=Q.filter(z),he=G.filter(Se=>{const oe=Zs(Se);return!ae.some(Re=>{const $=Zs(Re);if(oe===$)return!0;const Me=/[\p{P}\p{S}]$/u,Ge=oe.replace(Me,""),ee=$.replace(Me,"");return Ge===$||oe===ee||Ge===ee})}).slice(0,Js-ae.length);return[...ae,...he]}),G.length>0&&Et(G,t)}catch{}},me==="BING"?150:ce),[r,me,_,ce]),ve=i.useCallback(()=>{I(),le>0&&je(le)},[je,I,le]);i.useEffect(()=>{S.current&&d([])},[S]);const Ae=i.useMemo(()=>me==="HARDCODED"?I:ve,[me,ve,I]),Ee=i.useCallback(()=>{r instanceof Xn&&I(!0),r.getCurrentText().indexOf(`
`)>0&&d([])},[r,I]),Be=i.useCallback((U,H,V)=>{H.forEach(G=>{G.id===U.id&&(G.userInput=r.getCurrentText())}),d([H[V]])},[r]),Ce=Vn();return e.jsx(e.Fragment,{children:e.jsx(Jt,{children:e.jsx("div",{className:P("h-full w-full",Ce?"@lg/thread:py-[18px]":"lg:py-[18px]"),children:e.jsx(Wn,{isStaticSharedThread:!1,withVerticalPadding:!1,withHorizontalPadding:!0,clientThreadId:t,fullHeight:!0,children:e.jsxs(Ta,{children:[e.jsx("div",{className:P("mb-7 hidden text-center",Ce?"@lg/thread:block":"lg:block"),children:we==="CHATGPT_LOGO"?e.jsx(Yt,{className:"inline-block h-12 w-12"}):e.jsx(cr,{headlineOption:we})}),!Z&&e.jsx(dh,{isUnauthenticated:x,shouldShowLegacyStarterPrompts:ie,legacyPromptStarters:p,isSendBlocked:u,clientThreadId:t}),Z&&e.jsx(uh,{headlineOption:we,enableNewMobileDesign:Z,shouldShowStarterPrompts:q,promptChips:Y,onSelectStarterPrompt:b,starterPromptExpanded:E,setStarterPromptExpanded:j,isSendBlocked:u,clientThreadId:t}),e.jsx("div",{className:P(Ce?"@lg/thread:absolute @lg/thread:bottom-8 @lg/thread:left-0 @lg/thread:w-full":"lg:absolute lg:bottom-8 lg:left-0 lg:w-full"),children:e.jsx(Ta,{children:y?e.jsx(ir,{}):e.jsx(nr,{className:"block"})})}),e.jsx("div",{className:"w-full",children:e.jsx(rr,{clientThreadId:t,isNewThread:c,currentModelId:s,onRequestCompletion:n,showPromptStarters:!1,autocompletions:m,requiresFileUpload:F,onComposerInput:Ae,onComposerChange:Ee,onAutocompleteSelect:Be,onTaggingDropdownClose:()=>{S.current=!1},onTaggingDropdownOpen:()=>{S.current=!0},hideHeader:!0})}),e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:P("hidden",Ce?"@lg/thread:block":"lg:block",o&&x&&E?"":"h-[70px]"),children:q&&e.jsx(ur,{starterPrompts:Y,onSelectStarterPrompt:b,disabled:u,clientThreadId:t,onExpand:()=>j(!0)})}),o&&e.jsx("div",{className:P("w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",Ce?"@lg/thread:absolute @lg/thread:bottom-0 @lg/thread:left-0":"lg:absolute lg:bottom-0 lg:left-0"),children:e.jsx("div",{className:"min-h-4",children:o})})]})})})})})}function cr({headlineOption:t}){const a=xe().formatMessage(Sh[t]||Wt.whatCanIHelpWith);return e.jsx("div",{className:"relative inline-flex justify-center text-center text-2xl font-semibold leading-9",children:e.jsx("h1",{children:a})})}function dr({label:t,onClick:s,disabled:a=!1,icon:n}){return e.jsxs("button",{className:"group relative flex h-[42px] items-center gap-1.5 rounded-full border border-token-border-light px-3 py-2 text-start text-[13px] shadow-xxs transition enabled:hover:bg-token-main-surface-secondary disabled:cursor-not-allowed xl:gap-2 xl:text-[14px]",disabled:a,onClick:s,children:[n,e.jsx("span",{className:"max-w-full select-none whitespace-nowrap text-gray-600 transition group-hover:text-token-text-primary dark:text-gray-500",children:t})]})}function gh({starterPrompt:t,starterPrompts:s,index:a,disabled:n,onSelectStarterPrompt:o}){const r=t.theme??t.title,c=Ls(),{mutate:l}=Vc(),u=t.category==="onboarding"?()=>{l({key:rt.hasUsedConversationalOnboardingStarterPrompt}),c(t,s,a)}:()=>o(t,s,a);return e.jsx(dr,{disabled:n,onClick:u,icon:e.jsx(qc,{starterPrompt:t,useV2Colors:!0}),label:r})}function Ia({clientThreadId:t,onClick:s}){i.useEffect(()=>{$c(t)},[t]);const a=xe();return e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},className:"inline-block",children:e.jsx(dr,{onClick:()=>{Yc(t),s()},label:a.formatMessage(Wt.moreStarterPrompts)})})}const ph=5,fh=3;function ur({starterPrompts:t,onSelectStarterPrompt:s,disabled:a,clientThreadId:n,onExpand:o,mobileLayout:r=!1}){const c=r?fh:ph,[l,u]=i.useState(c),[m,d]=i.useState(!1),h=i.useRef(null),g=t.length<=l;i.useEffect(()=>{Et(t.slice(0,c),n)},[n]),i.useEffect(()=>{if(!m&&!g&&h.current){const x=h.current,f=x.getBoundingClientRect(),E=f.width,j=Array.from(x.children);let M=0;for(let y=0;y<j.length&&j[y].getBoundingClientRect().right-f.left<=E;y++)M++;u(M),d(!0)}},[t,g,m]);const S=()=>{const x=t.slice(l,t.length).map(f=>({...f,isAdditional:!0}));x.length>0&&Et(x,n),u(t.length),o()};return e.jsxs("div",{className:P("mt-5 flex items-center justify-center gap-x-2 transition-opacity xl:gap-x-2.5",m&&t.length>0?"opacity-100":"opacity-[0.01]",r?"flex-wrap":"flex-nowrap"),children:[e.jsxs("ul",{className:P("relative flex items-stretch gap-x-2 gap-y-4 overflow-hidden py-2 sm:gap-y-2 xl:gap-x-2.5 xl:gap-y-2.5",g||r?"flex-wrap justify-center":"flex-nowrap justify-start"),ref:h,children:[t.slice(0,l).map((x,f)=>e.jsx(ne.li,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeOut"},children:e.jsx(gh,{starterPrompt:x,starterPrompts:t,index:f,disabled:a,onSelectStarterPrompt:s})},x.id??f)),r&&t.length>l&&e.jsx(Ia,{clientThreadId:n,onClick:S})]}),!r&&t.length>l&&e.jsx(Ia,{clientThreadId:n,onClick:S})]})}function xh({promptStarters:t,isSendBlocked:s,clientThreadId:a,isSquare:n,...o}){i.useEffect(()=>{Et(t,a)},[a]);const r=Ls(),c=Vn();return e.jsx(e.Fragment,{children:n?e.jsx(ne.div,{...o,className:"mb-2 w-full flex-shrink overflow-y-hidden",children:e.jsx(qt,{children:e.jsx(Xo,{starterPrompts:t,onSelectStarterPrompt:r,disabled:s})})}):e.jsx(ne.div,{...o,className:"flex-shrink overflow-y-hidden",children:e.jsx(Wu,{starterPrompts:t,onSelectStarterPrompt:r,disabled:s,cssMobileDisplayLimit:2,marginOverride:P("mt-6",c?"@lg/thread:mt-12":"lg:mt-12")})})})}const vh=t=>{const[s,a]=i.useState([]),n=i.useCallback(async()=>{const r=(await Nt.generateTrendingSuggestions(t)).suggestions.map((c,l)=>({type:ks.Starter,title:Pa(c),body:"",icon:e.jsx(zc,{}),prompt:Pa(c),id:`starter-${l}`,theme:hn.Search}));a(r)},[t]);return{trendingSuggestions:s,fetchTrendingSuggestions:n}};function Pa(t){return t.split(" ").map(Gc).join(" ")}const Wt=Ie({whatCanIHelpWith:{id:"SplashScreenV2.whatCanIHelpWith",defaultMessage:"What can I help with?"},whereShouldWeStart:{id:"SplashScreenV2.whereShouldWeStart",defaultMessage:"Where should we start?"},askChatgptAnything:{id:"SplashScreenV2.askChatgptAnything",defaultMessage:"Ask ChatGPT anything"},moreStarterPrompts:{id:"SplashScreenV2.moreStarterPrompts",defaultMessage:"More"}}),Sh={HELP_WITH:Wt.whatCanIHelpWith,WHERE_TO_START:Wt.whereShouldWeStart,ASK_CHATGPT:Wt.askChatgptAnything};function mr({clientThreadId:t,currentLeafId:s}){const{currentModelId:a}=Jo(),n=Ln(t),o=lo(t,s),r=Te(t),c=lt(),l=Bs(a),u=Tt(t)&&!o&&(ws(n)||n?.kind===Qe.GizmoTest),m=Zt(r);return{showEmptyState:u,canUseNewHomepage:u&&m||u&&!r&&!l&&!c}}const Da=pe.button`max-w-28 xs:max-w-40 sm:max-w-60 md:max-w-none group flex cursor-pointer items-center gap-1 rounded-lg py-1.5 ${({$shimmer:t})=>t?"loading-shimmer":""} ${({$isScreenArch:t})=>t?"text-md px-2":"px-3 text-lg"} hover:bg-token-main-surface-secondary radix-state-open:bg-token-main-surface-secondary font-semibold text-token-text-secondary overflow-hidden whitespace-nowrap`;function bh({conversation:t,gizmoResource:s,elementRef:a}){const n=wi(t.id)??t.title;return e.jsx(Ms,{to:Jc(t.id,s),children:e.jsx(re.Item,{icon:Zc,children:e.jsx("div",{ref:a,children:n})},t.id)})}function yh({gizmoId:t,clientThreadId:s,inMobileHeader:a}){const n=xe(),{data:o}=It(t),{items:r,hasNextPage:c,fetchNextPage:l,isLoading:u,isFetchingNextPage:m}=Kc(t),d=i.useRef(null),h=i.useCallback(A=>{u||A==null||(d.current?.disconnect(),d.current=new IntersectionObserver(R=>{R[0].isIntersecting&&c&&l()}),d.current.observe(A))},[u,c,l]);i.useEffect(()=>()=>{d.current?.disconnect()},[]);const{title:g,titleSource:S}=vi(s),x=De(),{conversationLeafId:f}=Jo(),{showEmptyState:E}=mr({clientThreadId:s,currentLeafId:f}),j=Qt(s),M=Xc(),y=n.formatMessage(dn.newChatTitle),{resolvedTitle:v,isTypingEffect:k}=Qc(s,g??null,!0);if(!o||E)return null;const D=v==null&&(Tt(s)||S===Si.NewChat),T=j?e.jsx(e.Fragment,{}):e.jsxs(Da,{$isScreenArch:x,$shimmer:D,children:[e.jsx("div",{className:"truncate",children:k?e.jsx(ed,{text:v??""}):v??y}),e.jsx(qn,{className:"icon-md text-token-text-tertiary"})]}),C=M&&o.gizmo.display.emoji?e.jsxs(e.Fragment,{children:[o.gizmo.display.emoji," ",o.gizmo.display.name]}):o.gizmo.display.name;return e.jsxs("div",{className:"flex items-center gap-1 overflow-hidden whitespace-nowrap px-2 py-1.5",children:[e.jsx(Da,{$isScreenArch:x,children:e.jsx(Ms,{className:"truncate",to:_a(o),children:C})}),e.jsxs(e.Fragment,{children:[e.jsx(bi,{className:"icon-md text-token-text-tertiary"}),e.jsxs(co,{contentAlign:a?"center":"start",size:"small",triggerButton:T,contentClassName:"max-h-[50dvh] overflow-y-scroll",children:[e.jsx(Ms,{to:_a(o),children:e.jsx(re.Item,{icon:Lo,children:e.jsx(O,{...dn.newChatProjectDropdownItem,values:{name:`"${o.gizmo.display.name}"`}})},"new-chat")}),r.filter(A=>A.id!==s).map((A,R)=>{const p=c&&R===r.length-4?h:void 0;return e.jsx(bh,{elementRef:p,conversation:A,gizmoResource:o},A.id)}),m&&e.jsx("div",{className:"m-4 mb-5 flex justify-center",children:e.jsx(yi,{})})]})]})]})}const wh=Ue(()=>ze(()=>import("./f71pk7u4uvvf6e4w.js"),__vite__mapDeps([13,2,1,3,4,5,14])).then(t=>t.ThreadHeaderGizmoDropdown)),La=pe.button`group flex cursor-pointer items-center gap-1 rounded-lg py-1.5 ${({$isScreenArch:t})=>t?"h-[44px] @lg/screen-composer:pl-3 [line-height:26px] [font-size:17px] pl-1 pr-3":"px-3 text-lg"} hover:bg-token-main-surface-secondary radix-state-open:bg-token-main-surface-secondary font-semibold text-token-text-secondary overflow-hidden whitespace-nowrap`;function jh({clientThreadId:t}){const s=xe(),a=lt(),n=Ci(t),o=Nn(),[,r]=go(),c=()=>{!n&&!a?o({pathname:"/",search:new URLSearchParams({[hs]:"true"}).toString()}):r(l=>(l.get(hs)==="true"?l.delete(hs):l.set(hs,"true"),l),{replace:n,state:hd()})};return e.jsx(re.Item,{size:"large",className:"!pr-3",onClick:c,icon:dd,children:e.jsxs("div",{className:"flex grow items-center justify-between gap-2",children:[e.jsx("div",{className:"flex flex-1 items-center gap-3",children:e.jsx(O,{...fr.temporaryChat})}),e.jsx(ud,{enabled:a,label:s.formatMessage({defaultMessage:"Temporary",id:"temporaryChatToggleLabel"}),testId:"temporary-chat-toggle"})]})})}function hr(t,s,a){let n=t;if(t===Sa.AUTO){const c=s.filter(({defaultModel:l})=>l!==Sa.AUTO);c.length===1&&(n=c[0].defaultModel)}const o=s.find(({defaultModel:c})=>c===n);if(o){const{categoryId:c,shortLabel:l}=o;return{selectedCategory:c,modelLabel:l}}const r=a.find(({modelIds:c})=>c.includes(n));if(r){const{group:c,shortLabel:l}=r;return{selectedCategory:c,modelLabel:l}}return{selectedCategory:null,modelLabel:null}}function Ch({modelLabel:t}){return e.jsx("span",{className:"overflow-x-clip text-ellipsis text-token-text-secondary",children:t})}function Mh({clientThreadId:t,inMobileHeader:s}){const{isLoading:a,categories:n,groups:o}=$n(),r=ji(),l=Yn(t).id,u=td(),{modelLabel:m}=hr(l,n,o),d=_h(t,u),h=xe(),{isUnauthenticated:g}=Pe(),S=gr(),x=(!g||!S)&&!r;i.useEffect(()=>{a||sd({namespace:Io.ChatPageLoad})?.logTiming("render_model_switcher")},[a]);const f=De(),E=e.jsxs("div",{className:P(f?"overflow-x-hidden text-ellipsis":"text-token-text-secondary"),children:[nd," ",x?e.jsx("span",{className:"text-token-text-secondary",children:m}):g&&m?e.jsx(Ch,{modelLabel:m}):null]});return d.length?a?null:e.jsx(co,{sideOffset:8,size:"large",triggerButton:e.jsxs(La,{$isScreenArch:f,"aria-label":m?h.formatMessage({id:"JrtGPQ",defaultMessage:"Model selector, current model is {modelLabel}"},{modelLabel:m}):"",children:[E,f?e.jsx(ad,{className:"icon-md text-token-text-tertiary"}):e.jsx(qn,{className:"icon-md text-token-text-tertiary"})]}),onOpenChange:j=>{K.logEvent(X.toggleModelSwitcher,{isOpen:j}),de.logEvent("toggle_model_switcher",null,{isOpen:String(j)})},contentAlign:s?"center":"start",testId:"model-switcher-dropdown",children:e.jsx(Nh,{sections:d})}):e.jsx(La,{className:"cursor-default",children:E})}function gr(){return Ve("462735957").value}function Th({category:t,modelSwitcherDenialsBySlug:s,currentGizmoId:a,currentModelId:n,omitIcon:o,testId:r}){const{defaultModel:c,label:l,categoryId:u,description:m,isBeta:d}=t;return e.jsx(gn,{value:c,currentModelId:n,modelSwitcherDenialsBySlug:s,renderName:h=>e.jsx(Sn,{categoryId:u,name:l,description:m,isDisabled:h,omitIcon:o,isBeta:d}),isSelected:!a&&n===c,testId:r},c)}function _h(t,s){const a=Yn(t),n=a.id,o=Te(t),{categories:r,groups:c}=$n(),{doesUserHaveAnyAccountsWithPlusFeatures:l}=Tn(),u=J.getServerThreadId(t),m=od({clientThreadId:t}),d=xe(),h=!u,{isUnauthenticated:g}=Pe(),S=rd(),{layer:x}=We("2723963139"),f=x.get("is_dynamic_model_enabled",!1),E=gr(),j=s.find(({categoryId:I})=>I===Ye.ALPHA),M=s.find(({categoryId:I})=>I===Ye.DATA_CAMPAIGNS),y=s.find(({categoryId:I})=>I===Ye.EXPERIMENTS),v=s.find(({categoryId:I})=>I===Ye.MAINLINE),k=!0,D=!!j?.options?.length,T=!!M?.options?.length,C=!!y?.options?.length,A=!!v?.options?.length,R=Nn(),p=i.useCallback(()=>{K.logEvent(X.openModalAccountPaymentfromModelPicker,{content:"gizmo-button"}),id(R,"Thread header dropdown")},[R]),L=()=>{de.logEvent("chatgpt_model_switcher_plus_upgrade_button_clicked"),K.logEvent(X.modelSwitcherPlusUpgradeButtonClicked),g?S({shouldOpenPaymentModalOnAuth:!0,callback:I=>{K.logSignUpButtonClicked({location:"Model switcher GPT-4 upsell",provider:I})}}):p()},w=[],F=e.jsxs("div",{className:"mb-1 flex items-center justify-between px-5 pt-2",children:[e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(O,{id:"ilkdMh",defaultMessage:"Model"})}),e.jsx("a",{href:f?"https://help.openai.com/en/articles/9155758-what-is-the-chatgpt-plus-model-selector":"https://help.openai.com/en/articles/7102672-how-can-i-access-gpt-4",target:"_blank",rel:"noreferrer",children:e.jsx(gd,{className:"icon-md h-5 w-5 pl-0.5 text-token-text-tertiary"})})]},"header");if(E&&g){const I={id:"modelSection",content:[]};I.content.push(e.jsx(ld,{},"noAuthUpsell")),w.push(I)}else if(l){const I={id:"modelSection",content:[]};r.length&&I.content.push(F);const b=new Map;r.forEach(B=>{const Y=e.jsx(Th,{category:B,currentGizmoId:o,currentModelId:n,modelSwitcherDenialsBySlug:m,omitIcon:k,testId:`model-switcher-${B.defaultModel}`},B.categoryId);B.subcategory?(b.has(B.subcategory)||b.set(B.subcategory,[]),b.get(B.subcategory)?.push(Y)):I.content.push(Y)}),b.forEach((B,Y)=>{const te=r.find(q=>q.subcategory===Y&&q.defaultModel===a.id);I.content.push(e.jsxs(re.Sub,{children:[e.jsx(re.SubMenuTrigger,{"data-testid":Y==="More models"?"more-models-submenu":void 0,children:e.jsxs("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:[Y,!!te&&e.jsx("div",{className:"truncate text-token-text-tertiary",children:te.label})]})}),e.jsx(re.Portal,{children:e.jsx(re.SubContent,{className:"min-w-72",children:B})})]},Y))}),w.push(I)}else{const I={id:"modelSection",content:[]};I.content.push(e.jsx(gn,{value:"",currentModelId:n,onClick:L,modelSwitcherDenialsBySlug:m,isUpgradeUpsell:!0,renderName:b=>e.jsx(Sn,{icon:md,isDisabled:b,name:d.formatMessage({id:"mzDzkX",defaultMessage:"ChatGPT Plus"}),description:d.formatMessage({id:"bqTHri",defaultMessage:"Our smartest model & more"}),omitIcon:!1}),isSelected:!1,showNewChatHint:!1},"plusUpgrade")),I.content.push(e.jsx(gn,{value:Qs.AUTO,currentModelId:n,modelSwitcherDenialsBySlug:m,renderName:b=>e.jsx(Sn,{icon:cd,name:d.formatMessage({id:"U9E7Rx",defaultMessage:"ChatGPT"}),description:d.formatMessage({id:"n96qML",defaultMessage:"Great for everyday tasks"}),isDisabled:b,omitIcon:!1}),isSelected:!o&&n===Qs.AUTO,showNewChatHint:!0},Qs.AUTO)),w.push(I)}const z={id:"otherOptionsSection",content:[]},{selectedCategory:_}=hr(n,r,c);return h&&(D&&z.content.push(e.jsx(ms,{isSelected:_===Ye.ALPHA,currentModel:a,option:j,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},j.value)),T&&z.content.push(e.jsx(ms,{isSelected:_===Ye.DATA_CAMPAIGNS,currentModel:a,option:M,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},M.value)),C&&z.content.push(e.jsx(ms,{currentModel:a,isSelected:_===Ye.EXPERIMENTS,option:y,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},y.value)),A&&z.content.push(e.jsx(ms,{isSelected:_===Ye.MAINLINE,currentModel:a,option:v,modelSwitcherDenialsBySlug:m,displayInFull_INTERNAL_USE_ONLY:!0},v.value))),z.content.length&&w.push(z),g||w.push({id:"temporaryChatSection",content:[e.jsx(jh,{clientThreadId:t},"tempChat")]}),w}function kh(){const t=xe();return e.jsx("div",{className:"border-token-text-quartenary items-center rounded-full border px-1 py-0.5 text-[8px] font-semibold uppercase leading-3 text-token-text-secondary dark:border-token-border-heavy dark:text-token-text-tertiary",children:t.formatMessage(fr.beta)})}function Sn({isDisabled:t,name:s,icon:a,categoryId:n,description:o,extra:r,omitIcon:c,isBeta:l=!1}){let u=s;return l&&(u=e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:s}),e.jsx(kh,{})]})),e.jsxs("div",{className:"flex items-center gap-3",children:[!c&&e.jsx("span",{className:"flex h-7 w-7 flex-shrink-0 items-center justify-center rounded-full bg-token-main-surface-secondary",children:a?e.jsx(a,{className:"h-4 w-4 text-token-text-primary"}):n&&e.jsx(Bo,{type:"filled",className:P("h-4 w-4",t&&"text-gray-300",!t&&"text-token-text-primary"),categoryId:n})}),e.jsxs("div",{children:[u,e.jsxs("div",{className:P(!t&&"text-token-text-secondary","text-xs"),children:[o,r]})]})]})}function Nh({sections:t}){return e.jsx(e.Fragment,{children:t.map((s,a)=>e.jsxs(fo.Fragment,{children:[a!==0?e.jsx(re.Separator,{}):null,s.content]},s.id))})}function pr({clientThreadId:t,inMobileHeader:s=!1}){const a=Te(t),n=Zt(a);return a==null?e.jsx(Mh,{clientThreadId:t,inMobileHeader:s}):n?e.jsx(yh,{gizmoId:a,clientThreadId:t,inMobileHeader:s}):e.jsx(wh,{clientThreadId:t,gizmoId:a,inMobileHeader:s})}const fr=Ie({beta:{id:"XZwFET",defaultMessage:"Beta"},gpt35ShortExplainer:{defaultMessage:"Great for everyday tasks",id:"ModelSwitcher.gpt35ShortExplainer"},modelTunerSmartSelectionTitle:{id:"czjW8I",defaultMessage:"Dynamic"},modelTunerSmartSelectionExplainer:{id:"gp/YH1",defaultMessage:"Optimized for speed and intelligence"},gpt4ShortExplainer:{defaultMessage:"With DALL·E, browsing and analysis",id:"ModelSwitcher.gpt4ShortExplainer"},gpt4ShortExplainerWithoutBrowse:{defaultMessage:"With DALL·E and analysis",id:"ModelSwitcher.gpt4ShortExplainerWithoutBrowse"},gpt4UpsellExplainer:{id:"ModelSwitcher.gpt4Upsell",defaultMessage:"Our smartest and most capable model. Includes DALL·E, browsing and more."},userUpgrade:{id:"ModelSwithcer.upgradeButton",defaultMessage:"Upgrade to Plus"},userUpgradeSignup:{id:"ModelSwitcher.signupUpgradeButton",defaultMessage:"Sign up for ChatGPT Plus"},temporaryChat:{id:"ModelSwitcher.temporaryChat",defaultMessage:"Temporary chat"},shareChat:{id:"ModelSwitcher.shareChat",defaultMessage:"Share chat"}}),Ah=Ue(()=>ze(()=>import("./j839xdjncm5lalf7.js"),__vite__mapDeps([15,1,2,3,16,17,4,5,18,19,20,21,22,23,24,12,25,26,27,28,11,14,29,30,31,32])).then(t=>t.GizmoUsingAsOwnerNotice)),xr=({clientThreadId:t})=>{const s=On(m=>m.activeStageSidebar),a=J.getServerThreadId(t),n=pd(ys.WorkspaceShareLinks),{isUnauthenticated:o}=Pe(),r=lt(),c=n&&a&&!o&&!r,l=De(),u=!s&&!(l&&!o);return e.jsx("div",{className:P(!l&&"gap-2",l&&"@lg/screen-composer:gap-2","flex items-center pr-1 leading-[0]"),children:e.jsx(em,{showShareButton:c,showProfileDropdown:u,clientThreadId:t})})};function Eh({clientThreadId:t,gizmoId:s}){const a=fd(),{data:n}=It(s),o=Is();return e.jsxs(e.Fragment,{children:[e.jsxs(xd,{className:"max-md:hidden",children:[e.jsxs("div",{className:"absolute start-1/2 ltr:-translate-x-1/2 rtl:translate-x-1/2",children:[n!=null&&o?.isWorkspaceAccount()&&n.gizmo.tags?.includes(Un.WorkspaceDisabled)&&e.jsx(Ah,{gizmo:n}),e.jsx(vd,{gizmoId:s,clientThreadId:t})]}),e.jsx(Sd,{children:e.jsxs("div",{className:"flex items-center gap-0 overflow-hidden",children:[e.jsx(Zo,{clientThreadId:t}),e.jsx(pr,{clientThreadId:t})]})}),e.jsx(xr,{clientThreadId:t})]}),a&&e.jsx(bd,{})]})}function vr({clientThreadId:t}){const s=Te(t),a=jn(),n=De();return a||n?null:e.jsx(Eh,{gizmoId:s,clientThreadId:t})}function Rh({clientThreadId:t,currentModelId:s,isModelLoaded:a,onRequestCompletion:n,enableV2Homepage:o,v2HomepageDisclaimer:r}){const c=lt();let l=e.jsx(qu,{}),u;return c?(u=e.jsx(Ih,{}),l=e.jsx(Yt,{className:"mb-6 h-12 w-12"})):t!=null?(u=o?e.jsx(lr,{clientThreadId:t,currentModelId:s,isModelLoaded:a,onRequestCompletion:n,v2HomepageDisclaimer:r}):e.jsx($u,{clientThreadId:t}),l=null):u=e.jsx(Ph,{}),e.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-token-text-primary",children:[l,u]})}function Ih({gizmo:t}){const s=wd(),a=t?jd(t.tools):!1,n=Is();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-5 text-2xl font-semibold","data-testid":"temporary-chat-label",children:[e.jsx(Cd,{id:"temporary-chat-checkbox",name:"temporary-chat-checkbox",checked:!0}),e.jsx(O,{...at.temporaryChat})]}),e.jsxs("div",{className:"max-w-sm text-center text-sm font-normal text-token-text-tertiary",children:[e.jsx(O,{...n?.isWorkspaceAccount()?s?at.temporaryChatBizMemoryAvailable:at.temporaryChatBizMemoryUnavailable:s?at.temporaryChatDescriptionMemoryAvailable:at.temporaryChatDescriptionMemoryUnavailable}),a&&e.jsx("div",{className:"mt-3",children:e.jsx(O,{...at.temporaryChatDescriptionGptActions,values:{link:o=>e.jsx("a",{href:"https://help.openai.com/en/articles/8914046-temporary-chat-faq",target:"_blank",className:"underline",rel:"noreferrer",children:o})}})})]})]})}function Ph(){return e.jsx("div",{className:"mb-5 text-2xl font-semibold",children:e.jsx(O,{...at.howCanIHelpYouToday})})}function Sr({clientThreadId:t,currentModelId:s,isModelLoaded:a,onRequestCompletion:n,enableV2Homepage:o,v2HomepageDisclaimer:r}){const c=Te(t),l=Mi(),u=wn(),{data:m}=It(c),d=yd(),h=Ti(()=>navigator.windowControlsOverlay);return(l!=null||c!=null)&&m==null?null:e.jsxs("div",{className:"relative h-full",children:[e.jsx("div",{className:h?.visible?P("absolute right-[calc(100dvw-env(titlebar-area-width,100dvw)-env(titlebar-area-x,0))]",d?"left-[env(titlebar-area-x,0)]":"left-0"):"absolute left-0 right-0",children:e.jsx(vr,{clientThreadId:t})}),m!=null?e.jsx(Vu,{gizmo:m,showStarterPrompts:!0,disableStarterPrompts:u}):e.jsx(Rh,{clientThreadId:t,currentModelId:s,isModelLoaded:a,onRequestCompletion:n,enableV2Homepage:o,v2HomepageDisclaimer:r})]})}const at=Ie({temporaryChat:{id:"GizmoLanding.temporaryChat",defaultMessage:"Temporary Chat"},temporaryChatBizMemoryAvailable:{id:"g1opBW",defaultMessage:"This chat won't appear in your history and won't use or create memories."},temporaryChatBizMemoryUnavailable:{id:"fQmbtG",defaultMessage:"This chat won't appear your conversation history."},temporaryChatDescriptionMemoryAvailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryAvailable",defaultMessage:"This chat won't appear in history, use or create memories, or be used to train our models. For safety purposes, we may keep a copy for up to 30 days."},temporaryChatDescriptionMemoryUnavailable:{id:"GizmoLanding.temporaryChatDescriptionMemoryUnavailable",defaultMessage:"This chat won't appear in history or be used to train our models. For safety purposes, we may keep a copy of this chat for up to 30 days."},temporaryChatDescriptionGptActions:{id:"GizmoLanding.temporaryChatDescriptionGptActions",defaultMessage:"Any data shared with a third party through GPT actions are subject to the third party's privacy policy. <link>Learn more</link>"},howCanIHelpYouToday:{id:"GizmoLanding.howCanIHelpYouToday",defaultMessage:"How can I help you today?"}});function Dh({className:t,clientThreadId:s,message:a,onModelSelect:n,onDropdownChange:o}){const r=xe(),[c,l]=i.useState(null),[u,m]=i.useState(!1),[d,h]=i.useState(!1),g=Md(),S=Fo(s),x=Te(s),f=Ho({clientThreadId:s,message:a}),E=a.message.metadata?.model_slug,{modelOptions:j,modelSlug:M,animateModelLabelOnRender:y,nuxProps:v,messageModelEnabledTools:k}=f,D=Oo(a.message),T=k.includes(Gn.Search),C=i.useMemo(()=>j.find(_=>_.value==E),[j,E]),{doesUserHaveAnyAccountsWithPlusFeatures:A}=Tn(),R=i.useRef(null),p=_=>{_||setTimeout(()=>{R.current&&R.current.blur()},10)};if(i.useEffect(()=>{p(u)},[u]),!g||x)return null;const L=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:r.formatMessage(Ba.search),icon:e.jsx(Rn,{className:"icon-sm"}),condition:T&&!D,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:r.formatMessage(Ba.nosearch),icon:e.jsx(Uo,{className:"icon-sm"}),condition:T&&D,eventName:"chatgpt_regenerate_without_search_button_clicked"}];let w,F;v.shouldRenderNux?(w=Bh,F={title:e.jsx(O,{id:"g/+2Hh",defaultMessage:"Optimized your response"}),description:e.jsx(O,{id:"H0Flqm",defaultMessage:"Used {usedModelName} for a faster response that saves your limited {largestModelName} messages",values:{usedModelName:v.usedModelName,largestModelName:v.largestModelName}}),markAsViewed:v.announcement.markAsViewed}):(w=Lh,F={label:S?e.jsx(O,{id:"LBYK9a",defaultMessage:"Change model"}):e.jsx(O,{id:"nygjPN",defaultMessage:"Used {modelName}",values:{modelName:v.usedModelName}})});const z=S&&j.some(_=>$t(_,A));return e.jsxs(re.Root,{onOpenChange:_=>{S&&(m(_),o(_),p(_)),_&&K.logEvent(X.conversationOpenMessageModelSelector,{has_get_plus_button:z})},children:[e.jsx(w,{...F,children:e.jsx(uo,{ref:R,className:P("cursor-pointer",t),onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:e.jsx(br,{modelSlug:M,animateModelLabelOnRender:y,isDropdownOpen:u,isRegenerateEnabled:S,isHovered:d})})}),S&&e.jsxs(re.Content,{className:"z-30 origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[j.map(_=>{const I=$t(_,A),{value:b,...B}=_;return e.jsx(Mt,{value:b,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",b,{requestedModelId:b,...Xe({clientThreadId:s})}),n({requestedModelId:b})},onMouseEnter:()=>l(b),onMouseLeave:()=>l(null),isHovered:c===b,messageModelSlug:a.message.metadata?.model_slug,shouldShowUpsell:I,...B},b)}),!!C&&e.jsxs(e.Fragment,{children:[e.jsx(re.Separator,{}),L.filter(_=>_.condition).map(_=>e.jsx(Mt,{onSelect:()=>{de.logEvent(_.eventName,C.value,{requestedModelId:C.value,...Xe({clientThreadId:s})}),n({requestedModelId:C.value,extraStreamParams:_.extraStreamParams})},includeRegenerate:!0,onMouseEnter:()=>l(_.key),onMouseLeave:()=>l(null),isHovered:c===_.key,messageModelSlug:E,includeCheck:!1,...C,label:_.label,subtitle:"",icon:_.icon},_.key))]})]})]})}function br({modelSlug:t,animateModelLabelOnRender:s,isDropdownOpen:a,isRegenerateEnabled:n,isHovered:o,isRegenLabel:r=!1,animateShortLabel:c,omitIcon:l}){const[u,m]=i.useState("initial"),{categories:d}=$n({isRegen:!!r});i.useEffect(()=>{if(s){const j=setTimeout(()=>m("show"),500),M=setTimeout(()=>m("initial"),2e3);return()=>{clearTimeout(j),clearTimeout(M)}}m("initial")},[s]);const h=d.find(({defaultModel:j})=>j===t),g=t===Td?{categoryId:"gpt_3.5",shorterLabel:"3.5"}:{},{categoryId:S,shorterLabel:x}=h??g,f={initial:{opacity:0,paddingLeft:0,width:"0"},show:{opacity:1,paddingLeft:2,width:"100%"},visible:{opacity:1,paddingLeft:2,width:"100%",transition:{delay:0,duration:0}}},E=a?"visible":o?"show":u;return e.jsxs(ne.div,{initial:"initial",animate:E,className:"flex items-center pb-0",children:[!l&&(r?e.jsx(Kn,{className:"icon-md"}):S&&e.jsx(Bo,{type:"outline",categoryId:S,className:"icon-md h-4 w-4"})),(n||c)&&e.jsx(ne.span,{className:"overflow-hidden text-clip whitespace-nowrap text-sm",variants:f,transition:{type:"tween",duration:.18},children:x}),n&&e.jsx(qn,{className:P("icon-sm",{"text-token-text-quaternary":!o&&!r},{"text-token-text-secondary":o&&!r})})]})}function Lh({children:t,label:s}){return e.jsx(Kt,{label:s,sideOffset:0,children:t})}function Bh({children:t,title:s,description:a,markAsViewed:n}){return e.jsx(Pn,{announcementKey:rt.ModelSwitcherAutoDowngrade,show:!0,side:"bottom",sideOffset:-4,title:s,description:a,badge:"beta",onDismiss:n,dismissOnOutsideClick:!0,children:t})}function $t(t,s){const{modelSwitcherDeny:a,subscriptionLevel:n}=t;return!!a&&a.reason===_i.RATE_LIMIT&&n===ki.PLUS&&!s}const Ba=Ie({search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),Fh=i.memo(Dh),Ss="rounded-lg radix-disabled:pointer-events-auto radix-disabled:cursor-not-allowed";function Hh({className:t,clientThreadId:s,message:a,onModelSelect:n,onDropdownChange:o,canRegenerateResponse:r}){const[l,u]=i.useState(null),[m,d]=i.useState(!1),[h,g]=i.useState(!1),S=Te(s),x=Ho({clientThreadId:s,message:a}),f=a.message.metadata?.model_slug,E=a.message.id,{modelOptions:j,modelSlug:M,animateModelLabelOnRender:y,messageModelEnabledTools:v}=x,k=Oo(a.message),D=v.includes(Gn.Search),T=i.useMemo(()=>j.find(w=>w.value===f),[j,f]),C=i.useRef(null),{doesUserHaveAnyAccountsWithPlusFeatures:A}=Tn(),R=w=>{w||setTimeout(()=>{C.current&&C.current.blur()},10)};if(i.useEffect(()=>{R(m)},[m]),Ni(s))return null;const L=r&&j.some(w=>$t(w,A));return S?null:e.jsxs(re.Root,{onOpenChange:w=>{r&&(d(w),o(w),R(w)),w&&K.logEvent(X.conversationOpenMessageModelSelector,{has_get_plus_button:L,is_new_regen_dropdown:!0})},children:[r?e.jsx(Uh,{label:e.jsx(O,{id:"wDs5sz",defaultMessage:"Switch model"}),children:e.jsx(uo,{ref:C,className:P("cursor-pointer",t),onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:e.jsx(br,{modelSlug:M,animateModelLabelOnRender:y,isDropdownOpen:m,isRegenerateEnabled:r,isHovered:h,isRegenLabel:!0,omitIcon:!1})})}):null,r&&e.jsx(re.Portal,{children:e.jsxs(re.Content,{className:"z-30 min-w-fit origin-top-right text-token-text-primary",side:"bottom",align:"start",children:[e.jsx(re.Item,{disabled:!0,className:"pb-0 pt-2",children:e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(O,{id:"bFLh5u",defaultMessage:"Switch model"})})}),e.jsx(Oh,{clientThreadId:s,messageId:E,onModelSelect:n,messageModelSlug:f,omitModelIcons:!0,modelOptions:j,setHoveredOption:u,hoveredOption:l,retryOption:T,lastResponseUsedSearch:k,modelSupportsSearch:D,doesUserHaveAnyAccountsWithPlusFeatures:A})]})})]})}function Oh({clientThreadId:t,messageId:s,modelOptions:a,messageModelSlug:n,onModelSelect:o,omitModelIcons:r,setHoveredOption:c,hoveredOption:l,retryOption:u,lastResponseUsedSearch:m,modelSupportsSearch:d,doesUserHaveAnyAccountsWithPlusFeatures:h}){const g=xe(),[S,x]=i.useMemo(()=>_d(a,y=>y.subcategory),[a]),f=i.useMemo(()=>{const y=new Map;return S.forEach(v=>{const k=v.subcategory;k&&(y.has(k)||y.set(k,[]),y.get(k)?.push(v))}),y},[S]),E=P("icon-sm",r&&"order-10 ml-auto text-token-text-tertiary icon-md"),j=r?"right":"left",M=[{key:"use-search",extraStreamParams:{forceUseSearch:!0},label:g.formatMessage(en.search),icon:e.jsx(Rn,{className:E}),condition:d&&!m,eventName:"chatgpt_regenerate_with_search_button_clicked"},{key:"use-no-search",extraStreamParams:{forceUseSearch:!1},label:g.formatMessage(en.nosearch),icon:e.jsx(Uo,{className:E}),condition:d&&m,eventName:"chatgpt_regenerate_without_search_button_clicked"}];return e.jsxs(e.Fragment,{children:[x.map(y=>{const{value:v,...k}=y;return e.jsx(Mt,{value:v,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",v,{requestedModelId:v,...Xe({clientThreadId:t,messageId:s})}),o({requestedModelId:v})},includeRegenerate:!1,onMouseEnter:()=>c(v),onMouseLeave:()=>c(null),isHovered:l===v,messageModelSlug:n,includeCheck:!1,shouldShowUpsell:$t(y,h),className:Ss,...k,icon:r?e.jsx("span",{className:E}):k.icon,justifyIcon:j,wrapIcon:!r},v)}),[...f.entries()].map(([y,v])=>e.jsxs(re.Sub,{children:[e.jsx(re.SubMenuTrigger,{children:e.jsx("div",{className:"flex grow justify-between gap-2 overflow-hidden",children:y})}),e.jsx(re.Portal,{children:e.jsx(re.SubContent,{className:"min-w-fit",children:v.map(k=>{const{value:D,...T}=k;return e.jsx(Mt,{value:D,onSelect:()=>{de.logEvent("chatgpt_regenerate_switch_model_button_clicked",D,{requestedModelId:D,...Xe({clientThreadId:t,messageId:s})}),o({requestedModelId:D})},includeRegenerate:!1,onMouseEnter:()=>c(D),onMouseLeave:()=>c(null),isHovered:l===D,messageModelSlug:n,includeCheck:!1,className:Ss,...T,icon:null,justifyIcon:j,wrapIcon:!r,shouldShowUpsell:$t(k,h)},y+"-"+D)})})})]},y)),!!u&&e.jsxs(e.Fragment,{children:[e.jsx(re.Separator,{}),e.jsx(Mt,{onSelect:()=>{de.logEvent("chatgpt_regenerate_try_again_button_clicked",u.value,{requestedModelId:u.value,...Xe({clientThreadId:t,messageId:s})}),o({requestedModelId:u.value})},includeRegenerate:!0,onMouseEnter:()=>c(u.value),onMouseLeave:()=>c(null),messageModelSlug:n,includeCheck:!1,className:Ss,...u,label:g.formatMessage(en.tryAgain),subtitle:u.label,icon:e.jsx(Kn,{className:E}),justifyIcon:j,wrapIcon:!r},u.value),M.filter(y=>y.condition).map(y=>e.jsx(Mt,{onSelect:()=>{de.logEvent(y.eventName,u.value,{requestedModelId:u.value,...Xe({clientThreadId:t,messageId:s})}),o({requestedModelId:u.value,extraStreamParams:y.extraStreamParams})},includeRegenerate:!1,onMouseEnter:()=>c(y.key),onMouseLeave:()=>c(null),isHovered:l===y.key,messageModelSlug:n,includeCheck:!1,className:Ss,...u,label:y.label,subtitle:"",icon:y.icon,justifyIcon:j,wrapIcon:!r},y.key))]})]})}function Uh({children:t,label:s}){return e.jsx(Kt,{label:s,sideOffset:0,children:t})}const en=Ie({tryAgain:{id:"VbsBGW",defaultMessage:"Try again"},search:{id:"eTV6j1",defaultMessage:"Search the web"},nosearch:{id:"IvLzUk",defaultMessage:"Without web search"}}),zh=i.memo(Hh),Fa=Ue(()=>ze(()=>import("./lhyhests3vwi7plx.js").then(t=>t.q3),__vite__mapDeps([4,2,1,3,5])).then(t=>t.MemoryActionResult));function Ha(t,s,a){J.updateTree(t,n=>{n.updateNodeMetadata(s,{inlineComparisonRating:a})})}function Oa(t){return{is_dark_mode:t,time_since_loaded:Math.floor(performance.now()/1e3),page_height:window?.innerHeight,page_width:window?.innerWidth,pixel_ratio:window?.devicePixelRatio,screen_height:window?.screen?.height,screen_width:window?.screen?.width}}const Ua=({messages:t})=>{for(const{message:{metadata:s}}of t){const{augmented_paragen_prompt_label:a}=s??{};if(a)return a}};function Gh(t){const s=i.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null}),a=i.useRef({left:null,right:null});return t.stubSideBySideFeedback?e.jsx(yr,{setPreferredFeedback:()=>{},leftVariantId:"left-placeholder",rightVariantId:"right-placeholder",leftTurn:null,rightTurn:null,originalTurn:null,hasActiveRequest:!0,visibilityStateRef:s,firstVisibleTokenTimestampsRef:a,...t}):e.jsx(Wh,{...t,visibilityStateRef:s,firstVisibleTokenTimestampsRef:a})}function Wh(t){const{clientThreadId:s,variantIds:a,variantsInStreamInfo:n,turnIndex:o,firstVisibleTokenTimestampsRef:r}=t;if(a.length!==2)throw new Error("ConversationTurnSideBySideFeedback requires exactly two variant IDs");const c=ta(),l=qh(),u=Cn(),m=Ai(),[d,h]=i.useMemo(()=>zo(a.join(""))()<.5?[0,1]:[1,0],[a[0],a[1]]),g=d<h?"left":"right",S=g==="left"?"right":"left",x=a[d],f=a[h],E=Ct(ba(s,x)).id,j=Ct(ba(s,f)).id,M=Ct(rn(s,o,E)),y=Ct(rn(s,o,j)),v=g==="left"?M:y,k=g==="left"?y:M,D=n.display_treatment==="unskippable",T=c?"skippable_parallel_2_in_stream:a:2.0":"skippable_parallel_2_in_stream:a:1.5";i.useEffect(()=>(un.setState({displayingSideBySideFeedback:!0,unskippable:D}),()=>{un.setState({displayingSideBySideFeedback:!1,unskippable:!1})}),[D]),kd();const C=i.useRef({left_visibility_initial:null,left_visibility_max:null,right_visibility_initial:null,right_visibility_max:null});i.useEffect(()=>Ei(Ri,{requestCompletion:()=>{const R=Ke(v.messages)?.completionSampleFinishTime,p=Ke(k.messages)?.completionSampleFinishTime,L=J.getServerThreadId(s);if(l){const F=J.getTree(s).getParentPromptNode(E),z=[M,y].map((b,B)=>({messageId:b.messages[b.messages.length-1].message.id,loadFirstTokenTime:B===0?r.current.left:r.current.right,loadEndTime:Ke(b.messages)?.completionSampleFinishTime})),_={},I=F.metadata?.variantsInStreamInfo==null&&F.message.metadata?.paragen_variants_info!=null;for(const b of z)_[b.messageId]=I?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:b.loadFirstTokenTime,load_end_time:b.loadEndTime};bs({shouldUseNewParagenEndpoint:l,params:{conversation_id:L,displayed_message_ids:z.map(b=>b.messageId),message_metadatas:_,rating:"skipped",selected_message_id:null,source_timestamp:Date.now(),ui_variant:c?2:1,user_prompt_message_id:F.message.id}})}else bs({shouldUseNewParagenEndpoint:l,params:{feedback_version:T,original_message_id:v.messages[v.messages.length-1]?.message.id,new_message_id:k.messages[k.messages.length-1]?.message.id,conversation_id:L,completion_comparison_rating:"skip",new_completion_placement:S,feedback_start_time:t.conversationTurnMountTime,compare_step_start_time:t.conversationTurnMountTime,original_completion_load_start_time:t.conversationTurnMountTime,original_completion_load_end_time:R??0,new_completion_load_start_time:t.conversationTurnMountTime,new_completion_load_end_time:p??0,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:Oa(m),...C.current}})}}),[M,y,E,s,t.conversationTurnMountTime,T,S,v?.messages,k?.messages,m,l,c,r]);const A=R=>{const L=J.getTree(s).getLeafFromNode(R);J.setThreadCurrentLeafId(s,L.id);const w=R===x,F=w===(g==="left"),z=Ke(v.messages)?.completionSampleFinishTime,_=Ke(k.messages)?.completionSampleFinishTime;v.messages.length>0&&Ha(s,v.messages[v.messages.length-1].nodeId,F?"original":"new"),k.messages.length>0&&Ha(s,k.messages[k.messages.length-1].nodeId,F?"original":"new");let I;z==null||_==null?I=F?"partial_load_comparison_original":"partial_load_comparison_new":I=F?"original":"new";const b=J.getServerThreadId(s);if(l){const B=[M,y].map((Z,me)=>({messageId:Z.messages[Z.messages.length-1].message.id,loadFirstTokenTime:me===0?r.current.left:r.current.right,loadEndTime:Ke(Z.messages)?.completionSampleFinishTime})),Y=w?B[0].messageId:B[1].messageId,q=J.getTree(s).getParentPromptNode(E),ie={},le=q.metadata?.variantsInStreamInfo==null&&q.message.metadata?.paragen_variants_info!=null;for(const Z of B)ie[Z.messageId]=le?{load_first_token_time:t.conversationTurnMountTime,load_end_time:t.conversationTurnMountTime}:{load_first_token_time:Z.loadFirstTokenTime,load_end_time:Z.loadEndTime};bs({shouldUseNewParagenEndpoint:l,params:{conversation_id:b,displayed_message_ids:B.map(Z=>Z.messageId),message_metadatas:ie,rating:"selected",selected_message_id:Y,source_timestamp:Date.now(),ui_variant:c?2:1,user_prompt_message_id:q.message.id}})}else bs({shouldUseNewParagenEndpoint:l,params:{feedback_version:T,original_message_id:v.messages[v.messages.length-1]?.message.id,new_message_id:k.messages[k.messages.length-1]?.message.id,conversation_id:b,completion_comparison_rating:I,new_completion_placement:S,feedback_start_time:t.conversationTurnMountTime,compare_step_start_time:t.conversationTurnMountTime,original_completion_load_start_time:t.conversationTurnMountTime,original_completion_load_end_time:z??null,new_completion_load_start_time:t.conversationTurnMountTime,new_completion_load_end_time:_??null,frontend_submission_time:Date.now(),timezone_offset_min:new Date().getTimezoneOffset(),client_contextual_info:Oa(m),...C.current}})};return e.jsx(yr,{...t,setPreferredFeedback:A,leftVariantId:x,rightVariantId:f,leftTurn:M,rightTurn:y,hasActiveRequest:u,originalTurn:v,visibilityStateRef:C})}function Vh(t){if(!t.length)return!1;const s=t.filter(a=>a.type===ka.Text||a.type===ka.MultiText).filter(a=>a.message.message.status!=="finished_successfully"&&a.message.message.metadata?.snorkle_status!==void 0);return s.length>0&&s.every(a=>{const n=a.message.message.content;return n?.content_type===mo.Text&&n.parts.join("")===""})}function yr({setPreferredFeedback:t,leftVariantId:s,rightVariantId:a,leftTurn:n,rightTurn:o,hasActiveRequest:r,originalTurn:c,visibilityStateRef:l,...u}){const{defaultParagenLabel:m,shouldShowParagenLabels:d=!1}=To(),h=n&&Ua(n)||m,g=o&&Ua(o)||m,S=i.useMemo(()=>n?.messages??[],[n?.messages]),x=i.useMemo(()=>o?.messages??[],[o?.messages]),{avatarClassName:f,firstVisibleTokenTimestampsRef:E}=u,j=i.useMemo(()=>As(S),[S]),M=i.useMemo(()=>As(x),[x]),y=xo(),[v,k]=i.useMemo(()=>[j,M].map(B=>Vh(B)),[j,M]),D=ot(n?Cs.getRequestIdFromConversationTurn(n):"")||v,T=ot(o?Cs.getRequestIdFromConversationTurn(o):"")||k,C=n?.role===Oe.User,A=o?.role===Oe.User,R=i.useRef(null),p=i.useRef(null),L=i.useRef(null),w=u.stubSideBySideFeedback||v,F=u.stubSideBySideFeedback||k;!w&&E.current.left==null&&(E.current.left=Date.now()),!F&&E.current.right==null&&(E.current.right=Date.now()),i.useEffect(()=>{if(R.current&&p.current&&L.current){const B=Array(11).fill(0).map((te,q)=>q/10),Y=new IntersectionObserver(te=>te.forEach(q=>{q.target===p.current?(l.current.left_visibility_initial==null&&(l.current.left_visibility_initial=q.intersectionRatio),l.current.left_visibility_max=Math.max(l.current.left_visibility_max??0,q.intersectionRatio)):q.target===L.current&&(l.current.right_visibility_initial==null&&(l.current.right_visibility_initial=q.intersectionRatio),l.current.right_visibility_max=Math.max(l.current.right_visibility_max??0,q.intersectionRatio))}),{root:R.current,threshold:B});return Y.observe(p.current),Y.observe(L.current),()=>Y.disconnect()}},[l]);const{data:z}=vo(void 0,!1,y),_=ta(),I=e.jsx("div",{className:"text-pretty px-6 pb-5 pt-1 text-center text-sm text-token-text-secondary",children:e.jsx(O,{id:"TK934w",defaultMessage:"Which response do you prefer? Responses may take a moment to load."})}),b=De();return e.jsxs("div",{className:"relative flex flex-col",children:[e.jsxs("div",{className:P("sticky z-[1] text-pretty bg-token-main-surface-primary px-6 text-center text-lg",b&&"top-[var(--thread-leading-height)] pt-3",!b&&"top-[-1px]",_&&!b?"md:top-header-height":b?"":"md:static"),"data-testid":"paragen-feedback-title",children:[e.jsx(O,{id:"JgCHDY",defaultMessage:"You’re giving feedback on a new version of ChatGPT."}),_?I:null]}),_?null:I,e.jsx("div",{className:"relative -mb-2 snap-x snap-mandatory overflow-x-auto px-3 pb-4 md:px-5 lg:px-10",ref:R,children:e.jsx("div",{className:P(!b&&"min-w-fit"),children:e.jsxs("div",{className:P("mx-auto flex max-w-6xl items-start",_&&!b&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",!_&&!b&&"gap-4 sm:gap-6",_&&b&&"divide-x divide-token-border-medium dark:divide-token-border-heavy",b&&!_&&"gap-4 sm:gap-6"),children:[e.jsxs(za,{horizontalScrollContainerRef:R,rootElementRef:p,onClick:()=>{t(s)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:w,children:[e.jsxs(Va,{children:[e.jsx(pn,{messages:S,isUserTurn:C,avatarClassName:f}),e.jsx(Wa,{children:d?e.jsx("span",{className:"font-bold text-token-text-primary",children:h}):e.jsx(O,{...$a.responseNumber,values:{responseIndex:1}})})]}),_&&w?e.jsx(Ga,{}):e.jsxs(e.Fragment,{children:[z!=null&&!C&&e.jsx(Fa,{clientThreadId:u.clientThreadId,messages:S,isParagen:!0}),e.jsx(fn,{...u,groupedMessagesToRender:j,allGroupedMessages:j,isEditing:!1,isUserTurn:C,isCompletionRequestInProgress:D,hasActiveRequest:r,handleEnterEdit:us,handleExitEdit:us,shouldGrowContainer:!1}),e.jsx(qa,{clientThreadId:u.clientThreadId,conversationTurnMountTime:u.conversationTurnMountTime,turn:n,originalTurn:c})]})]}),e.jsxs(za,{horizontalScrollContainerRef:R,rootElementRef:L,onClick:()=>{t(a)},hasActiveRequest:r,isWaitingOnFirstUserVisibleToken:F,children:[e.jsxs(Va,{children:[e.jsx(pn,{messages:x,isUserTurn:A,avatarClassName:f}),e.jsx(Wa,{children:d?e.jsx("span",{className:"font-bold text-token-text-primary",children:g}):e.jsx(O,{...$a.responseNumber,values:{responseIndex:2}})})]}),_&&F?e.jsx(Ga,{}):e.jsxs(e.Fragment,{children:[z!=null&&!A&&e.jsx(Fa,{clientThreadId:u.clientThreadId,messages:x,isParagen:!0}),e.jsx(fn,{...u,groupedMessagesToRender:M,allGroupedMessages:M,isEditing:!1,isUserTurn:A,isCompletionRequestInProgress:T,hasActiveRequest:r,handleEnterEdit:us,handleExitEdit:us,shouldGrowContainer:!1}),e.jsx(qa,{clientThreadId:u.clientThreadId,conversationTurnMountTime:u.conversationTurnMountTime,turn:o,originalTurn:c})]})]})]})})})]})}function za({horizontalScrollContainerRef:t,rootElementRef:s,onClick:a,children:n,hasActiveRequest:o,isWaitingOnFirstUserVisibleToken:r}){const c=ta(),l=De(),{scrollX:u}=Xi({layoutEffect:!1,container:t,target:s}),m=Nd(),d=Ad(),h=i.useRef(null),g=i.useRef(null),S=i.useRef(null),[x,f]=i.useState(!1),[E,j]=i.useState(!1),[M,y]=i.useState(!1),[v,k]=i.useState(0);i.useEffect(()=>{if(!c)return;const L=new IntersectionObserver(w=>{for(const F of w)F.target===h.current?f(F.isIntersecting):F.target===S.current?y(F.isIntersecting):F.target===g.current&&j(F.isIntersecting)},{root:m?.current,rootMargin:l?`0px 0px -${v}px 0px`:void 0});return h.current&&g.current&&S.current&&(L.observe(h.current),L.observe(g.current),L.observe(S.current)),()=>{L.disconnect()}},[v,c,l,m]);const D=!M&&(E||x),T=Qi(u,L=>D?-1*L:0),C=ya(0);i.useEffect(()=>{if(!c)return;const L=new ResizeObserver(w=>{gs(w.length===1,"entryList.length === 1");const F=w[0];gs(F.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),C.set(F.contentBoxSize[0].inlineSize)});return s.current&&L.observe(s.current),()=>{L.disconnect()}},[c,C,s]);const A=ya(0);i.useEffect(()=>{if(!c)return;const L=new ResizeObserver(w=>{gs(w.length===1,"entryList.length === 1");const F=w[0];gs(F.contentBoxSize.length===1,"item.contentBoxSize.length === 1"),A.set(F.contentBoxSize[0].blockSize+16),k(F.contentBoxSize[0].blockSize)});return d.current&&L.observe(d.current),()=>{L.disconnect()}},[c,A,d]);const R=e.jsx(Rt,{className:c?"px-5":"mt-4 self-start",onClick:a,"data-testid":"paragen-prefer-response-button",children:e.jsx(O,{id:"U2EAH6",defaultMessage:"I prefer this response"})}),p=r;return e.jsxs("div",{"data-paragen-root":!0,className:P("relative flex w-full min-w-[min(450px,80vw)] snap-center flex-col gap-1 text-left",l&&c&&"pl-3 pr-5 sm:w-[calc(100cqw-62px)] sm:pl-3 sm:pr-5 md:px-10",!l&&c&&"px-10",c?"min-h-60 py-4":"rounded-2xl border border-token-main-surface-tertiary bg-white p-5 dark:bg-gray-700"),ref:s,children:[e.jsx("div",{className:P("absolute left-0 right-0 top-48 h-px","invisible"),ref:h}),e.jsx("div",{className:P("absolute bottom-0 left-0 right-0 top-48","invisible"),ref:g}),e.jsx("div",{className:P("absolute bottom-0 left-0 right-0 h-px","invisible"),ref:S}),n,c?e.jsx("div",{className:"flex-1"}):null,c?e.jsx("div",{className:"mt-4 min-h-10",children:p?null:e.jsx(ne.div,{style:{translateX:T,width:C,bottom:A},animate:{opacity:100},initial:{opacity:0},transition:{ease:"easeOut",duration:.2,delay:.5},className:P({fixed:D,"z-20 flex w-full justify-center":!0}),children:R})}):o?null:R]})}function Ga(){return e.jsxs("div",{className:"flex w-full flex-col gap-4 pb-5 pt-3",children:[e.jsx(nt,{className:"h-4 w-[75%]"}),e.jsx(nt,{className:"h-4 w-[50%]"}),e.jsx(nt,{className:"h-4 w-[80%]"}),e.jsx(nt,{className:"h-4 w-[55%]"}),e.jsx(nt,{className:"h-4 w-[66%]"}),e.jsx(nt,{className:"h-4 w-[64%]"}),e.jsx(nt,{className:"h-4 w-[48%]"})]})}function ta(){const{layer:t}=We("3119715334");return t.get("should-enable-hojicha",!1)}const Wa=pe.div`text-sm text-token-text-secondary font-semibold`,Va=pe.div`flex gap-4 items-center mb-1`,nt=pe.div`animate-pulse rounded-[4px] bg-token-main-surface-tertiary`;function qa({clientThreadId:t,conversationTurnMountTime:s,turn:a,originalTurn:n}){const o=Hn();if(!o.showParagenMetadata||!o.showDebugConversationTurns&&!o.forceParagen||a==null)return null;let r=a===n?"ORIGINAL":"NEW";const c=a.messages[a.messages.length-1],l=c?.message?.metadata?.__internal;if(l){const{model_id:h,model_definition_slug:g,model_definition_virtual_model_id:S,alternative_model_selection_rule:x,augmented_paragen_prompt_group_id:f,augmented_paragen_prompt_id:E,augmented_paragen_prompt:j}=l;h&&(r+=`
Model ID: ${h}`),g&&(r+=`
Model Slug: ${g}`),S&&(r+=`
Virtual Model ID: ${S}`),x&&(r+=`
Alternative Model Rule: ${x}`),f&&(r+=`
Prompt Group ID: ${f}`),E&&(r+=`
Prompt ID: ${E}`),j&&(r+=`
Prompt: ${j}`)}r+=`
Message ID: ${c.message.id}`;const m=J.getTree(t).getParentPromptNode(a.variantIds[0]),d=m.metadata?.variantsInStreamInfo==null&&m.message.metadata?.paragen_variants_info!=null;return r+=`
User prompt message ID: ${m.message.id}`,r+=`
Is Persisted Paragen? ${d}`,r+=`
Completion Sample Finish Time: ${d?`${s} (persisted)`:Ke(a.messages)?.completionSampleFinishTime}`,e.jsx("div",{className:"whitespace-pre-wrap text-sm text-red-500",children:r})}async function bs({shouldUseNewParagenEndpoint:t,params:s}){t?await Nt.submitParagenSelectionV2(s):await Nt.submitMessageComparisonFeedback(s)}function qh(){const{value:t}=Ve("3894844102");return t}const $a=Ie({responseNumber:{id:"ConversationTurnTwoUpFeedback.responseNumber",defaultMessage:"Response {responseIndex, number}"}}),Ya=[1,2,3,4,10,20,30],$h=.5;function Yh({clientThreadId:t,conversationLeafId:s}){const a=Go(Wo.isBusinessWorkspace),n=i.useRef(!1),o=Xt(t),r=Ps(t),{isUnauthenticated:c}=Pe(),l=i.useMemo(()=>{if(!o)return-1;const A=zo(o);return A()>$h?-1:Ya[Math.floor(A()*Ya.length)]},[o]),u=Ii(t,s),m=u[u.length-1],d=i.useMemo(()=>Cs.getRequestIdFromConversationTurn(m),[m]),h=ot(d),[g,S]=i.useState(null),[x,f]=i.useState(!1),[E,j]=i.useState(!1),[M,y]=i.useState(!1),v=A=>{const R=Ke(u)?.messages[0]?.message.id;S(A),T(R,A)},k=u.filter(A=>A.role===Oe.Assistant).length,D=m?.role===Oe.Assistant,T=i.useMemo(()=>Do((A,R)=>{o&&A&&Nt.submitConversationRating({conversation_id:o,message_id:A,rating:R,shown_at_assistant_turn:l}),K.logEvent(X.conversationRatingSubmitted,{rating:R,showAtAssistantTurn:l,conversationId:o}),f(!0),setTimeout(()=>{j(!0)},1500)},2e3),[o,l]),C=k!==l||h||!D||!!a||r?.kind!==Qe.PrimaryAssistant||M||c;return i.useEffect(()=>{!C&&!n.current&&(K.logEvent(X.conversationRatingShown,{showAtAssistantTurn:l,conversationId:o}),n.current=!0)},[C]),M||C?null:e.jsxs("div",{className:"mx-auto",children:[e.jsx(Jt,{children:x&&!E&&e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:e.jsx(Ka,{$padded:!0,children:e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(O,{id:"rating.thanks",defaultMessage:"Thanks for your feedback!"})})})},"submitted")}),!x&&e.jsx(ne.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.1},children:e.jsxs(Ka,{$padded:!1,children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 px-4 py-3 text-sm text-token-text-secondary",children:[e.jsx(O,{id:"rating.instructions",defaultMessage:"Is this conversation helpful so far?"}),e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx(tn,{$selected:g==="thumbsUp",onClick:()=>v("thumbsUp"),children:e.jsx(Vo,{className:"icon-md"})}),e.jsx(tn,{$selected:g==="thumbsDown",onClick:()=>v("thumbsDown"),children:e.jsx(qo,{className:"icon-md"})})]})]}),e.jsx("div",{className:"w-px flex-1 self-stretch bg-token-main-surface-tertiary"}),e.jsx(tn,{className:"p-3",$selected:!1,onClick:()=>y(!0),children:e.jsx(Pi,{className:"icon-md text-token-text-secondary hover:text-token-text-primary"})})]})},"rating")]})}const tn=pe.button`
  ${t=>t.$selected?"text-token-text-primary":"text-token-text-secondary"}
  hover:text-token-text-primary
`,Ka=pe.div`inline-flex rounded-xl border border-gray-100 dark:border-gray-700
${t=>t.$padded&&"py-3 px-4"}
`,Kh=Ue(()=>ze(()=>import("./i1mv0afppjc5ls1i.js"),__vite__mapDeps([33,1,2,3,4,5,34])));function Xh({clientThreadId:t,conversationLeafId:s,canShowInlineMessageFeedback:a,messageForRating:n,allGroupedMessages:o,currentModelId:r}){let c=null;const l=Di(t,s),u=Xt(t),m=On(g=>g.voiceFeedbackThread),d=u===m,{voiceName:h}=Ed();return l?null:(d&&u?(Li.feedbackShown.success({voice:h}),c=e.jsx("div",{className:"text-center",children:e.jsx(Rd,{serverThreadId:u})})):n.rating&&a?c=e.jsx(Kh,{clientThreadId:t,conversationMessage:n,allGroupedMessages:o,currentModelId:r}):c=e.jsx("div",{className:"text-center",children:e.jsx(Yh,{clientThreadId:t,conversationLeafId:s})}),e.jsx("div",{className:"mt-3 w-full empty:hidden",children:c}))}const Qh=Ue(()=>ze(()=>import("./l70wr62zmgek07u9.js"),__vite__mapDeps([35,1,2,3,36,37,4,5,38])).then(t=>t.VoicePlayButton)),Xa=128,Qa={minHeight:"calc(100cqh - var(--thread-leading-height) - var(--thread-trailing-height) - var(--previous-turn-min-height))"};function Jh(t){const{turnIndex:s,conversationLeafId:a,isFinalTurn:n,clientThreadId:o,onChangeItemInView:r,onChangeRating:c,currentModelId:l,avatarClassName:u,showAvatar:m=!0,scrollToMessageId:d,shouldShowDateHeader:h}=t,g=xe(),S=Dn(),x=!!S&&Bi(S),f=jn(),E=Go(Wo.isBusinessWorkspace),j=so(),{value:M}=Ve("2848981774"),y=J.getServerThreadId(o),v=Ct(rn(o,s,a)),{messages:k,variantIds:D,variantsInStreamInfo:T}=v,C=As(k),A=Id();let R=k[k.length-1];for(const W of C){const ge=zu(W);if(ge.some(tt=>A.has(tt.message.id))){R=ge[ge.length-1];break}}const p=k.slice(0,k.indexOf(R)+1),L=zn(),[w,F]=i.useState(!1),[z,_]=i.useState(!1),I=D.findIndex(W=>p.some(ge=>ge.nodeId===W)),b=v.role===Oe.User,B=lt(),Y=Te(o),te=It(v.gizmoId??Y)?.data,q=Bs(l),ie=Pd(l),le=De(),Z=Ps(o,te?.gizmo.id),we=ao(o)===oo.STREAMING,Le=!1,{value:ce}=js("2291672486"),fe=p.some(W=>W.message.content.content_type===mo.MultimodalText),{layer:je}=We("1547743984"),ve=y&&L&&je.get("show_share_button_inline",!1),{isUnauthenticated:Ae}=Pe(),[Ee,Be]=i.useState(!1),[Ce,U]=i.useState(!1),H=v.messages.map(W=>W.message.id),V=i.useRef(null),G=k[k.length-1],Q=G.rating,ae=(d?.length??0)>2&&d!=="finalAgentTurn"&&n&&M&&le,he=()=>{p.length===1&&(K.logEvent(X.editPrompt,{id:p[0].message.id,threadId:J.getServerThreadId(o)}),de.logEvent("chatgpt_edit_prompt"),F(!0))},Se=i.useCallback(()=>{F(!1)},[]),oe=i.useCallback(W=>{Dd(o,s,j,W)},[o,s,j]),Re=W=>{c({nodeId:G.nodeId,messageId:G.message.id,rating:W}),K.logEvent(W==="thumbsDown"?X.messageFeedbackThumbsDownClicked:X.messageFeedbackThumbsUpClicked,{id:G.message.id,threadId:J.getServerThreadId(o),model:l,rating:W}),_(!0)},[$]=i.useState(()=>Date.now()),Me=i.useMemo(()=>Cs.getRequestIdFromConversationTurn(v),[v]),Ge=ro({clientThreadId:o,conversationLeafId:a}),ee=ot(Me)&&!Ge,ct=Cn(),dt=As(p),ut=i.useRef(!1);i.useEffect(()=>{if(ut.current||d===void 0||!M||!le||!V.current){d==="finalAgentTurn"&&n&&ut.current&&J.updateScrollToMessageId(o,void 0);return}(H.includes(d)||d==="finalAgentTurn"&&n)&&(ut.current=!0,requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(V.current)if(d==="finalAgentTurn"&&n)V.current.scrollIntoView({behavior:"instant",block:"end"}),J.updateScrollToMessageId(o,void 0);else{const W=V.current.offsetHeight;let ge;W>Xa?ge=Xa-W:ge=0,V.current.style.scrollMarginTop=`calc(${ge}px + 2px + var(--thread-leading-height))`,V.current.scrollIntoView({behavior:"smooth"})}})}))},[d,V.current]);const{showDebugConversationTurns:Hs}=Hn(),Pt=io(o),qe=Fo(o),mt=Ld({clientThreadId:o,conversationMode:Z}),_e=it(o),ht=i.useCallback(({requestedModelId:W,systemMessage:ge,juice:tt,extraStreamParams:wt})=>{const Ot=new Vt;mt({id:G.nodeId,eventMetadata:{eventSource:"mouse"},turnTracker:Ot,requestedModelId:W,systemMessage:ge,juice:tt,extraStreamParams:wt})},[G,mt]),es=Le,gt=!f&&!Pt&&!B&&!b,Dt=Bd(),Lt=R.message.author.role===Oe.Assistant?R.message:null;Fd({isCompletionRequestInProgress:ee,isUserTurn:b,message:Lt});const Bt=Fi(o,D),{isOpen:pt}=Hd(),Je=Od(Z),Ft=!Dt&&!Je&&gt&&n&&T?.num_variants_in_stream===2&&!G.inlineComparisonRating&&!Bt,$e=Ud(v),Ze=Ft,Os=Ft&&!$e,ft=!b&&!f&&!Pt&&!Je&&!we&&!ee&&!pt,xt=ft&&(!E||es||ie||x)&&!Je&&!Ae&&!B,vt=!f&&!((ee||we)&&n)&&D.length>1&&!w&&!Ze;let St=!1;if(b&&p.length===1){const{shouldHideContent:W}=zd(p[0]);W&&(St=!0)}const Ht=b&&!Je&&!f&&!fe&&p.length===1&&!St&&!w&&!Ae,Us=W=>{r(D[W]),K.logEvent(X.changeNode,{intent:"toggle_between"})};if(!Gd(v,p,Hs)&&!Ze)return ae?e.jsx("div",{style:Qa}):null;const et=p.some(({message:W})=>Hi.getAssetPointers(W).length>0),ts=!et&&n&&qe&&!ce?e.jsx(ps,{onClick:()=>{de.logEvent("chatgpt_regenerate_try_again_button_clicked",l,{requestedModelId:l,...Xe({clientThreadId:o,turnIndex:s})});const W=new Vt;mt({id:_e,eventMetadata:{eventSource:"mouse"},turnTracker:W}),Ts()},icon:Kn,label:g.formatMessage({id:"ConversationTurn.regenerateTooltip",defaultMessage:"Regenerate"}),testId:"regenerate-turn-action-button"}):null,bt="h-[30px] rounded-md px-1 text-token-text-secondary hover:bg-token-main-surface-secondary",Gs=!et&&ce?e.jsx(zh,{className:bt,clientThreadId:o,message:G,onModelSelect:ht,onDropdownChange:Be,canRegenerateResponse:qe}):null,Ws=!b&&!St&&(!n||!ee)?e.jsx(tu,{onClick:oe}):null,ss=!b&&(!n||!ee)&&(G.disclaimers??[]).length===0&&G.nodeId?e.jsx(Qh,{conversationId:o,message:G,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-xs text-token-text-tertiary hover:text-token-text-primary"}):null,ns=!b&&G&&(!n||!ee)?e.jsx(su,{message:G,isFinalTurn:n,iconClassName:"icon-md",className:"gap-1.5 rounded-md p-1 text-token-text-tertiary hover:text-token-text-primary"}):null,yt=xt&&!ee?e.jsxs("div",{className:"flex",children:[Q!=="thumbsDown"&&e.jsx(ps,{onClick:()=>Re("thumbsUp"),disabled:Q==="thumbsUp",icon:Q==="thumbsUp"?Wd:Vo,label:g.formatMessage({id:"ConversationTurn.goodResponseTooltip",defaultMessage:"Good response"}),testId:"good-response-turn-action-button"},`thumbsUp:${G.nodeId}`),Q!=="thumbsUp"&&e.jsx(ps,{onClick:()=>Re("thumbsDown"),disabled:Q==="thumbsDown",icon:Q==="thumbsDown"?Vd:qo,label:g.formatMessage({id:"ConversationTurn.badResponseTooltip",defaultMessage:"Bad response"}),testId:"bad-response-turn-action-button"},`thumbsDown:${G.nodeId}`)]}):null,Vs=ve&&e.jsx(ps,{onClick:()=>{Ns.openSharingModal(y)},label:g.formatMessage({id:"ConversationTurn.shareButtonTooltip",defaultMessage:"Share conversation"}),className:"sm:hidden",icon:qd}),qs=!ce&&e.jsx(Fh,{className:bt,clientThreadId:o,message:G,onModelSelect:ht,onDropdownChange:Be});function as(W){return le?W:e.jsx(Wn,{clientThreadId:o,isStaticSharedThread:f,withVerticalPadding:!0,withHorizontalPadding:!Ze,children:W})}function os(W){return le?W:e.jsx(qt,{children:W})}return e.jsxs(e.Fragment,{children:[h&&e.jsx($d,{turn:v}),e.jsxs("article",{className:P("w-full scroll-mb-[var(--thread-trailing-height,150px)] text-token-text-primary focus-visible:outline-2 focus-visible:outline-offset-[-4px]",d==="finalAgentTurn"&&M&&le?"opacity-0":""),style:ae?Qa:void 0,ref:V,dir:"auto","data-testid":`conversation-turn-${s}`,"data-scroll-anchor":n,onMouseEnter:()=>U(!0),onMouseLeave:()=>U(!1),children:[e.jsx(Yd,{role:v.role}),as(e.jsx(e.Fragment,{children:Ze?e.jsx(Gh,{isFeedbackEnabled:xt,variantIds:D,variantsInStreamInfo:T,conversationTurnMountTime:$,stubSideBySideFeedback:Os,...t}):os(e.jsxs(e.Fragment,{children:[!b&&m&&e.jsx(Zh,{children:e.jsx(pn,{messages:p,isUserTurn:b,avatarClassName:u,gizmo:te})}),e.jsx("div",{className:P("group/conversation-turn relative flex w-full min-w-0 flex-col",!b&&Kd),children:e.jsx("div",{className:"flex-col gap-1 md:gap-3",children:e.jsxs(e.Fragment,{children:[!b&&!f&&e.jsx(Xd,{messages:p,clientThreadId:o,gizmoId:te?.gizmo.id}),!1,e.jsx(fn,{groupedMessagesToRender:dt,allGroupedMessages:C,...t,isEditing:w,isUserTurn:b,isCompletionRequestInProgress:ee,isFeedbackEnabled:xt,isFinalTurn:n,hasActiveRequest:ct,showEditButton:Ht,handleEnterEdit:he,handleExitEdit:Se}),q&&e.jsx("div",{className:"mb-4",children:e.jsx(Qd,{messages:p})}),(ft||vt)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:P("mb-2 flex gap-3 empty:hidden",b?"mr-1 flex-row-reverse":"-ml-2"),children:e.jsx(Jd,{alwaysShow:n,showInline:n||vt,isHovered:Ce||Ee,pagination:vt&&e.jsx(Zd,{showInline:n||vt,currentPage:I,onChangeIndex:Us,length:D.length,className:P("self-center",D.length>1?"visible":"!invisible")}),actions:ft&&e.jsxs(e.Fragment,{children:[ss,Ws,ts,yt,ns,qs,Vs,Gs]})})}),ft&&!ee?e.jsx("div",{className:"pr-2 lg:pr-0",children:e.jsx(eu,{message:G,isFinalTurn:n})}):null,n&&!ee&&e.jsx(Xh,{canShowInlineMessageFeedback:z,clientThreadId:o,conversationLeafId:a,messageForRating:G,allGroupedMessages:C,currentModelId:l})]})]})})})]}))}))]})]})}const bn=fo.memo(Jh),Zh=pe.div`flex-shrink-0 flex flex-col relative items-end`;function eg({onChangeItemInView:t,onRequestMoreCompletions:s,onChangeRating:a,onRequestCompletion:n,clientThreadId:o,conversationLeafId:r,hideHeader:c}){const l=ye(),u=Ds(),m=nu(),[d]=au(),h=ou(),[g]=ru(),S=Ps(o),x=Is(),f=Yn(o),j=J.getConversationOrigin(o)===Oi.APPLE,M=l.store.useContentAreaDimensions(At.Header,B=>B?.height?B.height:void 0),y=l.store.useIsHeaderContentAreaPopulated(),v=ho(o),{isArchived:k}=v,D=iu(f.id),T=S?.kind===Qe.GizmoMagicCreate?"bg-token-main-surface-primary text-token-text-primary":D,C=_n(o,r),A=lu(),[R,p]=i.useState(0),[L,w]=i.useState(!1);i.useEffect(()=>{u&&(R===0?p(C):!L&&C>R&&(w(!0),de.logEvent("chatgpt_continue_conversation_first_message_sent"),K.logEvent(X.continueConversationFirstMessageSent),de.logEvent("chatgpt_conversation_share_page_loaded"),K.logEvent(X.sharedConversationPageLoaded)))},[C,R,L,u]),i.useEffect(()=>{u&&(de.logEvent("chatgpt_continue_conversation_page_loaded"),K.logEvent(X.continueConversationPageLoaded))},[u]);const F=i.useCallback(()=>{m({behavior:"smooth"})},[m]),z=cu(o),_=A&&!k,I=$o(o,r),b=(B,Y,te)=>[...new Array(Y-B).keys()].map(q=>{const ie=q+B;return e.jsx(bn,{isFinalTurn:te(ie),turnIndex:ie,clientThreadId:o,conversationLeafId:r,onChangeItemInView:t,onChangeRating:a,onRequestMoreCompletions:s,onRequestCompletion:n,currentModelId:f.id,avatarClassName:T,scrollToBottom:F,shouldShowDateHeader:I(ie)},ie)});return e.jsxs("div",{onCopy:z,className:P("flex flex-col text-sm",_&&"pb-[120px]",M||_?null:"md:pb-9"),style:{paddingBottom:_?void 0:M},children:[!c&&x?.data&&e.jsx(vr,{clientThreadId:o}),u&&e.jsxs(e.Fragment,{children:[e.jsx(qt,{children:e.jsx("p",{className:"text-xs text-gray-500",children:e.jsx(O,{id:"threadLayout.sharedConversationCopyDisclaimer",defaultMessage:"This is a copy of a conversation between ChatGPT & Anonymous."})})}),C-R===0&&e.jsx("div",{className:"text-center text-xs font-semibold text-token-text-primary",children:e.jsx("button",{onClick:()=>{Ns.openModal(du.ReportConversation),de.logEvent("chatgpt_conversation_share_report_content_clicked",null,{location:"Static Shared Thread Page"}),K.logEvent(X.sharedConversationReportContentClicked,{location:"Dynamic Shared Thread Page"})},children:e.jsx(O,{id:"thread.reportSharedConversation",defaultMessage:"Report content"})})}),b(0,R,B=>B===R-1),e.jsx(qt,{children:e.jsxs("p",{className:"flex items-center text-xs text-gray-500",children:[e.jsx(uu,{className:"icon-xs mr-2"}),e.jsx(O,{id:"threadLayout.sharedConversationPrivateDisclaimer",defaultMessage:"Messages beyond this point are only visible to you"})]})}),b(R,C,B=>B===C-1)]}),!u&&b(0,C,B=>B===C-1),j&&d&&!g&&e.jsx(Ja,{className:P("translate-y-[10px] md:translate-y-[30px]"),onClick:()=>{de.logEvent("chatgpt_thread_scroll_to_top"),h({behavior:"smooth"})},children:e.jsx(mu,{className:"icon-md text-token-text-primary"})}),!d&&e.jsx(Ja,{className:P(M?null:"bottom-5",_?y?"translate-y-[-50px]":"translate-y-[-10px]":""),style:{bottom:A?"calc(var(--composer-bar_footer-current-height) + var(--composer-bar_current-height))":M},onClick:()=>{de.logEvent("chatgpt_thread_scroll_to_bottom"),m({behavior:"smooth"})},children:e.jsx(hu,{className:"icon-md text-token-text-primary"})})]})}const Ja=pe.button`cursor-pointer absolute z-10 rounded-full bg-clip-padding border text-token-text-secondary border-token-border-light right-1/2 translate-x-1/2 bg-token-main-surface-primary w-8 h-8 flex items-center justify-center`,tg=60,sg=({children:t,scrollViewClassName:s,scrollAnchorTopOffset:a=0})=>{const n=i.useRef(null);return e.jsx("div",{className:"h-full",ref:n,children:e.jsx(kn,{children:e.jsx(Uu,{className:"h-full",followButtonClassName:"hidden",initialScrollBehavior:"auto",scrollViewClassName:s,scroller:()=>ng(n,a)?0:1/0,children:t})})})},ng=(t,s)=>{const a=ag(t.current);if(a==null)return!1;const n=a>s,o=a<s-tg;return!n&&!o};function ag(t){if(!t)return null;const s=t.querySelector('[data-scroll-anchor="true"]');if(!s)return null;const a=s.getBoundingClientRect().top,n=t.getBoundingClientRect().top;return a-n}const og=Ue(()=>ze(()=>import("./do1pxkpitrnpxiq3.js"),__vite__mapDeps([39,2,1,3,4,5,40,41,42,43,44,38,45])).then(t=>t.OpenDebugSidebarButton)),rg=Ue(()=>ze(()=>import("./5q1oosqb59xuupbm.js"),__vite__mapDeps([46,1,4,2,3,5]))),Za=Ie({doNotShareSensitive:{id:"thread.modal.onboarding.title",defaultMessage:"Do not share sensitive materials with this application"},somethingWentWrong:{id:"thread.modal.unrecoverableError.title",defaultMessage:"Something went wrong"},tryAgainLater:{id:"thread.modal.unrecoverableError.description",defaultMessage:"We're sorry, but something went wrong. Please try again later."},resetThread:{id:"thread.modal.unrecoverableError.resetThread",defaultMessage:"Reset thread"},sharedConversationReportConversation:{id:"thread.sharedConversation.report",defaultMessage:"Report conversation"},latencyButton:{id:"thread.latencyButton",defaultMessage:"Latency"},archivedConversationDescription:{id:"thread.archivedConversationDescription",defaultMessage:"This conversation is archived. To continue, please unarchive it first."},unarchiveButton:{id:"thread.unarchiveButton",defaultMessage:"Unarchive"}});function ig({clientThreadId:t}){const s=po(),a=Xt(t),n=async()=>{a&&(await Nt.patchConversation(a,{is_archived:!1}),s.invalidateQueries({queryKey:["conversation",t]}),Mn.setState(o=>{const r=o.threads[a];r!=null&&(r.initialThreadData.isArchived=!1)}),Eu(s))};return e.jsxs("div",{className:"my-6 flex flex-col items-center justify-center gap-4",children:[e.jsx("div",{className:"px-3 text-center text-sm text-token-text-secondary",children:e.jsx(O,{...Za.archivedConversationDescription})}),e.jsx("div",{children:e.jsx(Rt,{disabled:!a,onClick:n,icon:Nu,children:e.jsx(O,{...Za.unarchiveButton})})})]})}const yg=function({clientThreadId:t,onCompletionFinished:s,onCreate:a,preRequestCompletion:n,hideHeader:o,hideMessages:r,hideFooter:c,hideToolsOverlay:l,messagesVerticalAlign:u="top",prependThreadChildren:m,renderEmptyState:d,prefetchSearch:h}){const g=no(),S=Ln(t),x=Qt(t),f=it(t),j=ho(t).isArchived;Ui(t),i.useEffect(()=>{x||(Tt(t)?on.addTiming("chatgpt.web.chatPage.renderNewConversation"):on.addTiming("chatgpt.web.chatPage.renderExistingConversation"))},[t,x]);const M=lo(t,f),y=_n(t,f),{setTargetedContent:v}=Fn(),k=g?.includes(zi),D=gu(),T=y>=2;Bn(T);const C=Tt(t)&&!T&&ws(S),A=Tt(t)&&!M&&(ws(S)||S?.kind===Qe.GizmoTest),p=Ro().id,L=Gi(t),w=L??p,F=!!L,z=Bs(w),I=Eo()[w],b=pu(t,S),B=Ao();Yo(y,t,f),i.useEffect(()=>{B||v(void 0)},[t,v,B,f]);const{caModal:Y,onRequestCompletion:te,onChangeItemInView:q,onChangeRating:ie,onRequestMoreCompletions:le}=fu({clientThreadId:t,currentModelId:w,defaultModelId:p,onCompletionFinished:s,onThreadCreated:a,preRequestCompletion:n}),{isUnauthenticated:Z,isLoading:me}=Pe(),we=Ko({clientThreadId:t,currentLeafId:f,handleRequestCompletion:te,prefetchSearchPromise:h});xu({clientThreadId:t,currentModelId:w});const Le=Re=>e.jsx(sg,{scrollAnchorTopOffset:o?0:Au,children:u==="bottom"?e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex-1"}),Re]}):Re});i.useEffect(()=>{document.title=b??"ChatGPT"},[b]);const ce=Te(t),fe=lt(),je=Wi(),ve=A&&!je&&!d&&!ce&&!z&&!fe,Ae=ve&&!me&&Z,Ee=ve&&!me&&!Z,Be=rh(Ae),Ce=lh(Ee),U=Ae&&Be||Ee&&Ce,H=Ds(),V=vu(),{reset:G,streamingContext:Q,StreamingProvider:ae}=Su();i.useEffect(()=>{V&&(Q.setOnResetContext=()=>{G()})},[V,G,Q]);const he=i.useRef(null),Se=i.useRef(null),oe=i.useMemo(()=>({threadContentScrollContainerElementRef:he,footerRootContainerElementRef:Se}),[]);return e.jsx(bu,{clientThreadId:t,currentLeafId:f,children:e.jsxs(ae,{value:Q,children:[k&&e.jsx(rg,{}),e.jsx(yu,{children:b!=null&&e.jsx("title",{children:b})}),e.jsx(Vi.Provider,{value:te,children:e.jsxs(wu,{children:[e.jsxs(ju,{clientThreadId:t,currentModelConfig:I,className:"composer-parent flex h-full flex-col focus-visible:outline-0",children:[!r&&e.jsx(Cu,{value:oe,children:e.jsx(lg,{ref:he,children:!x&&!we?A?d??e.jsx(Sr,{clientThreadId:t,currentModelId:w,isModelLoaded:F,onRequestCompletion:te,enableV2Homepage:U,v2HomepageDisclaimer:U&&e.jsx(Es,{clientThreadId:t})}):T?Le(e.jsxs(e.Fragment,{children:[m,e.jsx(eg,{onChangeItemInView:q,onRequestMoreCompletions:le,onChangeRating:ie,onRequestCompletion:te,clientThreadId:t,conversationLeafId:f,hideHeader:o},t)]})):null:null})}),e.jsx(cg,{ref:Se,children:j?e.jsx(ig,{clientThreadId:t}):e.jsxs("div",{children:[!U&&e.jsx(sh,{clientThreadId:t,isNewThread:C,showPromptStarters:C||!M,currentModelId:w,onRequestCompletion:te}),!c&&e.jsx("div",{className:"relative w-full px-2 py-2 text-center text-xs text-token-text-secondary empty:hidden md:px-[60px]",children:ws(S)&&!U&&e.jsx("div",{className:"min-h-4",children:e.jsx(Es,{clientThreadId:t})})})]})})]}),!l&&e.jsxs("div",{className:"group absolute bottom-2 end-2 z-20 flex flex-col gap-1 md:flex lg:bottom-3 lg:end-3",children:[D?e.jsxs(e.Fragment,{children:[e.jsx(og,{}),!1]}):null,e.jsx(Mu,{})]}),Y,e.jsx(Tu,{clientThreadId:t,isStaticSharedThread:!1,isDynamicSharedThread:H}),e.jsx(_u,{}),e.jsx(ku,{conversationId:t,currentModelId:w,isActiveWindow:!je})]})})]})})},lg=pe.div`grow flex-1 overflow-hidden @container/thread`,cg=pe.div`md:pt-0 dark:border-white/20 md:border-transparent md:dark:border-transparent w-full`;function dg({clientThreadId:t,currentModelId:s,isModelLoaded:a,onRequestCompletion:n,v2HomepageDisclaimer:o}){return e.jsx(lr,{clientThreadId:t,currentModelId:s,isModelLoaded:a,onRequestCompletion:n,v2HomepageDisclaimer:o})}const ug=Ue(()=>ze(()=>import("./lqgvblqpf19lbkho.js"),__vite__mapDeps([47,1,48,4,2,3,5,12])).then(t=>t.ChatScreenContentModals));function mg({disableEmptyState:t,fullWidth:s,renderEmptyState:a}){const{clientThreadId:n,currentModelId:o,conversationLeafId:r,isCompanionWindow:c,isEmbeddedInFocusedView:l,onChangeItemInView:u,onChangeRating:m,onRequestCompletion:d,onRequestMoreCompletions:h,isModelLoaded:g,prefetchSearch:S}=i.useContext(er),x=_n(n,r),f=qi(n),E={clientThreadId:n,conversationLeafId:r,currentModelId:o,onChangeItemInView:u,onChangeRating:m,onRequestMoreCompletions:h,onRequestCompletion:d,showAvatar:!1},j=Qt(n),M=Ko({clientThreadId:n,currentLeafId:r,handleRequestCompletion:d,prefetchSearchPromise:S}),y=j||M||t,v=Ds(),{initialConversationTurns:k,continuedConversationTurns:D}=Ru(x,v),{canUseNewHomepage:T,showEmptyState:C}=mr({clientThreadId:n,currentLeafId:r}),A=x>=2;Bn(A);const{setTargetedContent:R}=Fn(),p=Bs(o);Yo(x,n,r),i.useEffect(()=>{l||R(void 0)},[n,R,l]);const L=$o(n,r);if(C){if(a!=null)return a();if(T&&!y){const w=c?null:e.jsx("div",{className:"text-center text-xs text-token-text-secondary",children:e.jsx(Es,{clientThreadId:n})});return e.jsx(dg,{clientThreadId:n,currentModelId:o,isModelLoaded:g,onRequestCompletion:d,v2HomepageDisclaimer:w})}else if(!T&&!y)return e.jsx(Sr,{clientThreadId:n,currentModelId:o,isModelLoaded:g,onRequestCompletion:d,enableV2Homepage:!p,v2HomepageDisclaimer:e.jsx(Es,{clientThreadId:n})})}return e.jsxs(e.Fragment,{children:[v&&e.jsx(Iu,{}),v&&D.length===0&&e.jsx(Pu,{}),e.jsx(kn,{children:e.jsxs(i.Suspense,{fallback:null,children:[e.jsx(Du,{}),k.length>0&&e.jsx("ol",{className:He.conversationTurnList,children:k.map(({turnIndex:w,isFinalTurn:F})=>e.jsx("li",{className:P(He.conversationTurnWrapper,s&&"w-full"),children:i.createElement(bn,{...E,key:`${n}-${w}`,turnIndex:w,isFinalTurn:F,scrollToMessageId:f,shouldShowDateHeader:L(w)})},w))}),v&&e.jsx(Lu,{}),e.jsx("ol",{className:He.conversationTurnList,children:D.map(({turnIndex:w,isFinalTurn:F})=>e.jsx("li",{className:P(He.conversationTurnWrapper,s&&"w-full"),children:i.createElement(bn,{...E,key:`${n}-${w}`,turnIndex:w,isFinalTurn:F,scrollToMessageId:f,shouldShowDateHeader:L(w)})},w))})]})}),e.jsx(ug,{}),x>0&&e.jsx(Bu,{})]})}function wg({renderEmptyState:t}){return e.jsx(mg,{renderEmptyState:t})}function jg(){const t=xe(),{clientThreadId:s,isLoggedInUser:a,onNewThread:n}=i.useContext(er),o=Te(s),r=Zt(o),c=De();return e.jsxs(Fu,{leading:!0,type:"primary",className:He.header,children:[e.jsxs("div",{className:He.headerLeading,children:[!c&&r&&e.jsx(Zo,{clientThreadId:s,hideNewChat:!0}),a&&e.jsx(Hu,{}),!r&&e.jsx(Kt,{label:t.formatMessage(eo.newChat),className:"hidden @lg/thread:inline-flex",children:e.jsx(Ms,{to:"/",className:He.newThread,onClick:l=>{n?(l.preventDefault(),n()):de.logEvent("chatgpt_web_thread_tap_new_thread")},tabIndex:0,children:e.jsx(Ou,{className:P(He.sidebarIcon),icon:e.jsx(Lo,{}),tabIndex:-1,label:t.formatMessage(eo.newChat),style:{viewTransitionName:"var(--vt_new_chat_thread)"}})})}),e.jsx("div",{className:He.threadDropdown,children:e.jsx(pr,{clientThreadId:s})})]}),e.jsx("div",{className:He.headerTrailing,children:e.jsx(kn,{children:e.jsx(xr,{clientThreadId:s})})})]})}const eo=Ie({newChat:{id:"rnCpM4",defaultMessage:"New Chat"}});export{jg as C,La as G,rr as P,pr as T,sg as W,yg as a,vr as b,wg as c,sh as d,bn as e,bg as f,mr as u};
//# sourceMappingURL=jl9crqstotdu5fgc.js.map
