const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/k82wxk53karu5z88.js","assets/gdcgecchw5ye4zd8.js","assets/ljnjgpls3w1zv92a.js","assets/root-it5gal5m.css","assets/megyxj7wc7eqtmhh.js","assets/conversation-small-cll5buey.css","assets/k6eu4ix99dj5msgw.js","assets/cdqhuqxhiu5dqby5.js","assets/n6bnbva05cak6c8o.js","assets/l22fb38iz7i05qbb.js","assets/dur01wpm6h0bjcfn.js","assets/e34focwad30lup08.js","assets/hdxatkbrmdpsgjbh.js","assets/kiaxdakw6jh2syds.js","assets/dju2beh95xc26ne4.js","assets/b7on5mzt5iy10tm1.js","assets/jayzhgcczng9w1zw.js","assets/bto9j31xm8by1m74.js","assets/oqfj6q89fulpyxom.js","assets/et0gnxf664ezxo2w.js","assets/i5l6q1517jts5bgb.js","assets/mk1x4nqe0vu7o0ap.js","assets/icq2hhs7rnvczcl7.js","assets/ADAVisualizationComponent-mi6em660.css","assets/okjdwhpi1x88d7ki.js","assets/ow88vvvv84v667os.js","assets/jb16tr7cxzld9lzl.js","assets/kom0c78e4wpyapi2.js","assets/opu9nt6ay2d0gkwz.js","assets/ngpj60wyp33wvcnt.js","assets/k5xzb0rfds15l4bz.js","assets/bqpdwes0ro3ef15t.js","assets/nu9x18msrf3c5hn7.js","assets/cqqf5jyfbmkb7bnt.js","assets/chusz34nac89anjd.js"])))=>i.map(i=>d[i]);
import{a0 as oe,r as E,y as t,as as he,a4 as j,a9 as B,ab as N,ac as w,M as H,bC as xe,bD as pe,ae as U,ec as Me,P as G,d as Y,ah as z,cC as Ee,S as Te,N as ye,e as Ie}from"./gdcgecchw5ye4zd8.js";import{hp as _e,dO as Ce,fU as Ae,fV as ve,fP as be,hq as je,hr as Ne,hs as we,ht as Se,hu as Re,dL as Pe,hv as Fe,hw as De,hx as ke,hy as Oe,fX as x,fW as k,hz as J,hA as Q,hB as Le,hC as ze,hD as q,hE as ie,bD as V,fA as re,hF as Ve,hG as We,hH as Ue,hI as de,hJ as le,c as Be,bE as He,bB as Ke,fI as Ge,hK as Ye,fT as c,z as Je,hL as Qe,hM as qe,bu as Xe,hN as $e,eR as Ze,hO as es,hP as ss,hQ as ts,hR as W,hS as as}from"./megyxj7wc7eqtmhh.js";import{q as X,r as ns,d as ce,s as os,v as is,w as rs,z as ds,A as ls,B as cs,D as ms}from"./kiaxdakw6jh2syds.js";import{H as gs,I as us,T as D,l as fs}from"./cdqhuqxhiu5dqby5.js";import{i as hs,C as xs,g as ps,a as Ms,b as Es}from"./l22fb38iz7i05qbb.js";import{m as O}from"./k6eu4ix99dj5msgw.js";import{ae as Ts,af as ys}from"./ljnjgpls3w1zv92a.js";const Is=(e,a)=>e?.textdocId?e.textdocId:e?.function===k.CreateTextdoc?Le(e):a??void 0,_s=({messages:e,isRequestActive:a})=>{const s=oe(),o=_e(e),i=Ce(e),n=E.useMemo(()=>{if(Ae(o?.message))return ve(a,o.message,i?.message??null)},[a,o,i]),g=be(),r=Is(n,g),l=je(r),h=Ne(),u=we(r),M=Se(),d=Re(),f=Pe(),p=Fe(),T=De(),I=ke(),v=Oe({textdocId:r,toolResponseMessage:i});if(!n)return null;const b=!p&&!l&&n.status!==x.STREAMING&&n.status!==x.WAITING&&T;let S,R;if(n.status!==x.REDACTED&&n.status!==x.FAILED&&!b&&r){const C=I&&n.function===k.UpdateTextdoc&&n.status===x.COMPLETE;S=()=>{C&&n.versionInt?ze(r,n.versionInt,M):J(r)},R=()=>{C&&n.versionInt&&f(r,n.versionInt)}}const m=Cs(n,l);if(n.function===k.CreateTextdoc){if(n.status===x.STREAMING||n.status===x.WAITING||n.status===x.COMPLETE){const L=p===!0&&(n.status===x.STREAMING||n.status===x.WAITING);return t.jsx(X,{isInlinePreview:v,isMissingFromThread:b,isFetching:L,type:n.type??null,name:m,isFocused:u,isStreaming:n.status===x.STREAMING,onClick:S,isCanvasOpen:h,textdocId:r})}let C;switch(n.status){case x.FAILED:C=s.formatMessage({id:"SNarKX",defaultMessage:"Failed to generate"});break;case x.CANCELED:C=s.formatMessage({id:"1A6W36",defaultMessage:"Stopped generating"});break;case x.REDACTED:C=t.jsx(he,{align:"start",label:s.formatMessage({id:"F6q1k7",defaultMessage:"Removed from shared conversation"}),children:s.formatMessage({id:"BqyYDu",defaultMessage:"Created document"})});break}return t.jsx($,{children:C})}const y=b||n.status===x.REDACTED,P=d&&!y?m:null,_=t.jsx($,{onClick:S,onMouseOver:R,isStreaming:n.status===x.STREAMING,children:n.function===k.CommentTextdoc?vs(s,n,P):As(s,n,P)});return v&&!h?t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(X,{isInlinePreview:!0,isMissingFromThread:b,isFetching:!1,type:l?.type??null,name:m,isFocused:u,isStreaming:n.status===x.STREAMING,onClick:r!=null?()=>J(r):void 0,isCanvasOpen:h,textdocId:r}),_]}):_};function Cs(e,a){return a?.title?Q(a.title):e.function===k.CreateTextdoc&&e.title?Q(e.title):null}const $=({isStreaming:e=!1,onClick:a,onMouseOver:s,children:o})=>t.jsx("button",{disabled:!a,className:j(e&&"loading-shimmer","flex min-h-5 w-fit select-none pt-[3px] text-start text-token-text-secondary",a&&"hover:text-token-text-primary"),onClick:a,onMouseOver:s,children:o}),me=9;function As(e,a,s){if(a.status===x.STREAMING)return s?e.formatMessage({id:"W2xN1Z",defaultMessage:"Editing {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"8taq8v",defaultMessage:"Editing"});if(a.status===x.FAILED)return s?e.formatMessage({id:"UjJKYZ",defaultMessage:"Failed to edit {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"kWUVkg",defaultMessage:"Failed to edit"});if(a.status===x.CANCELED)return s?e.formatMessage({id:"TmSrCd",defaultMessage:"Stopped editing {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"bYV7xA",defaultMessage:"Stopped editing"});const o=a.updates?.length;return a.status===x.REDACTED||!o||o>me?s?e.formatMessage({id:"n+G/ct",defaultMessage:"Edited {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"aegqpL",defaultMessage:"Edited"}):s?e.formatMessage({id:"osYMSb",defaultMessage:"{numEdits, plural, one {Edited {documentTitle}} other {Made {numEdits} edits to {documentTitle}}}"},{numEdits:o,documentTitle:s}):e.formatMessage({id:"xJD3WR",defaultMessage:"{numEdits, plural, one {Edited} other {Made {numEdits} edits}}"},{numEdits:o})}function vs(e,a,s){if(a.status===x.STREAMING)return s?e.formatMessage({id:"8xQH/P",defaultMessage:"Commenting on {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"5yqLeN",defaultMessage:"Commenting"});if(a.status===x.FAILED)return s?e.formatMessage({id:"Rl821S",defaultMessage:"Failed to comment on {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"W007jt",defaultMessage:"Failed to comment"});if(a.status===x.CANCELED)return s?e.formatMessage({id:"bozPdq",defaultMessage:"Stopped commenting on {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"hyBGa7",defaultMessage:"Stopped commenting"});const o=a.comments?.length;return a.status===x.REDACTED||!o||o>me?s?e.formatMessage({id:"LXEzK7",defaultMessage:"Commented on {documentTitle}"},{documentTitle:s}):e.formatMessage({id:"KeMYhy",defaultMessage:"Commented"}):s?e.formatMessage({id:"Ql5lPq",defaultMessage:"{numComments, plural, one {Commented on {documentTitle}} other {Added {numComments} comments on {documentTitle}}}"},{numComments:o,documentTitle:s}):e.formatMessage({id:"FHtyJQ",defaultMessage:"{numComments, plural, one {Commented} other {Added {numComments} comments}}"},{numComments:o})}const bs=2e3,ge=.4,js=.45,Ns=.2,ws=.1,Ss=.25;var A=(e=>(e[e.Running=0]="Running",e[e.Finished=1]="Finished",e[e.Error=2]="Error",e[e.Stopped=3]="Stopped",e[e.Paused=4]="Paused",e))(A||{});function dt({conversationMessages:e,icon:a,status:s,text:o,estimatedToolDurationMs:i,animationLoopDurationMs:n=bs,shouldPersistAfterFinished:g=!1}){const[r,l]=E.useState(s===0?0:s===1&&!g?7:1),[h,u]=E.useState(0);E.useEffect(()=>{s===2?l(8):s===3?l(9):s===4?l(10):s===1?l(r===2?3:7):s===0&&r===10&&(l(2),u(d=>d+1))},[s]);const M=Fs(r);return E.useEffect(()=>{const d=e[0].message.id;if(M)return q.addDelayedRenderingMessage(d),()=>{q.removeDelayedRenderingMessage(d)}},[M]),ie(()=>{F(r)&&u(d=>d+1)},n),r===7&&!g?null:t.jsxs("div",{className:"my-2.5 flex items-center gap-2.5",children:[t.jsx(Rs,{icon:a,status:s,uiState:r,estimatedToolDurationMs:i,animationLoopCounter:h,shouldPersistAfterFinished:g,onFillProgressBarAnimationComplete:()=>l(4),onFinishAnimationComplete:()=>{l(5),setTimeout(()=>{l(g?7:6)},ws*1e3)},onHideAnimationComplete:()=>l(7)}),t.jsx(Ps,{text:o,uiState:r,animationLoopCounter:h,onEnterAnimationComplete:()=>l(2)})]})}const Z=50;function Rs({icon:e,status:a,uiState:s,estimatedToolDurationMs:o,animationLoopCounter:i,shouldPersistAfterFinished:n,onFillProgressBarAnimationComplete:g,onFinishAnimationComplete:r,onHideAnimationComplete:l}){const[h,u]=E.useState(0);ie(()=>{F(s)?u(b=>b+Z):s===10&&u(0)},Z);let M,d,f;F(s)||s===10?(M="running",d=t.jsx(e,{animationLoopCounter:i}),f="bg-transparent"):s===4||s===5||s===7&&n?(M="finished",d=t.jsx(Ve,{}),f="bg-brand-purple"):a===2?(M="error",d=t.jsx(We,{}),f="bg-orange-500"):a===3&&(M="stopped",d=t.jsx(Ue,{}),f="bg-gray-300");let p={opacity:0,scale:0,rotate:-180,x:0},T={type:"spring",bounce:.3,duration:js},I={opacity:0,scale:.6,rotate:0,x:0};s===0?(p={opacity:0,scale:.5,rotate:-180,x:-8},T={type:"spring",bounce:.3,duration:ge}):s===1?p=!1:s===5&&(I={opacity:0,scale:0,rotate:0,x:0},T={type:"spring",bounce:.3,duration:Ss});const v=ns(h,o);return t.jsx("div",{className:"relative h-5 w-5 shrink-0",children:t.jsx(V,{onExitComplete:()=>{s===6&&l()},children:M!=null&&t.jsxs(O.div,{className:j("absolute left-0 top-0 flex h-full w-full items-center justify-center rounded-full text-white",f),initial:p,animate:{opacity:1,scale:1,rotate:0,x:0},exit:I,transition:T,onAnimationComplete:()=>{s===4&&r()},children:[d,(F(s)||s===10)&&t.jsx(re,{percentage:s===3?100:v,thickness:1.5/23,className:"absolute left-1/2 top-1/2 h-[23px] w-[23px] -translate-x-1/2 -translate-y-1/2 text-brand-purple",backgroundStrokeClassName:"stroke-brand-purple/25 dark:stroke-brand-purple/50",transitionDuration:s===3?`${(100-v)/100*Ns}s`:void 0,transitionTimingFunction:s===3?"cubic-bezier(0.55, 0, 1, 1)":void 0,onTransitionEnd:()=>{s===3&&g()}})]},M)})})}function Ps({text:e,uiState:a,animationLoopCounter:s,onEnterAnimationComplete:o}){const[i,n]=E.useState(e);E.useEffect(()=>{a===2&&n(e)},[s]),E.useEffect(()=>{F(a)||n(e)},[a,e]);let g={opacity:0,x:0,y:15},r={type:"spring",bounce:.3,opacity:{duration:.15},y:{duration:.3}};a===0?(g={opacity:0,x:-8,y:0},r={type:"spring",bounce:.3,duration:ge,delay:.15}):a===1&&(g=!1);const l=i??void 0;return t.jsx("div",{className:j("relative h-5 w-full leading-5",a===8||a===9?"text-token-text-tertiary":"text-token-text-secondary"),children:t.jsx(V,{children:l!=null&&t.jsx(O.div,{className:"absolute left-0 top-0 line-clamp-1 overflow-visible",initial:g,animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:0,y:-15},transition:r,onAnimationComplete:()=>{a===0&&o()},children:l},l.toString())})})}function F(e){return e===0||e===2||e===3}function Fs(e){return F(e)||e===4||e===5||e===6||e===10}const ee=B.div`group absolute left-0 top-0 mr-1.5 h-8 overflow-hidden mt-1`;function K({highlightedCommand:e,status:a,children:s,showWorkUserSetting:o=!1,hideOnlyIfNotInteractedWith:i=!1,onOpenAnalytics:n}){const g=s!=null,[r]=E.useState(o),[l,h]=E.useState(o),[u,M]=E.useState(!1),d=a===A.Finished||a===A.Error,f=i?r?!1:!u:!1,p=a===A.Running&&"loading-shimmer";return d&&f?null:g?t.jsxs(t.Fragment,{children:[t.jsx(se,{$canShowWork:!0,children:t.jsx(V,{children:t.jsx(ee,{children:t.jsx(O.button,{onClick:()=>{l||n?.(),h(T=>!T),M(!0)},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:j(p),children:t.jsxs("div",{className:"flex items-center justify-start gap-1",children:[t.jsx("span",{children:e}),l?t.jsx(Ts,{className:"icon-md"}):t.jsx(ys,{className:"icon-md"})]})},e?.toString())})})}),t.jsx(V,{children:l&&s&&t.jsx(O.div,{initial:"collapsed",animate:"reveal",exit:"collapsed",variants:{collapsed:{translateY:-20,opacity:0,height:0},reveal:{translateY:0,opacity:1,height:"auto"}},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:s})})]}):t.jsx(se,{$canShowWork:!1,children:t.jsx(ee,{className:j(p),children:e})})}const se=B.p`first:mt-0 relative h-8
${({$canShowWork:e})=>e?"text-token-text-secondary hover:text-token-text-primary my-1.5":"text-token-text-secondary"}`,te=N(()=>w(()=>import("./k82wxk53karu5z88.js").then(e=>e.A),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23])).then(e=>e.default));function Ds({messages:e,isRequestActive:a,clientThreadId:s}){const[o,i]=e,n=ce(o.message),g=i?.message.metadata?.aggregate_result,r=os(),l=is(),h=i?.message?rs(i.message):[],u=i?.message.metadata?.aggregate_result?.messages.filter(hs)??[],d=(h.filter(T=>T.type==="chart")??[]).length!==u.length,f=l&&!d;let p=A.Running;return g?.status==="success"?p=A.Finished:i!=null&&i.message.content.content_type!==H.ExecutionOutput||g!=null&&g.status!=="running"?p=A.Error:(n||!a)&&(p=A.Stopped),t.jsxs(t.Fragment,{children:[t.jsx(ks,{messages:e,status:p,isRequestActive:a}),f&&h.map((T,I)=>{const{type:v}=T;return v==="chart"&&!r?(T.fallback_to_image=!0,t.jsx(ae,{children:t.jsx(te,{clientThreadId:s,visualization:T})},I)):t.jsx(ae,{children:t.jsx(te,{clientThreadId:s,visualization:T})},I)}),!f&&i!=null&&t.jsx(xs,{message:i.message})]})}const ae=B.div`mb-3 max-w-[80%]`;function ks({messages:e,status:a,isRequestActive:s}){const[o,i]=e,n=oe(),g=i?.message.metadata?.aggregate_result,r=ce(o.message),{data:l,error:h}=xe(pe.ShowExpandedCodeView);let u=n.formatMessage({id:"message.tools.data-analysis.running",defaultMessage:"Analyzing"});if(g?.status==="success"?u=n.formatMessage({id:"message.tools.data-analysis.finished",defaultMessage:"Analyzed"}):i!=null&&i.message.content.content_type!==H.ExecutionOutput||g!=null&&g.status!=="running"?u=n.formatMessage({id:"message.tools.data-analysis.error",defaultMessage:"Analysis errored"}):(r||!s)&&(u=n.formatMessage({id:"message.tools.data-analysis.stopped",defaultMessage:"Analysis paused"})),l!==void 0||h){const M=ps(o.message)!=null;return t.jsx(K,{status:a,highlightedCommand:u,showWorkUserSetting:l??!1,hideOnlyIfNotInteractedWith:!0,children:M?t.jsxs("div",{className:"mb-3 mt-0.5 overflow-hidden rounded-xl bg-black",children:[t.jsx(Ms,{message:o.message,FormattedText:de}),i!=null&&t.jsx(Es,{message:i.message})]}):null})}return null}const Os=3,Ls=.1,ne=[0,.26,.4];function zs({nextMessage:e,isLastMessage:a,isRequestActive:s}){let o=a||!e||e&&!le(e.message);const i=gs(e?.message),n=Be(i.slice(0,Os).map(g=>g.entries[0].url));if(e?.message.id&&ds(e?.message.id),o){const g=s?t.jsxs("div",{className:"flex items-center gap-1",children:[n.map((r,l)=>t.jsx(O.div,{className:j("-ml-1.5 first:ml-0 last:mr-1.5","relative"),initial:{width:l===0?0:6,opacity:0},animate:{width:20,opacity:1},transition:{duration:Ls,delay:ne[Math.min(l,ne.length-1)]},children:t.jsx("div",{className:j("flex h-[22px] w-[22px] items-center overflow-hidden rounded-full","border-2 border-token-main-surface-primary bg-token-main-surface-primary"),children:t.jsx(He,{url:r,size:32,minSize:16,className:"icon-md rounded-full"})})},r)),t.jsx(U,{id:"jjx8Qg",defaultMessage:"Searching the web"})]}):t.jsx(U,{id:"fssXGM",defaultMessage:"Error while searching"});return t.jsx(K,{highlightedCommand:g,status:s?A.Running:A.Error})}return null}const Vs={strong:e=>{const{node:a,children:s,...o}=e;return t.jsx("strong",{...o,className:j(o.className,"font-semibold text-token-text-primary"),children:s})},p:e=>{const{node:a,children:s,...o}=e;return t.jsx("p",{...o,className:j(o.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:s})}};function Ws({headline:e,message:a}){const o=a.create_time?new Date(a.create_time*1e3):Date.now(),i=+new Date-+o,n=Ge(a.id,48e4,Ye(48e4,i));return t.jsxs("div",{className:"flex items-center gap-2.5",children:[t.jsx(re,{percentage:n,thickness:1/8,className:"h-5 w-5 text-token-text-primary",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-n)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"}),e]})}function Us({messages:e,isStreaming:a,clientThreadId:s}){const[o,i]=E.useState(""),[n,g]=E.useState(!1),h=us(s)===Me.STREAMING||a,u=e[0].message,M=u.id,d=D.getServerThreadId(s),f=Ke(u),p=u.metadata?.summarization_headline,T=a&&p!=null;E.useEffect(()=>{const b=/\*\*(.*?)(?:\*\*|\n|$)/g;let S,R="";for(;(S=b.exec(f))!=null;)R=S[1].trim();R?i(R):u.metadata?.initial_text!=null&&i(u.metadata.initial_text)},[f,u.metadata?.initial_text]),E.useEffect(()=>{f.length>0&&!p&&g(!0)},[f,p]);const I=E.useMemo(()=>({client_thread_id:s,message_id:M,conversationId:d}),[s,M,d]);E.useEffect(()=>{n&&G.logEvent(Y.receivedA8KM123Message,I)},[n]);const v=E.useCallback(()=>{G.logEvent(Y.openedA8KM123Message,{...I,isStreaming:a})},[I,a]);return t.jsx(K,{status:h?A.Running:A.Finished,highlightedCommand:h?p==null?o:t.jsx(Ws,{headline:p,message:u}):u.metadata?.finished_text??"",onOpenAnalytics:v,children:n&&!T?t.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:t.jsx(de,{componentOverrides:Vs,className:"not-prose leading-6",children:f})}):null})}const Bs=N(()=>w(()=>import("./okjdwhpi1x88d7ki.js"),__vite__mapDeps([24,1,2,3,4,5,13,12,14,15,7,6,16,17,18,19,8,20,21,9,22]))),Hs=N(()=>w(()=>import("./ow88vvvv84v667os.js"),__vite__mapDeps([25,1,2,3,4,5]))),Ks=N(()=>w(()=>import("./jb16tr7cxzld9lzl.js"),__vite__mapDeps([26,1,2,3,4,5,13,12,14,15,7,6,16,17,18,19,8,20,21,9,22]))),Gs=N(()=>w(()=>import("./kom0c78e4wpyapi2.js"),__vite__mapDeps([27,1,2,3,4,5,7,6])).then(e=>e.TextMessageEditor)),Ys=N(()=>w(()=>import("./opu9nt6ay2d0gkwz.js"),__vite__mapDeps([28,1,2,3,4,5,6,29,13,12,14,15,7,16,17,18,19,8,20,21,9,22]))),Js=N(()=>w(()=>import("./k5xzb0rfds15l4bz.js"),__vite__mapDeps([30,1,2,3,13,4,5,12,14,15,7,6,16,17,18,19,8,20,21,9,22]))),Qs=N(()=>w(()=>import("./bqpdwes0ro3ef15t.js"),__vite__mapDeps([31,1,2,3,4,5,16,7,6,17,32,13,12,14,15,18,19,8,20,21,9,22])).then(e=>e.BrowsingMessage)),qs=N(()=>w(()=>import("./cqqf5jyfbmkb7bnt.js"),__vite__mapDeps([33,1,2,3,4,5,13,12,14,15,7,6,16,17,18,19,8,20,21,9,22])).then(e=>e.SearchResultMessage)),Xs=N(()=>w(()=>import("./chusz34nac89anjd.js"),__vite__mapDeps([34,1,2,3,4,5,16,7,6,17,13,12,14,15,18,19,8,20,21,9,22])).then(e=>e.JITPluginMessage));function lt(e){switch(e.type){case c.Text:case c.Debug:return[e.message];case c.MultiText:case c.Browsing:case c.CodeInterpreter:case c.JITPlugin:case c.RetrievalBrowsing:case c.ParallelBrowsing:case c.Dalle:case c.GizmoEditor:case c.SearchResult:case c.a8km123:case c.f959b8c:case c.b1de6e2:case c.b1de6e2_c:case c.Canmore:case c.de1d73e:case c.SearchGPTQuery:return e.messages;default:throw new Error("Bad")}}function ct({groupedMessagesToRender:e,allGroupedMessages:a,clientThreadId:s,isEditing:o,isUserTurn:i,isCompletionRequestInProgress:n,isFeedbackEnabled:g,isFinalTurn:r,turnIndex:l,hasActiveRequest:h,showEditButton:u=!1,handleEnterEdit:M,handleExitEdit:d,onChangeItemInView:f,onRequestMoreCompletions:p,onRequestCompletion:T,shouldGrowContainer:I=!0}){const{showDebugConversationTurns:v}=Je(),b=fs(s),S=a.some(m=>Qe.includes(m.type)),R=e.map((m,y)=>{const P=y===a.length-1;switch(m.type){case c.Text:case c.MultiText:{const _=e[y-1],C=_?.type,L=_&&"messages"in _?_.messages:void 0;if(m.type===c.Text){const ue=m?.message&&!le(m.message.message),fe=o?t.jsx(Gs,{message:m.message,clientThreadId:s,onChangeItemInView:f,onRequestCompletion:T,onRequestMoreCompletions:p,onExitEdit:d,disabled:h}):S&&ue?null:t.jsx(ls,{className:"min-h-8",message:m.message,isFeedbackEnabled:g,isCompletionInProgress:P&&n,turnIndex:l,clientThreadId:s,showEditButton:u,onEnterEdit:M,isUserTurn:i,onRequestMoreCompletions:p,prevGroupedMessageType:C,prevGroupedMessages:L});return t.jsxs(E.Fragment,{children:[fe,t.jsx(qe,{isUserTurn:i,message:m.message.message})]},"group-"+m.message.nodeId)}else return m.type===c.MultiText?t.jsx(Ks,{clientThreadId:s,messages:m.messages,isCompletionInProgress:P&&n,isFeedbackEnabled:g,onRequestMoreCompletions:p,prevGroupedMessageType:C,prevGroupedMessages:L},"multitext-"+(m.messages[0]?.nodeId??y)):m.type}case c.Browsing:case c.RetrievalBrowsing:{const _=b!=null&&[z.GizmoInteraction,z.GizmoMagicCreate,z.GizmoTest].includes(b.kind);return t.jsx(Qs,{messages:m.messages,isRequestActive:h,isLastMessageInTurn:P,isUsingGizmo:_,isRetrieval:m.type===c.RetrievalBrowsing},"browsing-"+(m.messages[0]?.nodeId??y))}case c.SearchGPTQuery:{const _=a.slice(y+1).find(C=>C.type===c.Text);return t.jsx(zs,{isRequestActive:h,isLastMessage:P,nextMessage:_&&_.type===c.Text?_.message:void 0},"searchquery-"+(m.messages[0]?.nodeId??y))}case c.a8km123:return t.jsx(Us,{messages:m.messages,isStreaming:P&&n,clientThreadId:s},"sum-"+(m.messages[0]?.nodeId??y));case c.f959b8c:return null;case c.b1de6e2:return null;case c.b1de6e2_c:return null;case c.de1d73e:return null;case c.ParallelBrowsing:return t.jsx(Js,{messages:m.messages},"parallel-"+(m.messages[0]?.nodeId??y));case c.CodeInterpreter:return t.jsx(Ds,{messages:m.messages,isRequestActive:h,clientThreadId:s},"ada-"+(m.messages[0]?.nodeId??y));case c.JITPlugin:return t.jsx(Xs,{messages:m.messages,clientThreadId:s,isLastTurnInConversation:r,onRequestCompletion:T},"jit-"+(m.messages[0]?.nodeId??y));case c.Dalle:return t.jsx(Ys,{messages:m.messages,clientThreadId:s},"dalle-"+(m.messages[0]?.nodeId??y));case c.GizmoEditor:return t.jsx(Bs,{messages:m.messages},"gizmo-editor-"+(m.messages[0]?.nodeId??y));case c.Canmore:return t.jsx(_s,{messages:m.messages,isRequestActive:h},"canmore-"+(m.messages[0]?.nodeId??y));case c.Debug:return v?t.jsx(Hs,{message:m.message},"debug-"+m.message.nodeId):null;case c.SearchResult:return t.jsx(qs,{messages:m.messages},"search-result-"+(m.messages[0]?.nodeId??y))}});return t.jsx(Zs,{shouldGrowContainer:I,children:R})}function $s(){return t.jsx(Xe,{type:"danger",children:t.jsx(U,{id:"daIg0P",defaultMessage:"Unable to display this message due to a error."})})}function Zs({children:e,shouldGrowContainer:a}){return t.jsx("div",{className:j({"flex max-w-full flex-col":!0,"flex-grow":a}),children:t.jsx(Ee,{name:"GroupedMessages",fallback:$s,children:e})})}function mt(e,a,s,o){let i=es.getReadyFiles(e.getState());o?.kind===z.GizmoMagicCreate?i=i.filter(d=>d.gizmoId!=null):i=i.filter(d=>d.gizmoId==null);let n=a??"";const g=[],r=[],l=ss(s,o),u=ts(s,o).length>0,M=l===W.Interpreter||l===W.Retrieval||l===W.ContextConnector;return i.forEach(({fileSpec:d})=>{if(M){const f=d.contextConnectorInfo;g.push({id:d.id,size:d.size,name:d.name,context_connector_info:f?{context_connector:f?.contextConnector,source_url:f?.sourceUrl,synthetic_extension:f?.syntheticExtension??null,type:f?.type}:void 0,mime_type:d.mimeType,width:"width"in d?d.width:void 0,height:"height"in d?d.height:void 0,file_token_size:d.fileTokenSize})}u&&"width"in d&&"height"in d&&r.push({content_type:Ie.ImageAssetPointer,asset_pointer:as(d.id),size_bytes:d.size,width:d.width,height:d.height})}),r.length>0&&(r.push(a??""),n={content_type:H.MultimodalText,parts:r}),{content:n,attachments:g}}async function gt({clientThreadId:e,currentRequestId:a,queryClient:s,isHistoryAndTrainingDisabled:o}){const i=D.getServerThreadId(e);cs.stopConversation(i);const n=D.getTree(e);!n.hasReceivedServerCompletion&&!o&&n.getParent(a).metadata?.errCode!==$e.ContentPolicy&&setTimeout(()=>{ms.onCreateFinished(s,i,o)},500),i&&Te.checkGate("3922476776")&&await ye.stopConversationProcess(i),Ze.abortRequest(a)&&D.updateTree(e,r=>{const l=D.getThreadCurrentLeafId(e);r.updateNodeMessageMetadata(l,{finish_details:{type:"interrupted"}})})}export{ct as C,A as T,K as a,dt as b,gt as c,lt as d,mt as g};
//# sourceMappingURL=gz9hevnzw30kkj7g.js.map
