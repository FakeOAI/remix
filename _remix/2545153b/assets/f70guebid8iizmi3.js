import{m as e,aJ as c,r as u,gz as U,az as W,z as B,e as H,bA as L,dY as V,f7 as J,bJ as E,P as D,d as P,bo as Q,bi as X}from"./llx06woxqm5vp2b7.js";import{cU as Y,ba as q,cV as Z}from"./j0tiu643ugkdkhvf.js";import{u as O}from"./lthiis713bg1gt6f.js";import{e as G,d as A}from"./j6fs9oow8f80rqhk.js";import{P as I}from"./gngnuaiec6kx5jdk.js";import{aQ as ee}from"./bkftj4gvmrvu5un3.js";import"./b6rom5lp4xitnu99.js";function R({title:a,content:t,buttons:r,time:s,icon:n,size:i="default",progressBar:m,disabled:l=!1,onClick:d}){const b=l?"border-token-dot-color border-opacity-10":"border-[rgba(0,0,0,0.1)] dark:border-[rgba(255,255,255,0.1)]",S=i==="small"?`w-[380px] pr-[15px] pl-[20px] pt-[13px] pb-[10px] ${l?"":"gap-4"}`:"w-full gap-4 px-[22px] pb-[22px] pt-[18px]",g=d?"cursor-pointer":"",h=i==="small"?"text-[15px]":"";return e.jsxs("div",{className:c("inline-flex flex-col items-start justify-start rounded-2xl border",b,"bg-token-main-surface-primary dark:bg-token-main-surface-secondary",S,g,h),onClick:d,style:i==="small"&&!l?{boxShadow:"rgba(0, 0, 0, 0.06) 0px 2px 6px 0px"}:void 0,children:[e.jsxs("div",{className:c("flex flex-col items-start justify-start self-stretch",i!=="small"&&"gap-1.5"),children:[e.jsxs("div",{className:c("inline-flex items-start justify-start self-stretch",i!=="small"&&"gap-2"),children:[e.jsx("div",{className:c("shrink grow basis-0 font-medium leading-normal",l?"text-token-text-secondary":"text-token-text-primary"),children:a}),e.jsx("div",{className:"relative h-6 w-6"}),!l&&(n||e.jsx(ee,{className:"relative h-6 w-6"}))]}),e.jsx("div",{className:c("flex w-full flex-col items-start justify-start",i==="small"&&"mt-[-2px]"),children:e.jsx("div",{className:c("inline-flex w-full items-start justify-start self-stretch rounded",i==="small"?"gap-1":"gap-2.5 py-1"),children:e.jsx("div",{className:c("w-full font-normal leading-relaxed",l?"text-token-text-tertiary":"text-token-text-secondary"),children:t})})})]}),m?e.jsxs("div",{className:c("mb-2 inline-flex items-center justify-between self-stretch",r?.length&&"mt-[-10px]"),children:[m,r]}):e.jsxs("div",{className:"inline-flex items-center justify-end self-stretch",children:[s&&e.jsx("div",{className:"shrink grow basis-0 text-[15px] font-normal leading-normal text-token-text-tertiary",children:s}),e.jsx("div",{className:"flex gap-2",children:r})]})]})}const se={strong:a=>{const{node:t,children:r,...s}=a;return e.jsx("strong",{...s,className:c(s.className,"font-semibold text-token-text-primary"),children:r})},p:a=>{const{node:t,children:r,...s}=a;return e.jsx("p",{...s,className:c(s.className,"text-base","has-[strong]:mb-1 [&:not(:first-child)]:has-[strong]:mt-3 [&:not(:has(strong))]:mb-3"),children:r})}};function te({message:a,isExpandable:t}){const s=a.create_time?new Date(a.create_time*1e3):Date.now(),n=O(+s,48e4);return e.jsx(I,{percentage:n,className:c("mr-4",t?"!w-3/4":"!w-full"),backgroundClassName:"bg-token-sidebar-surface-secondary rounded-full",barClassName:"bg-token-text-primary rounded-full",transitionDuration:`${(100-n)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)",height:8})}function ae({headline:a,message:t}){const s=t.create_time?new Date(t.create_time*1e3):Date.now(),n=O(+s,48e4);return e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(Z,{percentage:n,thickness:1/8,className:"h-5 w-5 text-token-text-primary",backgroundStrokeClassName:"stroke-token-main-surface-tertiary",transitionDuration:`${(100-n)/100*.2}s`,transitionTimingFunction:"cubic-bezier(0.55, 0, 1, 1)"}),a]})}function re({isExpandable:a,handleOpenSidebarSummarizer:t,summarizationHeadline:r,latestTitle:s,message:n}){return e.jsx("div",{className:"py-2",children:e.jsx(R,{buttons:[e.jsx(Q,{onClick:t,color:"secondary",className:"!h-[38px] text-[15px] font-normal text-token-text-secondary",children:e.jsx("div",{className:"px-1",children:e.jsx(X,{id:"wQcuK8",defaultMessage:"Details"})})},"Details")],title:r,time:null,icon:e.jsx("div",{className:""}),content:`${s}...`,size:"small",progressBar:e.jsx(te,{message:n,isExpandable:a})})})}function ne({handleOpenSidebarSummarizer:a,summarizationHeadline:t,message:r}){return e.jsx("div",{className:"py-2",children:e.jsx(R,{buttons:[],title:t,time:null,content:r.metadata?.finished_text??"",size:"small",disabled:!0,onClick:a})})}function z({completionInProgress:a,summarizationHeadline:t,latestTitle:r,message:s,summaryText:n,isExpandable:i,disableExpansion:m,onOpenAnalytics:l,handleOpenSidebarSummarizer:d}){return e.jsx(G,{status:a?A.Running:A.Finished,highlightedCommand:a?t==null?r:e.jsx(ae,{headline:t,message:s}):s.metadata?.finished_text??"",onOpenAnalytics:l,onClick:d,children:n&&i&&!m?e.jsx("div",{className:"mb-4 border-l-2 pl-4 dark:border-token-text-secondary",children:e.jsx(q,{componentOverrides:se,className:"not-prose leading-6",children:n})}):null})}function xe({messages:a,isStreaming:t,isLastMessage:r,clientThreadId:s,currentGroupedMessageIndex:n,turnIndex:i}){const[m,l]=u.useState(""),[d,b]=u.useState(!1),g=U(s)===W.STREAMING,h=g||t,o=a[0].message,k=o.id,w=B.getServerThreadId(s),x=H(o),p=o.metadata?.summarization_headline,F=t&&p!=null,{toggleThreadSidebar:j}=L(),_=V(),f=J(),$=o.metadata?.model_slug?.startsWith("o1")&&o.metadata?.model_slug?.endsWith("o"),K=Y(),y=u.useCallback(()=>{_&&f&&f.type==="summarizer"&&f.clientThreadId===s&&f.turnIndex===i?E({className:"close-thread-sidebar",update:()=>{j({type:"summarizer",clientThreadId:s,currentGroupedMessageIndex:n,turnIndex:i})}}):E({className:"open-thread-sidebar",update:()=>{j({type:"summarizer",clientThreadId:s,currentGroupedMessageIndex:n,turnIndex:i})}})},[j,s,n,i,_,f]);u.useEffect(()=>{const T=/\*\*(.*?)(?:\*\*|\n|$)/g;let C,v="";for(;(C=T.exec(x))!=null;)v=C[1].trim();v?l(v):o.metadata?.initial_text!=null&&l(o.metadata.initial_text)},[x,o.metadata?.initial_text]),u.useEffect(()=>{x.length>0&&b(!0)},[x]);const N=u.useMemo(()=>({client_thread_id:s,message_id:k,conversationId:w}),[s,k,w]);u.useEffect(()=>{d&&D.logEvent(P.receivedA8KM123Message,N)},[d]);const M=u.useCallback(()=>{D.logEvent(P.openedA8KM123Message,{...N,isStreaming:t})},[N,t]);return K?$?g&&r||t?e.jsx(re,{isExpandable:d,handleOpenSidebarSummarizer:y,summarizationHeadline:p??null,latestTitle:m,message:o}):e.jsx(ne,{handleOpenSidebarSummarizer:y,summarizationHeadline:p??null,message:o}):e.jsx(z,{completionInProgress:h,summarizationHeadline:p,latestTitle:m,message:o,onOpenAnalytics:M,handleOpenSidebarSummarizer:d||!t?y:void 0}):e.jsx(z,{completionInProgress:h,summarizationHeadline:p,latestTitle:m,message:o,onOpenAnalytics:M,summaryText:x,isExpandable:d,disableExpansion:F})}export{se as SUMMARY_MARKDOWN_COMPONENT_OVERRIDES,xe as default};
//# sourceMappingURL=f70guebid8iizmi3.js.map
