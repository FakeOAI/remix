import{j as e,r as o,bC as g,aq as j,ak as h}from"./mz4maixy265szwnd.js";import{g as p}from"./kqwdyvkaaavvn8k3.js";import{a as f}from"./ngfyq2zgg0sjwh1p.js";import{d4 as b,d5 as v,d6 as N,d7 as _,d8 as P,d9 as A}from"./n7b9v4lgoh59xuao.js";function F({url:i}){const r=f(i).data??p(i,"short");return e.jsx(e.Fragment,{children:r})}function M({item:i}){const r=b(),a=v(),x=N();let c=i.attributions_debug&&r!==i.attributions_debug.influence_temperature&&_(i.attributions_debug,r,void 0,a,x),n=i.attributions;const d=i.attributions_debug?.filtered_segments;return a&&d&&(n=n?.filter(({attribution_index:t})=>d.includes(t))),e.jsxs("div",{className:"text-left text-xs text-token-text-secondary",children:[c&&e.jsxs(e.Fragment,{children:[e.jsx("div",{children:i.attributions_debug?.ref_id}),e.jsxs("label",{className:"font-bold",children:["Probabilities (temperature: ",r,")"]}),e.jsxs("div",{className:"grid grid-cols-[auto,auto,auto] place-items-start gap-1",children:[e.jsx("div",{children:"Segment"}),e.jsx("div",{children:"Probability"}),e.jsx("div",{children:"Influence"}),c?.map(({attribution_index:t,probability:s,influence:l})=>e.jsxs(o.Fragment,{children:[e.jsx("div",{children:t}),e.jsx("div",{children:s.toPrecision(4)}),e.jsx("div",{children:l?.toPrecision(4)})]},t))]})]}),e.jsxs("label",{className:"font-bold",children:["Probabilities (default temp"," ",i.attributions_debug?.influence_temperature,")"]}),e.jsxs("div",{className:"grid grid-cols-[auto,1fr] place-items-start gap-1",children:[e.jsx("div",{children:"Segment"}),e.jsx("div",{children:"Probability"}),n?.map(({attribution_index:t,probability:s})=>e.jsxs(o.Fragment,{children:[e.jsx("div",{children:t}),e.jsx("div",{children:s.toPrecision(4)})]},t))]}),i.attributions_debug?.timings&&e.jsxs(e.Fragment,{children:[e.jsx("label",{className:"font-bold",children:"Timings"}),e.jsx("div",{className:"grid grid-cols-[auto,1fr] place-items-start gap-1",children:Object.entries(i.attributions_debug.timings).map(([t,s])=>e.jsxs(o.Fragment,{children:[e.jsx("div",{children:t}),e.jsxs("div",{children:[s.toFixed(0),"ms"]})]},t))})]}),e.jsx("label",{className:"font-bold",children:"Debug info"}),e.jsxs("div",{className:"grid grid-cols-[auto,1fr] place-items-start gap-1",children:[e.jsx("div",{children:"Segment start idx"}),e.jsx("div",{children:i.attributions_debug?.start_idx}),e.jsx("div",{children:"Segment end idx"}),e.jsx("div",{children:i.attributions_debug?.end_idx})]})]})}function k({attributions:i,attributionsDebug:r,children:a}){const x=P(),c=g().resolvedTheme==="dark",n=o.useMemo(()=>i?.map((s,l)=>({...s,originalIndex:l}))?.toSorted((s,l)=>l.probability-s.probability),[i]),d=b(),t=r&&i&&r.influence_temperature!==d&&A(i,d);return!n||!x?a:e.jsx(j,{label:e.jsxs("div",{className:"text-left text-xs font-normal text-token-text-primary",children:[e.jsx("div",{className:"font-bold",children:"Attributions (Debug)"}),e.jsxs("div",{className:"grid grid-cols-[200px,1fr,1fr] gap-1",children:[e.jsx("div",{children:"Source"}),e.jsxs("div",{children:["τ=",r?.influence_temperature]}),e.jsx("div",{children:t&&`τ=${d}`}),n.map((s,l)=>{const m=s.source_type==="prior",u=m?"text-red-500":s.url?"":"text-gray-500";return e.jsxs(o.Fragment,{children:[e.jsx("div",{className:h("flex flex-col",u),children:m?e.jsx("div",{className:"line-clamp-1 font-bold",children:"Model Prior"}):s.url?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"line-clamp-1 font-bold",children:e.jsx(F,{url:s.url})}),e.jsx("div",{className:"line-clamp-1 text-xs",children:s.url})]}):e.jsxs("div",{className:"text-xxs line-clamp-1",children:["(",s.source_type,")"]})}),e.jsxs("div",{className:u,children:[(s.probability*100).toFixed(2),"%"]}),e.jsx("div",{className:u,children:t&&`${(t[s.originalIndex].probability*100).toFixed(2)}%`})]},l)})]})]}),theme:c?"default":"white",delayDuration:0,className:"inline",side:"left",children:a})}export{k as A,M as E,F as a};
//# sourceMappingURL=o2921g4nv32zz3o6.js.map
