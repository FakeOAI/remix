const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/b6m8ik9775mnmzod.js","assets/cya1ek7zbsww3e8p.js","assets/m1h3d66e9x9d8av7.js","assets/root-fuvdhw7t.css","assets/sso-lh93s4wrdpp5fblx.js","assets/h2x37ub1souzo3by.js","assets/o02kugc5eyp7bzuk.js","assets/conversation-small-cll5buey.css","assets/cd3lr7lq8spr3x1m.js","assets/ji313uzrpltya54g.js","assets/cnkyxf781f12fdb9.js","assets/cnlquey73j7uw8fu.js","assets/lxcl4lkoqrle7fky.js","assets/gqzdg6plr3pmj597.js","assets/lrlzvgtohqckew7u.js","assets/clvle6hjcebazwfi.js","assets/dt5uqt2zhmlrp895.js","assets/n0s5m6clrqpu2fmq.js","assets/ck6f40emr7l3i0b3.js","assets/lptuk0q8xn5ezb1r.js","assets/eqdwfm1ss7l1qetb.js","assets/br9sj6yk029klw3b.js","assets/gq7tdevv4xdhasrb.js","assets/md510keitf2ivqa8.js","assets/beqhh5k54ufxbjqa.js","assets/n7mihaj2sjxshzb0.js","assets/pao6j5dhdawubk5p.js","assets/ht9d44tegtx4tp9s.js","assets/kav457re2wa0x93n.js","assets/bhomxqrcs87wp0ug.js","assets/bjiqtsa2cgudgxj8.js","assets/oqh7ik4ekqszwe7b.js","assets/itghwucfyv5ciib7.js","assets/hxbgovcs84mk9v9r.js","assets/o8i8jua4ntxjn5y6.js","assets/l2vkye9yek1pl7hq.js","assets/983a0dy92b3ronpv.js","assets/idzy572xfl7a5o6a.js","assets/hv7e2fak15kx5n21.js","assets/kqwdyvkaaavvn8k3.js","assets/n34hy54j5bdr6y6c.js","assets/f084274wzviqv3v8.js","assets/pcjzq5zspamo9j8w.js","assets/zy8toyr2lgrov161.js","assets/e9lafxuzyeh4418f.js","assets/oq0wn5kmxc7rsdva.js","assets/obop3mkgis8ubd40.js","assets/nhwwej1nq0zrd7sc.js","assets/ecaf2k8jxs5jdeba.js","assets/dg59tnhw4y7axib5.js","assets/k7gblveuiw9977ct.js","assets/o3xqxqfvzxvixas7.js","assets/t9hafwtdc4pa0i6h.js","assets/cwu0zz6c73ktxehb.js","assets/i54f37mdctri2apr.js","assets/jxvdqm13zt0qwgq5.js","assets/pbdfoko4gp72yxjd.js","assets/iej0cupg2dqkmejt.js","assets/g0lnj6ucdra0znz0.js","assets/m0ufyovf28ile0yl.js","assets/jk8w36bsokizpx57.js","assets/jci37cw2gaa1mzk1.js","assets/m6ckmcg5tc6lq0tg.js","assets/jwu51nzixsme9dia.js","assets/eg0ljzej0vy0q2ev.js","assets/l7os5ptlstx02j38.js","assets/hebnsu59jjcxuabp.js","assets/hdbfjkke7bjaucig.js","assets/swiper-kmk1dd5x.css","assets/mwq4hgq32r8zxoz9.js","assets/nbye4lkf0z5yx7k0.js","assets/bsu2bl74d8hvnjqn.js","assets/j7pqhf0z6hzxyx3a.js","assets/gphz2kh56z3x1ky9.js","assets/igb9dmr373qfmqoq.js","assets/hirsm9330k9ce9fk.js","assets/b0g5goygjlgrn1vt.js","assets/mbtmeqavw326paga.js","assets/moe68hd05fytpaqp.js","assets/nbgv50evg19shp1b.js","assets/biwdj69jy7kfro95.js","assets/mzkxlhrlmxhntkvn.js","assets/ifaswsg4f8xpgayn.js","assets/fsddy3bxlesj6ecw.js","assets/kcxw2s0wy8zkxgqf.js","assets/h6ozxan1owwhaig7.js","assets/nv8iokcz1qb8pmi8.js"])))=>i.map(i=>d[i]);
import{O as Re,t as e,a8 as c,bH as Pe,r as h,av as $,a3 as J,a as ze,aj as Ae,bx as pe,bJ as ye,by as qe,dg as D,aV as re,fF as ot,co as xa,k as lt,fG as ct,_ as ha,fH as va,fI as ja,fJ as ya,I as ba,w as dt,fK as ka,dW as wa,dU as Ms,cW as ut,cX as pt,cB as mt,fL as Ta,dV as Ma,fM as _a,fN as Na,K as Sa,g as Pa,a5 as Fe,a6 as Oe,ag as fe,z as be,T as oe,u as Ca,j as Be,ad as he,bD as gt,bo as _s,ax as Ns,bs as ft,ac as is,P as xt,d as ht,bE as vt,a9 as Ss,ay as Ia,f2 as jt,Q as yt,dO as He,ab as Te,f6 as Aa,v as Le,R as me,M as La,c_ as bt,c$ as kt,d0 as wt,ea as Tt,D as fs,fO as Ga,fe as Ua,bv as Es,bw as Rs,f8 as Ea}from"./cya1ek7zbsww3e8p.js";import{bH as v,kh as Mt,ac as Ie,W as le,a3 as Qe,H as Ra,ki as _t,kj as Nt,kk as St,fD as z,aw as Pt,kl as Ct,km as za,kn as xs,ko as Fa,M as hs,kp as se,kq as Ve,av as Oa,kr as Ue,bG as Xe,ck as It,cp as Ba,n as At,o as Lt,e_ as $a,ks as Wa,eE as Gt,kt as Da,eF as Ut,eG as Et,eJ as qa,eH as ie,ku as Ha,eI as Va,eK as Ka,aO as vs,eL as Ya,kv as Qa,kw as zs,kx as rs,aN as Xa,dt as Fs,ek as Rt,d as Ps,el as Ja,af as Za,da as en,ky as Os,c as zt,aG as sn,kz as Ft,bX as Ot,kA as tn,cn as Bt,cv as Ce,dm as an,aM as nn,kB as rn,de as on,e as ln,fC as cn}from"./o02kugc5eyp7bzuk.js";import{a as $t,N as Wt,L as Dt,w as Cs,J as dn,r as qt,q as un,n as pn,O as mn,Q as gn,R as fn,S as xn,T as hn,U as Bs}from"./ji313uzrpltya54g.js";import{F as vn,a as js,O as ss,q as Ht,aN as ys,ae as Ke,r as jn,ad as yn,P as bn,aD as os,aZ as Je,aP as Vt,aI as Kt,_ as Yt,a8 as kn,aH as wn,an as Tn,am as Mn,J as _n,I as Nn,b$ as Sn,S as Pn,aa as Cn,bx as In}from"./m1h3d66e9x9d8av7.js";import{a as X,F as ne,c as bs,b as ls,G as An,d as Ln}from"./o3xqxqfvzxvixas7.js";import{i as Gn,j as Un,T as R}from"./cnkyxf781f12fdb9.js";import{U as Ee,u as Qt}from"./n0s5m6clrqpu2fmq.js";import{u as En}from"./dg59tnhw4y7axib5.js";import{_ as Rn}from"./fsddy3bxlesj6ecw.js";import{G as Is}from"./k7gblveuiw9977ct.js";import{G as zn}from"./kcxw2s0wy8zkxgqf.js";import{D as F,B as As}from"./gqzdg6plr3pmj597.js";import{S as W}from"./ck6f40emr7l3i0b3.js";import{P as Fn}from"./cd3lr7lq8spr3x1m.js";import{G as On}from"./jci37cw2gaa1mzk1.js";import{z as $e,B as Bn,u as Xt,t as Jt}from"./h2x37ub1souzo3by.js";import{a as $s}from"./h6ozxan1owwhaig7.js";import{h as $n,c as Wn,a as Zt,W as Dn}from"./bsu2bl74d8hvnjqn.js";import{m as ea}from"./cnlquey73j7uw8fu.js";import{G as qn}from"./hirsm9330k9ce9fk.js";import{i as ks}from"./nv8iokcz1qb8pmi8.js";function sa(s){return s==v.User||s==v.Group?v.Private:s==v.WorkspaceLink?v.Workspace:s}function ue(s,t){return s=sa(s),t===void 0?!1:t.some(a=>a.recipient===s&&a.allowed)}function Ls(s,t){return t===void 0?[]:(s=sa(s),t.find(n=>n.recipient===s)?.moderated_fields)}function cs(s,t){const a=Ls(s,t);return a&&a.length>0}const Ws=Re.a`bold underline`,Hn=Re.textarea`w-full text-sm overflow-y-auto rounded-lg border px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium bg-token-main-surface-primary h-32`;var ke=(s=>(s[s.None=0]="None",s[s.AppealAvailable=1]="AppealAvailable",s[s.AppealSent=2]="AppealSent",s))(ke||{}),ts=(s=>(s[s.None=0]="None",s[s.PublishBlocked=1]="PublishBlocked",s[s.RemovedFromMarketplace=2]="RemovedFromMarketplace",s[s.RemovedFromPublic=3]="RemovedFromPublic",s[s.RemovedFromPrivate=4]="RemovedFromPrivate",s[s.Recategorized=5]="Recategorized",s))(ts||{});function Vn(s){if(!s)return;const t=s.gizmo.appeal_info?.state.kind==="appeal_sent",a=Kn(s.gizmo.share_recipient,s.gizmo.sharing_targets);return{sharingRecipient:s.gizmo.share_recipient,categories:s.gizmo.categories,gizmoId:s.gizmo.id,moderationType:a,sharingTargets:s.gizmo.sharing_targets,showModal:t?2:a!==0?1:0}}const Ds={[v.User]:v.Private,[v.Group]:v.Private,[v.WorkspaceLink]:v.Workspace};function Kn(s,t=[]){const a=new Set(t.filter(r=>r.allowed).map(r=>r.recipient));if(!s||(s in Ds&&(s=Ds[s]),a.has(s)))return 0;const n=a.has(v.Private)||a.has(v.Workspace),i=a.has(v.Link)||a.has(v.Marketplace);return s===v.Marketplace&&i?2:!i&&n?3:4}function qs(s){switch(s){case 0:case 1:return $({id:"gizmo.appeals.publishBlockedTitle",defaultMessage:"Your changes couldn’t be published"});case 2:return $({id:"gizmo.appeals.removedFromMarketplaceTitle",defaultMessage:"Your GPT has been removed from the marketplace"});case 3:return $({id:"gizmo.appeals.removedFromPublicTitle",defaultMessage:"Your GPT has been removed from public view"});case 5:return $({id:"gizmo.appeals.recategorizedTitle",defaultMessage:"Your GPT has been recategorized"});default:Mt(s)}}function Yn(s){switch(s){case"profile_picture":return $({id:"gizmo.appeals.profilePictureFieldName",defaultMessage:"Profile Picture"});case"gizmo_name":return $({id:"gizmo.appeals.gizmoNameFieldName",defaultMessage:"Name"});case"gizmo_description":return $({id:"gizmo.appeals.gizmoDescriptionFieldName",defaultMessage:"Description"});case"gizmo_instructions":return $({id:"gizmo.appeals.gizmoInstructionsFieldName",defaultMessage:"Instructions"});case"gizmo_welcome_message":return $({id:"gizmo.appeals.gizmoWelcomeMessageFieldName",defaultMessage:"Welcome Message"});case"custom_actions":return $({id:"gizmo.appeals.customActionsFieldName",defaultMessage:"Custom Actions"});case"conversation_starter":return $({id:"gizmo.appeals.conversationStarterFieldName",defaultMessage:"Conversation Starter"});case"file":return $({id:"gizmo.appeals.fileFieldName",defaultMessage:"File"});case"gizmo_combined_content":return $({id:"gizmo.appeals.gizmoCombinedContentFieldName",defaultMessage:"Overall GPT Config"})}}function Qn(s){switch(s){case v.Private:case v.Workspace:return $({id:"gizmo.appeals.privateRecipientModerationText",defaultMessage:"Your GPT can’t be updated because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case v.Link:return $({id:"gizmo.appeals.linkRecipientModerationText",defaultMessage:"Your GPT can’t be shared publicly because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case v.Marketplace:return $({id:"gizmo.appeals.marketplaceRecipientModerationText",defaultMessage:"Your GPT can’t appear in the Explore GPTs page because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});default:Mt(s)}}function ta({sharingRecipient:s,moderatedFields:t,appealAvailable:a}){const n=t.length;return e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx(c,{...Qn(s),values:{usagePolicyLink:i=>e.jsx(Ws,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:i})}})," ",n>0&&e.jsx(c,{id:"gizmo.appeals.seeBelowForSpecificIssues",defaultMessage:`{numModeratedFields, plural,
              one {See below for the specific issue:}
              other {See below for the specific issues:}
            }`,values:{numModeratedFields:n}})]}),n>0&&t?.map(i=>e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold",children:e.jsx(c,{...Yn(i.name)})}),e.jsx("ul",{className:"list-disc pl-5",children:i.reasons.map(r=>e.jsxs("li",{children:[r.description," ",r.link?e.jsx(Ws,{href:r.link,target:"_blank",rel:"noreferrer",children:e.jsx(c,{id:"gizmo.appeals.learnMore",defaultMessage:"Learn more"})}):""]},r.description))})]})),a&&e.jsx("p",{children:e.jsx(c,{id:"gizmo.appeals.appealAvailableText",defaultMessage:"Alternatively you may appeal this decision and we will get back to you as soon as possible. Or you can publish to “Only me” and use this GPT privately."})})]})}function Xn({gizmoId:s,sharingRecipient:t,categories:a,moderationType:n,sharingTargets:i,appealAvailable:r,onClose:o,onAppealSubmitted:d}){const l=J(),[f,j]=h.useState(""),[u,p]=h.useState(0),m=ze(),x=async()=>{await Ie.postGizmoAppeal(m,s,f,t,a),p(2),d?.()},g=Ls(t,i),y=g?.length??0,w=Ae();if(y==0&&w?.isEnterprisey())return e.jsx(pe,{title:l.formatMessage(qs(n)),isOpen:!0,onClose:o,showCloseButton:!0,type:"warning",primaryButton:e.jsx(ye.Button,{color:"primary",onClick:o,children:e.jsx(c,{id:"wEsAOU",defaultMessage:"OK"})}),children:e.jsx("p",{className:"text-sm",children:e.jsx(c,{id:"gizmo.appeals.workspaceSettingsMessage",defaultMessage:"Access to your GPT has been reduced by your workspace's GPT sharing settings. An owner of the workspace can change these settings in the workspace settings page."})})});switch(u){case 0:return e.jsx(pe,{title:l.formatMessage(qs(n)),isOpen:!0,onClose:o,showCloseButton:!0,primaryButton:e.jsx(ye.Button,{color:"primary",onClick:o,children:e.jsx(c,{id:"gizmo.appeals.contunueButton",defaultMessage:"Continue"})}),secondaryButton:r?e.jsx(ye.Button,{onClick:()=>p(1),children:e.jsx(c,{id:"gizmo.appeals.appealButton",defaultMessage:"Appeal"})}):void 0,type:"warning",children:e.jsx("div",{className:"flex flex-col gap-2 text-sm",children:e.jsx(ta,{sharingRecipient:t,moderatedFields:g??[],appealAvailable:r})})});case 1:return e.jsx(pe,{title:l.formatMessage({id:"gizmo.appeals.appealModalTitle",defaultMessage:"Appeal"}),isOpen:!0,onClose:o,showCloseButton:!0,shouldIgnoreClickOutside:!0,primaryButton:e.jsx(ye.Button,{color:"primary",onClick:x,disabled:f.trim().length===0,children:e.jsx(c,{id:"gizmo.appeals.submitAppealButton",defaultMessage:"Submit"})}),secondaryButton:e.jsx(ye.Button,{onClick:()=>p(0),children:e.jsx(c,{id:"gizmo.appeals.backButton",defaultMessage:"Back"})}),type:"warning",children:e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsx("p",{children:e.jsx(c,{id:"gizmo.appeals.appealReasonText",defaultMessage:"Please provide a reason for why you believe this GPT doesn’t violate our policies and should be published"})}),e.jsx(Hn,{value:f,onChange:S=>j(S.target.value)})]})});case 2:return e.jsx(e.Fragment,{})}}function Jn({onClose:s}){const t=J();return e.jsx(pe,{title:t.formatMessage({id:"gizmo.appeals.appealSubmittedModalTitle",defaultMessage:"Appeal submitted"}),isOpen:!0,onClose:s,showCloseButton:!0,primaryButton:e.jsx(ye.Button,{color:"primary",onClick:s,children:e.jsx(c,{id:"gizmo.appeals.closeButton",defaultMessage:"Close"})}),type:"success",children:e.jsx("div",{className:"flex flex-col gap-2 text-sm",children:e.jsx("div",{children:e.jsx(c,{id:"gizmo.appeals.appealSubmittedText",defaultMessage:"Your appeal has been submitted. We will get back to you as soon as possible."})})})})}function Zn({gizmoId:s,onClose:t}){const{data:a}=$t(s,!0),n=ze(),i=async()=>{await Ie.postGizmoCancelAppeal(n,s)};return e.jsx(pe,{isOpen:!0,onClose:qe,primaryButton:e.jsx(ye.Button,{color:"primary",onClick:()=>{i(),t?.()},children:e.jsx(c,{id:"gizmo.appeals.cancelAppealButton",defaultMessage:"Cancel appeal"})}),type:"warning",children:e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsx("h2",{className:"text-lg font-semibold",children:e.jsx(c,{id:"gizmo.appeals.appealReviewingHeader",defaultMessage:"Reviewing your appeal"})}),e.jsx("p",{children:e.jsx(c,{id:"gizmo.appeals.appealSentModalText",defaultMessage:"During the review you can continue using “{gizmoName}” as your private GPT, but won’t be able to update it or share it with others.",values:{gizmoName:a?.gizmo.display.name}})})]})})}function ei({appealState:s,onAppealClose:t,onAppealSubmitted:a}){const{value:n}=Pe("4226692983"),[i,r]=h.useState(!1);return i?e.jsx(Jn,{onClose:()=>{r(!1),a?.()}}):e.jsxs(e.Fragment,{children:[s?.showModal==2&&e.jsx(Zn,{gizmoId:s.gizmoId,onClose:t}),s?.showModal==1&&e.jsx(Xn,{gizmoId:s.gizmoId,sharingRecipient:s.sharingRecipient,categories:s.categories,moderationType:s.moderationType,sharingTargets:s.sharingTargets,appealAvailable:n,onClose:()=>t?.(),onAppealSubmitted:()=>r(!0)})]})}function si({gizmoEditorData:s,onOpen:t}){const a=s?.tools?.find(r=>r.type===D.INTENT&&"prompt_config"in r.settings),[n]=h.useState(a?.settings.prompt_config??[]),[i]=h.useState(a?.settings.state_keys??[]);return e.jsxs(ne,{children:[e.jsx("div",{className:"text-sm",children:e.jsx(X,{label:"Blocks + State",description:"Blocks and State for your GPT"})}),e.jsxs("div",{className:"mb space-y-1",children:[!(n||i)&&e.jsx("div",{className:"flex text-token-text-primary",children:"Add prompt blocks and state keys to your GPT"}),e.jsx(le,{onClick:()=>t(),children:n||i?"Show Blocks & State":"Add Blocks & State"})]})]})}function ti({gizmoEditorData:s,updateGizmo:t,onClose:a}){const n=s?.tools?.find(u=>u.type===D.INTENT&&"prompt_config"in u.settings),[i,r]=h.useState(n?.settings.prompt_config??[]),[o,d]=h.useState(n?.settings.state_keys??[]),l={key_name:"",description:""},f={prompt_key:"",prompt:"",continuation:"",hidden:!1},j=()=>{t(u=>({...u,tools:n?u.tools.map(p=>p.type===D.INTENT?{...p,settings:{...p.settings,prompt_config:i,state_keys:o}}:p):[...u.tools,{type:D.INTENT,settings:{prompt_config:i,state_keys:o}}]}))};return e.jsxs("div",{className:"h-full overflow-auto px-4 pb-12 text-sm",children:[e.jsxs("div",{className:"relative flex flex-col items-center px-16 py-6 text-center",children:[e.jsx("div",{className:"absolute left-0 top-6",children:e.jsx(re,{color:"secondary",onClick:a,icon:vn})}),e.jsx("div",{className:"text-xl font-semibold",children:e.jsx(c,{id:"eIFoMg",defaultMessage:"Blocks & State"})}),e.jsx("div",{className:"text-sm text-token-text-tertiary",children:e.jsx(c,{id:"rdK8Dl",defaultMessage:"Construct your GPT with instruction blocks and state."})}),e.jsx(X,{label:e.jsx("div",{className:"text-sm font-semibold text-token-text-tertiary",children:"Learn more"}),description:e.jsxs("div",{className:"space-y-2 text-sm font-normal",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Blocks"})," allow you to break up your GPT's instructions into smaller sections, letting the GPT decide which to load up in what scenario."]}),e.jsxs("div",{children:[e.jsx("b",{children:"State"})," gives the GPT a per-user storage for data, that will be provided at the start of all new conversations."]})]})})]}),e.jsx(ne,{children:e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"mb-4 space-y-5 text-lg",children:[e.jsx(X,{label:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Instruction Blocks"}),e.jsx(js,{className:"icon-sm"})]}),description:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{children:"Instruction Blocks are added to the end of your GPT's instructions when the GPT decides to use them."}),e.jsx("div",{children:"The GPT only knows these blocks by their name. and your initial GPT instructions must describe how to use at least one of these blocks."})]})}),e.jsxs("div",{className:"space-y-5 text-sm",children:[i.map((u,p)=>e.jsx(ai,{promptKey:u.prompt_key,prompt:u.prompt,continuation:u.continuation,hidden:u.hidden,visible:!1,isDuplicate:i.filter(m=>m.prompt_key===u.prompt_key).length>1,onChange:({promptKey:m,prompt:x,continuation:g,hidden:y})=>{r(w=>{const b=[...w];return b[p]={prompt_key:m,prompt:x,continuation:g,hidden:y},b}),j()},onDelete:({promptKey:m})=>{r(x=>x.filter(g=>g.prompt_key!==m)),j()}},p)),e.jsx(le,{onClick:()=>{r(u=>[...u,f])},children:"Add Block"})]}),e.jsx(X,{label:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Saved State"}),e.jsx(js,{className:"icon-sm"})]}),description:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{children:"State the GPT can save per-user, that will be provided at the start of all new conversations"}),e.jsx("div",{children:"Your GPT has access to write to these state entries, and read from them."}),e.jsx("div",{children:"The user can see this data."})]})}),o.map((u,p)=>e.jsx(ni,{keyName:u.key_name,description:u.description,isDuplicate:o.filter(m=>m.key_name===u.key_name).length>1,onChange:({keyName:m,description:x})=>{d(g=>{const y=[...g];return y[p]={key_name:m,description:x},y}),j()},onDelete:({keyName:m})=>{d(x=>x.filter(g=>g.key_name!==m)),j()}},p))]}),e.jsx(le,{onClick:()=>{d(u=>[...u,l])},children:"Add State Data"})]})})]})}function ai({promptKey:s,prompt:t,continuation:a,hidden:n,visible:i,isDuplicate:r,onChange:o,onDelete:d}){h.useState(n);const[l,f]=h.useState(i),j=()=>{f(!l)},u=[];s.length>20&&u.push({msg:"Block names work best when they are short"}),r&&u.push({msg:"Block names must be unique"});const p=u.length>0?Ht:void 0;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex space-x-2 text-sm",children:[e.jsx(X,{collapsed:!l,label:"Block",onClick:j}),e.jsx(Qe,{name:"promptKey",value:s,onChange:m=>o({promptKey:m.target.value,prompt:t,continuation:a}),icon:p,className:"max-w-xs grow-0",placeholder:"Block name"})]}),u.map(m=>e.jsx("div",{className:"text-xs text-token-text-secondary",children:m.msg},m.msg)),l&&e.jsxs("div",{className:"mb-4 space-y-1",children:[e.jsx(Ra,{rows:5,name:"prompt",value:t,onChange:m=>o({promptKey:s,prompt:m.target.value,continuation:a}),className:"grow",placeholder:"Block Text"}),ii,e.jsx("div",{role:"button",className:"flex items-center space-x-2",onClick:()=>{d({promptKey:s})},children:e.jsx(ss,{className:"icon-sm"})})]})]})}function ni({keyName:s,description:t,isDuplicate:a,onChange:n,onDelete:i}){const r=[];s.length>20&&r.push({msg:"State names work best when they are short"}),a&&r.push({msg:"State names must be unique"});const o=r.length>0?Ht:void 0;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex space-x-2 text-sm",children:[e.jsx(Qe,{name:"key",value:s,onChange:d=>n({keyName:d.target.value,description:t}),icon:o,className:"max-w-xs grow-0",placeholder:"State Name"}),e.jsx(Qe,{name:"description",value:t,onChange:d=>n({keyName:s,description:d.target.value}),className:"max-w-s flex-grow",placeholder:"Description"}),e.jsx("div",{role:"button",className:"flex items-center space-x-2",onClick:()=>{i({keyName:s})},children:e.jsx(ss,{className:"icon-sm"})})]}),r.map(d=>e.jsx("div",{className:"text-xs text-token-text-secondary",children:d.msg},d.msg))]})}const ii=!1;function ri(s,t){for(var a=-1,n=s==null?0:s.length;++a<n&&t(s[a],a,s)!==!1;);return s}var oi=ri,li=ot,ci=xa;function di(s,t,a,n){var i=!a;a||(a={});for(var r=-1,o=t.length;++r<o;){var d=t[r],l=n?n(a[d],s[d],d,a,s):void 0;l===void 0&&(l=s[d]),i?ci(a,d,l):li(a,d,l)}return a}var as=di,ui=as,pi=lt;function mi(s,t){return s&&ui(t,pi(t),s)}var gi=mi,fi=as,xi=ct;function hi(s,t){return s&&fi(t,xi(t),s)}var vi=hi,Ze={exports:{}};Ze.exports;(function(s,t){var a=ha,n=t&&!t.nodeType&&t,i=n&&!0&&s&&!s.nodeType&&s,r=i&&i.exports===n,o=r?a.Buffer:void 0,d=o?o.allocUnsafe:void 0;function l(f,j){if(j)return f.slice();var u=f.length,p=d?d(u):new f.constructor(u);return f.copy(p),p}s.exports=l})(Ze,Ze.exports);var ji=Ze.exports,yi=as,bi=va;function ki(s,t){return yi(s,bi(s),t)}var wi=ki,Ti=as,Mi=ja;function _i(s,t){return Ti(s,Mi(s),t)}var Ni=_i,Si=Object.prototype,Pi=Si.hasOwnProperty;function Ci(s){var t=s.length,a=new s.constructor(t);return t&&typeof s[0]=="string"&&Pi.call(s,"index")&&(a.index=s.index,a.input=s.input),a}var Ii=Ci,Hs=ya;function Ai(s){var t=new s.constructor(s.byteLength);return new Hs(t).set(new Hs(s)),t}var Gs=Ai,Li=Gs;function Gi(s,t){var a=t?Li(s.buffer):s.buffer;return new s.constructor(a,s.byteOffset,s.byteLength)}var Ui=Gi,Ei=/\w*$/;function Ri(s){var t=new s.constructor(s.source,Ei.exec(s));return t.lastIndex=s.lastIndex,t}var zi=Ri,Vs=ba,Ks=Vs?Vs.prototype:void 0,Ys=Ks?Ks.valueOf:void 0;function Fi(s){return Ys?Object(Ys.call(s)):{}}var Oi=Fi,Bi=Gs;function $i(s,t){var a=t?Bi(s.buffer):s.buffer;return new s.constructor(a,s.byteOffset,s.length)}var Wi=$i,Di=Gs,qi=Ui,Hi=zi,Vi=Oi,Ki=Wi,Yi="[object Boolean]",Qi="[object Date]",Xi="[object Map]",Ji="[object Number]",Zi="[object RegExp]",er="[object Set]",sr="[object String]",tr="[object Symbol]",ar="[object ArrayBuffer]",nr="[object DataView]",ir="[object Float32Array]",rr="[object Float64Array]",or="[object Int8Array]",lr="[object Int16Array]",cr="[object Int32Array]",dr="[object Uint8Array]",ur="[object Uint8ClampedArray]",pr="[object Uint16Array]",mr="[object Uint32Array]";function gr(s,t,a){var n=s.constructor;switch(t){case ar:return Di(s);case Yi:case Qi:return new n(+s);case nr:return qi(s,a);case ir:case rr:case or:case lr:case cr:case dr:case ur:case pr:case mr:return Ki(s,a);case Xi:return new n;case Ji:case sr:return new n(s);case Zi:return Hi(s);case er:return new n;case tr:return Vi(s)}}var fr=gr,xr=dt,Qs=Object.create,hr=function(){function s(){}return function(t){if(!xr(t))return{};if(Qs)return Qs(t);s.prototype=t;var a=new s;return s.prototype=void 0,a}}(),vr=hr,jr=vr,yr=ka,br=wa;function kr(s){return typeof s.constructor=="function"&&!br(s)?jr(yr(s)):{}}var wr=kr,Tr=Ms,Mr=ut,_r="[object Map]";function Nr(s){return Mr(s)&&Tr(s)==_r}var Sr=Nr,Pr=Sr,Cr=mt,Xs=pt,Js=Xs&&Xs.isMap,Ir=Js?Cr(Js):Pr,Ar=Ir,Lr=Ms,Gr=ut,Ur="[object Set]";function Er(s){return Gr(s)&&Lr(s)==Ur}var Rr=Er,zr=Rr,Fr=mt,Zs=pt,et=Zs&&Zs.isSet,Or=et?Fr(et):zr,Br=Or,$r=Ta,Wr=oi,Dr=ot,qr=gi,Hr=vi,Vr=ji,Kr=Rn,Yr=wi,Qr=Ni,Xr=_a,Jr=Na,Zr=Ms,eo=Ii,so=fr,to=wr,ao=Sa,no=Ma,io=Ar,ro=dt,oo=Br,lo=lt,co=ct,uo=1,po=2,mo=4,aa="[object Arguments]",go="[object Array]",fo="[object Boolean]",xo="[object Date]",ho="[object Error]",na="[object Function]",vo="[object GeneratorFunction]",jo="[object Map]",yo="[object Number]",ia="[object Object]",bo="[object RegExp]",ko="[object Set]",wo="[object String]",To="[object Symbol]",Mo="[object WeakMap]",_o="[object ArrayBuffer]",No="[object DataView]",So="[object Float32Array]",Po="[object Float64Array]",Co="[object Int8Array]",Io="[object Int16Array]",Ao="[object Int32Array]",Lo="[object Uint8Array]",Go="[object Uint8ClampedArray]",Uo="[object Uint16Array]",Eo="[object Uint32Array]",L={};L[aa]=L[go]=L[_o]=L[No]=L[fo]=L[xo]=L[So]=L[Po]=L[Co]=L[Io]=L[Ao]=L[jo]=L[yo]=L[ia]=L[bo]=L[ko]=L[wo]=L[To]=L[Lo]=L[Go]=L[Uo]=L[Eo]=!0;L[ho]=L[na]=L[Mo]=!1;function Ye(s,t,a,n,i,r){var o,d=t&uo,l=t&po,f=t&mo;if(a&&(o=i?a(s,n,i,r):a(s)),o!==void 0)return o;if(!ro(s))return s;var j=ao(s);if(j){if(o=eo(s),!d)return Kr(s,o)}else{var u=Zr(s),p=u==na||u==vo;if(no(s))return Vr(s,d);if(u==ia||u==aa||p&&!i){if(o=l||p?{}:to(s),!d)return l?Qr(s,Hr(o,s)):Yr(s,qr(o,s))}else{if(!L[u])return i?s:{};o=so(s,u,d)}}r||(r=new $r);var m=r.get(s);if(m)return m;r.set(s,o),oo(s)?s.forEach(function(y){o.add(Ye(y,t,a,y,s,r))}):io(s)&&s.forEach(function(y,w){o.set(w,Ye(y,t,a,w,s,r))});var x=f?l?Jr:Xr:l?co:lo,g=j?void 0:x(s);return Wr(g||s,function(y,w){g&&(w=y,y=s[w]),Dr(o,w,Ye(y,t,a,w,s,r))}),o}var Ro=Ye,zo=Ro,Fo=1,Oo=4;function Bo(s){return zo(s,Fo|Oo)}var $o=Bo;const Se=Pa($o);function Wo(s,t){if(t==null)return s;function a(n){return typeof n=="object"&&n!=null?Array.isArray(n)?n.map(a):Object.fromEntries(Object.entries(n).map(([i,r])=>[i,a(r)])):n===null?void 0:n}return t=a(t),{...s,...t}}var ge=(s=>(s[s.Loading=0]="Loading",s[s.UploadingProfilePic=1]="UploadingProfilePic",s[s.GeneratingProfilePic=2]="GeneratingProfilePic",s[s.GizmoNameTooLong=3]="GizmoNameTooLong",s[s.GizmoDescriptionTooLong=4]="GizmoDescriptionTooLong",s[s.GizmoInstructionsTooLong=5]="GizmoInstructionsTooLong",s[s.NameEmpty=6]="NameEmpty",s[s.MissingPublicActionPrivacyPolicyURL=7]="MissingPublicActionPrivacyPolicyURL",s[s.MissingCategory=8]="MissingCategory",s))(ge||{});function ws(s){switch(s){case 0:return"Loading";case 1:return"Uploading profile picture";case 2:return"Generating profile picture";case 3:return"GPT name too long";case 4:return"GPT description too long";case 5:return"GPT instructions too long";case 6:return"GPT name cannot be empty";case 7:return"Public actions require valid privacy policy URLs";case 8:return"Public GPTs must have a category"}}function Do(s){return s==="link"||s==="marketplace"}function qo(s){try{return new URL(s),!0}catch{return!1}}function We(s,t,a){const n=s.name.length>_t,i=(s.description?.length??0)>Nt,r=(s.instructions?.length??0)>St,o=[];if(s?.name===""&&o.push(6),n&&o.push(3),i&&o.push(4),r&&o.push(5),t!=null&&Do(t)){const d=s.tools?.filter(l=>l.type===D.JIT_PLUGIN);for(const l of d){const f=l.metadata?.privacy_policy_url;if(f==null||!qo(f)){o.push(7);break}}}return t===v.Marketplace&&a==null&&o.push(8),o}const ra=Fe(()=>Oe(()=>import("./b6m8ik9775mnmzod.js"),__vite__mapDeps([0,1,2,3])).then(s=>s.DirectorySyncResourceManagedIndication)),Ho=[se,Ve];function Vo(s,t){return s.type===z.USER?s.user_id===t.user_id:s.type===z.GROUP?s.group_id===t.group_id:s.type===t.type}const Ko={[z.USER]:v.User,[z.GROUP]:v.Group,[z.WORKSPACE]:v.Workspace,[z.ALL]:v.Marketplace};function oa(s){const t=Ko[s.type];if(!t)throw new Error("Unknown sharing subject type: "+s.type);return{...s,type:t}}function Yo({gizmo:s,publishedGizmo:t,updateGizmo:a,promoteGizmo:n,appealGizmo:i,setAppealState:r,showActionsModal:o,shareOnly:d,onClose:l,workspaceOwner:f=!1}){const j=J(),u=fe(),p=Ae(),m=p?.data?.name??"your workspace",x=Pt(),g=Wt(),[y,w]=h.useState(void 0);h.useEffect(()=>{if(y==null)if(t?.gizmo.display.categories&&t?.gizmo.display.categories.length>0){const k=g.data?.categories.find(A=>A.id===t?.gizmo.display.categories[0]);k&&w(k)}else g.data!=null&&w(g.data.categories[g.data.categories.length-1])},[g.data,y,t]);const[b,S]=h.useState(s.sharingRecipient??v.Private),[C,U]=h.useState(s.sharing?.subjects??[]),[T,G]=h.useState(null),[O,_]=h.useState(!1),P=h.useCallback(()=>!be(s.sharing?.subjects,C)||s.sharingRecipient!==b,[s.sharing,s.sharingRecipient,b,C]),E=ze(),q=We(s,b,y?.id??void 0),K=q.includes(ge.MissingPublicActionPrivacyPolicyURL),B=s.tools.find(k=>k.type===D.JIT_PLUGIN&&!k.metadata.privacy_policy_url);if(T)return e.jsx(ca,{publishedGizmo:T,sharing:{recipient:b,subjects:C},workspaceName:m,onClose:l});function V(k){C.find(A=>Vo(A,k))||U([...C,k])}const ae=Ct(C);function ve(k){const A=C.filter(ee=>[z.WORKSPACE,z.ALL].indexOf(ee.type)===-1);k!=null&&A.push(k),U(A)}function te(k){switch(S(k),k){case v.Marketplace:case v.Link:ve({type:z.ALL,capabilities:se});break;case v.Workspace:case v.WorkspaceLink:ve({type:z.WORKSPACE,capabilities:se});break;default:ve(null)}}function M(k){ae!=null&&U(C.map(A=>A===ae?{...A,capabilities:k}:A))}function H(k,A,ee){return k.type===z.USER&&k.user_id.indexOf("__")===-1?{...k,user_id:k.user_id+"__"+p?.getWorkspaceId()}:k}async function ns(k,A){if(O)return;if(k&&!A)throw new Error("Cannot share a gizmo that hasn't been promoted before");if(!y)return;_(!0);let ce=C.map(H).map(oa);if(ce=Ue(b,ce,ae?.capabilities??se),f)return!p||!A?(u.warning("Unable to change sharing settings"),l()):(await Be.updateWorkspaceGPTSharing(p.id,A,ce),u.success(j.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),E.invalidateQueries({queryKey:["workspace"]}),l());if(k){if(!A||!t)throw new Error("No gizmo ID to share");try{const Z={sharing:ce};y&&(Z.categories=[y.id]);const Me=await Ie.shareGizmo(A,Z);Me.error?cs(b,Me.sharing_targets)?(r({gizmoId:t.gizmo.id,sharingRecipient:b,categories:t.gizmo.display.categories,moderationType:ts.PublishBlocked,sharingTargets:Me.sharing_targets,showModal:ke.AppealAvailable}),l()):u.warning(j.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})):(E.setQueryData(["gizmo",{gizmoId:t.gizmo.id},{draft:!1}],Ge=>Me.resource),a(Ge=>({...Ge,sharingRecipient:b})),u.success(j.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),l())}catch{return u.warning(j.formatMessage({id:"dKC65l",defaultMessage:"Failed to update sharing settings"})),l()}}else{const Z=await n({subjects:ce,recipient:b},y.id);A||(A=Z?.gizmo.id),G(Z??null),a({liveVersion:Z?.gizmo.live_version??void 0}),E.invalidateQueries({queryKey:["gizmo",{gizmoId:A}]})}_(!1),E.invalidateQueries({queryKey:["gizmos"]}),E.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:A}]}),E.invalidateQueries({queryKey:["workspace"]}),a({sharing:{recipient:b,subjects:C},sharingRecipient:b},!1)}return e.jsx(pe,{type:"success",className:"max-w-[555px]",size:"custom",isOpen:!0,onClose:l,primaryButton:cs(b,s.sharingTargets)?e.jsx(re,{onClick:()=>i(b,y?.id),children:e.jsx(c,{id:"HRzqKK",defaultMessage:"Appeal"})}):e.jsx(re,{onClick:()=>ns(d,t?.gizmo.id),loading:O,disabled:q.length>0||!ue(b,s.sharingTargets),children:d?e.jsx(c,{id:"BEKjVh",defaultMessage:"Save"}):e.jsx(c,{id:"24j5ts",defaultMessage:"Update"})}),secondaryButton:e.jsxs(e.Fragment,{children:[P()&&e.jsx("div",{className:"absolute bottom-8 left-6 text-sm text-token-text-secondary",children:e.jsx(c,{id:"9CkgC4",defaultMessage:"Unsaved changes"})}),t&&e.jsx(re,{color:"secondary",onClick:k=>$e(t,u,k,j.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(c,{id:"wvL15a",defaultMessage:"Copy link"})})]}),title:j.formatMessage({id:"7JggXH",defaultMessage:"Share GPT"}),showCloseButton:!0,children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx(Xo,{onAdd:k=>V(k),publishedGizmo:t}),e.jsx("h3",{className:"text-base font-semibold",children:e.jsx(c,{id:"bNQXcV",defaultMessage:"Share with..."})}),e.jsxs("div",{className:"max-h-[200px] space-y-2 overflow-y-auto",children:[e.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[e.jsx("div",{className:"shrink-0 grow-0 self-start",children:e.jsx(za,{user:x,size:"gizmoConversation",roundedStyle:"rounded-full"})}),e.jsx("div",{className:"grow",children:!t||Jo(t?.gizmo.author.user_id.split("__")[0],x?.id)?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-base font-semibold",children:e.jsx(c,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:x?.name}})}),e.jsx("span",{className:"-mt-1 text-sm text-token-text-secondary",children:x?.email})]}):e.jsx("span",{className:"text-base font-semibold",children:e.jsx(c,{id:"scRZqV",defaultMessage:"{userName} (builder)",values:{userName:t?.gizmo.author.display_name}})})})]}),C.map((k,A)=>xs(k)&&e.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[e.jsx(Fa,{name:k.type===z.GROUP?k.group_name:`${k.user_name} ${k.user_email}`,initialsCount:k.type===z.USER?2:1,size:"gizmoConversation",className:oe("shrink-0 grow-0",k.type===z.USER&&"self-start")}),e.jsxs("div",{className:"flex grow flex-col",children:[e.jsxs("span",{className:"flex flex-row",children:[e.jsx("span",{className:"mr-2 text-base font-semibold",children:k.type===z.GROUP?k.group_name:k.user_name}),k.type===z.GROUP&&k.is_scim_managed&&e.jsx(ra,{})]}),k.type===z.USER&&e.jsx("span",{className:"-mt-1 text-sm text-token-text-secondary",children:k.user_email})]}),e.jsxs(F.Root,{children:[e.jsxs(F.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[e.jsx(c,{...we(k.capabilities)}),e.jsx(ys,{className:"icon-md"})]}),e.jsx(F.Portal,{children:e.jsxs(F.Content,{className:"max-w-[280px]",children:[Ho.map((ee,ce)=>e.jsx(ds,{caps:ee,selected:be(ee,k.capabilities),onClick:()=>{U(C.map(Z=>Z===k?{...Z,capabilities:ee}:Z))}},ce)),e.jsx(F.Separator,{}),e.jsx(F.Item,{onClick:()=>U(C.filter(ee=>ee!==k)),color:"danger",icon:ss,children:e.jsx(c,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},A))]}),e.jsx("hr",{className:"border-token-border-medium"}),e.jsx("h3",{className:"text-base font-semibold",children:e.jsx(c,{id:"uqD7Y8",defaultMessage:"Access"})}),e.jsxs("div",{className:"-ms-3.5 flex flex-row items-center justify-between space-x-3",children:[e.jsxs(W.Root,{value:b,onValueChange:k=>te(k),children:[e.jsxs(W.Trigger,{children:[e.jsx(W.Value,{}),e.jsx(W.Icon,{})]}),e.jsx(W.Portal,{children:e.jsxs(W.Content,{children:[e.jsxs(W.Group,{children:[e.jsx(W.Label,{children:e.jsx(c,{id:"YIQwaP",defaultMessage:"Private"})}),e.jsx(W.Item,{value:v.Private,children:e.jsx(Ne,{shareLevel:v.Private,workspaceName:m})})]}),e.jsx(W.Separator,{}),e.jsx(hs,{label:j.formatMessage({id:"n0m61x",defaultMessage:"Your workspace has disabled sharing with the workspace."}),side:"bottom",disabled:ue("workspace",s.sharingTargets),children:e.jsxs(W.Group,{children:[e.jsx(W.Label,{children:m}),e.jsx(W.Item,{value:v.WorkspaceLink,disabled:!ue(v.WorkspaceLink,s.sharingTargets)&&!ue(v.Workspace,s.sharingTargets),children:e.jsx(Ne,{shareLevel:v.WorkspaceLink,workspaceName:m})}),e.jsx(W.Item,{value:v.Workspace,disabled:!ue("workspace",s.sharingTargets),children:e.jsx(Ne,{shareLevel:v.Workspace,workspaceName:m})})]})}),e.jsx(W.Separator,{}),e.jsx(hs,{label:j.formatMessage({id:"IHnort",defaultMessage:"Your workspace has disabled public sharing."}),side:"bottom",disabled:ue("marketplace",s.sharingTargets),children:e.jsxs(W.Group,{children:[e.jsx(W.Label,{children:e.jsx(c,{id:"PjY9bi",defaultMessage:"Public"})}),e.jsx(W.Item,{value:v.Link,disabled:!ue("link",s.sharingTargets),children:e.jsx(Ne,{shareLevel:v.Link,workspaceName:m})}),e.jsx(W.Item,{disabled:!ue("marketplace",s.sharingTargets),value:v.Marketplace,children:e.jsx(Ne,{shareLevel:v.Marketplace,workspaceName:m})})]})})]})})]}),b!==v.Private&&b!==v.User&&e.jsxs(F.Root,{children:[e.jsxs(F.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[ae==null?e.jsx(c,{...we(se)}):e.jsx(c,{...we(ae.capabilities)}),e.jsx(ys,{className:"icon-md"})]}),e.jsx(F.Portal,{children:e.jsxs(F.Content,{className:"max-w-[280px]",children:[e.jsx(ds,{onClick:()=>M(se),caps:se,selected:be(ae?.capabilities,se)}),b!==v.Marketplace&&b!==v.Link&&e.jsx(ds,{onClick:()=>M(Ve),caps:Ve,selected:be(ae?.capabilities,Ve)})]})})]})]}),K&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(c,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:k=>e.jsx("button",{onClick:()=>{o(B?.metadata.action_id),l()},className:"underline",children:k})}})}),(b===v.Marketplace||b===v.Workspace)&&(ue(b,s.sharingTargets)?e.jsx(Us,{gizmo:s,category:y?.id,categories:g.data?.categories,onCategoryChange:k=>w(k)}):cs(b,s.sharingTargets)?e.jsx("div",{className:"pb-2 text-xs text-red-500",children:e.jsx(ta,{sharingRecipient:b,moderatedFields:Ls(b,s.sharingTargets)??[],appealAvailable:!0})}):e.jsx("div",{className:"pb-2 text-xs text-red-500",children:e.jsx(c,{id:"BzqqKH",defaultMessage:"Your workspace's settings don't allow this level of access. An owner of the workspace can change this setting in the workspace's GPTs settings."})}))]})})}const la=he({private:{id:"pSXBWQ",defaultMessage:"Invite-only"},user:{id:"pSXBWQ",defaultMessage:"Invite-only"},group:{id:"pSXBWQ",defaultMessage:"Invite-only"},workspace_link:{id:"Giaxt1",defaultMessage:"Anyone at {workspaceName} with the link"},workspace:{id:"XLHaTU",defaultMessage:"{workspaceName}"},link:{id:"uP1+Ri",defaultMessage:"Anyone with the link"},marketplace:{id:"82Ilac",defaultMessage:"GPT Store"}}),Qo=he({workspace:{id:"1kpopF",defaultMessage:"Published to {workspaceName}"},marketplace:{id:"hdTRpJ",defaultMessage:"Published to GPT Store"}});function we(s){return s.can_write?$({id:"SubCqD",defaultMessage:"Can edit"}):s.can_view_config?$({id:"ud3lp4",defaultMessage:"Can view configuration"}):s.can_read?$({id:"/0j34W",defaultMessage:"Can chat"}):$({id:"x2E8ET",defaultMessage:"Unknown"})}function ds({caps:s,selected:t,onClick:a}){let n=jn;return s.can_view_config?n=yn:s.can_read&&(n=bn),e.jsx(F.Item,{className:"flex h-auto flex-row items-start space-x-3 px-3 py-3",onClick:a,icon:n,children:s.can_write?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex grow flex-col",children:e.jsx("span",{className:"text-base font-semibold leading-tight",children:e.jsx(c,{...we(s)})})}),e.jsx(Ke,{className:oe("icon-lg shrink-0",!t&&"invisible")})]}):s.can_view_config?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex grow flex-col",children:[e.jsx("span",{className:"align-baseline text-base font-semibold leading-tight",children:e.jsx(c,{...we(s)})}),e.jsx("span",{className:"text-xs text-token-text-secondary",children:e.jsx(c,{id:"fL1rWw",defaultMessage:"View configuration settings, duplicate, and chat"})})]}),e.jsx(Ke,{className:oe("icon-lg shrink-0",!t&&"invisible")})]}):s.can_read?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex grow flex-col",children:[e.jsx("span",{className:"text-base font-semibold leading-tight",children:e.jsx(c,{...we(s)})}),e.jsx("span",{className:"text-xs text-token-text-secondary",children:e.jsx(c,{id:"tx5q1o",defaultMessage:"Users can only chat with this GPT"})})]}),e.jsx(Ke,{className:oe("icon-lg shrink-0",!t&&"invisible")})]}):null})}const es={private:os,user:os,group:os,workspace_link:Je,workspace:Vt,link:Je,marketplace:Kt};function Ne({shareLevel:s,workspaceName:t,hasInviteSharing:a=!0}){(s===v.User||s===v.Group)&&(s=v.Private);const n=es[s];return e.jsxs("div",{className:"flex flex-row items-center gap-3 text-base",children:[e.jsx(n,{className:"icon-lg"}),e.jsx("div",{className:"line-clamp-1 pt-px text-start font-semibold",children:!a&&s===v.Private?e.jsx(c,{id:"vVJhYB",defaultMessage:"Only me"}):e.jsx(c,{...la[s],values:{workspaceName:t}})})]})}function ca({publishedGizmo:s,sharing:t,workspaceName:a,onClose:n}){const i=t.recipient,r=es[i],o=J(),d=fe();return e.jsxs(pe,{isOpen:!0,onClose:n,showCloseButton:!0,className:"w-[304px]",title:e.jsx(c,{id:"5CEceY",defaultMessage:"GPT Updated"}),primaryButton:e.jsx(re,{onClick:()=>{window.location.href=`/g/${s.gizmo.id}`},children:e.jsx(c,{id:"RF75o5",defaultMessage:"View GPT"})}),secondaryButton:e.jsx(re,{color:"secondary",onClick:l=>$e(s,d,l,o.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(c,{id:"9hLOl9",defaultMessage:"Copy link"})}),type:"success",children:[e.jsx(Us,{gizmo:{profilePictureUrl:s.gizmo.display.profile_picture_url??void 0,name:s.gizmo.display.name}}),t.subjects.filter(l=>xs(l)).length>0&&e.jsxs("div",{className:"my-4",children:[e.jsx("h4",{className:"text-xs font-semibold text-token-text-secondary",children:e.jsx(c,{id:"/paYH9",defaultMessage:"Shared with"})}),t.subjects&&t.subjects.map((l,f)=>xs(l)&&e.jsxs("div",{className:"flex flex-row items-center justify-between space-x-3 py-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:l.type===z.GROUP?l.group_name:l.user_name}),l.type===z.USER&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:l.user_email})]})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{...we(l.capabilities)})})]},f))]}),e.jsxs("div",{className:"my-4",children:[e.jsx("h4",{className:"text-xs font-semibold text-token-text-secondary",children:e.jsx(c,{id:"q9XNZ7",defaultMessage:"Access"})}),e.jsxs("div",{className:"ml-[3px] flex flex-row items-center py-3 text-left text-base font-semibold",children:[e.jsx(r,{className:"md:icon-lg mr-3 h-6 w-6 shrink-0"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{...Qo[i]??la[i],values:{workspaceName:a}})}),(i===v.Workspace||i===v.Marketplace)&&e.jsx("span",{className:"text-xs text-token-text-secondary"})]})]})]})]})}function Us({gizmo:s,category:t,categories:a,onCategoryChange:n}){const{data:i,isLoading:r}=Dt(),o=a?.find(d=>d.id===t);return e.jsxs("div",{children:[e.jsxs("div",{className:oe("mb-[1px] flex flex-row items-center space-x-2 bg-token-main-surface-secondary p-4",r&&"invisible",a?"rounded-t-lg":"rounded-lg"),children:[e.jsx(Is,{isFirstParty:!1,className:"h-11 w-11",src:s.profilePictureUrl}),e.jsxs("div",{className:"flex grow flex-col space-y-0",children:[e.jsx("span",{className:"text-base font-semibold",children:s.name}),e.jsx(On,{builderName:i?.display_name,builderUrl:i?.website_url,socials:[i?.socials.linkedin,i?.socials.github,i?.socials.twitter].filter(d=>d!=null),className:"text-xs text-token-text-secondary"})]})]}),a&&e.jsxs("div",{className:"flex min-h-[56px] flex-row items-center justify-between space-x-2 rounded-b-lg bg-token-main-surface-secondary px-4 text-base",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"JcA4/t",defaultMessage:"Category"})}),e.jsx("div",{className:"text-token-text-secondary",children:n?e.jsx(As,{size:"small",triggerButton:e.jsxs("button",{className:"flex items-center gap-1",children:[o?.title,e.jsx(ys,{className:"icon-md"})]}),children:a.map((d,l)=>e.jsx(F.Item,{onClick:()=>n(d),children:d.title},l))}):e.jsx("span",{className:"text-token-text-secondary",children:o?.title})})]})]})}const st=Re.li`flex flex-col rounded-sm p-1 hover:bg-token-main-surface-secondary`;function Xo({onAdd:s,publishedGizmo:t}){const a=J(),n=Ae(),[i,r]=h.useState(""),d=Oa(n?.id,0,i,5).data?.items.filter(x=>x.id!==t?.gizmo.author.user_id.split("__")[0]),{data:l}=Ca({queryKey:[n?.id,"groups","filtered",i],queryFn:()=>Be.getWorkspaceGroups(n.id,{query:i,orderby:"@score"}),enabled:i.trim()!==""&&n!=null&&!!n.getWorkspaceId()}),f=(d?.length??0)>0||(l?.items.length??0)>0,[j,u]=h.useState(!1);function p(x,g,y){s({type:z.GROUP,group_id:x,group_name:g,capabilities:{...se},is_scim_managed:y}),r("")}function m(x,g,y){n&&(s({type:z.USER,user_id:x+"__"+n.getWorkspaceId(),user_name:g,user_email:y,capabilities:{...se}}),r(""))}return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex w-full flex-row space-x-3",children:e.jsxs($s,{as:"div",className:"group relative z-10 grow",children:[e.jsx(Qe,{list:"suggested-choices",name:"share-with-input",placeholder:n?.isEnterprisey()?a.formatMessage({id:"xy/AMO",defaultMessage:"Add people and groups from your workspace"}):a.formatMessage({id:"Lh9njB",defaultMessage:"Add people from your workspace"}),value:i,onChange:x=>r(x.target.value),onFocus:()=>u(!0),onBlur:()=>u(!1)}),e.jsx(Fn,{show:i.trim()!==""&&f&&j,children:e.jsx($s.Panel,{static:!0,className:"absolute top-8 ml-0 w-full cursor-pointer overflow-y-auto rounded-lg rounded-t-none border border-t-0 border-token-border-light bg-token-main-surface-primary px-1 py-1 group-has-[:focus]:border-token-border-xheavy",children:i.trim()!==""&&e.jsxs("ul",{id:"suggested-choices",children:[d&&d.map(x=>e.jsxs(st,{tabIndex:0,className:"rounded-sm p-1 text-sm hover:bg-token-main-surface-secondary",onClick:()=>m(x.id,x.name,x.email??""),children:[e.jsx("span",{className:"w-full font-semibold",children:x.name}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:x.email})]},x.id)),l?.items&&l.items.slice(0,5).map(x=>e.jsx(st,{tabIndex:0,onClick:()=>p(x.id,x.name,x.is_scim_managed??!1),children:e.jsxs("span",{className:"flex flex-col",children:[e.jsxs("span",{className:"flex flex-row",children:[e.jsx("span",{className:"mr-2 font-semibold",children:x.name}),x.is_scim_managed&&e.jsx(ra,{})]}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:e.jsx(c,{id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}",values:{numMembers:x.num_members}})})]})},x.id))]})})})]})})})}function Jo(s,t){return s===void 0||t===void 0?!1:s.split("__")[0]===t.split("__")[0]}function Zo({gizmo:s,updateGizmo:t,publishedGizmo:a,promoteGizmo:n,appealGizmo:i,setAppealState:r,showActionsModal:o,shareOnly:d,onClose:l}){const[f,j]=h.useState({type:"privacy"});return f.type==="privacy"?e.jsx(sl,{gizmo:s,updateGizmo:t,publishedGizmo:a,promoteGizmo:n,appealGizmo:i,setAppealState:r,setStep:j,showActionsModal:o,shareOnly:d,onClose:l}):e.jsx(tl,{publishedGizmo:f.publishedGizmo,onClose:l})}function el(s){return s?v.Workspace:v.Link}function sl({gizmo:s,publishedGizmo:t,updateGizmo:a,promoteGizmo:n,appealGizmo:i,setAppealState:r,setStep:o,showActionsModal:d,shareOnly:l,onClose:f}){const[j,u]=h.useState(!1),p=Xe(It.isBusinessWorkspace),m=J(),x=fe(),[g,y]=h.useState(Cs(s)?el(!!p):s.sharingRecipient),w=ze(),b=ue(g,s.sharingTargets),{data:S,isLoading:C}=Dt(),U=Wt(),[T,G]=h.useState(t!=null&&t.gizmo.display.categories.length>0?U.data?.categories.find(M=>M.id===t.gizmo.display.categories[0])?.id:void 0);h.useEffect(()=>{G(t?.gizmo.display.categories[0])},[t?.gizmo.display.categories]);const[O,_]=h.useState(void 0),P=h.useRef(Ba((M,H)=>Ie.generateCategory(M,H),1e3)),E=S?.is_verified?void 0:m.formatMessage({id:"qEQtmt",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile."});g===v.Marketplace&&E!=null&&!C&&y(v.Link);const q=p&&!s.sharingTargets?.some(M=>M.recipient===v.Link),K=We(s,g,T),B=K.includes(ge.MissingPublicActionPrivacyPolicyURL),V=s.tools.find(M=>M.type===D.JIT_PLUGIN&&!M.metadata.privacy_policy_url),ae=Xe(M=>M.currentWorkspace),ve=gt();h.useEffect(()=>{let M=!0;return(async()=>{try{if(T!=null)return;const H=await P.current(s.name,s.instructions);M&&T==null&&(H?G(H.id):_(!0))}catch{M&&T==null&&_(!0)}})(),()=>{M=!1}},[s.instructions,s.name,ve,T]);const{value:te}=Pe("4226692983");return e.jsx(pe,{type:"success",isOpen:!0,onClose:f,title:e.jsx(c,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:b?e.jsx(re,{color:"primary",disabled:K.length>0,loading:j,onClick:async()=>{try{if(u(!0),l){if(!t?.gizmo.id){x.danger(m.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}));return}const M=await Ie.shareGizmo(t.gizmo.id,T?{sharing:Ue(g,[],se),categories:[T]}:{sharing:Ue(g,[],se)});M.error?(x.warning(m.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),a({sharingTargets:M.sharing_targets}),r({gizmoId:t.gizmo.id,sharingRecipient:g,categories:t.gizmo.display.categories,moderationType:ts.PublishBlocked,sharingTargets:M.sharing_targets,showModal:ke.AppealAvailable})):(w.setQueryData(["gizmo",{gizmoId:t.gizmo.id},{draft:!1}],H=>M.resource),a(H=>({...H,sharingRecipient:g})),x.success(m.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),f())}else{const M=await n({recipient:g,subjects:Ue(g,[],se)},T);M?(o({type:"published",publishedGizmo:M}),a(H=>({...H,id:M.gizmo.id,sharingRecipient:g})),M.gizmo.live_version!=null&&a({liveVersion:M.gizmo.live_version}),x.success(m.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}),{testId:"gpt-published-toast"})):(x.warning(m.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),f())}}finally{u(!1)}},"data-testid":"save-gizmo-button",children:e.jsx(c,{id:"SW4DG4",defaultMessage:"Save"})}):te?e.jsx(e.Fragment,{children:e.jsx(re,{color:"primary",onClick:async()=>{await i(g,T)},children:e.jsx(c,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:t?e.jsx(re,{color:"secondary",onClick:M=>$e(t,x,M,m.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(c,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:e.jsxs("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[e.jsx("div",{className:"space-y-1.5",children:e.jsxs(At,{value:g,onValueChange:M=>y(M),children:[s.sharingTargets&&s.sharingTargets.map((M,H)=>e.jsx(us,{value:M.recipient,disabled:M.recipient===v.Marketplace&&E!=null,tooltipText:M.recipient===v.Marketplace?E??m.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:M.recipient},H)),q&&e.jsxs(e.Fragment,{children:[e.jsx(us,{value:v.Link,disabled:!0,tooltipText:m.formatMessage(tt.workspaceDisabledHint),shareLevel:v.Link,workspaceName:ae?.name}),e.jsx(us,{value:v.Link,disabled:!0,tooltipText:m.formatMessage(tt.workspaceDisabledHint),shareLevel:v.Marketplace,workspaceName:ae?.name})]})]})}),B&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(c,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:M=>e.jsx("button",{onClick:()=>{d(V?.metadata.action_id)},className:"underline",children:M})}})}),g!==v.Private&&e.jsx(Us,{gizmo:s,category:T,categories:g===v.Marketplace?U.data?.categories??[]:void 0,onCategoryChange:g===v.Marketplace?M=>G(M.id):void 0}),g===v.Marketplace&&(O?e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(c,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!b&&te&&e.jsx("div",{className:"flex items-center justify-between text-sm text-token-text-secondary",children:e.jsx(c,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function tl({publishedGizmo:s,onClose:t}){const a=Bn(s),n=J(),i=fe();return e.jsx(pe,{type:"success",isOpen:!0,onClose:t,title:e.jsx(c,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:e.jsx(re,{color:"primary",as:"link",to:a,children:e.jsx(c,{id:"lyZz44",defaultMessage:"View GPT"})}),children:e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex gap-1 rounded bg-token-main-surface-secondary px-2 py-1",children:[e.jsx("div",{className:"line-clamp-1 text-ellipsis break-all",children:a}),e.jsx("button",{onClick:r=>{$e(s,i,r,n.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary transition hover:text-token-text-primary","data-testid":"copy-saved-gpt-url-button",children:e.jsx(Yt,{className:"icon-sm"})})]})})})}const tt=he({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function us({shareLevel:s,workspaceName:t,value:a,disabled:n=!1,tooltipText:i}){const r=h.useId();return e.jsx(hs,{disabled:i==null,label:i,side:"top",children:e.jsxs(Lt,{id:r,value:a,disabled:n,className:"flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold hover:bg-token-main-surface-secondary",children:[e.jsx("label",{htmlFor:r,className:"flex cursor-pointer items-center gap-1",children:e.jsx(Ne,{shareLevel:s,workspaceName:t??"",hasInviteSharing:!1})}),e.jsx($a,{children:e.jsx(Ke,{className:"icon-lg mr-1"})})]})})}function da(s){window.history.length>1?s(-1):s(dn())}function al({gizmo:s,publishedGizmo:t,isLoading:a,isUploadingProfilePic:n,isGeneratingProfilePic:i,updateGizmo:r,promoteGizmo:o,appealGizmo:d,setAppealState:l,showActionsModal:f}){const j=Ae(),u=s!=null?We(s):[];(s==null||a)&&u.push(ge.Loading),n&&u.push(ge.UploadingProfilePic),i&&u.push(ge.GeneratingProfilePic);const p=Cs(s),[m,x]=h.useState(!1),[g,y]=h.useState(!1),w=s.sharingRecipient?es[s.sharingRecipient]:es.private;return e.jsxs(e.Fragment,{children:[p?e.jsx(le,{color:"primary",onClick:()=>x("promote"),loading:a,disabled:s.id===void 0||u.length>0,tooltip:u.length>0?u.map(ws).join(`
`):void 0,testId:"gizmo-editor-create-gpt-button",children:e.jsx(c,{id:"svUGIb",defaultMessage:"Create"})}):e.jsxs(e.Fragment,{children:[e.jsxs(le,{color:"secondary",loading:a||!t,onClick:()=>x("share"),children:[e.jsx(w,{className:"icon-sm shrink-0"}),e.jsx(c,{id:"aXKW4G",defaultMessage:"Share"})]}),e.jsx(le,{color:"primary",onClick:async()=>{let b=s.sharing.subjects.map(oa);const S=Ct(s.sharing.subjects);b=Ue(s.sharing.recipient,b,S?.capabilities??se),await o({recipient:s.sharing.recipient,subjects:b},t?.gizmo.display.categories[0])&&y(!0)},loading:a||!t,disabled:u.length>0,tooltip:u.length>0?u.map(ws).join(`
`):void 0,children:e.jsx(c,{id:"84QVoj",defaultMessage:"Update"})})]}),m&&(j?.getWorkspaceId()==null?e.jsx(Zo,{gizmo:s,publishedGizmo:t,promoteGizmo:o,appealGizmo:d,setAppealState:l,showActionsModal:f,updateGizmo:r,shareOnly:m==="share",onClose:()=>x(!1)}):e.jsx(Yo,{gizmo:s,publishedGizmo:t,promoteGizmo:o,appealGizmo:d,setAppealState:l,showActionsModal:f,updateGizmo:r,onClose:()=>x(!1),shareOnly:m==="share"})),g&&e.jsx(ca,{publishedGizmo:t,sharing:t.gizmo.sharing,onClose:()=>y(!1),workspaceName:j?.data.name??""})]})}function nl({gizmoEditorData:s,publishedGizmo:t,revertDraft:a}){const n=J(),i=fe(),r=_s(),[o,d]=h.useState(!1),l=gt(),{value:f}=Pe("3645668434");return!l?.includes("debug")&&s?.id==null?null:e.jsxs(e.Fragment,{children:[e.jsxs(As,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:e.jsx(le,{color:"ghost",icon:kn}),children:[t!=null&&e.jsxs(F.Item,{onClick:j=>{$e(t,i,j)},children:[e.jsx(Je,{className:"icon-sm"}),e.jsx(c,{...xe.copyLink})]}),a!=null&&e.jsxs(F.Item,{onClick:()=>{window.confirm(n.formatMessage(xe.revertConfirm))&&a()},children:[e.jsx(wn,{className:"icon-sm"}),e.jsx(c,{id:"W2blnV",defaultMessage:"Revert..."})]}),s?.id!=null&&f&&s.liveVersion>0&&e.jsxs(e.Fragment,{children:[e.jsxs(F.Item,{onClick:()=>{r(`/g/${s.id}/view`)},children:[e.jsx(Tn,{className:"icon-sm"}),e.jsx(c,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),e.jsxs(F.Item,{onClick:async()=>{const j=await Ie.copyGizmo({gizmoId:s.id});j.gizmo.id&&r(`/gpts/editor/${j.gizmo.id}`)},children:[e.jsx(Yt,{className:"icon-sm"}),e.jsx(c,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),s?.id!=null&&e.jsxs(F.Item,{color:"danger",onClick:()=>{d(!0)},children:[e.jsx(ss,{className:"icon-sm"}),e.jsx(c,{id:"tNrOLG",defaultMessage:"Delete GPT"})]}),l?.includes("debug")&&e.jsxs(e.Fragment,{children:[e.jsx(F.Separator,{}),e.jsxs(F.Item,{onClick:()=>{Ee.toggleActiveSidebar("debug")},children:[e.jsx(Mn,{className:"icon-sm"}),"Debug (Internal only)"]})]})]}),o&&e.jsx(zn,{gizmoId:s.id,onSuccess:()=>da(r),onClose:()=>{d(!1)}})]})}const De=Re.div`flex items-center gap-1`;function il({gizmoEditorData:s}){const t=Xe(a=>a.currentWorkspace?.name);switch(s.sharingRecipient){case v.Private:return e.jsxs(De,{children:[e.jsx(_n,{className:"icon-xs"}),e.jsx(c,{...xe.onlyMe})]});case v.Link:return e.jsxs(De,{children:[e.jsx(Je,{className:"icon-xs"}),e.jsx(c,{...xe.anyoneWithLink})]});case v.Workspace:return e.jsxs(De,{children:[e.jsx(Vt,{className:"icon-xs"}),t]});case v.Marketplace:return e.jsxs(De,{children:[e.jsx(Kt,{className:"icon-xs"}),e.jsx(c,{...xe.public})]});default:return e.jsx("div",{})}}function rl({gizmoEditorData:s}){return e.jsxs("div",{className:"flex items-center gap-2",children:[s.profilePictureUrl!=null?e.jsx(Is,{isFirstParty:!1,src:s.profilePictureUrl,className:"h-8 w-8"}):e.jsx("div",{className:"h-8 w-8 rounded-full border-2 border-dashed border-token-border-medium"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold",children:s.name||e.jsx(c,{...xe.newGPT})}),e.jsx("div",{className:"text-xs text-token-text-secondary",children:Cs(s)?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-token-text-tertiary"}),e.jsx(c,{...xe.draft})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-brand-green"}),s.sharingRecipient===v.Marketplace?e.jsx(c,{...xe.published}):e.jsx(c,{id:"gizmoEditorHeader.live",defaultMessage:"Live"})," · ",e.jsx(il,{gizmoEditorData:s})]})})]})]})}function ol({gizmoEditorData:s,isLoading:t,isUploadingProfilePic:a,isGeneratingProfilePic:n,publishedGizmo:i,updateGizmo:r,promoteGizmo:o,appealGizmo:d,setAppealState:l,revertDraft:f,draftMessage:j,className:u,hasUnpublishedChanges:p,showActionsModal:m}){const x=_s();return e.jsxs("div",{className:oe("relative flex h-14 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",u),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{className:"cursor-pointer text-token-text-primary",onClick:()=>da(x),children:e.jsx(Wa,{className:"icon-lg"})}),e.jsx(rl,{gizmoEditorData:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[j,e.jsx(nl,{gizmoEditorData:s,publishedGizmo:i,revertDraft:f}),e.jsx(al,{gizmo:s,publishedGizmo:i,isLoading:t,isUploadingProfilePic:a,isGeneratingProfilePic:n,updateGizmo:r,promoteGizmo:o,appealGizmo:d,setAppealState:l,hasUnpublishedChanges:p,showActionsModal:m})]})]})}const xe=he({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"}}),ll=512;function cl(){return e.jsx("div",{className:"relative flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-token-border-medium",children:e.jsx(Ns,{className:"h-1/4 w-1/4"})})}function dl({gizmoEditorData:s,onFileChange:t,generateProfilePic:a,isGeneratingProfilePic:n,setIsGeneratingProfilePic:i}){const r=J(),o=fe(),[d,l]=h.useState(void 0),f=h.useRef(t);h.useEffect(()=>{f.current=t});async function j(m){if(m.length>0){i(!1);const x=await Ka(m[0],ll),g=vs(x);l({tempId:g,file:x,status:ie.Uploading,progress:1,fileId:null,cdnUrl:null}),f.current("uploading"),Ya(g,x,r,o,ft.ProfilePicture,{onFileCreated(y,w,b){l(S=>S!=="initial"&&S?.tempId===y&&S.status===ie.Uploading?{...S,progress:10,fileId:w,cdnUrl:b}:S)},onFileUploadProgress(y,w){l(b=>b!=="initial"&&b?.tempId===y&&b.status===ie.Uploading?{...b,progress:w}:b)},onFileUploaded(y,w,b){l(S=>S!=="initial"&&S?.tempId===y?(f.current(S),{...S,status:ie.Ready,progress:100,fileSpec:{name:S.file.name,id:S.fileId,size:S.file.size,...b??{}}}):S)},onError(y){l(w=>{if(w!=="initial"&&w?.tempId===y){f.current(void 0);return}return w})}})}}const{open:u,getInputProps:p}=Gt({disabled:!1,noClick:!0,onDropAccepted:j,onDropRejected:m=>$n(m,r,o,Da.ProfilePicture),multiple:!0,maxSize:Ut,...Et(qa)});return e.jsxs("div",{className:"flex w-full items-center justify-center gap-4",children:[e.jsxs(As,{sideOffset:8,triggerButton:e.jsx("button",{className:"h-20 w-20",children:n?e.jsx(cl,{}):d!=null&&d!="initial"&&d.status!=ie.Ready?e.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[e.jsx(Ha,{file:d.file}),d.status===ie.Uploading&&d.progress<90?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:e.jsx(Va,{percentage:d.progress,className:"h-6 w-6"})}):null]}):s?.profilePictureUrl!=null&&s?.profilePictureUrl!==""?e.jsx(Is,{isFirstParty:!1,src:s.profilePictureUrl}):e.jsx("div",{className:"flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-token-border-medium",children:e.jsx(Nn,{className:"text-4xl"})})}),children:[e.jsx(F.Item,{onClick:u,children:e.jsx(c,{id:"ERQwXg",defaultMessage:"Upload Photo"})}),e.jsx(F.Item,{onClick:a,children:e.jsx(c,{id:"NXAog/",defaultMessage:"Use DALL·E"})})]}),e.jsx("input",{...p()})]})}function ul({gizmoEditorData:s,updateGizmo:t}){const a=s?.tools?.find(u=>u.type===D.INTENT&&"intents"in u.settings),[n,i]=h.useState(a?.settings.intents??""),[r,o]=h.useState(a?.settings.intent_hook??""),[d,l]=h.useState(!1),f=J(),j=()=>{t(u=>({...u,tools:a?u.tools.map(p=>p.type===D.INTENT?{...p,settings:{...p.settings,intents:n,intent_hook:r}}:p):[...u.tools,{type:D.INTENT,settings:{intents:n,intent_hook:r}}]})),l(!1)};return e.jsxs(ne,{children:[e.jsx(X,{label:"GPT Script",description:f.formatMessage({id:"gizmo.gptScriptExplanation",defaultMessage:"Code and Intents to save GPT state"})}),d&&e.jsxs("div",{className:"mb-4",children:[e.jsx(X,{label:"Intent Hook"}),e.jsx(bs,{value:r,rows:20,onChange:u=>o(u.target.value),placeholder:`def f(input):
return {
  "instructions": str(input.intent),
  "conversation_state": input.conversation_state,
  "user_state": input.user_state,
  "pinned": {},
}`,className:"h-50 mb-4 block w-full resize-none rounded-md border border-gray-300 p-2 font-mono text-xs shadow-sm focus:border-blue-500 focus:ring-blue-500",spellCheck:"false"}),e.jsx(X,{label:"Intents"}),e.jsx(bs,{value:n,rows:20,onChange:u=>i(u.target.value),placeholder:"Enter Intent",className:"h-50 mb-4"}),e.jsx(re,{color:"primary",onClick:()=>{j()},children:"Update"})]}),!d&&e.jsx(le,{onClick:()=>l(!0),children:r?"Update Script":"Add Script"})]})}function pl({gizmoEditorData:s,requireGizmoId:t,currentModelConfig:a,updateGizmo:n}){const i=J(),r=fe(),[o,d]=h.useState(0),l=h.useRef(new Map),f=Qa(a,void 0),j=async T=>{xt.logEvent(ht.uploadFile,{client:"web",eventSource:"mouse",intent:"gizmo"});const G=await t();T.length>0&&await Promise.all(T.map(O=>{const _=vs(O);l.current.set(_,{tempId:_,gizmoId:G,file:O,status:ie.Uploading,progress:1,fileId:null,cdnUrl:null}),Xa(vs(O),O,i,r,{kind:ft.Gizmo,gizmoId:G},{onFileUploaded:(P,E,q,K)=>{const B=l.current.get(P);B==null||B.fileId==null||(n(V=>({...V,files:[...V.files??[],{file_id:B.fileId,name:B.file.name,size:B.file.size,type:B.file.type,last_modified:B.file.lastModified,file_size_tokens:K?.fileTokenSize}]})),l.current.delete(P),d(V=>V+1))},onFileCreated:(P,E,q)=>{l.current.set(P,{tempId:P,gizmoId:G,file:O,status:ie.Uploading,progress:1,...l.current.get(P),fileId:E,cdnUrl:q}),d(K=>K+1)},onFileUploadProgress:(P,E)=>{const q=l.current.get(P);q?.status===ie.Uploading&&l.current.set(P,{...q,progress:E}),d(K=>K+1)},onError:P=>{l.current.delete(P)}},{usesRetrievalIndex:a!=null&&rs(a,O.type,O.name)===is.Retrieval})}))},{getInputProps:u,open:p}=Gt({disabled:!1,noClick:!0,onDropAccepted:j,multiple:!0,maxSize:Ut,maxFiles:10,...Et(f)}),m=s?.files??[];function x(T){return e.jsx(Fs,{onRemoveFileClick:()=>{l.current.delete(T.tempId),d(G=>G+1)},file:T.file,loadingPercentage:T.status===ie.Uploading?T.progress:void 0},T.tempId)}function g(T){return e.jsx(Fs,{file:T.name,fileId:T.file_id,onRemoveFileClick:()=>n(G=>({...G,files:G?.files?.filter(O=>O.file_id!==T.file_id)})),gizmoId:s?.id},T.file_id)}const y=Array.from(l.current.values()).filter(T=>m.every(G=>G.file_id!==T.fileId)),[w,b]=zs(y,T=>a!=null&&rs(a,T.file.type,T.file.name)===is.CodeInterpreter),[S,C]=zs(m,T=>a!=null&&T.type!=null&&rs(a,T.type,T.name)===is.CodeInterpreter),U=h.useRef(S.length);return h.useEffect(()=>{S.length>U.current&&n(T=>T.tools?.some(G=>G.type===D.PYTHON)?T:{...T,tools:[...T.tools??[],{type:D.PYTHON}]}),U.current=S.length},[S.length]),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"rounded-lg text-token-text-tertiary",children:e.jsx(c,{...ml.knowledgeWarning})}),b.length>0||C.length>0?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[b.map(x),C.map(g)]}):null,w.length>0||S.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 text-xs text-token-text-tertiary",children:e.jsx(c,{id:"i/QurZ",defaultMessage:"The following files are only available for Code Interpreter:"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[w.map(x),S.map(g)]})]}):null,e.jsx("div",{children:e.jsxs(le,{onClick:p,children:[e.jsx("input",{...u()}),e.jsx(c,{id:"sr8Qp/",defaultMessage:"Upload files"})]})})]})}const ml=he({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"If you upload files under Knowledge, conversations with your GPT may include file contents. Files can be downloaded when Code Interpreter is enabled"}});function gl({placeholder:s,text:t,onChange:a,onClose:n}){return e.jsx(pe,{className:"!max-h-[100vh] !max-w-[80vw]",type:"success",isOpen:!0,onClose:n,primaryButton:e.jsx(le,{onClick:n,children:e.jsx(c,{id:"FeFVdS",defaultMessage:"Close"})}),children:e.jsx("textarea",{className:"h-[70vh] w-full resize-none rounded-lg bg-token-main-surface-primary dark:border-gray-700",value:t,onChange:i=>{a(i.target.value)},placeholder:s})})}const ps=Re.div`text-sm text-red-500`;function fl({children:s,collapsed:t,initial:a}){return e.jsx(Za,{initial:a,children:!t&&e.jsx(ea.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:s})})}function xl({gizmo:s,onShowActionsEditor:t,isDisabled:a}){const n=J(),i=fe(),r=e.jsxs("div",{className:"space-y-1",children:[s?.tools?.map((o,d)=>o.type!==D.JIT_PLUGIN?null:e.jsxs("div",{children:[e.jsx(Ln,{isDisabled:a,actionTool:o,onShowActionsEditor:()=>t(o.metadata.domain)}),o.metadata.auth?.type==="oauth"&&e.jsx(en,{label:n.formatMessage(Q.callbackUrlLabel),value:`https://chat.openai.com/aip/${o.metadata.action_id}/oauth/callback`,onCopied:()=>{i.success("Copied to clipboard",{duration:3})}})]},d)),(s?.tools?.filter(o=>o.type===D.JIT_PLUGIN)??[]).length>=Os?e.jsx("div",{children:n.formatMessage(Q.maxActionsReached,{number:Os})}):e.jsx(le,{disabled:a,onClick:()=>{t("Unknown domain")},className:"mt-2",children:e.jsx(c,{...Q.createActionLabel})})]});return a?e.jsx(zt,{side:"top",label:n.formatMessage(Q.disabledCustomActionsTooltip),children:r}):r}function hl(s){return(s.files?.length??0)>0||s?.tools?.some(t=>t.type===D.JIT_PLUGIN)}const vl=12;function jl({gizmoEditorData:s,updateGizmo:t,currentModelConfig:a,generateProfilePic:n,setIsUploadingProfilePic:i,isGeneratingProfilePic:r,setIsGeneratingProfilePic:o,requireGizmoId:d,onShowActionsEditor:l,onShowBlocksEditor:f}){const j=s?.tools??[],[u,p]=h.useState(!1),[m,x]=h.useState(!0),g=s?.promptStarters??[],y=[...g,...g.length<vl?[""]:[]],w=We(s),S=Ae()?.isWorkspaceAccount(),C=Rt(vt.WorkspaceGPTCustomActions),U=J(),{value:T}=Pe("804300613"),{value:G}=Pe("736089948"),{value:O}=Pe("3047641741");return e.jsxs("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[e.jsxs("div",{className:"grow",children:[e.jsxs(ne,{children:[e.jsx(dl,{gizmoEditorData:s,generateProfilePic:n,isGeneratingProfilePic:r,setIsGeneratingProfilePic:o,onFileChange:async _=>{if(_!=null&&_!=="uploading"&&_.fileId!=null){const P=await Be.getFileDownloadLink(_.fileId);P.status===Ss.Success&&t({profilePictureId:_.fileId!=null?_.fileId:void 0,profilePictureUrl:P.download_url})}else t({profilePictureId:void 0,profilePictureUrl:void 0});i(_==="uploading")}}),e.jsx(X,{label:e.jsx(c,{id:"M4dZms",defaultMessage:"Name"}),description:e.jsx(c,{id:"+Gkni2",defaultMessage:"The name of your GPT"})}),e.jsx(ls,{type:"text",placeholder:U.formatMessage(Q.gptNamePlaceholder),value:s?.name??"",onChange:_=>{t({name:_.target.value})},onBlurCapture:()=>t(_=>({..._,name:_.name.trim()})),"data-testid":"gizmo-name-input"}),w.includes(ge.GizmoNameTooLong)?e.jsx(ps,{className:"mt-1",children:e.jsx(c,{...Q.nameTooLong,values:{length:_t}})}):null]}),e.jsxs(ne,{className:"mt-4",children:[e.jsx(X,{label:e.jsx(c,{id:"YDzNvf",defaultMessage:"Description"}),description:e.jsx(c,{id:"dpxCw8",defaultMessage:"Short description of what this GPT does"})}),e.jsx(ls,{type:"text",placeholder:U.formatMessage(Q.descriptionPlaceholder),value:s?.description??"",onChange:_=>t({description:_.target.value}),onBlurCapture:()=>t(_=>({..._,description:_.description?.trim()??""})),"data-testid":"gizmo-description-input"}),w.includes(ge.GizmoDescriptionTooLong)?e.jsx(ps,{className:"mt-1",children:e.jsx(c,{...Q.descriptionTooLong,values:{length:Nt}})}):null]}),e.jsxs(ne,{children:[e.jsx(X,{label:e.jsx(c,{id:"2SO0RJ",defaultMessage:"Instructions"}),description:U.formatMessage(Q.instructionsSubtitle)}),e.jsxs("div",{className:"relative",children:[e.jsx(bs,{className:"resize-none",rows:8,value:s?.instructions,onChange:_=>t({instructions:_.target.value}),onBlurCapture:()=>t(_=>({..._,instructions:_.instructions.trim()})),placeholder:U.formatMessage(Q.instructionsSubtitle),"data-testid":"gizmo-instructions-input"}),e.jsx("button",{className:"absolute bottom-3 right-2 text-token-text-tertiary",onClick:()=>p(!0),children:e.jsx(Sn,{className:"icon-sm"})})]}),w.includes(ge.GizmoInstructionsTooLong)?e.jsx(ps,{className:"mt-1",children:e.jsx(c,{...Q.instructionsTooLong,values:{length:St}})}):null]}),e.jsxs(ne,{children:[e.jsx(X,{label:e.jsx(c,{id:"6rfYOX",defaultMessage:"Conversation starters"}),description:e.jsx(c,{id:"OSOIpd",defaultMessage:"Examples for the user to start the conversation"})}),e.jsx("div",{className:"flex flex-col gap-1",children:y.map((_,P)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(ls,{className:"rounded-r-none",value:_,type:"text",onChange:E=>{const q=E.target.value;t(K=>({...K,promptStarters:Ps(P>=(g.length??0)?[...g??[],q]:g.map((B,V)=>V===P?q===""?void 0:q:B))}))}}),e.jsx("button",{className:"flex h-9 w-9 items-center justify-center rounded-lg rounded-l-none border border-l-0 border-token-border-medium",onClick:()=>t(E=>({...E,promptStarters:g.filter((q,K)=>K!==P)})),children:e.jsx(Pn,{className:"icon-sm"})})]},P))})]}),e.jsxs(ne,{children:[e.jsx(X,{label:e.jsx(c,{id:"bwXSkU",defaultMessage:"Knowledge"}),description:U.formatMessage(Q.knowledgeExplanation)}),e.jsx(pl,{gizmoEditorData:s,requireGizmoId:d,currentModelConfig:a,updateGizmo:t})]}),e.jsxs(ne,{children:[e.jsx(X,{label:e.jsx(c,{id:"mcAwDU",defaultMessage:"Capabilities"}),description:e.jsx(c,{id:"2exQT6",defaultMessage:"Functionality this GPT can use"})}),e.jsx(An,{enabledTools:j,onEnabledToolsChange:_=>t({tools:_})})]}),e.jsxs(ne,{children:[e.jsx(X,{label:e.jsx(c,{id:"7r7v+u",defaultMessage:"Actions"}),description:e.jsx(c,{id:"fBln7I",defaultMessage:"APIs this GPT can use"})}),e.jsx(xl,{isDisabled:!!(S&&!C),gizmo:s,onShowActionsEditor:l})]}),!S&&hl(s)&&e.jsxs(ne,{children:[e.jsx(X,{label:e.jsx(c,{id:"R3KeU7",defaultMessage:"Additional Settings"}),collapsed:!!m,onClick:()=>{x(_=>!_)}}),e.jsx(fl,{collapsed:m,initial:!1,children:e.jsx(Ja,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:e.jsx(c,{id:"tZgwFW",defaultMessage:"Use conversation data in your GPT to improve our models"}),id:"improve-chatgpt",checked:!s.trainingDisabled,onChange:()=>{t({trainingDisabled:!s.trainingDisabled})}})})]}),T&&e.jsx(yl,{gizmoEditorData:s,updateGizmo:t}),G&&!O&&e.jsx(ul,{gizmoEditorData:s,updateGizmo:t}),O&&e.jsx(si,{gizmoEditorData:s,onOpen:f})]}),u&&e.jsx(gl,{text:s.instructions??"",onChange:_=>{t({instructions:_})},onClose:()=>p(!1),placeholder:U.formatMessage(Q.instructionsSubtitle)})]})}const yl=Fe(()=>Oe(()=>import("./sso-lh93s4wrdpp5fblx.js").then(s=>s.G),__vite__mapDeps([4,1,2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68])).then(s=>s.GizmoContactsEditor)),Q=he({nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters."},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters."},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters."},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them."},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions"},descriptionPlaceholder:{id:"gizmo.descriptionPlaceholder",defaultMessage:"Add a short description about what this GPT does"},instructionsSubtitle:{id:"gizmo.instructionsSubtitle",defaultMessage:"What does this GPT do? How does it behave? What should it avoid doing?"},gptNamePlaceholder:{id:"gizmo.gptNamePlaceholder",defaultMessage:"Name your GPT"},callbackUrlLabel:{id:"gizmo.callbackUrlLabel",defaultMessage:"Callback URL"}});function bl(s,t){const a=jt(s);if(!Array.isArray(s.detail))return a;const n=Ps(s.detail.map(i=>{if(i.type==="value_error.any_str.max_length")switch(i.loc[1]){case"display":{switch(i.loc[2]){case"name":return t.formatMessage(Q.nameTooLong,{length:i.ctx.limit_value});case"description":return t.formatMessage(Q.descriptionTooLong,{length:i.ctx.limit_value})}break}case"instructions":return t.formatMessage(Q.instructionsTooLong,{length:i.ctx.limit_value})}if(typeof i.msg=="string")return i.msg}));return n.length>0?n.join(`
`):a}function kl({upsertDraftError:s}){const t=J(),a=bl(s,t);return e.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[e.jsx("div",{children:e.jsx(c,{...ua.errorSavingDraft})}),a!=null&&e.jsx(zt,{label:a,children:e.jsx(js,{className:"icon-sm"})})]})}function wl({isPublished:s,isSavingDraft:t,hasUnpublishedChanges:a,upsertDraftError:n,className:i}){return n instanceof Ia?e.jsx(kl,{upsertDraftError:n}):a?e.jsxs("div",{className:oe("flex items-center gap-2",i),children:[e.jsx("span",{className:"text-token-text-secondary",children:s?e.jsx(c,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):e.jsx(c,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),e.jsx("div",{className:"w-4 text-token-text-tertiary",children:t&&e.jsx(Ns,{})})]}):null}const ua=he({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}});async function Tl(){}function Ml({clientThreadId:s}){const t=Gn(s),a=qt(s),n=Un(s,t),i=[...new Array(n).keys()].map(r=>e.jsx(Wn,{isFinalTurn:r===n-1,turnIndex:r,clientThreadId:s,conversationLeafId:t,onChangeItemInView:qe,onChangeRating:qe,onRequestMoreCompletions:qe,onRequestCompletion:Tl,currentModelId:a??""},r));return e.jsx(e.Fragment,{children:i})}function at({clientThreadIds:s}){return e.jsx(e.Fragment,{children:s.map(t=>e.jsx(Ml,{clientThreadId:t},t))})}const _l=Fe(()=>Oe(()=>import("./mwq4hgq32r8zxoz9.js"),__vite__mapDeps([69,1,2,3,10,6,7,11,9,12,22,17,43,44,45,46,70,71,72,5,8,13,14,15,16,18,19,20,21,23,24,73,74,75,50,61,76,52,77,78,79,62,37])).then(s=>s.DebugConversationSidebar));function nt(){return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"border-token-border-secondary flex-grow border-b"}),e.jsxs("div",{className:"flex flex-shrink-0 items-center gap-2 px-2 py-6 text-sm text-token-text-tertiary",children:[e.jsx(In,{className:"icon-sm"}),e.jsx(c,{id:"qtaMEG",defaultMessage:"GPT updated"})]}),e.jsx("div",{className:"border-token-border-secondary flex-grow border-b"})]})}var Nl=(s=>(s.TestGizmoAction="test_gizmo_action",s))(Nl||{});const Sl=new sn;function Pl({gizmoEditorData:s,isSavingDraft:t,currentModelConfig:a,showTitle:n=!0}){const[i,r]=h.useState(()=>He()),[o,d]=h.useState([]);h.useEffect(()=>{d(w=>w[w.length-1]===i?w:[...w,i])},[i]);const l=o.slice(0,-1);Xt(i,{kind:Te.GizmoTest,gizmo_id:s.id}),h.useEffect(()=>{R.updateConversationMode(i,{kind:Te.GizmoTest,gizmo_id:s.id})},[i,s.id]);const f=s.files?.map(w=>w.file_id).join();h.useEffect(()=>{R.getServerThreadId(i)!=null&&r(He())},[s.id,s.instructions,s.tools,f,i]);const j=Qt(w=>w.activeSidebar),u=h.useMemo(()=>({gizmoEditorData:s,mode:"test"}),[s]),[p,m]=h.useState(0),x=()=>{m(w=>w-360)},g=s.id,y=Cl(i,a);return h.useEffect(()=>Aa(Sl,{test_gizmo_action:({rootDomain:w,operationName:b})=>{g&&y(g,w,b)}}),[y,g]),e.jsx(Ft.Provider,{value:u,children:e.jsxs("div",{className:oe("flex h-full w-full",t&&"cursor-wait opacity-80 transition"),children:[e.jsxs("div",{className:"flex grow flex-col",children:[e.jsx("div",{className:"relative mb-2 flex-shrink-0",children:e.jsx("div",{className:"flex justify-center py-1",children:n&&e.jsxs("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[e.jsx("div",{className:"icon-md"}),e.jsxs("button",{onClick:()=>{x(),d([]),r(He())},className:"flex items-center gap-2",children:[e.jsx(c,{id:"2u/6Ja",defaultMessage:"Preview"}),e.jsx(ea.div,{className:"text-token-text-primary",animate:{rotate:p},transition:{duration:.3},children:e.jsx(Cn,{className:"icon-md invisible group-hover:visible"})})]})]})})}),e.jsx("div",{className:oe("relative grow overflow-auto px-2",t&&"pointer-events-none"),children:e.jsx(Zt,{clientThreadId:i,hideHeader:!0,renderEmptyState:e.jsxs("div",{className:"relative h-full w-full",children:[l!=null&&l.length>0&&e.jsx("div",{className:"h-full w-full opacity-20",children:e.jsxs(Dn,{children:[e.jsx(at,{clientThreadIds:l}),e.jsx(nt,{})]})}),e.jsx("div",{className:"absolute left-0 top-0 h-full w-full",children:e.jsx(qn,{gizmo:s,hideOwner:!0,showStarterPrompts:!0})})]}),prependThreadChildren:l.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"opacity-50",children:e.jsx(at,{clientThreadIds:l})}),e.jsx(nt,{})]})})})]}),j==="debug"&&e.jsx(_l,{clientThreadId:i,slideOver:!1,onClose:()=>Ee.toggleActiveSidebar("debug"),isOpen:!0})]})})}const it=yt.memo(Pl);function Cl(s,t){const a=Jt({clientThreadId:s});return h.useCallback(async(i,r,o)=>{if(!t)return;const d=new Ot,l=R.getThreadCurrentLeafId(s),f=Le(),j=tn(r);R.updateTree(s,y=>{y.addNodeToEnd(l,{id:f,children:[],parentId:l,message:{id:f,author:{role:me.User},content:{content_type:La.Text,parts:[`Call the ${r} API with the ${o} operation`]},recipient:"all",metadata:{jit_plugin_data:{from_client:{type:"test",operation:o,tool_name:j}}}}})});const u={conversationMode:{kind:Te.GizmoTest,gizmo_id:i}},p=await bt(),[m,x,g]=await Promise.all([kt.getEnforcementToken(p),Bt.getEnforcementToken(p),wt.getEnforcementToken(p)]);a({model:t.id,completionType:Tt.Next,parentNodeId:f,metadata:{},focusOnNewCompletion:!0,chatReq:p,arkoseToken:m,turnstileToken:x,proofToken:g,preflightTime:0,completionMetadata:u,turnTracker:d})},[s,a,t])}function Il(s,t){const a=R.getThreadCurrentLeafId(s),n=R.getTree(s),i=[];let r=n.getNodeByIdOrMessageId(a);for(;r!=null&&(t==null||r.id!==t);)i.unshift(r.message),r=r.parentId!==""?n.getNodeByIdOrMessageId(r.parentId):void 0;return i}function Al(s){return s.filter(n=>n.recipient==="gizmo_editor.update_behavior").flatMap(n=>n.content.content_type==="text"?n.content.parts:n.content.content_type==="code"?[n.content.text]:[]).map(n=>JSON.parse(n)).reduce((n,i)=>({...n,...i}),{})}async function Ll(s){let t;for(const a of s)if(a.author.name==="gizmo_editor.generate_profile_pic"){const n=an.getImageAssetPointers(a);n.length>0&&(t=n.at(-1))}if(t!=null){const a=nn(t.asset_pointer),n=await Be.getFileDownloadLink(a);if(n.status===Ss.Success)return{id:a,permalink:n.download_url}}}async function Gl(s,t,a,n){const i=Il(t,n),r=Al(i);let o=await Ll(i);if(ks(r)&&o==null)return;const{name:d,context:l,description:f,profile_pic_file_id:j,prompt_starters:u}=r;if(j!=null)try{const m=await Be.getFileDownloadLink(j,s.id);m.status===Ss.Success&&(o={id:j,permalink:m.download_url})}catch(m){fs.addError(new Error("Error while retrieving profile pic in update",{cause:m})),a.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}const p={name:typeof d=="string"?d:void 0,description:typeof f=="string"?f:void 0,instructions:typeof l=="string"?l:void 0,promptStarters:Array.isArray(u)?u:void 0,profilePictureId:o?.id,profilePictureUrl:o?.permalink};return Ga(p,m=>m!=null)}function Ul(s){const t=new Set;for(const l of s.tools)t.add(l.type);const a=s.name??"",n=s.description??"",i=s.instructions??"",r=Array.from(t).join(","),o=a===""&&n===""&&i==="",d=s.profilePictureUrl!=null;return o?`The GPT you are about to has the following abilities: ${r}.`:`This is the GPT's current set of fields:

name: ${a}

description: ${n}

context: ${i}

abilities: ${r}

${d?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior."}
`}function pa(s,t,a,n){const i=a.current,r=n.current;if(be(i,r))return;const o={};i.name!==r?.name&&(o.name=i.name),(i.description??"")!==(r?.description??"")&&(o.description=i.description??""),i.instructions!==(r?.instructions??"")&&(o.context=i.instructions??"");const d=new Set(r?.files?.map(p=>p.file_id)??[]),l=new Set(i.files?.map(p=>p.file_id)??[]),f=(i.files??[]).filter(p=>!d.has(p.file_id)),j=(r?.files??[]).filter(p=>!l.has(p.file_id));if(ks(o)&&f.length===0&&j.length===0)return;const u=[];if(!ks(o)){const p=`Explicitly update the GPT's behavior to the following exact fields:

    ${JSON.stringify(o,null,2)}

    "Do not call update_behavior yet. Instead, use these updated fields as the GPT's current behavior, and in the next call to update_behavior, incorporate these changes."
    `;u.push(Ce.getTextAsMessage(p,me.System))}j.length>0&&u.push(Ce.getTextAsMessage(`The user has removed the following files from the GPT. You can no longer reference these files: ${j.map(p=>p.file_id).join(", ")}`,me.System)),f.length>0&&u.push(Ce.getTextAsMessage(`The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ${f.map(p=>p.file_id).join(", ")}`,me.System,{attachments:f.map(p=>({id:p.file_id,name:p.name,size:p.size}))})),u.length>0&&R.updateTree(s,p=>{let m=p.getNodeByIdOrMessageId(t).parentId;for(const x of u){const g=Le();p.insertNodeBefore(t,{id:g,children:[],parentId:m,message:x,metadata:{isClientCreatedSystemMessage:!0}}),m=g}})}function El(s,t,a){if(a.length===0)return;const n=Le(),i=`The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ${a.map(r=>`"${r.fileId}"`).join(", ")}`;R.updateTree(s,r=>{const o=r.getNodeByIdOrMessageId(t).parentId;r.insertNodeBefore(t,{id:n,children:[],parentId:o,message:Ce.getTextAsMessage(i,me.System),metadata:{isClientCreatedSystemMessage:!0}})})}function Rl(s,t){const a="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.",n=R.getThreadCurrentLeafId(s),i=R.getTree(s);let r=i.getNodeByIdOrMessageId(n);for(;r!=null&&r.message.author.role!==me.User;){if(r.message.content.content_type==="text"&&r.message.content.parts[0]===a)return;r=r.parentId!==""?i.getNodeByIdOrMessageId(r.parentId):void 0}R.updateTree(s,o=>{const d=o.getNodeByIdOrMessageId(t).parentId;o.insertNodeBefore(t,{id:Le(),children:[],parentId:d,message:Ce.getTextAsMessage(a,me.System,{exclude_after_next_user_message:!0}),metadata:{isClientCreatedSystemMessage:!0}})})}function zl(s,t,a){R.initThread(s,{kind:Te.GizmoMagicCreate,gizmo_id:void 0,behavior_overrides:a});const i=un().id,r=qt(s)??i,o=Jt({clientThreadId:s,onCompletionFinished:t});return async(l,f,j)=>{if(j.length===0)return;const u=new Ot;let p=R.getThreadCurrentLeafId(s);for(const S of j){const C=Le();R.updateTree(s,U=>{U.addNodeToEnd(p,{id:C,children:[],parentId:p,message:Ce.getTextAsMessage(S,me.System),metadata:{isClientCreatedSystemMessage:!0}})}),R.setThreadCurrentLeafId(s,C),p=C}const m=p;pa(s,m,l,f);const x={conversationMode:{kind:Te.GizmoMagicCreate,gizmo_id:l.current.id,behavior_overrides:a}},g=await bt(),[y,w,b]=await Promise.all([kt.getEnforcementToken(g),Bt.getEnforcementToken(g),wt.getEnforcementToken(g)]);o({model:r,completionType:Tt.Next,parentNodeId:m,metadata:{},focusOnNewCompletion:!0,chatReq:g,arkoseToken:y,turnstileToken:w,proofToken:b,preflightTime:0,completionMetadata:x,turnTracker:u})}}const Fl="Generate a new profile picture for this GPT using gizmo_editor generate_profile_pic. Do not prompt the user for any clarification. Do not send extra text outside of the tool function call. DO NOT CALL update_behavior or otherwise update GPT behavior in your response.",Ol=Fe(()=>Oe(()=>import("./mwq4hgq32r8zxoz9.js"),__vite__mapDeps([69,1,2,3,10,6,7,11,9,12,22,17,43,44,45,46,70,71,72,5,8,13,14,15,16,18,19,20,21,23,24,73,74,75,50,61,76,52,77,78,79,62,37])).then(s=>s.DebugConversationSidebar));function Bl(s,t){h.useEffect(()=>{const a=R.getTree(s);if(a.findNode(o=>o.message.author.role===me.User||o.metadata?.isClientCreatedSystemMessage===!0)||(R.deleteNodesByFilter(s,o=>o.metadata?.isPlaceholderTemplateAssistantWelcomeMessage===!0),t==null||t.length===0))return;const i=R.getThreadCurrentLeafId(s);if(!a.hasNodeOrMessageId(i))return;const r=Le();R.updateTree(s,o=>{o.addNode(r,t,i,me.Assistant,{isPlaceholderTemplateAssistantWelcomeMessage:!0})}),R.setThreadCurrentLeafId(s,r)},[s,t])}function $l(s,t,a){Xt(s,{kind:Te.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:a}),h.useEffect(()=>{R.updateConversationMode(s,{kind:Te.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:a})},[s,t.id,a]);const[n]=h.useState(()=>{const i=t.id==null,r=t.id!=null&&t.name!==""&&t.description!=null&&t.instructions!==""&&t.profilePictureUrl!=null;return i?`Hi! I'll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."

What would you like to make?`:r?`Welcome back! Is there anything ${t.name} should be doing better? Anything you'd like to change?`:"You're back! Let's continue where we left off..."});Bl(s,n)}function Wl({gizmoEditorData:s,updateGizmo:t,clientThreadId:a,completionCallbackResponse:n,gizmoEditorDataRef:i,magicMakerBehaviorOverrides:r,magicMakerConversationGizmoEditorDataRef:o,requireGizmoId:d}){const l=h.useMemo(()=>({gizmoEditorData:s,gizmoId:s.id,mode:"magic",behaviorOverrides:r,getGizmoId:d}),[d,s,r]),f=rn(p=>p.files.filter(m=>m.status===ie.Ready&&m.gizmoId!=null)),j=h.useCallback((p,m)=>{El(p,m,f),pa(p,m,i,o),Rl(p,m),t(x=>({...x,files:[...x.files??[],...Ps(f.map(g=>g.fileId!=null&&{file_id:g.fileId,name:g.file.name,size:g.file.size,type:g.file.type,last_modified:g.file.lastModified,file_size_tokens:g.fileSpec?.fileTokenSize}))]})),o.current=Se(i.current)},[i,o,f,t]),u=Qt(p=>p.activeSidebar);return e.jsx(Ft.Provider,{value:l,children:e.jsxs("div",{className:"relative flex h-full grow overflow-auto",children:[e.jsx("div",{className:"grow",children:e.jsx(Zt,{clientThreadId:a,onCompletionFinished:n,preRequestCompletion:j,hideHeader:!0,prependThreadChildren:e.jsx("div",{className:"h-8"})})}),u==="debug"&&e.jsx(Ol,{clientThreadId:a,slideOver:!1,onClose:()=>Ee.toggleActiveSidebar("debug"),isOpen:!0})]})})}const Dl=yt.memo(Wl),ql=Fe(()=>Oe(()=>import("./biwdj69jy7kfro95.js"),__vite__mapDeps([80,1,2,3,6,7,81,82,51,9,10,11,12,17,49,24,22,83,50,84,13,18,8,14,15,16,61,5,19,20,21,23,85,71,72,73,74,75,76,52,77,78,79,62,37,86])).then(s=>s.GizmoActionsEditor));var ma=(s=>(s.MAGIC_MAKER="magic",s.ADVANCED="advanced",s.PREVIEW="preview",s))(ma||{});function ms({value:s,label:t,testId:a}){return e.jsx(Lt,{value:s,className:"text-md w-1/3 flex-grow rounded-lg border-token-border-light p-1.5 font-semibold text-token-text-tertiary transition hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] md:w-1/2","data-testid":a,children:t})}function Hl({className:s,editorTab:t,setEditorTab:a}){const n=J();return e.jsxs(At,{className:oe("flex w-full overflow-hidden rounded-xl bg-token-main-surface-secondary p-1.5 md:w-1/2",s),value:t,onValueChange:i=>{a(i)},children:[e.jsx(ms,{value:"magic",label:n.formatMessage(gs.magicMakerLabel)}),e.jsx(ms,{value:"advanced",label:n.formatMessage(gs.configureLabel),testId:"gizmo-editor-configure-button"}),e.jsx("div",{className:"flex w-1/3 md:hidden",children:e.jsx(ms,{value:"preview",label:n.formatMessage(gs.previewLabel)})})]})}function Vl(s,t){return s.length!==t.length?!1:s.every(a=>t.some(n=>n.type===a.type))}function Kl(s,t){return s.name===t.gizmo.display.name&&s.description===t.gizmo.display.description&&s.instructions===t.gizmo.instructions&&Vl(s.tools,t.tools)&&be(s.files?.map(a=>a.file_id)??[],t.files?.map(a=>a.file_id)??[])&&s.profilePictureUrl==t.gizmo.display.profile_picture_url&&s.profilePictureId==t.gizmo.display.profile_pic_id}const Ts={id:void 0,instructions:"",name:"",description:"",profilePictureId:void 0,profilePictureUrl:void 0,promptStarters:[],sharing:{recipient:v.Private,subjects:[]},tools:[{type:D.DALLE}],files:[],trainingDisabled:!1,liveVersion:0},Yl={...Ts,tools:[...Ts.tools,{type:D.BROWSER}]};function rt(s){return{id:s.gizmo.id,instructions:s.gizmo.instructions,name:s.gizmo.display.name,description:s.gizmo.display.description??"",profilePictureId:s.gizmo.display.profile_pic_id??void 0,profilePictureUrl:s.gizmo.display.profile_picture_url??void 0,promptStarters:s.gizmo.display.prompt_starters??[],tools:Se(s.tools),files:Se(s.files),sharing:s.gizmo.sharing?Se(s.gizmo.sharing):{subjects:[],recipient:s.gizmo.share_recipient},trainingDisabled:s.gizmo.training_disabled??!1,sharingRecipient:s.gizmo.share_recipient,sharingTargets:Se(s.gizmo.sharing_targets),liveVersion:s.gizmo.live_version??0}}const ga=({gizmo:s,onNewGizmoId:t})=>{const a=ze(),n=Rt(vt.BrowsingAvailable),i=J(),r=fe(),o=h.useRef(s!=null?rt(s):n?Yl:Ts),d=h.useRef(s),l=h.useRef(o.current),[f,j]=h.useState(()=>o.current),[u,p]=h.useState(()=>He()),[m]=h.useState(()=>({context_message:Ul(o.current),model_slug:"unused",enabled_tools:[{tool_id:s!=null?"gizmo_editor":"gizmo_creator"}]}));$l(u,l.current,m);const{data:x}=gn(),g=x?.modelsList.find(N=>N.tags.includes(Ua.GPT_4))??x?.modelsList.find(N=>N.id===fn),{data:y}=$t(o.current.id),w=xn(),{isPending:b,error:S}=w,C=hn(),U=h.useMemo(()=>y!=null&&!Kl(f,y),[f,y]),T=async()=>{const N=o.current;try{const I=await w.mutateAsync({editorData:N,gizmoId:N.id});if(d.current=I,o.current.id==null){const Y=I.gizmo.id;o.current={...o.current,id:Y,sharingTargets:I.gizmo.sharing_targets},j(o.current),t?.(Y)}for(const Y of I.tools.filter(de=>de.type===D.JIT_PLUGIN)){const de=o.current.tools.find(je=>je.type===D.JIT_PLUGIN&&je.metadata.domain===Y.metadata.domain);de&&de.metadata.action_id!==Y.metadata.action_id&&(de.metadata={...de.metadata,action_id:Y.metadata.action_id},j(o.current))}return I}catch(I){const Y=jt(I)??i.formatMessage(ua.errorSavingDraft);throw r.warning(Y,{duration:2}),I}},G=h.useRef(void 0),O=async()=>o.current.id!=null?o.current.id:(G.current==null&&(G.current=T().then(N=>N.gizmo.id).catch(N=>{throw G.current=void 0,N})),G.current),[_]=h.useState(()=>ln(()=>T(),2e3,{trailing:!0}));function P(N,I=!0){const Y=typeof N=="function"?N(o.current):Wo(o.current,N);be(Y,o.current)||(o.current=Y,j(o.current),I&&_())}const E=h.useRef(void 0),q=async N=>{if(N==null){ee(!1);return}try{const I=await Gl(o.current,N,r,E.current);I!=null&&(P(I),l.current=Se(o.current))}catch(I){fs.addError(I),r.warning("Something went wrong generating your GPT",{duration:3})}finally{E.current=R.getThreadCurrentLeafId(N),ee(!1)}},K=zl(u,q,m),[B,V]=h.useState(void 0);h.useEffect(()=>{V(Vn(s))},[s?.gizmo.id]);const ae=async(N,I)=>{const Y=We(o.current,N.recipient,I);if(Y.length>0){r.warning(`Could not save GPT:

${Y.map(_e=>`- ${ws(_e)}`).join(`
`)}`,{duration:3});return}const de=await T(),je=de.gizmo.id;try{return xt.logEvent(ht.promoteGizmo,{gizmo_id:de.gizmo.id,sharing_recipient:N.recipient,editor_tab:te}),await C.mutateAsync({gizmoId:de.gizmo.id,data:{sharingSubjects:N.subjects,sharingRecipient:N.recipient,categories:I==null?void 0:[I]}},{onSuccess(fa){a.setQueryData(Bs(a,je).queryKey,fa),a.invalidateQueries({queryKey:["gizmos"]}),a.invalidateQueries({queryKey:["gizmo",{gizmoId:je}]}),a.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:je}]})}})}catch(_e){_e instanceof cn?V({gizmoId:je,sharingRecipient:N.recipient,moderationType:ts.PublishBlocked,sharingTargets:_e.response.sharing_targets,showModal:ke.AppealAvailable}):(fs.addError(_e),r.warning("Error saving GPT",{duration:2}))}},ve=w.isPending||C.isPending,[te,M]=h.useState(()=>{const N=Es.getItem(Rs.GizmoEditorTab);return Object.values(ma).includes(N)?N:"magic"}),H=Ea.useState(({windowWidth:N})=>N);h.useEffect(()=>{H!=null&&H>=768&&te==="preview"&&M("magic")},[H,te]);const[ns,k]=h.useState(!1),[A,ee]=h.useState(!1),[ce,Z]=h.useState(void 0),[Me,Ge]=h.useState(!1);return e.jsxs("div",{className:"flex h-screen w-full flex-col items-center",children:[e.jsx(ol,{gizmoEditorData:f,isLoading:ve,hasUnpublishedChanges:U,isUploadingProfilePic:ns,isGeneratingProfilePic:A,publishedGizmo:y,updateGizmo:P,promoteGizmo:async(N,I)=>{const Y=await ae(N,I);return o.current={...o.current,sharingRecipient:N.recipient},j(o.current),Es.setItem(Rs.GizmoEditorTab,te),Y},appealGizmo:async(N,I)=>{B!=null&&V({...B,sharingRecipient:N,categories:I==null?void 0:[I],showModal:ke.AppealAvailable})},setAppealState:V,revertDraft:y!=null&&U?()=>{const N=a.getQueryData(Bs(a,o.current.id).queryKey);if(N!=null){const I=rt(N);o.current=I,j(I),T()}}:void 0,draftMessage:e.jsx(wl,{isPublished:y!=null&&(y.gizmo.share_recipient==="marketplace"||y.gizmo.share_recipient==="workspace"),hasUnpublishedChanges:U,isSavingDraft:b,upsertDraftError:S,className:"text-sm"}),showActionsModal:N=>{Z(N)},className:"flex-shrink-0"}),B&&e.jsx(ei,{appealState:B,onAppealClose:()=>V({...B,showModal:ke.None}),onAppealSubmitted:()=>V({...B,showModal:ke.AppealSent})}),e.jsxs("div",{className:"relative flex w-full grow overflow-hidden",children:[e.jsx("div",{className:"flex w-full justify-center md:w-1/2",children:e.jsx("div",{className:"h-full grow overflow-hidden",children:ce!==void 0?e.jsx(ql,{currentlyEditingActionDomain:ce,gizmoEditorData:f,updateGizmo:P,onClose:()=>{Z(void 0)}}):Me?e.jsx(ti,{gizmoEditorData:f,updateGizmo:P,onClose:()=>{Ge(!1)}}):e.jsxs("div",{className:"flex h-full flex-col px-2 pt-2",children:[e.jsx("div",{className:"flex w-full flex-row justify-center",children:e.jsx(Hl,{editorTab:te,setEditorTab:M,className:"mb-2 flex-shrink-0 self-center"})}),e.jsx("div",{className:"grow overflow-hidden",children:te==="magic"?e.jsx("div",{className:"h-full w-full pb-5",children:e.jsx(Dl,{gizmoEditorData:f,updateGizmo:P,completionCallbackResponse:q,clientThreadId:u,gizmoEditorDataRef:o,magicMakerBehaviorOverrides:m,magicMakerConversationGizmoEditorDataRef:l,requireGizmoId:O},u)}):te==="advanced"?e.jsx(jl,{gizmoEditorData:f,updateGizmo:P,currentModelConfig:g,generateProfilePic:()=>{ee(!0),K(o,l,[Fl])},setIsUploadingProfilePic:k,isGeneratingProfilePic:A,setIsGeneratingProfilePic:ee,requireGizmoId:O,onShowActionsEditor:N=>{Z(N)},onShowBlocksEditor:()=>{Ge(!0)}}):e.jsx(it,{gizmoEditorData:f,currentModelConfig:g,isSavingDraft:b,showTitle:!1})})]})})}),e.jsx("div",{className:oe("hidden w-1/2 justify-center border-l border-token-border-medium bg-token-main-surface-secondary pt-4",te!=="preview"&&"md:flex"),children:e.jsx("div",{className:"flex-grow pb-5",children:e.jsx("div",{className:"h-full",children:e.jsx(it,{gizmoEditorData:f,currentModelConfig:g,isSavingDraft:b})})})})]})]})};function Ql({gizmoId:s,version:t}){const{data:a}=mn({gizmoId:s,draft:!0,version:t}),n=Xe(It.accountUserId),r=Pt()?.id,o=a!=null&&n!=null&&r!=null&&on(a);return a!=null&&o?e.jsx(ga,{gizmo:a}):null}function Xl({onNewGizmoId:s}){return e.jsx(ga,{gizmo:void 0,onNewGizmoId:s})}function jc({gizmoId:s,remixSourceId:t,version:a}){const n=_s(),i=Ae(),r=h.useRef(void 0);h.useEffect(()=>(Ee.enterGizmoEditor(),()=>{Ee.exitGizmoEditor()}),[]);let o=s;return s!=null&&r.current===s&&(o=void 0),En({resetThreadAction:()=>{n("/")}}),e.jsx("div",{children:i?.data?e.jsx("div",{children:o!=null?e.jsx(Ql,{gizmoId:o,version:a},o):e.jsx(Xl,{remixSourceId:t,onNewGizmoId:d=>{r.current=d,window.history.replaceState(window.history.state,"",pn(d))}})}):e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx(Ns,{})})})}const gs=he({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}});export{jc as G,Yo as S,Sl as a,Nl as b,rt as c};
//# sourceMappingURL=mgd1i0wv26i98y2r.js.map
