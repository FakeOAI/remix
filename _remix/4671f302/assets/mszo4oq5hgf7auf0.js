const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kdmpd54jbb38ekj3.js","assets/cya1ek7zbsww3e8p.js","assets/m1h3d66e9x9d8av7.js","assets/root-fuvdhw7t.css","assets/o02kugc5eyp7bzuk.js","assets/conversation-small-cll5buey.css","assets/guduah81s8sjp2t6.js","assets/k1rx6catehq88xq0.js","assets/h2x37ub1souzo3by.js","assets/cd3lr7lq8spr3x1m.js","assets/ji313uzrpltya54g.js","assets/cnkyxf781f12fdb9.js","assets/cnlquey73j7uw8fu.js","assets/lxcl4lkoqrle7fky.js","assets/gqzdg6plr3pmj597.js","assets/lrlzvgtohqckew7u.js","assets/clvle6hjcebazwfi.js","assets/dt5uqt2zhmlrp895.js","assets/n0s5m6clrqpu2fmq.js","assets/ck6f40emr7l3i0b3.js","assets/lptuk0q8xn5ezb1r.js","assets/eqdwfm1ss7l1qetb.js","assets/br9sj6yk029klw3b.js","assets/gq7tdevv4xdhasrb.js","assets/md510keitf2ivqa8.js","assets/beqhh5k54ufxbjqa.js","assets/j39ofvy1lixa7pjh.js","assets/g26onwtfblvcue98.js","assets/h4gjvv6ip0y3nwty.js","assets/j5rketn8ycceeo4g.js","assets/textdoc-sandpack-code-preview-mk0lbw6o.css"])))=>i.map(i=>d[i]);
import{a5 as nn,a6 as sn,t as u,T as V,r as C,a3 as U,aV as ot,by as X,R as rt,ag as on,e0 as rn,ad as Ee,c_ as an,c$ as ln,d0 as un,ea as cn,b as St,h as fn,fx as at,d7 as it,a as Mt,dk as dn,dS as mn}from"./cya1ek7zbsww3e8p.js";import{h8 as H,fs as N,eo as hn,fi as pn,cB as gn,af as At,jz as ne,jj as lt,c as se,N as J,hE as oe,R as vn,jA as ye,jB as It,fu as re,jC as Te,jD as Cn,jc as Dt,hf as kt,jp as yn,ao as P,bX as Tn,cn as xn,jE as wn,jF as En,jG as A,jH as bn,hw as Lt,jI as Sn,jJ as Mn,e as An,jK as In,jL as Dn,jM as kn,fh as Ln,hc as _n,fd as jn,hd as Pn,ff as Nn,cD as Rn,jN as On,jO as Hn,ap as ut,jP as qn,jQ as $n,jR as Un,jS as Bn,jT as ct,jf as Z}from"./o02kugc5eyp7bzuk.js";import{C as Fn,s as ee,g as Vn,t as Gn,v as zn,w as Yn,O as Wn,x as Jn,y as Qn}from"./h2x37ub1souzo3by.js";import{e as Xn,C as Zn}from"./ier51yc34rlup7h7.js";import{S as Kn}from"./db9d7ramebkx8sap.js";import{C as xe,a0 as es,a1 as _t,S as W,B as ts,a2 as ft}from"./k1rx6catehq88xq0.js";import{m as te}from"./cnlquey73j7uw8fu.js";import{D as ns}from"./jf4ni6i8z1hlceg4.js";import{bI as ss,bv as os,_ as rs,bK as as,bL as is,v as ls,an as us,y as cs}from"./m1h3d66e9x9d8av7.js";import{i as fs}from"./hsojkhupxqnnfzg0.js";import{i as ds,r as ms,T as hs,B as ps,d as gs}from"./cnkyxf781f12fdb9.js";import{l as jt,L as vs,m as Cs,n as ys,o as Ts,p as xs}from"./cd3lr7lq8spr3x1m.js";import{P as ws}from"./lptuk0q8xn5ezb1r.js";import{q as Es,r as bs,K as Ss}from"./ji313uzrpltya54g.js";import{u as Ms}from"./l0j08voj1v7au9ty.js";var Ne=(t=>(t.Close="close",t.Loaded="loaded",t.Streaming="streaming",t.Download="download",t))(Ne||{});function As(t){return t.includes("'react'")}function Is(t,e){switch(t){case H.CODE_HTML:return"static";case H.CODE_REACT:return"react";case H.CODE_JAVASCRIPT:case H.CODE_TYPESCRIPT:return As(e)?"react":void 0;default:return}}function Pt(t,e){return Is(t,e)!=null}function dt(){if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof global<"u")return global;if(typeof self<"u")return self;throw new Error("Unable to locate global object.")}function Ds(){const t=eval;function e(n){return n==="this"?dt():t(n)}try{dt().eval=e}catch(n){N.logError("Failed to polyfill eval",n)}}Ds();const ks=nn(()=>sn(()=>import("./kdmpd54jbb38ekj3.js").then(t=>t.t),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30])).then(t=>t.TextdocSandpackCodePreview),{fallback:()=>u.jsx("div",{className:"h-full w-full",children:"Failed to load"}),ssr:!1,loading:()=>u.jsx("div",{className:"h-full w-full"})});function Ls(t){return u.jsx(ks,{...t})}function _s({hidden:t,textdocContent:e,textdocType:n}){return n===H.CODE_HTML?u.jsx(Kn,{className:V("min-h-full w-full",{hidden:t}),srcDoc:e}):u.jsx(Ls,{hidden:t,textdocContent:e,textdocType:n})}const js=({isTextdocStreaming:t,isRequestActive:e,value:n,comments:s})=>{const[o,r]=C.useState(!1);return C.useEffect(()=>{t&&o&&(r(!1),xe.reset())},[n,s]),C.useEffect(()=>{e||(r(!1),xe.reset())},[e]),[o,r]};function Ps({onClickRestore:t,onClickResetLatest:e}){const n=U();return u.jsx(te.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{bounce:0,duration:.24},className:"absolute bottom-0 left-0 z-30 w-full items-center border-t border-gray-100 bg-token-main-surface-primary p-6 shadow-[0_-4px_32px_rgba(0,0,0,0.08)] @container dark:border-token-border-xlight dark:shadow-[0_-4px_32px_rgba(0,0,0,0.12)] lg:border-l",children:u.jsxs("div",{className:"mx-auto flex max-w-[48rem] flex-col flex-wrap justify-center gap-5 @2xl:flex-row @2xl:justify-between",children:[u.jsxs("div",{className:"flex flex-col px-2 text-center @2xl:text-start",children:[u.jsx("span",{className:"text-md text-wrap font-semibold",children:n.formatMessage({id:"gt23pb",defaultMessage:"You are viewing a previous version"})}),u.jsx("span",{className:"text-wrap text-sm text-token-text-secondary",children:n.formatMessage({id:"sAlUJn",defaultMessage:"Restore this version to make edits"})})]}),u.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4",children:[u.jsx(ot,{as:"button",color:"primary",onClick:t,children:n.formatMessage({id:"+cddAb",defaultMessage:"Restore this version"})}),u.jsx(ot,{as:"button",color:"secondary",onClick:e,children:n.formatMessage({id:"qCD3eu",defaultMessage:"Back to latest version"})})]})]})})}const Ns={type:"spring",damping:35,stiffness:300},Rs=({clientThreadId:t,turn:e})=>{const n=hn(),s=pn(e.messages);return u.jsxs(te.div,{className:"absolute left-0 right-0 top-0 z-10 -translate-y-full",children:[u.jsx(te.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-vert-light-gradient dark:bg-vert-dark-gradient"}),u.jsx(te.div,{className:"flex items-center px-6 py-2",initial:{opacity:.75,translateX:-50,translateY:"100%"},animate:{opacity:1,translateX:0,translateY:"0"},exit:{opacity:0,translateY:20},transition:Ns,children:u.jsx(Fn,{clientThreadId:t,onChangeItemInView:X,onRequestCompletion:async o=>X(o),onRequestMoreCompletions:X,groupedMessagesToRender:s,allGroupedMessages:s,isEditing:!1,isUserTurn:!0,turnIndex:0,isCompletionRequestInProgress:!1,isFeedbackEnabled:!1,isFinalTurn:!1,hasActiveRequest:n,showEditButton:!1,handleEnterEdit:X,handleExitEdit:X})})]},"user-message")},Os=({clientThreadId:t})=>{const e=ds(t),n=ms(t,e),{lastUserTurn:s,lastAssistantTurn:o}=C.useMemo(()=>{let a=null,i=null;for(let c=n.length-1;c>0;c--){const l=n[c];if(!a&&l.role===rt.User?a=l:!i&&l.role===rt.Assistant&&(i=l),a&&i)break}return{lastUserTurn:a,lastAssistantTurn:i}},[n]),r=s&&!o?.messages.find(({message:a})=>a.recipient?.startsWith(gn));return u.jsx(At,{initial:!1,children:r&&u.jsx(Rs,{turn:s,clientThreadId:t})})},Hs=({isRequestActive:t=!1,clientThreadId:e,onCancel:n,onAcceleratorsExpandedChange:s,onSubmit:o,onSubmitAccelerator:r,acceleratorActions:a=[]})=>{const[i,c]=C.useState(""),[l,d]=C.useState(!0),f=U(),[p,T]=C.useState(!1),g=()=>{o?.(i),c("")},h=m=>{const{metaKey:v,shiftKey:w,key:b}=m;b==="Enter"&&i.trim()&&!(w||v)&&(g(),m.preventDefault())};return u.jsxs("div",{className:"relative mb-3 flex max-w-2xl flex-1 justify-center",children:[u.jsx(Os,{clientThreadId:e}),u.jsx("div",{className:"flex flex-auto items-start",children:u.jsx("div",{className:V("mx-6 flex min-h-12 flex-auto items-center bg-[#f4f4f4] py-1 pl-6 pr-2 dark:bg-token-main-surface-secondary",{"rounded-full":l,"rounded-2xl":!l,"bg-transparent":p}),children:u.jsxs("div",{className:"relative flex flex-auto items-center self-stretch",children:[u.jsx(fs,{placeholder:f.formatMessage({id:"zrUbTJ",defaultMessage:"Ask ChatGPT to edit"}),disabled:t,value:i,className:V("w-full resize-none border-0 bg-transparent p-0 text-token-text-primary outline-0 placeholder:text-token-text-secondary focus:ring-0 focus-visible:ring-0",{"opacity-0":p}),maxRows:4,onChange:({target:{value:m}})=>c(m),onKeyDown:h,onHeightChange:(m,{rowHeight:v})=>d(Math.floor(m/v)<=1)}),i?u.jsx(te.button,{className:V("dark h-8 w-8 rounded-full bg-token-main-surface-primary text-center dark:bg-token-main-surface-primary",{"self-end":!l}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{type:"tween",duration:.1},onMouseDown:()=>g(),children:u.jsx(ss,{className:"h-8 w-8 text-token-text-primary"})}):(a?.length??0)>0&&u.jsx(es,{disableHint:!0,isEmbeddedInPromptArea:!0,isRequestActive:t,actions:a,onCancel:n,onExpandedChange:m=>{_t()||T(m),s?.(m)},onSubmit:r,right:0,bottom:4})]})})})]})};function R(){}R.prototype={diff:function(e,n){var s,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=o.callback;typeof o=="function"&&(r=o,o={});var a=this;function i(x){return x=a.postProcess(x,o),r?(setTimeout(function(){r(x)},0),!0):x}e=this.castInput(e,o),n=this.castInput(n,o),e=this.removeEmpty(this.tokenize(e,o)),n=this.removeEmpty(this.tokenize(n,o));var c=n.length,l=e.length,d=1,f=c+l;o.maxEditLength!=null&&(f=Math.min(f,o.maxEditLength));var p=(s=o.timeout)!==null&&s!==void 0?s:1/0,T=Date.now()+p,g=[{oldPos:-1,lastComponent:void 0}],h=this.extractCommon(g[0],n,e,0,o);if(g[0].oldPos+1>=l&&h+1>=c)return i(mt(a,g[0].lastComponent,n,e,a.useLongestToken));var m=-1/0,v=1/0;function w(){for(var x=Math.max(m,-d);x<=Math.min(v,d);x+=2){var k=void 0,L=g[x-1],I=g[x+1];L&&(g[x-1]=void 0);var _=!1;if(I){var B=I.oldPos-x;_=I&&0<=B&&B<c}var D=L&&L.oldPos+1<l;if(!_&&!D){g[x]=void 0;continue}if(!D||_&&L.oldPos<I.oldPos?k=a.addToPath(I,!0,!1,0,o):k=a.addToPath(L,!1,!0,1,o),h=a.extractCommon(k,n,e,x,o),k.oldPos+1>=l&&h+1>=c)return i(mt(a,k.lastComponent,n,e,a.useLongestToken));g[x]=k,k.oldPos+1>=l&&(v=Math.min(v,x-1)),h+1>=c&&(m=Math.max(m,x+1))}d++}if(r)(function x(){setTimeout(function(){if(d>f||Date.now()>T)return r();w()||x()},0)})();else for(;d<=f&&Date.now()<=T;){var b=w();if(b)return b}},addToPath:function(e,n,s,o,r){var a=e.lastComponent;return a&&!r.oneChangePerToken&&a.added===n&&a.removed===s?{oldPos:e.oldPos+o,lastComponent:{count:a.count+1,added:n,removed:s,previousComponent:a.previousComponent}}:{oldPos:e.oldPos+o,lastComponent:{count:1,added:n,removed:s,previousComponent:a}}},extractCommon:function(e,n,s,o,r){for(var a=n.length,i=s.length,c=e.oldPos,l=c-o,d=0;l+1<a&&c+1<i&&this.equals(s[c+1],n[l+1],r);)l++,c++,d++,r.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return d&&!r.oneChangePerToken&&(e.lastComponent={count:d,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=c,l},equals:function(e,n,s){return s.comparator?s.comparator(e,n):e===n||s.ignoreCase&&e.toLowerCase()===n.toLowerCase()},removeEmpty:function(e){for(var n=[],s=0;s<e.length;s++)e[s]&&n.push(e[s]);return n},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function mt(t,e,n,s,o){for(var r=[],a;e;)r.push(e),a=e.previousComponent,delete e.previousComponent,e=a;r.reverse();for(var i=0,c=r.length,l=0,d=0;i<c;i++){var f=r[i];if(f.removed)f.value=t.join(s.slice(d,d+f.count)),d+=f.count;else{if(!f.added&&o){var p=n.slice(l,l+f.count);p=p.map(function(T,g){var h=s[d+g];return h.length>T.length?h:T}),f.value=t.join(p)}else f.value=t.join(n.slice(l,l+f.count));l+=f.count,f.added||(d+=f.count)}}return r}function ht(t,e){var n;for(n=0;n<t.length&&n<e.length;n++)if(t[n]!=e[n])return t.slice(0,n);return t.slice(0,n)}function pt(t,e){var n;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(n=0;n<t.length&&n<e.length;n++)if(t[t.length-(n+1)]!=e[e.length-(n+1)])return t.slice(-n);return t.slice(-n)}function Re(t,e,n){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return n+t.slice(e.length)}function Oe(t,e,n){if(!e)return t+n;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+n}function K(t,e){return Re(t,e,"")}function ve(t,e){return Oe(t,e,"")}function gt(t,e){return e.slice(0,qs(t,e))}function qs(t,e){var n=0;t.length>e.length&&(n=t.length-e.length);var s=e.length;t.length<e.length&&(s=t.length);var o=Array(s),r=0;o[0]=0;for(var a=1;a<s;a++){for(e[a]==e[r]?o[a]=o[r]:o[a]=r;r>0&&e[a]!=e[r];)r=o[r];e[a]==e[r]&&r++}r=0;for(var i=n;i<t.length;i++){for(;r>0&&t[i]!=e[r];)r=o[r];t[i]==e[r]&&r++}return r}var we="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",$s=new RegExp("[".concat(we,"]+|\\s+|[^").concat(we,"]"),"ug"),be=new R;be.equals=function(t,e,n){return n.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t.trim()===e.trim()};be.tokenize=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');n=Array.from(e.intlSegmenter.segment(t),function(r){return r.segment})}else n=t.match($s)||[];var s=[],o=null;return n.forEach(function(r){/\s/.test(r)?o==null?s.push(r):s.push(s.pop()+r):/\s/.test(o)?s[s.length-1]==o?s.push(s.pop()+r):s.push(o+r):s.push(r),o=r}),s};be.join=function(t){return t.map(function(e,n){return n==0?e:e.replace(/^\s+/,"")}).join("")};be.postProcess=function(t,e){if(!t||e.oneChangePerToken)return t;var n=null,s=null,o=null;return t.forEach(function(r){r.added?s=r:r.removed?o=r:((s||o)&&vt(n,o,s,r),n=r,s=null,o=null)}),(s||o)&&vt(n,o,s,null),t};function vt(t,e,n,s){if(e&&n){var o=e.value.match(/^\s*/)[0],r=e.value.match(/\s*$/)[0],a=n.value.match(/^\s*/)[0],i=n.value.match(/\s*$/)[0];if(t){var c=ht(o,a);t.value=Oe(t.value,a,c),e.value=K(e.value,c),n.value=K(n.value,c)}if(s){var l=pt(r,i);s.value=Re(s.value,i,l),e.value=ve(e.value,l),n.value=ve(n.value,l)}}else if(n)t&&(n.value=n.value.replace(/^\s*/,"")),s&&(s.value=s.value.replace(/^\s*/,""));else if(t&&s){var d=s.value.match(/^\s*/)[0],f=e.value.match(/^\s*/)[0],p=e.value.match(/\s*$/)[0],T=ht(d,f);e.value=K(e.value,T);var g=pt(K(d,T),p);e.value=ve(e.value,g),s.value=Re(s.value,d,g),t.value=Oe(t.value,d,d.slice(0,d.length-g.length))}else if(s){var h=s.value.match(/^\s*/)[0],m=e.value.match(/\s*$/)[0],v=gt(m,h);e.value=ve(e.value,v)}else if(t){var w=t.value.match(/\s*$/)[0],b=e.value.match(/^\s*/)[0],x=gt(w,b);e.value=K(e.value,x)}}var Us=new R;Us.tokenize=function(t){var e=new RegExp("(\\r?\\n)|[".concat(we,"]+|[^\\S\\n\\r]+|[^").concat(we,"]"),"ug");return t.match(e)||[]};var Se=new R;Se.tokenize=function(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var n=[],s=t.split(/(\n|\r\n)/);s[s.length-1]||s.pop();for(var o=0;o<s.length;o++){var r=s[o];o%2&&!e.newlineIsToken?n[n.length-1]+=r:n.push(r)}return n};Se.equals=function(t,e,n){return n.ignoreWhitespace?((!n.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!n.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):n.ignoreNewlineAtEof&&!n.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),R.prototype.equals.call(this,t,e,n)};function Bs(t,e,n){return Se.diff(t,e,n)}var Fs=new R;Fs.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Vs=new R;Vs.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function He(t){"@babel/helpers - typeof";return He=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(t)}var ae=new R;ae.useLongestToken=!0;ae.tokenize=Se.tokenize;ae.castInput=function(t,e){var n=e.undefinedReplacement,s=e.stringifyReplacer,o=s===void 0?function(r,a){return typeof a>"u"?n:a}:s;return typeof t=="string"?t:JSON.stringify(qe(t,null,null,o),o,"  ")};ae.equals=function(t,e,n){return R.prototype.equals.call(ae,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),n)};function qe(t,e,n,s,o){e=e||[],n=n||[],s&&(t=s(o,t));var r;for(r=0;r<e.length;r+=1)if(e[r]===t)return n[r];var a;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),a=new Array(t.length),n.push(a),r=0;r<t.length;r+=1)a[r]=qe(t[r],e,n,s,o);return e.pop(),n.pop(),a}if(t&&t.toJSON&&(t=t.toJSON()),He(t)==="object"&&t!==null){e.push(t),a={},n.push(a);var i=[],c;for(c in t)Object.prototype.hasOwnProperty.call(t,c)&&i.push(c);for(i.sort(),r=0;r<i.length;r+=1)c=i[r],a[c]=qe(t[c],e,n,s,c);e.pop(),n.pop()}else a=t;return a}var $e=new R;$e.tokenize=function(t){return t.slice()};$e.join=$e.removeEmpty=function(t){return t};var Ce=(t=>(t.ADDED="added",t.REMOVED="removed",t.UNCHANGED="unchanged",t))(Ce||{});function Ue(t){if(t==="")return 0;const e=t.split(`
`).length;return t.endsWith(`
`)?e-1:e}function Gs(t,e){return Bs(t,e,{newlineIsToken:!0}).map(s=>({count:s.count??Ue(s.value),value:s.value,type:s.added?"added":s.removed?"removed":"unchanged"}))}function zs(t){let e="";for(const{type:n,value:s}of t)(n==="added"||n==="unchanged")&&(e+=s);return e}function Ys(t,e){const n=Ue(e),s=Qs(t,n);return{changes:Gs(s,e),numLinesDiffed:n}}function Ws(t){const e=[...t],n=[],s=[];for(;e.length>0;){const o=e[e.length-1];if(o.type===Ce.REMOVED)e.pop(),o.type===Ce.REMOVED&&n.unshift(o);else if(o.type===Ce.ADDED)e.pop(),s.unshift(o);else break}return{prunedChanges:[...e,...s],prunedRemovedChanges:n}}function Js(t,e){const{changes:n,numLinesDiffed:s}=Ys(t,e),{prunedChanges:o,prunedRemovedChanges:r}=Ws(n),a=zs(o),i=r.map(l=>l.value).join(`
`),c=Nt(t,s,"start");return{content:a+i+c,numLinesDiffed:Ue(a)}}function Qs(t,e){if(e<=0)return"";let n=0,s=t.length;for(let o=0;o<t.length;o++)if(t[o]===`
`&&(n++,n===e)){s=o+1;break}return t.substring(0,s)}function Nt(t,e,n="start"){if(e<=0)return t;if(n==="start"){let a=0;for(let i=0;i<t.length;i++)if(t[i]===`
`&&(a++,a===e))return t.substring(i+1);return""}let s=0,o=-1;const r=t.endsWith(`
`)?e+1:e;for(let a=t.length-1;a>=0;a--)if(t[a]===`
`&&(s++,s===r)){o=a;break}return o===-1?"":t.substring(0,o+1)}function Xs(t,e){const n=t?.type??H.LOADING,s=t?.content??"",o=!!t?.isPartial;if(!ne(n)||e==null||!o||t?.isRewriting!==!0)return{content:s,currentlyStreamingLineIndex:null};const r=Nt(s,1,"end");if(r==="")return{content:e.content,currentlyStreamingLineIndex:0};const a=Js(e.content,r);return{content:a.content,currentlyStreamingLineIndex:a.numLinesDiffed}}function Zs(t,e){const n=new Set(t.map(i=>i.id)),s=new Set(e.map(i=>i.id)),o=t.filter(i=>!s.has(i.id)).map(i=>({...i,diffStatus:lt.REMOVED})),r=e.filter(i=>!n.has(i.id)).map(i=>({...i,diffStatus:lt.ADDED})),a=t.filter(i=>s.has(i.id));return o.concat(r,a)}function Ks({textdocVersion:t}){const e=U(),n=on(),[s,o]=C.useState(!1),r=rn(),a=C.useRef(t?.content??"");C.useEffect(()=>{a.current=t?.content??""},[t]);const i=c=>{s||(r(()=>{N.logButtonClick(oe.COPY,{contentLength:a.current.length,textdocType:t?.type}),vn(a.current,n,c)},0),o(!0),r(()=>o(!1),2e3))};return u.jsx(se,{label:e.formatMessage(eo.copy),children:u.jsx(J,{icon:s?os:rs,onClick:i})})}const eo=Ee({copy:{id:"rbIYfo",defaultMessage:"Copy"}});function to({textdocId:t,version:e,isHistorical:n,isShowingChanges:s,latestVersionInt:o,nextVersion:r,previousVersion:a,onHoverPrevious:i,textdocType:c}){const l=U(),d=e==null||e===1,f=e!=null&&e>1;return d&&!n?null:u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx(se,{label:f&&l.formatMessage({id:"PoD5+8",defaultMessage:"Previous version"}),children:u.jsx(J,{disabled:!f,icon:as,onMouseOver:i,onClick:()=>{N.logButtonClick(oe.HISTORY_PREVIOUS,{textdocType:c,isShowingChanges:s,textdocId:t,versionInt:e}),t&&e&&f&&ye(t,{beforeVersion:e},s&&a!=null?a:void 0)}})}),u.jsx(se,{label:n&&l.formatMessage({id:"PJ8YVJ",defaultMessage:"Next version"}),children:u.jsx(J,{disabled:!n,icon:is,onClick:()=>{N.logButtonClick(oe.HISTORY_NEXT,{textdocType:c,isShowingChanges:s,textdocId:t,versionInt:e}),n&&(r?ye(t,{version:r},s?r:void 0):s&&o?It(t,o,null):re(t))}})})]})}function no({isShowingCodePreview:t,onClick:e}){const[n,s]=C.useState(!1),o=U(),r=()=>{s(!0)},a=()=>{s(!1)};return u.jsx(se,{label:t?o.formatMessage(Ct.hidePreview):o.formatMessage(Ct.showPreview),children:u.jsx(J,{onMouseEnter:r,onMouseLeave:a,icon:ls,onClick:e,className:V("transition-colors",{[Te.hoverActive]:n&&t,[Te.active]:!n&&t})})})}const Ct=Ee({showPreview:{id:"m61vYn",defaultMessage:"Preview code"},hidePreview:{id:"ot1Rmq",defaultMessage:"Preview code"}});function so({textdocId:t,textdocType:e,history:n,version:s,isShowingChanges:o,latestVersionInt:r,onMouseEnter:a}){const i=U(),[c,l]=C.useState(!1),d=()=>{n?ye(t,n):re(t)},f=(s?.versionInt??0)>1,p=()=>{N.logButtonClick(oe.SHOW_CHANGES,{textdocType:e,textdocId:t,versionInt:s?.versionInt,latestVersionInt:r}),s?.versionInt!=null&&It(t,s.versionInt,n)},T=()=>{l(!0),a?.()},g=()=>{l(!1)};return u.jsx(se,{label:f&&i.formatMessage(o?yt.hideChanges:yt.showChanges),children:u.jsx(J,{icon:us,disabled:!f,onClick:o?d:p,onMouseEnter:T,onMouseLeave:g,className:V("transition-colors",{[Te.hoverActive]:c&&o&&f,[Te.active]:!c&&o&&f,"!bg-transparent":!c&&!o&&f})})})}const yt=Ee({done:{id:"0MCBfo",defaultMessage:"Done"},showChanges:{id:"3jMGNS",defaultMessage:"Show changes"},hideChanges:{id:"HWiQSk",defaultMessage:"Hide changes"}}),oo=800,ro=100,Tt=100,ao=({textdocId:t,isHistoricalVersion:e,nextHistoricalTextdocVersion:n,previousHistoricalTextdocVersion:s,textdocVersion:o,readonlyReason:r,history:a,latestVersionInt:i,hasDebug:c,contentWidth:l,isEmbedded:d,isPersisting:f,isShowChangesFeatureEnabled:p,isShowingChanges:T,hideHistoryActions:g=!1,prefetchHistoricalTextdocVersion:h,restoreHistoricalTextdocVersion:m,setShowDebugView:v,onClickCodePreview:w,onClose:b,isShowingCodePreview:x})=>{const k=Cn(o?.title??""),[{width:L},I]=Dt(),_=l-L-ro-Tt>0,B=kt(),D=jt(),Me=o==null?!1:Pt(o.type,o.content);return u.jsxs(ee.Header,{children:[u.jsxs("div",{className:"flex flex-1 items-center leading-[0]",children:[u.jsx(ee.CloseButton,{onClick:b}),_&&u.jsx("div",{className:"flex flex-row items-center gap-2.5",children:u.jsx(ee.Title,{style:{maxWidth:l-L-Tt},children:k||u.jsx("div",{className:"w-52",children:u.jsx(ws,{lines:1,size:"base",width:100,widthVariance:0})})})}),f&&u.jsx(yn,{size:12,className:"pl-2 text-token-text-secondary"})]}),u.jsxs("div",{className:"flex select-none items-center gap-2 leading-[0]",ref:I,children:[u.jsxs("div",{className:V("flex items-center gap-2 transition-opacity duration-500",r===P.Streaming&&"pointer-events-none opacity-0"),children:[c&&l>oo&&u.jsx(J,{icon:cs,onClick:()=>v(Ae=>!Ae)}),D&&Me&&u.jsx(no,{onClick:w,isShowingCodePreview:x}),!g&&u.jsx(to,{textdocId:t,isHistorical:e,isShowingChanges:T,version:o?.versionInt,previousVersion:s?.versionInt,nextVersion:n?.versionInt,readonlyReason:r,onHoverPrevious:h,onClickRestore:m,textdocType:o?.type,latestVersionInt:i}),!g&&p&&u.jsx(so,{textdocId:t,textdocType:o?.type,history:a,version:o,isShowingChanges:T,latestVersionInt:i,onMouseEnter:()=>{o?.versionInt&&B(t,o.versionInt),h()}}),u.jsx(Ks,{textdocVersion:o})]}),!d&&u.jsx(vs,{})]})]})},io=/\s/,lo=30;function xt(t,e){const n=t.indexOf(e);return n===-1?!1:t.indexOf(e,n+e.length)===-1}function $(t,e){return io.test(t[e])}function wt(t,e,n=!1){if(e===0||n&&$(t,e-1))return e;for(;e>0&&$(t,e-1);)e--;for(;e>0&&!$(t,e-1);)e--;return $(t,e)&&e++,e}function Et(t,e,n=!1){if(e===t.length||n&&$(t,e))return e;for(;e<t.length&&$(t,e);)e++;for(;e<t.length&&!$(t,e);)e++;return $(t,e-1)&&e--,e}function uo(t,e,n=!0,s=lo){if(t.start<0||t.end>e.length||t.start>t.end)throw new Error("Invalid commentSourceRange provided.");const o=e.substring(t.start,t.end);let r=t.start,a=t.end;n&&(r=wt(e,r,!0),a=Et(e,a,!0));let i=e.substring(r,t.start),c=e.substring(t.end,a),l=`${i}${o}${c}`;if(xt(e,l)&&(s==null||l.length>=s))return{before:i,after:c,allSurrounding:l};let d=r,f=a,p=!0;for(;p&&(s==null||l.length<s);){let T=!1;const g=d>0?wt(e,d):d;g<d&&(d=g,T=!0);const h=f<e.length?Et(e,f):f;if(h>f&&(f=h,T=!0),T){const m=e.substring(d,t.start),v=e.substring(t.end,f),w=`${m}${o}${v}`;if(xt(e,w)&&(s==null||w.length>=s))return{before:m,after:v,allSurrounding:w};i=m,c=v,l=w}else p=!1}return{before:i,after:c,allSurrounding:l}}const ie="# Context",le="# Instructions";function ue(t,e,n){if(e==null||n==null)return`The user is referring to the entire text of "${t}".`;const s=`
## Selected Text
The user has selected this text in "${t}" in particular:
${e}
`.trim();return n.allSurrounding===e?s:`
${s}

## Surrounding Context
Here is the surrounding context:
${n.allSurrounding}
`.trim()}function Rt(t,e){return t==null||e==null?"entire document":t===e.allSurrounding?"selected text":"surrounding context"}function Ot(t){return`For the update pattern, create a regex which exactly matches the ${t}. Edit just this string in order to fullfill the user's request. NEVER rewrite the entire document. Instead, ALWAYS edit ONLY the ${t}. The only exception to this rule is if the ${t} includes markdown lists or tables. In that case, fully rewrite the document using ".*" as the regex update pattern.`.trim()}function co(t,e,n,s){if(!ne(e)&&n&&s){const o=Rt(n,s);return`
${ie}
The user requests that you directly edit the document.

${ue(t,n,s)}

${le}
Use the update_textdoc tool to make this edit. ${Ot(o)}`.trim()}return`
${ie}
The user requests that you directly edit the document.

${ue(t,n,s)}

${le}
Use the update_textdoc tool to make this edit. You MUST fully rewrite the entire document by using ".*" as the update regex pattern.`.trim()}function fo(t,e,n){return`
${ie}
The user requests that you add comments about some text.

${ue(t,e,n)}

${le}
Do not respond to the user's question directly, just leave comments.`.trim()}function mo(t,e){return ne(t)?e==="entire document"?` If you choose to update the ${e}, you MUST fully rewrite the ${e} by using ".*" as the update regex pattern.`:` If you choose to update the ${e}, you MUST fully rewrite the entire document by using ".*" as the update regex pattern. When you do so, ONLY modify the ${e} and rewrite other sections exactly as is, except for parts that must change based on this update`:e==="entire document"?"":` If you choose to update the ${e}, follow these instructions: ${Ot(e)}`}function ho(t,e,n,s){const o=Rt(n,s),r=mo(e,o);return`
${ie}
${ue(t,n,s)}

${le}
The user would like you perform one of the following actions:
- Update the ${o} via the \`update_textdoc\` tool.${r}
- Explain the selected text via chat, or answer a general question about the selected text (no tool call required).
- Comment on the ${o} with feedback via the \`comment_textdoc\` tool. This should only be used if the user very explicitly asks for feedback, critique, or comments.

Based on the user's request, choose the appropriate action.
`.trim()}function po(t,e,n){return`
${ie}
${ue(t,e,n)}

${le}
The user would like you to create a new textdoc.
`.trim()}function go(t,e,n,s=null,o=null){switch(n){case W.ASK:return ho(t,e,s,o);case W.CREATE_TEXTDOC:return po(t,s,o);case W.EDIT:return co(t,e,s,o);case W.COMMENT:return fo(t,s,o)}}function vo(t){const e=Es(),n=Vn(t),s=bs(t)??e.id,o=Gn({clientThreadId:t});return async function(r){const a=new Tn,i=hs.getThreadCurrentLeafId(t),c=performance.now(),l=await an(),[d,f,p]=await Promise.all([ln.getEnforcementToken(l),xn.getEnforcementToken(l),un.getEnforcementToken(l)]);o({model:s,completionType:cn.Next,parentNodeId:i,metadata:{eventSource:"mouse"},completionMetadata:{conversationMode:n},chatReq:l,arkoseToken:d??null,turnstileToken:f??null,proofToken:p??null,preflightTime:performance.now()-c,appendMessages:r,turnTracker:a})}}function Co(t){switch(t){case A.ACCELERATOR:case A.ACCEPT_COMMENT:return!0;case A.ASK_CHATGPT:case A.FULL_SCREEN_SUBMIT:return!1}}function yo(t,e){switch(e){case A.ASK_CHATGPT:case A.ACCEPT_COMMENT:case A.FULL_SCREEN_SUBMIT:return t.formatMessage(xo.askChatGPT);case A.ACCELERATOR:return}}const To=(t,e)=>{const n=vo(t),s=U(),{tags:o}=Ss(t);return C.useCallback(({content:r,sourceRange:a,action:i,userMessageType:c,acceleratorMetadata:l,selectionMetadata:d})=>{if(e?.versionInt==null)return;const{textdocId:f,type:p,versionInt:T,content:g}=e;let h,m=null;a&&a.start!==a.end&&(h=g.slice(a.start,a.end),m=uo(a,g));const v=go(f,p,i,h,m),b=wn(v,{exclude_after_next_user_message:!0});n([En([r],{canvas:{textdoc_id:f,textdoc_type:p,version:T,textdoc_content_length:g.length,user_message_type:c,accelerator_metadata:l,selection_metadata:d},is_visually_hidden_from_conversation:Co(c),targeted_reply:h,targeted_reply_label:yo(s,c),open_in_canvas_view:{type:"canvas_textdoc",id:f}}),b])},[n,s,e,o])},xo=Ee({askChatGPT:{id:"h5ANdM",defaultMessage:"Asked ChatGPT"}});function wo(t){const e=/\[([^\]]+)\]\((https?:\/\/[^\s)]+|www\.[^\s)]+)\)/gi,n=new Set,s=t.matchAll(e);for(const o of s){const r=o[2];try{let a=r;a.startsWith("www.")&&(a="http://"+r),new URL(a),n.add(r)}catch{}}return n}const Eo=async({lastVersion:t,textdocId:e,content:n,comments:s})=>{const o=bn(s,n);return(await St.safePost("/textdoc/{textdoc_id}",{parameters:{path:{textdoc_id:e}},requestBody:{version:t,content:n,comments:o}})).version},bo=()=>{const t=C.useRef([]),e=C.useRef(null),{mutateAsync:n,isPending:s}=fn({mutationKey:["canvas","textdoc","persist"],mutationFn:Eo});return[C.useCallback(async(r,a,i)=>{const c=new AbortController,d=(async()=>{const[g]=t.current;try{await g?.promise}catch(h){N.logError("Saving document",h)}if(!c.signal.aborted)try{const h=Math.max(e.current??0,r.versionInt??Lt);let m="";try{at(a)?m=a():m=a}catch(x){N.logError("Serializing document",x)}let v=[];try{at(i)?v=i():v=i}catch(x){N.logError("Adjusting comments",x)}const{textdocId:w}=r;Sn({textdocId:w,basedOnVersionInt:h,content:m,comments:v});const b=await n({textdocId:w,lastVersion:h,content:m,comments:v});Mn({textdocId:w,basedOnVersionInt:h,newVersion:b}),e.current=b}catch(h){N.logError("Error saving document",h)}finally{t.current.shift()}})(),f={abort:()=>c.abort(),promise:d},[p,T]=t.current;return T&&(T.abort(),t.current=p?[p]:[]),t.current=p?[p,f]:[f],d},[n]),t,s]},So=3e3,Mo=t=>{const[e,n,s]=bo(),o=U(),r=C.useRef(null),a=C.useCallback(An(e,So,{leading:!1}),[e]),i=In(t);return C.useEffect(()=>{if(!i)return;const l=it(window,{pagehide:()=>a.flush(),beforeunload:f=>{a.flush(),f.returnValue=o.formatMessage({id:"QZrKwi",defaultMessage:"You have a canvas save in progress."})}}),d=it(document,{visibilitychange:()=>a.flush(),keydown:()=>{r.current="keyboard"},mousemove:()=>{r.current!=="mouse"&&a.flush(),r.current="mouse"}});return()=>{r.current=null,d(),l()}},[o,i,a]),C.useEffect(()=>()=>{a.flush()},[t,a]),Dn(async()=>{await a.flush(),await Promise.allSettled(n.current?.map(({promise:l})=>l)??[])}),[C.useCallback((l,d,f)=>{const{textdocId:p}=l;return kn(p),a(l,d,f)},[a]),a.flush,s||i]};function Ao(t,e,n){const s=Mt(),o=n!=null&&e!=null,{data:r,error:a,fetchNextPage:i,hasNextPage:c,isFetching:l}=dn(bt(t,e,o)),d=C.useCallback(async()=>{const h=e!=null;await s.prefetchInfiniteQuery(bt(t,e,h))},[s,t,e]);C.useEffect(()=>{const h=e;return()=>{s.removeQueries({queryKey:Ht(t,h),exact:!0})}},[s,t,e]);const[f,p,T,g]=C.useMemo(()=>{if(r&&n){const m=r.pages.flatMap(w=>w),v=m.findIndex(w=>"beforeVersion"in n?(w.versionInt??Lt)<n.beforeVersion:w.versionInt===n.version);if(v!==-1)return[v===m.length-1,m[v],v>0?m[v-1]:null,v<m.length-1?m[v+1]:null]}const h=r?.pages.flatMap(m=>m)??[];return[!0,null,null,h.length===0?null:h[0]]},[r,n]);return C.useEffect(()=>{!l&&o&&c&&f&&i()},[l,o,c,f,i]),C.useEffect(()=>{!p&&a&&re(t)},[p,a,t]),{historicalTextdocVersion:p,nextHistoricalTextdocVersion:T,prefetchHistoricalTextdocVersion:d,previousHistoricalTextdocVersion:g}}function Ht(t,e=null){return["textdocHistory",t,e]}function bt(t,e,n=!0){return{queryKey:Ht(t,e),queryFn:({pageParam:s})=>Io(t,s),initialPageParam:e??void 0,getNextPageParam:s=>{const o=Ln(s)?.versionInt;if(o&&o>1)return o},enabled:n,staleTime:1/0,retry:2}}async function Io(t,e){return e===void 0?[]:(await St.safeGet("/textdoc/{textdoc_id}/history",{parameters:{path:{textdoc_id:t},query:{before_version:e}}})).previous_doc_states.map(({id:s,version:o,textdoc_type:r,title:a,content:i,updated_at:c,comments:l})=>({textdocId:s,versionInt:o,messageId:null,title:a,type:_n(r),content:i,createdAt:jn(c),comments:Pn(l,i)}))}const zo=({isFullScreen:t=!1,isEmbedded:e=!1,hideHeader:n=!1,readonlyReason:s,clientThreadId:o,focusedTextdoc:r,onClose:a,isAnimating:i=!1,width:c,hideBottomComposer:l=!1})=>{const{textdocId:d,history:f,showChangesAtVersion:p=null}=r,[T,g]=C.useState(!1),h=jt(),[m,v,w]=Mo(d),{targetedContent:b}=Nn(),x=Cs(),[k,L]=C.useState(!1),I=ys(d),_=Ts(),B=ps(o),D=Rn(B),[Me,Ae]=Dt(),ce=On(),{data:q,isLoading:qt}=Hn(d,ce?p:null),[Ie,$t]=C.useState(!1),O=I?.versions??[],Be=O[0]?.versionInt,{historicalTextdocVersion:fe,nextHistoricalTextdocVersion:Ut,previousHistoricalTextdocVersion:Fe,prefetchHistoricalTextdocVersion:Bt}=Ao(d,Be,f),Ft=kt();C.useEffect(()=>{xe.reset()},[d]),C.useEffect(()=>{I?.metadata?.textdocId&&ut().sendMessage({type:Ne.Loaded})},[I?.metadata?.textdocId]);const Ve=O.length>0?O[O.length-1]:null,De=O.length>1?O[O.length-2]:null,Ge=gs(o),{restoreHistoricalTextdocVersion:ze,optimisticRestoredTextdocVersion:Vt}=qn(Ge,Ve,fe),Q=f!=null,E=Q?fe:Ve,de=ce&&p!=null,me=To(o,E),Ye=i||!ce?null:q,he=(()=>{if(i)return[];const y=E?.comments.filter(j=>j.status!==Bn.DISMISSED)??[];return E==null?y:!de&&fe!=null?fe.comments:!de||q==null?y:q.contentBefore!==q.contentAfter?[]:Zs(q.commentsBefore,q.commentsAfter)})(),G=E?.type??H.LOADING,F=!!E?.isPartial,Gt=ts(_);C.useEffect(()=>{O.length===0&&!_&&Gt&&a?.()},[O.length,_]);const zt=!!s&&s!==P.OldVersion,ke=F&&!!E?.isRewriting,Yt=F&&!!E?.isCreation,{content:z,currentlyStreamingLineIndex:We}=q?.contentBefore!=null&&!ne(G)?{content:q.contentBefore,currentlyStreamingLineIndex:null}:Xs(E,De),Wt=Ms(Ge,Array.from(wo(z))),[pe,Le]=js({value:z,isRequestActive:D,isTextdocStreaming:F,comments:he}),Je=$n(E),Qe=F||D||pe||w;C.useEffect(()=>{ut().sendMessage({type:Ne.Streaming,streaming:Qe})},[Qe]);const Jt=({getSerializedDocument:y,getAdjustedComments:S})=>{E&&m(E,y,S)},Qt=y=>{if(!E)return;const S=y.doc.toString();m(E,S,y.field(Xn,!1)??[])},Xe=(y,S,j,Y)=>{Le(!0),me({action:S,content:y,userMessageType:A.ASK_CHATGPT,sourceRange:j,selectionMetadata:{selection_type:Y,selection_position_range:j}})},Ze=({id:y})=>{Je(y,ct.DISMISS),xe.reset()},Ke=async y=>{Le(!0);const{id:S,at:j,content:Y}=y;if(await Je(S,ct.ACCEPT)===!1)return Le(!1);me({content:Y,userMessageType:A.ACCEPT_COMMENT,sourceRange:j,action:W.EDIT,selectionMetadata:{selection_type:ft.SELECTION,selection_position_range:j}})},_e=(y,S,j)=>{const{action:Y}=j;me({action:Y,content:S,sourceRange:y,userMessageType:A.ACCELERATOR,acceleratorMetadata:{action:Y,id:j.id,prompt:S},selectionMetadata:y!=null?{selection_type:ft.SELECTION,selection_position_range:y}:void 0})},Xt=y=>{me({action:W.EDIT,content:y,userMessageType:A.FULL_SCREEN_SUBMIT})},Zt=mn(),Kt=Mt(),en=xs(),et=y=>en?.[y]??y,je=()=>Jn({clientThreadId:o,currentRequestId:B,queryClient:Kt,isHistoryAndTrainingDisabled:Zt}),tn=()=>{f?ye(d,f):re(d)};let M=s;Q?M=P.OldVersion:de?M=P.ShowingChanges:Vt!=null?M=P.Restoring:(F||D)&&(M=P.Streaming);let ge=null;const tt=i||M!=null||pe,nt=()=>{if(i&&he.length>0)return Z.ALL_HIDDEN;if(M==null)return Z.ENABLED;switch(M){case P.Streaming:return Z.ENABLED;case P.ShowingChanges:case P.OldVersion:return Z.COMMENTS_READONLY;default:return Z.ALL_HIDDEN}},st=t||i;let Pe=[];switch(G){case H.LOADING:ge=u.jsx(Qn,{});break;case H.DOCUMENT:ge=u.jsx(Yn,{value:z,comments:he,previousValue:De?.content,previousComments:De?.comments,isRewriting:ke,isAnimatingFromPreview:i,getStableCommentId:et,diff:Ye,isRequestActive:D,isDisabled:M!=null||_,isWaitingForCommentResponse:pe,hideAccelerators:st,hideToolbar:tt,hideEditOverlay:i,commentsMode:nt(),readonlyReason:M,onBlur:v,onSave:v,onChange:Jt,onCancelRequest:je,targetedContent:b,onAddComment:Xe,onAcceptComment:Ke,onDismissComment:Ze,onSubmitAccelerator:_e,onExitShowChanges:tn,safeUrls:Wt,width:c,modelCursor:F&&!ke?E?.modelCursor:void 0,shouldResetSelection:E?.versionInt===1}),Pe=ns;break;default:if(ne(G)){const y=Pt(G,z),S=u.jsx(zn,{id:"codemirror",getStableCommentId:et,language:Un(G),value:z,comments:he,hideAccelerators:st,commentsMode:nt(),hideToolbar:tt,onSubmitAccelerator:_e,currentlyStreamingLineIndex:We??null,readonlyReason:M,isRequestActive:D,isWaitingForCommentResponse:pe,onChange:Qt,onCancelRequest:je,onAddComment:Xe,onDismissComment:Ze,onAcceptComment:Ke,textdocDiff:Ye??void 0,modelCursor:F&&We==null?E?.modelCursor:void 0});ge=!h||!y?S:u.jsxs(u.Fragment,{children:[u.jsx("div",{style:{display:Ie?"none":"block"},children:S}),u.jsx(_s,{hidden:!Ie,textdocContent:z,textdocType:G})]}),Pe=Zn}}return u.jsxs(ee,{children:[T&&u.jsx(Wn,{zIndexKey:"acceleratorsOverlay",className:"bg-white/95 dark:bg-black/85"}),!n&&u.jsx(ao,{textdocId:d,isHistoricalVersion:Q,nextHistoricalTextdocVersion:Ut,previousHistoricalTextdocVersion:Fe,textdocVersion:E,readonlyReason:M,history:f,hasDebug:x,contentWidth:Me.width,isEmbedded:e,isPersisting:w,isShowChangesFeatureEnabled:ce,isShowingChanges:de,latestVersionInt:Be,hideHistoryActions:M===P.QueryParam,prefetchHistoricalTextdocVersion:()=>{Bt();const y=Fe?.versionInt;y!=null&&Ft(d,y)},restoreHistoricalTextdocVersion:ze,setShowDebugView:L,onClose:()=>{N.logButtonClick(oe.CLOSE_TEXTDOC,{textdocType:E?.type}),a?.()},onClickCodePreview:()=>$t(y=>!y),isShowingCodePreview:Ie}),u.jsxs(ee.Content,{ref:Ae,scrollToBottomMode:Yt?"bottom":"top",shouldScrollToTop:ke,isLoading:qt,children:[!1,ge]}),u.jsx(At,{children:Q&&!zt&&u.jsx(Ps,{onClickRestore:ze,onClickResetLatest:()=>re(d)})}),t&&!Q&&!l&&u.jsx("div",{className:"relative flex items-center justify-center pb-3",children:u.jsx(Hs,{isRequestActive:D,clientThreadId:o,onSubmitAccelerator:_e,onSubmit:Xt,onCancel:je,acceleratorActions:Pe,onAcceleratorsExpandedChange:y=>{_t()||g(y)}})})]})};export{Ne as C,zo as T,Is as g,As as i};
//# sourceMappingURL=mszo4oq5hgf7auf0.js.map
