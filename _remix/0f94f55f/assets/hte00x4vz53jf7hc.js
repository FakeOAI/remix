import{aC as G,aA as T,aH as H,S as p,r as k,P as b,a as v,m as o,a5 as h,bd as N,a6 as R,aN as w,eG as q,ad as B,bv as F,a1 as U,c as K,i as V,bJ as Y,eH as Q,eI as W,d2 as D,eJ as X,Z as z}from"./cbv020t7gzp4f872.js";import{bf as S,a8 as y,db as J,au as Z,dc as $}from"./gpe91l6ql3o0s610.js";import{L as C}from"./c039xathbpqv7hjp.js";import{c as ee}from"./eprwd5wd9a7hvvfw.js";import{T as ne}from"./lw9lle2awfx0m3zh.js";function te(){return T("437245079").value}function se(){const e=te(),n=ee(),t=G("1908072088").config.value,{eligible:s,isLoading:i}=S(y.AG8PqS2q);return{eligible:s&&e&&n&&t.blocking_modal===!0,singleButtonVariant:t.single_button_variant===!0,isLoading:i}}const O=y.UseSidekick,oe=y.SidekickLauncherOnboarding,E="https://persistent.oaistatic.com/sidekick/public/ChatGPT_Desktop_public_latest.dmg",L="download";function x(){const e=w(),n=q("1696863369").layer.get("has_sidekick_access",!1);return e!=null&&n}function ae(e){return e===L}function ie(){const e=B(),t=(F(()=>e.asPath)??"").split("#"),s=ae(t[1]);return{openModal:()=>{const l=e.asPath.split("#");e.replace(l[0]+"#"+L)},closeModal:()=>{e.replace(t[0])},isOpen:s}}function ve(e){var d;const{eligible:n,isLoading:t}=se(),s=x(),{eligible:i,isLoading:l}=S(O),{eligible:g,isLoading:m}=S(oe),a=n||!i||!g||!s||((d=e.conversationMode)==null?void 0:d.kind)!==H.PrimaryAssistant,c=t||m||l;return{eligible:!a&&p.getLayerValue({layerName:"1696863369",key:"show_nux_banner",defaultValue:!1}),isLoading:c}}function Se({onClose:e}){k.useEffect(()=>{b.logEvent(v.sidekickAnnouncementShown),p.logEvent("chatgpt_sidekick_announcement_shown")},[]);const{markAsViewed:n}=S(O),t=k.useCallback(()=>{n(),b.logEvent(v.sidekickAnnouncementDismissed),p.logEvent("chatgpt_sidekick_announcement_closed"),e&&e()},[n,e]),s=k.useCallback(()=>{b.logEvent(v.sidekickAnnouncementLinkClicked),p.logEvent("chatgpt_sidekick_announcement_download_clicked"),n(),e&&e()},[n,e]),i={downloadUrl:E,markAsDownloaded:s,markAsViewed:t,isSidekickAvailable:x()};return o.jsx(de,{...i})}function ce(){window.open(E,"_blank")}function le(){var e;return(e=w())!=null&&e.isPlus()?u.bannerTitleMentioningPlus:u.bannerTitleNotMentioningPlus}function _e(){const{closeModal:e,isOpen:n}=ie(),t=x(),s=k.useMemo(()=>({isDesktopAppAvailable:t}),[t]),i=()=>{b.logEvent(v.sidekickDownloadModalClosed,s),p.logEvent("chatgpt_sidekick_modal_closed"),e()},l=()=>{b.logEvent(v.sidekickDownloadModalDownloaded,s),p.logEvent("chatgpt_sidekick_modal_download_clicked"),e()};return k.useEffect(()=>{n&&(b.logEvent(v.sidekickDownloadModalShown,{...s}),p.logEvent("chatgpt_sidekick_modal_shown"))},[s,n]),n?o.jsx(re,{downloadUrl:E,markAsDownloaded:l,markAsViewed:i,isSidekickAvailable:t}):null}function re({downloadUrl:e,markAsDownloaded:n,markAsViewed:t,isSidekickAvailable:s}){const i=s?u.modalTitleEligible:u.modalTitleNotEligible,l=o.jsx(h,{...i}),g=o.jsx(h,{...u.modalContent}),m=s?u.disclaimer:u.comingSoonDisclaimer,a=o.jsx(h,{...m,values:{learnMoreLink:M=>o.jsx(C,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:M})}}),c=o.jsxs("div",{children:[o.jsx("div",{children:g}),o.jsx("div",{className:"mt-2",children:a})]}),d=o.jsx(N,{as:"link",to:e,color:"primary",onClick:n,openNewTab:!0,children:o.jsx(h,{...u.download})}),r=o.jsx(N,{color:"secondary",onClick:t,children:o.jsx(h,{...u.close})}),f=s?d:r,_=s?r:void 0;return o.jsx(J,{onClose:t,title:l,description:c,actionButton:f,cancelButton:_})}function de({markAsDownloaded:e,markAsViewed:n}){const t=U(),s=k.useCallback(()=>{ce(),e()},[e]),i=o.jsx(h,{...le()}),l=o.jsx(h,{...u.bannerContent}),g=o.jsx(h,{...u.disclaimer,values:{learnMoreLink:a=>o.jsx(C,{openNewTab:!0,href:"https://help.openai.com/en/articles/9275200",children:a})}}),m=o.jsxs("div",{className:"flex-grow",children:[o.jsx("div",{className:"mb-0.5 font-semibold",children:i}),o.jsxs("span",{className:"text-token-text-secondary",children:[l," ",g]})]});return o.jsx(Z,{onPrimaryCtaClick:s,primaryCtaText:t.formatMessage(u.download),onDismiss:n,content:m})}const u=R({bannerTitleNotMentioningPlus:{id:"SidekickOnboarding.bannerTitleEnterprisey_2",defaultMessage:"ChatGPT is available for macOS 14+ with Apple Silicon"},bannerTitleMentioningPlus:{id:"SidekickOnboarding.bannerTitleMentioningPlus",defaultMessage:"ChatGPT is now available for macOSâ€”Plus users get early access"},modalTitleEligible:{id:"SidekickOnboarding.modalTitleEligible",defaultMessage:"The ChatGPT app is now available for macOS"},modalTitleNotEligible:{id:"SidekickOnboarding.modalTitleNotEligible",defaultMessage:"The ChatGPT macOS desktop app is coming soon"},modalContent:{id:"SidekickOnboarding.modal_content_eligible",defaultMessage:"Quickly access ChatGPT from anywhere on your computer with a shortcut: Option + Space. Share screenshots, upload files and photos, have voice conversations, and search through past conversations."},bannerContent:{id:"SidekickOnboarding.banner_content_3",defaultMessage:"Get faster access to ChatGPT with the Option + Space shortcut and the floating companion window."},disclaimer:{id:"SidekickOnboarding.disclaimer_3",defaultMessage:"<learnMoreLink>Learn more</learnMoreLink>."},comingSoonDisclaimer:{id:"SidekickOnboarding.coming_soon_disclaimer",defaultMessage:"The app will be available over the next couple of weeks."},download:{id:"SidekickOnboarding.download",defaultMessage:"Download"},close:{id:"SidekickOnboarding.close",defaultMessage:"Close"}}),P=K(V(()=>({statusMap:{}}))),Me=e=>P(n=>n.statusMap[e]),we=(e,n)=>{P.setState(t=>{t.statusMap[e]=n;const s=ne.getServerThreadId(e);s&&(t.statusMap[s]=n)})},j=e=>{P.setState(n=>{for(const{id:t,async_status:s}of e)n.statusMap[t]=s})},I=28,A="conversationHistory";function ye(){const e=Y(),n=(e==null?void 0:e.includes(Q))??!1,t=w(),s=!n&&!!(t!=null&&t.data),i=W.useRelayEnvironment(),{value:l}=T("2893406386"),g=ue(i,s&&l),m=ge(s&&!l),{conversations:a,data:c,fetchNextPage:d,hasNextPage:r,isInitialLoading:f,isFetchingNextPage:_,isError:M}=l?g:m;return{data:c,conversations:a,fetchNextPage:d,hasNextPage:r,isLoading:f,isFetchingNextPage:_,isError:s&&M}}function ue(e,n){const{data:t,fetchNextPage:s,hasNextPage:i,isInitialLoading:l,isFetchingNextPage:g,isError:m}=D({queryKey:[A],queryFn:({pageParam:c})=>X.fetchQuery_DEPRECATED(e,me,{after:c,first:I,order:"updated",expand:!1,isArchived:!1}),initialPageParam:"aWR4Oi0x",getNextPageParam:c=>{var d,r;if((d=c.conversationDisplayHistory)!=null&&d.pageInfo.hasNextPage)return(r=c.conversationDisplayHistory)==null?void 0:r.pageInfo.endCursor},enabled:n}),a=k.useMemo(()=>(t==null?void 0:t.pages.flatMap(c=>{var d;return(((d=c.conversationDisplayHistory)==null?void 0:d.edges)??[]).flatMap(r=>{var f;return r!=null&&r.node?[{id:r.node.id,title:r.node.title??"",create_time:r.node.createTime,update_time:r.node.updateTime,conversation_template_id:(f=r.node.primaryGizmo)==null?void 0:f.id,async_status:r.node.asyncStatus}]:[]})}))??[],[t]);return k.useEffect(()=>{j(a)},[a]),{conversations:a,data:t,fetchNextPage:s,hasNextPage:i,isInitialLoading:l,isFetchingNextPage:g,isError:m}}function ge(e){const{data:n,fetchNextPage:t,hasNextPage:s,isInitialLoading:i,isFetchingNextPage:l,isError:g}=D({queryKey:[A],queryFn:async({pageParam:a})=>{const c=await z.getConversations({offset:a,limit:I});return j(c.items),c},initialPageParam:0,getNextPageParam:a=>{const c=a.offset+a.limit;return c<a.total?c:void 0},enabled:e});return{conversations:k.useMemo(()=>(n==null?void 0:n.pages.flatMap(a=>a.items))??[],[n]),data:n,fetchNextPage:t,hasNextPage:s,isInitialLoading:i,isFetchingNextPage:l,isError:g}}function Ee(e){e.invalidateQueries({queryKey:[A]})}const me=$;export{A as C,_e as D,se as a,Me as b,x as c,ie as d,Se as e,ve as f,Ee as r,we as s,ye as u};
//# sourceMappingURL=hte00x4vz53jf7hc.js.map
