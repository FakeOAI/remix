import{r,bp as q}from"./cbv020t7gzp4f872.js";import{s as B,i as I,a as L,b as $,T as z,C as J,m as Q}from"./i13yvb7mip3btqm2.js";import"./kq3cjnjkkiu42wsi.js";import"./gpe91l6ql3o0s610.js";import"./j1mltnb4g3et1nfv.js";import"./lw9lle2awfx0m3zh.js";import"./fte4amidzwa0x0i9.js";import"./hryykjcwq4fvumfr.js";import"./hewlejwoarda2nb0.js";import"./6belyjcnc0rvmzmg.js";import"./h627sded8tilmz3i.js";import"./nm04jgpfyxi6pn12.js";import"./jcecw02o1g7i3lgl.js";import"./m9c7p1d7qbcooudb.js";import"./nriec8vah7hgye40.js";import"./n1m1f2dq4jbayfm0.js";import"./eprwd5wd9a7hvvfw.js";import"./hte00x4vz53jf7hc.js";import"./c039xathbpqv7hjp.js";import"./4kmoegar8udth7vh.js";import"./le0igyxp535xhyki.js";import"./ihhnf33zws1gyw0j.js";const U=()=>t=>t.targetY,Z=()=>t=>t.targetX-1,ee=()=>t=>t.targetY-1,te=()=>t=>t.targetWidth+2,re=()=>t=>t.targetHeight+2,ie=()=>t=>t.targetY+10,ne=()=>t=>Math.max(0,(t.targetHeight-28)/2),se=B("div")({name:"DataGridOverlayEditorStyle",class:"gdg-d19meir1",propsAsIs:!1,vars:{"d19meir1-0":[U(),"px"],"d19meir1-1":[Z(),"px"],"d19meir1-2":[ee(),"px"],"d19meir1-3":[te(),"px"],"d19meir1-4":[re(),"px"],"d19meir1-5":[ie(),"px"],"d19meir1-6":[ne(),"px"]}});function ae(){const[t,s]=r.useState();return[t??void 0,s]}function oe(){const[t,s]=ae(),[n,g]=r.useState(0),[m,x]=r.useState(!0);r.useLayoutEffect(()=>{if(t===void 0||!("IntersectionObserver"in window))return;const a=new IntersectionObserver(o=>{o.length!==0&&x(o[0].isIntersecting)},{threshold:1});return a.observe(t),()=>a.disconnect()},[t]),r.useEffect(()=>{if(m||t===void 0)return;let a;const o=()=>{const{right:O}=t.getBoundingClientRect();g(p=>Math.min(p+window.innerWidth-O-10,0)),a=requestAnimationFrame(o)};return a=requestAnimationFrame(o),()=>{a!==void 0&&cancelAnimationFrame(a)}},[t,m]);const C=r.useMemo(()=>({transform:`translateX(${n}px)`}),[n]);return{ref:s,style:C}}const Fe=t=>{const{target:s,content:n,onFinishEditing:g,forceEditMode:m,initialValue:x,imageEditorOverride:C,markdownDivCreateNode:a,highlight:o,className:O,theme:p,id:T,cell:S,validateCell:d,getCellRenderer:w,provideEditor:y,isOutsideClick:V}=t,[l,G]=r.useState(m?n:void 0),v=r.useRef(l??n);v.current=l??n;const[h,k]=r.useState(()=>d===void 0?!0:!(I(n)&&(d==null?void 0:d(S,n,v.current))===!1)),c=r.useCallback((e,i)=>{g(h?e:void 0,i)},[h,g]),H=r.useCallback(e=>{if(d!==void 0&&e!==void 0&&I(e)){const i=d(S,e,v.current);i===!1?k(!1):(typeof i=="object"&&(e=i),k(!0))}G(e)},[S,d]),E=r.useRef(!1),f=r.useRef(void 0),A=r.useCallback(()=>{c(l,[0,0]),E.current=!0},[l,c]),K=r.useCallback((e,i)=>{c(e,i??f.current??[0,0]),E.current=!0},[c]),W=r.useCallback(async e=>{let i=!1;e.key==="Escape"?(e.stopPropagation(),e.preventDefault(),f.current=[0,0]):e.key==="Enter"&&!e.shiftKey?(e.stopPropagation(),e.preventDefault(),f.current=[0,1],i=!0):e.key==="Tab"&&(e.stopPropagation(),e.preventDefault(),f.current=[e.shiftKey?-1:1,0],i=!0),window.setTimeout(()=>{!E.current&&f.current!==void 0&&(c(i?l:void 0,f.current),E.current=!0)},0)},[c,l]),R=l??n,[u,X]=r.useMemo(()=>{var i,N;if(L(n))return[];const e=y==null?void 0:y(n);return e!==void 0?[e,!1]:[(N=(i=w(n))==null?void 0:i.provideEditor)==null?void 0:N.call(i,n),!1]},[n,w,y]),{ref:Y,style:j}=oe();let F=!0,P,_=!0,b;if(u!==void 0){F=u.disablePadding!==!0,_=u.disableStyling!==!0;const e=$(u);e&&(b=u.styleOverride);const i=e?u.editor:u;P=r.createElement(i,{isHighlighted:o,onChange:H,value:R,initialValue:x,onFinishedEditing:K,validatedSelection:I(R)?R.selectionRange:void 0,forceEditMode:m,target:s,imageEditorOverride:C,markdownDivCreateNode:a,isValid:h,theme:p})}b={...b,...j};const M=document.getElementById("portal");if(M===null)return console.error('Cannot open Data Grid overlay editor, because portal not found.  Please add `<div id="portal" />` as the last child of your `<body>`.'),null;let D=_?"gdg-style":"gdg-unstyle";return h||(D+=" gdg-invalid"),F&&(D+=" gdg-pad"),q.createPortal(r.createElement(z.Provider,{value:p},r.createElement(J,{style:Q(p),className:O,onClickOutside:A,isOutsideClick:V},r.createElement(se,{ref:Y,id:T,className:D,style:b,as:X===!0?"label":void 0,targetX:s.x,targetY:s.y,targetWidth:s.width,targetHeight:s.height},r.createElement("div",{className:"gdg-clip-region",onKeyDown:W},P)))),M)};export{Fe as default};
//# sourceMappingURL=o5065y18g8vf0h13.js.map
