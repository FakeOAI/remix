import{en as Y,G,r as u,Z as O,m as e,aJ as F,F as q,dO as J,aS as z,eR as V,aD as k,bp as L,d2 as X,b0 as w,fu as I,bV as $,bW as ee,gj as se,fp as E}from"./chhpo5f7h1mkv8bj.js";import{j as P,bw as te,eO as ae,ix as M,bO as ne,aB as ie,c4 as re,iy as v,iz as oe,iA as le,bU as A,iB as ce,dX as de,U as _,ef as me,ak as ue,iC as ge,hH as xe,hI as fe,iD as pe,iE as C,iF as he,iG as p,cQ as Se,iH as be,iI as je,iJ as Ce,dC as ve,iK as B,al as U,iL as ye,iM as ke,iN as Ie,iO as y,iP as ze,dD as Ne,iQ as Me,iR as Ge,iS as Oe,eL as Fe,iT as Te,iU as Le}from"./cfxa008xhk1w4hnw.js";import{as as we,bu as Ee,x as Pe,aw as Ae,K as _e,b7 as Be,L as D,aG as Ue,ad as De}from"./k976jk34eufnjb9r.js";import{m as R}from"./fo76ywp66oc7essj.js";import{a as Re}from"./c8m6a01nqfmcqxlv.js";import{U as We,P as He}from"./mc1jlvit0gqvf2ri.js";function Ke({gizmo:s,historyDisabled:r,section:a,onClick:l,isActive:o,hideOverflowMenu:x=!1}){const{clientThreadId:c}=P();Y(c);const d=G(),[g,h]=u.useState(!1),[n,S]=u.useState(!1),[t,i]=u.useState(o),m=O(),f=!!s?.gizmo.tags?.includes(te.FirstParty),b=!1;let Z=!1;u.useEffect(()=>{o&&i(!0)},[o]);const[Q,$e]=u.useState(0);let j;if(s!=null)j=s.gizmo.display.name||ae;else{if(m==null)return null;r?j=d.formatMessage(M.clearChat):m.canInteractWithGizmos()?j=le:j=d.formatMessage({id:"GizmoSidebarListItem.newChat",defaultMessage:"New chat"})}return e.jsxs(e.Fragment,{children:[e.jsx(R.div,{whileTap:{scale:.98},onMouseEnter:()=>{S(!0)},onMouseLeave:()=>{S(!1)},children:e.jsx(ne,{loggingGizmoId:s?.gizmo.id??"primary",href:s!=null?ie(s):"/",onClick:l,showActiveIndicator:Z,icon:e.jsx(re,{gizmoId:s?.gizmo.id,isFirstParty:s==null||f,gizmoEmoji:s?.gizmo.display.emoji,src:s?.gizmo.display.profile_picture_url,className:"h-6 w-6"}),isMenuOpen:g,label:j,hoverLeftIcon:n&&s&&b&&Q&&e.jsx("button",{onClick:N=>{N.preventDefault(),i(!t)},className:"flex text-token-text-secondary hover:text-token-text-primary",children:e.jsx("div",{className:"h-6 w-6",children:e.jsx("div",{className:"relative flex h-full items-center justify-center text-token-text-primary",children:t?e.jsx(we,{className:"icon-md"}):e.jsx(Ee,{className:"icon-md"})})})}),rightIcon:a===v.Workspace&&e.jsx(F,{side:"right",label:d.formatMessage(T.workspaceRecommended,{workspace_name:m?.name??"Your Workspace"}),children:e.jsx(Pe,{className:"icon-md text-token-text-secondary",alt:d.formatMessage(T.workspaceRecommended,{workspace_name:m?.name??"Your Workspace"})})}),hoverRightIcon:e.jsxs("div",{className:"flex gap-2",children:[(n||g)&&s!=null&&!b&&!x&&e.jsx("div",{className:"text-token-text-tertiary",onClick:N=>{N.preventDefault()},children:e.jsx(oe,{gizmo:s,isOpen:g,setIsOpen:h,section:a})}),!x&&e.jsx(F,{side:"right",label:d.formatMessage(r?M.clearChat:M.newChat),className:"flex items-center",children:e.jsx("button",{className:g?"text-token-text-tertiary":"invisible text-token-text-secondary hover:text-token-text-primary group-hover:visible",children:r?e.jsx(Ae,{className:"icon-md"}):e.jsx(_e,{className:"icon-md"})})})]})})}),!1]})}const T=q({workspaceRecommended:{id:"gizmo.workspaceRecommended",defaultMessage:"Recommended at {workspace_name}"}});function W(){const s=G(),r=A(),a=s.formatMessage({id:"gizmo.exploreStoreEnabled",defaultMessage:"Explore GPTs"});return e.jsx(ce,{children:e.jsx(R.div,{whileTap:{scale:.98},children:e.jsx(J,{to:de(),onClick:()=>{r.activeSidebar==="popover-nav"&&_.setActiveSidebar(!1)},children:e.jsx(me,{icon:Be,"data-testid":"explore-gpts-button",children:a})},"explore")})})}const Ze=2;function H({gizmos:s,isGizmoFlyout:r,isLoaded:a,maxToShowOnLoad:l=4,isScreenArch:o,showAllSidebarItems:x}){const c=pe(s,i=>i.flair.kind),d=[...(c[C.Workspace]?.map(({resource:i})=>({gizmo:i,section:v.Workspace}))??[]).slice(0,3),...c[C.FirstParty]?.map(({resource:i})=>({gizmo:i,section:v.Keep}))??[],...c[C.SidebarKeep]?.map(({resource:i})=>({gizmo:i,section:v.Keep}))??[]],g=c[C.Recent]?.slice(0,o||a?c[C.Recent]?.length:Ze).map(({resource:i})=>({gizmo:i,section:v.Recents}))??[],h=g.length,n=d.length,S=o?h>0:s.length>l;let t=[];return r&&o?t=[...d,...g]:!r&&o?t=d:(t=[...d,...g],x||(t.length>l&&n>l?t=t.slice(0,n):t.length>l&&(t=t.slice(0,l)))),{listItems:t,itemsLeft:s.length-t.length,needsToCollapseItems:S,total:s.length}}function K({gizmo:s,currentGizmoId:r,maxToShowOnLoad:a,hideOverflowMenu:l=!1}){const o=u.useRef(!1),x=!a,c=ue(),[d,g]=u.useState(!1),h=A(m=>!ge.isGptListCollapsed(m)),{listItems:n,needsToCollapseItems:S,itemsLeft:t}=H({gizmos:s,isGizmoFlyout:x,isLoaded:d,maxToShowOnLoad:a,isScreenArch:c,showAllSidebarItems:h});u.useEffect(()=>{d||g(!0)},[d]),u.useEffect(()=>{n.length>0&&!o.current&&(xe({namespace:fe.ChatPageLoad})?.logTiming("render_gizmo_sidebar"),o.current=!0)},[n]);function i(m,f){const b=e.jsx(Ke,{gizmo:m,isActive:m.gizmo.id===r,section:f,hideOverflowMenu:l},m.gizmo.id);return c?e.jsx("li",{children:b}):b}return e.jsxs("div",{children:[n.map(({gizmo:m,section:f},b)=>e.jsxs(u.Fragment,{children:[b>1&&f!==n[b-1].section&&e.jsx("div",{className:"my-2 ml-2 h-px w-7 bg-token-sidebar-surface-tertiary"}),i(m,f)]},b)),!c&&S?e.jsxs("button",{onClick:_.toggleGptListCollapsed,className:"flex h-10 w-full items-center gap-2 rounded-lg px-2 text-sm text-token-text-primary hover:bg-token-sidebar-surface-secondary",children:[e.jsx("div",{className:"flex h-6 w-6 flex-shrink-0 items-center justify-center",children:e.jsx(D,{className:"icon-md text-token-text-primary"})}),e.jsx("div",{className:"flex grow items-center gap-1",children:h?e.jsxs(e.Fragment,{children:[e.jsx(z,{id:"GizmoSidebarList.showLess",defaultMessage:"See less"}),e.jsx(Ue,{className:"icon-xs"})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{id:"GizmoSidebarList.showMoreItems",defaultMessage:"{numMore} more",values:{numMore:t}}),e.jsx(De,{className:"icon-xs"})]})})]}):null,!c&&e.jsx(W,{})]})}function Qe({currentGizmoId:s,gizmos:r,onClick:a}){const{isSidebarFlyoutOpen:l,onSidebarFlyoutOpenChange:o}=he(),x=l(p.Gizmo);return e.jsx("div",{className:"group mt-1 flex w-full items-center justify-start",children:e.jsx(V,{onOpenChange:c=>o(p.Gizmo,c),side:"right",sideOffset:4,open:x,contentAlign:"end",triggerButton:e.jsxs("button",{className:k("flex flex-1 select-none items-center gap-2 rounded-lg px-2 py-2 text-sm tracking-condensed text-token-text-secondary hover:bg-token-main-surface-secondary focus:ring-0",x&&"bg-token-main-surface-secondary"),onClick:a,children:[e.jsx(D,{className:k("icon-md mr-1 font-semibold text-token-sidebar-icon")}),e.jsx("span",{className:"text-left",children:e.jsx(z,{id:"qTIiY/",defaultMessage:"See more"})})]}),size:"auto",children:e.jsx("div",{className:"max-h-[50dvh] overflow-x-auto px-2 [scrollbar-gutter:stable]",children:e.jsx(L,{children:e.jsx("ul",{className:"flex flex-col gap-0.5",children:e.jsx(K,{gizmo:r,currentGizmoId:s,hideOverflowMenu:!0})})})})})})}function Ye({currentGizmoId:s}){const{data:{gizmos:r}={}}=Se();let a=r;const l=!a||a?.length===0,{needsToCollapseItems:o}=H({gizmos:a??[],isLoaded:!1,isGizmoFlyout:!1,isScreenArch:!0});return l?null:e.jsx(e.Fragment,{children:e.jsxs(be,{header:e.jsx("div",{className:"sticky top-[--sidebar-sticky-threshold] z-20",children:e.jsx(z,{id:"ZT2HVu",defaultMessage:"GPTs"})}),isLastInGroup:!0,children:[e.jsx(W,{}),e.jsx(K,{gizmo:a??[],currentGizmoId:s,maxToShowOnLoad:je}),o&&e.jsx(L,{children:e.jsx(Qe,{currentGizmoId:s,gizmos:a??[]})})]})})}function qe({clientThreadId:s}){const r=O(),a=X(s),{isUnauthenticated:l}=w();return l?null:e.jsxs("div",{className:k(I.screenContent),children:[null,e.jsx(Ce,{clientThreadId:s}),r?.canInteractWithGizmos()?e.jsx(Ye,{currentGizmoId:a}):null]})}function Je(){const s=O(),r=s?.data==null,{isUnauthenticated:a}=w(),{openSettings:l}=ve(),[o]=u.useState(()=>{const n=$.getCookie(ee.Workspace);return typeof n=="string"&&n!==se}),x=G(),{store:c,actions:d}=B(),g=c(n=>n.mode);if(!s||o&&r)return null;const h=a?e.jsx(We,{}):e.jsx(Re,{onClickSettings:()=>l()});return e.jsxs(U,{name:"user-profile-bar",className:"z-10 mb-[0.5px] grid-cols-[minmax(0,_1fr)_auto] px-sidebar-inline md:py-1.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:[h,e.jsx("div",{className:I.togglePinWrapper,children:e.jsx(ye,{tooltipSideOffset:14,className:I.pinSidebarAction,icon:e.jsx(ke,{}),onActivate:n=>{n.preventDefault(),n.persist(),Ie.togglePinSidebar(n,d,g===y.Floating?y.Pinned:y.Floating)},label:g===y.Floating?x.formatMessage({id:"b43Hkt",defaultMessage:"Pin Sidebar"}):x.formatMessage({id:"6m3n9w",defaultMessage:"Unpin Sidebar"}),htmlFor:E.FloatingOrPinned})})]})}function Ve(){return e.jsx(U,{className:"z-10 px-sidebar-inline pb-0.5",type:"primary",disableSizeTracking:!0,style:{"--bar-gap":"12px","--bar-background-color":"transparent"},children:e.jsx(He,{})})}function Xe(){return e.jsxs(ze,{className:k(I.screenTrailingBarContainer),children:[e.jsx(Ne,{}),e.jsx(Ve,{}),e.jsx(Je,{})]})}function rs(){const{clientThreadId:s,onNewThread:r}=P(),[a,l]=u.useState(!1),[o,x]=u.useState(!1),[c,d]=u.useState(!1),{store:g}=B(),h=u.useCallback(t=>t===p.Conversation?a:t===p.Gizmo?o:t===p.Conversation2?c:!1,[a,o,c]),n=u.useCallback((t,i)=>{const m=f=>{t===p.Conversation?l(f):t===p.Gizmo?x(f):t===p.Conversation2&&d(f)};if(i){m(i);return}setTimeout(()=>{m(i)},100)},[]),S=u.useRef(null);return Me((t,i)=>{n(p.Conversation,!1),n(p.Gizmo,!1),n(p.Conversation2,!1);const m=window.matchMedia("(max-width: 700px)").matches,f=Le(S.current);i!=null&&m&&g.getState().isSidebarOpen&&(g.getState().mode===y.Floating||f)&&setTimeout(()=>{document.getElementById(E.OpenOrClosed)?.click()},100)}),e.jsxs(Ge,{value:{isSidebarFlyoutOpen:h,onSidebarFlyoutOpenChange:n},children:[e.jsx(Oe,{}),e.jsx(Fe,{anchor:"vertical",className:k(I.screen,"popover flex-1 border-r border-r-token-border-xlight"),name:"sidebar",leading:e.jsx(Te,{onNewThread:r}),ref:S,trackLeading:!0,trailing:e.jsx(Xe,{}),children:e.jsx(qe,{clientThreadId:s})})]})}export{rs as C,Ke as G,K as a};
//# sourceMappingURL=f27spytdn749tftq.js.map
