import{r as g,y as e,a1 as w,X as R,a9 as W,ag as q,u as K,h as X,l as O,a6 as $,e$ as Q,j as Z,av as I,bq as ee,ar as se}from"./mvabgae368c8ppg9.js";import{a as te,b as ae,u as ne,e as re}from"./ci2i0i8ecwvoi84z.js";import{a as oe,d as U,e as F,f as H}from"./b0fwi5sx64zzt8jv.js";import{ag as ie,t as le,I as ce,bj as de}from"./hrs6fo7evr0q6t9c.js";import{S as u}from"./eap3oc6wp9aeta5h.js";import{U as A,G as N,a as ue}from"./cgk4v2mv167tmqt6.js";import{N as f,ao as me,h as xe}from"./gne0fkkyhu79w0cj.js";import{D}from"./bys7numkrxh763iw.js";import"./msipipmnnjcgrg74.js";import"./h8c08huq7kdim7pd.js";import"./lzx8u2ugd2jcjw0l.js";import"./hrszfqnlwp1fnoth.js";import"./odxqs5vnww3rcto3.js";import"./cgndeylrkni3styz.js";import"./fj28aivwf4skbrrx.js";import"./e4lojulx63yb1fnu.js";import"./f60kma9ld119vtbt.js";import"./im6spfpu2oz5vkzx.js";import"./ia6dvimohnab119m.js";import"./imrwt71oa8fmnhl5.js";import"./lzr8wefq7d448q1p.js";import"./mkyfsvjhn6f4m4aq.js";const P={NAME_KEYWORD:"Name keyword",NAME_SUBSTRING:"Name substring"},y={USERS:"User",GROUPS:"Group",SHARED_DRIVE:"Shared drive",...P},fe={ALL:"All exclusion types",...P},V={ALL:"All exclusion types",...y};var L=(s=>(s.EXCLUDE="exclude",s.INCLUDE="include",s))(L||{});const pe=[["sensitive_object_name_keywords",y.NAME_KEYWORD],["sensitive_object_name_substrings",y.NAME_SUBSTRING],["sensitive_users",y.USERS],["sensitive_groups",y.GROUPS],["sensitive_shared_drive_ids",y.SHARED_DRIVE]],Y={},B={};pe.forEach(([s,a])=>{Y[s]=a,B[a]=s});function ge(s){const a=[];for(const[l,i]of Object.entries(s))for(const[t,n]of Object.entries(i)){const m=Y[t];if(m){if(Array.isArray(n))n.forEach((x,c)=>{a.push({id:`${l}_${t}_${c}`,lastModifiedTime:i.last_modified_time,name:x,exclusionType:m,parentId:l,parentType:i.type})});else if(typeof n=="object"&&n!=null)for(const x of Object.keys(n))a.push({id:`${l}_${t}_${x}`,lastModifiedTime:i.last_modified_time,name:x,exclusionType:m,parentId:l,parentType:i.type})}}return a}function he(s){return Object.values(s)[0]?.last_modified_time}function Me(s){return Object.keys(s)[0]}function ye(s){return!!Object.values(s)[0]?.is_oauth}function je(s){return Object.values(s)[0]?.default_shared_drive_exclusion_selection??null}const k=10;function Ce({rowData:s,filterInputValue:a,filterType:l,workspaceId:i}){const[t,n]=g.useState(0);g.useEffect(()=>{n(0)},[a,l]);const m=s.filter(d=>d.name.toLowerCase().includes(a.toLowerCase())&&(l===V.ALL||d.exclusionType.toLowerCase()===l.toLowerCase())),x=m.slice(t*k,(t+1)*k),c=Math.ceil(m.length/k);return e.jsxs("div",{className:"mb-6",children:[e.jsxs(f.Root,{fixed:!0,size:"normal",children:[e.jsxs(f.Header,{children:[e.jsx(f.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(w,{...j.name})}),e.jsx(f.HeaderCell,{className:"w-40 bg-token-main-surface-primary",children:e.jsx(w,{...j.type})}),e.jsx(f.HeaderCell,{className:"w-16 bg-token-main-surface-primary"})]}),e.jsxs(f.Body,{children:[x.map(d=>e.jsx(Ee,{config:d,workspaceId:i},d.id)),x.length===0&&e.jsx(f.Row,{children:e.jsx(f.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(w,{...j.noResults})})})})]})]}),c>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(me,{currentPage:t,onChangeIndex:n,length:c})})]})}function Ee({config:s,workspaceId:a}){const l=R(),i=W(),t=q(),n=K(),m=X({mutationFn:c=>{const d={store_id:c.storeId,operations:c.operations,last_modified_time:c.lastModifiedTime};return O.updateKnowledgeStoreExclusionConfig(d,c.accountId)},onSuccess:()=>{n.invalidateQueries({queryKey:["listExclusionConfigs",a]}),i.success(l.formatMessage(j.deleteConfigSuccessMessage),{duration:3})},onError:()=>{i.danger(l.formatMessage(j.deleteConfigGenericErrorMessage),{duration:3})}}),x=()=>{if(!s.parentId){i.danger(l.formatMessage(j.deleteConfigGenericErrorMessage),{duration:3});return}if(!t){i.danger(l.formatMessage(j.deleteConfigGenericErrorMessage),{duration:3});return}const c={action:Q.REMOVE,field:B[s.exclusionType],value:s.name};m.mutate({storeId:s.parentId,operations:[c],lastModifiedTime:s.lastModifiedTime,accountId:t.id})};return e.jsxs(f.Row,{children:[e.jsx(f.Cell,{className:"whitespace-normal break-all",children:e.jsx("span",{children:s.name})}),e.jsx(f.Cell,{className:"whitespace-nowrap",children:e.jsx("span",{children:s.exclusionType})}),e.jsx(f.Cell,{children:e.jsx(be,{onDelete:x})})]})}function be({onDelete:s}){return e.jsxs(D.Root,{children:[e.jsx(D.Trigger,{children:e.jsx(ie,{className:"icon-sm cursor-pointer"})}),e.jsx(D.Portal,{children:e.jsx(D.Content,{children:e.jsx(D.Item,{className:"cursor-pointer",onClick:s,children:e.jsx(w,{...j.deleteConfig})})})})]})}const j=$({name:{id:"B+5Xa5",defaultMessage:"Name"},type:{id:"DY07PN",defaultMessage:"Type"},deleteConfig:{id:"fB8e41",defaultMessage:"Delete config"},noResults:{id:"x1Ejc3",defaultMessage:"No results"},deleteConfigSuccessMessage:{id:"d60LPO",defaultMessage:"Exclusion deleted successfully."},deleteConfigGenericErrorMessage:{id:"pOww+E",defaultMessage:"Error deleting exclusion."}});function ve({currentWorkspaceId:s}){const a=R(),[l,i]=g.useState(""),{data:t}=Z({queryKey:["listExclusionConfigs",s],queryFn:()=>O.listExclusionConfigs(s)}),n=t?ge(t):[],m=t?Me(t):null,x=t?he(t):null,c=t?ye(t):!1,d=t?je(t):null,[v,C]=g.useState(V.ALL),[E,h]=g.useState(""),S=g.useCallback(xe(b=>{h(b)},250),[]);return e.jsxs(e.Fragment,{children:[e.jsx(te,{title:a.formatMessage(o.title)}),e.jsx(ae,{children:e.jsxs(oe,{className:"mt-6 gap-6",children:[!c&&d&&e.jsxs(U,{children:[e.jsx(F,{children:a.formatMessage(o.sharedDriveSectionHeader)}),e.jsx(H,{className:"text-token-text-secondary",children:d===L.INCLUDE?a.formatMessage(o.sharedDriveInclusionDefaultSubtitle):a.formatMessage(o.sharedDriveExclusionDefaultSubtitle)})]}),e.jsxs(U,{children:[e.jsx(F,{children:a.formatMessage(o.exclusionsSectionHeader)}),e.jsx(H,{className:"text-[var(--Primary-Gray-600,_#565869)]",children:a.formatMessage(o.exclusionsSectionDescription)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"icon-sm absolute left-2 top-1/2 -translate-y-1/2 transform text-token-text-tertiary"}),e.jsx("input",{type:"text",value:l,onChange:b=>{i(b.target.value),S(b.target.value)},placeholder:a.formatMessage(o.search),className:"w-48 rounded-lg border border-token-border-light bg-token-main-surface-primary pl-8 text-base placeholder:text-token-text-tertiary"})]}),e.jsx(Se,{filterType:v,setFilterType:C,isOAuth:c})]}),e.jsx(I,{className:"max-w-[192px] rounded-lg border text-base",color:"primary",icon:ce,onClick:()=>{A.openModal(N.CreateExclusion)},children:a.formatMessage(o.createExclusionButton)})]}),e.jsx(Ce,{rowData:n,filterInputValue:E,filterType:v,workspaceId:s})]})}),e.jsx(De,{currentWorkspaceId:s,parentId:m,lastModifiedTime:x,isOAuth:c,defaultSharedDrivePolicy:d})]})}function Se({filterType:s,setFilterType:a,isOAuth:l}){return e.jsx("div",{className:"max-w-[208px]",children:e.jsxs(u.Root,{value:s,onValueChange:i=>a(i),disabled:!1,children:[e.jsxs(u.Trigger,{className:"rounded-lg border border-token-border-light py-5 text-base",children:[e.jsx(u.Value,{}),e.jsx(u.Icon,{})]}),e.jsx(u.Portal,{children:e.jsx(u.Content,{children:Object.entries(l?fe:V).map(([i,t])=>e.jsx(u.Item,{value:t,className:"text-base",children:t},i))})})]})})}function De({currentWorkspaceId:s,parentId:a,lastModifiedTime:l,isOAuth:i,defaultSharedDrivePolicy:t}){const n=R(),m=q(),x=K(),c=ue(N.CreateExclusion),[d,v]=g.useState(""),[C,E]=g.useState([]),[h,S]=g.useState(""),[b,M]=g.useState(null),z=r=>{r.key==="Enter"||r.key===","?(r.preventDefault(),h.trim()&&(E([...C,h.trim()]),S(""))):r.key==="Backspace"&&!h&&G(C.length-1)},G=r=>{E(C.filter((p,T)=>T!==r))},_=X({mutationFn:r=>{const p={store_id:r.storeId,operations:r.operations,last_modified_time:r.lastModifiedTime};return O.updateKnowledgeStoreExclusionConfig(p,r.accountId)},onSuccess:()=>{x.invalidateQueries({queryKey:["listExclusionConfigs",s]}),E([]),v(""),S(""),A.closeModal(N.CreateExclusion)},onError:()=>{M(o.creationModalGenericErrorMessage)}}),J=()=>{const r=[...C];if(h.trim()&&r.push(h.trim()),!a){M(o.creationModalGenericErrorMessage);return}if(!m){M(o.creationModalGenericErrorMessage);return}if(!d){M(o.creationModalValueErrorMessage);return}if(r.length===0){M(o.creationModalValueErrorMessage);return}M(null);const p=r.map(T=>({action:Q.ADD,field:B[d],value:T}));_.mutate({storeId:a,operations:p,lastModifiedTime:l,accountId:m.id})};return e.jsx(ee,{size:"custom",className:"max-w-lg overflow-y-auto text-base",isOpen:c,onClose:()=>{A.closeModal(N.CreateExclusion),M(null),E([])},showCloseButton:!0,type:"success",title:n.formatMessage(o.creationModalTitle),description:"",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("p",{className:"inline-flex items-center pb-2 text-base",children:n.formatMessage(o.creationModalExclusionType)}),e.jsxs(u.Root,{value:d,onValueChange:r=>v(r),disabled:!1,children:[e.jsxs(u.Trigger,{className:"justify-between rounded-lg border border-token-border-light py-5 text-base",children:[e.jsx(u.Value,{placeholder:"Select exclusion type"}),e.jsx(u.Icon,{})]}),e.jsx(u.Portal,{children:e.jsx(u.Content,{children:Object.entries(i?P:y).map(([r,p])=>e.jsx(u.Item,{value:p,className:"text-base",children:p},r))})})]}),e.jsx("p",{className:"inline-flex items-center pb-2 pt-6 text-base",children:n.formatMessage(o.creationModalExclusionValue)}),e.jsxs("div",{className:"flex flex-wrap items-center rounded-lg border border-token-border-light bg-token-main-surface-primary text-base",children:[C.map((r,p)=>e.jsxs("div",{className:"mx-1.5 my-2 flex min-w-0 cursor-pointer items-center rounded-full bg-gray-200 px-3.5 py-1 font-medium text-black",children:[e.jsx("span",{className:"overflow-hidden text-ellipsis whitespace-nowrap",children:r}),e.jsx(I,{onClick:()=>{G(p)},color:"ghost",className:"ml-2 min-h-0 p-0 text-gray-600 hover:text-red-700",icon:de})]},p)),e.jsx("input",{type:"text",value:h,onChange:r=>S(r.target.value),onKeyDown:z,placeholder:n.formatMessage(o.creationModalValuePlaceholder),className:"w-full min-w-0 flex-1 overflow-x-auto border-none bg-transparent text-base placeholder:text-token-text-tertiary focus:border-transparent focus:outline-none focus:ring-0"})]}),e.jsx("p",{className:"mt-1 inline-flex items-center text-sm text-token-text-secondary",children:!i&&d===y.SHARED_DRIVE&&t?t===L.INCLUDE?n.formatMessage(o.creationModalSeparateByCommasAndDefaultIncludeDrives):n.formatMessage(o.creationModalSeparateByCommasAndDefaultExcludeDrives):n.formatMessage(o.creationModalSeparateByCommas)}),b&&e.jsx("p",{className:"mt-4 text-sm text-red-500",children:n.formatMessage(b)}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(I,{className:"mt-6 w-full max-w-[92px] rounded-lg border text-base",color:"secondary",onClick:()=>{A.closeModal(N.CreateExclusion),E([]),M(null)},children:n.formatMessage(o.creationModalCancelButton)}),e.jsx(I,{className:"mt-6 w-full max-w-[92px] rounded-lg border text-base",color:"primary",onClick:J,disabled:_.status==="pending",children:_.status==="pending"?e.jsx(se,{}):n.formatMessage(o.creationModalCreateButton)})]})]})})}const o=$({title:{id:"j2s2hr",defaultMessage:"Google Drive Connection"},search:{id:"NxiatU",defaultMessage:"Search"},sharedDriveSectionHeader:{id:"MoVjjM",defaultMessage:"Shared Drives"},sharedDriveInclusionDefaultSubtitle:{id:"QpN++w",defaultMessage:"Shared drives are included by default. You can set overrides to exclude specific shared drives in the exclusions section."},sharedDriveExclusionDefaultSubtitle:{id:"Id1y2X",defaultMessage:"Shared drives are excluded by default. You can set overrides to include specific shared drives in the exclusions section."},exclusionsSectionHeader:{id:"D6JZP8",defaultMessage:"Exclusions"},exclusionsSectionDescription:{id:"9a9d/v",defaultMessage:"Manage which files will be excluded from being indexed by ChatGPT."},createExclusionButton:{id:"nKYBN7",defaultMessage:"Create exclusion"},creationModalTitle:{id:"ET+VpS",defaultMessage:"New exclusion"},creationModalExclusionType:{id:"I+xnyV",defaultMessage:"Type"},creationModalValuePlaceholder:{id:"hua2tW",defaultMessage:"String"},creationModalExclusionValue:{id:"aAr8X0",defaultMessage:"Value"},creationModalSeparateByCommas:{id:"HQDOHA",defaultMessage:"Separate values by commas"},creationModalSeparateByCommasAndDefaultIncludeDrives:{id:"qXuyO7",defaultMessage:"Separate values by commas. Any shared drive IDs added here will be excluded from indexing."},creationModalSeparateByCommasAndDefaultExcludeDrives:{id:"PQPdqt",defaultMessage:"Separate values by commas. Any shared drive IDs added here will be indexed."},creationModalCreateButton:{id:"GsyTJk",defaultMessage:"Create"},creationModalCancelButton:{id:"kUO70c",defaultMessage:"Cancel"},creationModalGenericErrorMessage:{id:"wUcmIJ",defaultMessage:"Error creating exclusion."},creationModalValueErrorMessage:{id:"+2RviF",defaultMessage:"Please enter all required fields."}});function Ye(){const s=ne();return re(),e.jsx(ve,{...s})}export{Ye as default};
//# sourceMappingURL=j02274rxszrkdw91.js.map
