const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/e6476rboo2cz5t2v.js","assets/hc9xxm00a3r3byem.js","assets/fga5qe14lr2llx8v.js","assets/root-gxieg4k5.css","assets/sso-ihqxdzxswuiox36n.js","assets/ozzpumen10p6g0yq.js","assets/index-small-c8xg50op.css","assets/guykwp3ov0cliuel.js","assets/eq9w2mijkl5gcncq.js","assets/k0a5tmklve7lhdwt.js","assets/io7lyk89lbveno1g.js","assets/kwn3fefba30wvgsb.js","assets/hzcrrlyorrog0p41.js","assets/jt3dvx97wm610wtl.js","assets/iyldmwu8ywhos7ff.js","assets/ovjwzbtdrcsgos3a.js","assets/cqwvbnjobeewuxnd.js","assets/c4ub15ug1kevxj8w.js","assets/g8nlf109ai64grtj.js","assets/facz9srd4e5z6fv5.js","assets/lyr64vj216kc7moh.js","assets/cpyn50o38nwfhwhi.js","assets/lgu0ki3gruqsdrdd.js","assets/l02mntsvyz06f5g3.js","assets/i9qil017zb3p1czr.js","assets/j6ap2wbjx1muhlqy.js","assets/k6kl8m1o5r79l67s.js","assets/hmu1ot8fm4uszmig.js","assets/c6gg5hubzrgc52sj.js","assets/oz2p01rklj1p4n8d.js","assets/lxui8l23v2tzixf9.js","assets/btg2u9gpl3szhq0h.js","assets/gi4dwz24es0xqvpd.js","assets/6tjupkkyx0z5k2fa.js","assets/j8vh1bvwq2thm6el.js","assets/hdncrjsjzzuve3ru.js","assets/cj3cq0j3ew1e2kbz.js","assets/lqlcwrsq68jkt57a.js","assets/nug034oo81goid6a.js","assets/n1uzh05qecnh8ko6.js","assets/le2xruw7cnm9ag5m.js","assets/fi9p3eeu24b9vfd1.js","assets/caxkuyopolf76hse.js","assets/exuoj3g9rvnr47xj.js","assets/o65h1gsmgo0mfsrq.js","assets/nbrfb6b5fqz7ea4t.js","assets/btkpb7dih1nft29s.js","assets/flu5midy8l1pp37c.js","assets/m0hxapdm52wypf6x.js","assets/b2rny0kod41myp87.js","assets/kptbw01pxwd1ocyc.js","assets/os9q9b6j79v07zj6.js","assets/k9btfb42xrk56ut9.js","assets/mafougdlzkh8qo68.js","assets/mnfbtuy5shn7j7rh.js","assets/h3k8refrd2si6yl9.js","assets/eozgrwgbmz9gatod.js","assets/fr59f31fg6jwe2u4.js","assets/isu9bse2a2oa6tex.js","assets/gi3tzluaomiird95.js","assets/bdei09nh6a4fidtg.js","assets/d0g8ptgc5gcqjwyj.js","assets/ldsypk8ae9f813gj.js","assets/j6bclhc7cbp7p32x.js","assets/isjdmfmhzv09v01t.js","assets/gr8wto7g581ivnj9.js","assets/j1lknt8seu6gd994.js","assets/eptaxtrdc5yo19ql.js","assets/mivz1ihv23m4q321.js","assets/ejr5bx585q00u2xr.js","assets/exmmesynbikjnder.js","assets/hgnflhls3cvgkj18.js","assets/qknnp5ml7bnljg47.js","assets/orzvve5u2p4b12ln.js","assets/e70ig0kgiu5e598s.js","assets/jrqybevk2xmg1j7t.js","assets/eaz86xbejavxr5kl.js","assets/d5gp1p3nlkkh1n5f.js","assets/clqpk0txvmrxgdlw.js","assets/clolni79kv2kq9pa.js","assets/nxwz9vaydgrnlkdl.js","assets/ed0icvfo2r5i5rtx.js","assets/kqwdyvkaaavvn8k3.js","assets/mc2unsdb4z4goxuv.js","assets/j10j4o3neo99b7zs.js","assets/do5dtfxps7uqtxpp.js","assets/kg9nkh26be0hgljf.js","assets/iv4ixuukcg9wgx9n.js","assets/jivegfkq3c3y773c.js","assets/lqbe15vkljpbygph.js","assets/c42bkcuslwv6041k.js","assets/ml6caj8ci8ergnrl.js","assets/o1ngi5g6kc1pvwll.js","assets/shared-mk6ngktc.css","assets/n3ty0r2frjejpyv8.js","assets/fsddy3bxlesj6ecw.js","assets/gbhwfxebtmzdjc5b.js","assets/b15s8fk5jsrtemdo.js","assets/g38016pkmz5kqvdj.js","assets/cudyehvey3vajzc8.js","assets/fentbcf1kft3zbjx.js","assets/gqw4n5vk4ei2sng7.js","assets/hd1qgib7s68j49he.js","assets/hjr2ka8peesj2qf7.js","assets/gfds12tx8qpu0ipq.js","assets/dsvckya76mm06sjp.js","assets/iej0cupg2dqkmejt.js","assets/nhwwej1nq0zrd7sc.js","assets/sso-bmfhfemd.css","assets/iqvwu2kwo3fu70ma.js","assets/gd8pozsaf0jikwjx.js","assets/olf0ghybf24bnz6o.js","assets/o7tg2hyicap3122c.js","assets/jzvtijirzcpvaajw.js","assets/c1hyxnl6kpsjtl7u.js","assets/lk8bqzua7fjya6ep.js","assets/h603pj0ovegt4tgz.js","assets/j9ybtsexrrxsl9vq.js","assets/cu7i7jyqvstu6net.js","assets/miwz08wj07jf3elq.js"])))=>i.map(i=>d[i]);
import{F as Ge,j as e,T as c,E as Se,r as x,c6 as W,a4 as Z,u as Be,v as Le,ax as de,ay as ye,a3 as Re,bc as $,G as ne,aj as Fe,ak as Oe,k as ke,c as ie,p as Ht,R as Ee,t as J,I as xe,z as Vs,J as Ks,aO as vs,dC as Ys,cT as De,X as $s,Y as Qs,B as Xs,as as ys,cX as Vt,dG as Js,K as Zs,aN as Me,eG as Kt,aC as Ae,at as ue,aD as Yt,aZ as zs,a_ as Ds,a$ as et,cI as st,ej as Ce,D as cs,eJ as $t,aP as Qt,h as Xt,bG as Jt,N as Ps,O as Ss,aW as Zt}from"./hc9xxm00a3r3byem.js";import{I as $e,n as zt,dg as tt,dh as at,di as nt,V as it,M as ds,b2 as Dt,X as Qe,Y as rt,dj as ea,bl as ot,bj as sa,aL as lt,i as ks,dk as Cs,T as ct,dl as dt,W as ta}from"./ozzpumen10p6g0yq.js";import{e as g,u as ut,a as Ie,C as B,Q as pt,R as mt,S as us,T as D,U as Ve,N as ft,V as Ue,f as bs,W as aa,X as na,h as ia,Y as ra,i as oa,Z as la,_ as ca,$ as Is,a0 as da}from"./lyr64vj216kc7moh.js";import{_ as gt}from"./k9btfb42xrk56ut9.js";import{ag as ua,f as ps,a1 as Ze,t as xt,aG as ms,aL as Ke,a4 as pa,a6 as ma,av as fa,at as es,aR as Xe,ap as ht,b1 as jt,M as vt,a0 as ga,H as xa,a8 as ha,a7 as ja,aq as va,a2 as ya,aO as ka,e as ba,a5 as wa,br as Ma}from"./fga5qe14lr2llx8v.js";import{G as re,a as Na}from"./hmu1ot8fm4uszmig.js";import{a as X,F as te,c as fs,b as ss,G as Ta}from"./jivegfkq3c3y773c.js";import{a as yt,c as _a,e as Pa,g as Sa}from"./cqwvbnjobeewuxnd.js";import{G as Ca,a as Ia,R as La,t as Ye,T as G,h as Aa}from"./iyldmwu8ywhos7ff.js";import{u as Ra}from"./c1hyxnl6kpsjtl7u.js";import{$ as kt,a as bt,b as Ua}from"./c6gg5hubzrgc52sj.js";import{c as Pe}from"./n3ty0r2frjejpyv8.js";import{G as ws}from"./g8nlf109ai64grtj.js";import{G as Ga}from"./lk8bqzua7fjya6ep.js";import{U as Ms,u as wt}from"./guykwp3ov0cliuel.js";import{D as F,B as Ns}from"./i9qil017zb3p1czr.js";import{U as Ba,F as Fa}from"./lxui8l23v2tzixf9.js";import{S as Y}from"./o65h1gsmgo0mfsrq.js";import{l as Oa}from"./fi9p3eeu24b9vfd1.js";import{G as Ea}from"./6tjupkkyx0z5k2fa.js";import{aq as We,ar as Wa,as as qa,at as Ls,au as Ha,L as Mt,N as Nt,p as Tt,q as _t,av as Va}from"./j6ap2wbjx1muhlqy.js";import{m as As}from"./h603pj0ovegt4tgz.js";import{C as Ka}from"./hdncrjsjzzuve3ru.js";import{u as Pt,g as gs,a as Ya,b as $a}from"./kptbw01pxwd1ocyc.js";import{I as Qa,F as Rs}from"./isu9bse2a2oa6tex.js";import{U as Xa,u as St,I as Ja,F as ae,s as Za,d as za,h as ts,b as Da}from"./b2rny0kod41myp87.js";import{G as en}from"./j9ybtsexrrxsl9vq.js";import{A as sn}from"./gi4dwz24es0xqvpd.js";import{m as Ct}from"./ovjwzbtdrcsgos3a.js";import{a as tn}from"./cu7i7jyqvstu6net.js";import{U as an}from"./n1uzh05qecnh8ko6.js";import{G as nn}from"./oz2p01rklj1p4n8d.js";import{i as xs}from"./miwz08wj07jf3elq.js";function It(s){return s==g.User||s==g.Group?g.Private:s==g.WorkspaceLink?g.Workspace:s}function ce(s,t){return s=It(s),t===void 0?!1:t.some(a=>a.recipient===s&&a.allowed)}function Ts(s,t){if(t===void 0)return[];s=It(s);const a=t.find(i=>i.recipient===s);return a==null?void 0:a.moderated_fields}function as(s,t){const a=Ts(s,t);return a&&a.length>0}const Us=Ge.a`bold underline`,rn=Ge.textarea`w-full text-sm overflow-y-auto rounded-lg border px-3 py-2 focus:ring-2 focus:ring-blue-400 border-token-border-medium bg-token-main-surface-primary h-32`;var be=(s=>(s[s.None=0]="None",s[s.AppealAvailable=1]="AppealAvailable",s[s.AppealSent=2]="AppealSent",s))(be||{}),ze=(s=>(s[s.None=0]="None",s[s.PublishBlocked=1]="PublishBlocked",s[s.RemovedFromMarketplace=2]="RemovedFromMarketplace",s[s.RemovedFromPublic=3]="RemovedFromPublic",s[s.RemovedFromPrivate=4]="RemovedFromPrivate",s[s.Recategorized=5]="Recategorized",s))(ze||{});function on(s){var i;if(!s)return;const t=((i=s.gizmo.appeal_info)==null?void 0:i.state.kind)==="appeal_sent",a=ln(s.gizmo.share_recipient,s.gizmo.sharing_targets);return{sharingRecipient:s.gizmo.share_recipient,categories:s.gizmo.categories,gizmoId:s.gizmo.id,moderationType:a,sharingTargets:s.gizmo.sharing_targets,showModal:t?2:a!==0?1:0}}const Gs={[g.User]:g.Private,[g.Group]:g.Private,[g.WorkspaceLink]:g.Workspace};function ln(s,t=[]){const a=new Set(t.filter(n=>n.allowed).map(n=>n.recipient));if(!s||(s in Gs&&(s=Gs[s]),a.has(s)))return 0;const i=a.has(g.Private)||a.has(g.Workspace),r=a.has(g.Link)||a.has(g.Marketplace);return s===g.Marketplace&&r?2:!r&&i?3:4}function Bs(s){switch(s){case 0:case 1:return W({id:"gizmo.appeals.publishBlockedTitle",defaultMessage:"Your changes couldn’t be published"});case 2:return W({id:"gizmo.appeals.removedFromMarketplaceTitle",defaultMessage:"Your GPT has been removed from the marketplace"});case 3:return W({id:"gizmo.appeals.removedFromPublicTitle",defaultMessage:"Your GPT has been removed from public view"});case 5:return W({id:"gizmo.appeals.recategorizedTitle",defaultMessage:"Your GPT has been recategorized"});default:gt(s)}}function cn(s){switch(s){case"profile_picture":return W({id:"gizmo.appeals.profilePictureFieldName",defaultMessage:"Profile Picture"});case"gizmo_name":return W({id:"gizmo.appeals.gizmoNameFieldName",defaultMessage:"Name"});case"gizmo_description":return W({id:"gizmo.appeals.gizmoDescriptionFieldName",defaultMessage:"Description"});case"gizmo_instructions":return W({id:"gizmo.appeals.gizmoInstructionsFieldName",defaultMessage:"Instructions"});case"gizmo_welcome_message":return W({id:"gizmo.appeals.gizmoWelcomeMessageFieldName",defaultMessage:"Welcome Message"});case"custom_actions":return W({id:"gizmo.appeals.customActionsFieldName",defaultMessage:"Custom Actions"});case"conversation_starter":return W({id:"gizmo.appeals.conversationStarterFieldName",defaultMessage:"Conversation Starter"});case"file":return W({id:"gizmo.appeals.fileFieldName",defaultMessage:"File"});case"gizmo_combined_content":return W({id:"gizmo.appeals.gizmoCombinedContentFieldName",defaultMessage:"Overall GPT Config"})}}function dn(s){switch(s){case g.Private:case g.Workspace:return W({id:"gizmo.appeals.privateRecipientModerationText",defaultMessage:"Your GPT can’t be updated because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case g.Link:return W({id:"gizmo.appeals.linkRecipientModerationText",defaultMessage:"Your GPT can’t be shared publicly because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});case g.Marketplace:return W({id:"gizmo.appeals.marketplaceRecipientModerationText",defaultMessage:"Your GPT can’t appear in the Explore GPTs page because it violates our {usagePolicyLink}Usage Policies{usagePolicyLink}."});default:gt(s)}}function Lt({sharingRecipient:s,moderatedFields:t,appealAvailable:a}){const i=t.length;return e.jsxs(e.Fragment,{children:[e.jsxs("p",{children:[e.jsx(c,{...dn(s),values:{usagePolicyLink:r=>e.jsx(Us,{target:"_blank",href:"https://openai.com/policies/usage-policies",rel:"noreferrer",children:r})}})," ",i>0&&e.jsx(c,{id:"gizmo.appeals.seeBelowForSpecificIssues",defaultMessage:`{numModeratedFields, plural,
              one {See below for the specific issue:}
              other {See below for the specific issues:}
            }`,values:{numModeratedFields:i}})]}),i>0&&(t==null?void 0:t.map(r=>e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"font-bold",children:e.jsx(c,{...cn(r.name)})}),e.jsx("ul",{className:"list-disc pl-5",children:r.reasons.map(n=>e.jsxs("li",{children:[n.description," ",n.link?e.jsx(Us,{href:n.link,target:"_blank",rel:"noreferrer",children:e.jsx(c,{id:"gizmo.appeals.learnMore",defaultMessage:"Learn more"})}):""]},n.description))})]}))),a&&e.jsx("p",{children:e.jsx(c,{id:"gizmo.appeals.appealAvailableText",defaultMessage:"Alternatively you may appeal this decision and we will get back to you as soon as possible. Or you can publish to “Only me” and use this GPT privately."})})]})}function un({gizmoId:s,sharingRecipient:t,categories:a,moderationType:i,sharingTargets:r,appealAvailable:n,onClose:l,onAppealSubmitted:o}){const m=Z(),[v,y]=x.useState(""),[j,u]=x.useState(0),f=Be(),p=async()=>{await Ie.postGizmoAppeal(f,s,v,t,a),u(2),o==null||o()},d=Ts(t,r),T=(d==null?void 0:d.length)??0,h=Le();if(T==0&&(h==null?void 0:h.isEnterprisey()))return e.jsx(de,{title:m.formatMessage(Bs(i)),isOpen:!0,onClose:l,showCloseButton:!0,type:"warning",primaryButton:e.jsx(ye.Button,{color:"primary",onClick:l,children:e.jsx(c,{id:"wEsAOU",defaultMessage:"OK"})}),children:e.jsx("p",{className:"text-sm",children:e.jsx(c,{id:"gizmo.appeals.workspaceSettingsMessage",defaultMessage:"Access to your GPT has been reduced by your workspace's GPT sharing settings. An owner of the workspace can change these settings in the workspace settings page."})})});switch(j){case 0:return e.jsx(de,{title:m.formatMessage(Bs(i)),isOpen:!0,onClose:l,showCloseButton:!0,primaryButton:e.jsx(ye.Button,{color:"primary",onClick:l,children:e.jsx(c,{id:"gizmo.appeals.contunueButton",defaultMessage:"Continue"})}),secondaryButton:n?e.jsx(ye.Button,{onClick:()=>u(1),children:e.jsx(c,{id:"gizmo.appeals.appealButton",defaultMessage:"Appeal"})}):void 0,type:"warning",children:e.jsx("div",{className:"flex flex-col gap-2 text-sm",children:e.jsx(Lt,{sharingRecipient:t,moderatedFields:d??[],appealAvailable:n})})});case 1:return e.jsx(de,{title:m.formatMessage({id:"gizmo.appeals.appealModalTitle",defaultMessage:"Appeal"}),isOpen:!0,onClose:l,showCloseButton:!0,shouldIgnoreClickOutside:!0,primaryButton:e.jsx(ye.Button,{color:"primary",onClick:p,disabled:v.trim().length===0,children:e.jsx(c,{id:"gizmo.appeals.submitAppealButton",defaultMessage:"Submit"})}),secondaryButton:e.jsx(ye.Button,{onClick:()=>u(0),children:e.jsx(c,{id:"gizmo.appeals.backButton",defaultMessage:"Back"})}),type:"warning",children:e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsx("p",{children:e.jsx(c,{id:"gizmo.appeals.appealReasonText",defaultMessage:"Please provide a reason for why you believe this GPT doesn’t violate our policies and should be published"})}),e.jsx(rn,{value:v,onChange:P=>y(P.target.value)})]})});case 2:return e.jsx(e.Fragment,{})}}function pn({onClose:s}){const t=Z();return e.jsx(de,{title:t.formatMessage({id:"gizmo.appeals.appealSubmittedModalTitle",defaultMessage:"Appeal submitted"}),isOpen:!0,onClose:s,showCloseButton:!0,primaryButton:e.jsx(ye.Button,{color:"primary",onClick:s,children:e.jsx(c,{id:"gizmo.appeals.closeButton",defaultMessage:"Close"})}),type:"success",children:e.jsx("div",{className:"flex flex-col gap-2 text-sm",children:e.jsx("div",{children:e.jsx(c,{id:"gizmo.appeals.appealSubmittedText",defaultMessage:"Your appeal has been submitted. We will get back to you as soon as possible."})})})})}function mn({gizmoId:s,onClose:t}){const{data:a}=ut(s,!0),i=Be(),r=async()=>{await Ie.postGizmoCancelAppeal(i,s)};return e.jsx(de,{isOpen:!0,onClose:Re,primaryButton:e.jsx(ye.Button,{color:"primary",onClick:()=>{r(),t==null||t()},children:e.jsx(c,{id:"gizmo.appeals.cancelAppealButton",defaultMessage:"Cancel appeal"})}),type:"warning",children:e.jsxs("div",{className:"flex flex-col gap-2 text-sm",children:[e.jsx("h2",{className:"text-lg font-semibold",children:e.jsx(c,{id:"gizmo.appeals.appealReviewingHeader",defaultMessage:"Reviewing your appeal"})}),e.jsx("p",{children:e.jsx(c,{id:"gizmo.appeals.appealSentModalText",defaultMessage:"During the review you can continue using “{gizmoName}” as your private GPT, but won’t be able to update it or share it with others.",values:{gizmoName:a==null?void 0:a.gizmo.display.name}})})]})})}function fn({appealState:s,onAppealClose:t,onAppealSubmitted:a}){const{value:i}=Se("4226692983"),[r,n]=x.useState(!1);return r?e.jsx(pn,{onClose:()=>{n(!1),a==null||a()}}):e.jsxs(e.Fragment,{children:[(s==null?void 0:s.showModal)==2&&e.jsx(mn,{gizmoId:s.gizmoId,onClose:t}),(s==null?void 0:s.showModal)==1&&e.jsx(un,{gizmoId:s.gizmoId,sharingRecipient:s.sharingRecipient,categories:s.categories,moderationType:s.moderationType,sharingTargets:s.sharingTargets,appealAvailable:i,onClose:()=>t==null?void 0:t(),onAppealSubmitted:()=>n(!0)})]})}function gn({gizmoEditorData:s,onOpen:t}){var n;const a=(n=s==null?void 0:s.tools)==null?void 0:n.find(l=>l.type===$.INTENT&&"prompt_config"in l.settings),[i]=x.useState((a==null?void 0:a.settings.prompt_config)??[]),[r]=x.useState((a==null?void 0:a.settings.state_keys)??[]);return e.jsxs(te,{children:[e.jsx("div",{className:"text-sm",children:e.jsx(X,{label:"Blocks + State",description:"Blocks and State for your GPT"})}),e.jsxs("div",{className:"mb space-y-1",children:[!(i||r)&&e.jsx("div",{className:"flex text-token-text-primary",children:"Add prompt blocks and state keys to your GPT"}),e.jsx(re,{onClick:()=>t(),children:i||r?"Show Blocks & State":"Add Blocks & State"})]})]})}function xn({gizmoEditorData:s,updateGizmo:t,onClose:a}){var j;const i=(j=s==null?void 0:s.tools)==null?void 0:j.find(u=>u.type===$.INTENT&&"prompt_config"in u.settings),[r,n]=x.useState((i==null?void 0:i.settings.prompt_config)??[]),[l,o]=x.useState((i==null?void 0:i.settings.state_keys)??[]),m={key_name:"",description:""},v={prompt_key:"",prompt:"",continuation:"",hidden:!1},y=()=>{t(u=>({...u,tools:i?u.tools.map(f=>f.type===$.INTENT?{...f,settings:{...f.settings,prompt_config:r,state_keys:l}}:f):[...u.tools,{type:$.INTENT,settings:{prompt_config:r,state_keys:l}}]}))};return e.jsxs("div",{className:"h-full overflow-auto px-4 pb-12 text-sm",children:[e.jsxs("div",{className:"relative flex flex-col items-center px-16 py-6 text-center",children:[e.jsx("div",{className:"absolute left-0 top-6",children:e.jsx(ne,{color:"secondary",onClick:a,icon:ua})}),e.jsx("div",{className:"text-xl font-semibold",children:e.jsx(c,{id:"eIFoMg",defaultMessage:"Blocks & State"})}),e.jsx("div",{className:"text-sm text-token-text-tertiary",children:e.jsx(c,{id:"rdK8Dl",defaultMessage:"Construct your GPT with instruction blocks and state."})}),e.jsx(X,{label:e.jsx("div",{className:"text-sm font-semibold text-token-text-tertiary",children:"Learn more"}),description:e.jsxs("div",{className:"space-y-2 text-sm font-normal",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Blocks"})," allow you to break up your GPT's instructions into smaller sections, letting the GPT decide which to load up in what scenario."]}),e.jsxs("div",{children:[e.jsx("b",{children:"State"})," gives the GPT a per-user storage for data, that will be provided at the start of all new conversations."]})]})})]}),e.jsx(te,{children:e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"mb-4 space-y-5 text-lg",children:[e.jsx(X,{label:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Instruction Blocks"}),e.jsx(ps,{className:"icon-sm"})]}),description:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{children:"Instruction Blocks are added to the end of your GPT's instructions when the GPT decides to use them."}),e.jsx("div",{children:"The GPT only knows these blocks by their name. and your initial GPT instructions must describe how to use at least one of these blocks."})]})}),e.jsxs("div",{className:"space-y-5 text-sm",children:[r.map((u,f)=>e.jsx(hn,{promptKey:u.prompt_key,prompt:u.prompt,continuation:u.continuation,hidden:u.hidden,visible:!1,isDuplicate:r.filter(p=>p.prompt_key===u.prompt_key).length>1,onChange:({promptKey:p,prompt:d,continuation:T,hidden:h})=>{n(k=>{const P=[...k];return P[f]={prompt_key:p,prompt:d,continuation:T,hidden:h},P}),y()},onDelete:({promptKey:p})=>{n(d=>d.filter(T=>T.prompt_key!==p)),y()}},f)),e.jsx(re,{onClick:()=>{n(u=>[...u,v])},children:"Add Block"})]}),e.jsx(X,{label:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:"Saved State"}),e.jsx(ps,{className:"icon-sm"})]}),description:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{children:"State the GPT can save per-user, that will be provided at the start of all new conversations"}),e.jsx("div",{children:"Your GPT has access to write to these state entries, and read from them."}),e.jsx("div",{children:"The user can see this data."})]})}),l.map((u,f)=>e.jsx(jn,{keyName:u.key_name,description:u.description,isDuplicate:l.filter(p=>p.key_name===u.key_name).length>1,onChange:({keyName:p,description:d})=>{o(T=>{const h=[...T];return h[f]={key_name:p,description:d},h}),y()},onDelete:({keyName:p})=>{o(d=>d.filter(T=>T.key_name!==p)),y()}},f))]}),e.jsx(re,{onClick:()=>{o(u=>[...u,m])},children:"Add State Data"})]})})]})}function hn({promptKey:s,prompt:t,continuation:a,hidden:i,visible:r,isDuplicate:n,onChange:l,onDelete:o}){x.useState(i);const[m,v]=x.useState(r),y=()=>{v(!m)},j=[];s.length>20&&j.push({msg:"Block names work best when they are short"}),n&&j.push({msg:"Block names must be unique"});const u=j.length>0?xt:void 0;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex space-x-2 text-sm",children:[e.jsx(X,{collapsed:!m,label:"Block",onClick:y}),e.jsx($e,{name:"promptKey",value:s,onChange:f=>l({promptKey:f.target.value,prompt:t,continuation:a}),icon:u,className:"max-w-xs grow-0",placeholder:"Block name"})]}),j.map(f=>e.jsx("div",{className:"text-xs text-token-text-secondary",children:f.msg},f.msg)),m&&e.jsxs("div",{className:"mb-4 space-y-1",children:[e.jsx(zt,{rows:5,name:"prompt",value:t,onChange:f=>l({promptKey:s,prompt:f.target.value,continuation:a}),className:"grow",placeholder:"Block Text"}),vn,e.jsx("div",{role:"button",className:"flex items-center space-x-2",onClick:()=>{o({promptKey:s})},children:e.jsx(Ze,{className:"icon-sm"})})]})]})}function jn({keyName:s,description:t,isDuplicate:a,onChange:i,onDelete:r}){const n=[];s.length>20&&n.push({msg:"State names work best when they are short"}),a&&n.push({msg:"State names must be unique"});const l=n.length>0?xt:void 0;return e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex space-x-2 text-sm",children:[e.jsx($e,{name:"key",value:s,onChange:o=>i({keyName:o.target.value,description:t}),icon:l,className:"max-w-xs grow-0",placeholder:"State Name"}),e.jsx($e,{name:"description",value:t,onChange:o=>i({keyName:s,description:o.target.value}),className:"max-w-s flex-grow",placeholder:"Description"}),e.jsx("div",{role:"button",className:"flex items-center space-x-2",onClick:()=>{r({keyName:s})},children:e.jsx(Ze,{className:"icon-sm"})})]}),n.map(o=>e.jsx("div",{className:"text-xs text-token-text-secondary",children:o.msg},o.msg))]})}const vn=!1;function yn(s,t){if(t==null)return s;function a(i){return typeof i=="object"&&i!=null?Array.isArray(i)?i.map(a):Object.fromEntries(Object.entries(i).map(([r,n])=>[r,a(n)])):i===null?void 0:i}return t=a(t),{...s,...t}}var pe=(s=>(s[s.Loading=0]="Loading",s[s.UploadingProfilePic=1]="UploadingProfilePic",s[s.GeneratingProfilePic=2]="GeneratingProfilePic",s[s.GizmoNameTooLong=3]="GizmoNameTooLong",s[s.GizmoDescriptionTooLong=4]="GizmoDescriptionTooLong",s[s.GizmoInstructionsTooLong=5]="GizmoInstructionsTooLong",s[s.NameEmpty=6]="NameEmpty",s[s.MissingPublicActionPrivacyPolicyURL=7]="MissingPublicActionPrivacyPolicyURL",s[s.MissingCategory=8]="MissingCategory",s))(pe||{});function hs(s){switch(s){case 0:return"Loading";case 1:return"Uploading profile picture";case 2:return"Generating profile picture";case 3:return"GPT name too long";case 4:return"GPT description too long";case 5:return"GPT instructions too long";case 6:return"GPT name cannot be empty";case 7:return"Public actions require valid privacy policy URLs";case 8:return"Public GPTs must have a category"}}function kn(s){return s==="link"||s==="marketplace"}function bn(s){try{return new URL(s),!0}catch{return!1}}function qe(s,t,a){var o,m,v,y;const i=s.name.length>tt,r=(((o=s.description)==null?void 0:o.length)??0)>at,n=(((m=s.instructions)==null?void 0:m.length)??0)>nt,l=[];if((s==null?void 0:s.name)===""&&l.push(6),i&&l.push(3),r&&l.push(4),n&&l.push(5),t!=null&&kn(t)){const j=(v=s.tools)==null?void 0:v.filter(u=>u.type===$.JIT_PLUGIN);for(const u of j){const f=(y=u.metadata)==null?void 0:y.privacy_policy_url;if(f==null||!bn(f)){l.push(7);break}}}return t===g.Marketplace&&a==null&&l.push(8),l}const At=Fe(()=>Oe(()=>import("./e6476rboo2cz5t2v.js"),__vite__mapDeps([0,1,2,3])).then(s=>s.DirectorySyncResourceManagedIndication)),wn=[D,Ve];function Mn(s,t){return s.type===B.USER?s.user_id===t.user_id:s.type===B.GROUP?s.group_id===t.group_id:s.type===t.type}const Nn={[B.USER]:g.User,[B.GROUP]:g.Group,[B.WORKSPACE]:g.Workspace,[B.ALL]:g.Marketplace};function Rt(s){const t=Nn[s.type];if(!t)throw new Error("Unknown sharing subject type: "+s.type);return{...s,type:t}}function Tn({gizmo:s,publishedGizmo:t,updateGizmo:a,promoteGizmo:i,appealGizmo:r,setAppealState:n,showActionsModal:l,shareOnly:o,onClose:m,workspaceOwner:v=!1}){var je,_,E;const y=Z(),j=Le(),u=((je=j==null?void 0:j.data)==null?void 0:je.name)??"your workspace",f=it(),p=pt(),[d,T]=x.useState(void 0);x.useEffect(()=>{var b;if(d==null)if(t!=null&&t.gizmo.display.categories&&(t==null?void 0:t.gizmo.display.categories.length)>0){const L=(b=p.data)==null?void 0:b.categories.find(se=>se.id===(t==null?void 0:t.gizmo.display.categories[0]));L&&T(L)}else p.data!=null&&T(p.data.categories[p.data.categories.length-1])},[p.data,d,t]);const[h,k]=x.useState(s.sharingRecipient??g.Private),[P,O]=x.useState(((_=s.sharing)==null?void 0:_.subjects)??[]),[M,I]=x.useState(null),[U,z]=x.useState(!1),N=x.useCallback(()=>{var b;return!ke((b=s.sharing)==null?void 0:b.subjects,P)||s.sharingRecipient!==h},[s.sharing,s.sharingRecipient,h,P]),C=Be(),q=qe(s,h,(d==null?void 0:d.id)??void 0),H=q.includes(pe.MissingPublicActionPrivacyPolicyURL),A=s.tools.find(b=>b.type===$.JIT_PLUGIN&&!b.metadata.privacy_policy_url);if(M)return e.jsx(Gt,{publishedGizmo:M,sharing:{recipient:h,subjects:P},workspaceName:u,onClose:m});function V(b){P.find(L=>Mn(L,b))||O([...P,b])}const R=mt(P);function he(b){const L=P.filter(se=>[B.WORKSPACE,B.ALL].indexOf(se.type)===-1);b!=null&&L.push(b),O(L)}function ee(b){switch(k(b),b){case g.Marketplace:case g.Link:he({type:B.ALL,capabilities:D});break;case g.Workspace:case g.WorkspaceLink:he({type:B.WORKSPACE,capabilities:D});break;default:he(null)}}function me(b){R!=null&&O(P.map(L=>L===R?{...L,capabilities:b}:L))}function fe(b,L,se){return b.type===B.USER&&b.user_id.indexOf("__")===-1?{...b,user_id:b.user_id+"__"+(j==null?void 0:j.getWorkspaceId())}:b}async function Ne(b,L){if(U)return;if(b&&!L)throw new Error("Cannot share a gizmo that hasn't been promoted before");if(!d)return;z(!0);let oe=P.map(fe).map(Rt);if(oe=Ue(h,oe,(R==null?void 0:R.capabilities)??D),v)return!j||!L?(J.warning("Unable to change sharing settings"),m()):(await Ee.updateWorkspaceGPTSharing(j.id,L,oe),J.success(y.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),C.invalidateQueries({queryKey:["workspace"]}),m());if(b){if(!L||!t)throw new Error("No gizmo ID to share");try{const w={sharing:oe};d&&(w.categories=[d.id]);const S=await Ie.shareGizmo(L,w);S.error?as(h,S.sharing_targets)?(n({gizmoId:t.gizmo.id,sharingRecipient:h,categories:t.gizmo.display.categories,moderationType:ze.PublishBlocked,sharingTargets:S.sharing_targets,showModal:be.AppealAvailable}),m()):J.warning(y.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})):(C.setQueryData(["gizmo",{gizmoId:t.gizmo.id},{draft:!1}],K=>S.resource),a(K=>({...K,sharingRecipient:h})),J.success(y.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),m())}catch{return J.warning(y.formatMessage({id:"dKC65l",defaultMessage:"Failed to update sharing settings"})),m()}}else{const w=await i({subjects:oe,recipient:h},d.id);L||(L=w==null?void 0:w.gizmo.id),I(w??null),a({liveVersion:(w==null?void 0:w.gizmo.live_version)??void 0}),C.invalidateQueries({queryKey:["gizmo",{gizmoId:L}]})}z(!1),C.invalidateQueries({queryKey:["gizmos"]}),C.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:L}]}),C.invalidateQueries({queryKey:["workspace"]}),a({sharing:{recipient:h,subjects:P},sharingRecipient:h},!1)}return e.jsx(de,{type:"success",className:"max-w-[555px]",size:"custom",isOpen:!0,onClose:m,primaryButton:as(h,s.sharingTargets)?e.jsx(ne,{onClick:()=>r(h,d==null?void 0:d.id),children:e.jsx(c,{id:"HRzqKK",defaultMessage:"Appeal"})}):e.jsx(ne,{onClick:()=>Ne(o,t==null?void 0:t.gizmo.id),loading:U,disabled:q.length>0||!ce(h,s.sharingTargets),children:o?e.jsx(c,{id:"BEKjVh",defaultMessage:"Save"}):e.jsx(c,{id:"24j5ts",defaultMessage:"Update"})}),secondaryButton:e.jsxs(e.Fragment,{children:[N()&&e.jsx("div",{className:"absolute bottom-8 left-6 text-sm text-token-text-secondary",children:e.jsx(c,{id:"9CkgC4",defaultMessage:"Unsaved changes"})}),t&&e.jsx(ne,{color:"secondary",onClick:()=>We(t,y.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(c,{id:"wvL15a",defaultMessage:"Copy link"})})]}),title:y.formatMessage({id:"7JggXH",defaultMessage:"Share GPT"}),showCloseButton:!0,children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx(Pn,{onAdd:b=>V(b),publishedGizmo:t}),e.jsx("h3",{className:"text-base font-semibold",children:e.jsx(c,{id:"bNQXcV",defaultMessage:"Share with..."})}),e.jsxs("div",{className:"max-h-[200px] space-y-2 overflow-y-auto",children:[e.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[e.jsx("div",{className:"shrink-0 grow-0 self-start",children:e.jsx(Ba,{user:f,size:"gizmoConversation",roundedStyle:"rounded-full"})}),e.jsx("div",{className:"grow",children:!t||Sn(t==null?void 0:t.gizmo.author.user_id.split("__")[0],f==null?void 0:f.id)?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-base font-semibold",children:e.jsx(c,{id:"U7tzof",defaultMessage:"{userName} (you)",values:{userName:f==null?void 0:f.name}})}),e.jsx("span",{className:"-mt-1 text-sm text-token-text-secondary",children:f==null?void 0:f.email})]}):e.jsx("span",{className:"text-base font-semibold",children:e.jsx(c,{id:"scRZqV",defaultMessage:"{userName} (builder)",values:{userName:t==null?void 0:t.gizmo.author.display_name}})})})]}),P.map((b,L)=>us(b)&&e.jsxs("div",{className:"mb-4 flex flex-row items-center justify-between space-x-3",children:[e.jsx(Fa,{name:b.type===B.GROUP?b.group_name:`${b.user_name} ${b.user_email}`,initialsCount:b.type===B.USER?2:1,size:"gizmoConversation",className:ie("shrink-0 grow-0",b.type===B.USER&&"self-start")}),e.jsxs("div",{className:"flex grow flex-col",children:[e.jsxs("span",{className:"flex flex-row",children:[e.jsx("span",{className:"mr-2 text-base font-semibold",children:b.type===B.GROUP?b.group_name:b.user_name}),b.type===B.GROUP&&b.is_scim_managed&&e.jsx(At,{})]}),b.type===B.USER&&e.jsx("span",{className:"-mt-1 text-sm text-token-text-secondary",children:b.user_email})]}),e.jsxs(F.Root,{children:[e.jsxs(F.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[e.jsx(c,{...we(b.capabilities)}),e.jsx(ms,{className:"icon-md"})]}),e.jsx(F.Portal,{children:e.jsxs(F.Content,{className:"max-w-[280px]",children:[wn.map((se,oe)=>e.jsx(ns,{caps:se,selected:ke(se,b.capabilities),onClick:()=>{O(P.map(w=>w===b?{...w,capabilities:se}:w))}},oe)),e.jsx(F.Separator,{}),e.jsx(F.Item,{onClick:()=>O(P.filter(se=>se!==b)),color:"danger",icon:Ze,children:e.jsx(c,{id:"NU0BOB",defaultMessage:"Remove"})})]})})]})]},L))]}),e.jsx("hr",{className:"border-token-border-medium"}),e.jsx("h3",{className:"text-base font-semibold",children:e.jsx(c,{id:"uqD7Y8",defaultMessage:"Access"})}),e.jsxs("div",{className:"-ms-3.5 flex flex-row items-center justify-between space-x-3",children:[e.jsxs(Y.Root,{value:h,onValueChange:b=>ee(b),children:[e.jsxs(Y.Trigger,{children:[e.jsx(Y.Value,{}),e.jsx(Y.Icon,{})]}),e.jsx(Y.Portal,{children:e.jsxs(Y.Content,{children:[e.jsxs(Y.Group,{children:[e.jsx(Y.Label,{children:e.jsx(c,{id:"YIQwaP",defaultMessage:"Private"})}),e.jsx(Y.Item,{value:g.Private,children:e.jsx(_e,{shareLevel:g.Private,workspaceName:u})})]}),e.jsx(Y.Separator,{}),e.jsx(ds,{label:y.formatMessage({id:"n0m61x",defaultMessage:"Your workspace has disabled sharing with the workspace."}),side:"bottom",disabled:ce("workspace",s.sharingTargets),children:e.jsxs(Y.Group,{children:[e.jsx(Y.Label,{children:u}),e.jsx(Y.Item,{value:g.WorkspaceLink,disabled:!ce(g.WorkspaceLink,s.sharingTargets)&&!ce(g.Workspace,s.sharingTargets),children:e.jsx(_e,{shareLevel:g.WorkspaceLink,workspaceName:u})}),e.jsx(Y.Item,{value:g.Workspace,disabled:!ce("workspace",s.sharingTargets),children:e.jsx(_e,{shareLevel:g.Workspace,workspaceName:u})})]})}),e.jsx(Y.Separator,{}),e.jsx(ds,{label:y.formatMessage({id:"IHnort",defaultMessage:"Your workspace has disabled public sharing."}),side:"bottom",disabled:ce("marketplace",s.sharingTargets),children:e.jsxs(Y.Group,{children:[e.jsx(Y.Label,{children:e.jsx(c,{id:"PjY9bi",defaultMessage:"Public"})}),e.jsx(Y.Item,{value:g.Link,disabled:!ce("link",s.sharingTargets),children:e.jsx(_e,{shareLevel:g.Link,workspaceName:u})}),e.jsx(Y.Item,{disabled:!ce("marketplace",s.sharingTargets),value:g.Marketplace,children:e.jsx(_e,{shareLevel:g.Marketplace,workspaceName:u})})]})})]})})]}),h!==g.Private&&h!==g.User&&e.jsxs(F.Root,{children:[e.jsxs(F.Trigger,{className:"whitespace-nowrap text-base text-token-text-secondary",children:[R==null?e.jsx(c,{...we(D)}):e.jsx(c,{...we(R.capabilities)}),e.jsx(ms,{className:"icon-md"})]}),e.jsx(F.Portal,{children:e.jsxs(F.Content,{className:"max-w-[280px]",children:[e.jsx(ns,{onClick:()=>me(D),caps:D,selected:ke(R==null?void 0:R.capabilities,D)}),h!==g.Marketplace&&h!==g.Link&&e.jsx(ns,{onClick:()=>me(Ve),caps:Ve,selected:ke(R==null?void 0:R.capabilities,Ve)})]})})]})]}),H&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(c,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:b=>e.jsx("button",{onClick:()=>{l(A==null?void 0:A.metadata.action_id),m()},className:"underline",children:b})}})}),(h===g.Marketplace||h===g.Workspace)&&(ce(h,s.sharingTargets)?e.jsx(_s,{gizmo:s,category:d==null?void 0:d.id,categories:(E=p.data)==null?void 0:E.categories,onCategoryChange:b=>T(b)}):as(h,s.sharingTargets)?e.jsx("div",{className:"pb-2 text-xs text-red-500",children:e.jsx(Lt,{sharingRecipient:h,moderatedFields:Ts(h,s.sharingTargets)??[],appealAvailable:!0})}):e.jsx("div",{className:"pb-2 text-xs text-red-500",children:e.jsx(c,{id:"BzqqKH",defaultMessage:"Your workspace's settings don't allow this level of access. An owner of the workspace can change this setting in the workspace's GPTs settings."})}))]})})}const Ut=xe({private:{id:"pSXBWQ",defaultMessage:"Invite-only"},user:{id:"pSXBWQ",defaultMessage:"Invite-only"},group:{id:"pSXBWQ",defaultMessage:"Invite-only"},workspace_link:{id:"Giaxt1",defaultMessage:"Anyone at {workspaceName} with the link"},workspace:{id:"XLHaTU",defaultMessage:"{workspaceName}"},link:{id:"uP1+Ri",defaultMessage:"Anyone with the link"},marketplace:{id:"82Ilac",defaultMessage:"GPT Store"}}),_n=xe({workspace:{id:"1kpopF",defaultMessage:"Published to {workspaceName}"},marketplace:{id:"hdTRpJ",defaultMessage:"Published to GPT Store"}});function we(s){return s.can_write?W({id:"SubCqD",defaultMessage:"Can edit"}):s.can_view_config?W({id:"ud3lp4",defaultMessage:"Can view configuration"}):s.can_read?W({id:"/0j34W",defaultMessage:"Can chat"}):W({id:"x2E8ET",defaultMessage:"Unknown"})}function ns({caps:s,selected:t,onClick:a}){let i=pa;return s.can_view_config?i=ma:s.can_read&&(i=fa),e.jsx(F.Item,{className:"flex h-auto flex-row items-start space-x-3 px-3 py-3",onClick:a,icon:i,children:s.can_write?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex grow flex-col",children:e.jsx("span",{className:"text-base font-semibold leading-tight",children:e.jsx(c,{...we(s)})})}),e.jsx(Ke,{className:ie("icon-lg shrink-0",!t&&"invisible")})]}):s.can_view_config?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex grow flex-col",children:[e.jsx("span",{className:"align-baseline text-base font-semibold leading-tight",children:e.jsx(c,{...we(s)})}),e.jsx("span",{className:"text-xs text-token-text-secondary",children:e.jsx(c,{id:"fL1rWw",defaultMessage:"View configuration settings, duplicate, and chat"})})]}),e.jsx(Ke,{className:ie("icon-lg shrink-0",!t&&"invisible")})]}):s.can_read?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex grow flex-col",children:[e.jsx("span",{className:"text-base font-semibold leading-tight",children:e.jsx(c,{...we(s)})}),e.jsx("span",{className:"text-xs text-token-text-secondary",children:e.jsx(c,{id:"tx5q1o",defaultMessage:"Users can only chat with this GPT"})})]}),e.jsx(Ke,{className:ie("icon-lg shrink-0",!t&&"invisible")})]}):null})}const Je={private:es,user:es,group:es,workspace_link:Xe,workspace:ht,link:Xe,marketplace:jt};function _e({shareLevel:s,workspaceName:t,hasInviteSharing:a=!0}){(s===g.User||s===g.Group)&&(s=g.Private);const i=Je[s];return e.jsxs("div",{className:"flex flex-row items-center gap-3 text-base",children:[e.jsx(i,{className:"icon-lg"}),e.jsx("div",{className:"line-clamp-1 pt-px text-start font-semibold",children:!a&&s===g.Private?e.jsx(c,{id:"vVJhYB",defaultMessage:"Only me"}):e.jsx(c,{...Ut[s],values:{workspaceName:t}})})]})}function Gt({publishedGizmo:s,sharing:t,workspaceName:a,onClose:i}){const r=t.recipient,n=Je[r],l=Z();return e.jsxs(de,{isOpen:!0,onClose:i,showCloseButton:!0,className:"w-[304px]",title:e.jsx(c,{id:"5CEceY",defaultMessage:"GPT Updated"}),primaryButton:e.jsx(ne,{onClick:()=>{window.location.href=`/g/${s.gizmo.id}`},children:e.jsx(c,{id:"RF75o5",defaultMessage:"View GPT"})}),secondaryButton:e.jsx(ne,{color:"secondary",onClick:()=>We(s,l.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(c,{id:"9hLOl9",defaultMessage:"Copy link"})}),type:"success",children:[e.jsx(_s,{gizmo:{profilePictureUrl:s.gizmo.display.profile_picture_url??void 0,name:s.gizmo.display.name}}),t.subjects.filter(o=>us(o)).length>0&&e.jsxs("div",{className:"my-4",children:[e.jsx("h4",{className:"text-xs font-semibold text-token-text-secondary",children:e.jsx(c,{id:"/paYH9",defaultMessage:"Shared with"})}),t.subjects&&t.subjects.map((o,m)=>us(o)&&e.jsxs("div",{className:"flex flex-row items-center justify-between space-x-3 py-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-base font-semibold",children:o.type===B.GROUP?o.group_name:o.user_name}),o.type===B.USER&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:o.user_email})]})]}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(c,{...we(o.capabilities)})})]},m))]}),e.jsxs("div",{className:"my-4",children:[e.jsx("h4",{className:"text-xs font-semibold text-token-text-secondary",children:e.jsx(c,{id:"q9XNZ7",defaultMessage:"Access"})}),e.jsxs("div",{className:"ml-[3px] flex flex-row items-center py-3 text-left text-base font-semibold",children:[e.jsx(n,{className:"md:icon-lg mr-3 h-6 w-6 shrink-0"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{..._n[r]??Ut[r],values:{workspaceName:a}})}),(r===g.Workspace||r===g.Marketplace)&&e.jsx("span",{className:"text-xs text-token-text-secondary"})]})]})]})]})}function _s({gizmo:s,category:t,categories:a,onCategoryChange:i}){const{data:r,isLoading:n}=ft(),l=a==null?void 0:a.find(o=>o.id===t);return e.jsxs("div",{children:[e.jsxs("div",{className:ie("mb-[1px] flex flex-row items-center space-x-2 bg-token-main-surface-secondary p-4",n&&"invisible",a?"rounded-t-lg":"rounded-lg"),children:[e.jsx(ws,{isFirstParty:!1,className:"h-11 w-11",src:s.profilePictureUrl}),e.jsxs("div",{className:"flex grow flex-col space-y-0",children:[e.jsx("span",{className:"text-base font-semibold",children:s.name}),e.jsx(Ea,{builderName:r==null?void 0:r.display_name,builderUrl:r==null?void 0:r.website_url,socials:[r==null?void 0:r.socials.linkedin,r==null?void 0:r.socials.github,r==null?void 0:r.socials.twitter].filter(o=>o!=null),className:"text-xs text-token-text-secondary"})]})]}),a&&e.jsxs("div",{className:"flex min-h-[56px] flex-row items-center justify-between space-x-2 rounded-b-lg bg-token-main-surface-secondary px-4 text-base",children:[e.jsx("span",{className:"font-semibold",children:e.jsx(c,{id:"JcA4/t",defaultMessage:"Category"})}),e.jsx("div",{className:"text-token-text-secondary",children:i?e.jsx(Ns,{size:"small",triggerButton:e.jsxs("button",{className:"flex items-center gap-1",children:[l==null?void 0:l.title,e.jsx(ms,{className:"icon-md"})]}),children:a.map((o,m)=>e.jsx(F.Item,{onClick:()=>i(o),children:o.title},m))}):e.jsx("span",{className:"text-token-text-secondary",children:l==null?void 0:l.title})})]})]})}const Fs=Ge.li`flex flex-col rounded-sm p-1 hover:bg-token-main-surface-secondary`;function Pn({onAdd:s,publishedGizmo:t}){var p;const a=Z(),i=Le(),[r,n]=x.useState(""),o=(p=Dt(i==null?void 0:i.id,0,r,5).data)==null?void 0:p.items.filter(d=>d.id!==(t==null?void 0:t.gizmo.author.user_id.split("__")[0])),{data:m}=Ht({queryKey:[i==null?void 0:i.id,"groups","filtered",r],queryFn:()=>Ee.getWorkspaceGroups(i.id,{query:r,orderby:"@score"}),enabled:r.trim()!==""&&i!=null&&!!i.getWorkspaceId()}),v=((o==null?void 0:o.length)??0)>0||((m==null?void 0:m.items.length)??0)>0,[y,j]=x.useState(!1);function u(d,T,h){s({type:B.GROUP,group_id:d,group_name:T,capabilities:{...D},is_scim_managed:h}),n("")}function f(d,T,h){i&&(s({type:B.USER,user_id:d+"__"+i.getWorkspaceId(),user_name:T,user_email:h,capabilities:{...D}}),n(""))}return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex w-full flex-row space-x-3",children:e.jsxs(As,{as:"div",className:"group relative z-10 grow",children:[e.jsx($e,{list:"suggested-choices",name:"share-with-input",placeholder:i!=null&&i.isEnterprisey()?a.formatMessage({id:"xy/AMO",defaultMessage:"Add people and groups from your workspace"}):a.formatMessage({id:"Lh9njB",defaultMessage:"Add people from your workspace"}),value:r,onChange:d=>n(d.target.value),onFocus:()=>j(!0),onBlur:()=>j(!1)}),e.jsx(Oa,{show:r.trim()!==""&&v&&y,children:e.jsx(As.Panel,{static:!0,className:"absolute top-8 ml-0 w-full cursor-pointer overflow-y-auto rounded-lg rounded-t-none border border-t-0 border-token-border-light bg-token-main-surface-primary px-1 py-1 group-has-[:focus]:border-token-border-xheavy",children:r.trim()!==""&&e.jsxs("ul",{id:"suggested-choices",children:[o&&o.map(d=>e.jsxs(Fs,{tabIndex:0,className:"rounded-sm p-1 text-sm hover:bg-token-main-surface-secondary",onClick:()=>f(d.id,d.name,d.email??""),children:[e.jsx("span",{className:"w-full font-semibold",children:d.name}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:d.email})]},d.id)),(m==null?void 0:m.items)&&m.items.slice(0,5).map(d=>e.jsx(Fs,{tabIndex:0,onClick:()=>u(d.id,d.name,d.is_scim_managed??!1),children:e.jsxs("span",{className:"flex flex-col",children:[e.jsxs("span",{className:"flex flex-row",children:[e.jsx("span",{className:"mr-2 font-semibold",children:d.name}),d.is_scim_managed&&e.jsx(At,{})]}),e.jsx("span",{className:"text-sm text-token-text-secondary",children:e.jsx(c,{id:"r3Rx6X",defaultMessage:"{numMembers, plural, one {1 member} other {# members}}",values:{numMembers:d.num_members}})})]})},d.id))]})})})]})})})}function Sn(s,t){return s===void 0||t===void 0?!1:s.split("__")[0]===t.split("__")[0]}function Cn({gizmo:s,updateGizmo:t,publishedGizmo:a,promoteGizmo:i,appealGizmo:r,setAppealState:n,showActionsModal:l,shareOnly:o,onClose:m}){const[v,y]=x.useState({type:"privacy"});return v.type==="privacy"?e.jsx(Ln,{gizmo:s,updateGizmo:t,publishedGizmo:a,promoteGizmo:i,appealGizmo:r,setAppealState:n,setStep:y,showActionsModal:l,shareOnly:o,onClose:m}):e.jsx(An,{publishedGizmo:v.publishedGizmo,onClose:m})}function In(s){return s?g.Workspace:g.Link}function Ln({gizmo:s,publishedGizmo:t,updateGizmo:a,promoteGizmo:i,appealGizmo:r,setAppealState:n,setStep:l,showActionsModal:o,shareOnly:m,onClose:v}){var me,fe,Ne,je;const[y,j]=x.useState(!1),u=Qe(rt.isBusinessWorkspace),f=Z(),[p,d]=x.useState(bs(s)?In(!!u):s.sharingRecipient),T=Be(),h=ce(p,s.sharingTargets),{data:k,isLoading:P}=ft(),O=pt(),[M,I]=x.useState(t!=null&&t.gizmo.display.categories.length>0?(fe=(me=O.data)==null?void 0:me.categories.find(_=>_.id===t.gizmo.display.categories[0]))==null?void 0:fe.id:void 0);x.useEffect(()=>{I(t==null?void 0:t.gizmo.display.categories[0])},[t==null?void 0:t.gizmo.display.categories]);const[U,z]=x.useState(void 0),N=x.useRef(Ca((_,E)=>Ie.generateCategory(_,E),1e3)),C=k!=null&&k.is_verified?void 0:f.formatMessage({id:"qEQtmt",defaultMessage:"To publish your GPTs to the Explore GPTs page, set up your builder profile."});p===g.Marketplace&&C!=null&&!P&&d(g.Link);const q=u&&!((Ne=s.sharingTargets)!=null&&Ne.some(_=>_.recipient===g.Link)),H=qe(s,p,M),A=H.includes(pe.MissingPublicActionPrivacyPolicyURL),V=s.tools.find(_=>_.type===$.JIT_PLUGIN&&!_.metadata.privacy_policy_url),R=Qe(_=>_.currentWorkspace),he=Vs();x.useEffect(()=>{let _=!0;return(async()=>{try{if(M!=null)return;const E=await N.current(s.name,s.instructions);_&&M==null&&(E?I(E.id):z(!0))}catch{_&&M==null&&z(!0)}})(),()=>{_=!1}},[s.instructions,s.name,he,M]);const{value:ee}=Se("4226692983");return e.jsx(de,{type:"success",isOpen:!0,onClose:v,title:e.jsx(c,{id:"9viumf",defaultMessage:"Share GPT"}),showCloseButton:!0,primaryButton:h?e.jsx(ne,{color:"primary",disabled:H.length>0,loading:y,onClick:async()=>{try{if(j(!0),m){if(!(t!=null&&t.gizmo.id)){J.danger(f.formatMessage({id:"QYVEx8",defaultMessage:"Error sharing GPT"}));return}const _=await Ie.shareGizmo(t.gizmo.id,M?{sharing:Ue(p,[],D),categories:[M]}:{sharing:Ue(p,[],D)});_.error?(J.warning(f.formatMessage({id:"tmIKmp",defaultMessage:"Unable to share GPT"})),a({sharingTargets:_.sharing_targets}),n({gizmoId:t.gizmo.id,sharingRecipient:p,categories:t.gizmo.display.categories,moderationType:ze.PublishBlocked,sharingTargets:_.sharing_targets,showModal:be.AppealAvailable})):(T.setQueryData(["gizmo",{gizmoId:t.gizmo.id},{draft:!1}],E=>_.resource),a(E=>({...E,sharingRecipient:p})),J.success(f.formatMessage({id:"SWSzcY",defaultMessage:"Sharing settings updated"})),v())}else{const _=await i({recipient:p,subjects:Ue(p,[],D)},M);_?(l({type:"published",publishedGizmo:_}),a(E=>({...E,id:_.gizmo.id,sharingRecipient:p})),_.gizmo.live_version!=null&&a({liveVersion:_.gizmo.live_version}),J.success(f.formatMessage({id:"R5zko1",defaultMessage:"GPT published"}))):(J.warning(f.formatMessage({id:"uf7WYw",defaultMessage:"Unable to publish GPT"})),v())}}finally{j(!1)}},children:e.jsx(c,{id:"SW4DG4",defaultMessage:"Save"})}):ee?e.jsx(e.Fragment,{children:e.jsx(ne,{color:"primary",onClick:async()=>{await r(p,M)},children:e.jsx(c,{id:"bBmLUr",defaultMessage:"Appeal"})})}):null,secondaryButton:t?e.jsx(ne,{color:"secondary",onClick:()=>We(t,f.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"})),children:e.jsx(c,{id:"wvL15a",defaultMessage:"Copy link"})}):null,children:e.jsxs("div",{className:"mx-[-16px] flex flex-col gap-3 text-sm",children:[e.jsx("div",{className:"space-y-1.5",children:e.jsxs(kt,{value:p,onValueChange:_=>d(_),children:[s.sharingTargets&&s.sharingTargets.map((_,E)=>e.jsx(is,{value:_.recipient,disabled:_.recipient===g.Marketplace&&C!=null,tooltipText:_.recipient===g.Marketplace?C??f.formatMessage({id:"0Rcb4e",defaultMessage:"Your GPT will appear in the Explore GPTs page"}):void 0,shareLevel:_.recipient},E)),q&&e.jsxs(e.Fragment,{children:[e.jsx(is,{value:g.Link,disabled:!0,tooltipText:f.formatMessage(Os.workspaceDisabledHint),shareLevel:g.Link,workspaceName:R==null?void 0:R.name}),e.jsx(is,{value:g.Link,disabled:!0,tooltipText:f.formatMessage(Os.workspaceDisabledHint),shareLevel:g.Marketplace,workspaceName:R==null?void 0:R.name})]})]})}),A&&e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(c,{id:"/iw1Iv",defaultMessage:"Public actions require valid privacy policy URLs. Click <fixlink>here</fixlink> to update.",values:{fixlink:_=>e.jsx("button",{onClick:()=>{o(V==null?void 0:V.metadata.action_id)},className:"underline",children:_})}})}),p!==g.Private&&e.jsx(_s,{gizmo:s,category:M,categories:p===g.Marketplace?((je=O.data)==null?void 0:je.categories)??[]:void 0,onCategoryChange:p===g.Marketplace?_=>I(_.id):void 0}),p===g.Marketplace&&(U?e.jsx("div",{className:"text-xs text-red-500",children:e.jsx(c,{id:"tpC3ui",defaultMessage:"There was an error updating the list of categories"})}):null),!h&&ee&&e.jsx("div",{className:"flex items-center justify-between text-sm text-token-text-secondary",children:e.jsx(c,{id:"jLCMMV",defaultMessage:"Because this GPT previously may have violated our policies, you will have to submit an appeal to make it available at this level."})})]})})}function An({publishedGizmo:s,onClose:t}){const a=Wa(s),i=Z();return e.jsx(de,{type:"success",isOpen:!0,onClose:t,title:e.jsx(c,{id:"rCRRmx",defaultMessage:"Settings Saved"}),showCloseButton:!0,primaryButton:e.jsx(ne,{color:"primary",as:"link",to:a,children:e.jsx(c,{id:"lyZz44",defaultMessage:"View GPT"})}),children:e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs("div",{className:"flex gap-1 rounded bg-token-main-surface-secondary px-2 py-1",children:[e.jsx("div",{className:"line-clamp-1 text-ellipsis break-all",children:a}),e.jsx("button",{onClick:()=>{We(s,i.formatMessage({id:"KdDqMm",defaultMessage:"Copied link to clipboard"}))},className:"text-token-text-secondary transition hover:text-token-text-primary",children:e.jsx(vt,{className:"icon-sm"})})]})})})}const Os=xe({workspaceDisabledHint:{id:"gizmo.workspaceDisabledHint",defaultMessage:"Your workspace administrator has disabled this setting"}});function is({shareLevel:s,workspaceName:t,value:a,disabled:i=!1,tooltipText:r}){const n=x.useId();return e.jsx(ds,{disabled:r==null,label:r,side:"top",children:e.jsxs(bt,{id:n,value:a,disabled:i,className:"flex h-14 w-full cursor-pointer flex-row items-center justify-between gap-2 rounded-md px-3 py-4 font-semibold hover:bg-token-main-surface-secondary",children:[e.jsx("label",{htmlFor:n,className:"flex cursor-pointer items-center gap-1",children:e.jsx(_e,{shareLevel:s,workspaceName:t??"",hasInviteSharing:!1})}),e.jsx(Ua,{children:e.jsx(Ke,{className:"icon-lg mr-1"})})]})})}function Bt(s){window.history.length>1?s(-1):s(aa())}function Rn({gizmo:s,publishedGizmo:t,isLoading:a,isUploadingProfilePic:i,isGeneratingProfilePic:r,updateGizmo:n,promoteGizmo:l,appealGizmo:o,setAppealState:m,showActionsModal:v}){const y=Le(),j=s!=null?qe(s):[];(s==null||a)&&j.push(pe.Loading),i&&j.push(pe.UploadingProfilePic),r&&j.push(pe.GeneratingProfilePic);const u=bs(s),[f,p]=x.useState(!1),[d,T]=x.useState(!1),h=s.sharingRecipient?Je[s.sharingRecipient]:Je.private;return e.jsxs(e.Fragment,{children:[u?e.jsx(re,{color:"primary",onClick:()=>p("promote"),loading:a,disabled:s.id===void 0||j.length>0,tooltip:j.length>0?j.map(hs).join(`
`):void 0,children:e.jsx(c,{id:"svUGIb",defaultMessage:"Create"})}):e.jsxs(e.Fragment,{children:[e.jsxs(re,{color:"secondary",loading:a||!t,onClick:()=>p("share"),children:[e.jsx(h,{className:"icon-sm shrink-0"}),e.jsx(c,{id:"aXKW4G",defaultMessage:"Share"})]}),e.jsx(re,{color:"primary",onClick:async()=>{let k=s.sharing.subjects.map(Rt);const P=mt(s.sharing.subjects);k=Ue(s.sharing.recipient,k,(P==null?void 0:P.capabilities)??D),await l({recipient:s.sharing.recipient,subjects:k},t==null?void 0:t.gizmo.display.categories[0])&&T(!0)},loading:a||!t,disabled:j.length>0,tooltip:j.length>0?j.map(hs).join(`
`):void 0,children:e.jsx(c,{id:"84QVoj",defaultMessage:"Update"})})]}),f&&((y==null?void 0:y.getWorkspaceId())==null?e.jsx(Cn,{gizmo:s,publishedGizmo:t,promoteGizmo:l,appealGizmo:o,setAppealState:m,showActionsModal:v,updateGizmo:n,shareOnly:f==="share",onClose:()=>p(!1)}):e.jsx(Tn,{gizmo:s,publishedGizmo:t,promoteGizmo:l,appealGizmo:o,setAppealState:m,showActionsModal:v,updateGizmo:n,onClose:()=>p(!1),shareOnly:f==="share"})),d&&e.jsx(Gt,{publishedGizmo:t,sharing:t.gizmo.sharing,onClose:()=>T(!1),workspaceName:(y==null?void 0:y.data.name)??""})]})}function Un({gizmoEditorData:s,publishedGizmo:t,revertDraft:a}){const i=Z(),r=Ks(),[n,l]=x.useState(!1),o=Vs(),{value:m}=Se("3645668434");return!(o!=null&&o.includes("debug"))&&(s==null?void 0:s.id)==null?null:e.jsxs(e.Fragment,{children:[e.jsxs(Ns,{side:"top",contentAlign:"end",sideOffset:8,triggerButton:e.jsx(re,{color:"ghost",icon:ga}),children:[t!=null&&e.jsxs(F.Item,{onClick:()=>{We(t)},children:[e.jsx(Xe,{className:"icon-sm"}),e.jsx(c,{...ge.copyLink})]}),a!=null&&e.jsxs(F.Item,{onClick:()=>{window.confirm(i.formatMessage(ge.revertConfirm))&&a()},children:[e.jsx(xa,{className:"icon-sm"}),e.jsx(c,{id:"W2blnV",defaultMessage:"Revert..."})]}),(s==null?void 0:s.id)!=null&&m&&s.liveVersion>0&&e.jsxs(e.Fragment,{children:[e.jsxs(F.Item,{onClick:()=>{r(`/g/${s.id}/view`)},children:[e.jsx(ha,{className:"icon-sm"}),e.jsx(c,{id:"gizmo.versionHistory",defaultMessage:"Version History"})]}),e.jsxs(F.Item,{onClick:async()=>{const v=await Ie.copyGizmo({gizmoId:s.id});v.gizmo.id&&r(`/gpts/editor/${v.gizmo.id}`)},children:[e.jsx(vt,{className:"icon-sm"}),e.jsx(c,{id:"GizmoInformation.copyGizmoLabel",defaultMessage:"Duplicate GPT"})]})]}),(s==null?void 0:s.id)!=null&&e.jsxs(F.Item,{color:"danger",onClick:()=>{l(!0)},children:[e.jsx(Ze,{className:"icon-sm"}),e.jsx(c,{id:"tNrOLG",defaultMessage:"Delete GPT"})]}),(o==null?void 0:o.includes("debug"))&&e.jsxs(e.Fragment,{children:[e.jsx(F.Separator,{}),e.jsxs(F.Item,{onClick:()=>{Ms.toggleActiveSidebar("debug")},children:[e.jsx(ja,{className:"icon-sm"}),"Debug (Internal only)"]})]})]}),n&&e.jsx(Ga,{gizmoId:s.id,onSuccess:()=>Bt(r),onClose:()=>{l(!1)}})]})}const He=Ge.div`flex items-center gap-1`;function Gn({gizmoEditorData:s}){const t=Qe(a=>{var i;return(i=a.currentWorkspace)==null?void 0:i.name});switch(s.sharingRecipient){case g.Private:return e.jsxs(He,{children:[e.jsx(va,{className:"icon-xs"}),e.jsx(c,{...ge.onlyMe})]});case g.Link:return e.jsxs(He,{children:[e.jsx(Xe,{className:"icon-xs"}),e.jsx(c,{...ge.anyoneWithLink})]});case g.Workspace:return e.jsxs(He,{children:[e.jsx(ht,{className:"icon-xs"}),t]});case g.Marketplace:return e.jsxs(He,{children:[e.jsx(jt,{className:"icon-xs"}),e.jsx(c,{...ge.public})]});default:return e.jsx("div",{})}}function Bn({gizmoEditorData:s}){return e.jsxs("div",{className:"flex items-center gap-2",children:[s.profilePictureUrl!=null?e.jsx(ws,{isFirstParty:!1,src:s.profilePictureUrl,className:"h-8 w-8"}):e.jsx("div",{className:"h-8 w-8 rounded-full border-2 border-dashed border-token-border-medium"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold",children:s.name||e.jsx(c,{...ge.newGPT})}),e.jsx("div",{className:"text-xs text-token-text-secondary",children:bs(s)?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-token-text-tertiary"}),e.jsx(c,{...ge.draft})]}):e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"h-1.5 w-1.5 rounded-full bg-brand-green"}),s.sharingRecipient===g.Marketplace?e.jsx(c,{...ge.published}):e.jsx(c,{id:"gizmoEditorHeader.live",defaultMessage:"Live"})," · ",e.jsx(Gn,{gizmoEditorData:s})]})})]})]})}function Fn({gizmoEditorData:s,isLoading:t,isUploadingProfilePic:a,isGeneratingProfilePic:i,publishedGizmo:r,updateGizmo:n,promoteGizmo:l,appealGizmo:o,setAppealState:m,revertDraft:v,draftMessage:y,className:j,hasUnpublishedChanges:u,showActionsModal:f}){const p=Ks();return e.jsxs("div",{className:ie("relative flex h-14 w-full items-center justify-between gap-2 border-b border-token-border-medium px-3",j),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("a",{className:"cursor-pointer text-token-text-primary",onClick:()=>Bt(p),children:e.jsx(ea,{className:"icon-lg"})}),e.jsx(Bn,{gizmoEditorData:s})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[y,e.jsx(Un,{gizmoEditorData:s,publishedGizmo:r,revertDraft:v}),e.jsx(Rn,{gizmo:s,publishedGizmo:r,isLoading:t,isUploadingProfilePic:a,isGeneratingProfilePic:i,updateGizmo:n,promoteGizmo:l,appealGizmo:o,setAppealState:m,hasUnpublishedChanges:u,showActionsModal:f})]})]})}const ge=xe({onlyMe:{id:"gizmo.onlyMe",defaultMessage:"Only me"},anyoneWithLink:{id:"gizmo.anyoneWithLink",defaultMessage:"Anyone with a link"},public:{id:"gizmo.public",defaultMessage:"Everyone"},newGPT:{id:"gizmo.newGPT",defaultMessage:"New GPT"},draft:{id:"gizmo.draft",defaultMessage:"Draft"},published:{id:"gizmo.published",defaultMessage:"Published"},revertConfirm:{id:"gizmo.revertConfirm",defaultMessage:"Are you sure you want to revert to the last saved version?"},copyLink:{id:"gizmo.copyLink",defaultMessage:"Copy link"}}),On=512;function En(){return e.jsx("div",{className:"relative flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-token-border-medium",children:e.jsx(vs,{className:"h-1/4 w-1/4"})})}function Wn({gizmoEditorData:s,onFileChange:t,generateProfilePic:a,isGeneratingProfilePic:i,setIsGeneratingProfilePic:r}){const n=Z(),[l,o]=x.useState(void 0),m=x.useRef(t);x.useEffect(()=>{m.current=t});async function v(u){if(u.length>0){r(!1);const f=await Za(u[0],On),p=gs(f);o({tempId:p,file:f,status:ae.Uploading,progress:1,fileId:null,cdnUrl:null}),m.current("uploading"),Ya(p,f,n,Ys.ProfilePicture,{onFileCreated(d,T,h){o(k=>k!=="initial"&&(k==null?void 0:k.tempId)===d&&k.status===ae.Uploading?{...k,progress:10,fileId:T,cdnUrl:h}:k)},onFileUploadProgress(d,T){o(h=>h!=="initial"&&(h==null?void 0:h.tempId)===d&&h.status===ae.Uploading?{...h,progress:T}:h)},onFileUploaded(d,T,h){o(k=>k!=="initial"&&(k==null?void 0:k.tempId)===d?(m.current(k),{...k,status:ae.Ready,progress:100,fileSpec:{name:k.file.name,id:k.fileId,size:k.file.size,...h??{}}}):k)},onError(d){o(T=>{if(T!=="initial"&&(T==null?void 0:T.tempId)===d){m.current(void 0);return}return T})}})}}const{open:y,getInputProps:j}=Pt({disabled:!1,noClick:!0,onDropAccepted:v,onDropRejected:u=>qa(u,n,Xa.ProfilePicture),multiple:!0,maxSize:ot,...St(Ja)});return e.jsxs("div",{className:"flex w-full items-center justify-center gap-4",children:[e.jsxs(Ns,{sideOffset:8,triggerButton:e.jsx("button",{className:"h-20 w-20",children:i?e.jsx(En,{}):l!=null&&l!="initial"&&l.status!=ae.Ready?e.jsxs("div",{className:"relative h-full w-full overflow-hidden rounded-full",children:[e.jsx(Qa,{file:l.file}),l.status===ae.Uploading&&l.progress<90?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/5 text-white",children:e.jsx(sa,{percentage:l.progress,className:"h-6 w-6"})}):null]}):(s==null?void 0:s.profilePictureUrl)!=null&&(s==null?void 0:s.profilePictureUrl)!==""?e.jsx(ws,{isFirstParty:!1,src:s.profilePictureUrl}):e.jsx("div",{className:"flex h-full w-full items-center justify-center rounded-full border-2 border-dashed border-token-border-medium",children:e.jsx(ya,{className:"text-4xl"})})}),children:[e.jsx(F.Item,{onClick:y,children:e.jsx(c,{id:"ERQwXg",defaultMessage:"Upload Photo"})}),e.jsx(F.Item,{onClick:a,children:e.jsx(c,{id:"NXAog/",defaultMessage:"Use DALL·E"})})]}),e.jsx("input",{...j()})]})}function qn({gizmoEditorData:s,updateGizmo:t}){var j;const a=(j=s==null?void 0:s.tools)==null?void 0:j.find(u=>u.type===$.INTENT&&"intents"in u.settings),[i,r]=x.useState((a==null?void 0:a.settings.intents)??""),[n,l]=x.useState((a==null?void 0:a.settings.intent_hook)??""),[o,m]=x.useState(!1),v=Z(),y=()=>{t(u=>({...u,tools:a?u.tools.map(f=>f.type===$.INTENT?{...f,settings:{...f.settings,intents:i,intent_hook:n}}:f):[...u.tools,{type:$.INTENT,settings:{intents:i,intent_hook:n}}]})),m(!1)};return e.jsxs(te,{children:[e.jsx(X,{label:"GPT Script",description:v.formatMessage({id:"gizmo.gptScriptExplanation",defaultMessage:"Code and Intents to save GPT state"})}),o&&e.jsxs("div",{className:"mb-4",children:[e.jsx(X,{label:"Intent Hook"}),e.jsx(fs,{value:n,rows:20,onChange:u=>l(u.target.value),placeholder:`def f(input):
return {
  "instructions": str(input.intent),
  "conversation_state": input.conversation_state,
  "user_state": input.user_state,
  "pinned": {},
}`,className:"h-50 mb-4 block w-full resize-none rounded-md border border-gray-300 p-2 font-mono text-xs shadow-sm focus:border-blue-500 focus:ring-blue-500",spellCheck:"false"}),e.jsx(X,{label:"Intents"}),e.jsx(fs,{value:i,rows:20,onChange:u=>r(u.target.value),placeholder:"Enter Intent",className:"h-50 mb-4"}),e.jsx(ne,{color:"primary",onClick:()=>{y()},children:"Update"})]}),!o&&e.jsx(re,{onClick:()=>m(!0),children:n?"Update Script":"Add Script"})]})}function Hn({gizmoEditorData:s,requireGizmoId:t,currentModelConfig:a,updateGizmo:i}){const r=Z(),[n,l]=x.useState(0),o=x.useRef(new Map),m=za(a,void 0),v=async M=>{$s.logEvent(Qs.uploadFile,{client:"web",eventSource:"mouse",intent:"gizmo"});const I=await t();M.length>0&&await Promise.all(M.map(U=>{const z=gs(U);o.current.set(z,{tempId:z,gizmoId:I,file:U,status:ae.Uploading,progress:1,fileId:null,cdnUrl:null}),$a(gs(U),U,r,{kind:Ys.Gizmo,gizmoId:I},{onFileUploaded:(N,C,q,H)=>{const A=o.current.get(N);A==null||A.fileId==null||(i(V=>({...V,files:[...V.files??[],{file_id:A.fileId,name:A.file.name,size:A.file.size,type:A.file.type,last_modified:A.file.lastModified,file_size_tokens:H==null?void 0:H.fileTokenSize}]})),o.current.delete(N),l(V=>V+1))},onFileCreated:(N,C,q)=>{o.current.set(N,{tempId:N,gizmoId:I,file:U,status:ae.Uploading,progress:1,...o.current.get(N),fileId:C,cdnUrl:q}),l(H=>H+1)},onFileUploadProgress:(N,C)=>{const q=o.current.get(N);(q==null?void 0:q.status)===ae.Uploading&&o.current.set(N,{...q,progress:C}),l(H=>H+1)},onError:N=>{o.current.delete(N)}},{usesRetrievalIndex:a!=null&&ts(a,U.type,U.name)===De.Retrieval})}))},{getInputProps:y,open:j}=Pt({disabled:!1,noClick:!0,onDropAccepted:v,multiple:!0,maxSize:ot,maxFiles:10,...St(m)}),u=(s==null?void 0:s.files)??[];function f(M){return e.jsx(Rs,{onRemoveFileClick:()=>{o.current.delete(M.tempId),l(I=>I+1)},file:M.file,loadingPercentage:M.status===ae.Uploading?M.progress:void 0},M.tempId)}function p(M){return e.jsx(Rs,{file:M.name,fileId:M.file_id,onRemoveFileClick:()=>i(I=>{var U;return{...I,files:(U=I==null?void 0:I.files)==null?void 0:U.filter(z=>z.file_id!==M.file_id)}}),gizmoId:s==null?void 0:s.id},M.file_id)}const d=Array.from(o.current.values()).filter(M=>u.every(I=>I.file_id!==M.fileId)),[T,h]=Ls(d,M=>a!=null&&ts(a,M.file.type,M.file.name)===De.CodeInterpreter),[k,P]=Ls(u,M=>a!=null&&M.type!=null&&ts(a,M.type,M.name)===De.CodeInterpreter),O=x.useRef(k.length);return x.useEffect(()=>{k.length>O.current&&i(M=>{var I;return(I=M.tools)!=null&&I.some(U=>U.type===$.PYTHON)?M:{...M,tools:[...M.tools??[],{type:$.PYTHON}]}}),O.current=k.length},[k.length]),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"rounded-lg text-token-text-tertiary",children:e.jsx(c,{...Vn.knowledgeWarning})}),h.length>0||P.length>0?e.jsxs("div",{className:"flex flex-wrap gap-2",children:[h.map(f),P.map(p)]}):null,T.length>0||k.length>0?e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 text-xs text-token-text-tertiary",children:e.jsx(c,{id:"i/QurZ",defaultMessage:"The following files are only available for Code Interpreter:"})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[T.map(f),k.map(p)]})]}):null,e.jsx("div",{children:e.jsxs(re,{onClick:j,children:[e.jsx("input",{...y()}),e.jsx(c,{id:"sr8Qp/",defaultMessage:"Upload files"})]})})]})}const Vn=xe({knowledgeWarning:{id:"gizmo.knowledgeWarning",defaultMessage:"If you upload files under Knowledge, conversations with your GPT may include file contents. Files can be downloaded when Code Interpreter is enabled"}});function Kn({placeholder:s,text:t,onChange:a,onClose:i}){return e.jsx(de,{className:"!max-h-[100vh] !max-w-[80vw]",type:"success",isOpen:!0,onClose:i,primaryButton:e.jsx(re,{onClick:i,children:e.jsx(c,{id:"FeFVdS",defaultMessage:"Close"})}),children:e.jsx("textarea",{className:"h-[70vh] w-full resize-none rounded-lg bg-token-main-surface-primary dark:border-gray-700",value:t,onChange:r=>{a(r.target.value)},placeholder:s})})}const rs=Ge.div`text-sm text-red-500`;function Yn({children:s,collapsed:t,initial:a}){return e.jsx(sn,{initial:a,children:!t&&e.jsx(Ct.div,{initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1,height:"auto"},collapsed:{opacity:0,height:0}},children:s})})}function $n({gizmo:s,onShowActionsEditor:t,isDisabled:a}){var n,l;const i=Z(),r=e.jsxs("div",{className:"space-y-1",children:[(n=s==null?void 0:s.tools)==null?void 0:n.map((o,m)=>{var v;return o.type!==$.JIT_PLUGIN?null:e.jsxs("div",{children:[e.jsx(Ta,{isDisabled:a,actionTool:o,onShowActionsEditor:()=>t(o.metadata.domain)}),((v=o.metadata.auth)==null?void 0:v.type)==="oauth"&&e.jsx(Ka,{label:i.formatMessage(Q.callbackUrlLabel),value:`https://chat.openai.com/aip/${o.metadata.action_id}/oauth/callback`,onCopied:()=>{J.success("Copied to clipboard",{duration:3})}})]},m)}),(((l=s==null?void 0:s.tools)==null?void 0:l.filter(o=>o.type===$.JIT_PLUGIN))??[]).length>=Cs?e.jsx("div",{children:i.formatMessage(Q.maxActionsReached,{number:Cs})}):e.jsx(re,{disabled:a,onClick:()=>{t("Unknown domain")},className:"mt-2",children:e.jsx(c,{...Q.createActionLabel})})]});return a?e.jsx(ct,{side:"top",label:i.formatMessage(Q.disabledCustomActionsTooltip),children:r}):r}function Qn(s){var t,a;return(((t=s.files)==null?void 0:t.length)??0)>0||((a=s==null?void 0:s.tools)==null?void 0:a.some(i=>i.type===$.JIT_PLUGIN))}const Xn=12;function Jn({gizmoEditorData:s,updateGizmo:t,currentModelConfig:a,generateProfilePic:i,setIsUploadingProfilePic:r,isGeneratingProfilePic:n,setIsGeneratingProfilePic:l,requireGizmoId:o,onShowActionsEditor:m,onShowBlocksEditor:v}){const y=(s==null?void 0:s.tools)??[],[j,u]=x.useState(!1),[f,p]=x.useState(!0),d=(s==null?void 0:s.promptStarters)??[],T=[...d,...d.length<Xn?[""]:[]],h=qe(s),k=Le(),P=k==null?void 0:k.isWorkspaceAccount(),O=lt(Xs.WorkspaceGPTCustomActions),M=Z(),{value:I}=Se("804300613"),{value:U}=Se("736089948"),{value:z}=Se("3047641741");return e.jsxs("div",{className:"flex h-full grow flex-col overflow-y-auto px-2 pt-6 text-sm",children:[e.jsxs("div",{className:"grow",children:[e.jsxs(te,{children:[e.jsx(Wn,{gizmoEditorData:s,generateProfilePic:i,isGeneratingProfilePic:n,setIsGeneratingProfilePic:l,onFileChange:async N=>{if(N!=null&&N!=="uploading"&&N.fileId!=null){const C=await Ee.getFileDownloadLink(N.fileId);C.status===ys.Success&&t({profilePictureId:N.fileId!=null?N.fileId:void 0,profilePictureUrl:C.download_url})}else t({profilePictureId:void 0,profilePictureUrl:void 0});r(N==="uploading")}}),e.jsx(X,{label:e.jsx(c,{id:"M4dZms",defaultMessage:"Name"}),description:e.jsx(c,{id:"+Gkni2",defaultMessage:"The name of your GPT"})}),e.jsx(ss,{type:"text",placeholder:M.formatMessage(Q.gptNamePlaceholder),value:(s==null?void 0:s.name)??"",onChange:N=>{t({name:N.target.value})},onBlurCapture:()=>t(N=>({...N,name:N.name.trim()}))}),h.includes(pe.GizmoNameTooLong)?e.jsx(rs,{className:"mt-1",children:e.jsx(c,{...Q.nameTooLong,values:{length:tt}})}):null]}),e.jsxs(te,{className:"mt-4",children:[e.jsx(X,{label:e.jsx(c,{id:"YDzNvf",defaultMessage:"Description"}),description:e.jsx(c,{id:"dpxCw8",defaultMessage:"Short description of what this GPT does"})}),e.jsx(ss,{type:"text",placeholder:M.formatMessage(Q.descriptionPlaceholder),value:(s==null?void 0:s.description)??"",onChange:N=>t({description:N.target.value}),onBlurCapture:()=>t(N=>{var C;return{...N,description:((C=N.description)==null?void 0:C.trim())??""}})}),h.includes(pe.GizmoDescriptionTooLong)?e.jsx(rs,{className:"mt-1",children:e.jsx(c,{...Q.descriptionTooLong,values:{length:at}})}):null]}),e.jsxs(te,{children:[e.jsx(X,{label:e.jsx(c,{id:"2SO0RJ",defaultMessage:"Instructions"}),description:M.formatMessage(Q.instructionsSubtitle)}),e.jsxs("div",{className:"relative",children:[e.jsx(fs,{className:"resize-none",rows:8,value:s==null?void 0:s.instructions,onChange:N=>t({instructions:N.target.value}),onBlurCapture:()=>t(N=>({...N,instructions:N.instructions.trim()})),placeholder:M.formatMessage(Q.instructionsSubtitle)}),e.jsx("button",{className:"absolute bottom-3 right-2 text-token-text-tertiary",onClick:()=>u(!0),children:e.jsx(ka,{className:"icon-sm"})})]}),h.includes(pe.GizmoInstructionsTooLong)?e.jsx(rs,{className:"mt-1",children:e.jsx(c,{...Q.instructionsTooLong,values:{length:nt}})}):null]}),e.jsxs(te,{children:[e.jsx(X,{label:e.jsx(c,{id:"6rfYOX",defaultMessage:"Conversation starters"}),description:e.jsx(c,{id:"OSOIpd",defaultMessage:"Examples for the user to start the conversation"})}),e.jsx("div",{className:"flex flex-col gap-1",children:T.map((N,C)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(ss,{className:"rounded-r-none",value:N,type:"text",onChange:q=>{const H=q.target.value;t(A=>({...A,promptStarters:ks(C>=(d.length??0)?[...d??[],H]:d.map((V,R)=>R===C?H===""?void 0:H:V))}))}}),e.jsx("button",{className:"flex h-9 w-9 items-center justify-center rounded-lg rounded-l-none border border-l-0 border-token-border-medium",onClick:()=>t(q=>({...q,promptStarters:d.filter((H,A)=>A!==C)})),children:e.jsx(ba,{className:"icon-sm"})})]},C))})]}),e.jsxs(te,{children:[e.jsx(X,{label:e.jsx(c,{id:"bwXSkU",defaultMessage:"Knowledge"}),description:M.formatMessage(Q.knowledgeExplanation)}),e.jsx(Hn,{gizmoEditorData:s,requireGizmoId:o,currentModelConfig:a,updateGizmo:t})]}),e.jsxs(te,{children:[e.jsx(X,{label:e.jsx(c,{id:"mcAwDU",defaultMessage:"Capabilities"}),description:e.jsx(c,{id:"2exQT6",defaultMessage:"Functionality this GPT can use"})}),e.jsx(en,{enabledTools:y,onEnabledToolsChange:N=>t({tools:N})})]}),e.jsxs(te,{children:[e.jsx(X,{label:e.jsx(c,{id:"7r7v+u",defaultMessage:"Actions"}),description:e.jsx(c,{id:"fBln7I",defaultMessage:"APIs this GPT can use"})}),e.jsx($n,{isDisabled:!!(P&&!O),gizmo:s,onShowActionsEditor:m})]}),!P&&Qn(s)&&e.jsxs(te,{children:[e.jsx(X,{label:e.jsx(c,{id:"R3KeU7",defaultMessage:"Additional Settings"}),collapsed:!!f,onClick:()=>{p(N=>!N)}}),e.jsx(Yn,{collapsed:f,initial:!1,children:e.jsx(Na,{className:"mx-3 my-1",labelClassName:"w-full cursor-pointer",label:e.jsx(c,{id:"tZgwFW",defaultMessage:"Use conversation data in your GPT to improve our models"}),id:"improve-chatgpt",checked:!s.trainingDisabled,onChange:()=>{t({trainingDisabled:!s.trainingDisabled})}})})]}),I&&e.jsx(Zn,{gizmoEditorData:s,updateGizmo:t}),U&&!z&&e.jsx(qn,{gizmoEditorData:s,updateGizmo:t}),z&&e.jsx(gn,{gizmoEditorData:s,onOpen:v})]}),j&&e.jsx(Kn,{text:s.instructions??"",onChange:N=>{t({instructions:N})},onClose:()=>u(!1),placeholder:M.formatMessage(Q.instructionsSubtitle)})]})}const Zn=Fe(()=>Oe(()=>import("./sso-ihqxdzxswuiox36n.js").then(s=>s.G),__vite__mapDeps([4,1,2,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108])).then(s=>s.GizmoContactsEditor)),Q=xe({nameTooLong:{id:"gizmo.nameTooLong",defaultMessage:"GPT names cannot be longer than {length} characters."},knowledgeExplanation:{id:"gizmo.knowledgeExplanation",defaultMessage:"Additional files for this GPT to reference."},descriptionTooLong:{id:"gizmo.descriptionTooLong",defaultMessage:"GPT descriptions cannot be longer than {length} characters."},instructionsTooLong:{id:"gizmo.instructionsTooLong",defaultMessage:"GPT instructions cannot be longer than {length} characters."},disabledCustomActionsTooltip:{id:"gizmo.disabledCustomActionsTooltip",defaultMessage:"Custom actions are disabled for your workspace. Contact your admin to enable them."},createActionLabel:{id:"gizmo.createActionLabel",defaultMessage:"Create new action"},maxActionsReached:{id:"gizmo.maxActionsReached",defaultMessage:"GPTs can have a maximum of {number} actions"},descriptionPlaceholder:{id:"gizmo.descriptionPlaceholder",defaultMessage:"Add a short description about what this GPT does"},instructionsSubtitle:{id:"gizmo.instructionsSubtitle",defaultMessage:"What does this GPT do? How does it behave? What should it avoid doing?"},gptNamePlaceholder:{id:"gizmo.gptNamePlaceholder",defaultMessage:"Name your GPT"},callbackUrlLabel:{id:"gizmo.callbackUrlLabel",defaultMessage:"Callback URL"}});function zn(s,t){const a=s.response,i=Js(s);if(!Array.isArray(a))return i;const r=ks(a.map(n=>{if(n.type==="value_error.any_str.max_length")switch(n.loc[1]){case"display":{switch(n.loc[2]){case"name":return t.formatMessage(Q.nameTooLong,{length:n.ctx.limit_value});case"description":return t.formatMessage(Q.descriptionTooLong,{length:n.ctx.limit_value})}break}case"instructions":return t.formatMessage(Q.instructionsTooLong,{length:n.ctx.limit_value})}if(typeof n.msg=="string")return n.msg}));return r.length>0?r.join(`
`):i}function Dn({upsertDraftError:s}){const t=Z(),a=zn(s,t);return e.jsxs("div",{className:"flex items-center gap-2 text-red-500",children:[e.jsx("div",{children:e.jsx(c,{...Ft.errorSavingDraft})}),a!=null&&e.jsx(ct,{label:a,children:e.jsx(ps,{className:"icon-sm"})})]})}function ei({isPublished:s,isSavingDraft:t,hasUnpublishedChanges:a,upsertDraftError:i,className:r}){return i instanceof Vt?e.jsx(Dn,{upsertDraftError:i}):a?e.jsxs("div",{className:ie("flex items-center gap-2",r),children:[e.jsx("span",{className:"text-token-text-secondary",children:s?e.jsx(c,{id:"gizmoEditor.draftUnpublished",defaultMessage:"Unpublished changes"}):e.jsx(c,{id:"gizmoEditor.draftPending",defaultMessage:"Updates pending"})}),e.jsx("div",{className:"w-4 text-token-text-tertiary",children:t&&e.jsx(vs,{})})]}):null}const Ft=xe({errorSavingDraft:{id:"gizmo.errorSavingDraft",defaultMessage:"Error saving draft"}});function si({clientThreadId:s}){const t=Ia(s),a=yt(s),i=La(s,t),r=[...new Array(i).keys()].map(n=>e.jsx(Ha,{isFinalTurn:n===i-1,turnIndex:n,clientThreadId:s,conversationLeafId:t,onChangeItemInView:Re,onChangeRating:Re,onRequestMoreCompletions:Re,onRequestCompletion:tn,currentModelId:a??""},n));return e.jsx(e.Fragment,{children:r})}function Es({clientThreadIds:s}){return e.jsx(e.Fragment,{children:s.map(t=>e.jsx(si,{clientThreadId:t},t))})}const ti=Fe(()=>Oe(()=>import("./iqvwu2kwo3fu70ma.js"),__vite__mapDeps([109,1,2,3,14,7,5,6,15,16,23,88,25,20,26,27,28,10,11,29,18,19,30,31,32,33,34,35,36,24,37,38,39,40,17,21,8,9,12,13,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,85,86,69,110])).then(s=>s.DebugConversationSidebar));function Ws(){return e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"border-token-border-secondary flex-grow border-b"}),e.jsxs("div",{className:"flex flex-shrink-0 items-center gap-2 px-2 py-6 text-sm text-token-text-tertiary",children:[e.jsx(Ma,{className:"icon-sm"}),e.jsx(c,{id:"qtaMEG",defaultMessage:"GPT updated"})]}),e.jsx("div",{className:"border-token-border-secondary flex-grow border-b"})]})}var ai=(s=>(s.TestGizmoAction="test_gizmo_action",s))(ai||{});const ni=new an;function ii({gizmoEditorData:s,isSavingDraft:t,currentModelConfig:a,showTitle:i=!0}){var h;const[r,n]=x.useState(()=>Ye()),[l,o]=x.useState([]);x.useEffect(()=>{o(k=>k[k.length-1]===r?k:[...k,r])},[r]);const m=l.slice(0,-1);Mt(r,{kind:Me.GizmoTest,gizmo_id:s.id}),x.useEffect(()=>{G.updateConversationMode(r,{kind:Me.GizmoTest,gizmo_id:s.id})},[r,s.id]);const v=(h=s.files)==null?void 0:h.map(k=>k.file_id).join();x.useEffect(()=>{G.getServerThreadId(r)!=null&&n(Ye())},[s.id,s.instructions,s.tools,v,r]);const y=wt(k=>k.activeSidebar),j=x.useMemo(()=>({gizmoEditorData:s,mode:"test"}),[s]),[u,f]=x.useState(0),p=()=>{f(k=>k-360)},d=s.id,T=ri(r,a);return x.useEffect(()=>Kt(ni,{test_gizmo_action:({rootDomain:k,operationName:P})=>{d&&T(d,k,P)}}),[T,d]),e.jsx(dt.Provider,{value:j,children:e.jsxs("div",{className:ie("flex h-full w-full",t&&"cursor-wait opacity-80 transition"),children:[e.jsxs("div",{className:"flex grow flex-col",children:[e.jsx("div",{className:"relative mb-2 flex-shrink-0",children:e.jsx("div",{className:"flex justify-center py-1",children:i&&e.jsxs("div",{className:"group flex items-center gap-2 text-lg font-semibold",children:[e.jsx("div",{className:"icon-md"}),e.jsxs("button",{onClick:()=>{p(),o([]),n(Ye())},className:"flex items-center gap-2",children:[e.jsx(c,{id:"2u/6Ja",defaultMessage:"Preview"}),e.jsx(Ct.div,{className:"text-token-text-primary",animate:{rotate:u},transition:{duration:.3},children:e.jsx(wa,{className:"icon-md invisible group-hover:visible"})})]})]})})}),e.jsx("div",{className:ie("relative grow overflow-auto px-2",t&&"pointer-events-none"),children:e.jsx(Nt,{clientThreadId:r,hideHeader:!0,renderEmptyState:e.jsxs("div",{className:"relative h-full w-full",children:[m!=null&&m.length>0&&e.jsx("div",{className:"h-full w-full opacity-20",children:e.jsxs(ta,{children:[e.jsx(Es,{clientThreadIds:m}),e.jsx(Ws,{})]})}),e.jsx("div",{className:"absolute left-0 top-0 h-full w-full",children:e.jsx(nn,{gizmo:s,hideOwner:!0,showStarterPrompts:!0})})]}),prependThreadChildren:m.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"opacity-50",children:e.jsx(Es,{clientThreadIds:m})}),e.jsx(Ws,{})]})})})]}),y==="debug"&&e.jsx(ti,{clientThreadId:r,slideOver:!1,onClose:()=>Ms.toggleActiveSidebar("debug"),isOpen:!0})]})})}const qs=Zs.memo(ii);function ri(s,t){const a=Tt(s,void 0,Re);return x.useCallback(async(r,n,l)=>{if(!t)return;const o=G.getThreadCurrentLeafId(s),m=Ae(),v=na(n);G.updateTree(s,d=>{d.addNodeToEnd(o,{id:m,children:[],parentId:o,message:{id:m,author:{role:ue.User},content:{content_type:Yt.Text,parts:[`Call the ${n} API with the ${l} operation`]},recipient:"all",metadata:{jit_plugin_data:{from_client:{type:"test",operation:l,tool_name:v}}}}})});const y={conversationMode:{kind:Me.GizmoTest,gizmo_id:r}},j=await zs(),[u,f,p]=await Promise.all([Ds.getEnforcementToken(j),_t.getEnforcementToken(j),et.getEnforcementToken(j)]);a({model:t.id,completionType:st.Next,parentNodeId:m,metadata:{},focusOnNewCompletion:!0,chatReq:j,arkoseToken:u,turnstileToken:f,proofToken:p,preflightTime:0,completionMetadata:y})},[s,a,t])}function oi(s,t){const a=G.getThreadCurrentLeafId(s),i=G.getTree(s),r=[];let n=i.getNodeByIdOrMessageId(a);for(;n!=null&&(t==null||n.id!==t);)r.unshift(n.message),n=n.parentId!==""?i.getNodeByIdOrMessageId(n.parentId):void 0;return r}function li(s){return s.filter(i=>i.recipient==="gizmo_editor.update_behavior").flatMap(i=>i.content.content_type==="text"?i.content.parts:i.content.content_type==="code"?[i.content.text]:[]).map(i=>JSON.parse(i)).reduce((i,r)=>({...i,...r}),{})}async function ci(s){let t;for(const a of s)if(a.author.name==="gizmo_editor.generate_profile_pic"){const i=Qt.getImageAssetPointers(a);i.length>0&&(t=i.at(-1))}if(t!=null){const a=Da(t.asset_pointer),i=await Ee.getFileDownloadLink(a);if(i.status===ys.Success)return{id:a,permalink:i.download_url}}}async function di(s,t,a){const i=oi(t,a),r=li(i);let n=await ci(i);if(xs(r)&&n==null)return;const{name:l,context:o,description:m,profile_pic_file_id:v,prompt_starters:y}=r;if(v!=null)try{const u=await Ee.getFileDownloadLink(v,s.id);u.status===ys.Success&&(n={id:v,permalink:u.download_url})}catch(u){cs.addError(new Error("Error while retrieving profile pic in update",{cause:u})),J.warning("Something went wrong updating your GPT's profile picture.",{duration:3})}const j={name:typeof l=="string"?l:void 0,description:typeof m=="string"?m:void 0,instructions:typeof o=="string"?o:void 0,promptStarters:Array.isArray(y)?y:void 0,profilePictureId:n==null?void 0:n.id,profilePictureUrl:n==null?void 0:n.permalink};return $t(j,u=>u!=null)}function ui(s){const t=new Set;for(const m of s.tools)t.add(m.type);const a=s.name??"",i=s.description??"",r=s.instructions??"",n=Array.from(t).join(","),l=a===""&&i===""&&r==="",o=s.profilePictureUrl!=null;return l?`The GPT you are about to has the following abilities: ${n}.`:`This is the GPT's current set of fields:

name: ${a}

description: ${i}

context: ${r}

abilities: ${n}

${o?"The GPT has a profile picture.":"This GPT does not have a profile picture. You must generate a profile picture when you next update your behavior."}
`}function Ot(s,t,a,i){var u,f;const r=a.current,n=i.current;if(ke(r,n))return;const l={};r.name!==(n==null?void 0:n.name)&&(l.name=r.name),(r.description??"")!==((n==null?void 0:n.description)??"")&&(l.description=r.description??""),r.instructions!==((n==null?void 0:n.instructions)??"")&&(l.context=r.instructions??"");const o=new Set(((u=n==null?void 0:n.files)==null?void 0:u.map(p=>p.file_id))??[]),m=new Set(((f=r.files)==null?void 0:f.map(p=>p.file_id))??[]),v=(r.files??[]).filter(p=>!o.has(p.file_id)),y=((n==null?void 0:n.files)??[]).filter(p=>!m.has(p.file_id));if(xs(l)&&v.length===0&&y.length===0)return;const j=[];if(!xs(l)){const p=`Explicitly update the GPT's behavior to the following exact fields:

    ${JSON.stringify(l,null,2)}

    "Do not call update_behavior yet. Instead, use these updated fields as the GPT's current behavior, and in the next call to update_behavior, incorporate these changes."
    `;j.push(Ce.getTextAsMessage(p,ue.System))}y.length>0&&j.push(Ce.getTextAsMessage(`The user has removed the following files from the GPT. You can no longer reference these files: ${y.map(p=>p.file_id).join(", ")}`,ue.System)),v.length>0&&j.push(Ce.getTextAsMessage(`The user is adding these files to the GPT. The GPT may reference these files. The file IDs are: ${v.map(p=>p.file_id).join(", ")}`,ue.System,{attachments:v.map(p=>({id:p.file_id,name:p.name,size:p.size}))})),j.length>0&&G.updateTree(s,p=>{let d=p.getNodeByIdOrMessageId(t).parentId;for(const T of j){const h=Ae();p.insertNodeBefore(t,{id:h,children:[],parentId:d,message:T,metadata:{isClientCreatedSystemMessage:!0}}),d=h}})}function pi(s,t,a){if(a.length===0)return;const i=Ae(),r=`The user is uploading files in their next message. If you need to reference these in calls to update_behavior, you will use the following File ID(s), in order: ${a.map(n=>`"${n.fileId}"`).join(", ")}`;G.updateTree(s,n=>{const l=n.getNodeByIdOrMessageId(t).parentId;n.insertNodeBefore(t,{id:i,children:[],parentId:l,message:Ce.getTextAsMessage(r,ue.System),metadata:{isClientCreatedSystemMessage:!0}})})}function mi(s,t){const a="Remember, you should be calling either update_behavior or generate_profile_pic after most messages from the user. Your personality should be neutral and separate from the GPT you are creating.",i=G.getThreadCurrentLeafId(s),r=G.getTree(s);let n=r.getNodeByIdOrMessageId(i);for(;n!=null&&n.message.author.role!==ue.User;){if(n.message.content.content_type==="text"&&n.message.content.parts[0]===a)return;n=n.parentId!==""?r.getNodeByIdOrMessageId(n.parentId):void 0}G.updateTree(s,l=>{const o=l.getNodeByIdOrMessageId(t).parentId;l.insertNodeBefore(t,{id:Ae(),children:[],parentId:o,message:Ce.getTextAsMessage(a,ue.System,{exclude_after_next_user_message:!0}),metadata:{isClientCreatedSystemMessage:!0}})})}function fi(s,t,a){G.initThread(s,{kind:Me.GizmoMagicCreate,gizmo_id:void 0,behavior_overrides:a});const r=_a().id,n=yt(s)??r,l=Tt(s,void 0,t);return async(m,v,y)=>{if(y.length===0)return;let j=G.getThreadCurrentLeafId(s);for(const k of y){const P=Ae();G.updateTree(s,O=>{O.addNodeToEnd(j,{id:P,children:[],parentId:j,message:Ce.getTextAsMessage(k,ue.System),metadata:{isClientCreatedSystemMessage:!0}})}),G.setThreadCurrentLeafId(s,P),j=P}const u=j;Ot(s,u,m,v);const f={conversationMode:{kind:Me.GizmoMagicCreate,gizmo_id:m.current.id,behavior_overrides:a}},p=await zs(),[d,T,h]=await Promise.all([Ds.getEnforcementToken(p),_t.getEnforcementToken(p),et.getEnforcementToken(p)]);l({model:n,completionType:st.Next,parentNodeId:u,metadata:{},focusOnNewCompletion:!0,chatReq:p,arkoseToken:d,turnstileToken:T,proofToken:h,preflightTime:0,completionMetadata:f})}}const gi="Generate a new profile picture for this GPT using gizmo_editor generate_profile_pic. Do not prompt the user for any clarification. Do not send extra text outside of the tool function call. DO NOT CALL update_behavior or otherwise update GPT behavior in your response.",xi=Fe(()=>Oe(()=>import("./iqvwu2kwo3fu70ma.js"),__vite__mapDeps([109,1,2,3,14,7,5,6,15,16,23,88,25,20,26,27,28,10,11,29,18,19,30,31,32,33,34,35,36,24,37,38,39,40,17,21,8,9,12,13,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,85,86,69,110])).then(s=>s.DebugConversationSidebar));function hi(s,t){x.useEffect(()=>{const a=G.getTree(s);if(a.findNode(l=>{var o;return l.message.author.role===ue.User||((o=l.metadata)==null?void 0:o.isClientCreatedSystemMessage)===!0})||(G.deleteNodesByFilter(s,l=>{var o;return((o=l.metadata)==null?void 0:o.isPlaceholderTemplateAssistantWelcomeMessage)===!0}),t==null||t.length===0))return;const r=G.getThreadCurrentLeafId(s);if(!a.hasNodeOrMessageId(r))return;const n=Ae();G.updateTree(s,l=>{l.addNode(n,t,r,ue.Assistant,{isPlaceholderTemplateAssistantWelcomeMessage:!0})}),G.setThreadCurrentLeafId(s,n)},[s,t])}function ji(s,t,a){Mt(s,{kind:Me.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:a}),x.useEffect(()=>{G.updateConversationMode(s,{kind:Me.GizmoMagicCreate,gizmo_id:t.id,behavior_overrides:a})},[s,t.id,a]);const[i]=x.useState(()=>{const r=t.id==null,n=t.id!=null&&t.name!==""&&t.description!=null&&t.instructions!==""&&t.profilePictureUrl!=null;return r?`Hi! I'll help you build a new GPT. You can say something like, "make a creative who helps generate visuals for new products" or "make a software engineer who helps format my code."

What would you like to make?`:n?`Welcome back! Is there anything ${t.name} should be doing better? Anything you'd like to change?`:"You're back! Let's continue where we left off..."});hi(s,i)}function vi({gizmoEditorData:s,updateGizmo:t,clientThreadId:a,completionCallbackResponse:i,gizmoEditorDataRef:r,magicMakerBehaviorOverrides:n,magicMakerConversationGizmoEditorDataRef:l,requireGizmoId:o}){const m=x.useMemo(()=>({gizmoEditorData:s,gizmoId:s.id,mode:"magic",behaviorOverrides:n,getGizmoId:o}),[o,s,n]),v=Va(u=>u.files.filter(f=>f.status===ae.Ready&&f.gizmoId!=null)),y=x.useCallback((u,f)=>{pi(u,f,v),Ot(u,f,r,l),mi(u,f),t(p=>({...p,files:[...p.files??[],...ks(v.map(d=>{var T;return d.fileId!=null&&{file_id:d.fileId,name:d.file.name,size:d.file.size,type:d.file.type,last_modified:d.file.lastModified,file_size_tokens:(T=d.fileSpec)==null?void 0:T.fileTokenSize}}))]})),l.current=Pe(r.current)},[r,l,v,t]),j=wt(u=>u.activeSidebar);return e.jsx(dt.Provider,{value:m,children:e.jsxs("div",{className:"relative flex h-full grow overflow-auto",children:[e.jsx("div",{className:"grow",children:e.jsx(Nt,{clientThreadId:a,onCompletionFinished:i,preRequestCompletion:y,hideHeader:!0,prependThreadChildren:e.jsx("div",{className:"h-8"})})}),j==="debug"&&e.jsx(xi,{clientThreadId:a,slideOver:!1,onClose:()=>Ms.toggleActiveSidebar("debug"),isOpen:!0})]})})}const yi=Zs.memo(vi),ki=Fe(()=>Oe(()=>import("./olf0ghybf24bnz6o.js"),__vite__mapDeps([111,1,2,3,14,7,5,6,15,112,113,28,10,11,88,20,16,27,52,114,39,94,95,18,19,115,24,30,44,41,8,9,12,13,42,43,45,38,33,34,35,36,37,25,26,29,31,32,23,40,17,21,46,47,48,49,50,51,53,54,55,56,57,58,59,60,116,110,117,118,119])).then(s=>s.GizmoActionsEditor));var Et=(s=>(s.MAGIC_MAKER="magic",s.ADVANCED="advanced",s.PREVIEW="preview",s))(Et||{});function os({value:s,label:t}){return e.jsx(bt,{value:s,className:"text-md w-1/3 flex-grow rounded-lg border-token-border-light p-1.5 font-semibold text-token-text-tertiary transition hover:text-token-text-primary radix-state-checked:border radix-state-checked:bg-token-main-surface-primary radix-state-checked:text-token-text-primary radix-state-checked:shadow-[0_0_2px_rgba(0,0,0,.03)] md:w-1/2",children:t})}function bi({className:s,editorTab:t,setEditorTab:a}){const i=Z();return e.jsxs(kt,{className:ie("flex w-full overflow-hidden rounded-xl bg-token-main-surface-secondary p-1.5 md:w-1/2",s),value:t,onValueChange:r=>{a(r)},children:[e.jsx(os,{value:"magic",label:i.formatMessage(ls.magicMakerLabel)}),e.jsx(os,{value:"advanced",label:i.formatMessage(ls.configureLabel)}),e.jsx("div",{className:"flex w-1/3 md:hidden",children:e.jsx(os,{value:"preview",label:i.formatMessage(ls.previewLabel)})})]})}function wi(s,t){return s.length!==t.length?!1:s.every(a=>t.some(i=>i.type===a.type))}function Mi(s,t){var a,i;return s.name===t.gizmo.display.name&&s.description===t.gizmo.display.description&&s.instructions===t.gizmo.instructions&&wi(s.tools,t.tools)&&ke(((a=s.files)==null?void 0:a.map(r=>r.file_id))??[],((i=t.files)==null?void 0:i.map(r=>r.file_id))??[])&&s.profilePictureUrl==t.gizmo.display.profile_picture_url&&s.profilePictureId==t.gizmo.display.profile_pic_id}const js={id:void 0,instructions:"",name:"",description:"",profilePictureId:void 0,profilePictureUrl:void 0,promptStarters:[],sharing:{recipient:g.Private,subjects:[]},tools:[{type:$.DALLE}],files:[],trainingDisabled:!1,liveVersion:0},Ni={...js,tools:[...js.tools,{type:$.BROWSER}]};function Hs(s){return{id:s.gizmo.id,instructions:s.gizmo.instructions,name:s.gizmo.display.name,description:s.gizmo.display.description??"",profilePictureId:s.gizmo.display.profile_pic_id??void 0,profilePictureUrl:s.gizmo.display.profile_picture_url??void 0,promptStarters:s.gizmo.display.prompt_starters??[],tools:Pe(s.tools),files:Pe(s.files),sharing:s.gizmo.sharing?Pe(s.gizmo.sharing):{subjects:[],recipient:s.gizmo.share_recipient},trainingDisabled:s.gizmo.training_disabled??!1,sharingRecipient:s.gizmo.share_recipient,sharingTargets:Pe(s.gizmo.sharing_targets),liveVersion:s.gizmo.live_version??0}}const Wt=({gizmo:s,onNewGizmoId:t})=>{const a=Be(),i=lt(Xs.BrowsingAvailable),r=Z(),n=x.useRef(s!=null?Hs(s):i?Ni:js),l=x.useRef(s),o=x.useRef(n.current),[m,v]=x.useState(()=>n.current),[y,j]=x.useState(()=>Ye()),[u]=x.useState(()=>({context_message:ui(n.current),model_slug:"unused",enabled_tools:[{tool_id:s!=null?"gizmo_editor":"gizmo_creator"}]}));ji(y,o.current,u);const{data:f}=Pa(),p=(f==null?void 0:f.modelsList.find(w=>w.tags.includes(Jt.GPT_4)))??(f==null?void 0:f.modelsList.find(w=>w.id===Sa)),{data:d}=ut(n.current.id),T=la(),{isPending:h,error:k}=T,P=ca(),O=x.useMemo(()=>d!=null&&!Mi(m,d),[m,d]),M=async()=>{const w=n.current;try{const S=await T.mutateAsync({editorData:w,gizmoId:w.id});if(l.current=S,n.current.id==null){const K=S.gizmo.id;n.current={...n.current,id:K,sharingTargets:S.gizmo.sharing_targets},v(n.current),t==null||t(K)}for(const K of S.tools.filter(le=>le.type===$.JIT_PLUGIN)){const le=n.current.tools.find(ve=>ve.type===$.JIT_PLUGIN&&ve.metadata.domain===K.metadata.domain);le&&le.metadata.action_id!==K.metadata.action_id&&(le.metadata={...le.metadata,action_id:K.metadata.action_id},v(n.current))}return S}catch(S){const K=Js(S)??r.formatMessage(Ft.errorSavingDraft);throw J.warning(K,{duration:2}),S}},I=x.useRef(),U=async()=>n.current.id!=null?n.current.id:(I.current==null&&(I.current=M().then(w=>w.gizmo.id).catch(w=>{throw I.current=void 0,w})),I.current),[z]=x.useState(()=>Aa(()=>M(),2e3,{trailing:!0}));function N(w,S=!0){const K=typeof w=="function"?w(n.current):yn(n.current,w);ke(K,n.current)||(n.current=K,v(n.current),S&&z())}const C=x.useRef(),q=async w=>{if(w==null){E(!1);return}try{const S=await di(n.current,w,C.current);S!=null&&(N(S),o.current=Pe(n.current))}catch(S){cs.addError(S),J.warning("Something went wrong generating your GPT",{duration:3})}finally{C.current=G.getThreadCurrentLeafId(w),E(!1)}},H=fi(y,q,u),[A,V]=x.useState(void 0);x.useEffect(()=>{V(on(s))},[s==null?void 0:s.gizmo.id]);const R=async(w,S)=>{const K=qe(n.current,w.recipient,S);if(K.length>0){J.warning(`Could not save GPT:

${K.map(Te=>`- ${hs(Te)}`).join(`
`)}`,{duration:3});return}const le=await M(),ve=le.gizmo.id;try{return $s.logEvent(Qs.promoteGizmo,{gizmo_id:le.gizmo.id,sharing_recipient:w.recipient,editor_tab:ee}),await P.mutateAsync({gizmoId:le.gizmo.id,data:{sharingSubjects:w.subjects,sharingRecipient:w.recipient,categories:S==null?void 0:[S]}},{onSuccess(qt){a.setQueryData(Is(a,ve).queryKey,qt),a.invalidateQueries({queryKey:["gizmos"]}),a.invalidateQueries({queryKey:["gizmo",{gizmoId:ve}]}),a.invalidateQueries({queryKey:["gizmo","userActionSettings",{gizmoId:ve}]})}})}catch(Te){Te instanceof da?V({gizmoId:ve,sharingRecipient:w.recipient,moderationType:ze.PublishBlocked,sharingTargets:Te.response.sharing_targets,showModal:be.AppealAvailable}):(cs.addError(Te),J.warning("Error saving GPT",{duration:2}))}},he=T.isPending||P.isPending,[ee,me]=x.useState(()=>{const w=Ps.getItem(Ss.GizmoEditorTab);return Object.values(Et).includes(w)?w:"magic"}),fe=Zt.useState(({windowWidth:w})=>w);x.useEffect(()=>{fe!=null&&fe>=768&&ee==="preview"&&me("magic")},[fe,ee]);const[Ne,je]=x.useState(!1),[_,E]=x.useState(!1),[b,L]=x.useState(void 0),[se,oe]=x.useState(!1);return e.jsxs("div",{className:"flex h-screen w-full flex-col items-center",children:[e.jsx(Fn,{gizmoEditorData:m,isLoading:he,hasUnpublishedChanges:O,isUploadingProfilePic:Ne,isGeneratingProfilePic:_,publishedGizmo:d,updateGizmo:N,promoteGizmo:async(w,S)=>{const K=await R(w,S);return n.current={...n.current,sharingRecipient:w.recipient},v(n.current),Ps.setItem(Ss.GizmoEditorTab,ee),K},appealGizmo:async(w,S)=>{A!=null&&V({...A,sharingRecipient:w,categories:S==null?void 0:[S],showModal:be.AppealAvailable})},setAppealState:V,revertDraft:d!=null&&O?()=>{const w=a.getQueryData(Is(a,n.current.id).queryKey);if(w!=null){const S=Hs(w);n.current=S,v(S),M()}}:void 0,draftMessage:e.jsx(ei,{isPublished:d!=null&&(d.gizmo.share_recipient==="marketplace"||d.gizmo.share_recipient==="workspace"),hasUnpublishedChanges:O,isSavingDraft:h,upsertDraftError:k,className:"text-sm"}),showActionsModal:w=>{L(w)},className:"flex-shrink-0"}),A&&e.jsx(fn,{appealState:A,onAppealClose:()=>V({...A,showModal:be.None}),onAppealSubmitted:()=>V({...A,showModal:be.AppealSent})}),e.jsxs("div",{className:"relative flex w-full grow overflow-hidden",children:[e.jsx("div",{className:"flex w-full justify-center md:w-1/2",children:e.jsx("div",{className:"h-full grow overflow-hidden",children:b!==void 0?e.jsx(ki,{currentlyEditingActionDomain:b,gizmoEditorData:m,updateGizmo:N,onClose:()=>{L(void 0)}}):se?e.jsx(xn,{gizmoEditorData:m,updateGizmo:N,onClose:()=>{oe(!1)}}):e.jsxs("div",{className:"flex h-full flex-col px-2 pt-2",children:[e.jsx("div",{className:"flex w-full flex-row justify-center",children:e.jsx(bi,{editorTab:ee,setEditorTab:me,className:"mb-2 flex-shrink-0 self-center"})}),e.jsx("div",{className:"grow overflow-hidden",children:ee==="magic"?e.jsx("div",{className:"h-full w-full pb-5",children:e.jsx(yi,{gizmoEditorData:m,updateGizmo:N,completionCallbackResponse:q,clientThreadId:y,gizmoEditorDataRef:n,magicMakerBehaviorOverrides:u,magicMakerConversationGizmoEditorDataRef:o,requireGizmoId:U},y)}):ee==="advanced"?e.jsx(Jn,{gizmoEditorData:m,updateGizmo:N,currentModelConfig:p,generateProfilePic:()=>{E(!0),H(n,o,[gi])},setIsUploadingProfilePic:je,isGeneratingProfilePic:_,setIsGeneratingProfilePic:E,requireGizmoId:U,onShowActionsEditor:w=>{L(w)},onShowBlocksEditor:()=>{oe(!0)}}):e.jsx(qs,{gizmoEditorData:m,currentModelConfig:p,isSavingDraft:h,showTitle:!1})})]})})}),e.jsx("div",{className:ie("hidden w-1/2 justify-center border-l border-token-border-medium bg-token-main-surface-secondary pt-4",ee!=="preview"&&"md:flex"),children:e.jsx("div",{className:"flex-grow pb-5",children:e.jsx("div",{className:"h-full",children:e.jsx(qs,{gizmoEditorData:m,currentModelConfig:p,isSavingDraft:h})})})})]})]})};function Ti({gizmoId:s,version:t}){const{data:a}=ra({gizmoId:s,draft:!0,version:t}),i=Qe(rt.accountUserId),r=it(),n=r==null?void 0:r.id,l=a!=null&&i!=null&&n!=null&&oa(a);return a!=null&&l?e.jsx(Wt,{gizmo:a}):null}function _i({onNewGizmoId:s}){return e.jsx(Wt,{gizmo:void 0,onNewGizmoId:s})}function or({gizmoId:s,remixSourceId:t,version:a}){const i=Xt(),r=Le(),n=x.useRef(void 0);let l=s;return s!=null&&n.current===s&&(l=void 0),Ra({resetThreadAction:()=>{i.push("/")}}),e.jsx("div",{children:r!=null&&r.data?e.jsx("div",{children:l!=null?e.jsx(Ti,{gizmoId:l,version:a},l):e.jsx(_i,{remixSourceId:t,onNewGizmoId:o=>{n.current=o,window.history.replaceState(window.history.state,"",ia(o))}})}):e.jsx("div",{className:"flex min-h-screen items-center justify-center",children:e.jsx(vs,{})})})}const ls=xe({magicMakerLabel:{id:"gizmo.magicMakerLabel",defaultMessage:"Create"},configureLabel:{id:"gizmo.advancedLabel",defaultMessage:"Configure"},previewLabel:{id:"gizmo.previewLabel",defaultMessage:"Preview"}});export{or as G,Tn as S,ni as a,ai as b,Hs as c};
//# sourceMappingURL=eysqd59hfut746t3.js.map
