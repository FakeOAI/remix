const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/e6476rboo2cz5t2v.js","assets/hc9xxm00a3r3byem.js","assets/fga5qe14lr2llx8v.js","assets/root-gxieg4k5.css"])))=>i.map(i=>d[i]);
import{j as e,c as _,a4 as A,v as U,r as u,ax as W,a3 as $,G as k,T as l,R as G,t as F,e2 as L,D as se,p as V,u as X,a as P,aO as Z,aj as te,ak as ae,d3 as re,E as ie,dD as ne,I as oe}from"./hc9xxm00a3r3byem.js";import{a as le,b as de,A as ue}from"./lmryd6g8vt3gp93f.js";import{n as ce,aI as me,b2 as ge,b3 as Q,z as r,T as E,b4 as H,I as pe}from"./ozzpumen10p6g0yq.js";import{A as xe}from"./jzvtijirzcpvaajw.js";import{P as K}from"./caxkuyopolf76hse.js";import{as as J,a9 as he,a2 as fe,a0 as R}from"./fga5qe14lr2llx8v.js";import{D as y}from"./i9qil017zb3p1czr.js";import{u as je}from"./fdepw20m3sce5u4k.js";import"./lxui8l23v2tzixf9.js";import"./facz9srd4e5z6fv5.js";import"./olkgl1p4p1b910lq.js";import"./guykwp3ov0cliuel.js";import"./nug034oo81goid6a.js";import"./fi9p3eeu24b9vfd1.js";import"./cqwvbnjobeewuxnd.js";import"./iyldmwu8ywhos7ff.js";import"./ovjwzbtdrcsgos3a.js";import"./eq9w2mijkl5gcncq.js";import"./k0a5tmklve7lhdwt.js";import"./io7lyk89lbveno1g.js";import"./kwn3fefba30wvgsb.js";import"./hzcrrlyorrog0p41.js";import"./jt3dvx97wm610wtl.js";import"./exuoj3g9rvnr47xj.js";import"./c6gg5hubzrgc52sj.js";import"./nbrfb6b5fqz7ea4t.js";import"./lyr64vj216kc7moh.js";import"./l02mntsvyz06f5g3.js";import"./dkb2noz4qv6snkbi.js";import"./do5dtfxps7uqtxpp.js";import"./fr59f31fg6jwe2u4.js";import"./o65h1gsmgo0mfsrq.js";import"./cj3cq0j3ew1e2kbz.js";import"./b2rny0kod41myp87.js";import"./kptbw01pxwd1ocyc.js";import"./cm4yp0pj7foedy4v.js";import"./dsvckya76mm06sjp.js";import"./iej0cupg2dqkmejt.js";function Y({className:s,inputClassName:i,value:n,onChange:m,placeholder:d}){return e.jsxs("div",{className:_("relative",s),children:[e.jsx(J,{className:"icon-sm absolute left-2 top-1/2 -translate-y-1/2 transform text-token-text-tertiary"}),e.jsx("input",{type:"text",value:n,onChange:m,placeholder:d,className:_("rounded-lg border border-gray-200 pl-8 placeholder:text-gray-500 dark:border-gray-600 dark:bg-gray-700",i),autoComplete:"off"})]})}const q=1e3;function ye({group:s,isOpen:i,onClose:n}){const m=A(),d=m.formatMessage({id:"workspaceSettings.groups.addMember",defaultMessage:"Add members to the {groupName} group"},{groupName:s.name}),g=U(),[p,h]=u.useState([]),[j,c]=u.useState(!1);async function f(){const M=g==null?void 0:g.getWorkspaceId();if(!M)throw new Error("No workspace ID found");c(!0);const w=await G.bulkAddWorkspaceGroupUsers(M,s.id,p);F.success(m.formatMessage({id:"yU4Zf0",defaultMessage:"Added {numUsers} users to the group"},{numUsers:w.added_group_users.length})),n==null||n(),c(!1)}return e.jsxs(W,{isOpen:i,onClose:n??$,title:d,type:"success",showCloseButton:!0,primaryButton:e.jsx(k,{onClick:f,disabled:p.length===0||p.length>q,loading:j,children:e.jsx(l,{id:"EpbOzA",defaultMessage:"Add users to group"})}),children:[e.jsx(Me,{onChange:h}),p.length>q&&e.jsx("div",{className:"mt-2 text-sm text-token-text-error",children:e.jsx(l,{id:"9lp0Tc",defaultMessage:"Email list is limited to {maxEmails} users at once",values:{maxEmails:q}})})]})}function Me({onChange:s}){const[i,n]=u.useState("");return e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("label",{htmlFor:"group-email-paste",children:[e.jsx(l,{id:"qvGcSC",defaultMessage:"Emails"}),e.jsx("br",{}),e.jsx("span",{className:"text-sm text-token-text-tertiary",children:e.jsx(l,{id:"Fhd+5h",defaultMessage:"Paste email addresses here, one per line:"})})]}),e.jsx(ce,{id:"group-email-paste",className:"h-[250px] text-sm",value:i,onChange:m=>{n(m.target.value),s(we(m.target.value))},placeholder:`jean@example.com
joohyun@example.com
muhammed@example.com
susan@example.com`})]})}function we(s){return s.split(`
`).map(i=>i.trim()).filter(i=>i.length>0).filter(i=>me.test(i))}function Se({group:s,isOpen:i,onClose:n}){const d=A().formatMessage({id:"workspaceSettings.groups.addMember",defaultMessage:"Add members to the {groupName} group"},{groupName:s.name}),g=U(),p=g==null?void 0:g.getWorkspaceId(),[h,j]=u.useState(""),[c,f]=u.useState(0),{data:M}=ge(p,c*Q,h,Q,L),[w,C]=u.useState([]),[N,b]=u.useState([]),[S,v]=u.useState("interactive"),t=M?Math.ceil(M.total??0/Q):0;async function o(a){b(x=>[...x,a]);try{await be(p,s.id,a),C(x=>[...x,a])}catch(x){se.addError(x)}finally{b(x=>x.filter(D=>D!==a))}}return S==="batch"?e.jsx(ye,{group:s,isOpen:i,onClose:n}):e.jsx(W,{type:"warning",isOpen:i,onClose:n??$,title:d,size:"custom",className:"max-w-screen-md",showCloseButton:!0,primaryButton:e.jsx(k,{onClick:n,children:e.jsx(l,{id:"0NAzDq",defaultMessage:"Done"})}),children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-row justify-between",children:[e.jsx("p",{children:d}),e.jsx(k,{onClick:()=>{v("batch")},color:"secondary",children:e.jsx(l,{id:"5GPldp",defaultMessage:"Bulk add users"})})]}),e.jsx(Y,{value:h,inputClassName:"w-full",onChange:a=>{j(a.target.value)}}),e.jsxs(r.Root,{className:"min-w-full",children:[e.jsxs(r.Header,{children:[e.jsx(r.HeaderCell,{children:e.jsx(l,{id:"workspaceSettings.groups.addMember.name",defaultMessage:"Name"})}),e.jsx(r.HeaderCell,{children:e.jsx(l,{id:"workspaceSettings.groups.addMember.email",defaultMessage:"Email"})}),e.jsx(r.HeaderCell,{})]}),e.jsx(r.Body,{children:M==null?void 0:M.items.map(a=>e.jsxs(r.Row,{children:[e.jsx(r.Cell,{children:a.name}),e.jsx(r.Cell,{children:a.email}),e.jsx(r.Cell,{textAlign:"right",className:"pr-1",children:e.jsx(k,{size:"small",color:"secondary",disabled:N.includes(a.id),onClick:()=>{w.includes(a.id)||o(a.id)},icon:w.includes(a.id)?he:fe,children:w.includes(a.id)?e.jsx(l,{id:"workspaceSettings.groups.addMember.addButton",defaultMessage:"Added"}):e.jsx(l,{id:"workspaceSettings.groups.addMember.addedButton",defaultMessage:"Add"})})})]},a.id))})]}),e.jsx("div",{className:"flex flex-row justify-center",children:e.jsx(K,{currentPage:c,onChangeIndex:a=>{f(a)},length:t})})]})})}async function be(s,i,n){await G.addWorkspaceGroupUser(s,i,n)}const I=10;function Ne({workspaceId:s,group:i,readOnly:n}){const m=A(),[d,g]=u.useState(!1),[p,h]=u.useState(""),[j,c]=u.useState(0),{data:f,isLoading:M,isPlaceholderData:w}=V({queryKey:[s,"groups",i.id,p,`members-page-${j}`],queryFn:()=>G.listWorkspaceGroupMembers(s,i.id,p,j*I),placeholderData:L}),[C,N]=u.useState(!1),b=u.useRef(null),S=X();u.useEffect(()=>{d&&b.current&&b.current.focus()},[d]);const{mutateAsync:v}=P({mutationFn:async t=>await G.removeWorkspaceGroupMember(s,i.id,t),onMutate:t=>{S.cancelQueries({queryKey:[s,"groups",i.id]});const o=f;return S.setQueryData([s,"groups",i.id,p,`members-page-${j}`],a=>a?{...a,items:a.items.filter(x=>x.id!==t),total:a.total-1}:{limit:10,offset:0,items:[],total:0}),{previousData:o}},onError:(t,o,a)=>{S.setQueryData([s,"groups",i.id,`members-page-${j}`],a==null?void 0:a.previousData),S.invalidateQueries({queryKey:[s,"groups",i.id]})},onSettled:async()=>{await new Promise(t=>setTimeout(t,1e3)),S.invalidateQueries({queryKey:[s,"groups"]})}});return e.jsxs("div",{className:"flex w-full flex-col",children:[e.jsxs("div",{className:"flex flex-row items-center",children:[e.jsx("div",{className:"border-token-border-dark mt-3 inline-block h-8 grow-0 border-b-2 text-sm font-semibold",children:e.jsx(l,{id:"workspaceSettings.groups.membersTableTitle",defaultMessage:"Group members"})}),e.jsx("div",{className:"grow"}),e.jsx(E,{label:m.formatMessage({id:"workspaceSettings.groups.searchButtonTooltip",defaultMessage:"Search members"}),children:e.jsx("div",{className:"cursor-pointer p-2",onClick:()=>{g(!0)},children:e.jsx(J,{className:"icon-sm"})})}),e.jsx("input",{type:"text",ref:b,placeholder:m.formatMessage({id:"workspaceSettings.groups.searchMembers",defaultMessage:"Filter by name or email..."}),className:_("bg-token-surface-primary dark:bg-token-surface-secondary border-none px-0 transition-width duration-300 ease-in-out focus:ring-0",d?"w-64":"w-0"),value:p,onChange:()=>{var t;c(0),h(((t=b.current)==null?void 0:t.value)??"")}})]}),e.jsxs(r.Root,{className:"min-w-full",children:[e.jsxs(r.Header,{children:[e.jsx(r.HeaderCell,{children:e.jsx(l,{id:"workspaceSettings.groups.memberName",defaultMessage:"Name"})}),e.jsx(r.HeaderCell,{children:e.jsx(l,{id:"workspaceSettings.groups.email",defaultMessage:"Email"})}),e.jsx(r.HeaderCell,{})]}),e.jsx(r.Body,{className:M||w?"opacity-50":void 0,children:f==null?e.jsx(r.Row,{children:e.jsx(r.Cell,{colSpan:3,children:e.jsx(Z,{})})}):f.items.length===0?e.jsx(r.Row,{children:e.jsx(r.Cell,{colSpan:3,children:p===""?e.jsx(l,{id:"workspaceSettings.groups.noMembers",defaultMessage:"No members"}):e.jsx(l,{id:"workspaceSettings.groups.noMembersForSearch",defaultMessage:"No members matched the filter"})})}):f.items.map(t=>e.jsxs(r.Row,{children:[e.jsx(r.Cell,{children:e.jsx("span",{className:"ml-3",children:t.name})}),e.jsx(r.Cell,{children:t.email}),e.jsx(r.Cell,{textAlign:"right",children:!n&&(i.is_scim_managed?e.jsx(y.Root,{children:e.jsx(y.Trigger,{disabled:!0,children:e.jsx(E,{sideOffset:0,label:m.formatMessage(H.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(R,{className:"icon-sm"})})})}):e.jsxs(y.Root,{children:[e.jsx(y.Trigger,{className:"-my-2",children:e.jsx(R,{className:"icon-sm"})}),e.jsx(y.Portal,{children:e.jsx(y.Content,{children:e.jsx(y.Item,{onClick:()=>v(t.id),children:e.jsx(l,{id:"workspaceSettings.groups.removeMember",defaultMessage:"Remove member"})})})})]}))})]},t.id))})]}),e.jsxs("div",{className:"my-2 flex flex-row justify-center",children:[!n&&!i.is_scim_managed&&e.jsx(k,{color:"secondary",onClick:()=>N(!0),children:e.jsx(l,{id:"workspaceSettings.groups.addMemberButton",defaultMessage:"Add member"})}),!n&&i.is_scim_managed&&e.jsx(E,{label:m.formatMessage(H.managedViaSCIMTooltip),side:"right",sideOffset:0,children:e.jsx(k,{color:"secondary",disabled:!0,children:e.jsx(l,{id:"workspaceSettings.groups.addMemberButton",defaultMessage:"Add member"})})}),e.jsx("div",{className:"grow"}),f&&f.items.length>0&&e.jsx(K,{currentPage:j,onChangeIndex:t=>{c(t)},length:Math.ceil(f.total/I)})]}),C&&e.jsx(Se,{isOpen:!0,onClose:()=>{S.invalidateQueries({queryKey:[s,"groups"]}),N(!1)},group:i})]})}const Ce=te(()=>ae(()=>import("./e6476rboo2cz5t2v.js"),__vite__mapDeps([0,1,2,3])).then(s=>s.DirectorySyncResourceManagedIndication)),B=10;function ve({workspaceId:s}){const i=A(),n=U(),m=!(n!=null&&n.isAdminOfAccount()||n!=null&&n.isOwnerOfAccount()),d=X(),[g,p]=u.useState(""),[h,j]=u.useState(0),{data:c,isLoading:f,isPlaceholderData:M}=V({queryKey:g===""?[s,"groups",`page-${h}`]:[s,"groups","filtered",g,`page-${h}`],queryFn:()=>G.getWorkspaceGroups(s,{query:g,offset:h*B}),placeholderData:L}),[w,C]=u.useState(!1),N=t=>{t&&(j(0),p("")),C(t)},{mutateAsync:b}=P({mutationFn:async({workspaceId:t,name:o})=>await G.createWorkspaceGroup(t,o),onMutate:({workspaceId:t,name:o})=>{d.cancelQueries({queryKey:[t,"groups"]});const a=c;return d.setQueryData([t,"groups","page-0"],x=>(x||(x={limit:10,offset:0,items:[],total:0}),{...x,items:[{id:"new",name:o,num_members:0,created_time:""},...x.items.slice(0,9)]})),{previousGroups:a}},onError:(t,o,a)=>{d.setQueryData([s,"groups","page-0"],a==null?void 0:a.previousGroups),d.invalidateQueries({queryKey:[s,"groups"]}),t.message==="Group with this name already exists."&&F.warning(i.formatMessage({id:"workspaceSettings.groups.duplicateName",defaultMessage:"Group with this name already exists"}),{duration:2})},onSettled:async()=>{await new Promise(t=>setTimeout(t,1e3)),d.invalidateQueries({queryKey:[s,"groups"]})}}),{mutateAsync:S}=P({mutationFn:async t=>await G.deleteWorkspaceGroup(s,t),onMutate:t=>{d.cancelQueries({queryKey:[s,"groups","page-0"]});const o=c;return d.setQueryData([s,"groups","page-0"],a=>(a||(a={items:[]}),{...a,items:a.items.filter(x=>x.id!==t)})),{previousGroups:o}},onError:(t,o,a)=>{d.setQueryData([s,"groups","page-0"],a==null?void 0:a.previousGroups),d.invalidateQueries({queryKey:[s,"groups"]})},onSettled:async()=>{await new Promise(t=>setTimeout(t,1e3)),d.invalidateQueries({queryKey:[s,"groups"]})}}),{mutateAsync:v}=P({mutationFn:async({workspaceId:t,groupID:o,name:a})=>await G.updateWorkspaceGroup(t,o,a),onMutate:({workspaceId:t,groupID:o,name:a})=>{const x=d.getQueryData([t,"groups",`page-${h}`]);return d.setQueryData([t,"groups",`page-${h}`],D=>(D||(D={items:[]}),{...D,items:D.items.map(T=>T.id===o?{...T,name:a}:T)})),{previousGroups:x}},onError:(t,o,a)=>{d.setQueryData([o,"groups",`page-${h}`],a==null?void 0:a.previousGroups),t.message==="Group with this name already exists."&&F.warning(i.formatMessage({id:"workspaceSettings.groups.duplicateName",defaultMessage:"Group with this name already exists"}),{duration:2})},onSettled:async()=>{await new Promise(t=>setTimeout(t,1e3)),d.invalidateQueries({queryKey:[s,"groups"]})}});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3 mt-6 flex flex-row justify-between gap-2",children:[e.jsx(Y,{inputClassName:"w-[250px]",value:g,onChange:t=>{p(t.target.value),j(0)},placeholder:i.formatMessage({id:"workspaceSettings.groups.search",defaultMessage:"Search group name"})}),!m&&e.jsx(k,{onClick:()=>N(!0),children:e.jsx(l,{id:"workspaceSettings.groups.create",defaultMessage:"Create group"})})]}),e.jsxs("div",{children:[e.jsxs(r.Root,{className:"min-w-full",children:[e.jsxs(r.Header,{children:[e.jsx(r.HeaderCell,{}),e.jsx(r.HeaderCell,{children:e.jsx(l,{id:"workspaceSettings.groups.groupName",defaultMessage:"Group name"})}),e.jsx(r.HeaderCell,{children:e.jsx(l,{id:"workspaceSettings.groups.members",defaultMessage:"Members"})}),e.jsx(r.HeaderCell,{children:e.jsx(l,{id:"workspaceSettings.groups.created",defaultMessage:"Created"})}),e.jsx(r.HeaderCell,{})]}),e.jsxs(r.Body,{className:_((f||M)&&"opacity-50"),children:[w&&e.jsx(O,{group:"new",workspaceId:s,onChangeName:async t=>{t.trim()!==""&&(b({workspaceId:s,name:t}),N(!1))},onDelete:()=>null,readOnly:m}),c==null?e.jsx(r.Row,{children:e.jsx(r.Cell,{colSpan:5,textAlign:"center",children:e.jsx(Z,{})})}):c.items.length===0?e.jsx(r.Row,{children:e.jsx(r.Cell,{colSpan:5,textAlign:"center",children:g===""?e.jsx(l,{id:"workspaceSettings.groups.noGroups",defaultMessage:"No groups found."}):e.jsx(l,{id:"workspaceSettings.groups.noGroupsWithFIlter",defaultMessage:"No groups found. Try changing the search query."})})}):c.items.map(t=>e.jsx(O,{group:t,workspaceId:s,onDelete:S,onChangeName:async o=>{v({workspaceId:s,groupID:t.id,name:o})},readOnly:m},t.id))]})]}),c&&e.jsx("div",{className:"text-center",children:e.jsx(K,{length:Math.ceil(c.total/B),currentPage:Math.min(h,Math.ceil(c.total/B)),onChangeIndex:t=>j(t)})})]})]})}function ke({currentWorkspaceId:s}){const i=A();return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx("title",{children:i.formatMessage(z.title)})}),e.jsx(le,{title:i.formatMessage(z.title),subtitle:e.jsx(l,{id:"NDDzzF",defaultMessage:"Only workspace admins can edit these settings."})}),e.jsx(de,{showSpinner:!1,children:e.jsx(ve,{workspaceId:s})})]})}function O({group:s,workspaceId:i,onChangeName:n,onDelete:m,readOnly:d}){const g=A(),{value:p}=ie("2091463435"),[h,j]=u.useState(!1),[c,f]=u.useState(s==="new"?"":s.name),[M,w]=u.useState(!1),[C,N]=u.useState(s==="new"),[b,S]=u.useState(null),v=u.useRef(null);u.useEffect(()=>{var o;(s==="new"||C)&&((o=v.current)==null||o.focus())},[s,C]);const t=async()=>{if(c.trim()===""){f(s==="new"?"":s.name),N(!1),w(!1);return}n&&(w(!0),await n(c)),w(!1),N(!1)};return e.jsxs(e.Fragment,{children:[e.jsxs(r.Row,{onClick:()=>j(o=>!o),className:"hover:bg-token-surface-secondary cursor-pointer",children:[e.jsx(r.Cell,{children:e.jsx(xe,{checked:h})}),e.jsxs(r.Cell,{children:[s==="new"||C?e.jsx(pe,{ref:v,name:"newGroupName",value:c,disabled:M,placeholder:g.formatMessage({id:"workspaceSettings.groups.groupNamePlaceholder",defaultMessage:"New group name..."}),onChange:o=>f(o.target.value),onBlur:()=>{c!==(s==="new"?"":s.name)&&t()},onPressEnter:t}):s.name,p&&s!=="new"&&s.is_scim_managed&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"flex-grow"}),e.jsx(Ce,{})]})]}),e.jsx(r.Cell,{children:e.jsx(l,{id:"workspaceSettings.groups.memberCount",defaultMessage:"{count} members",values:{count:s==="new"?"0":s.num_members}})}),e.jsx(r.Cell,{children:s==="new"||!s.created_time?"":e.jsx(ne,{value:s.created_time,year:"numeric",month:"long",day:"numeric"})}),e.jsx(r.Cell,{textAlign:"right",children:s!=="new"&&!d&&(s.is_scim_managed?e.jsx(y.Root,{children:e.jsx(y.Trigger,{disabled:!0,children:e.jsx(E,{sideOffset:0,label:g.formatMessage(H.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(R,{className:"icon-sm"})})})}):e.jsxs(y.Root,{children:[e.jsx(y.Trigger,{className:"-my-2",children:e.jsx(R,{className:"icon-sm"})}),e.jsx(y.Portal,{children:e.jsxs(y.Content,{children:[e.jsx(y.Item,{onClick:o=>{N(!0),setTimeout(()=>{var a;(a=v.current)==null||a.focus()},120),o.stopPropagation()},children:e.jsx(l,{id:"workspaceSettings.groups.changeName",defaultMessage:"Edit name"})}),e.jsx(y.Item,{onClick:o=>{S(s),o.stopPropagation()},children:e.jsx(l,{id:"workspaceSettings.groups.edit",defaultMessage:"Delete group"})})]})})]}))})]}),h&&s!=="new"&&e.jsx(r.Row,{children:e.jsx(r.Cell,{colSpan:5,className:"pl-8",children:e.jsx(Ne,{group:s,workspaceId:i,readOnly:d})})}),b&&e.jsx(Ge,{group:b,onDelete:m,onClose:()=>S(null)})]})}function Ge({group:s,onDelete:i,onClose:n}){const d=A().formatMessage({id:"workspaceSettings.groups.deleteGroupTitle",defaultMessage:"Delete group {groupName}?"},{groupName:s.name});return e.jsx(W,{type:"warning",isOpen:!0,onClose:n,title:d,showCloseButton:!0,primaryButton:e.jsx(k,{color:"danger",onClick:async()=>{i(s.id),n()},children:e.jsx(l,{id:"workspaceSettings.groups.confirmDelete",defaultMessage:"Delete"})}),secondaryButton:e.jsx(k,{onClick:n,color:"secondary",children:e.jsx(l,{id:"workspaceSettings.groups.cancelDelete",defaultMessage:"Cancel"})}),children:e.jsx("p",{children:e.jsx(l,{id:"workspaceSettings.groups.deleteGroupWarning",defaultMessage:'Are you sure you want to delete the "{groupName}" group? This action cannot be undone.',values:{groupName:s.name}})})})}const z=oe({title:{id:"admin.groupsSettings.title",defaultMessage:"Groups"}});function ee(s){return e.jsx(ke,{...s})}ee.getLayout=function(i){return e.jsx(ue,{mobilePageTitle:"Groups",children:i})};function gs(){const s=je();return e.jsx(ee,{...s})}export{gs as default};
//# sourceMappingURL=mulhszrd4lb2jheo.js.map
