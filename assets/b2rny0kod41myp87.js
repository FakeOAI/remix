import{r as U,a4 as b,aN as F,cT as u,D as p,I as T,aq as I,bU as v,t as k,R as P,as as N}from"./hc9xxm00a3r3byem.js";import{az as D}from"./ozzpumen10p6g0yq.js";var c=(e=>(e[e.None=0]="None",e[e.Multimodal=1]="Multimodal",e[e.Interpreter=2]="Interpreter",e[e.Retrieval=3]="Retrieval",e[e.ContextConnector=4]="ContextConnector",e[e.ProfilePicture=5]="ProfilePicture",e))(c||{});function z(e){if(e)return{contextConnector:e.context_connector,sourceUrl:e.source_url,syntheticExtension:D(e.synthetic_extension),type:e.type}}var q=(e=>(e.Uploading="uploading",e.Ready="ready",e))(q||{});function O(e){return e.replace("file-service://","")}function G(e){return"file-service://"+e}function W(e){return e.startsWith("file-service://")}function B(e,r,t){switch(r){case"file_zero_bytes":return e.formatMessage(l.fileZeroBytes,t);case"file_too_large":return e.formatMessage(l.fileTooLarge,t);case"over_user_quota":return e.formatMessage(l.overUserQuota,t);case"file_not_found":case"file_expired":return e.formatMessage(l.fileNotFound,t);case"file_timed_out":return e.formatMessage(l.fileTimedOut,t);case"ace_pod_expired":return e.formatMessage(l.codeInterpreterSessionTimeout,t);case"permission_error":return e.formatMessage(l.permissionError,t);case"default_upload_error":case"file_rejected":return e.formatMessage(l.defaultCreateEntryError,t);case"default_download_link_error":return e.formatMessage(l.defaultDownloadLinkError,t);case"file_empty":return e.formatMessage(l.fileEmpty,t);case"too_many_tokens":return e.formatMessage(l.fileTooManyTokens,t);case"file_encrypted":return e.formatMessage(l.fileEncrypted,t);case"file_corrupted":return e.formatMessage(l.fileCorrupted,t);case"failed_upload_to_blobstore":return e.formatMessage(l.failedUploadToBlobStore,t);case"internal_error":default:return e.formatMessage(l.unknownError)}}function Q(){const e=b();return U.useCallback((r,t)=>B(e,r,t),[e])}function Z(){const{session:e}=I(),{isUnauthenticated:r}=v(),t=b();return async(a,i)=>{if(!r&&e==null)return k.danger(t.formatMessage(l.fileDownloadFailed)),!1;try{const n=await P.getFileDownloadLink(a,void 0,r);if(n.status!==N.Success)throw new Error("File is not ready to download: "+JSON.stringify(n));const s=n.download_url,o=document.createElement("a");o.href=s,o.download=i,o.click(),window.open(s,"_blank")}catch{return k.danger(t.formatMessage(l.fileDownloadFailed)),!1}return!0}}function h(e,r){var t;return(r==null?void 0:r.kind)===F.GizmoInteraction||(r==null?void 0:r.kind)===F.GizmoTest?(t=r.gizmo)==null?void 0:t.product_features:e==null?void 0:e.product_features}function H(e,r){var a,i,n,s;const t=h(e,r);return((a=t==null?void 0:t.attachments)==null?void 0:a.type)===u.CodeInterpreter?c.Interpreter:((i=t==null?void 0:t.attachments)==null?void 0:i.type)===u.Multimodal?c.Multimodal:((n=t==null?void 0:t.attachments)==null?void 0:n.type)===u.Retrieval?c.Retrieval:((s=t==null?void 0:t.attachments)==null?void 0:s.type)===u.ContextConnector?c.ContextConnector:c.None}function C(e){var a;const r=(a=e.split(".").pop())==null?void 0:a.toLowerCase();return{md:"text/markdown",java:"text/x-java",py:"text/x-script.python",c:"text/x-c",cpp:"text/x-c++",h:"text/x-c++",php:"text/x-php",rb:"text/x-ruby",tex:"application/x-latext",ts:"text/x-typescript",cs:"text/x-csharp"}[r??""]||""}function R(e){switch(e){case"application/vnd.google-apps.spreadsheet":return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";case"application/vnd.google-apps.document":case"application/vnd.google-apps.presentation":return"text/plain";default:return e}}function Y(e,r,t,a,i){if(i==null)return e;const n=C(r);n&&(t=n),a&&(t=R(t));const{accepted_mime_types:s,can_accept_all_mime_types:o}=i;return s==null||s.length===0||!o||s.includes(t)?e:c.Interpreter}function J(e,r,t){var n,s,o;const a=r!==""?r:C(t),i=(n=e==null?void 0:e.product_features)==null?void 0:n.attachments;if(i!=null)return(s=i.accepted_mime_types)!=null&&s.includes(a)?i.type:(o=i.image_mime_types)!=null&&o.includes(a)?u.Multimodal:u.CodeInterpreter}function K(e,r){var a,i;const t=h(e,r);return(a=t==null?void 0:t.attachments)!=null&&a.can_accept_all_mime_types||(i=t==null?void 0:t.attachments)==null?void 0:i.accepted_mime_types}function V(e,r){const t=h(e,r),{attachments:a}=t??{};return a!=null&&a.image_mime_types?a.image_mime_types:(a==null?void 0:a.type)==="multimodal"?a.accepted_mime_types??S:[]}const S=["image/png","image/jpeg","image/gif","image/webp"];function $(e){return U.useMemo(()=>{if(e===void 0)return{};const r={"image/jpeg":[".jpg",".jpeg"],"image/svg+xml":[".svg"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".docx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".pptx"]};return{accept:e.reduce((t,a)=>(a in r?t[a]=r[a]:a.includes("/")&&(t[a]=[`.${a.split("/")[1]}`]),t),{})}},[e])}function _(e){var r;return(r=e.split(".").pop())==null?void 0:r.toLowerCase()}function X(e){const r=_(e);return r!=null&&["jpg","jpeg","png","gif","webp"].includes(r)}function ee(e){const r=_(e);return r!=null&&["xls","xlsx","csv"].includes(r)}function te(e){const r=_(e);return r!=null&&["xls","xlsx"].includes(r)}function j(e,r,t="fit"){return new Promise((a,i)=>{const n=new FileReader;n.onerror=s=>{p.addError(new Error("File reading has failed:",{cause:s})),i(new Error("Failed to read the file."))},n.onload=s=>{const o=new Image;o.onerror=d=>{p.addError(new Error("Image loading has failed:",{cause:d})),i(new Error("Failed to load the image."))},o.onload=()=>{const d=document.createElement("canvas");let f,w=0,x=0;switch(t){case"fill":f=r/Math.min(o.width,o.height);break;case"square":f=r/Math.min(o.width,o.height);break;case"fit":f=r/Math.max(o.width,o.height);break}const m=o.width*f,g=o.height*f;t==="square"?(d.width=r,d.height=r,w=(r-m)/2,x=(r-g)/2):(d.width=m,d.height=g);const y=d.getContext("2d");if(y==null){p.addError("Canvas context creation failed. Your environment might not fully support HTML5 canvas."),i(new Error("Failed to create canvas context."));return}y.drawImage(o,w,x,m,g);const E=e.type||"image/png";d.toBlob(M=>{M?a(new File([M],e.name,{type:E})):(p.addError("Blob creation failed. Blob is null."),i(new Error("Failed to create blob from image data.")))},E)},s.target==null?(p.addError("Event target is null. Failed to load image."),i("Failed to load image.")):o.src=s.target.result},n.readAsDataURL(e)})}function re(e,r){return j(e,r,"square")}function ae(e){const r=e.name.split("/")??[];return(r[r.length-1]??"").replace(/[-_]/g," ").split(".")[0]}function ie(e,r){return r?e.slice(0,-r.length-1):e}const l=T({defaultCreateEntryError:{id:"fileUpload.defaultCreateEntryError",defaultMessage:"Unable to upload {fileName}"},defaultDownloadLinkError:{id:"fileUpload.defaultDownloadLinkError",defaultMessage:"Failed to get upload status for {fileName}"},unknownError:{id:"fileUpload.unknownError",defaultMessage:"Unknown error occurred"},fileZeroBytes:{id:"fileUpload.fileZeroBytes",defaultMessage:"File is empty"},fileTooLarge:{id:"fileUpload.fileTooLarge",defaultMessage:"File is too large"},overUserQuota:{id:"fileUpload.overUserQuota",defaultMessage:"User quota exceeded"},fileNotFound:{id:"fileUpload.fileNotFound",defaultMessage:"File not found"},fileTimedOut:{id:"fileUpload.fileTimedOut",defaultMessage:"File upload timed out. Please try again."},fileEmpty:{id:"fileUpload.fileEmpty",defaultMessage:"No text could be extracted from this file."},fileTooManyTokens:{id:"fileUpload.fileTooManyTokens",defaultMessage:"This file contains too much text content. Please try again with a smaller file."},fileEncrypted:{id:"fileUpload.fileEncrypted",defaultMessage:"This file is encrypted/requires a password to access. Please try again with an unencrypted file."},fileCorrupted:{id:"fileUpload.fileCorrupted",defaultMessage:"This file is corrupted. Please ensure the file is not corrupted and try again."},codeInterpreterSessionTimeout:{id:"fileUpload.codeInterpreterSessionTimeout",defaultMessage:"Code interpreter session expired"},permissionError:{id:"fileUpload.permissionError",defaultMessage:"Missing permission to access file"},fileDownloadFailed:{id:"filesModal.fileDownloadFailed",defaultMessage:"File download failed. Please try again."},failedUploadToBlobStore:{id:"fileUpload.failedUploadToBlobStore",defaultMessage:"Failed upload to files.oaiusercontent.com. Please ensure your network settings allow access to this site or contact your network administrator."}});export{q as F,S as I,c as U,X as a,O as b,z as c,K as d,B as e,ie as f,_ as g,J as h,ee as i,W as j,Z as k,Q as l,Y as m,C as n,H as o,h as p,te as q,j as r,re as s,ae as t,$ as u,V as v,G as w};
//# sourceMappingURL=b2rny0kod41myp87.js.map
