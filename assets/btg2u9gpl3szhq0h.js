import{aN as d,bB as p}from"./hc9xxm00a3r3byem.js";import{ax as x,i as C,ay as y}from"./ozzpumen10p6g0yq.js";const A=t=>x([d.GizmoMagicCreate,d.GizmoTest],t==null?void 0:t.kind),I=t=>x([d.GizmoInteraction,d.GizmoMagicCreate,d.GizmoTest],t==null?void 0:t.kind);function w(t,e=[]){var a;if(e.length===0)return t;const o=e.filter(n=>{var i;return n.end_ix<=t.length&&n.citation_format_type==="tether_markdown"&&((i=n.metadata)==null?void 0:i.type)==="webpage"});for(let n=o.length-1;n>=0;n--){const i=o[n];if(((a=i.metadata)==null?void 0:a.type)!=="webpage")continue;const{start_ix:c,end_ix:s,metadata:r}=i,l=t.substring(c,s).replace(/\[(.*?)\]\((\d+)\)/g,`[$1](${r==null?void 0:r.url})`);t=t.substring(0,c)+l+t.substring(s)}return t}function b(t,e=[]){if(e.length===0)return[];const o=[],a=e.filter(i=>i.end_ix<=t.length&&i.citation_format_type!=="tether_markdown"),n=y(t);for(let i=a.length-1;i>=0;i--){const c=a[i];let s;const{start_ix:r,end_ix:u,metadata:l,invalid_reason:f}=c;if(!(l!=null&&l.type))continue;const g=n.slice(r,u).join("");switch(l.type){case"webpage":s={...l,type:"webpage",title:l.title??"",snippet:l.text??null,pub_date:v(l.pub_date),matched_text:g,start_idx:r,end_idx:u,alt:null};break;case"file":s={...l,matched_text:g,start_idx:r,end_idx:u,alt:null};break}f&&(s={type:"invalid",alt:f,start_idx:r,end_idx:u,matched_text:g,invalid:!0});let m=!1;if(o.length>0){const _=o[o.length-1];h(_)===h(s)&&n.slice(_.end_idx,c.start_ix).join("").trim().length===0&&(o[o.length-1].end_idx=c.end_ix,m=!0)}!m&&s&&o.push(s)}return o}function S(t,e=[],o=[],a=!0){const n=w(t,e),c=[...o.length>0?[]:b(n,e),...o],s=C(c.map(r=>r.type==="file"?T(a,r):r));return{text:n,contentReferences:s}}function $(){const{config:t}=p("1001765573"),e=p("3168246095");return t.get("ca_enabled",!1)?e.config.get("gizmo_ids",[],G):[]}function B(){return p("1001765573").config.get("ca_enabled",!1)}function G(t){return Array.isArray(t)&&t.every(e=>typeof e=="string")}function h(t){switch(t.type){case"file":return t.id;case"webpage":return t.url;case"invalid":return t.alt}}function T(t,e){if(!t)return e;const o=e.name.split("Â¤");if(o.length!==3)return e;const[a,n,i]=o;let c=i;const s=i.lastIndexOf(".");s!==-1&&(c=i.slice(0,s));let r,u="Google Drive";if(a==="gdrive")r=`https://drive.google.com/file/d/${n}/view`,u="Google Drive";else if(a==="gdoc")r=`https://docs.google.com/document/d/${n}`,u="Google Docs";else if(a==="notion")r=`https://www.notion.so/openai/${n}`,u="Notion";else return e;return{...e,type:"webpage",url:r,title:c,snippet:u,pub_date:null}}function v(t){return t==null?null:new Date(t).getTime()/1e3}export{I as a,$ as b,A as g,S as p,T as t,B as u};
//# sourceMappingURL=btg2u9gpl3szhq0h.js.map
