const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/e6476rboo2cz5t2v.js","assets/hc9xxm00a3r3byem.js","assets/fga5qe14lr2llx8v.js","assets/root-gxieg4k5.css"])))=>i.map(i=>d[i]);
import{p as S,R,a4 as j,u as w,a as A,t as P,I as C,aj as J,ak as X,r as h,j as e,T as d,E as Z,G as I,F as Y,v as ee,h as se,d3 as te,c as ae,y as ne,dV as re,J as E}from"./hc9xxm00a3r3byem.js";import{a as ie,b as oe,A as le}from"./lmryd6g8vt3gp93f.js";import{D as f,B as ce}from"./i9qil017zb3p1czr.js";import{U,G as de}from"./guykwp3ov0cliuel.js";import{c as ue}from"./iej0cupg2dqkmejt.js";import{h as me}from"./iyldmwu8ywhos7ff.js";import{a0 as N,as as ge,a2 as xe}from"./fga5qe14lr2llx8v.js";import{A as fe}from"./olkgl1p4p1b910lq.js";import{z as r,T as ve,b4 as he,X as W}from"./ozzpumen10p6g0yq.js";import{A as T,P as _,W as D,u as je,U as pe}from"./caxkuyopolf76hse.js";import{b as H,c as F,d as O,e as Me}from"./nbrfb6b5fqz7ea4t.js";import{a as be}from"./cj3cq0j3ew1e2kbz.js";import{d as ye,a as Ie}from"./cm4yp0pj7foedy4v.js";const M=25;function Re(s,t,a){return S({queryKey:["workspace",s,"invites",t,a],queryFn:async()=>await R.getWorkspaceInvites(s,t,M,a)})}function Pe(s,t,a){return S({queryKey:["workspace",s,"invites","requests",t,a],queryFn:async()=>await R.getWorkspaceInviteRequests(s,t,M,a)})}function B(s){const t=j(),a=w();return A({mutationFn:({inviteId:n,role:l,acceptRequest:o})=>R.patchWorkspaceInvite(s,n,{role:l,acceptRequest:o}).catch(i=>{P.danger(t.formatMessage(k.updateInviteError,{error:i.message}))}),onSuccess:()=>{a.invalidateQueries({queryKey:["workspace",s,"invites"]}),a.invalidateQueries({queryKey:["workspace",s,"invites","requests"]}),a.invalidateQueries({queryKey:["workspace",s]})}})}function L(s){const t=j(),a=w();return A({mutationFn:({email:n})=>R.deleteWorkspaceInvite(s,n).catch(l=>{P.danger(t.formatMessage(k.deleteInviteError,{email:n,error:l.message}))}),onSuccess:()=>{a.invalidateQueries({queryKey:["workspace",s,"invites"]}),a.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}function ke(s){const t=j(),a=w();return A({mutationFn:({role:n,email:l})=>R.addWorkspaceUsers(s,[l],n,!0).then(({account_invites:o,errored_emails:i})=>{if(i.length>0)throw new Error(i[0].error);o.length>0&&P.success(t.formatMessage(k.resendInviteSuccess,{email:l}))}).catch(o=>{P.danger(t.formatMessage(k.resendInviteError,{email:l,error:o.message}))}),onSuccess:()=>{a.invalidateQueries({queryKey:["workspace",s,"invites"]}),a.invalidateQueries({queryKey:["workspace",s,"invites","requests"]})}})}const k=C({updateInviteError:{id:"WorkspaceInvites.updateInviteError",defaultMessage:"Unable to update invite from workspace: {error}"},deleteInviteError:{id:"WorkspaceInvites.deleteInviteError",defaultMessage:"Unable to remove user ({email}) from workspace: {error}"},resendInviteSuccess:{id:"WorkspaceInvites.resendInviteSuccess",defaultMessage:"Sent a new invite to {email}"},resendInviteError:{id:"WorkspaceInvites.resendInviteError",defaultMessage:"Unable to resend invite to ({email}) from workspace: {error}"}}),Ce=J(()=>X(()=>import("./e6476rboo2cz5t2v.js"),__vite__mapDeps([0,1,2,3])).then(s=>s.DirectorySyncResourceManagedIndication));function qe({workspaceId:s,filterInputValue:t}){const[a,n]=h.useState(0),l=H(s),o=F(s),i=l||o,{data:c}=Re(s,a*M,t);if(c===void 0)return e.jsx(T,{});const u=c.items,m=Math.ceil((c.total??0)/M);return a>=m&&m!==0&&n(Math.max(m-1,0)),e.jsxs("div",{children:[e.jsxs(r.Root,{fixed:!0,size:"normal",children:[e.jsxs(r.Header,{children:[e.jsx(r.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(d,{...y.email})}),e.jsx(r.HeaderCell,{className:"w-28 bg-token-main-surface-primary",children:e.jsx("span",{className:i?"pl-3":"",children:e.jsx(d,{...y.role})})}),i&&e.jsx(r.HeaderCell,{className:"w-16 bg-token-main-surface-primary"})]}),e.jsxs(r.Body,{children:[u.map(g=>e.jsx(Ne,{workspaceId:s,invite:g,isCurrentUserOwner:l,currentUserHasAdminRights:i},g.id)),u.length===0&&e.jsx(r.Row,{children:e.jsx(r.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(d,{...y.noResults})})})})]})]}),m>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(_,{currentPage:a,onChangeIndex:n,length:m})})]})}function Ne({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n}){const l=O(),o=B(s),i=L(s),c=ke(s),{value:u}=Z("3999712942");return e.jsxs(r.Row,{disabled:o.isPending||i.isPending||i.isSuccess||c.isPending,children:[e.jsx(r.Cell,{children:e.jsxs("span",{className:"flex flex-grow justify-between",children:[e.jsx("span",{children:t.email_address}),u&&t.is_scim_managed&&e.jsx(Ce,{})]})}),e.jsx(r.Cell,{children:a?e.jsx(D,{currentRole:t.role,onUpdateUserRole:m=>{o.mutate({inviteId:t.id,role:m})}}):l[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(r.Cell,{children:e.jsx(we,{onDeleteUser:()=>{i.mutate({email:t.email_address??""})},onResendInvite:()=>{c.mutate({email:t.email_address??"",role:t.role??""})},disabled:t.is_scim_managed})})})]})}function we({onDeleteUser:s,onResendInvite:t,disabled:a}){const n=j();return e.jsx(e.Fragment,{children:a?e.jsx(f.Root,{children:e.jsx(f.Trigger,{disabled:!0,children:e.jsx(ve,{sideOffset:0,label:n.formatMessage(he.managedViaSCIMTooltip),className:"flex",side:"right",children:e.jsx(N,{className:"icon-sm"})})})}):e.jsxs(f.Root,{children:[e.jsx(f.Trigger,{children:e.jsx(N,{className:"icon-sm"})}),e.jsx(f.Portal,{children:e.jsxs(f.Content,{children:[e.jsx(f.Item,{onClick:t,children:e.jsx(d,{...y.resendInvite})}),e.jsx(f.Item,{onClick:s,children:e.jsx(d,{...y.revokeInvite})})]})})]})})}const y=C({email:{id:"InviteManager.email",defaultMessage:"Email"},role:{id:"InviteManager.role",defaultMessage:"Role"},resendInvite:{id:"InviteManager.resendInvite",defaultMessage:"Resend invite"},revokeInvite:{id:"InviteManager.revokeInvite",defaultMessage:"Revoke invite"},noResults:{id:"InviteManager.noResults",defaultMessage:"No results"}});function Ae({workspaceId:s,filterInputValue:t}){const[a,n]=h.useState(0),{data:l}=Pe(s,a*M,t),o=H(s),i=F(s),c=j(),u=o||i;if(l===void 0)return e.jsx(T,{});const m=l.items,g=Math.ceil(l.total/M);return a>=g&&g!==0&&n(Math.max(g-1,0)),e.jsxs("div",{children:[e.jsxs(r.Root,{fixed:!0,size:"normal",children:[e.jsxs(r.Header,{children:[e.jsx(r.HeaderCell,{className:"bg-token-main-surface-primary",children:e.jsx(d,{...p.email})}),e.jsx(r.HeaderCell,{className:"w-28 bg-token-main-surface-primary",children:e.jsx("span",{className:u?"pl-3":"",children:e.jsx(d,{...p.role})})}),u&&e.jsx(r.HeaderCell,{className:"w-40 bg-token-main-surface-primary",children:c.formatMessage(p.actions)})]}),e.jsxs(r.Body,{children:[m.map(b=>e.jsx(Ue,{workspaceId:s,invite:b,isCurrentUserOwner:o,currentUserHasAdminRights:u},b.id)),m.length===0&&e.jsx(r.Row,{children:e.jsx(r.Cell,{children:e.jsx("div",{className:"text-token-text-tertiary",children:e.jsx(d,{...p.noResults})})})})]})]}),g>1&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(_,{currentPage:a,onChangeIndex:n,length:g})})]})}function Ue({workspaceId:s,invite:t,isCurrentUserOwner:a,currentUserHasAdminRights:n}){const l=O(),o=B(s),i=L(s),c=j();return e.jsxs(r.Row,{disabled:o.isPending||i.isPending||i.isPending,children:[e.jsx(r.Cell,{children:t.email_address}),e.jsx(r.Cell,{children:a?e.jsx(D,{currentRole:t.role,onUpdateUserRole:u=>{o.mutate({inviteId:t.id,role:u})}}):l[t.role]}),n&&e.jsx(e.Fragment,{children:e.jsx(r.Cell,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(I,{onClick:()=>o.mutate({inviteId:t.id,acceptRequest:!0}),children:c.formatMessage(p.accept)}),e.jsx(I,{color:"secondary",onClick:()=>i.mutate({email:t.email_address}),children:c.formatMessage(p.reject)})]})})})]})}const p=C({email:{id:"RequestInviteManager.email",defaultMessage:"Email"},role:{id:"RequestInviteManager.role",defaultMessage:"Role"},actions:{id:"RequestInviteManager.actions",defaultMessage:"Actions"},accept:{id:"RequestInviteManager.accept",defaultMessage:"Accept"},reject:{id:"RequestInviteManager.reject",defaultMessage:"Reject"},noResults:{id:"RequestInviteManager.noResults",defaultMessage:"No results"}});var Q=(s=>(s.Members="members",s.Invites="invites",s.Requests="requests",s))(Q||{});function Se({tab:s}){switch(s){case"members":return e.jsx(d,{...v.allMembers});case"invites":return e.jsx(d,{...v.pendingInvites});case"requests":return e.jsx(d,{...v.pendingRequests})}}function Ee({tab:s,filterInputValue:t,workspaceId:a}){switch(s){case"members":return e.jsx(pe,{workspaceId:a,filterInputValue:t});case"invites":return e.jsx(qe,{workspaceId:a,filterInputValue:t});case"requests":return e.jsx(Ae,{workspaceId:a,filterInputValue:t})}}const We=ue(Q);function Te({currentWorkspaceId:s}){const t=j(),a=ee(),n=je(s)??"?",l=Me(a),o=a==null?void 0:a.isTeam(),i=se(),c=typeof i.query.tab=="string"&&We(i.query.tab)?i.query.tab:"members",[u,m]=h.useState(""),[g,b]=h.useState("");h.useEffect(()=>{b("")},[c]);const K=h.useCallback(me(x=>{b(x)},250),[]),q=be(),V=!!(q!=null&&q.length);if(!a)return null;const G=a.isAdminOfAccount(),$=a.isOwnerOfAccount(),z=o||!V?["members","invites"]:["members","invites","requests"];return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsx("title",{children:t.formatMessage(v.adminBrowserPageTitle)})}),e.jsx(ie,{title:t.formatMessage(v.adminPageTitle),subtitle:e.jsx(d,{values:{totalMembers:n,planName:l},...v.totalMembers})}),e.jsxs(oe,{children:[e.jsxs(De,{children:[e.jsx("div",{className:"mb-6 flex gap-2",children:z.map(x=>e.jsx(_e,{onClick:()=>{i.push(x!=null?`/admin?tab=${x}`:"/admin")},isSelected:c===x,children:e.jsx(Se,{tab:x})},x))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"icon-sm absolute left-2 top-1/2 -translate-y-1/2 transform text-token-text-tertiary"}),e.jsx("input",{type:"text",value:u,onChange:x=>{m(x.target.value),K(x.target.value)},placeholder:t.formatMessage(v.search),className:"w-48 rounded-lg border border-token-border-light bg-token-main-surface-primary pl-8 placeholder:text-token-text-tertiary"})]}),(G||$||o)&&e.jsx(I,{onClick:()=>{U.openModal(de.InviteUsersToWorkspace)},icon:xe,children:e.jsx(d,{...v.inviteMemberButton})}),o?e.jsx(ce,{triggerButton:e.jsx(I,{color:"secondary",icon:N}),children:e.jsx(f.Item,{onClick:()=>{a&&U.setLeaveWorkspaceData(a)},children:e.jsx(d,{...v.leaveWorkspace})})}):null]})]}),e.jsx(Ee,{workspaceId:s,tab:c,filterInputValue:g})]}),a!=null?e.jsx(fe,{workspace:a}):null]})}function _e({children:s,isSelected:t,onClick:a}){return e.jsx(I,{color:"ghost",className:ae(t?"bg-token-main-surface-tertiary":"hover:bg-token-main-surface-tertiary"),onClick:a,children:s})}const De=Y.div`mb-4 py-6 flex flex-col gap-4 lg:flex-row md:items-start lg:justify-between`,v=C({adminBrowserPageTitle:{id:"adminPage.adminBrowserPageTitle",defaultMessage:"ChatGPT - Member admin"},adminPageTitle:{id:"adminPage.adminPageTitle.0",defaultMessage:"Members"},workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},totalMembers:{id:"adminPage.totalMembers",defaultMessage:"{planName} · {totalMembers} {totalMembers, plural, one {member} other {members}}"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},allMembers:{id:"adminPage.allMembers",defaultMessage:"All members"},pendingInvites:{id:"adminPage.pendingInvites",defaultMessage:"Pending invites"},pendingRequests:{id:"adminPage.pendingRequests",defaultMessage:"Pending requests"},analytics:{id:"adminPage.analytics",defaultMessage:"Analytics"},inviteMemberButton:{id:"adminPage.inviteMemberButton",defaultMessage:"Invite member"},leaveWorkspace:{id:"adminPage.leaveWorkspace",defaultMessage:"Leave workspace"},search:{id:"adminPage.search",defaultMessage:"Search"}});function He(s){return e.jsx(Te,{...s})}He.getLayout=function(t){return e.jsx(le,{mobilePageTitle:"Members",children:t})};function Ye(){return ne(re("routes/admin"))}function es(){const s=W(n=>n.currentWorkspace),t=s!=null?ye(s.role):void 0,a=E();h.useEffect(()=>{t===!1&&a("/admin")},[t,a])}function ss(){const s=W(n=>n.currentWorkspace),t=s!=null?Ie(s.role):void 0,a=E();h.useEffect(()=>{t===!1&&a("/admin")},[t,a])}export{He as A,es as a,ss as b,Ye as u};
//# sourceMappingURL=fdepw20m3sce5u4k.js.map
