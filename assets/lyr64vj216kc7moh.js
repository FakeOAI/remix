import{r as P,h as H,at as V,cI as Y,aR as J,aC as Z,aK as i,aL as a,dT as C,dU as q,a4 as X,I as j,cR as D,u as d,p as f,x as F,a as w,t as L,aN as M,bG as ee}from"./hc9xxm00a3r3byem.js";import{bv as re,X as te,bw as ne}from"./ozzpumen10p6g0yq.js";import{e as se}from"./cqwvbnjobeewuxnd.js";import{T as b,g as ie}from"./iyldmwu8ywhos7ff.js";const Ge="g-YyyyMT9XH",Se="g-2fkFE8rbu";var ae=(e=>(e[e.USER=1]="USER",e[e.GROUP=2]="GROUP",e[e.WORKSPACE=3]="WORKSPACE",e[e.ALL=4]="ALL",e[e.PROJECT=5]="PROJECT",e[e.ORGANIZATION=6]="ORGANIZATION",e[e.SYSTEM=7]="SYSTEM",e[e.AGENT=8]="AGENT",e))(ae||{});const oe={can_read:!0,can_view_config:!1,can_write:!1,can_delete:!1,can_export:!1,can_share:!1},ke={can_read:!0,can_view_config:!0,can_write:!1,can_delete:!1,can_export:!1,can_share:!1},l={Private:"private",User:"user",Group:"group",WorkspaceLink:"workspace_link",Workspace:"workspace",Link:"link",Marketplace:"marketplace"};var ue=(e=>(e.FirstParty="first_party",e.UsesFunctionCalls="uses_function_calls",e.Reportable="reportable",e.Private="private",e.Workspace="workspace",e.Public="public",e.Beta="beta",e.Pinned="pinned",e.WorkspaceDisabled="workspace_disabled",e.Unreviewable="unreviewable",e))(ue||{});const Pe=e=>{var r;return(r=e.gizmo.tags)==null?void 0:r.includes("first_party")},Ae=e=>{var r;return!((r=e.gizmo.tags)!=null&&r.includes("unreviewable"))};var O=(e=>(e.FILE_SERVICE="fs",e))(O||{});function Ue(e){return e.type===1||e.type===2}const K=[1,2,3,4];function Ce(e){return e.length===0?null:e.reduce((r,t)=>K.indexOf(t.type)<K.indexOf(r.type)?r:t,e[0])}function Ee(e,r,t){return r=r.filter(n=>n.type===l.User||n.type===l.Group),e===l.Private||e===l.User||e===l.Group?[{type:l.Private,capabilities:oe},...r]:[...r,{type:e,capabilities:t}]}class ce{constructor(r){this.response=r}}var le=(e=>(e.ENGLISH="en",e.GLOBAL="global",e))(le||{}),$=(e=>(e.FirstParty="first_party",e.SidebarKeep="sidebar_keep",e.Mine="mine",e.Recent="recent",e.Workspace="workspace",e))($||{});const N="q",ge="m";function qe(e){const{clientThreadId:r,currentLeafId:t,handleRequestCompletion:n}=e,s=P.useRef(!1),{isLoading:o}=se(),c=H(),g=P.useCallback((m,h,_,v)=>{b.updateTree(r,S=>{S.addNode(m,_,h,V.User,void 0,v)})},[r]),y=P.useCallback(async(m,{content:h,attachments:_},v,S)=>{const W=t,B=_.length>0?{attachments:_}:{};g(m,W,h,B),n({type:Y.Next,promptId:m,eventMetadata:v,cancelActiveRequests:!0,completionMetadata:S})},[g,n,t]),z=J(()=>window.location.pathname)??null;let R=!o&&ye(z);const G=ie.getConversationMode(r),U=re();fe(z)&&U===void 0&&(R=!1),P.useEffect(()=>{if(!R||s.current)return;const{[N]:m,[ge]:h,..._}=c.query,v=(typeof m=="string"?m:null)??(typeof h=="string"?h:null);if(!v||b.getServerThreadId(r)!=null||G==null)return;const S=Z();s.current=!0,c.replace({query:_},void 0,{shallow:!0}),y(S,{content:v,attachments:[]},{eventSource:"url"},{conversationMode:G,source:"instant-query"})},[R,c,y,r,G])}function fe(e){return I(e)}function I(e){return e==null?!1:/^\/g\/[\w-]+$/.test(e)}function ye(e){return e==null?!1:e==="/"||I(e)}class u{static getMyGizmos(){return i.get(`${a}/gizmos?mine=true`)}static getGizmosByUser(r){return i.get(`${a}/gizmos/u/${r}`)}static getGizmo(r,t){const n=t?"?draft=true":"";return i.get(`${a}/gizmos/${r}${n}`)}static shareGizmo(r,t){return i.post(`${a}/gizmos/${r}/share`,t)}static getGizmoDiscovery(r,t){const n=new URLSearchParams;return r!=null&&n.set("locale",r),i.get(t?`${C}/gizmos/discovery_anon?${n}`:`${C}/gizmos/discovery?${n}`,{authOption:q.SendIfAvailable})}static async getGizmoDiscoveryCut(r,t){const n=o=>{const c={};o!=null&&(c.cursor=o),(t==null?void 0:t.limit)!=null&&(c.limit=`${t.limit}`),(t==null?void 0:t.locale)!=null&&(c.locale=t.locale);const g=`${C}/gizmos/discovery/${r}`;return i.get(g,{params:c,authOption:q.SendIfAvailable})},s=await n(t==null?void 0:t.cursor);return s.list.items.length===0&&s.list.cursor!=null?(await new Promise(o=>setTimeout(o,Math.random()*30)),n(s.list.cursor)):s}static getGizmoBootstrap(){return i.get(`${a}/gizmos/bootstrap?limit=2`)}static getGizmoPinned(){return i.get(`${a}/gizmos/pinned`)}static getGizmoSearch(r,t=null){return t?i.get(`${a}/gizmos/search?q=${r}&cursor=${t} `):i.get(`${a}/gizmos/search?q=${r}`)}static getGizmoSearchForWorkspace(r,t=null){return t?i.get(`${a}/gizmos/search?q=${r}&workspace_only=true&cursor=${t}`):i.get(`${a}/gizmos/search?q=${r}&workspace_only=true`)}static async postGizmoAppeal(r,t,n,s,o){await i.post(`${a}/gizmos/${t}/appeal`,{reason:n,share_recipient:s,categories:o}),await r.invalidateQueries({queryKey:["gizmo",{gizmoId:t}]})}static async postGizmoCancelAppeal(r,t){await i.post(`${a}/gizmos/${t}/cancel_appeal`,{}),await r.invalidateQueries({queryKey:["gizmo",{gizmoId:t}]})}static upsertDraft(r,t){return t!==void 0?i.post(`${a}/gizmos?gizmo_id=${t}`,r):i.post(`${a}/gizmos`,r)}static promoteDraft(r,t){return i.post(`${a}/gizmos/${t}/promote`,r)}static deleteGizmo(r){return i.delete(`${a}/gizmos/${r}`)}static getBuilderProfile(){return i.get(`${a}/gizmo_creator_profile`)}static updateBuilderProfile(r){return i.post(`${a}/gizmo_creator_profile`,r)}static unverifySocialAuth(r){return i.delete(`${a}/gizmo_creator_profile/socials/${r}`)}static async updateGizmoSidebar(r,t,n,s){const o=await i.post(`${a}/gizmos/${n}/sidebar`,{action:s});switch(s){case"keep":t.handleGizmoSidebarKeep(r,n);break;case"hide":t.handleGizmoSidebarHide(r,n);break}return o}static async removeFromRecent(r,t){const n=await i.post(`${a}/gizmos/${t}/remove_recent`,{});return r.invalidateQueries({queryKey:["gizmos","bootstrap"]}),r.invalidateQueries({queryKey:["gizmos","discovery"]}),n}static fetchOpenAPISpec(r){return i.post(`${a}/gizmos/fetch_openapi`,{url:r})}static validateOpenAPISpec(r){return i.post(`${a}/gizmos/validate_openapi`,{raw_spec:r})}static transformToOpenAPISpec(r,t){return i.post(`${a}/gizmos/transform_openapi`,{...r,auth:t})}static async doOAuthRedirect(r,t,n,s,o){const c=await i.post(`${a}/gizmos/oauth_redirect`,{gizmo_id:r,gizmo_action_id:t,domain:n,redirect_to:s,draft:o});window.location.href=c.redirect_uri}static async upsertUserActionSettings(r,t,n){return i.post(`${a}/gizmos/action_settings`,{gizmo_action_id:r,domain:t,action_settings:n})}static async getUserActionSettings(r){return i.get(`${a}/gizmos/user_action_settings?gizmo_id=${r}`)}static async generateCategory(r,t){return i.post(`${a}/gizmos/gen_category`,{name:r,instructions:t})}static async getCategories(){return i.get(`${a}/gizmos/categories`)}static async getUserReview(r){return i.get(`${a}/gizmo_reviews/${r}`)}static async upsertUserReview(r,t,n,s){return i.post(`${a}/gizmo_reviews/${r}`,{rating:t,message:n,include_from:s})}static async sendFeedbackEmail(r,t,n){return i.post(`${a}/gizmos/${r}/feedback`,{message:t,include_from:n})}static async getAbout(r){return i.get(`${a}/gizmos/${r}/about`)}static async getCreatorSlice({creatorId:r}){return i.get(`${a}/gizmo_creators/${r}/gizmos`)}static async getVersion({gizmoId:r,version:t}){return t==null?i.get(`${a}/gizmos/${r}/version/latest`):i.get(`${a}/gizmos/${r}/version/${t}`)}static async listVersions({gizmoId:r,limit:t,cursor:n}){const s={};return t&&(s.limit=t),n&&(s.cursor=n),i.get(`${a}/gizmos/${r}/versions`,{params:s})}static async getRolodex(){return i.get(`${a}/rolodex`)}static async upsertToRolodex(r,{gizmoId:t,usageDescription:n,remove:s}){const o=await i.post(`${a}/rolodex`,{gizmo_id:t,usage_description:n,remove:s});return r.invalidateQueries({queryKey:["gizmoRolodex"],refetchType:"all"}),o}static async copyGizmo({gizmoId:r}){return await i.post(`${a}/gizmos/${r}/copy`)}}function Me(e){var r;return((r=e.gizmo.current_user_permission)==null?void 0:r.can_write)??!1}function be(e){var r;return((r=e.gizmo.current_user_permission)==null?void 0:r.can_view_config)??!1}function me(e,r,t){const n=r==null?void 0:r.name;switch(e){case l.Link:return t.formatMessage(A.privacyAnyoneWithLink);case l.Private:return t.formatMessage(A.privacyOnlyMe);case l.Group:case l.User:return t.formatMessage({id:"B9pJ5o",defaultMessage:"Invite only"});case l.Marketplace:return t.formatMessage(A.privacyMarketplace);case l.Workspace:return t.formatMessage(A.privacyWorkspace,{workspaceName:n});case l.WorkspaceLink:return t.formatMessage({id:"T5Eek0",defaultMessage:"Anyone at {workspaceName} with the link"},{workspaceName:n})}}function Ke(e){const r=X(),t=te(n=>n.currentWorkspace);return me(e,t,r)}function pe(e){return"gizmo"in e}function de(e){return"id"in e}function Qe(e){return`${e.replaceAll(".","_").replaceAll("-","_")}__jit_plugin`}const A=j({privacyOnlyMe:{id:"gizmo.privacyOnlyMe",defaultMessage:"Only me"},privacyAnyoneWithLink:{id:"gizmo.privacyAnyoneWithLink",defaultMessage:"Anyone with a link"},privacyWorkspace:{id:"gizmo.privacyWorkspace",defaultMessage:"Anyone at {workspaceName}"},privacyMarketplace:{id:"gizmo.privacyMarketplace",defaultMessage:"Everyone"}}),De="GPT Builder";function Fe(e){if(e)return`ChatGPT - ${e}`}function E(e){return e.gizmo.short_url??e.gizmo.id??"-"}function T(e){return`/g/${e}`}function Le(e){return`https://chatgpt.com${T(e)}`}function ze(e){return T(E(e))}function Oe(e,r){const t=new URLSearchParams;return r!=null&&t.set(N,r),ne(new URL(`${ze(e)}?${t}`,"https://chatgpt.com"))}function Ne(e){return`/g/${E(e)}`}function Ie(e){return pe(e)&&e.gizmo.live_version===0||de(e)&&e.liveVersion===0}function Te(e,r){return f({queryKey:["gizmos","discovery",{locale:e,isAnon:r}],queryFn:async()=>u.getGizmoDiscovery(e,r)})}function xe({cutId:e,locale:r,limit:t,cursor:n,enabled:s=!0}){return D({queryKey:["gizmos","discovery",{cutId:e,locale:r,limit:t}],queryFn:async({pageParam:o})=>u.getGizmoDiscoveryCut(e,{locale:r,cursor:o,limit:t}),initialPageParam:n,getNextPageParam:o=>o.list.cursor??void 0,enabled:s})}function We(){return f({queryKey:["gizmos","pinned"],queryFn:async()=>u.getGizmoPinned()})}function k(){return F({queryKey:["gizmos","bootstrap"],queryFn:async()=>u.getGizmoBootstrap().then(e=>({gizmos:e.gizmos.map(r=>({resource:r.resource,flair:r.flair}))}))})}function Be(){return f(k())}function Q(e,r){const t=e.filter(s=>s.resource.gizmo.id!==r.resource.gizmo.id);let n=t.findIndex(s=>s.flair.kind===$.Recent);return n===-1&&(n=t.length),t.splice(n,0,r),t}const He={handleGizmoInteracted(e,r){const t=e.getQueryData(p(e,r).queryKey);t!=null&&e.setQueryData(k().queryKey,n=>{if(n==null)return n;const s=n.gizmos.find(o=>o.resource.gizmo.id===r);return(s==null?void 0:s.flair.kind)===$.FirstParty||(s==null?void 0:s.flair.kind)===$.SidebarKeep?n:{gizmos:Q(n.gizmos,{resource:t,flair:{kind:$.Recent}})}})},handleGizmoSidebarKeep(e,r){const t=e.getQueryData(p(e,r).queryKey);t!=null&&e.setQueryData(k().queryKey,n=>n==null?n:{gizmos:Q(n.gizmos,{resource:t,flair:{kind:$.SidebarKeep}})})},handleGizmoSidebarHide(e,r){e.setQueryData(k().queryKey,t=>t!=null&&t.gizmos.some(n=>n.resource.gizmo.id===r)?{gizmos:t.gizmos.filter(n=>n.resource.gizmo.id!==r)}:t)}};function Ve(e,r=!1){const t=d();return f(p(t,e,r))}function Ye({gizmoId:e,draft:r,version:t}){const n=d(),s=t?{queryKey:["gizmo","version",{gizmoId:e,version:t}],queryFn:async()=>u.getVersion({gizmoId:e,version:t}),enabled:e!=null}:p(n,e,r);return f(s)}function Je(e,r){return f({queryKey:["gizmo","userActionSettings",{gizmoId:e}],queryFn:async()=>u.getUserActionSettings(e),enabled:e!=null&&r})}function p(e,r,t=!1){return F({queryKey:["gizmo",{gizmoId:r},{draft:t}],queryFn:async()=>u.getGizmo(r,t),enabled:r!=null,initialData:()=>{var o,c;if(t===!0)return;const n=e.getQueryData(k().queryKey);if(n!=null)return(o=n.gizmos.find(g=>g.resource.gizmo.id===r))==null?void 0:o.resource;const s=e.getQueryData(["gizmos","discovery"]);if(s!=null)for(const g of s.cuts){const y=(c=g.list.items.find(z=>z.resource.gizmo.id===r))==null?void 0:c.resource;if(y!=null)return y}}})}function Ze(e,r){return e.fetchQuery(p(e,r))}function Xe(e){return f({queryKey:["gizmo",{search:e}],queryFn:async()=>u.getGizmoSearch(e),enabled:e.length>0})}function je(e,r){return f({queryKey:["gizmo-search-workspace",{search:e}],queryFn:async()=>u.getGizmoSearchForWorkspace(e),enabled:e.length>0&&r})}function er(e,r=!1,t=!1,n=null){return D({queryKey:[t?"gizmo-search-workspace":"gizmo",{query:e,cursor:n}],queryFn:async({pageParam:s})=>t?u.getGizmoSearchForWorkspace(e,n=s):u.getGizmoSearch(e,n=s),initialPageParam:n,getNextPageParam:s=>s.cursor??void 0,enabled:r})}function rr(){const e=d();return w({mutationFn:async({gizmoId:r,editorData:t})=>{const{instructions:n,name:s,description:o,profilePictureId:c,profilePictureUrl:g,promptStarters:y,tools:z,files:R,trainingDisabled:G}=t;return u.upsertDraft({instructions:n,display:{name:s,description:o,profile_pic_id:c,profile_picture_url:g,prompt_starters:y},tools:z,files:R.map(U=>({...U,location:O.FILE_SERVICE})),training_disabled:G},r)},onSettled:r=>{r&&(e.setQueryData(p(e,r.gizmo.id,!0).queryKey,r),e.invalidateQueries({queryKey:["gizmos","mine"],refetchType:"none"}))}})}function tr(){const e=d();return w({mutationFn:async({gizmoId:r,data:t})=>{const{sharingRecipient:n,categories:s}=t,o=await u.promoteDraft({sharing:t.sharingSubjects&&t.sharingSubjects.length>0?t.sharingSubjects:{recipient:n},categories:s},r);if(o.error)throw new ce(o);return o.resource},onSettled:r=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"}),e.invalidateQueries({queryKey:["gizmos","pinned"],refetchType:"none"}),r&&e.setQueryData(p(e,r.gizmo.id,!1).queryKey,r)}})}function nr(){const e=d();return w({mutationFn:async({gizmoId:r})=>u.deleteGizmo(r),onSettled:()=>{e.invalidateQueries({queryKey:["gizmos"],refetchType:"all"})}})}function sr(){const e=d();return w({mutationFn:async({name:r,hideName:t,websiteUrl:n,willReceiveSupportEmails:s})=>u.updateBuilderProfile({name:r,hide_name:t,website_url:n,will_receive_support_emails:s}),onSuccess:r=>{e.setQueryData(["builderProfile"],r)},onError:r=>{L.warning(r.message)}})}function ir(){return f({queryKey:["builderProfile"],queryFn:async()=>u.getBuilderProfile()})}function ar(){return w({mutationFn:async({gizmoId:e})=>u.copyGizmo({gizmoId:e})})}function or(){return f({queryKey:["gizmoCategories"],queryFn:async()=>u.getCategories()})}function ur(e,r){return!!(r!=null&&[M.PrimaryAssistant,M.GizmoInteraction].includes(r)&&(e!=null&&e.includes(ee.GPT_4)))}function cr(e,r){const t=d();return w({mutationFn:async({rating:n,message:s,includeFrom:o})=>{await u.upsertUserReview(e,n,s,o)},onSuccess:async()=>{t.invalidateQueries({queryKey:["gizmo","review",{gizmoId:e}]})},onError:n=>{L.danger(n.message)}})}function lr(e,r){return r?`/g/${E(r)}/c/${e}`:`/c/${e}`}function gr(){return"/gpts"}function fr(){return"/gpts/mine"}function x(e){return e?`/gpts/editor/${e}`:"/gpts/editor"}function yr(e){const r=he();return e==null?r:x(e)}function he(e){return x(e)}function mr(e){try{const r=new URL(e);return r.hostname=r.hostname.replace(/^(www\.|web\.|mbasic\.|mobile\.)(secure\.)?/,""),r.pathname="",[...r.searchParams.keys()].forEach(t=>r.searchParams.delete(t)),r.toString()}catch{return e}}function _e(e){if(!e)return null;try{return new URL(e).hostname}catch{return null}}function pr(e){const r=_e(e);return r?r.replace(/^www\./,""):e}export{p as $,We as A,ar as B,ae as C,Se as D,de as E,pe as F,ue as G,Xe as H,je as I,er as J,Te as K,gr as L,le as M,ir as N,sr as O,$ as P,or as Q,Ce as R,Ue as S,oe as T,ke as U,Ee as V,fr as W,Qe as X,Ye as Y,rr as Z,tr as _,u as a,ce as a0,T as a1,Ze as a2,Ge as a3,ur as a4,De as a5,qe as a6,cr as b,nr as c,Ne as d,l as e,Ie as f,lr as g,x as h,Me as i,ze as j,Ke as k,he as l,pr as m,Be as n,He as o,Fe as p,Le as q,Oe as r,mr as s,Je as t,Ve as u,Ae as v,be as w,yr as x,Pe as y,xe as z};
//# sourceMappingURL=lyr64vj216kc7moh.js.map
