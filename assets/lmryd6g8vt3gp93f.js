import{a4 as C,j as e,c as R,I as W,r as p,ay as $,ax as se,T as m,u as te,a as re,dC as oe,R as J,t as K,as as ne,G as ie,F as P,h as E,v as L,c6 as F,w as le,aO as ce}from"./hc9xxm00a3r3byem.js";import{A as O,a as T}from"./lxui8l23v2tzixf9.js";import{S as de,a as me}from"./olkgl1p4p1b910lq.js";import{bl as ue,I as pe,bj as xe,aJ as fe,X as z,Y as ge,bm as ve,T as he}from"./ozzpumen10p6g0yq.js";import{u as je,F as M,I as be,s as ke}from"./b2rny0kod41myp87.js";import{u as ye,g as we,a as Me}from"./kptbw01pxwd1ocyc.js";import{aZ as Ne,e as Ae,a4 as Pe,a_ as Se,a$ as q,b0 as Ie,b1 as Ue,an as Ce,b2 as We,b3 as De,aq as Be}from"./fga5qe14lr2llx8v.js";import{b as Re,G as A,U}from"./guykwp3ov0cliuel.js";import{d as Te,a as Ee}from"./cm4yp0pj7foedy4v.js";import{M as X}from"./fi9p3eeu24b9vfd1.js";import{T as Le}from"./facz9srd4e5z6fv5.js";import{u as ze,a as _e}from"./dsvckya76mm06sjp.js";import{b as Ge}from"./nbrfb6b5fqz7ea4t.js";function He({onFileChange:a,className:o,message:s,mimeTypes:n}){const t=C(),r=s??t.formatMessage(Y.helpText),c=S=>{if(S.length>0){const l=S[0];n&&n.includes(l.type)&&a(l)}},{open:x,getRootProps:h,getInputProps:N,isDragActive:j}=ye({disabled:!1,noClick:!0,onDropAccepted:c,onDropRejected:()=>null,multiple:!1,maxSize:ue,...je(n)});return e.jsxs("div",{className:R("flex flex-col content-center justify-center gap-3 rounded-xl border border-dashed px-6 py-16 text-center",j?"border-green-600 bg-green-600 bg-opacity-10":"border-token-border-medium",o),...h(),children:[e.jsx("input",{...N()}),e.jsx("div",{className:"text-center dark:text-white",children:e.jsx("div",{className:"inline-block",children:e.jsx(Ne,{})})}),e.jsx("div",{className:"text-center text-sm",children:r}),e.jsx("div",{className:"cursor-pointer text-center text-sm font-bold text-green-600",onClick:()=>{x()},children:t.formatMessage(Y.openFilePicker)})]})}const Y=W({helpText:{id:"FileUploadBox.helpText",defaultMessage:"Drop file here to upload"},openFilePicker:{id:"FileUploadBox.openFilePicker",defaultMessage:"Browse files"}});function $e(a){const o=te(),s=C();return re({mutationFn:({name:n,profilePictureId:t,profilePictureUrl:r})=>J.patchWorkspace({workspaceId:a,name:n,profile_picture_id:t,profile_picture_url:r}).catch(c=>{K.danger(s.formatMessage(g.saveError,{error:c.message}))}),onSuccess:()=>{o.invalidateQueries({queryKey:["account-status"]})}})}function Fe({workspace:a}){const[o,s]=p.useState((a==null?void 0:a.name)??""),[n,t]=p.useState(!1);!n&&a&&(t(!0),o==""&&s((a==null?void 0:a.name)??""));const[r,c]=p.useState(a.profilePictureUrl),[x,h]=p.useState(a.profilePictureId),N=Re(A.WorkspaceAppearance),j=C(),S=()=>U.closeModal(A.WorkspaceAppearance),[l,k]=p.useState(void 0);async function Z(f){const w=await ke(f,O.workspaceAvatarPreview*2),G=we(w);k({tempId:G,file:w,status:M.Uploading,progress:1,fileId:null,cdnUrl:null}),Me(G,w,j,oe.ProfilePicture,{onFileCreated(y,u,d){k(i=>i!=="initial"&&(i==null?void 0:i.tempId)===y&&i.status===M.Uploading?{...i,progress:10,fileId:u,cdnUrl:d}:i)},onFileUploadProgress(y,u){k(d=>d!=="initial"&&(d==null?void 0:d.tempId)===y&&d.status===M.Uploading?{...d,progress:u}:d)},onFileUploaded(y,u,d){k(i=>i!=="initial"&&i&&i.cdnUrl&&i.tempId===y?(J.getFileDownloadLink(i.fileId).then(H=>{H.status===ne.Success&&(h(i.fileId),c(H.download_url))}),{...i,status:M.Ready,progress:100,fileSpec:{name:i.file.name,id:i.fileId,size:i.file.size,...d??{}}}):i)},onError(y){k(u=>{if(u!=="initial"&&(u==null?void 0:u.tempId)===y){h(void 0),c(void 0),B(null);return}return u})}})}const _=$e(a.id),V=e.jsx($.Button,{color:"primary",disabled:l!=="initial"&&l!==void 0&&l.status!==M.Ready||l!=="initial"&&l!==void 0&&l.status===M.Ready&&!r||_.isPending||o.trim().length===0,onClick:async()=>{_.mutate({name:o,profilePictureId:x,profilePictureUrl:r}),U.closeModal(A.WorkspaceAppearance)},title:j.formatMessage(g.modalSubmit)}),ee=e.jsx($.Button,{onClick:()=>{k(void 0),h(a.profilePictureId),c(a.profilePictureUrl),U.closeModal(A.WorkspaceAppearance)},title:j.formatMessage(g.modalCancel)}),[D,B]=p.useState(null);p.useEffect(()=>{if(l!=="initial"&&l!=null&&D==null){const f=new FileReader;f.addEventListener("load",()=>{const w=f.result;typeof w=="string"&&B(w)}),f.readAsDataURL(l.file)}},[l,D]);const ae=()=>{h(null),c(null),k(void 0),B(null)};return e.jsxs(se,{isOpen:N,onClose:S,showCloseButton:!0,primaryButton:V,secondaryButton:ee,type:"danger",title:j.formatMessage(g.modalTitle),children:[e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-name",className:"block pb-1 font-semibold text-token-text-primary",children:e.jsx(m,{...g.workspaceName})}),e.jsx("p",{className:"font-base text-sm text-token-text-secondary",children:e.jsx(m,{...g.workspaceNameDescription})})]}),e.jsx("div",{className:"mb-4",children:e.jsx(pe,{type:"text",name:"workspace-name",value:o,onChange:f=>s(f.target.value),maxLength:64})}),e.jsxs("div",{className:"mb-4 flex-wrap",children:[e.jsx("label",{htmlFor:"workspace-avatar",className:"block pb-1 font-semibold text-token-text-primary",children:e.jsx(m,{...g.workspaceAvatar})}),e.jsx("p",{className:"font-base text-sm text-token-text-secondary",children:j.formatMessage(g.workspaceAvatarDescription,{size:O.workspaceAvatarPreview*2})})]}),e.jsxs("div",{className:"mb-4 flex-wrap text-center",children:[r?e.jsxs("div",{className:"relative mb-3 inline-flex",children:[e.jsx(T,{src:r,size:"workspaceAvatarPreview"}),e.jsx("div",{className:"absolute -right-1 -top-1",children:e.jsx(Oe,{onClick:ae})})]}):l!=null&&l!=="initial"&&D?e.jsx("div",{className:"flex flex-col justify-center text-center",children:e.jsxs("div",{className:"relative mb-3 text-center",children:[e.jsx(T,{src:URL.createObjectURL(l.file),size:"workspaceAvatarPreview"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white",children:e.jsx(xe,{percentage:l.progress,className:"h-6 w-6"})})]})}):e.jsx(He,{onFileChange:f=>{Z(f)},mimeTypes:be}),e.jsx(fe,{className:"mt-3",children:j.formatMessage(g.propagationWarning)})]})]})}function Oe({onClick:a}){return e.jsx("div",{className:"flex h-6 w-6 cursor-pointer flex-row flex-wrap content-center justify-center rounded-full border-2 border-white bg-black text-white",onClick:a,children:e.jsx(Ae,{className:"h-3 w-3"})})}const g=W({modalTitle:{id:"workspaceAppearanceModal.title",defaultMessage:"Workspace appearance"},modalSubmit:{id:"workspaceAppearanceModal.submit",defaultMessage:"Save"},modalCancel:{id:"workspaceAppearanceModal.cancel",defaultMessage:"Cancel"},workspaceName:{id:"workspaceAppearanceModal.workspaceName",defaultMessage:"Workspace name"},workspaceNameDescription:{id:"workspaceAppearanceModal.workspaceNameDescription",defaultMessage:"Update the name of the workspace."},workspaceAvatar:{id:"workspaceAppearanceModal.workspaceAvatar",defaultMessage:"Workspace image"},workspaceAvatarDescription:{id:"workspaceAppearanceModal.workspaceAvatarDescription",defaultMessage:"Upload a JPEG or PNG workspace image for your team. (Minimum {size}Ã—{size}px recommended.)"},propagationWarning:{id:"workspaceAppearanceModal.propagationWarning",defaultMessage:"Changes to the workspace name and image may take some time to take effect."},saveError:{id:"workspaceAppearanceModal.saveError",defaultMessage:"Failed to save workspace appearance"}});function qe({accountId:a,subscription:o}){const s=C(),n=ze(a),[t,r]=p.useState(!1),c=Ge(a),x=async()=>{r(!0);try{await n.mutateAsync(a)}catch{K.warning(s.formatMessage(I.errorRenewingSubscription),{hasCloseButton:!0})}finally{r(!1)}};return e.jsx("div",{className:"bg-token-main-surface-secondary",children:e.jsxs("div",{className:"mx-auto flex w-full max-w-5xl items-center justify-between px-2 py-4 md:px-6 lg:px-10 lg:py-6",children:[e.jsxs("div",{className:"mx-2 flex-grow md:mx-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Le,{className:"mr-4 hidden text-orange-500 md:block"}),e.jsx("p",{className:"text-lg font-semibold",children:e.jsx(m,{...I.workspaceWillBeDeactivated})})]}),o.active_until!=null&&e.jsx("p",{className:"md:ml-8",children:e.jsx(m,{...I.retainAccessUntil,values:{expiryDate:new Date(o.active_until)}})})]}),c&&e.jsx(ie,{color:"primary",onClick:x,loading:t,children:e.jsx(m,{...I.reactivateBtn})})]})})}const I=W({retainAccessUntil:{id:"adminPage.retainAccessUntil",defaultMessage:"You will retain access to the workspace until the end of your billing cycle on {expiryDate, date, long}."},workspaceWillBeDeactivated:{id:"adminPage.workspaceWillBeDeactivated",defaultMessage:"This workspace will be deactivated."},reactivateBtn:{id:"adminPage.reactivateBtn",defaultMessage:"Reactivate"},errorRenewingSubscription:{id:"adminPage.errorRenewingSubscription",defaultMessage:"There was an error reactivating your subscription."}});function b({route:a,icon:o,name:s,upsellEnterprise:n=!1}){const t=E();return n?e.jsx(he,{label:e.jsx(m,{...v.availableForEnterprise}),side:"right",children:e.jsxs(X,{$as:"button",className:R("w-full rounded text-left","hover:bg-token-sidebar-surface-secondary"),children:[e.jsx(Be,{className:"icon-sm shrink-0 text-token-text-secondary"}),e.jsx("span",{className:"text-token-text-secondary",children:e.jsx(m,{...s})})]})}):e.jsxs(X,{$as:"button",className:R("w-full rounded text-left hover:bg-token-sidebar-surface-secondary",t.route===a&&"bg-token-sidebar-surface-secondary"),onClick:r=>{t.push(a),r.stopPropagation()},children:[o,e.jsx(m,{...s})]})}function Xe({workspace:a,hasAdminPrivileges:o,hasOwnerPrivileges:s}){const n=E(),t=p.useCallback(()=>{n.push("/")},[n]),r=z(ge.isEnterpriseyPlan);return e.jsxs("nav",{className:"p-2",children:[e.jsx("div",{className:"mb-1 flex flex-row gap-2",children:e.jsxs(me,{onClick:t,children:[e.jsx(ve,{className:"icon-sm"}),e.jsx(m,{...v.backToChat})]})}),e.jsxs("div",{className:"flex flex-col gap-2 py-2",children:[e.jsxs("div",{className:`flex flex-col gap-2 rounded px-2 py-2 ${s?"cursor-pointer hover:bg-token-main-surface-secondary":""}`,onClick:()=>{s&&U.openModal(A.WorkspaceAppearance)},children:[e.jsx(T,{size:"large",src:a==null?void 0:a.profilePictureUrl}),e.jsxs("div",{className:"align-center flex flex-row",children:[e.jsx("h2",{className:"flex-1 text-lg text-token-text-primary dark:text-white",children:a==null?void 0:a.name}),s?e.jsx("div",{className:"my-auto h-4 flex-initial align-middle dark:text-white",children:e.jsx(Pe,{className:"icon-sm opacity-70 hover:opacity-100"})}):null]})]}),e.jsx(b,{route:"/admin",icon:e.jsx(Se,{className:"icon-sm"}),name:v.membersPageTitle}),r&&e.jsx(b,{route:"/admin/groups",icon:e.jsx(q,{className:"icon-sm"}),upsellEnterprise:!r,name:F({id:"aecR1i",defaultMessage:"Groups"})}),s&&e.jsx(b,{route:"/admin/billing",icon:e.jsx(Ie,{className:"icon-sm"}),name:v.billing}),s&&e.jsx(b,{route:"/admin/gpts",icon:e.jsx(Ue,{className:"icon-sm"}),name:v.gpts}),s&&e.jsx(b,{route:"/admin/settings",icon:e.jsx(Ce,{className:"icon-sm"}),name:v.settings}),!r&&e.jsx("span",{className:"mx-3 border-t border-y-token-border-medium"}),!r&&e.jsx(b,{route:"/admin/groups",icon:e.jsx(q,{className:"icon-sm"}),upsellEnterprise:!r,name:F({id:"aecR1i",defaultMessage:"Groups"})}),o&&e.jsx(b,{route:"/admin/analytics",icon:e.jsx(We,{className:"icon-sm"}),name:v.analytics,upsellEnterprise:!r}),s&&e.jsx(b,{route:"/admin/identity",upsellEnterprise:!r,icon:e.jsx(De,{className:"icon-sm"}),name:v.identity})]})]})}function da({mobilePageTitle:a,requireAdminPrivileges:o=!1,requireOwnerPrivileges:s=!1,children:n}){const t=z(N=>N.currentWorkspace),r=E(),c=t!=null?Te(t.role):void 0,x=t!=null?Ee(t.role):void 0;return p.useEffect(()=>{o&&c===!1&&r.push("/admin"),s&&x===!1&&r.push("/admin")},[o,c,r,s,x]),L()==null?null:e.jsxs(e.Fragment,{children:[e.jsx(de,{mobileHeaderContent:a,forceOpenDesktopSidebar:!0,sidebar:e.jsx(Xe,{workspace:t??void 0,hasAdminPrivileges:c,hasOwnerPrivileges:x}),children:n}),t==null?null:e.jsx(Fe,{workspace:t})]})}const Ye=P.div`border-b border-token-main-surface-tertiary hidden md:block py-6 lg:py-10`,Q=P.h2`mx-auto w-full max-w-4xl px-2 md:px-6 lg:px-10`,Je=P(Q)`font-normal text-base text-token-text-secondary`;P.p`text-sm text-token-text-tertiary`;function ma({title:a,subtitle:o}){const{data:s}=_e(),n=L(),t=n&&s&&s.plan_type===le.TEAM&&!s.will_renew;return e.jsxs(e.Fragment,{children:[t&&e.jsx(qe,{accountId:n.id,subscription:s}),e.jsxs(Ye,{children:[e.jsx(Q,{children:a}),o&&e.jsx(Je,{children:o})]})]})}const Ke=P.div`max-w-4xl mx-auto w-full px-2 md:px-6 lg:px-10`;function ua({children:a,showSpinner:o}){const s=L(),n=z(r=>r.currentWorkspace),t=!s||o;return e.jsxs(Ke,{children:[t&&e.jsx("div",{className:"flex min-h-[80vh] items-center justify-center",children:e.jsx(ce,{})}),!t&&!n&&e.jsx("div",{className:"flex min-h-[80vh] items-center justify-center",children:e.jsx(m,{...v.workspaceNotFound})}),!t&&n&&a]})}const v=W({workspaceNotFound:{id:"adminPage.workspaceNotFound",defaultMessage:"Workspace not found"},backToChat:{id:"adminPage.backToChat",defaultMessage:"Back to chat"},membersPageTitle:{id:"adminPage.membersPageTitle",defaultMessage:"Members"},analytics:{id:"adminPage.analytics",defaultMessage:"Analytics"},billing:{id:"adminPage.billing.1",defaultMessage:"Billing"},gpts:{id:"adminPage.gpts",defaultMessage:"GPTs"},settings:{id:"adminPage.Settings",defaultMessage:"Settings"},identity:{id:"adminPage.identity.0",defaultMessage:"Identity & provisioning"},availableForEnterprise:{id:"adminPage.availableForEnterprise",defaultMessage:"Available for Enterprise plan"}});export{da as A,ma as a,ua as b};
//# sourceMappingURL=lmryd6g8vt3gp93f.js.map
